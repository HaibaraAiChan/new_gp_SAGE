main start at this time 1657097072.525797
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.027182340621948242
global_2_local spend time (sec) 0.03707623481750488
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0049135684967041016
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 66367, 1: 13428, 2: 11706, 3: 9277, 4: 7320, 5: 6222, 40: 5145, 6: 4868, 7: 4045, 8: 3472, 9: 2976, 10: 2599, 11: 2203, 12: 1937, 13: 1656, 14: 1434, 15: 1289, 16: 1111, 17: 1030, 18: 948, 19: 836, 20: 807, 21: 717, 22: 556, 24: 525, 23: 519, 25: 483, 26: 409, 27: 390, 28: 370, 29: 329, 31: 300, 32: 273, 30: 261, 33: 261, 34: 231, 36: 226, 35: 200, 39: 200, 37: 196, 38: 186})

A = g.adjacency_matrix() spent  0.009832620620727539
auxiliary_graph
Graph(num_nodes=157308, num_edges=35021951,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07855677604675293
remove nodes length  66367

auxiliary_graph.remove_nodes spent  1.8802776336669922
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=35021951,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.6003978252410889

the counter of shared neighbor distribution
Counter({1.0: 27043422, 2.0: 5402536, 3.0: 1535470, 4.0: 520896, 5.0: 208256, 6.0: 96348, 7.0: 49078, 8.0: 27750, 9.0: 16122, 10.0: 10522, 11.0: 6674, 12.0: 4282, 13.0: 2858, 14.0: 2032, 15.0: 1384, 16.0: 974, 17.0: 736, 18.0: 480, 19.0: 374, 20.0: 276, 21.0: 184, 22.0: 132, 23.0: 88, 24.0: 44, 25.0: 36, 26.0: 24, 27.0: 10, 28.0: 6, 30.0: 6, 29.0: 4, 33.0: 2, 38.0: 2, 32.0: 2})
34931010
Convert a graph into a bidirected graph: 1.590 seconds
Metis partitioning: 6.598 seconds
Split the graph: 1.390 seconds
Construct subgraphs: 0.079 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.672581911087036
5522
5517
5517
5747
5854
5517
5518
5520
5854
5854
5813
5854
5791
5689
5854
5520
total k batches seeds list generation spend  18.849509239196777
after graph partition
graph partition algorithm spend time 18.951192617416382
5522
5517
5517
5747
5854
5517
5518
5520
5854
5854
5813
5854
5791
5689
5854
5520
partition_len_list
[11764, 16194, 28438, 17952, 32958, 28789, 31394, 26911, 10716, 13464, 12296, 14186, 10796, 12804, 13012, 11538]
REG selection method  spend 19.040173768997192
time for parepare:  0.017809629440307617
local_output_nid generation:  0.0012187957763671875
local_in_edges_tensor generation:  0.0013740062713623047
mini_batch_src_global generation:  0.0015044212341308594
r_  generation:  0.01055908203125
local_output_nid generation:  0.0013055801391601562
local_in_edges_tensor generation:  0.0013155937194824219
mini_batch_src_global generation:  0.0017883777618408203
r_  generation:  0.015470027923583984
local_output_nid generation:  0.0013935565948486328
local_in_edges_tensor generation:  0.001653432846069336
mini_batch_src_global generation:  0.0025267601013183594
r_  generation:  0.02290654182434082
local_output_nid generation:  0.001718282699584961
local_in_edges_tensor generation:  0.0013391971588134766
mini_batch_src_global generation:  0.0019469261169433594
r_  generation:  0.017582416534423828
local_output_nid generation:  0.0016722679138183594
local_in_edges_tensor generation:  0.0015606880187988281
mini_batch_src_global generation:  0.003500699996948242
r_  generation:  0.031221628189086914
local_output_nid generation:  0.0018203258514404297
local_in_edges_tensor generation:  0.0015265941619873047
mini_batch_src_global generation:  0.002659320831298828
r_  generation:  0.024359703063964844
local_output_nid generation:  0.0018420219421386719
local_in_edges_tensor generation:  0.0014522075653076172
mini_batch_src_global generation:  0.0019953250885009766
r_  generation:  0.025018692016601562
local_output_nid generation:  0.0019631385803222656
local_in_edges_tensor generation:  0.00135040283203125
mini_batch_src_global generation:  0.0016460418701171875
r_  generation:  0.018566131591796875
local_output_nid generation:  0.001932382583618164
local_in_edges_tensor generation:  0.0013446807861328125
mini_batch_src_global generation:  0.0012485980987548828
r_  generation:  0.013573884963989258
local_output_nid generation:  0.001764535903930664
local_in_edges_tensor generation:  0.0013408660888671875
mini_batch_src_global generation:  0.0012812614440917969
r_  generation:  0.01572251319885254
local_output_nid generation:  0.0017328262329101562
local_in_edges_tensor generation:  0.0012290477752685547
mini_batch_src_global generation:  0.0012731552124023438
r_  generation:  0.01403498649597168
local_output_nid generation:  0.0016655921936035156
local_in_edges_tensor generation:  0.0012695789337158203
mini_batch_src_global generation:  0.0014562606811523438
r_  generation:  0.01753830909729004
local_output_nid generation:  0.0016529560089111328
local_in_edges_tensor generation:  0.0012860298156738281
mini_batch_src_global generation:  0.001619100570678711
r_  generation:  0.018134593963623047
local_output_nid generation:  0.001556396484375
local_in_edges_tensor generation:  0.001329660415649414
mini_batch_src_global generation:  0.0014903545379638672
r_  generation:  0.016315460205078125
local_output_nid generation:  0.0016701221466064453
local_in_edges_tensor generation:  0.001295328140258789
mini_batch_src_global generation:  0.001598358154296875
r_  generation:  0.01871204376220703
local_output_nid generation:  0.0016508102416992188
local_in_edges_tensor generation:  0.0012784004211425781
mini_batch_src_global generation:  0.0039234161376953125
r_  generation:  0.012527704238891602
----------------------check_connections_block total spend ----------------------------- 0.4638712406158447
generate_one_block  0.021701574325561523
generate_one_block  0.018181800842285156
generate_one_block  0.03141045570373535
generate_one_block  0.02715754508972168
generate_one_block  0.047430992126464844
generate_one_block  0.032896995544433594
generate_one_block  0.03285050392150879
generate_one_block  0.024117231369018555
generate_one_block  0.01724553108215332
generate_one_block  0.020783185958862305
generate_one_block  0.018441438674926758
generate_one_block  0.024163007736206055
generate_one_block  0.02514934539794922
generate_one_block  0.022052526473999023
generate_one_block  0.03647589683532715
generate_one_block  0.01728343963623047
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.051931142807006836
gen group dst list time:  0.008333683013916016
time for parepare:  0.022076845169067383
local_output_nid generation:  0.002228975296020508
local_in_edges_tensor generation:  0.018964052200317383
mini_batch_src_global generation:  0.0029191970825195312
r_  generation:  0.031153202056884766
local_output_nid generation:  0.004774808883666992
local_in_edges_tensor generation:  0.006004810333251953
mini_batch_src_global generation:  0.00615239143371582
r_  generation:  0.05353951454162598
local_output_nid generation:  0.007738828659057617
local_in_edges_tensor generation:  0.011603593826293945
mini_batch_src_global generation:  0.03633379936218262
r_  generation:  0.13725018501281738
local_output_nid generation:  0.0052187442779541016
local_in_edges_tensor generation:  0.005159854888916016
mini_batch_src_global generation:  0.009262561798095703
r_  generation:  0.07345104217529297
local_output_nid generation:  0.009386539459228516
local_in_edges_tensor generation:  0.011834859848022461
mini_batch_src_global generation:  0.02663445472717285
r_  generation:  0.180039644241333
local_output_nid generation:  0.008106708526611328
local_in_edges_tensor generation:  0.01690506935119629
mini_batch_src_global generation:  0.022010326385498047
r_  generation:  0.15159368515014648
local_output_nid generation:  0.00827932357788086
local_in_edges_tensor generation:  0.010701179504394531
mini_batch_src_global generation:  0.021357297897338867
r_  generation:  0.15892958641052246
local_output_nid generation:  0.007486820220947266
local_in_edges_tensor generation:  0.008244991302490234
mini_batch_src_global generation:  0.02184891700744629
r_  generation:  0.1363663673400879
local_output_nid generation:  0.004372596740722656
local_in_edges_tensor generation:  0.003050565719604492
mini_batch_src_global generation:  0.0059740543365478516
r_  generation:  0.03217148780822754
local_output_nid generation:  0.004220008850097656
local_in_edges_tensor generation:  0.004156351089477539
mini_batch_src_global generation:  0.004380702972412109
r_  generation:  0.043021440505981445
local_output_nid generation:  0.003707408905029297
local_in_edges_tensor generation:  0.0036439895629882812
mini_batch_src_global generation:  0.004008054733276367
r_  generation:  0.03679203987121582
local_output_nid generation:  0.004349470138549805
local_in_edges_tensor generation:  0.004224538803100586
mini_batch_src_global generation:  0.005132913589477539
r_  generation:  0.0549931526184082
local_output_nid generation:  0.0033957958221435547
local_in_edges_tensor generation:  0.003374814987182617
mini_batch_src_global generation:  0.004596233367919922
r_  generation:  0.03732156753540039
local_output_nid generation:  0.003786325454711914
local_in_edges_tensor generation:  0.0036118030548095703
mini_batch_src_global generation:  0.003957986831665039
r_  generation:  0.04081082344055176
local_output_nid generation:  0.0037908554077148438
local_in_edges_tensor generation:  0.003670930862426758
mini_batch_src_global generation:  0.004362344741821289
r_  generation:  0.043167829513549805
local_output_nid generation:  0.0034263134002685547
local_in_edges_tensor generation:  0.003217458724975586
mini_batch_src_global generation:  0.0033788681030273438
r_  generation:  0.032537221908569336
----------------------check_connections_block total spend ----------------------------- 1.940263271331787
generate_one_block  0.05215620994567871
generate_one_block  0.07042050361633301
generate_one_block  0.18400335311889648
generate_one_block  0.09200835227966309
generate_one_block  0.24938750267028809
generate_one_block  0.21312904357910156
generate_one_block  0.2152848243713379
generate_one_block  0.1704559326171875
generate_one_block  0.03530073165893555
generate_one_block  0.052164554595947266
generate_one_block  0.04438185691833496
generate_one_block  0.06905102729797363
generate_one_block  0.04679989814758301
generate_one_block  0.05396413803100586
generate_one_block  0.0537412166595459
generate_one_block  0.04169726371765137
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.04689908027648926
gen group dst list time:  0.026793241500854492
time for parepare:  0.021205663681030273
local_output_nid generation:  0.006201744079589844
local_in_edges_tensor generation:  0.035120248794555664
mini_batch_src_global generation:  0.012543678283691406
r_  generation:  0.11548638343811035
local_output_nid generation:  0.01415252685546875
local_in_edges_tensor generation:  0.014251708984375
mini_batch_src_global generation:  0.023169994354248047
r_  generation:  0.1840953826904297
local_output_nid generation:  0.019978761672973633
local_in_edges_tensor generation:  0.03202676773071289
mini_batch_src_global generation:  0.03484988212585449
r_  generation:  0.329958438873291
local_output_nid generation:  0.013878345489501953
local_in_edges_tensor generation:  0.01731705665588379
mini_batch_src_global generation:  0.02832818031311035
r_  generation:  0.22116589546203613
local_output_nid generation:  0.016376972198486328
local_in_edges_tensor generation:  0.022452354431152344
mini_batch_src_global generation:  0.047727108001708984
r_  generation:  0.3049001693725586
local_output_nid generation:  0.01793360710144043
local_in_edges_tensor generation:  0.022985219955444336
mini_batch_src_global generation:  0.03935360908508301
r_  generation:  0.312544584274292
local_output_nid generation:  0.02120065689086914
local_in_edges_tensor generation:  0.03435993194580078
mini_batch_src_global generation:  0.05147266387939453
r_  generation:  0.3593025207519531
local_output_nid generation:  0.021772146224975586
local_in_edges_tensor generation:  0.029435396194458008
mini_batch_src_global generation:  0.048125505447387695
r_  generation:  0.3697638511657715
local_output_nid generation:  0.008953094482421875
local_in_edges_tensor generation:  0.005888700485229492
mini_batch_src_global generation:  0.016791820526123047
r_  generation:  0.07430458068847656
local_output_nid generation:  0.01042032241821289
local_in_edges_tensor generation:  0.010654687881469727
mini_batch_src_global generation:  0.013265371322631836
r_  generation:  0.15218710899353027
local_output_nid generation:  0.00979304313659668
local_in_edges_tensor generation:  0.008880853652954102
mini_batch_src_global generation:  0.015093803405761719
r_  generation:  0.1387939453125
local_output_nid generation:  0.01897597312927246
local_in_edges_tensor generation:  0.01697087287902832
mini_batch_src_global generation:  0.03538346290588379
r_  generation:  0.19867467880249023
local_output_nid generation:  0.012212753295898438
local_in_edges_tensor generation:  0.007977008819580078
mini_batch_src_global generation:  0.020080089569091797
r_  generation:  0.09385085105895996
local_output_nid generation:  0.011528253555297852
local_in_edges_tensor generation:  0.010076522827148438
mini_batch_src_global generation:  0.01692509651184082
r_  generation:  0.14273810386657715
local_output_nid generation:  0.008049249649047852
local_in_edges_tensor generation:  0.007232666015625
mini_batch_src_global generation:  0.015392780303955078
r_  generation:  0.09622716903686523
local_output_nid generation:  0.008809328079223633
local_in_edges_tensor generation:  0.007812976837158203
mini_batch_src_global generation:  0.013587713241577148
r_  generation:  0.10629439353942871
----------------------check_connections_block total spend ----------------------------- 4.891972780227661
generate_one_block  0.1656191349029541
generate_one_block  0.2736930847167969
generate_one_block  0.4842557907104492
generate_one_block  0.3006117343902588
generate_one_block  0.40720605850219727
generate_one_block  0.40535974502563477
generate_one_block  0.4536759853363037
generate_one_block  0.4681565761566162
generate_one_block  0.09144401550292969
generate_one_block  0.16524696350097656
generate_one_block  0.16062021255493164
generate_one_block  0.2277965545654297
generate_one_block  0.11376047134399414
generate_one_block  0.17333531379699707
generate_one_block  0.12343502044677734
generate_one_block  0.13513588905334473
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.029916763305664062
gen group dst list time:  0.054155826568603516
time for parepare:  0.021743297576904297
local_output_nid generation:  0.020275354385375977
local_in_edges_tensor generation:  0.03418588638305664
mini_batch_src_global generation:  0.03221392631530762
r_  generation:  0.23638391494750977
local_output_nid generation:  0.03170633316040039
local_in_edges_tensor generation:  0.03265857696533203
mini_batch_src_global generation:  0.030092716217041016
r_  generation:  0.2935471534729004
local_output_nid generation:  0.03284931182861328
local_in_edges_tensor generation:  0.040343523025512695
mini_batch_src_global generation:  0.037599802017211914
r_  generation:  0.3357672691345215
local_output_nid generation:  0.02675342559814453
local_in_edges_tensor generation:  0.027769804000854492
mini_batch_src_global generation:  0.034989118576049805
r_  generation:  0.28100085258483887
local_output_nid generation:  0.029266834259033203
local_in_edges_tensor generation:  0.022487401962280273
mini_batch_src_global generation:  0.03267788887023926
r_  generation:  0.31371426582336426
local_output_nid generation:  0.03093886375427246
local_in_edges_tensor generation:  0.029557228088378906
mini_batch_src_global generation:  0.03132176399230957
r_  generation:  0.30954599380493164
local_output_nid generation:  0.031374454498291016
local_in_edges_tensor generation:  0.03054213523864746
mini_batch_src_global generation:  0.03308534622192383
r_  generation:  0.3340413570404053
local_output_nid generation:  0.033762454986572266
local_in_edges_tensor generation:  0.031003952026367188
mini_batch_src_global generation:  0.03537631034851074
r_  generation:  0.3441202640533447
local_output_nid generation:  0.019334793090820312
local_in_edges_tensor generation:  0.013436317443847656
mini_batch_src_global generation:  0.020432710647583008
r_  generation:  0.15860342979431152
local_output_nid generation:  0.025547504425048828
local_in_edges_tensor generation:  0.020171642303466797
mini_batch_src_global generation:  0.024797439575195312
r_  generation:  0.2521219253540039
local_output_nid generation:  0.023514509201049805
local_in_edges_tensor generation:  0.023885488510131836
mini_batch_src_global generation:  0.02492523193359375
r_  generation:  0.2597498893737793
local_output_nid generation:  0.03142523765563965
local_in_edges_tensor generation:  0.029247760772705078
mini_batch_src_global generation:  0.03331756591796875
r_  generation:  0.29799485206604004
local_output_nid generation:  0.01690959930419922
local_in_edges_tensor generation:  0.01324009895324707
mini_batch_src_global generation:  0.020422697067260742
r_  generation:  0.16206932067871094
local_output_nid generation:  0.024991512298583984
local_in_edges_tensor generation:  0.020337820053100586
mini_batch_src_global generation:  0.025757789611816406
r_  generation:  0.25458216667175293
local_output_nid generation:  0.018439531326293945
local_in_edges_tensor generation:  0.013701677322387695
mini_batch_src_global generation:  0.02021503448486328
r_  generation:  0.18264389038085938
local_output_nid generation:  0.020650863647460938
local_in_edges_tensor generation:  0.015654325485229492
mini_batch_src_global generation:  0.021507978439331055
r_  generation:  0.20254278182983398
----------------------check_connections_block total spend ----------------------------- 6.508999586105347
generate_one_block  0.3112025260925293
generate_one_block  0.37923431396484375
generate_one_block  0.4060068130493164
generate_one_block  0.3434023857116699
generate_one_block  0.37316131591796875
generate_one_block  0.37717294692993164
generate_one_block  0.39243388175964355
generate_one_block  0.42936182022094727
generate_one_block  0.18002557754516602
generate_one_block  0.29819607734680176
generate_one_block  0.2788534164428711
generate_one_block  0.350039005279541
generate_one_block  0.2257225513458252
generate_one_block  0.3156163692474365
generate_one_block  0.20674705505371094
generate_one_block  0.23902392387390137
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

connection checking time:  13.80510687828064
block generation total time  11.316840410232544
average batch blocks generation time:  0.1768256314098835
block dataloader generation time/epoch 44.83814215660095
pseudo mini batch 0 input nodes size: 133201
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.0657501220703125  GigaBytes
Max Memory Allocated: 0.0657501220703125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06579160690307617  GigaBytes
Max Memory Allocated: 0.06579160690307617  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0819091796875 GB
    Memory Allocated: 0.06579160690307617  GigaBytes
Max Memory Allocated: 0.06579160690307617  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.0743107795715332  GigaBytes
Max Memory Allocated: 0.0743107795715332  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.0743107795715332  GigaBytes
Max Memory Allocated: 0.0743107795715332  GigaBytes

first layer input nodes number: 133201
first layer output nodes number: 91453
edges number: 671299
----------------------------------------before model layer 0
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.07598495483398438  GigaBytes
Max Memory Allocated: 0.07848596572875977  GigaBytes

torch.Size([133201, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1678466796875 GB
    Memory Allocated: 0.07598495483398438  GigaBytes
Max Memory Allocated: 0.07848596572875977  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5799560546875 GB
    Memory Allocated: 0.21282672882080078  GigaBytes
Max Memory Allocated: 0.21282672882080078  GigaBytes

torch.Size([91453, 256])
torch.Size([91453, 256])
----------------------------------------after rst
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.3007173538208008  GigaBytes
Max Memory Allocated: 0.3886079788208008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.21282672882080078  GigaBytes
Max Memory Allocated: 0.3886079788208008  GigaBytes

torch.Size([91453, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.3007173538208008  GigaBytes
Max Memory Allocated: 0.3886079788208008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.3225216865539551  GigaBytes
Max Memory Allocated: 0.4104123115539551  GigaBytes

input nodes number: 91453
output nodes number: 31815
edges number: 350817
----------------------------------------before model layer 1
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.3234405517578125  GigaBytes
Max Memory Allocated: 0.4104123115539551  GigaBytes

torch.Size([91453, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.3234405517578125  GigaBytes
Max Memory Allocated: 0.4104123115539551  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.3869810104370117  GigaBytes
Max Memory Allocated: 0.4104123115539551  GigaBytes

torch.Size([31815, 256])
torch.Size([31815, 256])
----------------------------------------after rst
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.4182310104370117  GigaBytes
Max Memory Allocated: 0.4494810104370117  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.3878898620605469  GigaBytes
Max Memory Allocated: 0.4494810104370117  GigaBytes

torch.Size([31815, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.4182310104370117  GigaBytes
Max Memory Allocated: 0.4494810104370117  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.4267253875732422  GigaBytes
Max Memory Allocated: 0.45706653594970703  GigaBytes

input nodes number: 31815
output nodes number: 11764
edges number: 88795
----------------------------------------before model layer 2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.4270505905151367  GigaBytes
Max Memory Allocated: 0.45706653594970703  GigaBytes

torch.Size([31815, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.4270505905151367  GigaBytes
Max Memory Allocated: 0.45706653594970703  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.45091772079467773  GigaBytes
Max Memory Allocated: 0.45706653594970703  GigaBytes

torch.Size([11764, 256])
torch.Size([11764, 256])
----------------------------------------after rst
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.46213674545288086  GigaBytes
Max Memory Allocated: 0.47408246994018555  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.4502382278442383  GigaBytes
Max Memory Allocated: 0.47408246994018555  GigaBytes

torch.Size([11764, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.46213674545288086  GigaBytes
Max Memory Allocated: 0.47408246994018555  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.46498870849609375  GigaBytes
Max Memory Allocated: 0.47688722610473633  GigaBytes

----------------input nodes number: 11764
----------------output nodes number: 5522
----------------edges number: 32260
----------------------------------------before mean aggregator
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.4651179313659668  GigaBytes
Max Memory Allocated: 0.47688722610473633  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.8201904296875 GB
    Memory Allocated: 0.47149038314819336  GigaBytes
Max Memory Allocated: 0.47688722610473633  GigaBytes

torch.Size([5522, 40])
torch.Size([5522, 40])
----------------------------------------after rst
 Nvidia-smi: 1.8221435546875 GB
    Memory Allocated: 0.47231340408325195  GigaBytes
Max Memory Allocated: 0.47688722610473633  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.8221435546875 GB
    Memory Allocated: 0.47149038314819336  GigaBytes
Max Memory Allocated: 0.47688722610473633  GigaBytes

torch.Size([5522, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8221435546875 GB
    Memory Allocated: 0.47231340408325195  GigaBytes
Max Memory Allocated: 0.47688722610473633  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8221435546875 GB
    Memory Allocated: 0.47313737869262695  GigaBytes
Max Memory Allocated: 0.47688722610473633  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0623779296875 GB
    Memory Allocated: 0.09255027770996094  GigaBytes
Max Memory Allocated: 0.5092811584472656  GigaBytes

pseudo mini batch 1 input nodes size: 141871
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0623779296875 GB
    Memory Allocated: 0.06791257858276367  GigaBytes
Max Memory Allocated: 0.5092811584472656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0623779296875 GB
    Memory Allocated: 0.06791257858276367  GigaBytes
Max Memory Allocated: 0.5092811584472656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.0623779296875 GB
    Memory Allocated: 0.13556194305419922  GigaBytes
Max Memory Allocated: 0.5092811584472656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.0623779296875 GB
    Memory Allocated: 0.1356034278869629  GigaBytes
Max Memory Allocated: 0.5092811584472656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.0623779296875 GB
    Memory Allocated: 0.07110881805419922  GigaBytes
Max Memory Allocated: 0.5092811584472656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.0623779296875 GB
    Memory Allocated: 0.0828390121459961  GigaBytes
Max Memory Allocated: 0.5092811584472656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.0623779296875 GB
    Memory Allocated: 0.0828390121459961  GigaBytes
Max Memory Allocated: 0.5092811584472656  GigaBytes

first layer input nodes number: 141871
first layer output nodes number: 110796
edges number: 804983
----------------------------------------before model layer 0
 Nvidia-smi: 2.0623779296875 GB
    Memory Allocated: 0.08472204208374023  GigaBytes
Max Memory Allocated: 0.5092811584472656  GigaBytes

torch.Size([141871, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.0623779296875 GB
    Memory Allocated: 0.08472204208374023  GigaBytes
Max Memory Allocated: 0.5092811584472656  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.24962759017944336  GigaBytes
Max Memory Allocated: 0.5092811584472656  GigaBytes

torch.Size([110796, 256])
torch.Size([110796, 256])
----------------------------------------after rst
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 0.35529088973999023  GigaBytes
Max Memory Allocated: 0.5092811584472656  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 0.24962759017944336  GigaBytes
Max Memory Allocated: 0.5092811584472656  GigaBytes

torch.Size([110796, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 0.35529088973999023  GigaBytes
Max Memory Allocated: 0.5092811584472656  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 0.38170671463012695  GigaBytes
Max Memory Allocated: 0.5092811584472656  GigaBytes

input nodes number: 110796
output nodes number: 48184
edges number: 569452
----------------------------------------before model layer 1
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 0.3828916549682617  GigaBytes
Max Memory Allocated: 0.5092811584472656  GigaBytes

torch.Size([110796, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 0.3828916549682617  GigaBytes
Max Memory Allocated: 0.5092811584472656  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 0.47951221466064453  GigaBytes
Max Memory Allocated: 0.5092811584472656  GigaBytes

torch.Size([48184, 256])
torch.Size([48184, 256])
----------------------------------------after rst
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 0.5254640579223633  GigaBytes
Max Memory Allocated: 0.571415901184082  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 0.47951221466064453  GigaBytes
Max Memory Allocated: 0.571415901184082  GigaBytes

torch.Size([48184, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 0.5254640579223633  GigaBytes
Max Memory Allocated: 0.571415901184082  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 0.536952018737793  GigaBytes
Max Memory Allocated: 0.5829038619995117  GigaBytes

input nodes number: 48184
output nodes number: 16194
edges number: 160589
----------------------------------------before model layer 2
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 0.5374321937561035  GigaBytes
Max Memory Allocated: 0.5829038619995117  GigaBytes

torch.Size([48184, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 0.5374321937561035  GigaBytes
Max Memory Allocated: 0.5829038619995117  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 0.5696377754211426  GigaBytes
Max Memory Allocated: 0.5829038619995117  GigaBytes

torch.Size([16194, 256])
torch.Size([16194, 256])
----------------------------------------after rst
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 0.5850815773010254  GigaBytes
Max Memory Allocated: 0.6005253791809082  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 0.5696377754211426  GigaBytes
Max Memory Allocated: 0.6005253791809082  GigaBytes

torch.Size([16194, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 0.5854439735412598  GigaBytes
Max Memory Allocated: 0.6005253791809082  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 0.5891118049621582  GigaBytes
Max Memory Allocated: 0.6049180030822754  GigaBytes

----------------input nodes number: 16194
----------------output nodes number: 5517
----------------edges number: 39185
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3944091796875 GB
    Memory Allocated: 0.5892744064331055  GigaBytes
Max Memory Allocated: 0.6049180030822754  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3963623046875 GB
    Memory Allocated: 0.5956931114196777  GigaBytes
Max Memory Allocated: 0.6049180030822754  GigaBytes

torch.Size([5517, 40])
torch.Size([5517, 40])
----------------------------------------after rst
 Nvidia-smi: 2.3983154296875 GB
    Memory Allocated: 0.5965156555175781  GigaBytes
Max Memory Allocated: 0.6049180030822754  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.3983154296875 GB
    Memory Allocated: 0.5956931114196777  GigaBytes
Max Memory Allocated: 0.6049180030822754  GigaBytes

torch.Size([5517, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3983154296875 GB
    Memory Allocated: 0.5956926345825195  GigaBytes
Max Memory Allocated: 0.6049180030822754  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3983154296875 GB
    Memory Allocated: 0.5965156555175781  GigaBytes
Max Memory Allocated: 0.6049180030822754  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.10671329498291016  GigaBytes
Max Memory Allocated: 0.6327996253967285  GigaBytes

pseudo mini batch 2 input nodes size: 148671
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.07110834121704102  GigaBytes
Max Memory Allocated: 0.6327996253967285  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.07110834121704102  GigaBytes
Max Memory Allocated: 0.6327996253967285  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.1420001983642578  GigaBytes
Max Memory Allocated: 0.6327996253967285  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.14204168319702148  GigaBytes
Max Memory Allocated: 0.6327996253967285  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.07435083389282227  GigaBytes
Max Memory Allocated: 0.6327996253967285  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.09348678588867188  GigaBytes
Max Memory Allocated: 0.6327996253967285  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.09348678588867188  GigaBytes
Max Memory Allocated: 0.6327996253967285  GigaBytes

first layer input nodes number: 148671
first layer output nodes number: 126546
edges number: 907642
----------------------------------------before model layer 0
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.09553766250610352  GigaBytes
Max Memory Allocated: 0.6327996253967285  GigaBytes

torch.Size([148671, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.6326904296875 GB
    Memory Allocated: 0.09553766250610352  GigaBytes
Max Memory Allocated: 0.6327996253967285  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7596435546875 GB
    Memory Allocated: 0.28493738174438477  GigaBytes
Max Memory Allocated: 0.6327996253967285  GigaBytes

torch.Size([126546, 256])
torch.Size([126546, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.40603113174438477  GigaBytes
Max Memory Allocated: 0.6327996253967285  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.28493738174438477  GigaBytes
Max Memory Allocated: 0.6327996253967285  GigaBytes

torch.Size([126546, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.40603113174438477  GigaBytes
Max Memory Allocated: 0.6327996253967285  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.4362020492553711  GigaBytes
Max Memory Allocated: 0.6327996253967285  GigaBytes

input nodes number: 126546
output nodes number: 78540
edges number: 1062829
----------------------------------------before model layer 1
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.4377307891845703  GigaBytes
Max Memory Allocated: 0.6327996253967285  GigaBytes

torch.Size([126546, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0018310546875 GB
    Memory Allocated: 0.4377307891845703  GigaBytes
Max Memory Allocated: 0.6327996253967285  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 0.596038818359375  GigaBytes
Max Memory Allocated: 0.6327996253967285  GigaBytes

torch.Size([78540, 256])
torch.Size([78540, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 0.6709403991699219  GigaBytes
Max Memory Allocated: 0.7458419799804688  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 0.596038818359375  GigaBytes
Max Memory Allocated: 0.7458419799804688  GigaBytes

torch.Size([78540, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 0.6709403991699219  GigaBytes
Max Memory Allocated: 0.7458419799804688  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 0.6904716491699219  GigaBytes
Max Memory Allocated: 0.7653732299804688  GigaBytes

input nodes number: 78540
output nodes number: 28438
edges number: 441830
----------------------------------------before model layer 2
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 0.6912693977355957  GigaBytes
Max Memory Allocated: 0.7653732299804688  GigaBytes

torch.Size([78540, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 0.6912693977355957  GigaBytes
Max Memory Allocated: 0.7653732299804688  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 0.749443531036377  GigaBytes
Max Memory Allocated: 0.7653732299804688  GigaBytes

torch.Size([28438, 256])
torch.Size([28438, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 0.7765641212463379  GigaBytes
Max Memory Allocated: 0.8036847114562988  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 0.7490153312683105  GigaBytes
Max Memory Allocated: 0.8036847114562988  GigaBytes

torch.Size([28438, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 0.7765641212463379  GigaBytes
Max Memory Allocated: 0.8036847114562988  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 0.7829160690307617  GigaBytes
Max Memory Allocated: 0.8104648590087891  GigaBytes

----------------input nodes number: 28438
----------------output nodes number: 5517
----------------edges number: 65900
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 0.7831697463989258  GigaBytes
Max Memory Allocated: 0.8104648590087891  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 0.7907342910766602  GigaBytes
Max Memory Allocated: 0.8104648590087891  GigaBytes

torch.Size([5517, 40])
torch.Size([5517, 40])
----------------------------------------after rst
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 0.7915568351745605  GigaBytes
Max Memory Allocated: 0.8104648590087891  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 0.7907342910766602  GigaBytes
Max Memory Allocated: 0.8104648590087891  GigaBytes

torch.Size([5517, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 0.7907342910766602  GigaBytes
Max Memory Allocated: 0.8104648590087891  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0174560546875 GB
    Memory Allocated: 0.7915573120117188  GigaBytes
Max Memory Allocated: 0.8104648590087891  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.13090944290161133  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

pseudo mini batch 3 input nodes size: 132991
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.07435083389282227  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.07435083389282227  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.13776588439941406  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.13780879974365234  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.06687545776367188  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.07951068878173828  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.07951068878173828  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

first layer input nodes number: 132991
first layer output nodes number: 102057
edges number: 761941
----------------------------------------before model layer 0
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.08130931854248047  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([132991, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.08130931854248047  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.23336076736450195  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([102057, 256])
torch.Size([102057, 256])
----------------------------------------after rst
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.3306899070739746  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.23336076736450195  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([102057, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.3306899070739746  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.3550224304199219  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

input nodes number: 102057
output nodes number: 50920
edges number: 675595
----------------------------------------before model layer 1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.35616254806518555  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([102057, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.35616254806518555  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.4593238830566406  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([50920, 256])
torch.Size([50920, 256])
----------------------------------------after rst
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5078849792480469  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.4593238830566406  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([50920, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5078849792480469  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5200252532958984  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

input nodes number: 50920
output nodes number: 17952
edges number: 213319
----------------------------------------before model layer 2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5205388069152832  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([50920, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5205388069152832  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5565037727355957  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([17952, 256])
torch.Size([17952, 256])
----------------------------------------after rst
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5736241340637207  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5565037727355957  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([17952, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5736241340637207  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5780243873596191  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------input nodes number: 17952
----------------output nodes number: 5747
----------------edges number: 44795
----------------------------------------before mean aggregator
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5782012939453125  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5849151611328125  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([5747, 40])
torch.Size([5747, 40])
----------------------------------------after rst
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5857715606689453  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5849151611328125  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([5747, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5849490165710449  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5858058929443359  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.10471296310424805  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

pseudo mini batch 4 input nodes size: 129786
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.0669093132019043  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.0669093132019043  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.12879610061645508  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.12883996963500977  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.06538200378417969  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.08351898193359375  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.08351898193359375  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

first layer input nodes number: 129786
first layer output nodes number: 103075
edges number: 775093
----------------------------------------before model layer 0
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.08525419235229492  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([129786, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.08525419235229492  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.23886394500732422  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([103075, 256])
torch.Size([103075, 256])
----------------------------------------after rst
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.33716392517089844  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.23886394500732422  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([103075, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.33716392517089844  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.3617391586303711  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

input nodes number: 103075
output nodes number: 67088
edges number: 962741
----------------------------------------before model layer 1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.3630075454711914  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([103075, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.3630075454711914  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.4986419677734375  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([67088, 256])
torch.Size([67088, 256])
----------------------------------------after rst
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5626220703125  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.4986419677734375  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([67088, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5626220703125  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5786170959472656  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

input nodes number: 67088
output nodes number: 32958
edges number: 593620
----------------------------------------before model layer 2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5793628692626953  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([67088, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5793628692626953  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6471700668334961  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([32958, 256])
torch.Size([32958, 256])
----------------------------------------after rst
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6786012649536133  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6471700668334961  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([32958, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6786012649536133  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6864590644836426  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------input nodes number: 32958
----------------output nodes number: 5854
----------------edges number: 102647
----------------------------------------before mean aggregator
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6867485046386719  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6940126419067383  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([5854, 40])
torch.Size([5854, 40])
----------------------------------------after rst
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.69488525390625  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6940126419067383  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([5854, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6940288543701172  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6949019432067871  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.11988544464111328  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

pseudo mini batch 5 input nodes size: 138563
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.0653982162475586  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.0653982162475586  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.1314702033996582  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.13151168823242188  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.0695810317993164  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.08705520629882812  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.08705520629882812  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

first layer input nodes number: 138563
first layer output nodes number: 111208
edges number: 818226
----------------------------------------before model layer 0
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.08891677856445312  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([138563, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.08891677856445312  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.25451231002807617  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([111208, 256])
torch.Size([111208, 256])
----------------------------------------after rst
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.3605685234069824  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.25451231002807617  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([111208, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.3605685234069824  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.387082576751709  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

input nodes number: 111208
output nodes number: 69210
edges number: 970700
----------------------------------------before model layer 1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.3884272575378418  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([111208, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.3884272575378418  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5281834602355957  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([69210, 256])
torch.Size([69210, 256])
----------------------------------------after rst
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5941872596740723  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5281834602355957  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([69210, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5941872596740723  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6106882095336914  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

input nodes number: 69210
output nodes number: 28789
edges number: 486963
----------------------------------------before model layer 2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6114187240600586  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([69210, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6114187240600586  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6701726913452148  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([28789, 256])
torch.Size([28789, 256])
----------------------------------------after rst
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6976280212402344  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6701726913452148  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([28789, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6976280212402344  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.7050352096557617  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------input nodes number: 28789
----------------output nodes number: 5517
----------------edges number: 69238
----------------------------------------before mean aggregator
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.7052912712097168  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.7119331359863281  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([5517, 40])
torch.Size([5517, 40])
----------------------------------------after rst
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.7127556800842285  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.7119331359863281  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([5517, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.7118830680847168  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.7127060890197754  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.121795654296875  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

pseudo mini batch 6 input nodes size: 145013
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.06953096389770508  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.06953096389770508  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.13867855072021484  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.13872003555297852  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.07260656356811523  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.09183979034423828  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.09183979034423828  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

first layer input nodes number: 145013
first layer output nodes number: 120856
edges number: 869175
----------------------------------------before model layer 0
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.09382104873657227  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([145013, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.09382104873657227  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.27398204803466797  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([120856, 256])
torch.Size([120856, 256])
----------------------------------------after rst
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.3892393112182617  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.27398204803466797  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([120856, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.3892393112182617  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.41805362701416016  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

input nodes number: 120856
output nodes number: 78825
edges number: 1064091
----------------------------------------before model layer 1
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.4195418357849121  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([120856, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.4195418357849121  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5784049034118652  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([78825, 256])
torch.Size([78825, 256])
----------------------------------------after rst
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6535782814025879  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.5784049034118652  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([78825, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6535782814025879  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6731095314025879  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

input nodes number: 78825
output nodes number: 31394
edges number: 506752
----------------------------------------before model layer 2
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6739311218261719  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([78825, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.6739311218261719  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.7378206253051758  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([31394, 256])
torch.Size([31394, 256])
----------------------------------------after rst
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.7677602767944336  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.7378206253051758  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([31394, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.7677602767944336  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.7753114700317383  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------input nodes number: 31394
----------------output nodes number: 5518
----------------edges number: 65741
----------------------------------------before mean aggregator
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.7755870819091797  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.7822041511535645  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([5518, 40])
torch.Size([5518, 40])
----------------------------------------after rst
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.7830266952514648  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.7822041511535645  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([5518, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.7822041511535645  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.783027172088623  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.1293644905090332  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

pseudo mini batch 7 input nodes size: 150409
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.07260656356811523  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.07260656356811523  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.14432716369628906  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.14436864852905273  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.0751795768737793  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.0947275161743164  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.0947275161743164  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

first layer input nodes number: 150409
first layer output nodes number: 130361
edges number: 928953
----------------------------------------before model layer 0
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.09681987762451172  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([150409, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.1522216796875 GB
    Memory Allocated: 0.09681987762451172  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2772216796875 GB
    Memory Allocated: 0.29138851165771484  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([130361, 256])
torch.Size([130361, 256])
----------------------------------------after rst
 Nvidia-smi: 3.5272216796875 GB
    Memory Allocated: 0.41638851165771484  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.5272216796875 GB
    Memory Allocated: 0.29138851165771484  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([130361, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.5272216796875 GB
    Memory Allocated: 0.41638851165771484  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.5272216796875 GB
    Memory Allocated: 0.44763851165771484  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

input nodes number: 130361
output nodes number: 82825
edges number: 1117768
----------------------------------------before model layer 1
 Nvidia-smi: 3.5272216796875 GB
    Memory Allocated: 0.44922733306884766  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([130361, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.5272216796875 GB
    Memory Allocated: 0.44922733306884766  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 0.6167240142822266  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([82825, 256])
torch.Size([82825, 256])
----------------------------------------after rst
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 0.6957120895385742  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 0.6167240142822266  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([82825, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 0.6957120895385742  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 0.7154593467712402  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

input nodes number: 82825
output nodes number: 26911
edges number: 404825
----------------------------------------before model layer 2
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 0.7162775993347168  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([82825, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 0.7162775993347168  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 0.771543025970459  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([26911, 256])
torch.Size([26911, 256])
----------------------------------------after rst
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 0.7972073554992676  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 0.771543025970459  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([26911, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 0.7972073554992676  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 0.8036236763000488  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------input nodes number: 26911
----------------output nodes number: 5520
----------------edges number: 48466
----------------------------------------before mean aggregator
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 0.803865909576416  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 0.8106775283813477  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([5520, 40])
torch.Size([5520, 40])
----------------------------------------after rst
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 0.811500072479248  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 0.8106775283813477  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

torch.Size([5520, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 0.8106775283813477  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.5311279296875 GB
    Memory Allocated: 0.8115005493164062  GigaBytes
Max Memory Allocated: 0.8495512008666992  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.1332693099975586  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

pseudo mini batch 8 input nodes size: 103313
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.0751795768737793  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.0751795768737793  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.12444305419921875  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.12448692321777344  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.05272483825683594  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.05801868438720703  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.05801868438720703  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

first layer input nodes number: 103313
first layer output nodes number: 57437
edges number: 402163
----------------------------------------before model layer 0
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.059216976165771484  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([103313, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.059216976165771484  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.14545726776123047  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([57437, 256])
torch.Size([57437, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.20023345947265625  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.14545726776123047  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([57437, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.20023345947265625  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.2139277458190918  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

input nodes number: 57437
output nodes number: 21962
edges number: 196979
----------------------------------------before model layer 1
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.21451997756958008  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([57437, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.21451997756958008  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.2580409049987793  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([21962, 256])
torch.Size([21962, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.27898550033569336  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.2580409049987793  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([21962, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.27898550033569336  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.2848224639892578  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

input nodes number: 21962
output nodes number: 10716
edges number: 74476
----------------------------------------before model layer 2
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.2850666046142578  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([21962, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.2850666046142578  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.3062267303466797  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([10716, 256])
torch.Size([10716, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.31644630432128906  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.3061408996582031  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([10716, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.31644630432128906  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.31891536712646484  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------input nodes number: 10716
----------------output nodes number: 5854
----------------edges number: 36841
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.31903934478759766  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.32581329345703125  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([5854, 40])
torch.Size([5854, 40])
----------------------------------------after rst
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.32668590545654297  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.32581329345703125  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([5854, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.3258633613586426  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6600341796875 GB
    Memory Allocated: 0.3267364501953125  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.06937837600708008  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

pseudo mini batch 9 input nodes size: 132568
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.052774906158447266  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.052774906158447266  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.11598825454711914  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.11603212356567383  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.06672477722167969  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.07555866241455078  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.07555866241455078  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

first layer input nodes number: 132568
first layer output nodes number: 91323
edges number: 660621
----------------------------------------before model layer 0
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.07722711563110352  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([132568, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.07722711563110352  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.2139272689819336  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([91323, 256])
torch.Size([91323, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.3018178939819336  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.2139272689819336  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([91323, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.3018178939819336  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.3235912322998047  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

input nodes number: 91323
output nodes number: 34412
edges number: 359882
----------------------------------------before model layer 1
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.32452821731567383  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([91323, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.32452821731567383  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.39313697814941406  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([34412, 256])
torch.Size([34412, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.42595481872558594  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.39313697814941406  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([34412, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.42595481872558594  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.4341592788696289  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

input nodes number: 34412
output nodes number: 13464
edges number: 118272
----------------------------------------before model layer 2
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.43451642990112305  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([34412, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.43451642990112305  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.461179256439209  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([13464, 256])
torch.Size([13464, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.47401952743530273  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.461179256439209  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([13464, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.47401952743530273  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.4779191017150879  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------input nodes number: 13464
----------------output nodes number: 5854
----------------edges number: 46639
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.47806358337402344  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.4849109649658203  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([5854, 40])
torch.Size([5854, 40])
----------------------------------------after rst
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.48578357696533203  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.4849109649658203  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([5854, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.4849109649658203  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.48578405380249023  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.0927281379699707  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

pseudo mini batch 10 input nodes size: 128253
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.06672477722167969  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.06672477722167969  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.12788057327270508  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.12792396545410156  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.064666748046875  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.0726938247680664  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.0726938247680664  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

first layer input nodes number: 128253
first layer output nodes number: 85028
edges number: 611598
----------------------------------------before model layer 0
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.07428312301635742  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([128253, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.07428312301635742  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.2007913589477539  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([85028, 256])
torch.Size([85028, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.28188037872314453  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.2007913589477539  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([85028, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.28188037872314453  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.3021526336669922  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

input nodes number: 85028
output nodes number: 31197
edges number: 324588
----------------------------------------before model layer 1
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.30301904678344727  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([85028, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.30301904678344727  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.3663520812988281  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([31197, 256])
torch.Size([31197, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.3961038589477539  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.3663520812988281  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([31197, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.3961038589477539  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.40354204177856445  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

input nodes number: 31197
output nodes number: 12296
edges number: 100932
----------------------------------------before model layer 2
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.4038667678833008  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([31197, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.4038667678833008  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.42899322509765625  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([12296, 256])
torch.Size([12296, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.4407196044921875  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.4281644821166992  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([12296, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.43989086151123047  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.4440741539001465  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------input nodes number: 12296
----------------output nodes number: 5813
----------------edges number: 39990
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.44420957565307617  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.4509620666503906  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([5813, 40])
torch.Size([5813, 40])
----------------------------------------after rst
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.4518284797668457  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.4509620666503906  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([5813, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.450955867767334  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.45182275772094727  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.08925962448120117  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

pseudo mini batch 11 input nodes size: 136383
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.06466054916381836  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.06466054916381836  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.12969303131103516  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.12973690032958984  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.06853771209716797  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.07988166809082031  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.07988166809082031  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

first layer input nodes number: 136383
first layer output nodes number: 104347
edges number: 781647
----------------------------------------before model layer 0
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.08167552947998047  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([136383, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.08167552947998047  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.23715829849243164  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([104347, 256])
torch.Size([104347, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.3366713523864746  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.23715829849243164  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([104347, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.3366713523864746  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.36154985427856445  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

input nodes number: 104347
output nodes number: 42567
edges number: 532562
----------------------------------------before model layer 1
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.36264514923095703  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([104347, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.36264514923095703  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.44903564453125  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([42567, 256])
torch.Size([42567, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.48963069915771484  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.44903564453125  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([42567, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.48963069915771484  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.49977970123291016  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

input nodes number: 42567
output nodes number: 14186
edges number: 153389
----------------------------------------before model layer 2
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.5002031326293945  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([42567, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.5002031326293945  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.5285100936889648  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([14186, 256])
torch.Size([14186, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.5420389175415039  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.5285100936889648  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([14186, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.5420389175415039  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.5462312698364258  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------input nodes number: 14186
----------------output nodes number: 5854
----------------edges number: 54718
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.5463809967041016  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.553288459777832  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([5854, 40])
torch.Size([5854, 40])
----------------------------------------after rst
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.5541610717773438  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.553288459777832  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([5854, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.5532946586608887  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.5541677474975586  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.10271072387695312  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

pseudo mini batch 12 input nodes size: 97942
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.06854391098022461  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.06854391098022461  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.11524629592895508  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.11528968811035156  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.05021333694458008  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.05645418167114258  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.05645418167114258  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

first layer input nodes number: 97942
first layer output nodes number: 56034
edges number: 408721
----------------------------------------before model layer 0
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.0576019287109375  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([97942, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.0576019287109375  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.14101409912109375  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([56034, 256])
torch.Size([56034, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.19445228576660156  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.14101409912109375  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([56034, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.19445228576660156  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.20781183242797852  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

input nodes number: 56034
output nodes number: 23717
edges number: 258843
----------------------------------------before model layer 1
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.2084064483642578  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([56034, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.2084064483642578  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.2557497024536133  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([23717, 256])
torch.Size([23717, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.2783679962158203  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.2557497024536133  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([23717, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.2783679962158203  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.28402280807495117  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

input nodes number: 23717
output nodes number: 10796
edges number: 112487
----------------------------------------before model layer 2
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.28428030014038086  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([23717, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.28428030014038086  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.30579137802124023  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([10796, 256])
torch.Size([10796, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.3160872459411621  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.30579137802124023  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([10796, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.3160872459411621  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.3190641403198242  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------input nodes number: 10796
----------------output nodes number: 5791
----------------edges number: 57255
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.31918811798095703  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.32604503631591797  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([5791, 40])
torch.Size([5791, 40])
----------------------------------------after rst
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.3269081115722656  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.32604503631591797  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([5791, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.3260354995727539  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6619873046875 GB
    Memory Allocated: 0.32689905166625977  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.06870222091674805  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

pseudo mini batch 13 input nodes size: 130787
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.050203800201416016  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.050203800201416016  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.11256790161132812  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.1126103401184082  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.06586456298828125  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.07516002655029297  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.07516002655029297  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

first layer input nodes number: 130787
first layer output nodes number: 91414
edges number: 678665
----------------------------------------before model layer 0
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.07681608200073242  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([130787, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.07681608200073242  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.21369457244873047  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([91414, 256])
torch.Size([91414, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.30158519744873047  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.21369457244873047  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([91414, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.30158519744873047  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.3233799934387207  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

input nodes number: 91414
output nodes number: 34698
edges number: 394872
----------------------------------------before model layer 1
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.32432031631469727  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([91414, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.32432031631469727  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.39429330825805664  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([34698, 256])
torch.Size([34698, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.4273838996887207  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.39429330825805664  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([34698, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.4273838996887207  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.4356565475463867  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

input nodes number: 34698
output nodes number: 12804
edges number: 124319
----------------------------------------before model layer 2
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.43601131439208984  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([34698, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.43601131439208984  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.461456298828125  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([12804, 256])
torch.Size([12804, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.4736671447753906  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.461456298828125  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([12804, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.4736671447753906  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.47722578048706055  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------input nodes number: 12804
----------------output nodes number: 5689
----------------edges number: 49462
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.47736406326293945  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.48404932022094727  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([5689, 40])
torch.Size([5689, 40])
----------------------------------------after rst
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.4848971366882324  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.48404932022094727  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([5689, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.48403406143188477  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.4848823547363281  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.09341716766357422  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

pseudo mini batch 14 input nodes size: 107779
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.06584930419921875  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.06584930419921875  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.11724233627319336  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.11728620529174805  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.05487966537475586  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.06178426742553711  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.06178426742553711  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

first layer input nodes number: 107779
first layer output nodes number: 63187
edges number: 463474
----------------------------------------before model layer 0
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.06305885314941406  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([107779, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.06305885314941406  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.15713739395141602  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([63187, 256])
torch.Size([63187, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.21739721298217773  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.15713739395141602  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([63187, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.21739721298217773  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.23246240615844727  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

input nodes number: 63187
output nodes number: 26004
edges number: 273589
----------------------------------------before model layer 1
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.23312759399414062  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([63187, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.23312759399414062  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.28506040573120117  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([26004, 256])
torch.Size([26004, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.3098597526550293  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.28506040573120117  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([26004, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.3098597526550293  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.31631040573120117  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

input nodes number: 26004
output nodes number: 13012
edges number: 132149
----------------------------------------before model layer 2
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.3166017532348633  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([26004, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.3166017532348633  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.3425025939941406  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([13012, 256])
torch.Size([13012, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.35491180419921875  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.3425025939941406  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([13012, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.35491180419921875  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.3580141067504883  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------input nodes number: 13012
----------------output nodes number: 5854
----------------edges number: 57332
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.3581552505493164  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.365081787109375  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([5854, 40])
torch.Size([5854, 40])
----------------------------------------after rst
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.3659543991088867  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.365081787109375  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([5854, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.36510658264160156  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.3659796714782715  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.07621526718139648  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

pseudo mini batch 15 input nodes size: 120169
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.05490446090698242  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.05490446090698242  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.11220550537109375  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.11224699020385742  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.060810089111328125  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.06780052185058594  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.06780052185058594  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

first layer input nodes number: 120169
first layer output nodes number: 73771
edges number: 522537
----------------------------------------before model layer 0
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.06924581527709961  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([120169, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.06924581527709961  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.17894506454467773  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([73771, 256])
torch.Size([73771, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.2492985725402832  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.17894506454467773  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([73771, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.2492985725402832  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.26688718795776367  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

input nodes number: 73771
output nodes number: 28540
edges number: 285071
----------------------------------------before model layer 1
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.26764965057373047  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([73771, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.26764965057373047  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.3249626159667969  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([28540, 256])
torch.Size([28540, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.35218048095703125  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.3249626159667969  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([28540, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.35218048095703125  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.35898494720458984  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

input nodes number: 28540
output nodes number: 11538
edges number: 94516
----------------------------------------before model layer 2
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.3592839241027832  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([28540, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.3592839241027832  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.382082462310791  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([11538, 256])
torch.Size([11538, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.39308595657348633  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.382082462310791  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([11538, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.39308595657348633  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.396026611328125  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------input nodes number: 11538
----------------output nodes number: 5520
----------------edges number: 35810
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.39615440368652344  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.40255022048950195  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([5520, 40])
torch.Size([5520, 40])
----------------------------------------after rst
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.40337276458740234  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.40255022048950195  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

torch.Size([5520, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.4025001525878906  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.4033231735229492  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.0827627182006836  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.0853567123413086  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.6639404296875 GB
    Memory Allocated: 0.0853567123413086  GigaBytes
Max Memory Allocated: 0.882502555847168  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.026535049080848694 |0.03469642996788025 |0.06652665138244629 |0.00014869868755340576 |0.00667966902256012 |0.001863241195678711 |
----------------------------------------------------------pseudo_mini_loss sum 6.485284328460693
Total (block generation + training)time/epoch 47.04495167732239
Training time/epoch 2.2064919471740723
Training time without block to device /epoch 1.6513490676879883
Training time without total dataloading part /epoch 1.1755435466766357
load block tensor time/epoch 0.4245607852935791
block to device time/epoch 0.555142879486084
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  4640308
Number of first layer input nodes during this epoch:  2077699
Number of first layer output nodes during this epoch:  1518893
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  348160
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([40, 256])
layers.3.fc_neigh.weight, torch.Size([40, 256])
----------------------------------------
un-trainable parameters
