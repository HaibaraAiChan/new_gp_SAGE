main start at this time 1657072011.1685238
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.025802135467529297
number of batches is  8
batch size is  11368
random selection method spend 0.0069391727447509766
time for parepare:  0.018289566040039062
local_output_nid generation:  0.004230976104736328
local_in_edges_tensor generation:  0.006447792053222656
mini_batch_src_global generation:  0.0029981136322021484
r_  generation:  0.03454446792602539
local_output_nid generation:  0.005501270294189453
local_in_edges_tensor generation:  0.003157377243041992
mini_batch_src_global generation:  0.003834962844848633
r_  generation:  0.03487038612365723
local_output_nid generation:  0.00585174560546875
local_in_edges_tensor generation:  0.003007650375366211
mini_batch_src_global generation:  0.0026154518127441406
r_  generation:  0.037367820739746094
local_output_nid generation:  0.006169795989990234
local_in_edges_tensor generation:  0.0030715465545654297
mini_batch_src_global generation:  0.0027647018432617188
r_  generation:  0.03736162185668945
local_output_nid generation:  0.005945444107055664
local_in_edges_tensor generation:  0.0030012130737304688
mini_batch_src_global generation:  0.0027778148651123047
r_  generation:  0.03654789924621582
local_output_nid generation:  0.005884408950805664
local_in_edges_tensor generation:  0.0029211044311523438
mini_batch_src_global generation:  0.0030219554901123047
r_  generation:  0.037752628326416016
local_output_nid generation:  0.006134033203125
local_in_edges_tensor generation:  0.0029942989349365234
mini_batch_src_global generation:  0.002933025360107422
r_  generation:  0.037606000900268555
local_output_nid generation:  0.00589752197265625
local_in_edges_tensor generation:  0.002979755401611328
mini_batch_src_global generation:  0.0029706954956054688
r_  generation:  0.03755307197570801
----------------------check_connections_block total spend ----------------------------- 0.4798147678375244
generate_one_block  0.05065512657165527
generate_one_block  0.051311492919921875
generate_one_block  0.05471467971801758
generate_one_block  0.051749229431152344
generate_one_block  0.050739288330078125
generate_one_block  0.052515506744384766
generate_one_block  0.05128931999206543
generate_one_block  0.05144190788269043
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033357858657836914
gen group dst list time:  0.014249563217163086
time for parepare:  0.018759727478027344
local_output_nid generation:  0.011980056762695312
local_in_edges_tensor generation:  0.027289867401123047
mini_batch_src_global generation:  0.022392988204956055
r_  generation:  0.24010920524597168
local_output_nid generation:  0.017707347869873047
local_in_edges_tensor generation:  0.026383638381958008
mini_batch_src_global generation:  0.029412031173706055
r_  generation:  0.25251269340515137
local_output_nid generation:  0.016906261444091797
local_in_edges_tensor generation:  0.01972651481628418
mini_batch_src_global generation:  0.02930474281311035
r_  generation:  0.26067399978637695
local_output_nid generation:  0.016645431518554688
local_in_edges_tensor generation:  0.021497011184692383
mini_batch_src_global generation:  0.030839920043945312
r_  generation:  0.25746917724609375
local_output_nid generation:  0.01697254180908203
local_in_edges_tensor generation:  0.017134904861450195
mini_batch_src_global generation:  0.031511545181274414
r_  generation:  0.2647054195404053
local_output_nid generation:  0.017033815383911133
local_in_edges_tensor generation:  0.02187061309814453
mini_batch_src_global generation:  0.031165361404418945
r_  generation:  0.26849913597106934
local_output_nid generation:  0.01705789566040039
local_in_edges_tensor generation:  0.022012710571289062
mini_batch_src_global generation:  0.03153276443481445
r_  generation:  0.2654380798339844
local_output_nid generation:  0.016924142837524414
local_in_edges_tensor generation:  0.02196025848388672
mini_batch_src_global generation:  0.032022953033447266
r_  generation:  0.2701735496520996
----------------------check_connections_block total spend ----------------------------- 3.1041226387023926
generate_one_block  0.3345198631286621
generate_one_block  0.3274550437927246
generate_one_block  0.3388326168060303
generate_one_block  0.3525516986846924
generate_one_block  0.3303649425506592
generate_one_block  0.34310173988342285
generate_one_block  0.34096646308898926
generate_one_block  0.3447544574737549
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023070812225341797
gen group dst list time:  0.03384900093078613
time for parepare:  0.018811702728271484
local_output_nid generation:  0.026319265365600586
local_in_edges_tensor generation:  0.03649783134460449
mini_batch_src_global generation:  0.030063629150390625
r_  generation:  0.3253822326660156
local_output_nid generation:  0.03295397758483887
local_in_edges_tensor generation:  0.03836822509765625
mini_batch_src_global generation:  0.03435492515563965
r_  generation:  0.33466601371765137
local_output_nid generation:  0.032584190368652344
local_in_edges_tensor generation:  0.03595709800720215
mini_batch_src_global generation:  0.033942222595214844
r_  generation:  0.35398077964782715
local_output_nid generation:  0.03323101997375488
local_in_edges_tensor generation:  0.029803037643432617
mini_batch_src_global generation:  0.03568911552429199
r_  generation:  0.33878421783447266
local_output_nid generation:  0.03284955024719238
local_in_edges_tensor generation:  0.026699304580688477
mini_batch_src_global generation:  0.03747844696044922
r_  generation:  0.34720468521118164
local_output_nid generation:  0.03308868408203125
local_in_edges_tensor generation:  0.03428363800048828
mini_batch_src_global generation:  0.036301374435424805
r_  generation:  0.34344911575317383
local_output_nid generation:  0.03336334228515625
local_in_edges_tensor generation:  0.03191542625427246
mini_batch_src_global generation:  0.035372018814086914
r_  generation:  0.3461112976074219
local_output_nid generation:  0.03337359428405762
local_in_edges_tensor generation:  0.03197979927062988
mini_batch_src_global generation:  0.0359644889831543
r_  generation:  0.3449208736419678
----------------------check_connections_block total spend ----------------------------- 4.180700778961182
generate_one_block  0.4107236862182617
generate_one_block  0.4037621021270752
generate_one_block  0.4130861759185791
generate_one_block  0.404965877532959
generate_one_block  0.4354679584503174
generate_one_block  0.4164698123931885
generate_one_block  0.41710472106933594
generate_one_block  0.41670823097229004
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

connection checking time:  7.284823417663574
block generation total time  6.030835390090942
average batch blocks generation time:  0.7538544237613678
block dataloader generation time/epoch 14.626470565795898
pseudo mini batch 0 input nodes size: 156721
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.07553911209106445  GigaBytes
Max Memory Allocated: 0.07553911209106445  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.07562398910522461  GigaBytes
Max Memory Allocated: 0.07562398910522461  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.07562398910522461  GigaBytes
Max Memory Allocated: 0.07562398910522461  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.08927202224731445  GigaBytes
Max Memory Allocated: 0.08927202224731445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.08927202224731445  GigaBytes
Max Memory Allocated: 0.08927202224731445  GigaBytes

first layer input nodes number: 156721
first layer output nodes number: 137070
edges number: 949620
----------------------------------------before model layer 0
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.0917348861694336  GigaBytes
Max Memory Allocated: 0.09527254104614258  GigaBytes

torch.Size([156721, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.0917348861694336  GigaBytes
Max Memory Allocated: 0.09527254104614258  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.29554033279418945  GigaBytes
Max Memory Allocated: 0.29554033279418945  GigaBytes

torch.Size([137070, 256])
torch.Size([137070, 256])
----------------------------------------after rst
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.42639970779418945  GigaBytes
Max Memory Allocated: 0.5572590827941895  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.29554033279418945  GigaBytes
Max Memory Allocated: 0.5572590827941895  GigaBytes

torch.Size([137070, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.42639970779418945  GigaBytes
Max Memory Allocated: 0.5572590827941895  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.4590797424316406  GigaBytes
Max Memory Allocated: 0.5899391174316406  GigaBytes

input nodes number: 137070
output nodes number: 64376
edges number: 785752
----------------------------------------before model layer 1
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.4606056213378906  GigaBytes
Max Memory Allocated: 0.5899391174316406  GigaBytes

torch.Size([137070, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.4606056213378906  GigaBytes
Max Memory Allocated: 0.5899391174316406  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.9842529296875 GB
    Memory Allocated: 0.5897274017333984  GigaBytes
Max Memory Allocated: 0.5899391174316406  GigaBytes

torch.Size([64376, 256])
torch.Size([64376, 256])
----------------------------------------after rst
 Nvidia-smi: 2.1092529296875 GB
    Memory Allocated: 0.6511211395263672  GigaBytes
Max Memory Allocated: 0.7125148773193359  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.1092529296875 GB
    Memory Allocated: 0.5897274017333984  GigaBytes
Max Memory Allocated: 0.7125148773193359  GigaBytes

torch.Size([64376, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.1092529296875 GB
    Memory Allocated: 0.6511211395263672  GigaBytes
Max Memory Allocated: 0.7125148773193359  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.1092529296875 GB
    Memory Allocated: 0.6664695739746094  GigaBytes
Max Memory Allocated: 0.7278633117675781  GigaBytes

----------------input nodes number: 64376
----------------output nodes number: 11368
----------------edges number: 96379
----------------------------------------before mean aggregator
 Nvidia-smi: 2.1092529296875 GB
    Memory Allocated: 0.6670341491699219  GigaBytes
Max Memory Allocated: 0.7278633117675781  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.1112060546875 GB
    Memory Allocated: 0.6805214881896973  GigaBytes
Max Memory Allocated: 0.7278633117675781  GigaBytes

torch.Size([11368, 40])
torch.Size([11368, 40])
----------------------------------------after rst
 Nvidia-smi: 2.1112060546875 GB
    Memory Allocated: 0.682215690612793  GigaBytes
Max Memory Allocated: 0.7278633117675781  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1112060546875 GB
    Memory Allocated: 0.6803727149963379  GigaBytes
Max Memory Allocated: 0.7278633117675781  GigaBytes

torch.Size([11368, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1112060546875 GB
    Memory Allocated: 0.682215690612793  GigaBytes
Max Memory Allocated: 0.7278633117675781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1112060546875 GB
    Memory Allocated: 0.6842589378356934  GigaBytes
Max Memory Allocated: 0.7278633117675781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.4979248046875 GB
    Memory Allocated: 0.11824226379394531  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

pseudo mini batch 1 input nodes size: 156951
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.4979248046875 GB
    Memory Allocated: 0.0782766342163086  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.4979248046875 GB
    Memory Allocated: 0.0782766342163086  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.4979248046875 GB
    Memory Allocated: 0.15311670303344727  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.4979248046875 GB
    Memory Allocated: 0.15320158004760742  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.4979248046875 GB
    Memory Allocated: 0.07838630676269531  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.4979248046875 GB
    Memory Allocated: 0.09211063385009766  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4979248046875 GB
    Memory Allocated: 0.09211063385009766  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

first layer input nodes number: 156951
first layer output nodes number: 137660
edges number: 951662
----------------------------------------before model layer 0
 Nvidia-smi: 2.4979248046875 GB
    Memory Allocated: 0.09430599212646484  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

torch.Size([156951, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4979248046875 GB
    Memory Allocated: 0.09430599212646484  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.6307373046875 GB
    Memory Allocated: 0.29959869384765625  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

torch.Size([137660, 256])
torch.Size([137660, 256])
----------------------------------------after rst
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.4308815002441406  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.29959869384765625  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

torch.Size([137660, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.4308815002441406  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.4637022018432617  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

input nodes number: 137660
output nodes number: 65006
edges number: 791709
----------------------------------------before model layer 1
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.4657163619995117  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

torch.Size([137660, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.4657163619995117  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5971002578735352  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

torch.Size([65006, 256])
torch.Size([65006, 256])
----------------------------------------after rst
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6590948104858398  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.5965948104858398  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

torch.Size([65006, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6590948104858398  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.674593448638916  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

----------------input nodes number: 65006
----------------output nodes number: 11368
----------------edges number: 98553
----------------------------------------before mean aggregator
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6751627922058105  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.689326286315918  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

torch.Size([11368, 40])
torch.Size([11368, 40])
----------------------------------------after rst
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6916646957397461  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6891617774963379  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

torch.Size([11368, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6890130043029785  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8963623046875 GB
    Memory Allocated: 0.6907076835632324  GigaBytes
Max Memory Allocated: 0.7934603691101074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.11940288543701172  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

pseudo mini batch 2 input nodes size: 156999
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.07823753356933594  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.07823753356933594  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.15310049057006836  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.15318536758422852  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.07826042175292969  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.0920257568359375  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.0920257568359375  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

first layer input nodes number: 156999
first layer output nodes number: 137551
edges number: 952218
----------------------------------------before model layer 0
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.0943598747253418  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([156999, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.0943598747253418  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.29955291748046875  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([137551, 256])
torch.Size([137551, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.43073177337646484  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.29955291748046875  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([137551, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.43073177337646484  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.46352672576904297  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

input nodes number: 137551
output nodes number: 65220
edges number: 796091
----------------------------------------before model layer 1
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.46532630920410156  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([137551, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.46532630920410156  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.5967445373535156  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([65220, 256])
torch.Size([65220, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6589431762695312  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.5964431762695312  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([65220, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6589431762695312  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6741914749145508  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------input nodes number: 65220
----------------output nodes number: 11368
----------------edges number: 99064
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6747627258300781  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6888985633850098  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([11368, 40])
torch.Size([11368, 40])
----------------------------------------after rst
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6911859512329102  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6887145042419434  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([11368, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6887145042419434  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6904091835021973  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.11944103240966797  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

pseudo mini batch 3 input nodes size: 156796
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.07826042175292969  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.07826042175292969  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.15302658081054688  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.15311145782470703  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.07816362380981445  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.09187078475952148  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.09187078475952148  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

first layer input nodes number: 156796
first layer output nodes number: 137094
edges number: 949291
----------------------------------------before model layer 0
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.09415817260742188  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([156796, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.09415817260742188  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.2979736328125  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([137094, 256])
torch.Size([137094, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.4288330078125  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.2979736328125  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([137094, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.4288330078125  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.4615187644958496  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

input nodes number: 137094
output nodes number: 64541
edges number: 791974
----------------------------------------before model layer 1
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.46303462982177734  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([137094, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.46303462982177734  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.5944175720214844  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([64541, 256])
torch.Size([64541, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6559686660766602  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.5934686660766602  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([64541, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6559686660766602  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6713566780090332  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------input nodes number: 64541
----------------output nodes number: 11368
----------------edges number: 98250
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6719226837158203  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6853060722351074  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([11368, 40])
torch.Size([11368, 40])
----------------------------------------after rst
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6870002746582031  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6852755546569824  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([11368, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6853060722351074  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6877555847167969  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.11815786361694336  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

pseudo mini batch 4 input nodes size: 156723
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.07819414138793945  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.07819414138793945  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.1529254913330078  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.15301036834716797  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.07815933227539062  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.09186172485351562  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.09186172485351562  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

first layer input nodes number: 156723
first layer output nodes number: 137263
edges number: 950826
----------------------------------------before model layer 0
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.09432506561279297  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([156723, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.09432506561279297  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.29923200607299805  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([137263, 256])
torch.Size([137263, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.43013620376586914  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.29923200607299805  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([137263, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.43013620376586914  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.462862491607666  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

input nodes number: 137263
output nodes number: 64705
edges number: 790663
----------------------------------------before model layer 1
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.4651646614074707  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([137263, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.4651646614074707  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.5965390205383301  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([64705, 256])
torch.Size([64705, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6582465171813965  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.5957465171813965  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([64705, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6582465171813965  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6728811264038086  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------input nodes number: 64705
----------------output nodes number: 11368
----------------edges number: 97384
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6734485626220703  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6870088577270508  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([11368, 40])
torch.Size([11368, 40])
----------------------------------------after rst
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6889982223510742  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6870899200439453  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([11368, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6872735023498535  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6891822814941406  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.1192464828491211  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

pseudo mini batch 5 input nodes size: 156816
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.07834291458129883  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.07834291458129883  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.15311861038208008  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.15320348739624023  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.07838726043701172  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.09212779998779297  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.09212779998779297  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

first layer input nodes number: 156816
first layer output nodes number: 137169
edges number: 949586
----------------------------------------before model layer 0
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.09431886672973633  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([156816, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.09431886672973633  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.29897308349609375  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([137169, 256])
torch.Size([137169, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.42983245849609375  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.29897308349609375  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([137169, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.42983245849609375  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.4625363349914551  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

input nodes number: 137169
output nodes number: 64979
edges number: 795366
----------------------------------------before model layer 1
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.46486377716064453  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([137169, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.46486377716064453  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.5962743759155273  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([64979, 256])
torch.Size([64979, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6582431793212891  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.5957431793212891  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([64979, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6582431793212891  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6737356185913086  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------input nodes number: 64979
----------------output nodes number: 11368
----------------edges number: 99138
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6743049621582031  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6876645088195801  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([11368, 40])
torch.Size([11368, 40])
----------------------------------------after rst
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6893587112426758  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6876645088195801  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([11368, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6874504089355469  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6891450881958008  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.11975765228271484  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

pseudo mini batch 6 input nodes size: 156801
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.07817316055297852  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.07817316055297852  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.15294170379638672  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.15302658081054688  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.07816600799560547  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.09192276000976562  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.09192276000976562  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

first layer input nodes number: 156801
first layer output nodes number: 137431
edges number: 952175
----------------------------------------before model layer 0
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.09465360641479492  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([156801, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.09465360641479492  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.2997307777404785  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([137431, 256])
torch.Size([137431, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.43079519271850586  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.2997307777404785  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([137431, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.43079519271850586  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.4635615348815918  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

input nodes number: 137431
output nodes number: 64832
edges number: 796011
----------------------------------------before model layer 1
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.4657926559448242  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([137431, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.4657926559448242  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.5977258682250977  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([64832, 256])
torch.Size([64832, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6595544815063477  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.5970544815063477  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([64832, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6595544815063477  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6743402481079102  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------input nodes number: 64832
----------------output nodes number: 11368
----------------edges number: 98111
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6749081611633301  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6883139610290527  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([11368, 40])
torch.Size([11368, 40])
----------------------------------------after rst
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6906938552856445  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6889457702636719  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([11368, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6889457702636719  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6906404495239258  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.11994075775146484  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

pseudo mini batch 7 input nodes size: 156971
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.07816600799560547  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.07816600799560547  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.1530156135559082  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.15310049057006836  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.0782470703125  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.09204864501953125  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.09204864501953125  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

first layer input nodes number: 156971
first layer output nodes number: 137713
edges number: 952502
----------------------------------------before model layer 0
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.09442853927612305  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([156971, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.09442853927612305  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.29977846145629883  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([137713, 256])
torch.Size([137713, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.43111181259155273  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.29977846145629883  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([137713, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.43111181259155273  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.4639453887939453  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

input nodes number: 137713
output nodes number: 65321
edges number: 801289
----------------------------------------before model layer 1
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.4659113883972168  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([137713, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.4659113883972168  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.5973696708679199  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([65321, 256])
torch.Size([65321, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6596646308898926  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.5971646308898926  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([65321, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6596646308898926  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6752386093139648  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------input nodes number: 65321
----------------output nodes number: 11365
----------------edges number: 98381
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6758103370666504  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6898560523986816  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([11365, 40])
torch.Size([11365, 40])
----------------------------------------after rst
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6921195983886719  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6897306442260742  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

torch.Size([11365, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.689730167388916  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.6914243698120117  GigaBytes
Max Memory Allocated: 0.801262378692627  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.1196751594543457  GigaBytes
Max Memory Allocated: 0.8023581504821777  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.1212925910949707  GigaBytes
Max Memory Allocated: 0.8023581504821777  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.0330810546875 GB
    Memory Allocated: 0.1212925910949707  GigaBytes
Max Memory Allocated: 0.8023581504821777  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.02661973237991333 |0.04423004388809204 |0.1116257905960083 |0.00015926361083984375 |0.005817770957946777 |0.0019829273223876953 |
----------------------------------------------------------pseudo_mini_loss sum 4.60054349899292
Total (block generation + training)time/epoch 16.15964388847351
Training time/epoch 1.5329101085662842
Training time without block to device /epoch 1.1790697574615479
Training time without total dataloading part /epoch 0.9428055286407471
load block tensor time/epoch 0.21295785903930664
block to device time/epoch 0.35384035110473633
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2872709
Number of first layer input nodes during this epoch:  1254778
Number of first layer output nodes during this epoch:  1098951
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  217088
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([40, 256])
layers.2.fc_neigh.weight, torch.Size([40, 256])
----------------------------------------
un-trainable parameters
