main start at this time 1657105176.4087136
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  500
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007778167724609375  GigaBytes
Max Memory Allocated: 0.007778167724609375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007778167724609375  GigaBytes
Max Memory Allocated: 0.007778167724609375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0020210742950439453
number of batches is  8
batch size is  8
random selection method spend 0.0007979869842529297
time for parepare:  5.340576171875e-05
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.0026657581329345703
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001659393310546875
mini_batch_src_global generation:  2.6226043701171875e-05
r_  generation:  3.552436828613281e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00012755393981933594
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  2.8848648071289062e-05
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00012063980102539062
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  3.504753112792969e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  2.6941299438476562e-05
r_  generation:  2.574920654296875e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00012302398681640625
mini_batch_src_global generation:  1.6689300537109375e-05
r_  generation:  1.9788742065429688e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011897087097167969
mini_batch_src_global generation:  1.621246337890625e-05
r_  generation:  1.7404556274414062e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00011849403381347656
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.528594970703125e-05
----------------------check_connections_block total spend ----------------------------- 0.004747629165649414
generate_one_block  0.003947734832763672
generate_one_block  0.0013227462768554688
generate_one_block  0.0012712478637695312
generate_one_block  0.0014009475708007812
generate_one_block  0.0012502670288085938
generate_one_block  0.0010609626770019531
generate_one_block  0.0010652542114257812
generate_one_block  0.0010693073272705078
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.000946044921875
gen group dst list time:  7.295608520507812e-05
time for parepare:  0.00029158592224121094
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00022125244140625
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.00034236907958984375
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00014925003051757812
mini_batch_src_global generation:  3.814697265625e-05
r_  generation:  0.000171661376953125
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  4.6253204345703125e-05
r_  generation:  0.0003292560577392578
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0001418590545654297
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.00022649765014648438
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  2.9325485229492188e-05
r_  generation:  0.00012731552124023438
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  2.8848648071289062e-05
r_  generation:  0.0001475811004638672
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00012874603271484375
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  8.368492126464844e-05
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  3.314018249511719e-05
r_  generation:  0.00021696090698242188
----------------------check_connections_block total spend ----------------------------- 0.0041124820709228516
generate_one_block  0.0017151832580566406
generate_one_block  0.0014529228210449219
generate_one_block  0.0017666816711425781
generate_one_block  0.0015244483947753906
generate_one_block  0.0013854503631591797
generate_one_block  0.001444101333618164
generate_one_block  0.0011410713195800781
generate_one_block  0.0012676715850830078
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0010704994201660156
gen group dst list time:  0.00012731552124023438
time for parepare:  0.0009143352508544922
local_output_nid generation:  6.341934204101562e-05
local_in_edges_tensor generation:  0.00035309791564941406
mini_batch_src_global generation:  0.0002090930938720703
r_  generation:  0.002190828323364258
local_output_nid generation:  3.62396240234375e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.0001633167266845703
r_  generation:  0.0010833740234375
local_output_nid generation:  6.246566772460938e-05
local_in_edges_tensor generation:  0.00024580955505371094
mini_batch_src_global generation:  0.0002498626708984375
r_  generation:  0.0023941993713378906
local_output_nid generation:  4.649162292480469e-05
local_in_edges_tensor generation:  0.00021314620971679688
mini_batch_src_global generation:  0.00017690658569335938
r_  generation:  0.0013165473937988281
local_output_nid generation:  3.0517578125e-05
local_in_edges_tensor generation:  0.00018835067749023438
mini_batch_src_global generation:  9.012222290039062e-05
r_  generation:  0.0006330013275146484
local_output_nid generation:  3.647804260253906e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  9.393692016601562e-05
r_  generation:  0.0008420944213867188
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.0001735687255859375
mini_batch_src_global generation:  7.104873657226562e-05
r_  generation:  0.00042366981506347656
local_output_nid generation:  3.1948089599609375e-05
local_in_edges_tensor generation:  0.00017213821411132812
mini_batch_src_global generation:  0.00010895729064941406
r_  generation:  0.0010409355163574219
----------------------check_connections_block total spend ----------------------------- 0.016949176788330078
generate_one_block  0.0034356117248535156
generate_one_block  0.002116680145263672
generate_one_block  0.003432035446166992
generate_one_block  0.002231597900390625
generate_one_block  0.0015032291412353516
generate_one_block  0.001817464828491211
generate_one_block  0.0013549327850341797
generate_one_block  0.0024428367614746094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020024776458740234
gen group dst list time:  0.00035643577575683594
time for parepare:  0.0019698143005371094
local_output_nid generation:  0.0003082752227783203
local_in_edges_tensor generation:  0.0008423328399658203
mini_batch_src_global generation:  0.0012102127075195312
r_  generation:  0.009577274322509766
local_output_nid generation:  0.0001652240753173828
local_in_edges_tensor generation:  0.00039267539978027344
mini_batch_src_global generation:  0.0007123947143554688
r_  generation:  0.0049932003021240234
local_output_nid generation:  0.00019407272338867188
local_in_edges_tensor generation:  0.00045609474182128906
mini_batch_src_global generation:  0.000667572021484375
r_  generation:  0.00663304328918457
local_output_nid generation:  0.00018668174743652344
local_in_edges_tensor generation:  0.00037217140197753906
mini_batch_src_global generation:  0.0005006790161132812
r_  generation:  0.004903078079223633
local_output_nid generation:  8.797645568847656e-05
local_in_edges_tensor generation:  0.00024127960205078125
mini_batch_src_global generation:  0.0003294944763183594
r_  generation:  0.0028803348541259766
local_output_nid generation:  0.00012063980102539062
local_in_edges_tensor generation:  0.0003185272216796875
mini_batch_src_global generation:  0.00035190582275390625
r_  generation:  0.0038139820098876953
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.0002384185791015625
mini_batch_src_global generation:  0.0003094673156738281
r_  generation:  0.0023751258850097656
local_output_nid generation:  0.0002033710479736328
local_in_edges_tensor generation:  0.0008745193481445312
mini_batch_src_global generation:  0.0004773139953613281
r_  generation:  0.005394458770751953
----------------------check_connections_block total spend ----------------------------- 0.06274580955505371
generate_one_block  0.012191057205200195
generate_one_block  0.007187843322753906
generate_one_block  0.010409355163574219
generate_one_block  0.0074405670166015625
generate_one_block  0.004637479782104492
generate_one_block  0.006197929382324219
generate_one_block  0.0042765140533447266
generate_one_block  0.008555173873901367
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.002130270004272461
gen group dst list time:  0.001680612564086914
time for parepare:  0.0021800994873046875
local_output_nid generation:  0.001186370849609375
local_in_edges_tensor generation:  0.0028619766235351562
mini_batch_src_global generation:  0.001538991928100586
r_  generation:  0.016839981079101562
local_output_nid generation:  0.0005562305450439453
local_in_edges_tensor generation:  0.000978708267211914
mini_batch_src_global generation:  0.0014693737030029297
r_  generation:  0.013177156448364258
local_output_nid generation:  0.0007138252258300781
local_in_edges_tensor generation:  0.0010101795196533203
mini_batch_src_global generation:  0.0012030601501464844
r_  generation:  0.014058351516723633
local_output_nid generation:  0.0006134510040283203
local_in_edges_tensor generation:  0.0009808540344238281
mini_batch_src_global generation:  0.0013263225555419922
r_  generation:  0.012636184692382812
local_output_nid generation:  0.00046062469482421875
local_in_edges_tensor generation:  0.0007483959197998047
mini_batch_src_global generation:  0.0008423328399658203
r_  generation:  0.007948160171508789
local_output_nid generation:  0.0006086826324462891
local_in_edges_tensor generation:  0.0009539127349853516
mini_batch_src_global generation:  0.0008678436279296875
r_  generation:  0.009596824645996094
local_output_nid generation:  0.00032591819763183594
local_in_edges_tensor generation:  0.0005376338958740234
mini_batch_src_global generation:  0.0006494522094726562
r_  generation:  0.006376981735229492
local_output_nid generation:  0.0005724430084228516
local_in_edges_tensor generation:  0.0008771419525146484
mini_batch_src_global generation:  0.0009489059448242188
r_  generation:  0.01224970817565918
----------------------check_connections_block total spend ----------------------------- 0.14247584342956543
generate_one_block  0.01910853385925293
generate_one_block  0.015723705291748047
generate_one_block  0.015842914581298828
generate_one_block  0.015702247619628906
generate_one_block  0.01204991340637207
generate_one_block  0.01346278190612793
generate_one_block  0.009255647659301758
generate_one_block  0.015586376190185547
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007778167724609375  GigaBytes
Max Memory Allocated: 0.007778167724609375  GigaBytes

connection checking time:  0.22628331184387207
block generation total time  0.20765995979309082
average batch blocks generation time:  0.025957494974136353
block dataloader generation time/epoch 0.480724573135376
pseudo mini batch 0 input nodes size: 13507
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007778167724609375  GigaBytes
Max Memory Allocated: 0.007778167724609375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007778167724609375  GigaBytes
Max Memory Allocated: 0.007778167724609375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.033168792724609375  GigaBytes
Max Memory Allocated: 0.033168792724609375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.03316926956176758  GigaBytes
Max Memory Allocated: 0.03316926956176758  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.03316926956176758  GigaBytes
Max Memory Allocated: 0.03316926956176758  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.03374624252319336  GigaBytes
Max Memory Allocated: 0.03374624252319336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.03374624252319336  GigaBytes
Max Memory Allocated: 0.03374624252319336  GigaBytes

first layer input nodes number: 13507
first layer output nodes number: 9690
edges number: 42124
----------------------------------------before model layer 0
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.0339198112487793  GigaBytes
Max Memory Allocated: 0.03407716751098633  GigaBytes

torch.Size([13507, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.0339198112487793  GigaBytes
Max Memory Allocated: 0.03407716751098633  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.07080221176147461  GigaBytes
Max Memory Allocated: 0.07080221176147461  GigaBytes

torch.Size([9690, 512])
torch.Size([9690, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.08928442001342773  GigaBytes
Max Memory Allocated: 0.10776662826538086  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.07080221176147461  GigaBytes
Max Memory Allocated: 0.10776662826538086  GigaBytes

torch.Size([9690, 512])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3729248046875 GB
    Memory Allocated: 0.08928442001342773  GigaBytes
Max Memory Allocated: 0.10776662826538086  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.09390497207641602  GigaBytes
Max Memory Allocated: 0.11238718032836914  GigaBytes

input nodes number: 9690
output nodes number: 2586
edges number: 27832
----------------------------------------before model layer 1
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.09399700164794922  GigaBytes
Max Memory Allocated: 0.11238718032836914  GigaBytes

torch.Size([9690, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.09399700164794922  GigaBytes
Max Memory Allocated: 0.11238718032836914  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.10408973693847656  GigaBytes
Max Memory Allocated: 0.11238718032836914  GigaBytes

torch.Size([2586, 512])
torch.Size([2586, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.10902214050292969  GigaBytes
Max Memory Allocated: 0.11406803131103516  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.10408973693847656  GigaBytes
Max Memory Allocated: 0.11406803131103516  GigaBytes

torch.Size([2586, 512])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.10902214050292969  GigaBytes
Max Memory Allocated: 0.11406803131103516  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.11061763763427734  GigaBytes
Max Memory Allocated: 0.11555004119873047  GigaBytes

input nodes number: 2586
output nodes number: 604
edges number: 6156
----------------------------------------before model layer 2
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.1106419563293457  GigaBytes
Max Memory Allocated: 0.11555004119873047  GigaBytes

torch.Size([2586, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.1106419563293457  GigaBytes
Max Memory Allocated: 0.11555004119873047  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.11299753189086914  GigaBytes
Max Memory Allocated: 0.11555004119873047  GigaBytes

torch.Size([604, 512])
torch.Size([604, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.11447381973266602  GigaBytes
Max Memory Allocated: 0.11562585830688477  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.11332178115844727  GigaBytes
Max Memory Allocated: 0.11562585830688477  GigaBytes

torch.Size([604, 512])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.11447381973266602  GigaBytes
Max Memory Allocated: 0.11562585830688477  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.1147618293762207  GigaBytes
Max Memory Allocated: 0.11591386795043945  GigaBytes

input nodes number: 604
output nodes number: 53
edges number: 788
----------------------------------------before model layer 3
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.11476707458496094  GigaBytes
Max Memory Allocated: 0.11591386795043945  GigaBytes

torch.Size([604, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3924560546875 GB
    Memory Allocated: 0.11476707458496094  GigaBytes
Max Memory Allocated: 0.11591386795043945  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.11497688293457031  GigaBytes
Max Memory Allocated: 0.11591386795043945  GigaBytes

torch.Size([53, 512])
torch.Size([53, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.11507797241210938  GigaBytes
Max Memory Allocated: 0.11591386795043945  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.11497688293457031  GigaBytes
Max Memory Allocated: 0.11591386795043945  GigaBytes

torch.Size([53, 512])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.11507797241210938  GigaBytes
Max Memory Allocated: 0.11591386795043945  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.11510324478149414  GigaBytes
Max Memory Allocated: 0.11591386795043945  GigaBytes

----------------input nodes number: 53
----------------output nodes number: 8
----------------edges number: 45
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.11510419845581055  GigaBytes
Max Memory Allocated: 0.11591386795043945  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.11512184143066406  GigaBytes
Max Memory Allocated: 0.11591386795043945  GigaBytes

torch.Size([8, 3])
torch.Size([8, 3])
----------------------------------------after rst
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.11512231826782227  GigaBytes
Max Memory Allocated: 0.11591386795043945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.11512184143066406  GigaBytes
Max Memory Allocated: 0.11591386795043945  GigaBytes

torch.Size([8, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.11512231826782227  GigaBytes
Max Memory Allocated: 0.11591386795043945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3944091796875 GB
    Memory Allocated: 0.11512374877929688  GigaBytes
Max Memory Allocated: 0.11591386795043945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.04275989532470703  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

pseudo mini batch 1 input nodes size: 11799
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.04094886779785156  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4432373046875 GB
    Memory Allocated: 0.04094886779785156  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.0629262924194336  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.0629267692565918  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.037535667419433594  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.03793144226074219  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.03793144226074219  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

first layer input nodes number: 11799
first layer output nodes number: 6275
edges number: 33198
----------------------------------------before model layer 0
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.038066864013671875  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([11799, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.038066864013671875  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.061995506286621094  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([6275, 512])
torch.Size([6275, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.07396411895751953  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.061995506286621094  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([6275, 512])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.07396411895751953  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.07695627212524414  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 6275
output nodes number: 1663
edges number: 16505
----------------------------------------before model layer 1
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.07701587677001953  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([6275, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.07701587677001953  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.0834951400756836  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([1663, 512])
torch.Size([1663, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.08666706085205078  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.0834951400756836  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([1663, 512])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.08666706085205078  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.08746004104614258  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 1663
output nodes number: 274
edges number: 2791
----------------------------------------before model layer 2
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.08747482299804688  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([1663, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.08747482299804688  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.08854389190673828  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([274, 512])
torch.Size([274, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.0890665054321289  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08854389190673828  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([274, 512])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.0890665054321289  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08919715881347656  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 274
output nodes number: 45
edges number: 372
----------------------------------------before model layer 3
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08920001983642578  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([274, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08920001983642578  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08937549591064453  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([45, 512])
torch.Size([45, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.0894613265991211  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08937549591064453  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([45, 512])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.0894613265991211  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08948278427124023  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------input nodes number: 45
----------------output nodes number: 8
----------------edges number: 37
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08948373794555664  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08950138092041016  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([8, 3])
torch.Size([8, 3])
----------------------------------------after rst
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08950185775756836  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08950138092041016  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([8, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08950138092041016  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08950233459472656  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03875303268432617  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

pseudo mini batch 2 input nodes size: 11309
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.037535667419433594  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.037535667419433594  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.058600425720214844  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.05860090255737305  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03662300109863281  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03712940216064453  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03712940216064453  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

first layer input nodes number: 11309
first layer output nodes number: 7522
edges number: 34892
----------------------------------------before model layer 0
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03727006912231445  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([11309, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03727006912231445  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.06591653823852539  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([7522, 512])
torch.Size([7522, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08026361465454102  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.06591653823852539  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([7522, 512])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08026361465454102  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08458948135375977  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 7522
output nodes number: 2247
edges number: 24860
----------------------------------------before model layer 1
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08466291427612305  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([7522, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08466291427612305  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09523439407348633  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([2247, 512])
torch.Size([2247, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09952020645141602  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09433603286743164  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([2247, 512])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09952020645141602  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09985637664794922  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 2247
output nodes number: 581
edges number: 6906
----------------------------------------before model layer 2
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09987831115722656  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([2247, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09987831115722656  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.10215091705322266  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([581, 512])
torch.Size([581, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.10401058197021484  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.10290241241455078  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([581, 512])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.10401058197021484  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.10428762435913086  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 581
output nodes number: 47
edges number: 919
----------------------------------------before model layer 3
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.1042928695678711  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([581, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.1042928695678711  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.10448074340820312  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([47, 512])
torch.Size([47, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.10457038879394531  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.10448074340820312  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([47, 512])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.10457038879394531  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.10459280014038086  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------input nodes number: 47
----------------output nodes number: 8
----------------edges number: 39
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.10459375381469727  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.10461139678955078  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([8, 3])
torch.Size([8, 3])
----------------------------------------after rst
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.10461187362670898  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.10461139678955078  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([8, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.10461139678955078  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.10461235046386719  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03820371627807617  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

pseudo mini batch 3 input nodes size: 12194
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03662300109863281  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03662300109863281  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.06006050109863281  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.060060977935791016  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03899574279785156  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03941059112548828  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03941059112548828  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

first layer input nodes number: 12194
first layer output nodes number: 6936
edges number: 34603
----------------------------------------before model layer 0
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03955364227294922  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([12194, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.03955364227294922  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.06598711013793945  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([6936, 512])
torch.Size([6936, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.07921648025512695  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.06598711013793945  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([6936, 512])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.07921648025512695  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08252382278442383  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 6936
output nodes number: 1985
edges number: 16800
----------------------------------------before model layer 1
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08259105682373047  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([6936, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.08259105682373047  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09030437469482422  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([1985, 512])
torch.Size([1985, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09409046173095703  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09030437469482422  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([1985, 512])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09409046173095703  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09503698348999023  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 1985
output nodes number: 378
edges number: 3345
----------------------------------------before model layer 2
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09505510330200195  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([1985, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09505510330200195  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09652566909790039  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([378, 512])
torch.Size([378, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09724664688110352  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09652566909790039  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([378, 512])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09724664688110352  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.0974268913269043  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 378
output nodes number: 66
edges number: 508
----------------------------------------before model layer 3
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09743070602416992  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([378, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09743070602416992  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.0976872444152832  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([66, 512])
torch.Size([66, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09781312942504883  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.0976872444152832  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([66, 512])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09781312942504883  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09784460067749023  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------input nodes number: 66
----------------output nodes number: 8
----------------edges number: 59
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09784603118896484  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09786367416381836  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([8, 3])
torch.Size([8, 3])
----------------------------------------after rst
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09786415100097656  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09786367416381836  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([8, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09786367416381836  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4686279296875 GB
    Memory Allocated: 0.09786462783813477  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.04028749465942383  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

pseudo mini batch 4 input nodes size: 9696
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.03899574279785156  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.03899574279785156  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05705595016479492  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.057056427001953125  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.03361845016479492  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.03389883041381836  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.03389883041381836  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

first layer input nodes number: 9696
first layer output nodes number: 5100
edges number: 25815
----------------------------------------before model layer 0
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.034009456634521484  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([9696, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.034009456634521484  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.053980350494384766  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([5100, 512])
torch.Size([5100, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.06370782852172852  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.053980350494384766  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([5100, 512])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.06378412246704102  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.06613969802856445  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 5100
output nodes number: 889
edges number: 9697
----------------------------------------before model layer 1
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.06618452072143555  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([5100, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.06618452072143555  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.06965494155883789  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([889, 512])
torch.Size([889, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07163572311401367  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.06994009017944336  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([889, 512])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07163572311401367  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07205963134765625  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 889
output nodes number: 221
edges number: 1439
----------------------------------------before model layer 2
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.0720682144165039  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([889, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.0720682144165039  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07292461395263672  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([221, 512])
torch.Size([221, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07334613800048828  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07292461395263672  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([221, 512])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07334613800048828  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07345151901245117  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 221
output nodes number: 34
edges number: 263
----------------------------------------before model layer 3
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07345390319824219  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([221, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07345390319824219  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07358741760253906  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([34, 512])
torch.Size([34, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07365226745605469  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07358741760253906  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([34, 512])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07365226745605469  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.0736684799194336  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------input nodes number: 34
----------------output nodes number: 8
----------------edges number: 26
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07366943359375  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07368707656860352  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([8, 3])
torch.Size([8, 3])
----------------------------------------after rst
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07368755340576172  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07368707656860352  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([8, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07368707656860352  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07368803024291992  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.034482479095458984  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

pseudo mini batch 5 input nodes size: 11347
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.03361845016479492  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.03361845016479492  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05475425720214844  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05475473403930664  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.03669404983520508  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.03704500198364258  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.03704500198364258  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

first layer input nodes number: 11347
first layer output nodes number: 6794
edges number: 31103
----------------------------------------before model layer 0
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.03718090057373047  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([11347, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.03718090057373047  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.06305217742919922  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([6794, 512])
torch.Size([6794, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07601070404052734  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.06305217742919922  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([6794, 512])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07601070404052734  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07925033569335938  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 6794
output nodes number: 1257
edges number: 13261
----------------------------------------before model layer 1
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07931089401245117  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([6794, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.07931089401245117  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08515024185180664  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([1257, 512])
torch.Size([1257, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08754777908325195  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08421468734741211  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([1257, 512])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08754777908325195  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08721160888671875  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 1257
output nodes number: 314
edges number: 2083
----------------------------------------before model layer 2
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08722352981567383  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([1257, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08722352981567383  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.0884404182434082  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([314, 512])
torch.Size([314, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08903932571411133  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.0884404182434082  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([314, 512])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08903932571411133  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08918905258178711  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 314
output nodes number: 27
edges number: 355
----------------------------------------before model layer 3
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08919191360473633  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([314, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08919191360473633  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08929872512817383  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([27, 512])
torch.Size([27, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08935022354125977  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08929872512817383  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([27, 512])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08935022354125977  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08936309814453125  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------input nodes number: 27
----------------output nodes number: 8
----------------edges number: 19
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08936405181884766  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08938169479370117  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([8, 3])
torch.Size([8, 3])
----------------------------------------after rst
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08938217163085938  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08938169479370117  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([8, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08938169479370117  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08938264846801758  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.03779268264770508  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

pseudo mini batch 6 input nodes size: 7633
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.03669404983520508  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.03669404983520508  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.050911903381347656  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05091238021850586  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.02977609634399414  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.030009746551513672  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.030009746551513672  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

first layer input nodes number: 7633
first layer output nodes number: 3818
edges number: 21042
----------------------------------------before model layer 0
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.030095577239990234  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([7633, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.030095577239990234  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.044661521911621094  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([3818, 512])
torch.Size([3818, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05194377899169922  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.044661521911621094  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([3818, 512])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05194377899169922  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05376434326171875  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 3818
output nodes number: 671
edges number: 8693
----------------------------------------before model layer 1
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05379819869995117  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([3818, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05379819869995117  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05701494216918945  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([671, 512])
torch.Size([671, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05829477310180664  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05701494216918945  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([671, 512])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05829477310180664  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05861473083496094  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 671
output nodes number: 140
edges number: 1053
----------------------------------------before model layer 2
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05862140655517578  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([671, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05862140655517578  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05916595458984375  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([140, 512])
torch.Size([140, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.0594329833984375  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05916595458984375  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([140, 512])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.0594329833984375  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05949974060058594  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 140
output nodes number: 22
edges number: 154
----------------------------------------before model layer 3
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05950164794921875  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([140, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05950164794921875  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05958843231201172  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([22, 512])
torch.Size([22, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.059630393981933594  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05958843231201172  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([22, 512])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.059630393981933594  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05964088439941406  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------input nodes number: 22
----------------output nodes number: 8
----------------edges number: 14
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05964183807373047  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.059659481048583984  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([8, 3])
torch.Size([8, 3])
----------------------------------------after rst
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05965995788574219  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.059659481048583984  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([8, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.059659481048583984  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05966043472290039  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.030486583709716797  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

pseudo mini batch 7 input nodes size: 12412
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.02977609634399414  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.02977609634399414  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.05321359634399414  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.053214073181152344  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.03899574279785156  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.03943634033203125  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.03943634033203125  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

first layer input nodes number: 12412
first layer output nodes number: 7154
edges number: 36003
----------------------------------------before model layer 0
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.039582252502441406  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([12412, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.039582252502441406  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.0668487548828125  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([7154, 512])
torch.Size([7154, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08049392700195312  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.0668487548828125  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([7154, 512])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08049392700195312  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08390522003173828  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 7154
output nodes number: 2189
edges number: 18702
----------------------------------------before model layer 1
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08397531509399414  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([7154, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.08397531509399414  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.0924830436706543  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([2189, 512])
torch.Size([2189, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.09665822982788086  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.0924830436706543  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([2189, 512])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.09665822982788086  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.09836912155151367  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 2189
output nodes number: 380
edges number: 3561
----------------------------------------before model layer 2
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.098388671875  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([2189, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.098388671875  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.0998678207397461  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([380, 512])
torch.Size([380, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.10059261322021484  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.0998678207397461  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([380, 512])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.10059261322021484  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.10077381134033203  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

input nodes number: 380
output nodes number: 62
edges number: 509
----------------------------------------before model layer 3
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.10077714920043945  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([380, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.10077714920043945  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.10101842880249023  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([62, 512])
torch.Size([62, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.10113668441772461  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.10101842880249023  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([62, 512])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.10113668441772461  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.1011662483215332  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------input nodes number: 62
----------------output nodes number: 4
----------------edges number: 58
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.10116720199584961  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.10117721557617188  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([4, 3])
torch.Size([4, 3])
----------------------------------------after rst
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.10117769241333008  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.10117721557617188  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

torch.Size([4, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.10117721557617188  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.10117816925048828  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.040363311767578125  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.055919647216796875  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.4862060546875 GB
    Memory Allocated: 0.055919647216796875  GigaBytes
Max Memory Allocated: 0.137451171875  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.008880794048309326 |0.04506674408912659 |0.1156880259513855 |0.000140458345413208 |0.005708873271942139 |0.003600597381591797 |
----------------------------------------------------------pseudo_mini_loss sum 1.0907412767410278
Total (block generation + training)time/epoch 1.918243169784546
Training time/epoch 1.4371178150177002
Training time without block to device /epoch 1.0765838623046875
Training time without total dataloading part /epoch 0.9758994579315186
load block tensor time/epoch 0.07104635238647461
block to device time/epoch 0.3605339527130127
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 9.5367431640625e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  159921
Number of first layer input nodes during this epoch:  89897
Number of first layer output nodes during this epoch:  53289
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=500, out_features=512, bias=False)
      (fc_neigh): Linear(in_features=500, out_features=512, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=512, out_features=512, bias=False)
      (fc_neigh): Linear(in_features=512, out_features=512, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=512, out_features=512, bias=False)
      (fc_neigh): Linear(in_features=512, out_features=512, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=512, out_features=512, bias=False)
      (fc_neigh): Linear(in_features=512, out_features=512, bias=False)
    )
    (4): SAGEConv(
      (fc_self): Linear(in_features=512, out_features=3, bias=False)
      (fc_neigh): Linear(in_features=512, out_features=3, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  2087936
trainable parameters
layers.0.fc_self.weight, torch.Size([512, 500])
layers.0.fc_neigh.weight, torch.Size([512, 500])
layers.1.fc_self.weight, torch.Size([512, 512])
layers.1.fc_neigh.weight, torch.Size([512, 512])
layers.2.fc_self.weight, torch.Size([512, 512])
layers.2.fc_neigh.weight, torch.Size([512, 512])
layers.3.fc_self.weight, torch.Size([512, 512])
layers.3.fc_neigh.weight, torch.Size([512, 512])
layers.4.fc_self.weight, torch.Size([3, 512])
layers.4.fc_neigh.weight, torch.Size([3, 512])
----------------------------------------
un-trainable parameters
