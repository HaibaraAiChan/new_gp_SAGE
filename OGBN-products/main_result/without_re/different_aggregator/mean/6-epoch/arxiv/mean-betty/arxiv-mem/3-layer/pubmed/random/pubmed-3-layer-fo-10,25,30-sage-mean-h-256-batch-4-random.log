main start at this time 1657074219.7967608
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  500
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014476776123046875  GigaBytes
Max Memory Allocated: 0.0014476776123046875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014476776123046875  GigaBytes
Max Memory Allocated: 0.0014476776123046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0016887187957763672
number of batches is  4
batch size is  15
random selection method spend 0.0003342628479003906
time for parepare:  4.3392181396484375e-05
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00019979476928710938
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  0.0011856555938720703
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.0001347064971923828
mini_batch_src_global generation:  2.4318695068359375e-05
r_  generation:  4.744529724121094e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.000110626220703125
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  4.649162292480469e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00022101402282714844
mini_batch_src_global generation:  2.0742416381835938e-05
r_  generation:  2.956390380859375e-05
----------------------check_connections_block total spend ----------------------------- 0.0023665428161621094
generate_one_block  0.003591775894165039
generate_one_block  0.0011811256408691406
generate_one_block  0.0011081695556640625
generate_one_block  0.0010635852813720703
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009436607360839844
gen group dst list time:  3.2901763916015625e-05
time for parepare:  0.00022602081298828125
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00019478797912597656
mini_batch_src_global generation:  4.124641418457031e-05
r_  generation:  0.00029850006103515625
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.0003757476806640625
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.0001285076141357422
mini_batch_src_global generation:  4.482269287109375e-05
r_  generation:  0.000324249267578125
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011920928955078125
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.0002129077911376953
----------------------check_connections_block total spend ----------------------------- 0.002613544464111328
generate_one_block  0.0015077590942382812
generate_one_block  0.0015549659729003906
generate_one_block  0.0015265941619873047
generate_one_block  0.0013315677642822266
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008027553558349609
gen group dst list time:  6.747245788574219e-05
time for parepare:  0.0005931854248046875
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.0002872943878173828
mini_batch_src_global generation:  0.00011205673217773438
r_  generation:  0.0012657642364501953
local_output_nid generation:  6.103515625e-05
local_in_edges_tensor generation:  0.0002181529998779297
mini_batch_src_global generation:  0.00015807151794433594
r_  generation:  0.001486063003540039
local_output_nid generation:  5.53131103515625e-05
local_in_edges_tensor generation:  0.000202178955078125
mini_batch_src_global generation:  0.00014519691467285156
r_  generation:  0.0013666152954101562
local_output_nid generation:  4.0531158447265625e-05
local_in_edges_tensor generation:  0.00018072128295898438
mini_batch_src_global generation:  0.0001068115234375
r_  generation:  0.0008051395416259766
----------------------check_connections_block total spend ----------------------------- 0.008505582809448242
generate_one_block  0.0030803680419921875
generate_one_block  0.003094911575317383
generate_one_block  0.002769947052001953
generate_one_block  0.0019137859344482422
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014476776123046875  GigaBytes
Max Memory Allocated: 0.0014476776123046875  GigaBytes

connection checking time:  0.01111912727355957
block generation total time  0.01677989959716797
average batch blocks generation time:  0.004194974899291992
block dataloader generation time/epoch 0.04660749435424805
pseudo mini batch 0 input nodes size: 2057
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014476776123046875  GigaBytes
Max Memory Allocated: 0.0014476776123046875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014476776123046875  GigaBytes
Max Memory Allocated: 0.0014476776123046875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.005279541015625  GigaBytes
Max Memory Allocated: 0.005279541015625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.005280017852783203  GigaBytes
Max Memory Allocated: 0.005280017852783203  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.005280017852783203  GigaBytes
Max Memory Allocated: 0.005280017852783203  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.005317211151123047  GigaBytes
Max Memory Allocated: 0.005317211151123047  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.005317211151123047  GigaBytes
Max Memory Allocated: 0.005317211151123047  GigaBytes

first layer input nodes number: 2057
first layer output nodes number: 657
edges number: 3901
----------------------------------------before model layer 0
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.005338191986083984  GigaBytes
Max Memory Allocated: 0.005352973937988281  GigaBytes

torch.Size([2057, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.005338191986083984  GigaBytes
Max Memory Allocated: 0.005352973937988281  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007221221923828125  GigaBytes
Max Memory Allocated: 0.00782155990600586  GigaBytes

torch.Size([657, 256])
torch.Size([657, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007847785949707031  GigaBytes
Max Memory Allocated: 0.008474349975585938  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007221221923828125  GigaBytes
Max Memory Allocated: 0.008474349975585938  GigaBytes

torch.Size([657, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.007847785949707031  GigaBytes
Max Memory Allocated: 0.008474349975585938  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00800466537475586  GigaBytes
Max Memory Allocated: 0.008631229400634766  GigaBytes

input nodes number: 657
output nodes number: 81
edges number: 878
----------------------------------------before model layer 1
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0080108642578125  GigaBytes
Max Memory Allocated: 0.008631229400634766  GigaBytes

torch.Size([657, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.0080108642578125  GigaBytes
Max Memory Allocated: 0.008631229400634766  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008172988891601562  GigaBytes
Max Memory Allocated: 0.008631229400634766  GigaBytes

torch.Size([81, 256])
torch.Size([81, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008250236511230469  GigaBytes
Max Memory Allocated: 0.008631229400634766  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008172988891601562  GigaBytes
Max Memory Allocated: 0.008631229400634766  GigaBytes

torch.Size([81, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008250236511230469  GigaBytes
Max Memory Allocated: 0.008631229400634766  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008269786834716797  GigaBytes
Max Memory Allocated: 0.008631229400634766  GigaBytes

----------------input nodes number: 81
----------------output nodes number: 15
----------------edges number: 66
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008271217346191406  GigaBytes
Max Memory Allocated: 0.008631229400634766  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008287906646728516  GigaBytes
Max Memory Allocated: 0.008631229400634766  GigaBytes

torch.Size([15, 3])
torch.Size([15, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008288383483886719  GigaBytes
Max Memory Allocated: 0.008631229400634766  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008287906646728516  GigaBytes
Max Memory Allocated: 0.008631229400634766  GigaBytes

torch.Size([15, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008288383483886719  GigaBytes
Max Memory Allocated: 0.008631229400634766  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.008289813995361328  GigaBytes
Max Memory Allocated: 0.008631229400634766  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006846904754638672  GigaBytes
Max Memory Allocated: 0.009780406951904297  GigaBytes

pseudo mini batch 1 input nodes size: 2353
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0067291259765625  GigaBytes
Max Memory Allocated: 0.009780406951904297  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0067291259765625  GigaBytes
Max Memory Allocated: 0.009780406951904297  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011112213134765625  GigaBytes
Max Memory Allocated: 0.011112213134765625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.011112689971923828  GigaBytes
Max Memory Allocated: 0.011112689971923828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0072803497314453125  GigaBytes
Max Memory Allocated: 0.011112689971923828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.00732421875  GigaBytes
Max Memory Allocated: 0.011112689971923828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.00732421875  GigaBytes
Max Memory Allocated: 0.011112689971923828  GigaBytes

first layer input nodes number: 2353
first layer output nodes number: 773
edges number: 4518
----------------------------------------before model layer 0
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007348060607910156  GigaBytes
Max Memory Allocated: 0.011112689971923828  GigaBytes

torch.Size([2353, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007348060607910156  GigaBytes
Max Memory Allocated: 0.011112689971923828  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01051473617553711  GigaBytes
Max Memory Allocated: 0.011220932006835938  GigaBytes

torch.Size([773, 256])
torch.Size([773, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01125192642211914  GigaBytes
Max Memory Allocated: 0.011989116668701172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01051473617553711  GigaBytes
Max Memory Allocated: 0.011989116668701172  GigaBytes

torch.Size([773, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01125192642211914  GigaBytes
Max Memory Allocated: 0.011989116668701172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01143646240234375  GigaBytes
Max Memory Allocated: 0.012173652648925781  GigaBytes

input nodes number: 773
output nodes number: 108
edges number: 1092
----------------------------------------before model layer 1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011443614959716797  GigaBytes
Max Memory Allocated: 0.012173652648925781  GigaBytes

torch.Size([773, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011443614959716797  GigaBytes
Max Memory Allocated: 0.012173652648925781  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01165914535522461  GigaBytes
Max Memory Allocated: 0.012173652648925781  GigaBytes

torch.Size([108, 256])
torch.Size([108, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011762142181396484  GigaBytes
Max Memory Allocated: 0.012173652648925781  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.01165914535522461  GigaBytes
Max Memory Allocated: 0.012173652648925781  GigaBytes

torch.Size([108, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011762142181396484  GigaBytes
Max Memory Allocated: 0.012173652648925781  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011787891387939453  GigaBytes
Max Memory Allocated: 0.012173652648925781  GigaBytes

----------------input nodes number: 108
----------------output nodes number: 15
----------------edges number: 93
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011789321899414062  GigaBytes
Max Memory Allocated: 0.012173652648925781  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011806011199951172  GigaBytes
Max Memory Allocated: 0.012173652648925781  GigaBytes

torch.Size([15, 3])
torch.Size([15, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011806488037109375  GigaBytes
Max Memory Allocated: 0.012173652648925781  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011806011199951172  GigaBytes
Max Memory Allocated: 0.012173652648925781  GigaBytes

torch.Size([15, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011806011199951172  GigaBytes
Max Memory Allocated: 0.012173652648925781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011806964874267578  GigaBytes
Max Memory Allocated: 0.012173652648925781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007418155670166016  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

pseudo mini batch 2 input nodes size: 2433
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0072803497314453125  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0072803497314453125  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011812210083007812  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.011812686920166016  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0074291229248046875  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007468223571777344  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007468223571777344  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

first layer input nodes number: 2433
first layer output nodes number: 675
edges number: 4032
----------------------------------------before model layer 0
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0074920654296875  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

torch.Size([2433, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0074920654296875  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009426593780517578  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

torch.Size([675, 256])
torch.Size([675, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010070323944091797  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.009426593780517578  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

torch.Size([675, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010070323944091797  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010231494903564453  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

input nodes number: 675
output nodes number: 113
edges number: 905
----------------------------------------before model layer 1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010237693786621094  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

torch.Size([675, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010237693786621094  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010461807250976562  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

torch.Size([113, 256])
torch.Size([113, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010569572448730469  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010461807250976562  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

torch.Size([113, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010569572448730469  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010596752166748047  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------input nodes number: 113
----------------output nodes number: 15
----------------edges number: 98
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010598182678222656  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010614871978759766  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

torch.Size([15, 3])
torch.Size([15, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010615348815917969  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010614871978759766  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

torch.Size([15, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010614871978759766  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010615825653076172  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007554531097412109  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

pseudo mini batch 3 input nodes size: 1451
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0074291229248046875  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0074291229248046875  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0101318359375  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.010132312774658203  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0055999755859375  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.005623817443847656  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.005623817443847656  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

first layer input nodes number: 1451
first layer output nodes number: 499
edges number: 2318
----------------------------------------before model layer 0
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.005638599395751953  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

torch.Size([1451, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.005638599395751953  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007064342498779297  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

torch.Size([499, 256])
torch.Size([499, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007540225982666016  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007064342498779297  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

torch.Size([499, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007540225982666016  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007659435272216797  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

input nodes number: 499
output nodes number: 54
edges number: 613
----------------------------------------before model layer 1
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007663726806640625  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

torch.Size([499, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007663726806640625  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0077724456787109375  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

torch.Size([54, 256])
torch.Size([54, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007823944091796875  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.0077724456787109375  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

torch.Size([54, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007823944091796875  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.00783681869506836  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------input nodes number: 54
----------------output nodes number: 15
----------------edges number: 39
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007837772369384766  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007854461669921875  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

torch.Size([15, 3])
torch.Size([15, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007854938507080078  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007854461669921875  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

torch.Size([15, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007854461669921875  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.007855415344238281  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.005678653717041016  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.00857400894165039  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.00857400894165039  GigaBytes
Max Memory Allocated: 0.012943744659423828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.003162980079650879 |0.0868462324142456 |0.20161467790603638 |0.00015729665756225586 |0.0033124685287475586 |0.001581430435180664 |
----------------------------------------------------------pseudo_mini_loss sum 1.1123126745224
Total (block generation + training)time/epoch 1.2418880462646484
Training time/epoch 1.194960117340088
Training time without block to device /epoch 0.8475751876831055
Training time without total dataloading part /epoch 0.8219192028045654
load block tensor time/epoch 0.012651920318603516
block to device time/epoch 0.3473849296569824
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  11254
Number of first layer input nodes during this epoch:  8294
Number of first layer output nodes during this epoch:  2604
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=500, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=500, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=3, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=3, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  388608
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 500])
layers.0.fc_neigh.weight, torch.Size([256, 500])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([3, 256])
layers.2.fc_neigh.weight, torch.Size([3, 256])
----------------------------------------
un-trainable parameters
