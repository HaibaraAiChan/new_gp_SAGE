main start at this time 1657071992.9106722
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02219676971435547
number of batches is  4
batch size is  22736
random selection method spend 0.006676197052001953
time for parepare:  0.018156766891479492
local_output_nid generation:  0.008717775344848633
local_in_edges_tensor generation:  0.009052038192749023
mini_batch_src_global generation:  0.006051301956176758
r_  generation:  0.07445478439331055
local_output_nid generation:  0.011520862579345703
local_in_edges_tensor generation:  0.0058536529541015625
mini_batch_src_global generation:  0.008109092712402344
r_  generation:  0.07967400550842285
local_output_nid generation:  0.011706113815307617
local_in_edges_tensor generation:  0.005616188049316406
mini_batch_src_global generation:  0.006057262420654297
r_  generation:  0.08172726631164551
local_output_nid generation:  0.012238264083862305
local_in_edges_tensor generation:  0.0057294368743896484
mini_batch_src_global generation:  0.006700992584228516
r_  generation:  0.08534955978393555
----------------------check_connections_block total spend ----------------------------- 0.5127291679382324
generate_one_block  0.09497380256652832
generate_one_block  0.09595203399658203
generate_one_block  0.09566855430603027
generate_one_block  0.10028457641601562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.033574581146240234
gen group dst list time:  0.010811090469360352
time for parepare:  0.01880621910095215
local_output_nid generation:  0.018243074417114258
local_in_edges_tensor generation:  0.03742170333862305
mini_batch_src_global generation:  0.03484487533569336
r_  generation:  0.34240031242370605
local_output_nid generation:  0.02378082275390625
local_in_edges_tensor generation:  0.03484511375427246
mini_batch_src_global generation:  0.043100833892822266
r_  generation:  0.35518884658813477
local_output_nid generation:  0.024494647979736328
local_in_edges_tensor generation:  0.029781579971313477
mini_batch_src_global generation:  0.051403045654296875
r_  generation:  0.3607509136199951
local_output_nid generation:  0.028223276138305664
local_in_edges_tensor generation:  0.029515743255615234
mini_batch_src_global generation:  0.04152679443359375
r_  generation:  0.36232924461364746
----------------------check_connections_block total spend ----------------------------- 2.1609530448913574
generate_one_block  0.46727967262268066
generate_one_block  0.47098851203918457
generate_one_block  0.4687044620513916
generate_one_block  0.46546149253845215
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.01983785629272461
gen group dst list time:  0.02061176300048828
time for parepare:  0.018660306930541992
local_output_nid generation:  0.028204917907714844
local_in_edges_tensor generation:  0.04010605812072754
mini_batch_src_global generation:  0.02959299087524414
r_  generation:  0.35454893112182617
local_output_nid generation:  0.0350799560546875
local_in_edges_tensor generation:  0.035361289978027344
mini_batch_src_global generation:  0.03697013854980469
r_  generation:  0.35878682136535645
local_output_nid generation:  0.03557085990905762
local_in_edges_tensor generation:  0.04544782638549805
mini_batch_src_global generation:  0.034646034240722656
r_  generation:  0.36827874183654785
local_output_nid generation:  0.0355687141418457
local_in_edges_tensor generation:  0.03981184959411621
mini_batch_src_global generation:  0.036696434020996094
r_  generation:  0.37532901763916016
----------------------check_connections_block total spend ----------------------------- 2.2431116104125977
generate_one_block  0.437999963760376
generate_one_block  0.4470236301422119
generate_one_block  0.44537806510925293
generate_one_block  0.4724612236022949
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

connection checking time:  4.404064655303955
block generation total time  3.6752970218658447
average batch blocks generation time:  0.9188242554664612
block dataloader generation time/epoch 9.32198166847229
pseudo mini batch 0 input nodes size: 162200
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.0789337158203125  GigaBytes
Max Memory Allocated: 0.0789337158203125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.07910346984863281  GigaBytes
Max Memory Allocated: 0.07910346984863281  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0955810546875 GB
    Memory Allocated: 0.07910346984863281  GigaBytes
Max Memory Allocated: 0.07910346984863281  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1815185546875 GB
    Memory Allocated: 0.09621143341064453  GigaBytes
Max Memory Allocated: 0.09621143341064453  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1815185546875 GB
    Memory Allocated: 0.09621143341064453  GigaBytes
Max Memory Allocated: 0.09621143341064453  GigaBytes

first layer input nodes number: 162200
first layer output nodes number: 152194
edges number: 1003422
----------------------------------------before model layer 0
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.09855461120605469  GigaBytes
Max Memory Allocated: 0.10229301452636719  GigaBytes

torch.Size([162200, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2010498046875 GB
    Memory Allocated: 0.09855461120605469  GigaBytes
Max Memory Allocated: 0.10229301452636719  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.7635498046875 GB
    Memory Allocated: 0.3243141174316406  GigaBytes
Max Memory Allocated: 0.3243141174316406  GigaBytes

torch.Size([152194, 256])
torch.Size([152194, 256])
----------------------------------------after rst
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.46945762634277344  GigaBytes
Max Memory Allocated: 0.6146011352539062  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.3243141174316406  GigaBytes
Max Memory Allocated: 0.6146011352539062  GigaBytes

torch.Size([152194, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.46945762634277344  GigaBytes
Max Memory Allocated: 0.6146011352539062  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5057435035705566  GigaBytes
Max Memory Allocated: 0.6508870124816895  GigaBytes

input nodes number: 152194
output nodes number: 97738
edges number: 1097705
----------------------------------------before model layer 1
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5078129768371582  GigaBytes
Max Memory Allocated: 0.6508870124816895  GigaBytes

torch.Size([152194, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.0565185546875 GB
    Memory Allocated: 0.5078129768371582  GigaBytes
Max Memory Allocated: 0.6508870124816895  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.7036805152893066  GigaBytes
Max Memory Allocated: 0.7036805152893066  GigaBytes

torch.Size([97738, 256])
torch.Size([97738, 256])
----------------------------------------after rst
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.7974305152893066  GigaBytes
Max Memory Allocated: 0.8911805152893066  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.7042202949523926  GigaBytes
Max Memory Allocated: 0.8911805152893066  GigaBytes

torch.Size([97738, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.7979702949523926  GigaBytes
Max Memory Allocated: 0.8911805152893066  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.3572998046875 GB
    Memory Allocated: 0.8207330703735352  GigaBytes
Max Memory Allocated: 0.9144830703735352  GigaBytes

----------------input nodes number: 97738
----------------output nodes number: 22736
----------------edges number: 194932
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3592529296875 GB
    Memory Allocated: 0.8216314315795898  GigaBytes
Max Memory Allocated: 0.9144830703735352  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.8483242988586426  GigaBytes
Max Memory Allocated: 0.9144830703735352  GigaBytes

torch.Size([22736, 40])
torch.Size([22736, 40])
----------------------------------------after rst
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.8517122268676758  GigaBytes
Max Memory Allocated: 0.9144830703735352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.8483242988586426  GigaBytes
Max Memory Allocated: 0.9144830703735352  GigaBytes

torch.Size([22736, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.8517122268676758  GigaBytes
Max Memory Allocated: 0.9144830703735352  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3612060546875 GB
    Memory Allocated: 0.8551011085510254  GigaBytes
Max Memory Allocated: 0.9144830703735352  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.13440752029418945  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

pseudo mini batch 1 input nodes size: 162215
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.08330106735229492  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.08330106735229492  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.16065120697021484  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.16082096099853516  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.08252620697021484  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.10039663314819336  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.10039663314819336  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

first layer input nodes number: 162215
first layer output nodes number: 152139
edges number: 1003357
----------------------------------------before model layer 0
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.10352945327758789  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

torch.Size([162215, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.10352945327758789  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.3292088508605957  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

torch.Size([152139, 256])
torch.Size([152139, 256])
----------------------------------------after rst
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.47429990768432617  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.3292088508605957  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

torch.Size([152139, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.47429990768432617  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.5105729103088379  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

input nodes number: 152139
output nodes number: 97958
edges number: 1104010
----------------------------------------before model layer 1
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.5126962661743164  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

torch.Size([152139, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.5126962661743164  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.7091531753540039  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

torch.Size([97958, 256])
torch.Size([97958, 256])
----------------------------------------after rst
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.8025732040405273  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.7088232040405273  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

torch.Size([97958, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.8025732040405273  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.8259282112121582  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

----------------input nodes number: 97958
----------------output nodes number: 22736
----------------edges number: 197314
----------------------------------------before mean aggregator
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.8268280029296875  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.853538990020752  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

torch.Size([22736, 40])
torch.Size([22736, 40])
----------------------------------------after rst
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.8569269180297852  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.853538990020752  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

torch.Size([22736, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.853538990020752  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9901123046875 GB
    Memory Allocated: 0.8569273948669434  GigaBytes
Max Memory Allocated: 1.0159506797790527  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.13609647750854492  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

pseudo mini batch 2 input nodes size: 162208
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.08252620697021484  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.08252620697021484  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.16065120697021484  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.16082096099853516  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.08330106735229492  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10090923309326172  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10090923309326172  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

first layer input nodes number: 162208
first layer output nodes number: 152241
edges number: 1003517
----------------------------------------before model layer 0
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10325241088867188  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

torch.Size([162208, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10325241088867188  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.32991838455200195  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

torch.Size([152241, 256])
torch.Size([152241, 256])
----------------------------------------after rst
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.47510671615600586  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.32991838455200195  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

torch.Size([152241, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.47510671615600586  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.5114040374755859  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

input nodes number: 152241
output nodes number: 98066
edges number: 1104679
----------------------------------------before model layer 1
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.5134310722351074  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

torch.Size([152241, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.5134310722351074  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.7106199264526367  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

torch.Size([98066, 256])
torch.Size([98066, 256])
----------------------------------------after rst
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.8043699264526367  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.7106199264526367  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

torch.Size([98066, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.8043699264526367  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.8277506828308105  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

----------------input nodes number: 98066
----------------output nodes number: 22736
----------------edges number: 196522
----------------------------------------before mean aggregator
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.8286514282226562  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.8553566932678223  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

torch.Size([22736, 40])
torch.Size([22736, 40])
----------------------------------------after rst
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.8587446212768555  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.8553566932678223  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

torch.Size([22736, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.8553566932678223  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.8587450981140137  GigaBytes
Max Memory Allocated: 1.0173897743225098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.13688945770263672  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

pseudo mini batch 3 input nodes size: 162179
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.08330106735229492  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.08330106735229492  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.16063404083251953  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.16080379486083984  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.08250904083251953  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.0997171401977539  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.0997171401977539  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

first layer input nodes number: 162179
first layer output nodes number: 152346
edges number: 1004500
----------------------------------------before model layer 0
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10206747055053711  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

torch.Size([162179, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.10206747055053711  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.3280525207519531  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

torch.Size([152346, 256])
torch.Size([152346, 256])
----------------------------------------after rst
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.4733409881591797  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.3280525207519531  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

torch.Size([152346, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.4733409881591797  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.5096631050109863  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

input nodes number: 152346
output nodes number: 98261
edges number: 1108439
----------------------------------------before model layer 1
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.5115914344787598  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

torch.Size([152346, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.5115914344787598  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.7087564468383789  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

torch.Size([98261, 256])
torch.Size([98261, 256])
----------------------------------------after rst
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.8024654388427734  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.7087154388427734  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

torch.Size([98261, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.8024654388427734  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.8258929252624512  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

----------------input nodes number: 98261
----------------output nodes number: 22733
----------------edges number: 196492
----------------------------------------before mean aggregator
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.8267951011657715  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.8534975051879883  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

torch.Size([22733, 40])
torch.Size([22733, 40])
----------------------------------------after rst
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.8568854331970215  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.8534975051879883  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

torch.Size([22733, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.8534975051879883  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.8568859100341797  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.13445663452148438  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.13607406616210938  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.9920654296875 GB
    Memory Allocated: 0.13607406616210938  GigaBytes
Max Memory Allocated: 1.0193052291870117  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.027075767517089844 |0.08666735887527466 |0.21797072887420654 |0.00019353628158569336 |0.011640310287475586 |0.0040395259857177734 |
----------------------------------------------------------pseudo_mini_loss sum 4.59714412689209
Total (block generation + training)time/epoch 10.714929580688477
Training time/epoch 1.3926832675933838
Training time without block to device /epoch 1.0460138320922852
Training time without total dataloading part /epoch 0.9232578277587891
load block tensor time/epoch 0.10830307006835938
block to device time/epoch 0.34666943550109863
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1649745
Number of first layer input nodes during this epoch:  648802
Number of first layer output nodes during this epoch:  608920
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  217088
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([40, 256])
layers.2.fc_neigh.weight, torch.Size([40, 256])
----------------------------------------
un-trainable parameters
