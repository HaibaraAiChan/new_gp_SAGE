main start at this time 1657072515.818711
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  602
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017147064208984375  GigaBytes
Max Memory Allocated: 0.0017147064208984375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017147064208984375  GigaBytes
Max Memory Allocated: 0.0017147064208984375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3304939270019531
global_2_local spend time (sec) 0.05840015411376953
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.017813444137573242
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({30: 132904, 0: 71192, 1: 1391, 2: 1221, 3: 1053, 4: 986, 5: 920, 6: 875, 7: 814, 8: 799, 11: 702, 9: 695, 13: 691, 10: 690, 12: 684, 14: 652, 15: 643, 16: 607, 19: 606, 17: 598, 18: 563, 21: 562, 22: 556, 23: 543, 20: 538, 28: 532, 27: 528, 25: 525, 26: 521, 24: 521, 29: 511})

A = g.adjacency_matrix() spent  0.06423377990722656
auxiliary_graph
Graph(num_nodes=224623, num_edges=205357019,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.1159520149230957
remove nodes length  71192

auxiliary_graph.remove_nodes spent  10.125195980072021
after remove non output nodes the auxiliary_graph
Graph(num_nodes=153431, num_edges=205357019,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  8.084864854812622

the counter of shared neighbor distribution
Counter({1.0: 188777130, 2.0: 13023222, 3.0: 2028012, 4.0: 618458, 5.0: 280804, 6.0: 151834, 7.0: 91670, 8.0: 58900, 9.0: 41228, 10.0: 29572, 11.0: 21504, 12.0: 16186, 13.0: 12610, 14.0: 9636, 15.0: 7654, 16.0: 6272, 17.0: 4990, 18.0: 4596, 19.0: 3764, 20.0: 3034, 21.0: 2596, 22.0: 2018, 23.0: 1648, 25.0: 1556, 24.0: 1394, 26.0: 1266, 27.0: 1144, 28.0: 688, 29.0: 200, 30.0: 2})
205203588
Convert a graph into a bidirected graph: 13.863 seconds
Metis partitioning: 55.735 seconds
Split the graph: 7.149 seconds
Construct subgraphs: 0.061 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  76.90049719810486
19468
19688
18619
19692
18619
18725
19019
19601
total k batches seeds list generation spend  122.6669933795929
after graph partition
graph partition algorithm spend time 123.15427017211914
19468
19688
18619
19692
18619
18725
19019
19601
partition_len_list
[45481, 56629, 71987, 52915, 68575, 71488, 73570, 73142]
REG selection method  spend 123.30418133735657
time for parepare:  0.031098604202270508
local_output_nid generation:  0.00452423095703125
local_in_edges_tensor generation:  0.00825810432434082
mini_batch_src_global generation:  0.01975846290588379
r_  generation:  0.1564655303955078
local_output_nid generation:  0.006072282791137695
local_in_edges_tensor generation:  0.012834310531616211
mini_batch_src_global generation:  0.02346348762512207
r_  generation:  0.16722536087036133
local_output_nid generation:  0.006195783615112305
local_in_edges_tensor generation:  0.00931239128112793
mini_batch_src_global generation:  0.02387094497680664
r_  generation:  0.1619575023651123
local_output_nid generation:  0.00627589225769043
local_in_edges_tensor generation:  0.009819507598876953
mini_batch_src_global generation:  0.02635025978088379
r_  generation:  0.16963887214660645
local_output_nid generation:  0.006140947341918945
local_in_edges_tensor generation:  0.008800506591796875
mini_batch_src_global generation:  0.02390003204345703
r_  generation:  0.16674304008483887
local_output_nid generation:  0.006946563720703125
local_in_edges_tensor generation:  0.03613114356994629
mini_batch_src_global generation:  0.027186870574951172
r_  generation:  0.18547725677490234
local_output_nid generation:  0.008294343948364258
local_in_edges_tensor generation:  0.010321855545043945
mini_batch_src_global generation:  0.02158212661743164
r_  generation:  0.18175458908081055
local_output_nid generation:  0.005973339080810547
local_in_edges_tensor generation:  0.008544921875
mini_batch_src_global generation:  0.024547100067138672
r_  generation:  0.1578688621520996
----------------------check_connections_block total spend ----------------------------- 2.0334014892578125
generate_one_block  0.24042320251464844
generate_one_block  0.2667264938354492
generate_one_block  0.28698039054870605
generate_one_block  0.2745940685272217
generate_one_block  0.2881145477294922
generate_one_block  0.33356547355651855
generate_one_block  0.2436985969543457
generate_one_block  0.24632477760314941
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.671745777130127
gen group dst list time:  0.01586127281188965
time for parepare:  0.034093379974365234
local_output_nid generation:  0.009496688842773438
local_in_edges_tensor generation:  0.06461119651794434
mini_batch_src_global generation:  0.03269362449645996
r_  generation:  0.32863879203796387
local_output_nid generation:  0.014508962631225586
local_in_edges_tensor generation:  0.034349918365478516
mini_batch_src_global generation:  0.0523531436920166
r_  generation:  0.42505836486816406
local_output_nid generation:  0.01887202262878418
local_in_edges_tensor generation:  0.039156198501586914
mini_batch_src_global generation:  0.059792280197143555
r_  generation:  0.5879707336425781
local_output_nid generation:  0.01934504508972168
local_in_edges_tensor generation:  0.020781278610229492
mini_batch_src_global generation:  0.0516514778137207
r_  generation:  0.42278265953063965
local_output_nid generation:  0.017341136932373047
local_in_edges_tensor generation:  0.0296475887298584
mini_batch_src_global generation:  0.05907130241394043
r_  generation:  0.5582883358001709
local_output_nid generation:  0.018281936645507812
local_in_edges_tensor generation:  0.029349803924560547
mini_batch_src_global generation:  0.07330608367919922
r_  generation:  0.573960542678833
local_output_nid generation:  0.020731687545776367
local_in_edges_tensor generation:  0.04030251502990723
mini_batch_src_global generation:  0.0665431022644043
r_  generation:  0.5727205276489258
local_output_nid generation:  0.019018888473510742
local_in_edges_tensor generation:  0.030032873153686523
mini_batch_src_global generation:  0.06682634353637695
r_  generation:  0.5846166610717773
----------------------check_connections_block total spend ----------------------------- 5.748115062713623
generate_one_block  0.5907022953033447
generate_one_block  0.6761984825134277
generate_one_block  0.8169913291931152
generate_one_block  0.5895330905914307
generate_one_block  0.8096208572387695
generate_one_block  0.7935101985931396
generate_one_block  0.8256299495697021
generate_one_block  0.7591838836669922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.26991796493530273
gen group dst list time:  0.045108795166015625
time for parepare:  0.03147244453430176
local_output_nid generation:  0.03301215171813965
local_in_edges_tensor generation:  0.061597347259521484
mini_batch_src_global generation:  0.04529571533203125
r_  generation:  0.525752067565918
local_output_nid generation:  0.040396928787231445
local_in_edges_tensor generation:  0.05525827407836914
mini_batch_src_global generation:  0.05955243110656738
r_  generation:  0.5745899677276611
local_output_nid generation:  0.048209190368652344
local_in_edges_tensor generation:  0.07098722457885742
mini_batch_src_global generation:  0.06471800804138184
r_  generation:  0.6909844875335693
local_output_nid generation:  0.03905010223388672
local_in_edges_tensor generation:  0.047556161880493164
mini_batch_src_global generation:  0.06411457061767578
r_  generation:  0.610346794128418
local_output_nid generation:  0.0448150634765625
local_in_edges_tensor generation:  0.0511624813079834
mini_batch_src_global generation:  0.063720703125
r_  generation:  0.6441330909729004
local_output_nid generation:  0.0459749698638916
local_in_edges_tensor generation:  0.058060646057128906
mini_batch_src_global generation:  0.06650257110595703
r_  generation:  0.6650807857513428
local_output_nid generation:  0.04625558853149414
local_in_edges_tensor generation:  0.05009269714355469
mini_batch_src_global generation:  0.07135272026062012
r_  generation:  0.6682455539703369
local_output_nid generation:  0.045554399490356445
local_in_edges_tensor generation:  0.04242205619812012
mini_batch_src_global generation:  0.06695127487182617
r_  generation:  0.6570985317230225
----------------------check_connections_block total spend ----------------------------- 7.3784003257751465
generate_one_block  0.8738594055175781
generate_one_block  0.7632513046264648
generate_one_block  0.9394063949584961
generate_one_block  0.6732332706451416
generate_one_block  0.7473523616790771
generate_one_block  0.7958214282989502
generate_one_block  0.7904202938079834
generate_one_block  0.7581408023834229
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017147064208984375  GigaBytes
Max Memory Allocated: 0.0017147064208984375  GigaBytes

connection checking time:  15.159916877746582
block generation total time  14.383282899856567
average batch blocks generation time:  0.5993034541606903
block dataloader generation time/epoch 154.9971718788147
pseudo mini batch 0 input nodes size: 200012
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017147064208984375  GigaBytes
Max Memory Allocated: 0.0017147064208984375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017147064208984375  GigaBytes
Max Memory Allocated: 0.0017147064208984375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.45093345642089844  GigaBytes
Max Memory Allocated: 0.45093345642089844  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.4510788917541504  GigaBytes
Max Memory Allocated: 0.4510788917541504  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.4510788917541504  GigaBytes
Max Memory Allocated: 0.4510788917541504  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5701904296875 GB
    Memory Allocated: 0.47471094131469727  GigaBytes
Max Memory Allocated: 0.47471094131469727  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5701904296875 GB
    Memory Allocated: 0.47471094131469727  GigaBytes
Max Memory Allocated: 0.47471094131469727  GigaBytes

first layer input nodes number: 200012
first layer output nodes number: 147262
edges number: 1466456
----------------------------------------before model layer 0
 Nvidia-smi: 1.5701904296875 GB
    Memory Allocated: 0.4772987365722656  GigaBytes
Max Memory Allocated: 0.48276185989379883  GigaBytes

torch.Size([200012, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.5701904296875 GB
    Memory Allocated: 0.4772987365722656  GigaBytes
Max Memory Allocated: 0.48276185989379883  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7791748046875 GB
    Memory Allocated: 0.9594674110412598  GigaBytes
Max Memory Allocated: 1.1498298645019531  GigaBytes

torch.Size([147262, 256])
torch.Size([147262, 256])
----------------------------------------after rst
 Nvidia-smi: 2.9197998046875 GB
    Memory Allocated: 1.1000924110412598  GigaBytes
Max Memory Allocated: 1.240532398223877  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.9197998046875 GB
    Memory Allocated: 0.9596524238586426  GigaBytes
Max Memory Allocated: 1.240532398223877  GigaBytes

torch.Size([147262, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.9197998046875 GB
    Memory Allocated: 1.1000924110412598  GigaBytes
Max Memory Allocated: 1.240532398223877  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.9197998046875 GB
    Memory Allocated: 1.135202407836914  GigaBytes
Max Memory Allocated: 1.2756423950195312  GigaBytes

input nodes number: 147262
output nodes number: 45481
edges number: 1107949
----------------------------------------before model layer 1
 Nvidia-smi: 2.9197998046875 GB
    Memory Allocated: 1.1373190879821777  GigaBytes
Max Memory Allocated: 1.2756423950195312  GigaBytes

torch.Size([147262, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.9197998046875 GB
    Memory Allocated: 1.1373190879821777  GigaBytes
Max Memory Allocated: 1.2756423950195312  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.9197998046875 GB
    Memory Allocated: 1.2326617240905762  GigaBytes
Max Memory Allocated: 1.2756423950195312  GigaBytes

torch.Size([45481, 256])
torch.Size([45481, 256])
----------------------------------------after rst
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.2760357856750488  GigaBytes
Max Memory Allocated: 1.3194098472595215  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.2326617240905762  GigaBytes
Max Memory Allocated: 1.3194098472595215  GigaBytes

torch.Size([45481, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.2760357856750488  GigaBytes
Max Memory Allocated: 1.3194098472595215  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.286879539489746  GigaBytes
Max Memory Allocated: 1.3302536010742188  GigaBytes

----------------input nodes number: 45481
----------------output nodes number: 19468
----------------edges number: 550354
----------------------------------------before mean aggregator
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.2873640060424805  GigaBytes
Max Memory Allocated: 1.3302536010742188  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.313389778137207  GigaBytes
Max Memory Allocated: 1.3302536010742188  GigaBytes

torch.Size([19468, 41])
torch.Size([19468, 41])
----------------------------------------after rst
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.3163633346557617  GigaBytes
Max Memory Allocated: 1.3302536010742188  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.313216209411621  GigaBytes
Max Memory Allocated: 1.3302536010742188  GigaBytes

torch.Size([19468, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.3163633346557617  GigaBytes
Max Memory Allocated: 1.3302536010742188  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.3198280334472656  GigaBytes
Max Memory Allocated: 1.3302536010742188  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.5219764709472656  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

pseudo mini batch 1 input nodes size: 203674
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.45594167709350586  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.4412841796875 GB
    Memory Allocated: 0.45594167709350586  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8983154296875 GB
    Memory Allocated: 0.9129729270935059  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8983154296875 GB
    Memory Allocated: 0.9131197929382324  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8983154296875 GB
    Memory Allocated: 0.46375560760498047  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8983154296875 GB
    Memory Allocated: 0.49067211151123047  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8983154296875 GB
    Memory Allocated: 0.49067211151123047  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

first layer input nodes number: 203674
first layer output nodes number: 160222
edges number: 1593456
----------------------------------------before model layer 0
 Nvidia-smi: 3.8983154296875 GB
    Memory Allocated: 0.49338388442993164  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

torch.Size([203674, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.8983154296875 GB
    Memory Allocated: 0.49338388442993164  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 1.0180277824401855  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

torch.Size([160222, 256])
torch.Size([160222, 256])
----------------------------------------after rst
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 1.1708273887634277  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 1.0180277824401855  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

torch.Size([160222, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 1.1708273887634277  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 1.2090272903442383  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

input nodes number: 160222
output nodes number: 56629
edges number: 1379844
----------------------------------------before model layer 1
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 1.2110710144042969  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

torch.Size([160222, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 1.2110710144042969  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 1.3297863006591797  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

torch.Size([56629, 256])
torch.Size([56629, 256])
----------------------------------------after rst
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 1.3837919235229492  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 1.3297863006591797  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

torch.Size([56629, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 1.3837919235229492  GigaBytes
Max Memory Allocated: 1.4485068321228027  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 1.3972935676574707  GigaBytes
Max Memory Allocated: 1.4512991905212402  GigaBytes

----------------input nodes number: 56629
----------------output nodes number: 19688
----------------edges number: 553087
----------------------------------------before mean aggregator
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 1.397862434387207  GigaBytes
Max Memory Allocated: 1.4512991905212402  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 1.425333023071289  GigaBytes
Max Memory Allocated: 1.4512991905212402  GigaBytes

torch.Size([19688, 41])
torch.Size([19688, 41])
----------------------------------------after rst
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 1.4283404350280762  GigaBytes
Max Memory Allocated: 1.4512991905212402  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 1.4243712425231934  GigaBytes
Max Memory Allocated: 1.4512991905212402  GigaBytes

torch.Size([19688, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 1.4242315292358398  GigaBytes
Max Memory Allocated: 1.4512991905212402  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.2850341796875 GB
    Memory Allocated: 1.4282011985778809  GigaBytes
Max Memory Allocated: 1.4512991905212402  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2987060546875 GB
    Memory Allocated: 0.5399389266967773  GigaBytes
Max Memory Allocated: 1.5487127304077148  GigaBytes

pseudo mini batch 2 input nodes size: 212745
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2987060546875 GB
    Memory Allocated: 0.46361589431762695  GigaBytes
Max Memory Allocated: 1.5487127304077148  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2987060546875 GB
    Memory Allocated: 0.46361589431762695  GigaBytes
Max Memory Allocated: 1.5487127304077148  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.7772216796875 GB
    Memory Allocated: 0.9407234191894531  GigaBytes
Max Memory Allocated: 1.5487127304077148  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 4.7772216796875 GB
    Memory Allocated: 0.9408621788024902  GigaBytes
Max Memory Allocated: 1.5487127304077148  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.7772216796875 GB
    Memory Allocated: 0.48368406295776367  GigaBytes
Max Memory Allocated: 1.5487127304077148  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.7772216796875 GB
    Memory Allocated: 0.5144996643066406  GigaBytes
Max Memory Allocated: 1.5487127304077148  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.7772216796875 GB
    Memory Allocated: 0.5144996643066406  GigaBytes
Max Memory Allocated: 1.5487127304077148  GigaBytes

first layer input nodes number: 212745
first layer output nodes number: 185780
edges number: 1846216
----------------------------------------before model layer 0
 Nvidia-smi: 4.7772216796875 GB
    Memory Allocated: 0.5174932479858398  GigaBytes
Max Memory Allocated: 1.5487127304077148  GigaBytes

torch.Size([212745, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 4.7772216796875 GB
    Memory Allocated: 0.5174932479858398  GigaBytes
Max Memory Allocated: 1.5487127304077148  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 1.1257500648498535  GigaBytes
Max Memory Allocated: 1.5487127304077148  GigaBytes

torch.Size([185780, 256])
torch.Size([185780, 256])
----------------------------------------after rst
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 1.3029236793518066  GigaBytes
Max Memory Allocated: 1.5487127304077148  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 1.1257500648498535  GigaBytes
Max Memory Allocated: 1.5487127304077148  GigaBytes

torch.Size([185780, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 1.3029236793518066  GigaBytes
Max Memory Allocated: 1.5487127304077148  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 1.3478455543518066  GigaBytes
Max Memory Allocated: 1.5487127304077148  GigaBytes

input nodes number: 185780
output nodes number: 71987
edges number: 1759231
----------------------------------------before model layer 1
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 1.3497662544250488  GigaBytes
Max Memory Allocated: 1.5487127304077148  GigaBytes

torch.Size([185780, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 1.3497662544250488  GigaBytes
Max Memory Allocated: 1.5487127304077148  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 1.5007147789001465  GigaBytes
Max Memory Allocated: 1.5487127304077148  GigaBytes

torch.Size([71987, 256])
torch.Size([71987, 256])
----------------------------------------after rst
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 1.5693669319152832  GigaBytes
Max Memory Allocated: 1.63801908493042  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 1.5007147789001465  GigaBytes
Max Memory Allocated: 1.63801908493042  GigaBytes

torch.Size([71987, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 1.5693669319152832  GigaBytes
Max Memory Allocated: 1.63801908493042  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 1.5865302085876465  GigaBytes
Max Memory Allocated: 1.6551823616027832  GigaBytes

----------------input nodes number: 71987
----------------output nodes number: 18619
----------------edges number: 521117
----------------------------------------before mean aggregator
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 1.587205410003662  GigaBytes
Max Memory Allocated: 1.6551823616027832  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 1.6123900413513184  GigaBytes
Max Memory Allocated: 1.6551823616027832  GigaBytes

torch.Size([18619, 41])
torch.Size([18619, 41])
----------------------------------------after rst
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 1.6152338981628418  GigaBytes
Max Memory Allocated: 1.6551823616027832  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 1.6121034622192383  GigaBytes
Max Memory Allocated: 1.6551823616027832  GigaBytes

torch.Size([18619, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 1.6122264862060547  GigaBytes
Max Memory Allocated: 1.6551823616027832  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.8377685546875 GB
    Memory Allocated: 1.6155476570129395  GigaBytes
Max Memory Allocated: 1.6551823616027832  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.5702157020568848  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

pseudo mini batch 3 input nodes size: 199003
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.4838070869445801  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.4838070869445801  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.9300961494445801  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.9302430152893066  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.45299673080444336  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.47832298278808594  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.47832298278808594  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

first layer input nodes number: 199003
first layer output nodes number: 151192
edges number: 1503710
----------------------------------------before model layer 0
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.481112003326416  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([199003, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.481112003326416  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.9761343002319336  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([151192, 256])
torch.Size([151192, 256])
----------------------------------------after rst
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.1203222274780273  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.9761343002319336  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([151192, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.1203222274780273  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.1563692092895508  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

input nodes number: 151192
output nodes number: 52915
edges number: 1291286
----------------------------------------before model layer 1
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.1578903198242188  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([151192, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.1578903198242188  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.26912260055542  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([52915, 256])
torch.Size([52915, 256])
----------------------------------------after rst
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.3195862770080566  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.26912260055542  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([52915, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.3195862770080566  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.332202434539795  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------input nodes number: 52915
----------------output nodes number: 19692
----------------edges number: 559777
----------------------------------------before mean aggregator
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.3327436447143555  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.3588495254516602  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([19692, 41])
torch.Size([19692, 41])
----------------------------------------after rst
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.3618574142456055  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.3588495254516602  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([19692, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.3588051795959473  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.361936092376709  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.5247969627380371  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

pseudo mini batch 4 input nodes size: 207758
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.45295238494873047  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.45295238494873047  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.9188756942749023  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.9190144538879395  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.4725785255432129  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.501716136932373  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.501716136932373  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

first layer input nodes number: 207758
first layer output nodes number: 171307
edges number: 1702813
----------------------------------------before model layer 0
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.5051255226135254  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([207758, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.5051255226135254  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.06666898727417  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([171307, 256])
torch.Size([171307, 256])
----------------------------------------after rst
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.2300400733947754  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.06666898727417  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([171307, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.2300400733947754  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.2708830833435059  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

input nodes number: 171307
output nodes number: 68575
edges number: 1680248
----------------------------------------before model layer 1
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.2726707458496094  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([171307, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.2726707458496094  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.4164972305297852  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([68575, 256])
torch.Size([68575, 256])
----------------------------------------after rst
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.4818954467773438  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.4164972305297852  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([68575, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.4818954467773438  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.4982452392578125  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------input nodes number: 68575
----------------output nodes number: 18619
----------------edges number: 527541
----------------------------------------before mean aggregator
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.4988951683044434  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.524740219116211  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([18619, 41])
torch.Size([18619, 41])
----------------------------------------after rst
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.5275840759277344  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.5244026184082031  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([18619, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.5244979858398438  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 1.5279030799865723  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.5566091537475586  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

pseudo mini batch 5 input nodes size: 211850
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.4726738929748535  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.0076904296875 GB
    Memory Allocated: 0.4726738929748535  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.9477744102478027  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.9479141235351562  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.48185205459594727  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.512275218963623  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.512275218963623  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

first layer input nodes number: 211850
first layer output nodes number: 180339
edges number: 1793510
----------------------------------------before model layer 0
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.5153160095214844  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([211850, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.5153160095214844  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.1057682037353516  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([180339, 256])
torch.Size([180339, 256])
----------------------------------------after rst
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.2777528762817383  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.1057682037353516  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([180339, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.2777528762817383  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.320749282836914  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

input nodes number: 180339
output nodes number: 71488
edges number: 1755707
----------------------------------------before model layer 1
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.3227510452270508  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([180339, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.3227510452270508  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.4727182388305664  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([71488, 256])
torch.Size([71488, 256])
----------------------------------------after rst
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.5408945083618164  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.4727182388305664  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([71488, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.5408945083618164  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.557938575744629  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------input nodes number: 71488
----------------output nodes number: 18725
----------------edges number: 533974
----------------------------------------before mean aggregator
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.5586109161376953  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.5837883949279785  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([18725, 41])
torch.Size([18725, 41])
----------------------------------------after rst
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.5866484642028809  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.5837883949279785  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([18725, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.5840559005737305  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.586916446685791  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.5691933631896973  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

pseudo mini batch 6 input nodes size: 212315
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.4821195602416992  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.4821195602416992  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.9582624435424805  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.958404541015625  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.48316431045532227  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.514866828918457  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.514866828918457  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

first layer input nodes number: 212315
first layer output nodes number: 181613
edges number: 1796482
----------------------------------------before model layer 0
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.5178022384643555  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([212315, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.5178022384643555  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.1123542785644531  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([181613, 256])
torch.Size([181613, 256])
----------------------------------------after rst
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.2855539321899414  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.1123542785644531  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([181613, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.2855539321899414  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.3288540840148926  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

input nodes number: 181613
output nodes number: 73570
edges number: 1759417
----------------------------------------before model layer 1
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.331024169921875  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([181613, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.331024169921875  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.485306739807129  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([73570, 256])
torch.Size([73570, 256])
----------------------------------------after rst
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.555769920349121  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.4856081008911133  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([73570, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.555769920349121  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.573310375213623  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------input nodes number: 73570
----------------output nodes number: 19019
----------------edges number: 498810
----------------------------------------before mean aggregator
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.5740008354187012  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.6006550788879395  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([19019, 41])
torch.Size([19019, 41])
----------------------------------------after rst
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.6040334701538086  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.6003170013427734  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([19019, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.5997734069824219  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.6032228469848633  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.5709009170532227  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

pseudo mini batch 7 input nodes size: 208922
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.4826207160949707  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.4826207160949707  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.9511547088623047  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.951301097869873  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.47501611709594727  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.5051169395446777  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.5051169395446777  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

first layer input nodes number: 208922
first layer output nodes number: 177947
edges number: 1757699
----------------------------------------before model layer 0
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.5081539154052734  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([208922, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.5081539154052734  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.0906858444213867  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([177947, 256])
torch.Size([177947, 256])
----------------------------------------after rst
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.2603893280029297  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.0906858444213867  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([177947, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.2603893280029297  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.3028154373168945  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

input nodes number: 177947
output nodes number: 73142
edges number: 1737467
----------------------------------------before model layer 1
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.3048605918884277  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([177947, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.3048605918884277  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.4578585624694824  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([73142, 256])
torch.Size([73142, 256])
----------------------------------------after rst
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.5276122093200684  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.4578585624694824  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([73142, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.5276122093200684  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.5450506210327148  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------input nodes number: 73142
----------------output nodes number: 19601
----------------edges number: 504132
----------------------------------------before mean aggregator
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.5457420349121094  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.5719499588012695  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([19601, 41])
torch.Size([19601, 41])
----------------------------------------after rst
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.5755419731140137  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.5725479125976562  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

torch.Size([19601, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.572636604309082  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 1.5756311416625977  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.4842529296875 GB
    Memory Allocated: 0.560204029083252  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.4881591796875 GB
    Memory Allocated: 0.5636334419250488  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.4881591796875 GB
    Memory Allocated: 0.5636334419250488  GigaBytes
Max Memory Allocated: 1.7404675483703613  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.17400649189949036 |0.059873372316360474 |0.13055619597434998 |0.00017008185386657715 |0.00666433572769165 |0.0020935535430908203 |
----------------------------------------------------------pseudo_mini_loss sum 10.781656265258789
Total (block generation + training)time/epoch 158.01165127754211
Training time/epoch 3.0141987800598145
Training time without block to device /epoch 2.5352118015289307
Training time without total dataloading part /epoch 1.1012184619903564
load block tensor time/epoch 1.3920519351959229
block to device time/epoch 0.4789869785308838
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3525728
Number of first layer input nodes during this epoch:  1656279
Number of first layer output nodes during this epoch:  1355662
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=602, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=602, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=41, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=41, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  460288
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 602])
layers.0.fc_neigh.weight, torch.Size([256, 602])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([41, 256])
layers.2.fc_neigh.weight, torch.Size([41, 256])
----------------------------------------
un-trainable parameters
