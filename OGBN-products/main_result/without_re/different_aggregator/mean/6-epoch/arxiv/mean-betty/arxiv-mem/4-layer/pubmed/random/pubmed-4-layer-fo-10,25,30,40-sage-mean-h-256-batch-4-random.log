main start at this time 1657101435.0222762
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  500
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0019359588623046875  GigaBytes
Max Memory Allocated: 0.0019359588623046875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0019359588623046875  GigaBytes
Max Memory Allocated: 0.0019359588623046875  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.004163026809692383
number of batches is  4
batch size is  15
random selection method spend 0.0008070468902587891
time for parepare:  4.2438507080078125e-05
local_output_nid generation:  2.4318695068359375e-05
local_in_edges_tensor generation:  0.0003452301025390625
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.0027654170989990234
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  2.5510787963867188e-05
r_  generation:  5.030632019042969e-05
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.8358230590820312e-05
r_  generation:  3.075599670410156e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  9.72747802734375e-05
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.600120544433594e-05
----------------------check_connections_block total spend ----------------------------- 0.003958702087402344
generate_one_block  0.0039522647857666016
generate_one_block  0.0011675357818603516
generate_one_block  0.0010690689086914062
generate_one_block  0.0010554790496826172
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.00168609619140625
gen group dst list time:  3.170967102050781e-05
time for parepare:  0.0002589225769042969
local_output_nid generation:  8.58306884765625e-06
local_in_edges_tensor generation:  0.00018215179443359375
mini_batch_src_global generation:  3.981590270996094e-05
r_  generation:  0.00034165382385253906
local_output_nid generation:  1.239776611328125e-05
local_in_edges_tensor generation:  0.00013303756713867188
mini_batch_src_global generation:  5.435943603515625e-05
r_  generation:  0.0004096031188964844
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001327991485595703
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.0002682209014892578
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.00011682510375976562
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002543926239013672
----------------------check_connections_block total spend ----------------------------- 0.002710103988647461
generate_one_block  0.0014202594757080078
generate_one_block  0.0016298294067382812
generate_one_block  0.0013654232025146484
generate_one_block  0.0013608932495117188
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0009548664093017578
gen group dst list time:  6.67572021484375e-05
time for parepare:  0.0006237030029296875
local_output_nid generation:  5.3882598876953125e-05
local_in_edges_tensor generation:  0.0003018379211425781
mini_batch_src_global generation:  0.00014543533325195312
r_  generation:  0.001795053482055664
local_output_nid generation:  6.127357482910156e-05
local_in_edges_tensor generation:  0.0002357959747314453
mini_batch_src_global generation:  0.0002257823944091797
r_  generation:  0.002270221710205078
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.0002067089080810547
mini_batch_src_global generation:  0.00019073486328125
r_  generation:  0.0017092227935791016
local_output_nid generation:  4.887580871582031e-05
local_in_edges_tensor generation:  0.00019121170043945312
mini_batch_src_global generation:  0.00016546249389648438
r_  generation:  0.0016658306121826172
----------------------check_connections_block total spend ----------------------------- 0.011853456497192383
generate_one_block  0.003403186798095703
generate_one_block  0.003809690475463867
generate_one_block  0.0031435489654541016
generate_one_block  0.0029821395874023438
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0017070770263671875
gen group dst list time:  0.00020265579223632812
time for parepare:  0.001196146011352539
local_output_nid generation:  0.0002231597900390625
local_in_edges_tensor generation:  0.0007767677307128906
mini_batch_src_global generation:  0.0006282329559326172
r_  generation:  0.005617618560791016
local_output_nid generation:  0.00023293495178222656
local_in_edges_tensor generation:  0.0008575916290283203
mini_batch_src_global generation:  0.000690460205078125
r_  generation:  0.005902767181396484
local_output_nid generation:  0.00019931793212890625
local_in_edges_tensor generation:  0.000377655029296875
mini_batch_src_global generation:  0.0004284381866455078
r_  generation:  0.0046656131744384766
local_output_nid generation:  0.0002148151397705078
local_in_edges_tensor generation:  0.00041985511779785156
mini_batch_src_global generation:  0.0004868507385253906
r_  generation:  0.005213737487792969
----------------------check_connections_block total spend ----------------------------- 0.033672332763671875
generate_one_block  0.009606361389160156
generate_one_block  0.008407115936279297
generate_one_block  0.00713038444519043
generate_one_block  0.008083343505859375
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0019359588623046875  GigaBytes
Max Memory Allocated: 0.0019359588623046875  GigaBytes

connection checking time:  0.04823589324951172
block generation total time  0.05234217643737793
average batch blocks generation time:  0.013085544109344482
block dataloader generation time/epoch 0.130629301071167
pseudo mini batch 0 input nodes size: 8373
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0019359588623046875  GigaBytes
Max Memory Allocated: 0.0019359588623046875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0019359588623046875  GigaBytes
Max Memory Allocated: 0.0019359588623046875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0330810546875 GB
    Memory Allocated: 0.017560958862304688  GigaBytes
Max Memory Allocated: 0.017560958862304688  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0330810546875 GB
    Memory Allocated: 0.01756143569946289  GigaBytes
Max Memory Allocated: 0.01756143569946289  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0330810546875 GB
    Memory Allocated: 0.01756143569946289  GigaBytes
Max Memory Allocated: 0.01756143569946289  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.0994873046875 GB
    Memory Allocated: 0.017749309539794922  GigaBytes
Max Memory Allocated: 0.017749309539794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0994873046875 GB
    Memory Allocated: 0.017749309539794922  GigaBytes
Max Memory Allocated: 0.017749309539794922  GigaBytes

first layer input nodes number: 8373
first layer output nodes number: 3113
edges number: 18317
----------------------------------------before model layer 0
 Nvidia-smi: 1.0994873046875 GB
    Memory Allocated: 0.017835140228271484  GigaBytes
Max Memory Allocated: 0.017903804779052734  GigaBytes

torch.Size([8373, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.0994873046875 GB
    Memory Allocated: 0.017835140228271484  GigaBytes
Max Memory Allocated: 0.017903804779052734  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.026751995086669922  GigaBytes
Max Memory Allocated: 0.029593944549560547  GigaBytes

torch.Size([3113, 256])
torch.Size([3113, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.029720783233642578  GigaBytes
Max Memory Allocated: 0.032689571380615234  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.026751995086669922  GigaBytes
Max Memory Allocated: 0.032689571380615234  GigaBytes

torch.Size([3113, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.029720783233642578  GigaBytes
Max Memory Allocated: 0.032689571380615234  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.030463218688964844  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

input nodes number: 3113
output nodes number: 705
edges number: 5739
----------------------------------------before model layer 1
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.030492305755615234  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

torch.Size([3113, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2850341796875 GB
    Memory Allocated: 0.030492305755615234  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.031885623931884766  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

torch.Size([705, 256])
torch.Size([705, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.03255796432495117  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.031885623931884766  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

torch.Size([705, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.03255796432495117  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.032726287841796875  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

input nodes number: 705
output nodes number: 76
edges number: 842
----------------------------------------before model layer 2
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.03273296356201172  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

torch.Size([705, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.03273296356201172  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.03288555145263672  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

torch.Size([76, 256])
torch.Size([76, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.032958030700683594  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.03288555145263672  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

torch.Size([76, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.032958030700683594  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.03297615051269531  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

----------------input nodes number: 76
----------------output nodes number: 15
----------------edges number: 61
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.03297758102416992  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.03299427032470703  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

torch.Size([15, 3])
torch.Size([15, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.032994747161865234  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.03299427032470703  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

torch.Size([15, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.032994747161865234  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.032996177673339844  GigaBytes
Max Memory Allocated: 0.0334320068359375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.02007913589477539  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

pseudo mini batch 1 input nodes size: 7639
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.019498825073242188  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.019498825073242188  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.03372764587402344  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.03372812271118164  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.018102645874023438  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.018310546875  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.018310546875  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

first layer input nodes number: 7639
first layer output nodes number: 3057
edges number: 18841
----------------------------------------before model layer 0
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.018390655517578125  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([7639, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.018390655517578125  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.02715301513671875  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([3057, 256])
torch.Size([3057, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.030068397521972656  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.02715301513671875  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([3057, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.030068397521972656  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.030797481536865234  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

input nodes number: 3057
output nodes number: 777
edges number: 7536
----------------------------------------before model layer 1
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.030826568603515625  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([3057, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.030826568603515625  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.03237152099609375  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([777, 256])
torch.Size([777, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.033112525939941406  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.03237152099609375  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([777, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.033112525939941406  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.03329801559448242  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

input nodes number: 777
output nodes number: 121
edges number: 1227
----------------------------------------before model layer 2
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.03330516815185547  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([777, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.03330516815185547  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.03354644775390625  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([121, 256])
torch.Size([121, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.033661842346191406  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.03354644775390625  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([121, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.033661842346191406  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.0336909294128418  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------input nodes number: 121
----------------output nodes number: 15
----------------edges number: 106
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.033692359924316406  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.033709049224853516  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([15, 3])
torch.Size([15, 3])
----------------------------------------after rst
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.03370952606201172  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.033709049224853516  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([15, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.033709049224853516  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3143310546875 GB
    Memory Allocated: 0.03371000289916992  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.018733978271484375  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

pseudo mini batch 2 input nodes size: 6795
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.018102645874023438  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.018102645874023438  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.030759334564208984  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.030759811401367188  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.016530513763427734  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.01670217514038086  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.01670217514038086  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

first layer input nodes number: 6795
first layer output nodes number: 2427
edges number: 16061
----------------------------------------before model layer 0
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.016771316528320312  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([6795, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.016771316528320312  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02438974380493164  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([2427, 256])
torch.Size([2427, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02670431137084961  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.023736000061035156  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([2427, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02670431137084961  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02662944793701172  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

input nodes number: 2427
output nodes number: 637
edges number: 5878
----------------------------------------before model layer 1
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02665233612060547  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([2427, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02665233612060547  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02791595458984375  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([637, 256])
torch.Size([637, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02852344512939453  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02791595458984375  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([637, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02852344512939453  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.028675556182861328  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

input nodes number: 637
output nodes number: 72
edges number: 852
----------------------------------------before model layer 2
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.028681278228759766  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([637, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.028681278228759766  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.028826236724853516  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([72, 256])
torch.Size([72, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.028894901275634766  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.028826236724853516  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([72, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.028894901275634766  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.028912067413330078  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------input nodes number: 72
----------------output nodes number: 15
----------------edges number: 57
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.028913497924804688  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.028930187225341797  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([15, 3])
torch.Size([15, 3])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.0289306640625  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.028930187225341797  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([15, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.028930187225341797  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.028931140899658203  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.01704883575439453  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

pseudo mini batch 3 input nodes size: 7586
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.016530513763427734  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.016530513763427734  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.030660629272460938  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03066110610961914  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.01800394058227539  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.018180370330810547  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.018180370330810547  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

first layer input nodes number: 7586
first layer output nodes number: 2973
edges number: 17411
----------------------------------------before model layer 0
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.018259525299072266  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([7586, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.018259525299072266  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026774883270263672  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([2973, 256])
torch.Size([2973, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.029610157012939453  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026774883270263672  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([2973, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.029610157012939453  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.0303192138671875  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

input nodes number: 2973
output nodes number: 612
edges number: 5213
----------------------------------------before model layer 1
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.030346393585205078  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([2973, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.030346393585205078  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.031557559967041016  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([612, 256])
torch.Size([612, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03214120864868164  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.031557559967041016  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([612, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03214120864868164  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.0322871208190918  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

input nodes number: 612
output nodes number: 88
edges number: 752
----------------------------------------before model layer 2
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.032292842864990234  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([612, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.032292842864990234  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03246736526489258  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([88, 256])
torch.Size([88, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03255128860473633  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03246736526489258  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([88, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03255128860473633  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.032572269439697266  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------input nodes number: 88
----------------output nodes number: 15
----------------edges number: 73
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.032573699951171875  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.032590389251708984  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([15, 3])
torch.Size([15, 3])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03259086608886719  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.032590389251708984  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

torch.Size([15, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.032590389251708984  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03259134292602539  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.018545150756835938  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.022417068481445312  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.022417068481445312  GigaBytes
Max Memory Allocated: 0.037541866302490234  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006224870681762695 |0.0853797197341919 |0.20784175395965576 |0.00017654895782470703 |0.004145681858062744 |0.0023682117462158203 |
----------------------------------------------------------pseudo_mini_loss sum 1.1051337718963623
Total (block generation + training)time/epoch 1.3636538982391357
Training time/epoch 1.232750415802002
Training time without block to device /epoch 0.8912315368652344
Training time without total dataloading part /epoch 0.8510241508483887
load block tensor time/epoch 0.02489948272705078
block to device time/epoch 0.3415188789367676
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  45051
Number of first layer input nodes during this epoch:  30393
Number of first layer output nodes during this epoch:  11570
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=500, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=500, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=3, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=3, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  519680
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 500])
layers.0.fc_neigh.weight, torch.Size([256, 500])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([3, 256])
layers.3.fc_neigh.weight, torch.Size([3, 256])
----------------------------------------
un-trainable parameters
