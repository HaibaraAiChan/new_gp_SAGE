main start at this time 1657097026.8462522
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.028943538665771484
global_2_local spend time (sec) 0.03708386421203613
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004870414733886719
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 66367, 1: 13428, 2: 11706, 3: 9277, 4: 7320, 5: 6222, 40: 5145, 6: 4868, 7: 4045, 8: 3472, 9: 2976, 10: 2599, 11: 2203, 12: 1937, 13: 1656, 14: 1434, 15: 1289, 16: 1111, 17: 1030, 18: 948, 19: 836, 20: 807, 21: 717, 22: 556, 24: 525, 23: 519, 25: 483, 26: 409, 27: 390, 28: 370, 29: 329, 31: 300, 32: 273, 30: 261, 33: 261, 34: 231, 36: 226, 35: 200, 39: 200, 37: 196, 38: 186})

A = g.adjacency_matrix() spent  0.010277509689331055
auxiliary_graph
Graph(num_nodes=157308, num_edges=35021951,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07884693145751953
remove nodes length  66367

auxiliary_graph.remove_nodes spent  1.8584024906158447
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=35021951,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.4413089752197266

the counter of shared neighbor distribution
Counter({1.0: 27043422, 2.0: 5402536, 3.0: 1535470, 4.0: 520896, 5.0: 208256, 6.0: 96348, 7.0: 49078, 8.0: 27750, 9.0: 16122, 10.0: 10522, 11.0: 6674, 12.0: 4282, 13.0: 2858, 14.0: 2032, 15.0: 1384, 16.0: 974, 17.0: 736, 18.0: 480, 19.0: 374, 20.0: 276, 21.0: 184, 22.0: 132, 23.0: 88, 24.0: 44, 25.0: 36, 26.0: 24, 27.0: 10, 28.0: 6, 30.0: 6, 29.0: 4, 33.0: 2, 38.0: 2, 32.0: 2})
34931010
Convert a graph into a bidirected graph: 1.619 seconds
Metis partitioning: 6.161 seconds
Split the graph: 2.483 seconds
Construct subgraphs: 0.129 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  10.407077550888062
11036
11058
11235
11035
11644
11674
11671
11588
total k batches seeds list generation spend  18.633957862854004
after graph partition
graph partition algorithm spend time 18.802927017211914
11036
11058
11235
11035
11644
11674
11671
11588
partition_len_list
[32055, 38641, 46042, 53318, 19510, 26310, 21895, 20592]
REG selection method  spend 18.89118719100952
time for parepare:  0.017081737518310547
local_output_nid generation:  0.0018758773803710938
local_in_edges_tensor generation:  0.0023789405822753906
mini_batch_src_global generation:  0.00490117073059082
r_  generation:  0.028128862380981445
local_output_nid generation:  0.0024614334106445312
local_in_edges_tensor generation:  0.0021314620971679688
mini_batch_src_global generation:  0.004466533660888672
r_  generation:  0.034098148345947266
local_output_nid generation:  0.0026540756225585938
local_in_edges_tensor generation:  0.003919124603271484
mini_batch_src_global generation:  0.005267143249511719
r_  generation:  0.05212712287902832
local_output_nid generation:  0.0027947425842285156
local_in_edges_tensor generation:  0.0023674964904785156
mini_batch_src_global generation:  0.004562854766845703
r_  generation:  0.043234825134277344
local_output_nid generation:  0.002921581268310547
local_in_edges_tensor generation:  0.002220630645751953
mini_batch_src_global generation:  0.0034148693084716797
r_  generation:  0.03228473663330078
local_output_nid generation:  0.004834413528442383
local_in_edges_tensor generation:  0.0028350353240966797
mini_batch_src_global generation:  0.0034449100494384766
r_  generation:  0.03524613380432129
local_output_nid generation:  0.00446009635925293
local_in_edges_tensor generation:  0.0028579235076904297
mini_batch_src_global generation:  0.004285097122192383
r_  generation:  0.0336451530456543
local_output_nid generation:  0.004192829132080078
local_in_edges_tensor generation:  0.002829313278198242
mini_batch_src_global generation:  0.003535747528076172
r_  generation:  0.033759355545043945
----------------------check_connections_block total spend ----------------------------- 0.46947479248046875
generate_one_block  0.049834489822387695
generate_one_block  0.05059361457824707
generate_one_block  0.07752799987792969
generate_one_block  0.060459136962890625
generate_one_block  0.0337374210357666
generate_one_block  0.045590877532958984
generate_one_block  0.04566764831542969
generate_one_block  0.07377886772155762
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.047167301177978516
gen group dst list time:  0.011816740036010742
time for parepare:  0.03603100776672363
local_output_nid generation:  0.007704734802246094
local_in_edges_tensor generation:  0.0245816707611084
mini_batch_src_global generation:  0.011685371398925781
r_  generation:  0.13506698608398438
local_output_nid generation:  0.01570606231689453
local_in_edges_tensor generation:  0.013736486434936523
mini_batch_src_global generation:  0.024816513061523438
r_  generation:  0.16776561737060547
local_output_nid generation:  0.014882564544677734
local_in_edges_tensor generation:  0.018034696578979492
mini_batch_src_global generation:  0.025541067123413086
r_  generation:  0.23707938194274902
local_output_nid generation:  0.016115665435791016
local_in_edges_tensor generation:  0.027189970016479492
mini_batch_src_global generation:  0.03792881965637207
r_  generation:  0.2634267807006836
local_output_nid generation:  0.011644840240478516
local_in_edges_tensor generation:  0.004171848297119141
mini_batch_src_global generation:  0.010937213897705078
r_  generation:  0.04928445816040039
local_output_nid generation:  0.0073528289794921875
local_in_edges_tensor generation:  0.006735801696777344
mini_batch_src_global generation:  0.008577823638916016
r_  generation:  0.08805990219116211
local_output_nid generation:  0.0065610408782958984
local_in_edges_tensor generation:  0.005037546157836914
mini_batch_src_global generation:  0.00991511344909668
r_  generation:  0.1094975471496582
local_output_nid generation:  0.005948066711425781
local_in_edges_tensor generation:  0.004566192626953125
mini_batch_src_global generation:  0.012397289276123047
r_  generation:  0.07578229904174805
----------------------check_connections_block total spend ----------------------------- 1.7602064609527588
generate_one_block  0.1653594970703125
generate_one_block  0.23944711685180664
generate_one_block  0.3113136291503906
generate_one_block  0.34534645080566406
generate_one_block  0.058411598205566406
generate_one_block  0.11706924438476562
generate_one_block  0.08605480194091797
generate_one_block  0.08750462532043457
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03443741798400879
gen group dst list time:  0.019929170608520508
time for parepare:  0.018549680709838867
local_output_nid generation:  0.017497539520263672
local_in_edges_tensor generation:  0.06791210174560547
mini_batch_src_global generation:  0.03612923622131348
r_  generation:  0.37013745307922363
local_output_nid generation:  0.02570199966430664
local_in_edges_tensor generation:  0.035132646560668945
mini_batch_src_global generation:  0.04508805274963379
r_  generation:  0.3855466842651367
local_output_nid generation:  0.02048182487487793
local_in_edges_tensor generation:  0.026987552642822266
mini_batch_src_global generation:  0.04794168472290039
r_  generation:  0.40979909896850586
local_output_nid generation:  0.030807018280029297
local_in_edges_tensor generation:  0.04001593589782715
mini_batch_src_global generation:  0.05402064323425293
r_  generation:  0.4417126178741455
local_output_nid generation:  0.009795188903808594
local_in_edges_tensor generation:  0.008557796478271484
mini_batch_src_global generation:  0.020971298217773438
r_  generation:  0.1082916259765625
local_output_nid generation:  0.0157163143157959
local_in_edges_tensor generation:  0.013804197311401367
mini_batch_src_global generation:  0.024730443954467773
r_  generation:  0.2192063331604004
local_output_nid generation:  0.010604619979858398
local_in_edges_tensor generation:  0.008896589279174805
mini_batch_src_global generation:  0.019505977630615234
r_  generation:  0.13515472412109375
local_output_nid generation:  0.011509180068969727
local_in_edges_tensor generation:  0.009506702423095703
mini_batch_src_global generation:  0.01953291893005371
r_  generation:  0.15819621086120605
----------------------check_connections_block total spend ----------------------------- 3.3736658096313477
generate_one_block  0.4662754535675049
generate_one_block  0.4806394577026367
generate_one_block  0.4793112277984619
generate_one_block  0.5428719520568848
generate_one_block  0.12820124626159668
generate_one_block  0.2774088382720947
generate_one_block  0.16327142715454102
generate_one_block  0.19323301315307617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.02379131317138672
gen group dst list time:  0.03620457649230957
time for parepare:  0.019337892532348633
local_output_nid generation:  0.03030705451965332
local_in_edges_tensor generation:  0.0662848949432373
mini_batch_src_global generation:  0.03085470199584961
r_  generation:  0.33897852897644043
local_output_nid generation:  0.03221273422241211
local_in_edges_tensor generation:  0.035384178161621094
mini_batch_src_global generation:  0.03385305404663086
r_  generation:  0.3302798271179199
local_output_nid generation:  0.028481483459472656
local_in_edges_tensor generation:  0.027693748474121094
mini_batch_src_global generation:  0.03070974349975586
r_  generation:  0.3191068172454834
local_output_nid generation:  0.03270769119262695
local_in_edges_tensor generation:  0.029003381729125977
mini_batch_src_global generation:  0.03620457649230957
r_  generation:  0.3602726459503174
local_output_nid generation:  0.019740581512451172
local_in_edges_tensor generation:  0.0435640811920166
mini_batch_src_global generation:  0.02250218391418457
r_  generation:  0.20100975036621094
local_output_nid generation:  0.029369354248046875
local_in_edges_tensor generation:  0.02365589141845703
mini_batch_src_global generation:  0.02893805503845215
r_  generation:  0.3249545097351074
local_output_nid generation:  0.02164483070373535
local_in_edges_tensor generation:  0.017112016677856445
mini_batch_src_global generation:  0.024526357650756836
r_  generation:  0.24283266067504883
local_output_nid generation:  0.023447275161743164
local_in_edges_tensor generation:  0.018631935119628906
mini_batch_src_global generation:  0.024674654006958008
r_  generation:  0.26712775230407715
----------------------check_connections_block total spend ----------------------------- 3.673914909362793
generate_one_block  0.43900561332702637
generate_one_block  0.4433715343475342
generate_one_block  0.4173774719238281
generate_one_block  0.4365193843841553
generate_one_block  0.23673725128173828
generate_one_block  0.3741445541381836
generate_one_block  0.26909613609313965
generate_one_block  0.30409741401672363
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

connection checking time:  9.277261972427368
block generation total time  7.499258995056152
average batch blocks generation time:  0.23435184359550476
block dataloader generation time/epoch 36.320332765579224
pseudo mini batch 0 input nodes size: 155930
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.07565021514892578  GigaBytes
Max Memory Allocated: 0.07565021514892578  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.07573270797729492  GigaBytes
Max Memory Allocated: 0.07573270797729492  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0936279296875 GB
    Memory Allocated: 0.07573270797729492  GigaBytes
Max Memory Allocated: 0.07573270797729492  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09460639953613281  GigaBytes
Max Memory Allocated: 0.09460639953613281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1776123046875 GB
    Memory Allocated: 0.09460639953613281  GigaBytes
Max Memory Allocated: 0.09460639953613281  GigaBytes

first layer input nodes number: 155930
first layer output nodes number: 140271
edges number: 962351
----------------------------------------before model layer 0
 Nvidia-smi: 1.1971435546875 GB
    Memory Allocated: 0.09763288497924805  GigaBytes
Max Memory Allocated: 0.10121822357177734  GigaBytes

torch.Size([155930, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1971435546875 GB
    Memory Allocated: 0.09763288497924805  GigaBytes
Max Memory Allocated: 0.10121822357177734  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.7322998046875 GB
    Memory Allocated: 0.3059854507446289  GigaBytes
Max Memory Allocated: 0.3059854507446289  GigaBytes

torch.Size([140271, 256])
torch.Size([140271, 256])
----------------------------------------after rst
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.43975830078125  GigaBytes
Max Memory Allocated: 0.5735311508178711  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.3059854507446289  GigaBytes
Max Memory Allocated: 0.5735311508178711  GigaBytes

torch.Size([140271, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.43975830078125  GigaBytes
Max Memory Allocated: 0.5735311508178711  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.4732017517089844  GigaBytes
Max Memory Allocated: 0.6069746017456055  GigaBytes

input nodes number: 140271
output nodes number: 89676
edges number: 1080864
----------------------------------------before model layer 1
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.4753432273864746  GigaBytes
Max Memory Allocated: 0.6069746017456055  GigaBytes

torch.Size([140271, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.4753432273864746  GigaBytes
Max Memory Allocated: 0.6069746017456055  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.1053466796875 GB
    Memory Allocated: 0.655524730682373  GigaBytes
Max Memory Allocated: 0.655524730682373  GigaBytes

torch.Size([89676, 256])
torch.Size([89676, 256])
----------------------------------------after rst
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 0.741462230682373  GigaBytes
Max Memory Allocated: 0.827399730682373  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 0.6559405326843262  GigaBytes
Max Memory Allocated: 0.827399730682373  GigaBytes

torch.Size([89676, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 0.7418780326843262  GigaBytes
Max Memory Allocated: 0.827399730682373  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 0.7628426551818848  GigaBytes
Max Memory Allocated: 0.8487801551818848  GigaBytes

input nodes number: 89676
output nodes number: 32055
edges number: 343566
----------------------------------------before model layer 2
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 0.7637500762939453  GigaBytes
Max Memory Allocated: 0.8487801551818848  GigaBytes

torch.Size([89676, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 0.7637500762939453  GigaBytes
Max Memory Allocated: 0.8487801551818848  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.2772216796875 GB
    Memory Allocated: 0.8276901245117188  GigaBytes
Max Memory Allocated: 0.8487801551818848  GigaBytes

torch.Size([32055, 256])
torch.Size([32055, 256])
----------------------------------------after rst
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.8589401245117188  GigaBytes
Max Memory Allocated: 0.8895101547241211  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.8283700942993164  GigaBytes
Max Memory Allocated: 0.8895101547241211  GigaBytes

torch.Size([32055, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.8589401245117188  GigaBytes
Max Memory Allocated: 0.8895101547241211  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.8665828704833984  GigaBytes
Max Memory Allocated: 0.8971529006958008  GigaBytes

----------------input nodes number: 32055
----------------output nodes number: 11036
----------------edges number: 73764
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3084716796875 GB
    Memory Allocated: 0.8669042587280273  GigaBytes
Max Memory Allocated: 0.8971529006958008  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 0.8798084259033203  GigaBytes
Max Memory Allocated: 0.8971529006958008  GigaBytes

torch.Size([11036, 40])
torch.Size([11036, 40])
----------------------------------------after rst
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 0.8814530372619629  GigaBytes
Max Memory Allocated: 0.8971529006958008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 0.879706859588623  GigaBytes
Max Memory Allocated: 0.8971529006958008  GigaBytes

torch.Size([11036, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 0.8813514709472656  GigaBytes
Max Memory Allocated: 0.8971529006958008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3104248046875 GB
    Memory Allocated: 0.8830986022949219  GigaBytes
Max Memory Allocated: 0.8971529006958008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.13612747192382812  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

pseudo mini batch 1 input nodes size: 151961
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.0786752700805664  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.0786752700805664  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.15113592147827148  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.15121841430664062  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.0767827033996582  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.09715032577514648  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.09715032577514648  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

first layer input nodes number: 151961
first layer output nodes number: 131756
edges number: 914772
----------------------------------------before model layer 0
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.09926462173461914  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([151961, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.09926462173461914  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.29505014419555664  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([131756, 256])
torch.Size([131756, 256])
----------------------------------------after rst
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.4207024574279785  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.29505014419555664  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([131756, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.4207024574279785  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.452115535736084  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

input nodes number: 131756
output nodes number: 88118
edges number: 1093744
----------------------------------------before model layer 1
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.4537539482116699  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([131756, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.4537539482116699  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.6315960884094238  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([88118, 256])
torch.Size([88118, 256])
----------------------------------------after rst
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.7156319618225098  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.6315960884094238  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([88118, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.7156319618225098  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.7366409301757812  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

input nodes number: 88118
output nodes number: 38641
edges number: 505071
----------------------------------------before model layer 2
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.7375855445861816  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([88118, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.7375855445861816  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.8153786659240723  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([38641, 256])
torch.Size([38641, 256])
----------------------------------------after rst
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.8522295951843262  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.8153786659240723  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([38641, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.8522295951843262  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.862274169921875  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------input nodes number: 38641
----------------output nodes number: 11058
----------------edges number: 102034
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7303466796875 GB
    Memory Allocated: 0.8626446723937988  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.8757243156433105  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([11058, 40])
torch.Size([11058, 40])
----------------------------------------after rst
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.8773722648620605  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.8756823539733887  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([11058, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.8756856918334961  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.8773760795593262  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.13735723495483398  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

pseudo mini batch 2 input nodes size: 145322
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.07678604125976562  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.07678604125976562  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.14608097076416016  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.1461648941040039  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.07362174987792969  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.09603500366210938  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.09603500366210938  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

first layer input nodes number: 145322
first layer output nodes number: 121963
edges number: 872752
----------------------------------------before model layer 0
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.09802675247192383  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([145322, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.09802675247192383  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.27945375442504883  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([121963, 256])
torch.Size([121963, 256])
----------------------------------------after rst
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.3957667350769043  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.27945375442504883  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([121963, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.3957667350769043  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.42484521865844727  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

input nodes number: 121963
output nodes number: 84235
edges number: 1098746
----------------------------------------before model layer 1
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.42638206481933594  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([121963, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.42638206481933594  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.5958623886108398  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([84235, 256])
torch.Size([84235, 256])
----------------------------------------after rst
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.6761951446533203  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.5958623886108398  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([84235, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.6761951446533203  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.6962785720825195  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

input nodes number: 84235
output nodes number: 46042
edges number: 733949
----------------------------------------before model layer 2
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.6972498893737793  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([84235, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.6972498893737793  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.7918453216552734  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([46042, 256])
torch.Size([46042, 256])
----------------------------------------after rst
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.83575439453125  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.7918453216552734  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([46042, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.83575439453125  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.8469209671020508  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------input nodes number: 46042
----------------output nodes number: 11235
----------------edges number: 166819
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7322998046875 GB
    Memory Allocated: 0.8473482131958008  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.8615617752075195  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([11235, 40])
torch.Size([11235, 40])
----------------------------------------after rst
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.8632359504699707  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.8610644340515137  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([11235, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.8612751960754395  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.8634471893310547  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.14049720764160156  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

pseudo mini batch 3 input nodes size: 156185
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.07383251190185547  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.07383251190185547  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.14830732345581055  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.1483898162841797  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.0790109634399414  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.10269880294799805  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.10269880294799805  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

first layer input nodes number: 156185
first layer output nodes number: 141233
edges number: 965089
----------------------------------------before model layer 0
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.1056208610534668  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([156185, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.1056208610534668  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.3154487609863281  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([141233, 256])
torch.Size([141233, 256])
----------------------------------------after rst
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.4502143859863281  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.3154487609863281  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([141233, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.4502143859863281  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.4838871955871582  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

input nodes number: 141233
output nodes number: 105961
edges number: 1287526
----------------------------------------before model layer 1
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.48623132705688477  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([141233, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7342529296875 GB
    Memory Allocated: 0.48623132705688477  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7498779296875 GB
    Memory Allocated: 0.6987185478210449  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([105961, 256])
torch.Size([105961, 256])
----------------------------------------after rst
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.8002810478210449  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.6992287635803223  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([105961, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.8007912635803223  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.8255443572998047  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

input nodes number: 105961
output nodes number: 53318
edges number: 793562
----------------------------------------before model layer 2
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.8267316818237305  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([105961, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.8267316818237305  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9347548484802246  GigaBytes
Max Memory Allocated: 0.9454593658447266  GigaBytes

torch.Size([53318, 256])
torch.Size([53318, 256])
----------------------------------------after rst
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.985602855682373  GigaBytes
Max Memory Allocated: 1.0364508628845215  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9347548484802246  GigaBytes
Max Memory Allocated: 1.0364508628845215  GigaBytes

torch.Size([53318, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.985602855682373  GigaBytes
Max Memory Allocated: 1.0364508628845215  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9983148574829102  GigaBytes
Max Memory Allocated: 1.0491628646850586  GigaBytes

----------------input nodes number: 53318
----------------output nodes number: 11035
----------------edges number: 125531
----------------------------------------before mean aggregator
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 0.9987950325012207  GigaBytes
Max Memory Allocated: 1.0491628646850586  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.0119819641113281  GigaBytes
Max Memory Allocated: 1.0491628646850586  GigaBytes

torch.Size([11035, 40])
torch.Size([11035, 40])
----------------------------------------after rst
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.0136265754699707  GigaBytes
Max Memory Allocated: 1.0491628646850586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.0119819641113281  GigaBytes
Max Memory Allocated: 1.0491628646850586  GigaBytes

torch.Size([11035, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.011767864227295  GigaBytes
Max Memory Allocated: 1.0491628646850586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9530029296875 GB
    Memory Allocated: 1.0134129524230957  GigaBytes
Max Memory Allocated: 1.0491628646850586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.15213537216186523  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

pseudo mini batch 4 input nodes size: 120692
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.0787968635559082  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.0787968635559082  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.13634729385375977  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.13643407821655273  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.061876773834228516  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.07007884979248047  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.07007884979248047  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

first layer input nodes number: 120692
first layer output nodes number: 76639
edges number: 520699
----------------------------------------before model layer 0
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.0715494155883789  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([120692, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.0715494155883789  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.1853475570678711  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([76639, 256])
torch.Size([76639, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.2584362030029297  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.1853475570678711  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([76639, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.2584362030029297  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.27670860290527344  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

input nodes number: 76639
output nodes number: 33974
edges number: 283661
----------------------------------------before model layer 1
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.27753305435180664  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([76639, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.27753305435180664  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.34490299224853516  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([33974, 256])
torch.Size([33974, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.3773031234741211  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.34490299224853516  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([33974, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.3773031234741211  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.3854031562805176  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

input nodes number: 33974
output nodes number: 19510
edges number: 124865
----------------------------------------before model layer 2
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.3858017921447754  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([33974, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.3858017921447754  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.42594099044799805  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([19510, 256])
torch.Size([19510, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.444547176361084  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.425015926361084  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([19510, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.444547176361084  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.44837093353271484  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------input nodes number: 19510
----------------output nodes number: 11644
----------------edges number: 69694
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.44860315322875977  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.46205854415893555  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([11644, 40])
torch.Size([11644, 40])
----------------------------------------after rst
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.4637937545776367  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.4620494842529297  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([11644, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.46214914321899414  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.46396780014038086  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.0860905647277832  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

pseudo mini batch 5 input nodes size: 147134
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.06197643280029297  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.06197643280029297  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.13213539123535156  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.13222265243530273  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.0745854377746582  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.08876466751098633  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.08876466751098633  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

first layer input nodes number: 147134
first layer output nodes number: 119268
edges number: 845767
----------------------------------------before model layer 0
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.09074974060058594  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([147134, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.09074974060058594  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.2681102752685547  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([119268, 256])
torch.Size([119268, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.3818531036376953  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.2681102752685547  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([119268, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.3818531036376953  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.41028881072998047  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

input nodes number: 119268
output nodes number: 58301
edges number: 635854
----------------------------------------before model layer 1
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.41161203384399414  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([119268, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.41161203384399414  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.5284304618835449  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([58301, 256])
torch.Size([58301, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.5840306282043457  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.5284304618835449  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([58301, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.5840306282043457  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.597930908203125  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

input nodes number: 58301
output nodes number: 26310
edges number: 253491
----------------------------------------before model layer 2
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.5985617637634277  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([58301, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.5985617637634277  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.6508297920227051  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([26310, 256])
torch.Size([26310, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.6759209632873535  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.6508297920227051  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([26310, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.6759209632873535  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.6821937561035156  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------input nodes number: 26310
----------------output nodes number: 11674
----------------edges number: 101517
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0545654296875 GB
    Memory Allocated: 0.6824774742126465  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0565185546875 GB
    Memory Allocated: 0.6961956024169922  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([11674, 40])
torch.Size([11674, 40])
----------------------------------------after rst
 Nvidia-smi: 3.0565185546875 GB
    Memory Allocated: 0.6979355812072754  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0565185546875 GB
    Memory Allocated: 0.6961956024169922  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([11674, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0565185546875 GB
    Memory Allocated: 0.6961913108825684  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0565185546875 GB
    Memory Allocated: 0.6979317665100098  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.11651134490966797  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

pseudo mini batch 6 input nodes size: 125945
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.07458114624023438  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.07458114624023438  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.13463640213012695  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.13472366333007812  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.06447744369506836  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.07479381561279297  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.07479381561279297  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

first layer input nodes number: 125945
first layer output nodes number: 83447
edges number: 588872
----------------------------------------before model layer 0
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.0763540267944336  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([125945, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.0763540267944336  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.2004246711730957  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([83447, 256])
torch.Size([83447, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.28000593185424805  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.2004246711730957  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([83447, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.28000593185424805  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.29990148544311523  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

input nodes number: 83447
output nodes number: 38620
edges number: 373874
----------------------------------------before model layer 1
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.3008112907409668  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([83447, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.3008112907409668  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.37833166122436523  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([38620, 256])
torch.Size([38620, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.4151625633239746  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.37833166122436523  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([38620, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.4151625633239746  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.42437028884887695  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

input nodes number: 38620
output nodes number: 21895
edges number: 198905
----------------------------------------before model layer 2
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.4248218536376953  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([38620, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.4248218536376953  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.4682292938232422  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([21895, 256])
torch.Size([21895, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.48910999298095703  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.4682292938232422  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([21895, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.48910999298095703  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.49433040618896484  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------input nodes number: 21895
----------------output nodes number: 11671
----------------edges number: 102765
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.4945812225341797  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.5086898803710938  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([11671, 40])
torch.Size([11671, 40])
----------------------------------------after rst
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.5104293823242188  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.5083045959472656  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([11671, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.5086894035339355  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.510429859161377  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.09505558013916016  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

pseudo mini batch 7 input nodes size: 129026
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.06486225128173828  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.06486225128173828  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.1263866424560547  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.12647342681884766  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.0663309097290039  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.07712507247924805  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.07712507247924805  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

first layer input nodes number: 129026
first layer output nodes number: 91088
edges number: 666362
----------------------------------------before model layer 0
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.078765869140625  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([129026, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.078765869140625  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.2143726348876953  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([91088, 256])
torch.Size([91088, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.3012409210205078  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.2143726348876953  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([91088, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.3012409210205078  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.32295799255371094  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

input nodes number: 91088
output nodes number: 41449
edges number: 450404
----------------------------------------before model layer 1
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.3239459991455078  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([91088, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.3239459991455078  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.40666866302490234  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([41449, 256])
torch.Size([41449, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.446197509765625  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.40666866302490234  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([41449, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.446197509765625  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.45607995986938477  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

input nodes number: 41449
output nodes number: 20592
edges number: 201983
----------------------------------------before model layer 2
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.4565424919128418  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([41449, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.4565424919128418  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.49747705459594727  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([20592, 256])
torch.Size([20592, 256])
----------------------------------------after rst
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.5171151161193848  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.49747705459594727  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([20592, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.5171151161193848  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.522122859954834  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------input nodes number: 20592
----------------output nodes number: 11588
----------------edges number: 104155
----------------------------------------before mean aggregator
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.5223631858825684  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.5363259315490723  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([11588, 40])
torch.Size([11588, 40])
----------------------------------------after rst
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.538053035736084  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.5360045433044434  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

torch.Size([11588, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.5359282493591309  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.5380535125732422  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 0.09780454635620117  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 0.10039854049682617  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.0604248046875 GB
    Memory Allocated: 0.10039854049682617  GigaBytes
Max Memory Allocated: 1.102388858795166  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.030105680227279663 |0.054422348737716675 |0.11748737096786499 |0.00016310811042785645 |0.00823792815208435 |0.0021772384643554688 |
----------------------------------------------------------pseudo_mini_loss sum 6.463830471038818
Total (block generation + training)time/epoch 38.035308837890625
Training time/epoch 1.7146413326263428
Training time without block to device /epoch 1.2792625427246094
Training time without total dataloading part /epoch 1.009284496307373
load block tensor time/epoch 0.2408454418182373
block to device time/epoch 0.4353787899017334
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2836557
Number of first layer input nodes during this epoch:  1132195
Number of first layer output nodes during this epoch:  905665
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  348160
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([40, 256])
layers.3.fc_neigh.weight, torch.Size([40, 256])
----------------------------------------
un-trainable parameters
