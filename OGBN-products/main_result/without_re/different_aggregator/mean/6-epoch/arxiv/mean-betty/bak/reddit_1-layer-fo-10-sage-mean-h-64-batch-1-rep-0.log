main start at this time 1657006253.0569277
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  602
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00018405914306640625  GigaBytes
Max Memory Allocated: 0.00018405914306640625  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00018405914306640625  GigaBytes
Max Memory Allocated: 0.00018405914306640625  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00018405914306640625  GigaBytes
Max Memory Allocated: 0.00018405914306640625  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.0647120475769043
pseudo mini batch 0 input nodes size: 217301
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00018405914306640625  GigaBytes
Max Memory Allocated: 0.00018405914306640625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.00018405914306640625  GigaBytes
Max Memory Allocated: 0.00018405914306640625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5057373046875 GB
    Memory Allocated: 0.4884653091430664  GigaBytes
Max Memory Allocated: 0.4884653091430664  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.4896087646484375  GigaBytes
Max Memory Allocated: 0.4896087646484375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5252685546875 GB
    Memory Allocated: 0.4896087646484375  GigaBytes
Max Memory Allocated: 0.4896087646484375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.5006799697875977  GigaBytes
Max Memory Allocated: 0.5006799697875977  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.5006799697875977  GigaBytes
Max Memory Allocated: 0.5006799697875977  GigaBytes

torch.Size([153431, 41])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.9032807350158691  GigaBytes
Max Memory Allocated: 1.2010717391967773  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.9267163276672363  GigaBytes
Max Memory Allocated: 1.2010717391967773  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.535942554473877  GigaBytes
Max Memory Allocated: 1.2010717391967773  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.5363106727600098  GigaBytes
Max Memory Allocated: 1.2010717391967773  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.5363106727600098  GigaBytes
Max Memory Allocated: 1.2010717391967773  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1759507656097412 |0.3383908271789551 |0.7702572345733643 |0.00033402442932128906 |0.010350942611694336 |0.002046823501586914 |
----------------------------------------------------------pseudo_mini_loss sum 6.0861406326293945
Total (block generation + training)time/epoch 1.367201566696167
Training time/epoch 1.3020155429840088
Training time without block to device /epoch 0.9636247158050537
Training time without total dataloading part /epoch 0.7829890251159668
load block tensor time/epoch 0.1759507656097412
block to device time/epoch 0.3383908271789551
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  217301
Number of first layer input nodes during this epoch:  217301
Number of first layer output nodes during this epoch:  153431
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.5363101959228516  GigaBytes
Max Memory Allocated: 1.2010717391967773  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.5363101959228516  GigaBytes
Max Memory Allocated: 1.2010717391967773  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.06835806369781494
pseudo mini batch 0 input nodes size: 217255
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.5135955810546875  GigaBytes
Max Memory Allocated: 1.2010717391967773  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.8455810546875 GB
    Memory Allocated: 0.5135955810546875  GigaBytes
Max Memory Allocated: 1.2010717391967773  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.3338623046875 GB
    Memory Allocated: 1.0008172988891602  GigaBytes
Max Memory Allocated: 1.2010717391967773  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.3338623046875 GB
    Memory Allocated: 1.0019607543945312  GigaBytes
Max Memory Allocated: 1.2010717391967773  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.3338623046875 GB
    Memory Allocated: 0.5125360488891602  GigaBytes
Max Memory Allocated: 1.2010717391967773  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.3338623046875 GB
    Memory Allocated: 0.5236072540283203  GigaBytes
Max Memory Allocated: 1.2010717391967773  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3338623046875 GB
    Memory Allocated: 0.5236072540283203  GigaBytes
Max Memory Allocated: 1.2010717391967773  GigaBytes

torch.Size([153431, 41])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.3338623046875 GB
    Memory Allocated: 0.9034109115600586  GigaBytes
Max Memory Allocated: 1.2246365547180176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.3338623046875 GB
    Memory Allocated: 0.9268465042114258  GigaBytes
Max Memory Allocated: 1.2246365547180176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.3338623046875 GB
    Memory Allocated: 0.535888671875  GigaBytes
Max Memory Allocated: 1.2246365547180176  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.3338623046875 GB
    Memory Allocated: 0.535888671875  GigaBytes
Max Memory Allocated: 1.2246365547180176  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.3338623046875 GB
    Memory Allocated: 0.535888671875  GigaBytes
Max Memory Allocated: 1.2246365547180176  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1762235164642334 |0.006483793258666992 |0.0015308856964111328 |0.00014638900756835938 |0.0013010501861572266 |0.0007963180541992188 |
----------------------------------------------------------pseudo_mini_loss sum 3.7574613094329834
Total (block generation + training)time/epoch 0.8260562419891357
Training time/epoch 0.21260619163513184
Training time without block to device /epoch 0.20612239837646484
Training time without total dataloading part /epoch 0.0037746429443359375
load block tensor time/epoch 0.1762235164642334
block to device time/epoch 0.006483793258666992
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  217255
Number of first layer input nodes during this epoch:  217255
Number of first layer output nodes during this epoch:  153431
----------------------------------------before generate dataloader block 
 Nvidia-smi: 3.3338623046875 GB
    Memory Allocated: 0.5358881950378418  GigaBytes
Max Memory Allocated: 1.2246365547180176  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 3.3338623046875 GB
    Memory Allocated: 0.5358881950378418  GigaBytes
Max Memory Allocated: 1.2246365547180176  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.059044837951660156
pseudo mini batch 0 input nodes size: 217197
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.3338623046875 GB
    Memory Allocated: 0.5125360488891602  GigaBytes
Max Memory Allocated: 1.2246365547180176  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.3338623046875 GB
    Memory Allocated: 0.5125360488891602  GigaBytes
Max Memory Allocated: 1.2246365547180176  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.8221435546875 GB
    Memory Allocated: 0.9996275901794434  GigaBytes
Max Memory Allocated: 1.2246365547180176  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.8221435546875 GB
    Memory Allocated: 1.0007710456848145  GigaBytes
Max Memory Allocated: 1.2246365547180176  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.8221435546875 GB
    Memory Allocated: 0.5124058723449707  GigaBytes
Max Memory Allocated: 1.2246365547180176  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.8221435546875 GB
    Memory Allocated: 0.5234770774841309  GigaBytes
Max Memory Allocated: 1.2246365547180176  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8221435546875 GB
    Memory Allocated: 0.5234770774841309  GigaBytes
Max Memory Allocated: 1.2246365547180176  GigaBytes

torch.Size([153431, 41])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.8221435546875 GB
    Memory Allocated: 0.9026432037353516  GigaBytes
Max Memory Allocated: 1.2246365547180176  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.8221435546875 GB
    Memory Allocated: 0.9260787963867188  GigaBytes
Max Memory Allocated: 1.2246365547180176  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.8221435546875 GB
    Memory Allocated: 0.535120964050293  GigaBytes
Max Memory Allocated: 1.2246365547180176  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.8221435546875 GB
    Memory Allocated: 0.535120964050293  GigaBytes
Max Memory Allocated: 1.2246365547180176  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.8221435546875 GB
    Memory Allocated: 0.535120964050293  GigaBytes
Max Memory Allocated: 1.2246365547180176  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1777794361114502 |0.006383657455444336 |0.0014858245849609375 |0.00014019012451171875 |0.0012989044189453125 |0.0007765293121337891 |
----------------------------------------------------------pseudo_mini_loss sum 2.4710114002227783
Total (block generation + training)time/epoch 0.6353293259938558
Training time/epoch 0.21331167221069336
Training time without block to device /epoch 0.20692801475524902
Training time without total dataloading part /epoch 0.003701448440551758
load block tensor time/epoch 0.1777794361114502
block to device time/epoch 0.006383657455444336
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  217197
Number of first layer input nodes during this epoch:  217197
Number of first layer output nodes during this epoch:  153431
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=602, out_features=41, bias=False)
      (fc_neigh): Linear(in_features=602, out_features=41, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  49364
trainable parameters
layers.0.fc_self.weight, torch.Size([41, 602])
layers.0.fc_neigh.weight, torch.Size([41, 602])
----------------------------------------
un-trainable parameters
