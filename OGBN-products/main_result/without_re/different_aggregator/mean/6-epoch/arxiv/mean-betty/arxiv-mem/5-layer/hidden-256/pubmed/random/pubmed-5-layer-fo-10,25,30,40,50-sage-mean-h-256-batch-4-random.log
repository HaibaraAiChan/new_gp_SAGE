main start at this time 1657103109.5754128
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  500
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0024242401123046875  GigaBytes
Max Memory Allocated: 0.0024242401123046875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0024242401123046875  GigaBytes
Max Memory Allocated: 0.0024242401123046875  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0027463436126708984
number of batches is  4
batch size is  15
random selection method spend 0.0008451938629150391
time for parepare:  4.5299530029296875e-05
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.0002536773681640625
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.002820730209350586
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.00013971328735351562
mini_batch_src_global generation:  2.5987625122070312e-05
r_  generation:  3.7670135498046875e-05
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00010633468627929688
mini_batch_src_global generation:  1.6927719116210938e-05
r_  generation:  3.3855438232421875e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00010061264038085938
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.218650817871094e-05
----------------------check_connections_block total spend ----------------------------- 0.003937244415283203
generate_one_block  0.004001617431640625
generate_one_block  0.0011670589447021484
generate_one_block  0.0010981559753417969
generate_one_block  0.0010547637939453125
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.00153350830078125
gen group dst list time:  3.314018249511719e-05
time for parepare:  0.00024056434631347656
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0004127025604248047
local_output_nid generation:  9.298324584960938e-06
local_in_edges_tensor generation:  0.0002536773681640625
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.00029850006103515625
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.000133514404296875
mini_batch_src_global generation:  4.649162292480469e-05
r_  generation:  0.0003714561462402344
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012445449829101562
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0002512931823730469
----------------------check_connections_block total spend ----------------------------- 0.0029244422912597656
generate_one_block  0.0015451908111572266
generate_one_block  0.001474618911743164
generate_one_block  0.0015583038330078125
generate_one_block  0.0013871192932128906
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0009891986846923828
gen group dst list time:  7.009506225585938e-05
time for parepare:  0.0006990432739257812
local_output_nid generation:  5.698204040527344e-05
local_in_edges_tensor generation:  0.00030922889709472656
mini_batch_src_global generation:  0.0001590251922607422
r_  generation:  0.0017621517181396484
local_output_nid generation:  5.507469177246094e-05
local_in_edges_tensor generation:  0.0002167224884033203
mini_batch_src_global generation:  0.00022745132446289062
r_  generation:  0.002135753631591797
local_output_nid generation:  6.628036499023438e-05
local_in_edges_tensor generation:  0.0002410411834716797
mini_batch_src_global generation:  0.0002830028533935547
r_  generation:  0.002619504928588867
local_output_nid generation:  5.054473876953125e-05
local_in_edges_tensor generation:  0.00019741058349609375
mini_batch_src_global generation:  0.0001800060272216797
r_  generation:  0.0015716552734375
----------------------check_connections_block total spend ----------------------------- 0.012952089309692383
generate_one_block  0.0034112930297851562
generate_one_block  0.0037336349487304688
generate_one_block  0.004189014434814453
generate_one_block  0.0030837059020996094
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0018656253814697266
gen group dst list time:  0.0002167224884033203
time for parepare:  0.0014929771423339844
local_output_nid generation:  0.0002124309539794922
local_in_edges_tensor generation:  0.0007681846618652344
mini_batch_src_global generation:  0.0007593631744384766
r_  generation:  0.0066258907318115234
local_output_nid generation:  0.00022649765014648438
local_in_edges_tensor generation:  0.0005435943603515625
mini_batch_src_global generation:  0.0009911060333251953
r_  generation:  0.007950067520141602
local_output_nid generation:  0.0002541542053222656
local_in_edges_tensor generation:  0.0006501674652099609
mini_batch_src_global generation:  0.0009989738464355469
r_  generation:  0.009618520736694336
local_output_nid generation:  0.0002474784851074219
local_in_edges_tensor generation:  0.0005753040313720703
mini_batch_src_global generation:  0.0007877349853515625
r_  generation:  0.007673501968383789
----------------------check_connections_block total spend ----------------------------- 0.04844307899475098
generate_one_block  0.010258197784423828
generate_one_block  0.011839866638183594
generate_one_block  0.013347625732421875
generate_one_block  0.01189565658569336
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0016331672668457031
gen group dst list time:  0.0007350444793701172
time for parepare:  0.0017726421356201172
local_output_nid generation:  0.0007863044738769531
local_in_edges_tensor generation:  0.0015821456909179688
mini_batch_src_global generation:  0.0011975765228271484
r_  generation:  0.013441324234008789
local_output_nid generation:  0.0008382797241210938
local_in_edges_tensor generation:  0.001535654067993164
mini_batch_src_global generation:  0.0015642642974853516
r_  generation:  0.013674736022949219
local_output_nid generation:  0.0009276866912841797
local_in_edges_tensor generation:  0.001451253890991211
mini_batch_src_global generation:  0.001295328140258789
r_  generation:  0.015677928924560547
local_output_nid generation:  0.0009558200836181641
local_in_edges_tensor generation:  0.0012755393981933594
mini_batch_src_global generation:  0.0012333393096923828
r_  generation:  0.015054941177368164
----------------------check_connections_block total spend ----------------------------- 0.08811163902282715
generate_one_block  0.0169219970703125
generate_one_block  0.019169330596923828
generate_one_block  0.020645618438720703
generate_one_block  0.019617795944213867
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0024242401123046875  GigaBytes
Max Memory Allocated: 0.0024242401123046875  GigaBytes

connection checking time:  0.15243124961853027
block generation total time  0.14407896995544434
average batch blocks generation time:  0.036019742488861084
block dataloader generation time/epoch 0.33443760871887207
pseudo mini batch 0 input nodes size: 13426
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0024242401123046875  GigaBytes
Max Memory Allocated: 0.0024242401123046875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0024242401123046875  GigaBytes
Max Memory Allocated: 0.0024242401123046875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0447998046875 GB
    Memory Allocated: 0.027814865112304688  GigaBytes
Max Memory Allocated: 0.027814865112304688  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0447998046875 GB
    Memory Allocated: 0.02781534194946289  GigaBytes
Max Memory Allocated: 0.02781534194946289  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0447998046875 GB
    Memory Allocated: 0.02781534194946289  GigaBytes
Max Memory Allocated: 0.02781534194946289  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1092529296875 GB
    Memory Allocated: 0.02831888198852539  GigaBytes
Max Memory Allocated: 0.02831888198852539  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1092529296875 GB
    Memory Allocated: 0.02831888198852539  GigaBytes
Max Memory Allocated: 0.02831888198852539  GigaBytes

first layer input nodes number: 13426
first layer output nodes number: 8338
edges number: 39367
----------------------------------------before model layer 0
 Nvidia-smi: 1.1092529296875 GB
    Memory Allocated: 0.028481483459472656  GigaBytes
Max Memory Allocated: 0.02862834930419922  GigaBytes

torch.Size([13426, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1092529296875 GB
    Memory Allocated: 0.028481483459472656  GigaBytes
Max Memory Allocated: 0.02862834930419922  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.0523834228515625  GigaBytes
Max Memory Allocated: 0.060088157653808594  GigaBytes

torch.Size([8338, 256])
torch.Size([8338, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06033515930175781  GigaBytes
Max Memory Allocated: 0.06828689575195312  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.0523834228515625  GigaBytes
Max Memory Allocated: 0.06828689575195312  GigaBytes

torch.Size([8338, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06033515930175781  GigaBytes
Max Memory Allocated: 0.06828689575195312  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06232309341430664  GigaBytes
Max Memory Allocated: 0.07027482986450195  GigaBytes

input nodes number: 8338
output nodes number: 2717
edges number: 21184
----------------------------------------before model layer 1
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.062406063079833984  GigaBytes
Max Memory Allocated: 0.07027482986450195  GigaBytes

torch.Size([8338, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.062406063079833984  GigaBytes
Max Memory Allocated: 0.07027482986450195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06776762008666992  GigaBytes
Max Memory Allocated: 0.07027482986450195  GigaBytes

torch.Size([2717, 256])
torch.Size([2717, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.0703587532043457  GigaBytes
Max Memory Allocated: 0.07294988632202148  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.06776762008666992  GigaBytes
Max Memory Allocated: 0.07294988632202148  GigaBytes

torch.Size([2717, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.0703587532043457  GigaBytes
Max Memory Allocated: 0.07294988632202148  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.07100677490234375  GigaBytes
Max Memory Allocated: 0.07359790802001953  GigaBytes

input nodes number: 2717
output nodes number: 697
edges number: 5564
----------------------------------------before model layer 2
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.07103252410888672  GigaBytes
Max Memory Allocated: 0.07359790802001953  GigaBytes

torch.Size([2717, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.07103252410888672  GigaBytes
Max Memory Allocated: 0.07359790802001953  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.07240962982177734  GigaBytes
Max Memory Allocated: 0.07359790802001953  GigaBytes

torch.Size([697, 256])
torch.Size([697, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.0730743408203125  GigaBytes
Max Memory Allocated: 0.07373905181884766  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.07240962982177734  GigaBytes
Max Memory Allocated: 0.07373905181884766  GigaBytes

torch.Size([697, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.0730743408203125  GigaBytes
Max Memory Allocated: 0.07373905181884766  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.07324075698852539  GigaBytes
Max Memory Allocated: 0.07390546798706055  GigaBytes

input nodes number: 697
output nodes number: 117
edges number: 1047
----------------------------------------before model layer 3
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.07324695587158203  GigaBytes
Max Memory Allocated: 0.07390546798706055  GigaBytes

torch.Size([697, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.07324695587158203  GigaBytes
Max Memory Allocated: 0.07390546798706055  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.07347965240478516  GigaBytes
Max Memory Allocated: 0.07390546798706055  GigaBytes

torch.Size([117, 256])
torch.Size([117, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.07359123229980469  GigaBytes
Max Memory Allocated: 0.07390546798706055  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.07347965240478516  GigaBytes
Max Memory Allocated: 0.07390546798706055  GigaBytes

torch.Size([117, 256])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.07359123229980469  GigaBytes
Max Memory Allocated: 0.07390546798706055  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.07361936569213867  GigaBytes
Max Memory Allocated: 0.07390546798706055  GigaBytes

----------------input nodes number: 117
----------------output nodes number: 15
----------------edges number: 103
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.07362079620361328  GigaBytes
Max Memory Allocated: 0.07390546798706055  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.07363748550415039  GigaBytes
Max Memory Allocated: 0.07390546798706055  GigaBytes

torch.Size([15, 3])
torch.Size([15, 3])
----------------------------------------after rst
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.0736379623413086  GigaBytes
Max Memory Allocated: 0.07390546798706055  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.07363748550415039  GigaBytes
Max Memory Allocated: 0.07390546798706055  GigaBytes

torch.Size([15, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.0736379623413086  GigaBytes
Max Memory Allocated: 0.07390546798706055  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.0736393928527832  GigaBytes
Max Memory Allocated: 0.07390546798706055  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3709716796875 GB
    Memory Allocated: 0.03182792663574219  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

pseudo mini batch 1 input nodes size: 13297
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3709716796875 GB
    Memory Allocated: 0.030241012573242188  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3709716796875 GB
    Memory Allocated: 0.030241012573242188  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.05563163757324219  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.05563211441040039  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.030241012573242188  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.0308074951171875  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.0308074951171875  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

first layer input nodes number: 13297
first layer output nodes number: 8680
edges number: 40686
----------------------------------------before model layer 0
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.030971527099609375  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

torch.Size([13297, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.030971527099609375  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.055753231048583984  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

torch.Size([8680, 256])
torch.Size([8680, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.06403112411499023  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.055753231048583984  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

torch.Size([8680, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.06403112411499023  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.06700658798217773  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

input nodes number: 8680
output nodes number: 2774
edges number: 27261
----------------------------------------before model layer 1
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.0670924186706543  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

torch.Size([8680, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.0670924186706543  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.07332515716552734  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

torch.Size([2774, 256])
torch.Size([2774, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.07597064971923828  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.07260751724243164  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

torch.Size([2774, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.07597064971923828  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.07591438293457031  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

input nodes number: 2774
output nodes number: 665
edges number: 6801
----------------------------------------before model layer 2
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.07594060897827148  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

torch.Size([2774, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.07594060897827148  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.07726621627807617  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

torch.Size([665, 256])
torch.Size([665, 256])
----------------------------------------after rst
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.07790040969848633  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.07726621627807617  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

torch.Size([665, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.07790040969848633  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.07805919647216797  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

input nodes number: 665
output nodes number: 80
edges number: 908
----------------------------------------before model layer 3
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.07806539535522461  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

torch.Size([665, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.07806539535522461  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.07822656631469727  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

torch.Size([80, 256])
torch.Size([80, 256])
----------------------------------------after rst
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.07830286026000977  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.07822656631469727  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

torch.Size([80, 256])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.07830286026000977  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.07832193374633789  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------input nodes number: 80
----------------output nodes number: 15
----------------edges number: 65
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.0783233642578125  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.07834005355834961  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

torch.Size([15, 3])
torch.Size([15, 3])
----------------------------------------after rst
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.07834053039550781  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.07834005355834961  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

torch.Size([15, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.07834005355834961  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.07834100723266602  GigaBytes
Max Memory Allocated: 0.08029413223266602  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.032013893127441406  GigaBytes
Max Memory Allocated: 0.08426952362060547  GigaBytes

pseudo mini batch 2 input nodes size: 14522
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.030241012573242188  GigaBytes
Max Memory Allocated: 0.08426952362060547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4002685546875 GB
    Memory Allocated: 0.030241012573242188  GigaBytes
Max Memory Allocated: 0.08426952362060547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.05758476257324219  GigaBytes
Max Memory Allocated: 0.08426952362060547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.05758523941040039  GigaBytes
Max Memory Allocated: 0.08426952362060547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.03219413757324219  GigaBytes
Max Memory Allocated: 0.08426952362060547  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.03285694122314453  GigaBytes
Max Memory Allocated: 0.08426952362060547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.03285694122314453  GigaBytes
Max Memory Allocated: 0.08426952362060547  GigaBytes

first layer input nodes number: 14522
first layer output nodes number: 10785
edges number: 45806
----------------------------------------before model layer 0
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.03304576873779297  GigaBytes
Max Memory Allocated: 0.08426952362060547  GigaBytes

torch.Size([14522, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4276123046875 GB
    Memory Allocated: 0.03304576873779297  GigaBytes
Max Memory Allocated: 0.08426952362060547  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.06380176544189453  GigaBytes
Max Memory Allocated: 0.08426952362060547  GigaBytes

torch.Size([10785, 256])
torch.Size([10785, 256])
----------------------------------------after rst
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.07408714294433594  GigaBytes
Max Memory Allocated: 0.08437252044677734  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.06380176544189453  GigaBytes
Max Memory Allocated: 0.08437252044677734  GigaBytes

torch.Size([10785, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.07408714294433594  GigaBytes
Max Memory Allocated: 0.08437252044677734  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.07665872573852539  GigaBytes
Max Memory Allocated: 0.0869441032409668  GigaBytes

input nodes number: 10785
output nodes number: 3321
edges number: 33152
----------------------------------------before model layer 1
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.07676410675048828  GigaBytes
Max Memory Allocated: 0.0869441032409668  GigaBytes

torch.Size([10785, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.07676410675048828  GigaBytes
Max Memory Allocated: 0.0869441032409668  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.08337020874023438  GigaBytes
Max Memory Allocated: 0.0869441032409668  GigaBytes

torch.Size([3321, 256])
torch.Size([3321, 256])
----------------------------------------after rst
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.08653736114501953  GigaBytes
Max Memory Allocated: 0.08970451354980469  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.08337020874023438  GigaBytes
Max Memory Allocated: 0.08970451354980469  GigaBytes

torch.Size([3321, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.08653736114501953  GigaBytes
Max Memory Allocated: 0.08970451354980469  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.08732938766479492  GigaBytes
Max Memory Allocated: 0.09049654006958008  GigaBytes

input nodes number: 3321
output nodes number: 833
edges number: 8698
----------------------------------------before model layer 2
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.08736085891723633  GigaBytes
Max Memory Allocated: 0.09049654006958008  GigaBytes

torch.Size([3321, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.08736085891723633  GigaBytes
Max Memory Allocated: 0.09049654006958008  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.08902120590209961  GigaBytes
Max Memory Allocated: 0.09049654006958008  GigaBytes

torch.Size([833, 256])
torch.Size([833, 256])
----------------------------------------after rst
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.08981561660766602  GigaBytes
Max Memory Allocated: 0.09061002731323242  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.08902120590209961  GigaBytes
Max Memory Allocated: 0.09061002731323242  GigaBytes

torch.Size([833, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.08981561660766602  GigaBytes
Max Memory Allocated: 0.09061002731323242  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.09001445770263672  GigaBytes
Max Memory Allocated: 0.09080886840820312  GigaBytes

input nodes number: 833
output nodes number: 84
edges number: 1149
----------------------------------------before model layer 3
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.09002208709716797  GigaBytes
Max Memory Allocated: 0.09080886840820312  GigaBytes

torch.Size([833, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.09002208709716797  GigaBytes
Max Memory Allocated: 0.09080886840820312  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.09019184112548828  GigaBytes
Max Memory Allocated: 0.09080886840820312  GigaBytes

torch.Size([84, 256])
torch.Size([84, 256])
----------------------------------------after rst
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.0902719497680664  GigaBytes
Max Memory Allocated: 0.09080886840820312  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.09019184112548828  GigaBytes
Max Memory Allocated: 0.09080886840820312  GigaBytes

torch.Size([84, 256])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.0902719497680664  GigaBytes
Max Memory Allocated: 0.09080886840820312  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.09029197692871094  GigaBytes
Max Memory Allocated: 0.09080886840820312  GigaBytes

----------------input nodes number: 84
----------------output nodes number: 15
----------------edges number: 70
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.09029340744018555  GigaBytes
Max Memory Allocated: 0.09080886840820312  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.09031009674072266  GigaBytes
Max Memory Allocated: 0.09080886840820312  GigaBytes

torch.Size([15, 3])
torch.Size([15, 3])
----------------------------------------after rst
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.09031057357788086  GigaBytes
Max Memory Allocated: 0.09080886840820312  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.09031009674072266  GigaBytes
Max Memory Allocated: 0.09080886840820312  GigaBytes

torch.Size([15, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.09031009674072266  GigaBytes
Max Memory Allocated: 0.09080886840820312  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4315185546875 GB
    Memory Allocated: 0.09031105041503906  GigaBytes
Max Memory Allocated: 0.09080886840820312  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.03428983688354492  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

pseudo mini batch 3 input nodes size: 14238
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.03219413757324219  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4451904296875 GB
    Memory Allocated: 0.03219413757324219  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.05953788757324219  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.05953836441040039  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.03219413757324219  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.03276634216308594  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.03276634216308594  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

first layer input nodes number: 14238
first layer output nodes number: 9799
edges number: 44192
----------------------------------------before model layer 0
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.032946109771728516  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

torch.Size([14238, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.032946109771728516  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.06091022491455078  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

torch.Size([9799, 256])
torch.Size([9799, 256])
----------------------------------------after rst
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.07025527954101562  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.06091022491455078  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

torch.Size([9799, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.07109642028808594  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.07259178161621094  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

input nodes number: 9799
output nodes number: 2825
edges number: 26507
----------------------------------------before model layer 1
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.07268667221069336  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

torch.Size([9799, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.07268667221069336  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.07829523086547852  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

torch.Size([2825, 256])
torch.Size([2825, 256])
----------------------------------------after rst
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08098936080932617  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.07829523086547852  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

torch.Size([2825, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08098936080932617  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08166313171386719  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

input nodes number: 2825
output nodes number: 603
edges number: 4887
----------------------------------------before model layer 2
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08168935775756836  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

torch.Size([2825, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08168935775756836  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08288145065307617  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

torch.Size([603, 256])
torch.Size([603, 256])
----------------------------------------after rst
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08345651626586914  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08288145065307617  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

torch.Size([603, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08345651626586914  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08360052108764648  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

input nodes number: 603
output nodes number: 74
edges number: 709
----------------------------------------before model layer 3
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08360624313354492  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

torch.Size([603, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08360624313354492  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08375406265258789  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

torch.Size([74, 256])
torch.Size([74, 256])
----------------------------------------after rst
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08382463455200195  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08375406265258789  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

torch.Size([74, 256])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08382463455200195  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08384227752685547  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------input nodes number: 74
----------------output nodes number: 15
----------------edges number: 59
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08384370803833008  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08386039733886719  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

torch.Size([15, 3])
torch.Size([15, 3])
----------------------------------------after rst
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08386087417602539  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08386039733886719  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

torch.Size([15, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.08386039733886719  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.0838613510131836  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.03399038314819336  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.038838863372802734  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.4725341796875 GB
    Memory Allocated: 0.038838863372802734  GigaBytes
Max Memory Allocated: 0.09809207916259766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010166168212890625 |0.08766651153564453 |0.21219122409820557 |0.00019353628158569336 |0.005515754222869873 |0.002633333206176758 |
----------------------------------------------------------pseudo_mini_loss sum 1.105656623840332
Total (block generation + training)time/epoch 1.6148009300231934
Training time/epoch 1.2799711227416992
Training time without block to device /epoch 0.9293050765991211
Training time without total dataloading part /epoch 0.8742353916168213
load block tensor time/epoch 0.0406646728515625
block to device time/epoch 0.3506660461425781
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  107875
Number of first layer input nodes during this epoch:  55483
Number of first layer output nodes during this epoch:  37602
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=500, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=500, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (4): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=3, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=3, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  650752
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 500])
layers.0.fc_neigh.weight, torch.Size([256, 500])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([256, 256])
layers.3.fc_neigh.weight, torch.Size([256, 256])
layers.4.fc_self.weight, torch.Size([3, 256])
layers.4.fc_neigh.weight, torch.Size([3, 256])
----------------------------------------
un-trainable parameters
