main start at this time 1657102915.2868516
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00421142578125  GigaBytes
Max Memory Allocated: 0.00421142578125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00421142578125  GigaBytes
Max Memory Allocated: 0.00421142578125  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0012238025665283203
global_2_local spend time (sec) 0.00012373924255371094
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0006058216094970703
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 504, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 9: 4, 7: 4, 10: 3, 8: 3, 12: 2, 21: 1, 11: 1, 36: 1, 19: 1, 32: 1})

A = g.adjacency_matrix() spent  0.0003924369812011719
auxiliary_graph
Graph(num_nodes=644, num_edges=438,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0007035732269287109
remove nodes length  504

auxiliary_graph.remove_nodes spent  0.0017042160034179688
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=438,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0008835792541503906

the counter of shared neighbor distribution
Counter({1.0: 252, 2.0: 30, 3.0: 14, 4.0: 2})
298
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.002143383026123047
35
34
35
36
total k batches seeds list generation spend  0.01199650764465332
after graph partition
graph partition algorithm spend time 0.059252262115478516
35
34
35
36
partition_len_list
[181, 174, 178, 131]
REG selection method  spend 0.05955314636230469
time for parepare:  6.103515625e-05
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  8.082389831542969e-05
local_output_nid generation:  3.814697265625e-06
local_in_edges_tensor generation:  0.00010704994201660156
mini_batch_src_global generation:  2.3603439331054688e-05
r_  generation:  6.341934204101562e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  6.842613220214844e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  0.00010180473327636719
mini_batch_src_global generation:  1.8596649169921875e-05
r_  generation:  5.1021575927734375e-05
----------------------check_connections_block total spend ----------------------------- 0.0010883808135986328
generate_one_block  0.0026121139526367188
generate_one_block  0.00109100341796875
generate_one_block  0.0010914802551269531
generate_one_block  0.0010967254638671875
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0004971027374267578
gen group dst list time:  4.100799560546875e-05
time for parepare:  0.0001423358917236328
local_output_nid generation:  1.5020370483398438e-05
local_in_edges_tensor generation:  0.00018405914306640625
mini_batch_src_global generation:  5.030632019042969e-05
r_  generation:  0.0004069805145263672
local_output_nid generation:  1.621246337890625e-05
local_in_edges_tensor generation:  0.00013327598571777344
mini_batch_src_global generation:  4.887580871582031e-05
r_  generation:  0.00031638145446777344
local_output_nid generation:  3.314018249511719e-05
local_in_edges_tensor generation:  0.0001354217529296875
mini_batch_src_global generation:  5.173683166503906e-05
r_  generation:  0.00036716461181640625
local_output_nid generation:  1.1444091796875e-05
local_in_edges_tensor generation:  0.00012540817260742188
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0002522468566894531
----------------------check_connections_block total spend ----------------------------- 0.0027704238891601562
generate_one_block  0.0014767646789550781
generate_one_block  0.0013632774353027344
generate_one_block  0.001416921615600586
generate_one_block  0.00124359130859375
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005743503570556641
gen group dst list time:  6.222724914550781e-05
time for parepare:  0.0002014636993408203
local_output_nid generation:  4.7206878662109375e-05
local_in_edges_tensor generation:  0.00026154518127441406
mini_batch_src_global generation:  0.00010347366333007812
r_  generation:  0.0011112689971923828
local_output_nid generation:  3.7670135498046875e-05
local_in_edges_tensor generation:  0.0001747608184814453
mini_batch_src_global generation:  0.00010395050048828125
r_  generation:  0.0008637905120849609
local_output_nid generation:  3.886222839355469e-05
local_in_edges_tensor generation:  0.0001697540283203125
mini_batch_src_global generation:  9.608268737792969e-05
r_  generation:  0.0008766651153564453
local_output_nid generation:  3.123283386230469e-05
local_in_edges_tensor generation:  0.0001614093780517578
mini_batch_src_global generation:  8.654594421386719e-05
r_  generation:  0.0006647109985351562
----------------------check_connections_block total spend ----------------------------- 0.00600123405456543
generate_one_block  0.0023140907287597656
generate_one_block  0.0020360946655273438
generate_one_block  0.002026796340942383
generate_one_block  0.0017571449279785156
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0007443428039550781
gen group dst list time:  0.00010275840759277344
time for parepare:  0.0001823902130126953
local_output_nid generation:  8.988380432128906e-05
local_in_edges_tensor generation:  0.00038504600524902344
mini_batch_src_global generation:  0.00019073486328125
r_  generation:  0.002108335494995117
local_output_nid generation:  9.059906005859375e-05
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  0.0001857280731201172
r_  generation:  0.0018627643585205078
local_output_nid generation:  7.486343383789062e-05
local_in_edges_tensor generation:  0.00022792816162109375
mini_batch_src_global generation:  0.00015163421630859375
r_  generation:  0.0016133785247802734
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.00023221969604492188
mini_batch_src_global generation:  0.000152587890625
r_  generation:  0.0015909671783447266
----------------------check_connections_block total spend ----------------------------- 0.011316061019897461
generate_one_block  0.003425121307373047
generate_one_block  0.0029752254486083984
generate_one_block  0.0026397705078125
generate_one_block  0.0026755332946777344
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008108615875244141
gen group dst list time:  0.0001652240753173828
time for parepare:  0.00019788742065429688
local_output_nid generation:  0.00013828277587890625
local_in_edges_tensor generation:  0.000499725341796875
mini_batch_src_global generation:  0.0002484321594238281
r_  generation:  0.002839803695678711
local_output_nid generation:  0.0001266002655029297
local_in_edges_tensor generation:  0.00031948089599609375
mini_batch_src_global generation:  0.00026106834411621094
r_  generation:  0.002526521682739258
local_output_nid generation:  0.0001327991485595703
local_in_edges_tensor generation:  0.0003223419189453125
mini_batch_src_global generation:  0.00020575523376464844
r_  generation:  0.002376556396484375
local_output_nid generation:  0.00012373924255371094
local_in_edges_tensor generation:  0.0002999305725097656
mini_batch_src_global generation:  0.00020170211791992188
r_  generation:  0.0024487972259521484
----------------------check_connections_block total spend ----------------------------- 0.01579904556274414
generate_one_block  0.0042345523834228516
generate_one_block  0.003824472427368164
generate_one_block  0.003567934036254883
generate_one_block  0.003688335418701172
----------===============-------------===============-------------the number of batches *****---- 4

original number of batches:  4
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00421142578125  GigaBytes
Max Memory Allocated: 0.00421142578125  GigaBytes

connection checking time:  0.03697514533996582
block generation total time  0.046556949615478516
average batch blocks generation time:  0.002327847480773926
block dataloader generation time/epoch 0.1562023162841797
pseudo mini batch 0 input nodes size: 2347
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00421142578125  GigaBytes
Max Memory Allocated: 0.00421142578125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00421142578125  GigaBytes
Max Memory Allocated: 0.00421142578125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.016740798950195312  GigaBytes
Max Memory Allocated: 0.016740798950195312  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.016741275787353516  GigaBytes
Max Memory Allocated: 0.016741275787353516  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.016741275787353516  GigaBytes
Max Memory Allocated: 0.016741275787353516  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.016888141632080078  GigaBytes
Max Memory Allocated: 0.016888141632080078  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.016888141632080078  GigaBytes
Max Memory Allocated: 0.016888141632080078  GigaBytes

first layer input nodes number: 2347
first layer output nodes number: 2075
edges number: 8130
----------------------------------------before model layer 0
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.016921520233154297  GigaBytes
Max Memory Allocated: 0.016952037811279297  GigaBytes

torch.Size([2347, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.016921520233154297  GigaBytes
Max Memory Allocated: 0.016952037811279297  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.03068828582763672  GigaBytes
Max Memory Allocated: 0.0404362678527832  GigaBytes

torch.Size([2075, 256])
torch.Size([2075, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.03266716003417969  GigaBytes
Max Memory Allocated: 0.0404362678527832  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.03068828582763672  GigaBytes
Max Memory Allocated: 0.0404362678527832  GigaBytes

torch.Size([2075, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.03266716003417969  GigaBytes
Max Memory Allocated: 0.0404362678527832  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.03347301483154297  GigaBytes
Max Memory Allocated: 0.0404362678527832  GigaBytes

input nodes number: 2075
output nodes number: 1395
edges number: 6437
----------------------------------------before model layer 1
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.03349924087524414  GigaBytes
Max Memory Allocated: 0.0404362678527832  GigaBytes

torch.Size([2075, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.03349924087524414  GigaBytes
Max Memory Allocated: 0.0404362678527832  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.036867618560791016  GigaBytes
Max Memory Allocated: 0.0404362678527832  GigaBytes

torch.Size([1395, 256])
torch.Size([1395, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.038197994232177734  GigaBytes
Max Memory Allocated: 0.0404362678527832  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.036219120025634766  GigaBytes
Max Memory Allocated: 0.0404362678527832  GigaBytes

torch.Size([1395, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.037549495697021484  GigaBytes
Max Memory Allocated: 0.0404362678527832  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.038530826568603516  GigaBytes
Max Memory Allocated: 0.0404362678527832  GigaBytes

input nodes number: 1395
output nodes number: 692
edges number: 3418
----------------------------------------before model layer 2
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.03854656219482422  GigaBytes
Max Memory Allocated: 0.0404362678527832  GigaBytes

torch.Size([1395, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.03854656219482422  GigaBytes
Max Memory Allocated: 0.0404362678527832  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3006591796875 GB
    Memory Allocated: 0.039897918701171875  GigaBytes
Max Memory Allocated: 0.0404362678527832  GigaBytes

torch.Size([692, 256])
torch.Size([692, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.040557861328125  GigaBytes
Max Memory Allocated: 0.041217803955078125  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.039897918701171875  GigaBytes
Max Memory Allocated: 0.041217803955078125  GigaBytes

torch.Size([692, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.040557861328125  GigaBytes
Max Memory Allocated: 0.041217803955078125  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.04072284698486328  GigaBytes
Max Memory Allocated: 0.041382789611816406  GigaBytes

input nodes number: 692
output nodes number: 181
edges number: 1212
----------------------------------------before model layer 3
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.040729522705078125  GigaBytes
Max Memory Allocated: 0.041382789611816406  GigaBytes

torch.Size([692, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.040729522705078125  GigaBytes
Max Memory Allocated: 0.041382789611816406  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.04108619689941406  GigaBytes
Max Memory Allocated: 0.041382789611816406  GigaBytes

torch.Size([181, 256])
torch.Size([181, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.041258811950683594  GigaBytes
Max Memory Allocated: 0.041431427001953125  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.04108619689941406  GigaBytes
Max Memory Allocated: 0.041431427001953125  GigaBytes

torch.Size([181, 256])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.041258811950683594  GigaBytes
Max Memory Allocated: 0.041431427001953125  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.04130220413208008  GigaBytes
Max Memory Allocated: 0.04147481918334961  GigaBytes

----------------input nodes number: 181
----------------output nodes number: 35
----------------edges number: 183
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.04130411148071289  GigaBytes
Max Memory Allocated: 0.04147481918334961  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.041341304779052734  GigaBytes
Max Memory Allocated: 0.04147481918334961  GigaBytes

torch.Size([35, 7])
torch.Size([35, 7])
----------------------------------------after rst
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.04134225845336914  GigaBytes
Max Memory Allocated: 0.04147481918334961  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.041341304779052734  GigaBytes
Max Memory Allocated: 0.04147481918334961  GigaBytes

torch.Size([35, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.04134225845336914  GigaBytes
Max Memory Allocated: 0.04147481918334961  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3026123046875 GB
    Memory Allocated: 0.04134416580200195  GigaBytes
Max Memory Allocated: 0.04147481918334961  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.022065162658691406  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

pseudo mini batch 1 input nodes size: 2196
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.02156686782836914  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.02156686782836914  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03328990936279297  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03329038619995117  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.020760536193847656  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.020887374877929688  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.020887374877929688  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

first layer input nodes number: 2196
first layer output nodes number: 1844
edges number: 7427
----------------------------------------before model layer 0
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.020917892456054688  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([2196, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.020917892456054688  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.0327000617980957  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([1844, 256])
torch.Size([1844, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03498983383178711  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.033115386962890625  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([1844, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03498983383178711  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03550386428833008  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

input nodes number: 1844
output nodes number: 1193
edges number: 5623
----------------------------------------before model layer 1
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03552675247192383  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([1844, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03552675247192383  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.038590431213378906  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([1193, 256])
torch.Size([1193, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03972816467285156  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03785371780395508  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([1193, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.038991451263427734  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04001283645629883  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

input nodes number: 1193
output nodes number: 480
edges number: 2671
----------------------------------------before model layer 2
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04002571105957031  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([1193, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04002571105957031  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04096508026123047  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([480, 256])
torch.Size([480, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04142284393310547  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04096508026123047  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([480, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04142284393310547  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04153728485107422  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

input nodes number: 480
output nodes number: 174
edges number: 861
----------------------------------------before model layer 3
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04154253005981445  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([480, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04154253005981445  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.041882991790771484  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([174, 256])
torch.Size([174, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04204893112182617  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.041882991790771484  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([174, 256])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04204893112182617  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.042090415954589844  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------input nodes number: 174
----------------output nodes number: 34
----------------edges number: 157
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.042092323303222656  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.042128562927246094  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([34, 7])
torch.Size([34, 7])
----------------------------------------after rst
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.0421295166015625  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.042128562927246094  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([34, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.042128562927246094  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.0421299934387207  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.02118825912475586  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

pseudo mini batch 2 input nodes size: 2187
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.020760536193847656  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.020760536193847656  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.032479286193847656  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03247976303100586  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.020756244659423828  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.02087545394897461  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.02087545394897461  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

first layer input nodes number: 2187
first layer output nodes number: 1730
edges number: 7054
----------------------------------------before model layer 0
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.020905494689941406  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([2187, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.020905494689941406  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03249073028564453  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([1730, 256])
torch.Size([1730, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.034140586853027344  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03185081481933594  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([1730, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.034140586853027344  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03391313552856445  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

input nodes number: 1730
output nodes number: 1036
edges number: 4831
----------------------------------------before model layer 1
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.033934593200683594  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([1730, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.033934593200683594  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.036269187927246094  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([1036, 256])
torch.Size([1036, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03725719451904297  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03595542907714844  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([1036, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03725719451904297  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03784656524658203  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

input nodes number: 1036
output nodes number: 489
edges number: 2540
----------------------------------------before model layer 2
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03785848617553711  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([1036, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03785848617553711  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03881406784057617  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([489, 256])
torch.Size([489, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03928041458129883  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03881406784057617  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([489, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03928041458129883  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.039397239685058594  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

input nodes number: 489
output nodes number: 178
edges number: 1062
----------------------------------------before model layer 3
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03940248489379883  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([489, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03940248489379883  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03975248336791992  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([178, 256])
torch.Size([178, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.039922237396240234  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03975248336791992  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([178, 256])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.039922237396240234  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03996467590332031  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------input nodes number: 178
----------------output nodes number: 35
----------------edges number: 180
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.039966583251953125  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04000377655029297  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([35, 7])
torch.Size([35, 7])
----------------------------------------after rst
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.040004730224609375  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04000377655029297  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([35, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04000377655029297  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04000520706176758  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.02115917205810547  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

pseudo mini batch 3 input nodes size: 2220
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.020756244659423828  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.020756244659423828  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03328561782836914  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.033286094665527344  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.02156686782836914  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.021679401397705078  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.021679401397705078  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

first layer input nodes number: 2220
first layer output nodes number: 1777
edges number: 7267
----------------------------------------before model layer 0
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.021709442138671875  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([2220, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.021709442138671875  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.033489227294921875  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([1777, 256])
torch.Size([1777, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03518390655517578  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03295183181762695  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([1777, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03518390655517578  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03566551208496094  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

input nodes number: 1777
output nodes number: 996
edges number: 4958
----------------------------------------before model layer 1
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.035686492919921875  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([1777, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.035686492919921875  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03763103485107422  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([996, 256])
torch.Size([996, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.038580894470214844  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03763103485107422  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([996, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.038580894470214844  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.038818359375  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

input nodes number: 996
output nodes number: 376
edges number: 1989
----------------------------------------before model layer 2
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03882884979248047  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([996, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03882884979248047  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03956413269042969  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([376, 256])
torch.Size([376, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03992271423339844  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03956413269042969  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([376, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.03992271423339844  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.040012359619140625  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

input nodes number: 376
output nodes number: 131
edges number: 623
----------------------------------------before model layer 3
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04001665115356445  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([376, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04001665115356445  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.040273189544677734  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([131, 256])
torch.Size([131, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04039812088012695  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.040273189544677734  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([131, 256])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04039812088012695  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04042959213256836  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------input nodes number: 131
----------------output nodes number: 36
----------------edges number: 118
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04043149948120117  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.040468692779541016  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([36, 7])
torch.Size([36, 7])
----------------------------------------after rst
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.04046964645385742  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.040468692779541016  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

torch.Size([36, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.040468692779541016  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3221435546875 GB
    Memory Allocated: 0.040470123291015625  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.021944046020507812  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.03129005432128906  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.3240966796875 GB
    Memory Allocated: 0.03129005432128906  GigaBytes
Max Memory Allocated: 0.04258298873901367  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0076354146003723145 |0.0868825912475586 |0.21174097061157227 |0.00017404556274414062 |0.00522160530090332 |0.0041162967681884766 |
----------------------------------------------------------pseudo_mini_loss sum 1.9594306945800781
Total (block generation + training)time/epoch 1.4225294589996338
Training time/epoch 1.2659525871276855
Training time without block to device /epoch 0.9184222221374512
Training time without total dataloading part /epoch 0.8726627826690674
load block tensor time/epoch 0.030541658401489258
block to device time/epoch 0.3475303649902344
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  23697
Number of first layer input nodes during this epoch:  8950
Number of first layer output nodes during this epoch:  7426
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=1433, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (4): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  1130496
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 1433])
layers.0.fc_neigh.weight, torch.Size([256, 1433])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([256, 256])
layers.3.fc_neigh.weight, torch.Size([256, 256])
layers.4.fc_self.weight, torch.Size([7, 256])
layers.4.fc_neigh.weight, torch.Size([7, 256])
----------------------------------------
un-trainable parameters
