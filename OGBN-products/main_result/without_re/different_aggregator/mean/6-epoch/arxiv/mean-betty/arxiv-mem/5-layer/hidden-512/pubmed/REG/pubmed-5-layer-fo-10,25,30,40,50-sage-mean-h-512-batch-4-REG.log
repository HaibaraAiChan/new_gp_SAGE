main start at this time 1657105099.5635054
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  500
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007778167724609375  GigaBytes
Max Memory Allocated: 0.007778167724609375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007778167724609375  GigaBytes
Max Memory Allocated: 0.007778167724609375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.001939535140991211
global_2_local spend time (sec) 6.771087646484375e-05
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0003592967987060547
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 294, 1: 26, 2: 6, 3: 6, 6: 4, 4: 3, 8: 3, 5: 2, 17: 2, 18: 1, 7: 1, 31: 1, 22: 1, 10: 1, 29: 1, 9: 1, 11: 1})

A = g.adjacency_matrix() spent  0.0003266334533691406
auxiliary_graph
Graph(num_nodes=354, num_edges=66,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.00038361549377441406
remove nodes length  294

auxiliary_graph.remove_nodes spent  0.0007469654083251953
after remove non output nodes the auxiliary_graph
Graph(num_nodes=60, num_edges=66,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0007996559143066406

the counter of shared neighbor distribution
Counter({1.0: 6})
6
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.000 seconds
Construct subgraphs: 0.001 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.0018038749694824219
15
15
15
15
total k batches seeds list generation spend  0.007762908935546875
after graph partition
graph partition algorithm spend time 0.10175681114196777
15
15
15
15
partition_len_list
[107, 101, 77, 69]
REG selection method  spend 0.10196471214294434
time for parepare:  4.458427429199219e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00011181831359863281
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  6.580352783203125e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00011157989501953125
mini_batch_src_global generation:  2.0503997802734375e-05
r_  generation:  4.76837158203125e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010609626770019531
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.600120544433594e-05
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010251998901367188
mini_batch_src_global generation:  1.7642974853515625e-05
r_  generation:  3.075599670410156e-05
----------------------check_connections_block total spend ----------------------------- 0.001009225845336914
generate_one_block  0.002696990966796875
generate_one_block  0.00139617919921875
generate_one_block  0.0011053085327148438
generate_one_block  0.0010921955108642578
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0011899471282958984
gen group dst list time:  3.409385681152344e-05
time for parepare:  0.0002579689025878906
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00019168853759765625
mini_batch_src_global generation:  4.696846008300781e-05
r_  generation:  0.0002980232238769531
local_output_nid generation:  1.049041748046875e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  6.842613220214844e-05
r_  generation:  0.0003972053527832031
local_output_nid generation:  8.821487426757812e-06
local_in_edges_tensor generation:  0.0001308917999267578
mini_batch_src_global generation:  4.935264587402344e-05
r_  generation:  0.0002980232238769531
local_output_nid generation:  7.3909759521484375e-06
local_in_edges_tensor generation:  0.00012493133544921875
mini_batch_src_global generation:  4.839897155761719e-05
r_  generation:  0.0003440380096435547
----------------------check_connections_block total spend ----------------------------- 0.0028755664825439453
generate_one_block  0.0015034675598144531
generate_one_block  0.001600027084350586
generate_one_block  0.0014388561248779297
generate_one_block  0.0015025138854980469
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012331008911132812
gen group dst list time:  9.298324584960938e-05
time for parepare:  0.0009152889251708984
local_output_nid generation:  6.985664367675781e-05
local_in_edges_tensor generation:  0.00035572052001953125
mini_batch_src_global generation:  0.00020766258239746094
r_  generation:  0.002087116241455078
local_output_nid generation:  8.630752563476562e-05
local_in_edges_tensor generation:  0.0002837181091308594
mini_batch_src_global generation:  0.00033974647521972656
r_  generation:  0.0021779537200927734
local_output_nid generation:  0.00010251998901367188
local_in_edges_tensor generation:  0.00026988983154296875
mini_batch_src_global generation:  0.00023126602172851562
r_  generation:  0.001857757568359375
local_output_nid generation:  7.414817810058594e-05
local_in_edges_tensor generation:  0.00021839141845703125
mini_batch_src_global generation:  0.0002162456512451172
r_  generation:  0.0021653175354003906
----------------------check_connections_block total spend ----------------------------- 0.01405191421508789
generate_one_block  0.004060506820678711
generate_one_block  0.0035822391510009766
generate_one_block  0.003309488296508789
generate_one_block  0.00374603271484375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020301342010498047
gen group dst list time:  0.00022912025451660156
time for parepare:  0.0014543533325195312
local_output_nid generation:  0.0002663135528564453
local_in_edges_tensor generation:  0.0008296966552734375
mini_batch_src_global generation:  0.0009610652923583984
r_  generation:  0.008045673370361328
local_output_nid generation:  0.0002338886260986328
local_in_edges_tensor generation:  0.0005702972412109375
mini_batch_src_global generation:  0.0010128021240234375
r_  generation:  0.00771021842956543
local_output_nid generation:  0.00020074844360351562
local_in_edges_tensor generation:  0.00044846534729003906
mini_batch_src_global generation:  0.0006606578826904297
r_  generation:  0.006955146789550781
local_output_nid generation:  0.00019025802612304688
local_in_edges_tensor generation:  0.0004744529724121094
mini_batch_src_global generation:  0.0007517337799072266
r_  generation:  0.0072021484375
----------------------check_connections_block total spend ----------------------------- 0.04562568664550781
generate_one_block  0.012369871139526367
generate_one_block  0.011548280715942383
generate_one_block  0.010178327560424805
generate_one_block  0.011208057403564453
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0020101070404052734
gen group dst list time:  0.0006902217864990234
time for parepare:  0.001668691635131836
local_output_nid generation:  0.0008678436279296875
local_in_edges_tensor generation:  0.0018901824951171875
mini_batch_src_global generation:  0.0013544559478759766
r_  generation:  0.014782190322875977
local_output_nid generation:  0.0008459091186523438
local_in_edges_tensor generation:  0.001617431640625
mini_batch_src_global generation:  0.0016031265258789062
r_  generation:  0.014972209930419922
local_output_nid generation:  0.0007305145263671875
local_in_edges_tensor generation:  0.0010268688201904297
mini_batch_src_global generation:  0.0011317729949951172
r_  generation:  0.012654542922973633
local_output_nid generation:  0.0006756782531738281
local_in_edges_tensor generation:  0.0010571479797363281
mini_batch_src_global generation:  0.0011544227600097656
r_  generation:  0.012428522109985352
----------------------check_connections_block total spend ----------------------------- 0.08408665657043457
generate_one_block  0.019574403762817383
generate_one_block  0.019627094268798828
generate_one_block  0.01635146141052246
generate_one_block  0.016383647918701172
----------===============-------------===============-------------the number of batches *****---- 4

original number of batches:  4
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007778167724609375  GigaBytes
Max Memory Allocated: 0.007778167724609375  GigaBytes

connection checking time:  0.14764904975891113
block generation total time  0.14427495002746582
average batch blocks generation time:  0.007213747501373291
block dataloader generation time/epoch 0.41689133644104004
pseudo mini batch 0 input nodes size: 14714
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007778167724609375  GigaBytes
Max Memory Allocated: 0.007778167724609375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007778167724609375  GigaBytes
Max Memory Allocated: 0.007778167724609375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0526123046875 GB
    Memory Allocated: 0.03518533706665039  GigaBytes
Max Memory Allocated: 0.03518533706665039  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0526123046875 GB
    Memory Allocated: 0.035185813903808594  GigaBytes
Max Memory Allocated: 0.035185813903808594  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0526123046875 GB
    Memory Allocated: 0.035185813903808594  GigaBytes
Max Memory Allocated: 0.035185813903808594  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.0357818603515625  GigaBytes
Max Memory Allocated: 0.0357818603515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.0357818603515625  GigaBytes
Max Memory Allocated: 0.0357818603515625  GigaBytes

first layer input nodes number: 14714
first layer output nodes number: 10147
edges number: 45677
----------------------------------------before model layer 0
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.035967350006103516  GigaBytes
Max Memory Allocated: 0.03613758087158203  GigaBytes

torch.Size([14714, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1190185546875 GB
    Memory Allocated: 0.035967350006103516  GigaBytes
Max Memory Allocated: 0.03613758087158203  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.0754084587097168  GigaBytes
Max Memory Allocated: 0.07544660568237305  GigaBytes

torch.Size([10147, 512])
torch.Size([10147, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.0949397087097168  GigaBytes
Max Memory Allocated: 0.1144709587097168  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.0754084587097168  GigaBytes
Max Memory Allocated: 0.1144709587097168  GigaBytes

torch.Size([10147, 512])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3768310546875 GB
    Memory Allocated: 0.0949397087097168  GigaBytes
Max Memory Allocated: 0.1144709587097168  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.0997781753540039  GigaBytes
Max Memory Allocated: 0.1193094253540039  GigaBytes

input nodes number: 10147
output nodes number: 3274
edges number: 27862
----------------------------------------before model layer 1
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.09987878799438477  GigaBytes
Max Memory Allocated: 0.1193094253540039  GigaBytes

torch.Size([10147, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3963623046875 GB
    Memory Allocated: 0.09987878799438477  GigaBytes
Max Memory Allocated: 0.1193094253540039  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.11260080337524414  GigaBytes
Max Memory Allocated: 0.1193094253540039  GigaBytes

torch.Size([3274, 512])
torch.Size([3274, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.11884546279907227  GigaBytes
Max Memory Allocated: 0.1250901222229004  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.11260080337524414  GigaBytes
Max Memory Allocated: 0.1250901222229004  GigaBytes

torch.Size([3274, 512])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.11884546279907227  GigaBytes
Max Memory Allocated: 0.1250901222229004  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.12073516845703125  GigaBytes
Max Memory Allocated: 0.12697982788085938  GigaBytes

input nodes number: 3274
output nodes number: 647
edges number: 5291
----------------------------------------before model layer 2
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.12076520919799805  GigaBytes
Max Memory Allocated: 0.12697982788085938  GigaBytes

torch.Size([3274, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.12076520919799805  GigaBytes
Max Memory Allocated: 0.12697982788085938  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.12424850463867188  GigaBytes
Max Memory Allocated: 0.12697982788085938  GigaBytes

torch.Size([647, 512])
torch.Size([647, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.12548255920410156  GigaBytes
Max Memory Allocated: 0.12697982788085938  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.12327909469604492  GigaBytes
Max Memory Allocated: 0.12697982788085938  GigaBytes

torch.Size([647, 512])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.12451314926147461  GigaBytes
Max Memory Allocated: 0.12697982788085938  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.12579107284545898  GigaBytes
Max Memory Allocated: 0.12702512741088867  GigaBytes

input nodes number: 647
output nodes number: 107
edges number: 806
----------------------------------------before model layer 3
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.12579727172851562  GigaBytes
Max Memory Allocated: 0.12702512741088867  GigaBytes

torch.Size([647, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.12579727172851562  GigaBytes
Max Memory Allocated: 0.12702512741088867  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.12621307373046875  GigaBytes
Max Memory Allocated: 0.12702512741088867  GigaBytes

torch.Size([107, 512])
torch.Size([107, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.1264171600341797  GigaBytes
Max Memory Allocated: 0.12702512741088867  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.12621307373046875  GigaBytes
Max Memory Allocated: 0.12702512741088867  GigaBytes

torch.Size([107, 512])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.1264171600341797  GigaBytes
Max Memory Allocated: 0.12702512741088867  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.12646818161010742  GigaBytes
Max Memory Allocated: 0.12702512741088867  GigaBytes

----------------input nodes number: 107
----------------output nodes number: 15
----------------edges number: 92
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.12646961212158203  GigaBytes
Max Memory Allocated: 0.12702512741088867  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.12650060653686523  GigaBytes
Max Memory Allocated: 0.12702512741088867  GigaBytes

torch.Size([15, 3])
torch.Size([15, 3])
----------------------------------------after rst
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.12650108337402344  GigaBytes
Max Memory Allocated: 0.12702512741088867  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.12650060653686523  GigaBytes
Max Memory Allocated: 0.12702512741088867  GigaBytes

torch.Size([15, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.12650108337402344  GigaBytes
Max Memory Allocated: 0.12702512741088867  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3983154296875 GB
    Memory Allocated: 0.12650251388549805  GigaBytes
Max Memory Allocated: 0.12702512741088867  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.0448451042175293  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

pseudo mini batch 1 input nodes size: 14825
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.04296541213989258  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.4471435546875 GB
    Memory Allocated: 0.04296541213989258  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.4764404296875 GB
    Memory Allocated: 0.07057952880859375  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.4764404296875 GB
    Memory Allocated: 0.07058000564575195  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.4764404296875 GB
    Memory Allocated: 0.043172359466552734  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4764404296875 GB
    Memory Allocated: 0.04375886917114258  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4764404296875 GB
    Memory Allocated: 0.04375886917114258  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

first layer input nodes number: 14825
first layer output nodes number: 10733
edges number: 44235
----------------------------------------before model layer 0
 Nvidia-smi: 1.4764404296875 GB
    Memory Allocated: 0.04394960403442383  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

torch.Size([14825, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4764404296875 GB
    Memory Allocated: 0.04394960403442383  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4998779296875 GB
    Memory Allocated: 0.08478307723999023  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

torch.Size([10733, 512])
torch.Size([10733, 512])
----------------------------------------after rst
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.1052546501159668  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.08478307723999023  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

torch.Size([10733, 512])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.1052546501159668  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.11037254333496094  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

input nodes number: 10733
output nodes number: 3287
edges number: 26594
----------------------------------------before model layer 1
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.11047744750976562  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

torch.Size([10733, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.11047744750976562  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.12323951721191406  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

torch.Size([3287, 512])
torch.Size([3287, 512])
----------------------------------------after rst
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.12950897216796875  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.12323951721191406  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

torch.Size([3287, 512])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.12950897216796875  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.13191461563110352  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

input nodes number: 3287
output nodes number: 842
edges number: 6513
----------------------------------------before model layer 2
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.13194608688354492  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

torch.Size([3287, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.13194608688354492  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.13570880889892578  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

torch.Size([842, 512])
torch.Size([842, 512])
----------------------------------------after rst
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.1373147964477539  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.13570880889892578  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

torch.Size([842, 512])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.1373147964477539  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.13771629333496094  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

input nodes number: 842
output nodes number: 101
edges number: 1116
----------------------------------------before model layer 3
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.1377239227294922  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

torch.Size([842, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.1377239227294922  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.13811874389648438  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

torch.Size([101, 512])
torch.Size([101, 512])
----------------------------------------after rst
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.13831138610839844  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.13811874389648438  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

torch.Size([101, 512])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.13831138610839844  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.13835954666137695  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------input nodes number: 101
----------------output nodes number: 15
----------------edges number: 88
----------------------------------------before mean aggregator
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.13836097717285156  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.13839197158813477  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

torch.Size([15, 3])
torch.Size([15, 3])
----------------------------------------after rst
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.13839244842529297  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.13839197158813477  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

torch.Size([15, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.13839197158813477  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5428466796875 GB
    Memory Allocated: 0.13839292526245117  GigaBytes
Max Memory Allocated: 0.1454324722290039  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.04505109786987305  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

pseudo mini batch 2 input nodes size: 12495
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.043172359466552734  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.043172359466552734  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.06644630432128906  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.06644678115844727  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.03883218765258789  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.03936338424682617  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.03936338424682617  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

first layer input nodes number: 12495
first layer output nodes number: 7971
edges number: 38426
----------------------------------------before model layer 0
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.039516448974609375  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([12495, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.039516448974609375  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.0698843002319336  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([7971, 512])
torch.Size([7971, 512])
----------------------------------------after rst
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.08508777618408203  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.0698843002319336  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([7971, 512])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.08508777618408203  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.0894155502319336  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

input nodes number: 7971
output nodes number: 2531
edges number: 25324
----------------------------------------before model layer 1
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.08949422836303711  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([7971, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.08949422836303711  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.09935712814331055  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([2531, 512])
torch.Size([2531, 512])
----------------------------------------after rst
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.10490560531616211  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.10007810592651367  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([2531, 512])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.10490560531616211  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.10611248016357422  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

input nodes number: 2531
output nodes number: 582
edges number: 6341
----------------------------------------before model layer 2
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.10613632202148438  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([2531, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.10613632202148438  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.10849428176879883  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([582, 512])
torch.Size([582, 512])
----------------------------------------after rst
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.1096043586730957  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.10840892791748047  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([582, 512])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.1096043586730957  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11069726943969727  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

input nodes number: 582
output nodes number: 77
edges number: 845
----------------------------------------before model layer 3
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.1107029914855957  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([582, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.1107029914855957  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11100435256958008  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([77, 512])
torch.Size([77, 512])
----------------------------------------after rst
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11115121841430664  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11100435256958008  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([77, 512])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11115121841430664  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11118793487548828  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------input nodes number: 77
----------------output nodes number: 15
----------------edges number: 63
----------------------------------------before mean aggregator
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11118936538696289  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.1112203598022461  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([15, 3])
torch.Size([15, 3])
----------------------------------------after rst
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.1112208366394043  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.1112203598022461  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([15, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.1112203598022461  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.1112213134765625  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.040486812591552734  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

pseudo mini batch 3 input nodes size: 12099
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.03883218765258789  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.03883218765258789  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.061368465423583984  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.06136894226074219  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.038094520568847656  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.0386505126953125  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.0386505126953125  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

first layer input nodes number: 12099
first layer output nodes number: 8335
edges number: 38299
----------------------------------------before model layer 0
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.0388035774230957  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([12099, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.0388035774230957  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.07054424285888672  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([8335, 512])
torch.Size([8335, 512])
----------------------------------------after rst
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.0864419937133789  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.07054424285888672  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([8335, 512])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.0864419937133789  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.09044790267944336  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

input nodes number: 8335
output nodes number: 2514
edges number: 27243
----------------------------------------before model layer 1
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.0905294418334961  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([8335, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.0905294418334961  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.100341796875  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([2514, 512])
torch.Size([2514, 512])
----------------------------------------after rst
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.10513687133789062  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.100341796875  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([2514, 512])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.10513687133789062  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.10668659210205078  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

input nodes number: 2514
output nodes number: 704
edges number: 7565
----------------------------------------before model layer 2
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.10671091079711914  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([2514, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.10671091079711914  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11040735244750977  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([704, 512])
torch.Size([704, 512])
----------------------------------------after rst
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11175012588500977  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.10945940017700195  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([704, 512])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11175012588500977  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11113786697387695  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

input nodes number: 704
output nodes number: 69
edges number: 1037
----------------------------------------before model layer 3
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.1111440658569336  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([704, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.1111440658569336  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11141681671142578  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([69, 512])
torch.Size([69, 512])
----------------------------------------after rst
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11154842376708984  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11141681671142578  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([69, 512])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11154842376708984  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11158132553100586  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------input nodes number: 69
----------------output nodes number: 15
----------------edges number: 54
----------------------------------------before mean aggregator
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11158275604248047  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11161375045776367  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([15, 3])
torch.Size([15, 3])
----------------------------------------after rst
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11161422729492188  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11161375045776367  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

torch.Size([15, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11161375045776367  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.11161470413208008  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.039832115173339844  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.055388450622558594  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.055388450622558594  GigaBytes
Max Memory Allocated: 0.15204763412475586  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.01607370376586914 |0.087618887424469 |0.21180462837219238 |0.00014930963516235352 |0.006889939308166504 |0.007111787796020508 |
----------------------------------------------------------pseudo_mini_loss sum 1.1212265491485596
Total (block generation + training)time/epoch 1.7294249534606934
Training time/epoch 1.3122997283935547
Training time without block to device /epoch 0.9618241786956787
Training time without total dataloading part /epoch 0.8824872970581055
load block tensor time/epoch 0.06429481506347656
block to device time/epoch 0.350475549697876
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 4.76837158203125e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  106054
Number of first layer input nodes during this epoch:  54133
Number of first layer output nodes during this epoch:  37186
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=500, out_features=512, bias=False)
      (fc_neigh): Linear(in_features=500, out_features=512, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=512, out_features=512, bias=False)
      (fc_neigh): Linear(in_features=512, out_features=512, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=512, out_features=512, bias=False)
      (fc_neigh): Linear(in_features=512, out_features=512, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=512, out_features=512, bias=False)
      (fc_neigh): Linear(in_features=512, out_features=512, bias=False)
    )
    (4): SAGEConv(
      (fc_self): Linear(in_features=512, out_features=3, bias=False)
      (fc_neigh): Linear(in_features=512, out_features=3, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  2087936
trainable parameters
layers.0.fc_self.weight, torch.Size([512, 500])
layers.0.fc_neigh.weight, torch.Size([512, 500])
layers.1.fc_self.weight, torch.Size([512, 512])
layers.1.fc_neigh.weight, torch.Size([512, 512])
layers.2.fc_self.weight, torch.Size([512, 512])
layers.2.fc_neigh.weight, torch.Size([512, 512])
layers.3.fc_self.weight, torch.Size([512, 512])
layers.3.fc_neigh.weight, torch.Size([512, 512])
layers.4.fc_self.weight, torch.Size([3, 512])
layers.4.fc_neigh.weight, torch.Size([3, 512])
----------------------------------------
un-trainable parameters
