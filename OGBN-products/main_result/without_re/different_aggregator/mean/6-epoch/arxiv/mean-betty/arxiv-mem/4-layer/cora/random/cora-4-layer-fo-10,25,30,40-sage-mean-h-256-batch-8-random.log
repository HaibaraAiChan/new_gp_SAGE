main start at this time 1657101314.8151379
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00372314453125  GigaBytes
Max Memory Allocated: 0.00372314453125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00372314453125  GigaBytes
Max Memory Allocated: 0.00372314453125  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0013513565063476562
number of batches is  8
batch size is  18
random selection method spend 0.0009725093841552734
time for parepare:  9.441375732421875e-05
local_output_nid generation:  3.24249267578125e-05
local_in_edges_tensor generation:  0.00036215782165527344
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  0.00414729118347168
local_output_nid generation:  1.0728836059570312e-05
local_in_edges_tensor generation:  0.00016570091247558594
mini_batch_src_global generation:  2.7179718017578125e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  8.344650268554688e-06
local_in_edges_tensor generation:  0.0001316070556640625
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  5.078315734863281e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  2.2411346435546875e-05
r_  generation:  4.673004150390625e-05
local_output_nid generation:  8.106231689453125e-06
local_in_edges_tensor generation:  0.0001304149627685547
mini_batch_src_global generation:  1.7404556274414062e-05
r_  generation:  3.4809112548828125e-05
local_output_nid generation:  7.867813110351562e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  1.811981201171875e-05
r_  generation:  8.678436279296875e-05
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001232624053955078
mini_batch_src_global generation:  1.9788742065429688e-05
r_  generation:  4.267692565917969e-05
local_output_nid generation:  6.4373016357421875e-06
local_in_edges_tensor generation:  0.00011944770812988281
mini_batch_src_global generation:  1.7881393432617188e-05
r_  generation:  4.9591064453125e-05
----------------------check_connections_block total spend ----------------------------- 0.006701469421386719
generate_one_block  0.0032265186309814453
generate_one_block  0.001312255859375
generate_one_block  0.0012927055358886719
generate_one_block  0.0012586116790771484
generate_one_block  0.001077413558959961
generate_one_block  0.0010745525360107422
generate_one_block  0.0010776519775390625
generate_one_block  0.0011146068572998047
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005359649658203125
gen group dst list time:  8.416175842285156e-05
time for parepare:  0.0002014636993408203
local_output_nid generation:  1.3113021850585938e-05
local_in_edges_tensor generation:  0.0002319812774658203
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0003027915954589844
local_output_nid generation:  1.0967254638671875e-05
local_in_edges_tensor generation:  0.00014901161193847656
mini_batch_src_global generation:  4.315376281738281e-05
r_  generation:  0.0002529621124267578
local_output_nid generation:  1.4781951904296875e-05
local_in_edges_tensor generation:  0.00014495849609375
mini_batch_src_global generation:  4.1484832763671875e-05
r_  generation:  0.0002944469451904297
local_output_nid generation:  1.2636184692382812e-05
local_in_edges_tensor generation:  0.0001430511474609375
mini_batch_src_global generation:  4.553794860839844e-05
r_  generation:  0.0003256797790527344
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.0001380443572998047
mini_batch_src_global generation:  3.695487976074219e-05
r_  generation:  0.00020122528076171875
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00014019012451171875
mini_batch_src_global generation:  3.838539123535156e-05
r_  generation:  0.0002675056457519531
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.0001404285430908203
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002675056457519531
local_output_nid generation:  1.2159347534179688e-05
local_in_edges_tensor generation:  0.00014162063598632812
mini_batch_src_global generation:  4.029273986816406e-05
r_  generation:  0.00028014183044433594
----------------------check_connections_block total spend ----------------------------- 0.004854679107666016
generate_one_block  0.0015840530395507812
generate_one_block  0.001501321792602539
generate_one_block  0.0015840530395507812
generate_one_block  0.0016026496887207031
generate_one_block  0.0014500617980957031
generate_one_block  0.0014874935150146484
generate_one_block  0.0012912750244140625
generate_one_block  0.0012133121490478516
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006921291351318359
gen group dst list time:  0.0001327991485595703
time for parepare:  0.00022220611572265625
local_output_nid generation:  4.00543212890625e-05
local_in_edges_tensor generation:  0.0002949237823486328
mini_batch_src_global generation:  8.654594421386719e-05
r_  generation:  0.0008630752563476562
local_output_nid generation:  4.792213439941406e-05
local_in_edges_tensor generation:  0.000213623046875
mini_batch_src_global generation:  0.00010466575622558594
r_  generation:  0.0008449554443359375
local_output_nid generation:  5.364418029785156e-05
local_in_edges_tensor generation:  0.0002124309539794922
mini_batch_src_global generation:  0.00010848045349121094
r_  generation:  0.0009860992431640625
local_output_nid generation:  5.5789947509765625e-05
local_in_edges_tensor generation:  0.00021219253540039062
mini_batch_src_global generation:  0.00011992454528808594
r_  generation:  0.0010600090026855469
local_output_nid generation:  3.743171691894531e-05
local_in_edges_tensor generation:  0.00019288063049316406
mini_batch_src_global generation:  9.608268737792969e-05
r_  generation:  0.0007505416870117188
local_output_nid generation:  4.8160552978515625e-05
local_in_edges_tensor generation:  0.00020241737365722656
mini_batch_src_global generation:  0.00010704994201660156
r_  generation:  0.0009446144104003906
local_output_nid generation:  4.506111145019531e-05
local_in_edges_tensor generation:  0.0001971721649169922
mini_batch_src_global generation:  0.00010561943054199219
r_  generation:  0.0009338855743408203
local_output_nid generation:  4.029273986816406e-05
local_in_edges_tensor generation:  0.0001938343048095703
mini_batch_src_global generation:  9.894371032714844e-05
r_  generation:  0.0008296966552734375
----------------------check_connections_block total spend ----------------------------- 0.012404203414916992
generate_one_block  0.002215862274169922
generate_one_block  0.0017197132110595703
generate_one_block  0.0018460750579833984
generate_one_block  0.0018677711486816406
generate_one_block  0.0017592906951904297
generate_one_block  0.0018601417541503906
generate_one_block  0.0017642974853515625
generate_one_block  0.0016829967498779297
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008056163787841797
gen group dst list time:  0.00024890899658203125
time for parepare:  0.00023627281188964844
local_output_nid generation:  9.417533874511719e-05
local_in_edges_tensor generation:  0.0004112720489501953
mini_batch_src_global generation:  0.00021600723266601562
r_  generation:  0.0018017292022705078
local_output_nid generation:  0.00010013580322265625
local_in_edges_tensor generation:  0.0002815723419189453
mini_batch_src_global generation:  0.00020647048950195312
r_  generation:  0.001528024673461914
local_output_nid generation:  9.584426879882812e-05
local_in_edges_tensor generation:  0.00025963783264160156
mini_batch_src_global generation:  0.00017762184143066406
r_  generation:  0.0018312931060791016
local_output_nid generation:  8.654594421386719e-05
local_in_edges_tensor generation:  0.0002460479736328125
mini_batch_src_global generation:  0.0001590251922607422
r_  generation:  0.0016732215881347656
local_output_nid generation:  7.605552673339844e-05
local_in_edges_tensor generation:  0.00022673606872558594
mini_batch_src_global generation:  0.00014352798461914062
r_  generation:  0.0014925003051757812
local_output_nid generation:  8.96453857421875e-05
local_in_edges_tensor generation:  0.00024771690368652344
mini_batch_src_global generation:  0.0001647472381591797
r_  generation:  0.0017180442810058594
local_output_nid generation:  8.463859558105469e-05
local_in_edges_tensor generation:  0.00024175643920898438
mini_batch_src_global generation:  0.0001652240753173828
r_  generation:  0.0016589164733886719
local_output_nid generation:  9.059906005859375e-05
local_in_edges_tensor generation:  0.00023102760314941406
mini_batch_src_global generation:  0.00014472007751464844
r_  generation:  0.0014426708221435547
----------------------check_connections_block total spend ----------------------------- 0.020936012268066406
generate_one_block  0.0026750564575195312
generate_one_block  0.0024564266204833984
generate_one_block  0.002850055694580078
generate_one_block  0.0027980804443359375
generate_one_block  0.002491474151611328
generate_one_block  0.0027549266815185547
generate_one_block  0.0026755332946777344
generate_one_block  0.0025510787963867188
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00372314453125  GigaBytes
Max Memory Allocated: 0.00372314453125  GigaBytes

connection checking time:  0.038194894790649414
block generation total time  0.047683000564575195
average batch blocks generation time:  0.005960375070571899
block dataloader generation time/epoch 0.11914420127868652
pseudo mini batch 0 input nodes size: 1622
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00372314453125  GigaBytes
Max Memory Allocated: 0.00372314453125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00372314453125  GigaBytes
Max Memory Allocated: 0.00372314453125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.012382030487060547  GigaBytes
Max Memory Allocated: 0.012382030487060547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.01238250732421875  GigaBytes
Max Memory Allocated: 0.01238250732421875  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.01238250732421875  GigaBytes
Max Memory Allocated: 0.01238250732421875  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.012437820434570312  GigaBytes
Max Memory Allocated: 0.012437820434570312  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.012437820434570312  GigaBytes
Max Memory Allocated: 0.012437820434570312  GigaBytes

first layer input nodes number: 1622
first layer output nodes number: 977
edges number: 4274
----------------------------------------before model layer 0
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.012457847595214844  GigaBytes
Max Memory Allocated: 0.01247406005859375  GigaBytes

torch.Size([1622, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.012457847595214844  GigaBytes
Max Memory Allocated: 0.01247406005859375  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01864147186279297  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

torch.Size([977, 256])
torch.Size([977, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.019573211669921875  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.01864147186279297  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

torch.Size([977, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.019573211669921875  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.019806385040283203  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

input nodes number: 977
output nodes number: 393
edges number: 2161
----------------------------------------before model layer 1
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.019817352294921875  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

torch.Size([977, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.019817352294921875  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02058696746826172  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

torch.Size([393, 256])
torch.Size([393, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.020961761474609375  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02058696746826172  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

torch.Size([393, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.020961761474609375  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02105569839477539  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

input nodes number: 393
output nodes number: 110
edges number: 686
----------------------------------------before model layer 2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02105998992919922  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

torch.Size([393, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02105998992919922  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021276473999023438  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

torch.Size([110, 256])
torch.Size([110, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021381378173828125  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021276473999023438  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

torch.Size([110, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021381378173828125  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021407604217529297  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

----------------input nodes number: 110
----------------output nodes number: 18
----------------edges number: 96
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021409034729003906  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021428585052490234  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021429061889648438  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021428585052490234  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

torch.Size([18, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021429061889648438  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021430492401123047  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01629018783569336  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

pseudo mini batch 1 input nodes size: 1536
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01610708236694336  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01610708236694336  GigaBytes
Max Memory Allocated: 0.02292919158935547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024306774139404297  GigaBytes
Max Memory Allocated: 0.024306774139404297  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0243072509765625  GigaBytes
Max Memory Allocated: 0.0243072509765625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01564788818359375  GigaBytes
Max Memory Allocated: 0.0243072509765625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015700340270996094  GigaBytes
Max Memory Allocated: 0.0243072509765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015700340270996094  GigaBytes
Max Memory Allocated: 0.0243072509765625  GigaBytes

first layer input nodes number: 1536
first layer output nodes number: 913
edges number: 4188
----------------------------------------before model layer 0
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015718936920166016  GigaBytes
Max Memory Allocated: 0.0243072509765625  GigaBytes

torch.Size([1536, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015718936920166016  GigaBytes
Max Memory Allocated: 0.0243072509765625  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021499156951904297  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

torch.Size([913, 256])
torch.Size([913, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022369861602783203  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.021499156951904297  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

torch.Size([913, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022369861602783203  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02258777618408203  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

input nodes number: 913
output nodes number: 381
edges number: 2042
----------------------------------------before model layer 1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022597789764404297  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

torch.Size([913, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022597789764404297  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023342609405517578  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

torch.Size([381, 256])
torch.Size([381, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02370595932006836  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023342609405517578  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

torch.Size([381, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02370595932006836  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023797035217285156  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

input nodes number: 381
output nodes number: 79
edges number: 584
----------------------------------------before model layer 2
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02380084991455078  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

torch.Size([381, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02380084991455078  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023957252502441406  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

torch.Size([79, 256])
torch.Size([79, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0240325927734375  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023957252502441406  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

torch.Size([79, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.0240325927734375  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024051666259765625  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

----------------input nodes number: 79
----------------output nodes number: 18
----------------edges number: 63
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024053096771240234  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024072647094726562  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024073123931884766  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024072647094726562  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

torch.Size([18, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024072647094726562  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02407360076904297  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015819549560546875  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

pseudo mini batch 2 input nodes size: 1887
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01564788818359375  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01564788818359375  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02572154998779297  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.025722026824951172  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01752185821533203  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017586708068847656  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017586708068847656  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

first layer input nodes number: 1887
first layer output nodes number: 1196
edges number: 5235
----------------------------------------before model layer 0
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01761007308959961  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

torch.Size([1887, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01761007308959961  GigaBytes
Max Memory Allocated: 0.026038169860839844  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025296688079833984  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([1196, 256])
torch.Size([1196, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02643728256225586  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025179386138916016  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([1196, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02643728256225586  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02660512924194336  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

input nodes number: 1196
output nodes number: 457
edges number: 2433
----------------------------------------before model layer 1
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.026618003845214844  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([1196, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.026618003845214844  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.027512550354003906  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([457, 256])
torch.Size([457, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.027948379516601562  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.027512550354003906  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([457, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.027948379516601562  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.028057575225830078  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

input nodes number: 457
output nodes number: 110
edges number: 686
----------------------------------------before model layer 2
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02806234359741211  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([457, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02806234359741211  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.028278827667236328  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([110, 256])
torch.Size([110, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.028383731842041016  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.028278827667236328  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([110, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.028383731842041016  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.028409957885742188  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------input nodes number: 110
----------------output nodes number: 18
----------------edges number: 97
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.028411388397216797  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.028430938720703125  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.028431415557861328  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.028430938720703125  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([18, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.028430938720703125  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02843189239501953  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.017734527587890625  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

pseudo mini batch 3 input nodes size: 1673
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.01752185821533203  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.01752185821533203  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026453018188476562  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026453495025634766  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.016379356384277344  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.016442298889160156  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.016442298889160156  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

first layer input nodes number: 1673
first layer output nodes number: 1077
edges number: 4720
----------------------------------------before model layer 0
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.016463279724121094  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([1673, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.016463279724121094  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.023279666900634766  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([1077, 256])
torch.Size([1077, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.024306774139404297  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.023279666900634766  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([1077, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02504873275756836  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02456378936767578  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

input nodes number: 1077
output nodes number: 487
edges number: 2564
----------------------------------------before model layer 1
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02457571029663086  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([1077, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02457571029663086  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.025528430938720703  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([487, 256])
torch.Size([487, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.025992870330810547  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.025528430938720703  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([487, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.025992870330810547  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02610921859741211  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

input nodes number: 487
output nodes number: 101
edges number: 783
----------------------------------------before model layer 2
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02611398696899414  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([487, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02611398696899414  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026314258575439453  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([101, 256])
torch.Size([101, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026410579681396484  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026314258575439453  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([101, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026410579681396484  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026434898376464844  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------input nodes number: 101
----------------output nodes number: 18
----------------edges number: 84
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026436328887939453  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02645587921142578  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026456356048583984  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02645587921142578  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([18, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02645587921142578  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026456832885742188  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.016585826873779297  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

pseudo mini batch 4 input nodes size: 1620
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.016379356384277344  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.016379356384277344  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02503824234008789  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.025038719177246094  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.01610708236694336  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.016158580780029297  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.016158580780029297  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

first layer input nodes number: 1620
first layer output nodes number: 927
edges number: 4231
----------------------------------------before model layer 0
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.016178131103515625  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([1620, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.016178131103515625  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02204751968383789  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([927, 256])
torch.Size([927, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.022931575775146484  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02204751968383789  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([927, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.022931575775146484  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.023152828216552734  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

input nodes number: 927
output nodes number: 322
edges number: 1830
----------------------------------------before model layer 1
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.023162841796875  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([927, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.023162841796875  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.023794174194335938  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([322, 256])
torch.Size([322, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02410125732421875  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.023794174194335938  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([322, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02410125732421875  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.024178028106689453  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

input nodes number: 322
output nodes number: 69
edges number: 446
----------------------------------------before model layer 2
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.024181842803955078  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([322, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.024181842803955078  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.024318218231201172  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([69, 256])
torch.Size([69, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.024384021759033203  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.024318218231201172  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([69, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.024384021759033203  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.024400711059570312  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------input nodes number: 69
----------------output nodes number: 18
----------------edges number: 52
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.024402141571044922  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02442169189453125  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.024422168731689453  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02442169189453125  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([18, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02442169189453125  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.024422645568847656  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.016275882720947266  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

pseudo mini batch 5 input nodes size: 1795
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.01610708236694336  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.01610708236694336  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02568960189819336  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.025690078735351562  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.017030715942382812  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.017091751098632812  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.017091751098632812  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

first layer input nodes number: 1795
first layer output nodes number: 1123
edges number: 4934
----------------------------------------before model layer 0
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.01711416244506836  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([1795, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.01711416244506836  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02422189712524414  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([1123, 256])
torch.Size([1123, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026033401489257812  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.024962425231933594  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([1123, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026033401489257812  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02630138397216797  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

input nodes number: 1123
output nodes number: 425
edges number: 2360
----------------------------------------before model layer 1
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026313304901123047  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([1123, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026313304901123047  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027145862579345703  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([425, 256])
torch.Size([425, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02755117416381836  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027145862579345703  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([425, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02755117416381836  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027652740478515625  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

input nodes number: 425
output nodes number: 92
edges number: 605
----------------------------------------before model layer 2
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027657032012939453  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([425, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027657032012939453  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02783823013305664  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([92, 256])
torch.Size([92, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027925968170166016  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02783823013305664  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([92, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027925968170166016  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02794790267944336  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------input nodes number: 92
----------------output nodes number: 18
----------------edges number: 80
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02794933319091797  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027968883514404297  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.0279693603515625  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027968883514404297  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([18, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027968883514404297  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027969837188720703  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.017230510711669922  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

pseudo mini batch 6 input nodes size: 1718
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.017030715942382812  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.017030715942382812  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026979446411132812  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026979923248291016  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.017396926879882812  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.0174560546875  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.0174560546875  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

first layer input nodes number: 1718
first layer output nodes number: 1066
edges number: 4783
----------------------------------------before model layer 0
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.017477035522460938  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([1718, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.017477035522460938  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.024225234985351562  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([1066, 256])
torch.Size([1066, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02608346939086914  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.025066852569580078  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([1066, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02608346939086914  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026337623596191406  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

input nodes number: 1066
output nodes number: 395
edges number: 2220
----------------------------------------before model layer 1
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02634906768798828  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([1066, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02634906768798828  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027123451232910156  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([395, 256])
torch.Size([395, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027500152587890625  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027123451232910156  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([395, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027500152587890625  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027594566345214844  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

input nodes number: 395
output nodes number: 97
edges number: 592
----------------------------------------before model layer 2
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027598857879638672  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([395, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027598857879638672  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027789592742919922  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([97, 256])
torch.Size([97, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027882099151611328  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027789592742919922  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([97, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027882099151611328  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02790546417236328  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------input nodes number: 97
----------------output nodes number: 18
----------------edges number: 80
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02790689468383789  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02792644500732422  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027926921844482422  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02792644500732422  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([18, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02792644500732422  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.027927398681640625  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.017590045928955078  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

pseudo mini batch 7 input nodes size: 1670
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.017396926879882812  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.017396926879882812  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026979446411132812  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026979923248291016  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.017030715942382812  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.01708507537841797  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.01708507537841797  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

first layer input nodes number: 1670
first layer output nodes number: 1003
edges number: 4429
----------------------------------------before model layer 0
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.017105579376220703  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([1670, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.017105579376220703  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.023453712463378906  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([1003, 256])
torch.Size([1003, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.024410247802734375  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.023453712463378906  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([1003, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.024410247802734375  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.024649620056152344  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

input nodes number: 1003
output nodes number: 357
edges number: 2029
----------------------------------------before model layer 1
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.024660110473632812  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([1003, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.024660110473632812  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.025359153747558594  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([357, 256])
torch.Size([357, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.025699615478515625  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.025359153747558594  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([357, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.025699615478515625  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.025784969329833984  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

input nodes number: 357
output nodes number: 100
edges number: 606
----------------------------------------before model layer 2
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02578878402709961  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([357, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02578878402709961  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.025985240936279297  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([100, 256])
torch.Size([100, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026080608367919922  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.025985240936279297  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([100, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026080608367919922  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026104450225830078  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------input nodes number: 100
----------------output nodes number: 14
----------------edges number: 86
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026105880737304688  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02612161636352539  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([14, 7])
torch.Size([14, 7])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026122093200683594  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02612161636352539  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

torch.Size([14, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.02612161636352539  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.026122570037841797  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.017208576202392578  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.024654865264892578  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.024654865264892578  GigaBytes
Max Memory Allocated: 0.030428409576416016  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.00401073694229126 |0.04324445128440857 |0.11055001616477966 |0.00015309453010559082 |0.0035060346126556396 |0.001973867416381836 |
----------------------------------------------------------pseudo_mini_loss sum 1.952298879623413
Total (block generation + training)time/epoch 1.4328124523162842
Training time/epoch 1.3134493827819824
Training time without block to device /epoch 0.9674937725067139
Training time without total dataloading part /epoch 0.915647029876709
load block tensor time/epoch 0.03208589553833008
block to device time/epoch 0.34595561027526855
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  25778
Number of first layer input nodes during this epoch:  13521
Number of first layer output nodes during this epoch:  8282
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=1433, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  999424
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 1433])
layers.0.fc_neigh.weight, torch.Size([256, 1433])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([7, 256])
layers.3.fc_neigh.weight, torch.Size([7, 256])
----------------------------------------
un-trainable parameters
