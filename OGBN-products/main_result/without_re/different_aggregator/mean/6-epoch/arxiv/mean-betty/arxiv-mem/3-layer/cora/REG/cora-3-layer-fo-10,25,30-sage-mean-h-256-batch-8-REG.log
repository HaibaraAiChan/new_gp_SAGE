main start at this time 1657074043.7003415
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00323486328125  GigaBytes
Max Memory Allocated: 0.00323486328125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00323486328125  GigaBytes
Max Memory Allocated: 0.00323486328125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0012023448944091797
global_2_local spend time (sec) 0.00012421607971191406
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0006399154663085938
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 497, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 9: 4, 7: 4, 10: 3, 8: 3, 12: 2, 30: 2, 19: 1, 21: 1, 11: 1})

A = g.adjacency_matrix() spent  0.0004184246063232422
auxiliary_graph
Graph(num_nodes=637, num_edges=436,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0007605552673339844
remove nodes length  497

auxiliary_graph.remove_nodes spent  0.0019097328186035156
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=436,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0009918212890625

the counter of shared neighbor distribution
Counter({1.0: 250, 2.0: 30, 3.0: 14, 4.0: 2})
296
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.0029120445251464844
18
18
17
18
18
18
16
17
total k batches seeds list generation spend  0.01343226432800293
after graph partition
graph partition algorithm spend time 0.0500941276550293
18
18
17
18
18
18
16
17
partition_len_list
[86, 107, 49, 82, 102, 118, 65, 59]
REG selection method  spend 0.05051612854003906
time for parepare:  0.00013494491577148438
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00023412704467773438
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.000110626220703125
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00022459030151367188
mini_batch_src_global generation:  4.0531158447265625e-05
r_  generation:  0.00010013580322265625
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0002186298370361328
mini_batch_src_global generation:  3.552436828613281e-05
r_  generation:  6.985664367675781e-05
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.0002162456512451172
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  7.891654968261719e-05
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00021529197692871094
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  0.00011467933654785156
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0002143383026123047
mini_batch_src_global generation:  3.743171691894531e-05
r_  generation:  9.679794311523438e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0002129077911376953
mini_batch_src_global generation:  4.4345855712890625e-05
r_  generation:  6.842613220214844e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.000213623046875
mini_batch_src_global generation:  3.2901763916015625e-05
r_  generation:  5.7220458984375e-05
----------------------check_connections_block total spend ----------------------------- 0.003734111785888672
generate_one_block  0.0037431716918945312
generate_one_block  0.0015099048614501953
generate_one_block  0.0014095306396484375
generate_one_block  0.0014340877532958984
generate_one_block  0.0015101432800292969
generate_one_block  0.0013306140899658203
generate_one_block  0.001043558120727539
generate_one_block  0.0010221004486083984
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006177425384521484
gen group dst list time:  6.842613220214844e-05
time for parepare:  0.00015091896057128906
local_output_nid generation:  9.059906005859375e-06
local_in_edges_tensor generation:  0.00018334388732910156
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00020122528076171875
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00012826919555664062
mini_batch_src_global generation:  3.933906555175781e-05
r_  generation:  0.0002524852752685547
local_output_nid generation:  6.198883056640625e-06
local_in_edges_tensor generation:  0.00011706352233886719
mini_batch_src_global generation:  2.9802322387695312e-05
r_  generation:  0.00012063980102539062
local_output_nid generation:  1.0013580322265625e-05
local_in_edges_tensor generation:  0.00012040138244628906
mini_batch_src_global generation:  3.147125244140625e-05
r_  generation:  0.00018477439880371094
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012087821960449219
mini_batch_src_global generation:  3.3855438232421875e-05
r_  generation:  0.00021529197692871094
local_output_nid generation:  1.1682510375976562e-05
local_in_edges_tensor generation:  0.0001227855682373047
mini_batch_src_global generation:  3.647804260253906e-05
r_  generation:  0.0002429485321044922
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.0001163482666015625
mini_batch_src_global generation:  2.86102294921875e-05
r_  generation:  0.00012040138244628906
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011277198791503906
mini_batch_src_global generation:  2.5033950805664062e-05
r_  generation:  0.00011444091796875
----------------------check_connections_block total spend ----------------------------- 0.003573894500732422
generate_one_block  0.0013005733489990234
generate_one_block  0.0013074874877929688
generate_one_block  0.0011451244354248047
generate_one_block  0.0012960433959960938
generate_one_block  0.00125885009765625
generate_one_block  0.0013053417205810547
generate_one_block  0.0011446475982666016
generate_one_block  0.0011279582977294922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007042884826660156
gen group dst list time:  8.702278137207031e-05
time for parepare:  0.00018453598022460938
local_output_nid generation:  2.6464462280273438e-05
local_in_edges_tensor generation:  0.00022649765014648438
mini_batch_src_global generation:  5.745887756347656e-05
r_  generation:  0.0005621910095214844
local_output_nid generation:  3.4332275390625e-05
local_in_edges_tensor generation:  0.0001652240753173828
mini_batch_src_global generation:  7.462501525878906e-05
r_  generation:  0.0006265640258789062
local_output_nid generation:  1.9311904907226562e-05
local_in_edges_tensor generation:  0.00014090538024902344
mini_batch_src_global generation:  5.316734313964844e-05
r_  generation:  0.0003235340118408203
local_output_nid generation:  2.5510787963867188e-05
local_in_edges_tensor generation:  0.0001595020294189453
mini_batch_src_global generation:  5.841255187988281e-05
r_  generation:  0.00048160552978515625
local_output_nid generation:  2.193450927734375e-05
local_in_edges_tensor generation:  0.00014638900756835938
mini_batch_src_global generation:  5.793571472167969e-05
r_  generation:  0.0004513263702392578
local_output_nid generation:  3.2901763916015625e-05
local_in_edges_tensor generation:  0.00016021728515625
mini_batch_src_global generation:  6.794929504394531e-05
r_  generation:  0.0006544589996337891
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00013589859008789062
mini_batch_src_global generation:  4.863739013671875e-05
r_  generation:  0.00027108192443847656
local_output_nid generation:  1.7404556274414062e-05
local_in_edges_tensor generation:  0.00013399124145507812
mini_batch_src_global generation:  4.076957702636719e-05
r_  generation:  0.00028443336486816406
----------------------check_connections_block total spend ----------------------------- 0.006990909576416016
generate_one_block  0.0016922950744628906
generate_one_block  0.0017426013946533203
generate_one_block  0.001474618911743164
generate_one_block  0.0015916824340820312
generate_one_block  0.0015087127685546875
generate_one_block  0.001649618148803711
generate_one_block  0.0012526512145996094
generate_one_block  0.0012221336364746094
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00323486328125  GigaBytes
Max Memory Allocated: 0.00323486328125  GigaBytes

connection checking time:  0.01429891586303711
block generation total time  0.03502345085144043
average batch blocks generation time:  0.0014593104521433513
block dataloader generation time/epoch 0.11012554168701172
pseudo mini batch 0 input nodes size: 752
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00323486328125  GigaBytes
Max Memory Allocated: 0.00323486328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00323486328125  GigaBytes
Max Memory Allocated: 0.00323486328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.007249355316162109  GigaBytes
Max Memory Allocated: 0.007249355316162109  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0072498321533203125  GigaBytes
Max Memory Allocated: 0.0072498321533203125  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.0072498321533203125  GigaBytes
Max Memory Allocated: 0.0072498321533203125  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.007267951965332031  GigaBytes
Max Memory Allocated: 0.007267951965332031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.007267951965332031  GigaBytes
Max Memory Allocated: 0.007267951965332031  GigaBytes

first layer input nodes number: 752
first layer output nodes number: 341
edges number: 1539
----------------------------------------before model layer 0
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0072765350341796875  GigaBytes
Max Memory Allocated: 0.007282733917236328  GigaBytes

torch.Size([752, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0072765350341796875  GigaBytes
Max Memory Allocated: 0.007282733917236328  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00943613052368164  GigaBytes
Max Memory Allocated: 0.01093292236328125  GigaBytes

torch.Size([341, 256])
torch.Size([341, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009761333465576172  GigaBytes
Max Memory Allocated: 0.01093292236328125  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.00943613052368164  GigaBytes
Max Memory Allocated: 0.01093292236328125  GigaBytes

torch.Size([341, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009761333465576172  GigaBytes
Max Memory Allocated: 0.01093292236328125  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009842872619628906  GigaBytes
Max Memory Allocated: 0.01093292236328125  GigaBytes

input nodes number: 341
output nodes number: 86
edges number: 544
----------------------------------------before model layer 1
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009846687316894531  GigaBytes
Max Memory Allocated: 0.01093292236328125  GigaBytes

torch.Size([341, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.009846687316894531  GigaBytes
Max Memory Allocated: 0.01093292236328125  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010016441345214844  GigaBytes
Max Memory Allocated: 0.01093292236328125  GigaBytes

torch.Size([86, 256])
torch.Size([86, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010098457336425781  GigaBytes
Max Memory Allocated: 0.01093292236328125  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010016441345214844  GigaBytes
Max Memory Allocated: 0.01093292236328125  GigaBytes

torch.Size([86, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010098457336425781  GigaBytes
Max Memory Allocated: 0.01093292236328125  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010118961334228516  GigaBytes
Max Memory Allocated: 0.01093292236328125  GigaBytes

----------------input nodes number: 86
----------------output nodes number: 18
----------------edges number: 87
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010120391845703125  GigaBytes
Max Memory Allocated: 0.01093292236328125  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010139942169189453  GigaBytes
Max Memory Allocated: 0.01093292236328125  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010140419006347656  GigaBytes
Max Memory Allocated: 0.01093292236328125  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010139942169189453  GigaBytes
Max Memory Allocated: 0.01093292236328125  GigaBytes

torch.Size([18, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010140419006347656  GigaBytes
Max Memory Allocated: 0.01093292236328125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.010141849517822266  GigaBytes
Max Memory Allocated: 0.01093292236328125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.01100015640258789  GigaBytes
Max Memory Allocated: 0.013145923614501953  GigaBytes

pseudo mini batch 1 input nodes size: 780
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010940074920654297  GigaBytes
Max Memory Allocated: 0.013145923614501953  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.010940074920654297  GigaBytes
Max Memory Allocated: 0.013145923614501953  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.015104293823242188  GigaBytes
Max Memory Allocated: 0.015104293823242188  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.01510477066040039  GigaBytes
Max Memory Allocated: 0.01510477066040039  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011089801788330078  GigaBytes
Max Memory Allocated: 0.01510477066040039  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.01110982894897461  GigaBytes
Max Memory Allocated: 0.01510477066040039  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.01110982894897461  GigaBytes
Max Memory Allocated: 0.01510477066040039  GigaBytes

first layer input nodes number: 780
first layer output nodes number: 372
edges number: 1727
----------------------------------------before model layer 0
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011118888854980469  GigaBytes
Max Memory Allocated: 0.01510477066040039  GigaBytes

torch.Size([780, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.011118888854980469  GigaBytes
Max Memory Allocated: 0.01510477066040039  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013474464416503906  GigaBytes
Max Memory Allocated: 0.015107154846191406  GigaBytes

torch.Size([372, 256])
torch.Size([372, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013829231262207031  GigaBytes
Max Memory Allocated: 0.015107154846191406  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013474464416503906  GigaBytes
Max Memory Allocated: 0.015107154846191406  GigaBytes

torch.Size([372, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013829231262207031  GigaBytes
Max Memory Allocated: 0.015107154846191406  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013917922973632812  GigaBytes
Max Memory Allocated: 0.015107154846191406  GigaBytes

input nodes number: 372
output nodes number: 107
edges number: 677
----------------------------------------before model layer 1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013921737670898438  GigaBytes
Max Memory Allocated: 0.015107154846191406  GigaBytes

torch.Size([372, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013921737670898438  GigaBytes
Max Memory Allocated: 0.015107154846191406  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014132499694824219  GigaBytes
Max Memory Allocated: 0.015107154846191406  GigaBytes

torch.Size([107, 256])
torch.Size([107, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014234542846679688  GigaBytes
Max Memory Allocated: 0.015107154846191406  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014132499694824219  GigaBytes
Max Memory Allocated: 0.015107154846191406  GigaBytes

torch.Size([107, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014234542846679688  GigaBytes
Max Memory Allocated: 0.015107154846191406  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014260292053222656  GigaBytes
Max Memory Allocated: 0.015107154846191406  GigaBytes

----------------input nodes number: 107
----------------output nodes number: 18
----------------edges number: 104
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014261722564697266  GigaBytes
Max Memory Allocated: 0.015107154846191406  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014281272888183594  GigaBytes
Max Memory Allocated: 0.015107154846191406  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014281749725341797  GigaBytes
Max Memory Allocated: 0.015107154846191406  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014281272888183594  GigaBytes
Max Memory Allocated: 0.015107154846191406  GigaBytes

torch.Size([18, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014281272888183594  GigaBytes
Max Memory Allocated: 0.015107154846191406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0142822265625  GigaBytes
Max Memory Allocated: 0.015107154846191406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011155128479003906  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

pseudo mini batch 2 input nodes size: 499
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011089801788330078  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011089801788330078  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014701366424560547  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01470184326171875  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010537147521972656  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010547637939453125  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010547637939453125  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

first layer input nodes number: 499
first layer output nodes number: 190
edges number: 854
----------------------------------------before model layer 0
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01055288314819336  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([499, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01055288314819336  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011756420135498047  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([190, 256])
torch.Size([190, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011937618255615234  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011756420135498047  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([190, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011937618255615234  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011982917785644531  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

input nodes number: 190
output nodes number: 49
edges number: 284
----------------------------------------before model layer 1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011984825134277344  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([190, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011984825134277344  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012082099914550781  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([49, 256])
torch.Size([49, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012128829956054688  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012082099914550781  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([49, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012128829956054688  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012140750885009766  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------input nodes number: 49
----------------output nodes number: 17
----------------edges number: 50
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012141704559326172  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012160301208496094  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([17, 7])
torch.Size([17, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012160778045654297  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012160301208496094  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([17, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012160301208496094  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0121612548828125  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010573387145996094  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

pseudo mini batch 3 input nodes size: 707
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010537147521972656  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010537147521972656  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014551639556884766  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014552116394042969  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010940074920654297  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010955333709716797  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010955333709716797  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

first layer input nodes number: 707
first layer output nodes number: 293
edges number: 1326
----------------------------------------before model layer 0
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01096343994140625  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([707, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01096343994140625  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012819290161132812  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([293, 256])
torch.Size([293, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013098716735839844  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012819290161132812  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([293, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013098716735839844  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013168811798095703  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

input nodes number: 293
output nodes number: 82
edges number: 491
----------------------------------------before model layer 1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013172149658203125  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([293, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013172149658203125  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013333320617675781  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([82, 256])
torch.Size([82, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013411521911621094  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013333320617675781  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([82, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013411521911621094  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013431072235107422  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------input nodes number: 82
----------------output nodes number: 18
----------------edges number: 70
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013432502746582031  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01345205307006836  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013452529907226562  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01345205307006836  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([18, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01345205307006836  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013453006744384766  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01099252700805664  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

pseudo mini batch 4 input nodes size: 562
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010940074920654297  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010940074920654297  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01394033432006836  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013940811157226562  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00992584228515625  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00994110107421875  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00994110107421875  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

first layer input nodes number: 562
first layer output nodes number: 249
edges number: 1229
----------------------------------------before model layer 0
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00994729995727539  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([562, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00994729995727539  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011524677276611328  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([249, 256])
torch.Size([249, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011762142181396484  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011524677276611328  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([249, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011762142181396484  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011821746826171875  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

input nodes number: 249
output nodes number: 102
edges number: 586
----------------------------------------before model layer 1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011824607849121094  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([249, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011824607849121094  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012024879455566406  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([102, 256])
torch.Size([102, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012122154235839844  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012024879455566406  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([102, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012122154235839844  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012146472930908203  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------input nodes number: 102
----------------output nodes number: 18
----------------edges number: 117
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012147903442382812  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01216745376586914  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012167930603027344  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01216745376586914  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([18, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01216745376586914  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.012168407440185547  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009975910186767578  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

pseudo mini batch 5 input nodes size: 885
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00992584228515625  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00992584228515625  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014701366424560547  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01470184326171875  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011701107025146484  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011721134185791016  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011721134185791016  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

first layer input nodes number: 885
first layer output nodes number: 393
edges number: 1803
----------------------------------------before model layer 0
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011731147766113281  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

torch.Size([885, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011731147766113281  GigaBytes
Max Memory Allocated: 0.015316963195800781  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014220237731933594  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([393, 256])
torch.Size([393, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01459503173828125  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014220237731933594  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([393, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01459503173828125  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014688968658447266  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

input nodes number: 393
output nodes number: 118
edges number: 639
----------------------------------------before model layer 1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014693260192871094  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([393, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014693260192871094  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014924049377441406  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([118, 256])
torch.Size([118, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.015036582946777344  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.014924049377441406  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([118, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.015036582946777344  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.015064716339111328  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------input nodes number: 118
----------------output nodes number: 18
----------------edges number: 104
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.015066146850585938  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.015085697174072266  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([18, 7])
torch.Size([18, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.015086174011230469  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.015085697174072266  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([18, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.015085697174072266  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.015086650848388672  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011767864227294922  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

pseudo mini batch 6 input nodes size: 350
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011701107025146484  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011701107025146484  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013569831848144531  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.013570308685302734  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008794307708740234  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00880289077758789  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00880289077758789  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

first layer input nodes number: 350
first layer output nodes number: 141
edges number: 654
----------------------------------------before model layer 0
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008807182312011719  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([350, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008807182312011719  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009701251983642578  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([141, 256])
torch.Size([141, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00983572006225586  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009701251983642578  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([141, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00983572006225586  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009869575500488281  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

input nodes number: 141
output nodes number: 65
edges number: 256
----------------------------------------before model layer 1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009871959686279297  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([141, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009871959686279297  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009998798370361328  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([65, 256])
torch.Size([65, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010060787200927734  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009998798370361328  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([65, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010060787200927734  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010076522827148438  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------input nodes number: 65
----------------output nodes number: 16
----------------edges number: 54
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010077953338623047  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010095596313476562  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([16, 7])
torch.Size([16, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010096073150634766  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010095596313476562  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([16, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010095596313476562  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010096549987792969  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.00882577896118164  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

pseudo mini batch 7 input nodes size: 431
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008794307708740234  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.008794307708740234  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011095523834228516  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.011096000671386719  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009226799011230469  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009235382080078125  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009235382080078125  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

first layer input nodes number: 431
first layer output nodes number: 173
edges number: 730
----------------------------------------before model layer 0
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009240150451660156  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([431, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009240150451660156  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010335445404052734  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([173, 256])
torch.Size([173, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010500431060791016  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010335445404052734  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([173, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010500431060791016  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010541915893554688  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

input nodes number: 173
output nodes number: 59
edges number: 249
----------------------------------------before model layer 1
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0105438232421875  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([173, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.0105438232421875  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010659217834472656  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([59, 256])
torch.Size([59, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010715484619140625  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010659217834472656  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([59, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010715484619140625  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010729789733886719  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------input nodes number: 59
----------------output nodes number: 17
----------------edges number: 44
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010730743408203125  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010749340057373047  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([17, 7])
torch.Size([17, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01074981689453125  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010749340057373047  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

torch.Size([17, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010749340057373047  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.010750293731689453  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.009257793426513672  GigaBytes
Max Memory Allocated: 0.016847610473632812  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01652812957763672  GigaBytes
Max Memory Allocated: 0.021570682525634766  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.01652812957763672  GigaBytes
Max Memory Allocated: 0.021570682525634766  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0032556354999542236 |0.04376921057701111 |0.10664138197898865 |0.00013813376426696777 |0.002559453248977661 |0.0014538764953613281 |
----------------------------------------------------------pseudo_mini_loss sum 1.9474180936813354
Total (block generation + training)time/epoch 1.3844497203826904
Training time/epoch 1.2739129066467285
Training time without block to device /epoch 0.9237592220306396
Training time without total dataloading part /epoch 0.8761656284332275
load block tensor time/epoch 0.02604508399963379
block to device time/epoch 0.35015368461608887
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7786
Number of first layer input nodes during this epoch:  4966
Number of first layer output nodes during this epoch:  2152
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=1433, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  868352
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 1433])
layers.0.fc_neigh.weight, torch.Size([256, 1433])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([7, 256])
layers.2.fc_neigh.weight, torch.Size([7, 256])
----------------------------------------
un-trainable parameters
