main start at this time 1657105157.2402446
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  500
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007778167724609375  GigaBytes
Max Memory Allocated: 0.007778167724609375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007778167724609375  GigaBytes
Max Memory Allocated: 0.007778167724609375  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0013175010681152344
number of batches is  2
batch size is  30
random selection method spend 0.0005512237548828125
time for parepare:  5.3882598876953125e-05
local_output_nid generation:  3.075599670410156e-05
local_in_edges_tensor generation:  0.00023436546325683594
mini_batch_src_global generation:  3.170967102050781e-05
r_  generation:  0.0019075870513916016
local_output_nid generation:  1.4543533325195312e-05
local_in_edges_tensor generation:  0.00016617774963378906
mini_batch_src_global generation:  2.956390380859375e-05
r_  generation:  6.651878356933594e-05
----------------------check_connections_block total spend ----------------------------- 0.0027170181274414062
generate_one_block  0.004141092300415039
generate_one_block  0.0013937950134277344
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0009100437164306641
gen group dst list time:  2.9325485229492188e-05
time for parepare:  0.00029850006103515625
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.0002429485321044922
mini_batch_src_global generation:  9.655952453613281e-05
r_  generation:  0.0009436607360839844
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00017333030700683594
mini_batch_src_global generation:  9.608268737792969e-05
r_  generation:  0.0005800724029541016
----------------------check_connections_block total spend ----------------------------- 0.002873659133911133
generate_one_block  0.002586841583251953
generate_one_block  0.0020046234130859375
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0011768341064453125
gen group dst list time:  7.82012939453125e-05
time for parepare:  0.0008420944213867188
local_output_nid generation:  0.00015926361083984375
local_in_edges_tensor generation:  0.0006783008575439453
mini_batch_src_global generation:  0.00048160552978515625
r_  generation:  0.006078481674194336
local_output_nid generation:  0.00012087821960449219
local_in_edges_tensor generation:  0.0003223419189453125
mini_batch_src_global generation:  0.00045561790466308594
r_  generation:  0.003265857696533203
----------------------check_connections_block total spend ----------------------------- 0.015029668807983398
generate_one_block  0.0073125362396240234
generate_one_block  0.0043985843658447266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0020949840545654297
gen group dst list time:  0.00023674964904785156
time for parepare:  0.0017249584197998047
local_output_nid generation:  0.0005795955657958984
local_in_edges_tensor generation:  0.001215219497680664
mini_batch_src_global generation:  0.0016231536865234375
r_  generation:  0.016201019287109375
local_output_nid generation:  0.0003325939178466797
local_in_edges_tensor generation:  0.0008027553558349609
mini_batch_src_global generation:  0.001603841781616211
r_  generation:  0.011625051498413086
----------------------check_connections_block total spend ----------------------------- 0.043167829513549805
generate_one_block  0.01914072036743164
generate_one_block  0.016253232955932617
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0015082359313964844
gen group dst list time:  0.0005095005035400391
time for parepare:  0.001603841781616211
local_output_nid generation:  0.0010519027709960938
local_in_edges_tensor generation:  0.0019011497497558594
mini_batch_src_global generation:  0.0015835762023925781
r_  generation:  0.018317222595214844
local_output_nid generation:  0.001013040542602539
local_in_edges_tensor generation:  0.0015747547149658203
mini_batch_src_global generation:  0.0016961097717285156
r_  generation:  0.01774454116821289
----------------------check_connections_block total spend ----------------------------- 0.05515480041503906
generate_one_block  0.022528409957885742
generate_one_block  0.023540019989013672
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007778167724609375  GigaBytes
Max Memory Allocated: 0.007778167724609375  GigaBytes

connection checking time:  0.1162259578704834
block generation total time  0.09776496887207031
average batch blocks generation time:  0.048882484436035156
block dataloader generation time/epoch 0.2417736053466797
pseudo mini batch 0 input nodes size: 16663
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007778167724609375  GigaBytes
Max Memory Allocated: 0.007778167724609375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0233154296875 GB
    Memory Allocated: 0.007778167724609375  GigaBytes
Max Memory Allocated: 0.007778167724609375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0545654296875 GB
    Memory Allocated: 0.039028167724609375  GigaBytes
Max Memory Allocated: 0.039028167724609375  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0545654296875 GB
    Memory Allocated: 0.03902864456176758  GigaBytes
Max Memory Allocated: 0.03902864456176758  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0545654296875 GB
    Memory Allocated: 0.03902864456176758  GigaBytes
Max Memory Allocated: 0.03902864456176758  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1209716796875 GB
    Memory Allocated: 0.03990983963012695  GigaBytes
Max Memory Allocated: 0.03990983963012695  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1209716796875 GB
    Memory Allocated: 0.03990983963012695  GigaBytes
Max Memory Allocated: 0.03990983963012695  GigaBytes

first layer input nodes number: 16663
first layer output nodes number: 13523
edges number: 53793
----------------------------------------before model layer 0
 Nvidia-smi: 1.1209716796875 GB
    Memory Allocated: 0.04013538360595703  GigaBytes
Max Memory Allocated: 0.04033613204956055  GigaBytes

torch.Size([16663, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1209716796875 GB
    Memory Allocated: 0.04013538360595703  GigaBytes
Max Memory Allocated: 0.04033613204956055  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3865966796875 GB
    Memory Allocated: 0.09177112579345703  GigaBytes
Max Memory Allocated: 0.09177112579345703  GigaBytes

torch.Size([13523, 512])
torch.Size([13523, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.11756420135498047  GigaBytes
Max Memory Allocated: 0.1433572769165039  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.09177112579345703  GigaBytes
Max Memory Allocated: 0.1433572769165039  GigaBytes

torch.Size([13523, 512])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.11756420135498047  GigaBytes
Max Memory Allocated: 0.1433572769165039  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12401247024536133  GigaBytes
Max Memory Allocated: 0.14980554580688477  GigaBytes

input nodes number: 13523
output nodes number: 5630
edges number: 45695
----------------------------------------before model layer 1
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12415552139282227  GigaBytes
Max Memory Allocated: 0.14980554580688477  GigaBytes

torch.Size([13523, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.12415552139282227  GigaBytes
Max Memory Allocated: 0.14980554580688477  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4412841796875 GB
    Memory Allocated: 0.14601469039916992  GigaBytes
Max Memory Allocated: 0.14980554580688477  GigaBytes

torch.Size([5630, 512])
torch.Size([5630, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.1567530632019043  GigaBytes
Max Memory Allocated: 0.16749143600463867  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.14601469039916992  GigaBytes
Max Memory Allocated: 0.16749143600463867  GigaBytes

torch.Size([5630, 512])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.1567530632019043  GigaBytes
Max Memory Allocated: 0.16749143600463867  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.1594376564025879  GigaBytes
Max Memory Allocated: 0.17017602920532227  GigaBytes

input nodes number: 5630
output nodes number: 1607
edges number: 15859
----------------------------------------before model layer 2
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.15949201583862305  GigaBytes
Max Memory Allocated: 0.17017602920532227  GigaBytes

torch.Size([5630, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.15949201583862305  GigaBytes
Max Memory Allocated: 0.17017602920532227  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.16587018966674805  GigaBytes
Max Memory Allocated: 0.17017602920532227  GigaBytes

torch.Size([1607, 512])
torch.Size([1607, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.16893529891967773  GigaBytes
Max Memory Allocated: 0.17200040817260742  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.16575288772583008  GigaBytes
Max Memory Allocated: 0.17200040817260742  GigaBytes

torch.Size([1607, 512])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.16893529891967773  GigaBytes
Max Memory Allocated: 0.17200040817260742  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.1695842742919922  GigaBytes
Max Memory Allocated: 0.17276668548583984  GigaBytes

input nodes number: 1607
output nodes number: 200
edges number: 2450
----------------------------------------before model layer 3
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.16959857940673828  GigaBytes
Max Memory Allocated: 0.17276668548583984  GigaBytes

torch.Size([1607, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.16959857940673828  GigaBytes
Max Memory Allocated: 0.17276668548583984  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4530029296875 GB
    Memory Allocated: 0.17038249969482422  GigaBytes
Max Memory Allocated: 0.17276668548583984  GigaBytes

torch.Size([200, 512])
torch.Size([200, 512])
----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.17076396942138672  GigaBytes
Max Memory Allocated: 0.17276668548583984  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.17038249969482422  GigaBytes
Max Memory Allocated: 0.17276668548583984  GigaBytes

torch.Size([200, 512])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.17076396942138672  GigaBytes
Max Memory Allocated: 0.17276668548583984  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.17085933685302734  GigaBytes
Max Memory Allocated: 0.17276668548583984  GigaBytes

----------------input nodes number: 200
----------------output nodes number: 30
----------------edges number: 170
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.17086172103881836  GigaBytes
Max Memory Allocated: 0.17276668548583984  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.17092227935791016  GigaBytes
Max Memory Allocated: 0.17276668548583984  GigaBytes

torch.Size([30, 3])
torch.Size([30, 3])
----------------------------------------after rst
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.17092275619506836  GigaBytes
Max Memory Allocated: 0.17276668548583984  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.17092227935791016  GigaBytes
Max Memory Allocated: 0.17276668548583984  GigaBytes

torch.Size([30, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.17092275619506836  GigaBytes
Max Memory Allocated: 0.17276668548583984  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4549560546875 GB
    Memory Allocated: 0.17092418670654297  GigaBytes
Max Memory Allocated: 0.17276668548583984  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.04964780807495117  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

pseudo mini batch 1 input nodes size: 16122
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.04680824279785156  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5272216796875 GB
    Memory Allocated: 0.04680824279785156  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.07683801651000977  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.07683849334716797  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.045588016510009766  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.046312808990478516  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.046312808990478516  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

first layer input nodes number: 16122
first layer output nodes number: 12517
edges number: 51295
----------------------------------------before model layer 0
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.046526432037353516  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

torch.Size([16122, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.046526432037353516  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.09414482116699219  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

torch.Size([12517, 512])
torch.Size([12517, 512])
----------------------------------------after rst
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.11801910400390625  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.09414482116699219  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

torch.Size([12517, 512])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.11801910400390625  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.12398767471313477  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

input nodes number: 12517
output nodes number: 4206
edges number: 36199
----------------------------------------before model layer 1
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.12411260604858398  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

torch.Size([12517, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.12411260604858398  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.1404585838317871  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

torch.Size([4206, 512])
torch.Size([4206, 512])
----------------------------------------after rst
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.14848089218139648  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.1404585838317871  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

torch.Size([4206, 512])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.14848089218139648  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.1505565643310547  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

input nodes number: 4206
output nodes number: 1117
edges number: 8148
----------------------------------------before model layer 2
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.15059661865234375  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

torch.Size([4206, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.15059661865234375  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.15492725372314453  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

torch.Size([1117, 512])
torch.Size([1117, 512])
----------------------------------------after rst
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.1570577621459961  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.15492725372314453  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

torch.Size([1117, 512])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.1570577621459961  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.15759038925170898  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

input nodes number: 1117
output nodes number: 156
edges number: 1403
----------------------------------------before model layer 3
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.15760040283203125  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

torch.Size([1117, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.15760040283203125  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.15820789337158203  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

torch.Size([156, 512])
torch.Size([156, 512])
----------------------------------------after rst
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.15850543975830078  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.15820789337158203  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

torch.Size([156, 512])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.15850543975830078  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.15857982635498047  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------input nodes number: 156
----------------output nodes number: 30
----------------edges number: 127
----------------------------------------before mean aggregator
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.15858173370361328  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.15864133834838867  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

torch.Size([30, 3])
torch.Size([30, 3])
----------------------------------------after rst
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.15864181518554688  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.15864133834838867  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

torch.Size([30, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.15864133834838867  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.5584716796875 GB
    Memory Allocated: 0.15864229202270508  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.04790639877319336  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.06346273422241211  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.5780029296875 GB
    Memory Allocated: 0.06346273422241211  GigaBytes
Max Memory Allocated: 0.18521881103515625  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.011856913566589355 |0.17434287071228027 |0.40453290939331055 |0.00021576881408691406 |0.00879812240600586 |0.0074007511138916016 |
----------------------------------------------------------pseudo_mini_loss sum 1.1437067985534668
Total (block generation + training)time/epoch 1.4579172134399414
Training time/epoch 1.2155961990356445
Training time without block to device /epoch 0.866910457611084
Training time without total dataloading part /epoch 0.8344943523406982
load block tensor time/epoch 0.02371382713317871
block to device time/epoch 0.34868574142456055
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  71741
Number of first layer input nodes during this epoch:  32785
Number of first layer output nodes during this epoch:  26040
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=500, out_features=512, bias=False)
      (fc_neigh): Linear(in_features=500, out_features=512, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=512, out_features=512, bias=False)
      (fc_neigh): Linear(in_features=512, out_features=512, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=512, out_features=512, bias=False)
      (fc_neigh): Linear(in_features=512, out_features=512, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=512, out_features=512, bias=False)
      (fc_neigh): Linear(in_features=512, out_features=512, bias=False)
    )
    (4): SAGEConv(
      (fc_self): Linear(in_features=512, out_features=3, bias=False)
      (fc_neigh): Linear(in_features=512, out_features=3, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  2087936
trainable parameters
layers.0.fc_self.weight, torch.Size([512, 500])
layers.0.fc_neigh.weight, torch.Size([512, 500])
layers.1.fc_self.weight, torch.Size([512, 512])
layers.1.fc_neigh.weight, torch.Size([512, 512])
layers.2.fc_self.weight, torch.Size([512, 512])
layers.2.fc_neigh.weight, torch.Size([512, 512])
layers.3.fc_self.weight, torch.Size([512, 512])
layers.3.fc_neigh.weight, torch.Size([512, 512])
layers.4.fc_self.weight, torch.Size([3, 512])
layers.4.fc_neigh.weight, torch.Size([3, 512])
----------------------------------------
un-trainable parameters
