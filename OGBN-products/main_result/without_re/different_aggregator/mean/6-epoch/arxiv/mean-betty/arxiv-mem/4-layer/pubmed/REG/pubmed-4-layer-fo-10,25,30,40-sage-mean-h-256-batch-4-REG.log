main start at this time 1657101369.6283176
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  500
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0019359588623046875  GigaBytes
Max Memory Allocated: 0.0019359588623046875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0019359588623046875  GigaBytes
Max Memory Allocated: 0.0019359588623046875  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0018601417541503906
global_2_local spend time (sec) 6.866455078125e-05
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0005714893341064453
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 294, 1: 26, 2: 6, 3: 6, 6: 4, 4: 3, 8: 3, 5: 2, 17: 2, 31: 1, 7: 1, 9: 1, 18: 1, 10: 1, 29: 1, 11: 1, 22: 1})

A = g.adjacency_matrix() spent  0.0004825592041015625
auxiliary_graph
Graph(num_nodes=354, num_edges=66,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0006403923034667969
remove nodes length  294

auxiliary_graph.remove_nodes spent  0.0015034675598144531
after remove non output nodes the auxiliary_graph
Graph(num_nodes=60, num_edges=66,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0009071826934814453

the counter of shared neighbor distribution
Counter({1.0: 6})
6
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.0020723342895507812
15
15
15
15
total k batches seeds list generation spend  0.01131296157836914
after graph partition
graph partition algorithm spend time 0.06898260116577148
15
15
15
15
partition_len_list
[121, 89, 74, 70]
REG selection method  spend 0.06920289993286133
time for parepare:  3.886222839355469e-05
local_output_nid generation:  2.1457672119140625e-06
local_in_edges_tensor generation:  0.00010848045349121094
mini_batch_src_global generation:  2.7894973754882812e-05
r_  generation:  8.702278137207031e-05
local_output_nid generation:  2.6226043701171875e-06
local_in_edges_tensor generation:  0.00012135505676269531
mini_batch_src_global generation:  1.9311904907226562e-05
r_  generation:  3.933906555175781e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  0.00010132789611816406
mini_batch_src_global generation:  1.6450881958007812e-05
r_  generation:  3.170967102050781e-05
local_output_nid generation:  2.384185791015625e-06
local_in_edges_tensor generation:  9.799003601074219e-05
mini_batch_src_global generation:  1.5735626220703125e-05
r_  generation:  3.0040740966796875e-05
----------------------check_connections_block total spend ----------------------------- 0.0009465217590332031
generate_one_block  0.002475738525390625
generate_one_block  0.0011138916015625
generate_one_block  0.0010714530944824219
generate_one_block  0.0010986328125
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.001155853271484375
gen group dst list time:  4.601478576660156e-05
time for parepare:  0.00022363662719726562
local_output_nid generation:  1.1205673217773438e-05
local_in_edges_tensor generation:  0.00018286705017089844
mini_batch_src_global generation:  4.410743713378906e-05
r_  generation:  0.00034546852111816406
local_output_nid generation:  9.775161743164062e-06
local_in_edges_tensor generation:  0.00012803077697753906
mini_batch_src_global generation:  5.817413330078125e-05
r_  generation:  0.0003757476806640625
local_output_nid generation:  7.62939453125e-06
local_in_edges_tensor generation:  0.00012421607971191406
mini_batch_src_global generation:  4.506111145019531e-05
r_  generation:  0.0003025531768798828
local_output_nid generation:  6.9141387939453125e-06
local_in_edges_tensor generation:  0.00012183189392089844
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.0002014636993408203
----------------------check_connections_block total spend ----------------------------- 0.0026230812072753906
generate_one_block  0.0015218257904052734
generate_one_block  0.001560211181640625
generate_one_block  0.0014615058898925781
generate_one_block  0.0013053417205810547
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.000985860824584961
gen group dst list time:  7.104873657226562e-05
time for parepare:  0.0006802082061767578
local_output_nid generation:  5.340576171875e-05
local_in_edges_tensor generation:  0.0003082752227783203
mini_batch_src_global generation:  0.0001628398895263672
r_  generation:  0.001916646957397461
local_output_nid generation:  6.961822509765625e-05
local_in_edges_tensor generation:  0.00024127960205078125
mini_batch_src_global generation:  0.0002727508544921875
r_  generation:  0.0024831295013427734
local_output_nid generation:  5.14984130859375e-05
local_in_edges_tensor generation:  0.00020694732666015625
mini_batch_src_global generation:  0.00020265579223632812
r_  generation:  0.0019390583038330078
local_output_nid generation:  3.790855407714844e-05
local_in_edges_tensor generation:  0.0001780986785888672
mini_batch_src_global generation:  0.00013685226440429688
r_  generation:  0.001108407974243164
----------------------check_connections_block total spend ----------------------------- 0.011965036392211914
generate_one_block  0.0038843154907226562
generate_one_block  0.004109859466552734
generate_one_block  0.0034699440002441406
generate_one_block  0.0023479461669921875
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.001783609390258789
gen group dst list time:  0.0002086162567138672
time for parepare:  0.0012447834014892578
local_output_nid generation:  0.0002541542053222656
local_in_edges_tensor generation:  0.0007603168487548828
mini_batch_src_global generation:  0.000682830810546875
r_  generation:  0.006068706512451172
local_output_nid generation:  0.00026798248291015625
local_in_edges_tensor generation:  0.0005338191986083984
mini_batch_src_global generation:  0.0008320808410644531
r_  generation:  0.007006645202636719
local_output_nid generation:  0.00017642974853515625
local_in_edges_tensor generation:  0.0003879070281982422
mini_batch_src_global generation:  0.0004761219024658203
r_  generation:  0.004645347595214844
local_output_nid generation:  0.0001690387725830078
local_in_edges_tensor generation:  0.0003693103790283203
mini_batch_src_global generation:  0.0003895759582519531
r_  generation:  0.003770112991333008
----------------------check_connections_block total spend ----------------------------- 0.0336003303527832
generate_one_block  0.009926557540893555
generate_one_block  0.009753942489624023
generate_one_block  0.006735324859619141
generate_one_block  0.005932807922363281
----------===============-------------===============-------------the number of batches *****---- 4

original number of batches:  4
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0019359588623046875  GigaBytes
Max Memory Allocated: 0.0019359588623046875  GigaBytes

connection checking time:  0.04913496971130371
block generation total time  0.0577692985534668
average batch blocks generation time:  0.003610581159591675
block dataloader generation time/epoch 0.19175982475280762
pseudo mini batch 0 input nodes size: 8300
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0019359588623046875  GigaBytes
Max Memory Allocated: 0.0019359588623046875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0019359588623046875  GigaBytes
Max Memory Allocated: 0.0019359588623046875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0330810546875 GB
    Memory Allocated: 0.017560958862304688  GigaBytes
Max Memory Allocated: 0.017560958862304688  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0330810546875 GB
    Memory Allocated: 0.01756143569946289  GigaBytes
Max Memory Allocated: 0.01756143569946289  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0330810546875 GB
    Memory Allocated: 0.01756143569946289  GigaBytes
Max Memory Allocated: 0.01756143569946289  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.0994873046875 GB
    Memory Allocated: 0.017760753631591797  GigaBytes
Max Memory Allocated: 0.017760753631591797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.0994873046875 GB
    Memory Allocated: 0.017760753631591797  GigaBytes
Max Memory Allocated: 0.017760753631591797  GigaBytes

first layer input nodes number: 8300
first layer output nodes number: 3523
edges number: 19288
----------------------------------------before model layer 0
 Nvidia-smi: 1.0994873046875 GB
    Memory Allocated: 0.017849445343017578  GigaBytes
Max Memory Allocated: 0.01792144775390625  GigaBytes

torch.Size([8300, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.0994873046875 GB
    Memory Allocated: 0.017849445343017578  GigaBytes
Max Memory Allocated: 0.01792144775390625  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.027928829193115234  GigaBytes
Max Memory Allocated: 0.03114461898803711  GigaBytes

torch.Size([3523, 256])
torch.Size([3523, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.03128862380981445  GigaBytes
Max Memory Allocated: 0.03464841842651367  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.027928829193115234  GigaBytes
Max Memory Allocated: 0.03464841842651367  GigaBytes

torch.Size([3523, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.03128862380981445  GigaBytes
Max Memory Allocated: 0.03464841842651367  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.03212881088256836  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

input nodes number: 3523
output nodes number: 690
edges number: 6245
----------------------------------------before model layer 1
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.03216075897216797  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

torch.Size([3523, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3065185546875 GB
    Memory Allocated: 0.03216075897216797  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.03352928161621094  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

torch.Size([690, 256])
torch.Size([690, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.03418731689453125  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.03352928161621094  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

torch.Size([690, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.03418731689453125  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.03435182571411133  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

input nodes number: 690
output nodes number: 121
edges number: 992
----------------------------------------before model layer 2
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.03435802459716797  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

torch.Size([690, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.03435802459716797  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.03459739685058594  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

torch.Size([121, 256])
torch.Size([121, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.034712791442871094  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.03459739685058594  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

torch.Size([121, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.034712791442871094  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.034741878509521484  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

----------------input nodes number: 121
----------------output nodes number: 15
----------------edges number: 108
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.034743309020996094  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.0347599983215332  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

torch.Size([15, 3])
torch.Size([15, 3])
----------------------------------------after rst
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.034760475158691406  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.0347599983215332  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

torch.Size([15, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.034760475158691406  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3104248046875 GB
    Memory Allocated: 0.034761905670166016  GigaBytes
Max Memory Allocated: 0.03548860549926758  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.020114898681640625  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

pseudo mini batch 1 input nodes size: 9145
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.019498825073242188  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.019498825073242188  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03653287887573242  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.036533355712890625  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.020907878875732422  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.021145343780517578  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.021145343780517578  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

first layer input nodes number: 9145
first layer output nodes number: 3494
edges number: 22442
----------------------------------------before model layer 0
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.021239757537841797  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

torch.Size([9145, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.021239757537841797  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.031261444091796875  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

torch.Size([3494, 256])
torch.Size([3494, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03459358215332031  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.031261444091796875  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

torch.Size([3494, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03459358215332031  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03542661666870117  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

input nodes number: 3494
output nodes number: 888
edges number: 7822
----------------------------------------before model layer 1
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03545951843261719  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

torch.Size([3494, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03545951843261719  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3162841796875 GB
    Memory Allocated: 0.03721904754638672  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

torch.Size([888, 256])
torch.Size([888, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03806591033935547  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03721904754638672  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

torch.Size([888, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03806591033935547  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.038277626037597656  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

input nodes number: 888
output nodes number: 89
edges number: 1158
----------------------------------------before model layer 2
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.038285255432128906  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

torch.Size([888, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.038285255432128906  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03846549987792969  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

torch.Size([89, 256])
torch.Size([89, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.038550376892089844  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03846549987792969  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

torch.Size([89, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.038550376892089844  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.038571834564208984  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

----------------input nodes number: 89
----------------output nodes number: 15
----------------edges number: 75
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.038573265075683594  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.0385899543762207  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

torch.Size([15, 3])
torch.Size([15, 3])
----------------------------------------after rst
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.038590431213378906  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.0385899543762207  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

torch.Size([15, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.0385899543762207  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03859090805053711  GigaBytes
Max Memory Allocated: 0.04000282287597656  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.021623611450195312  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

pseudo mini batch 2 input nodes size: 6176
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.020907878875732422  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.020907878875732422  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.03241157531738281  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.032412052154541016  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.015377521514892578  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.015546321868896484  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.015546321868896484  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

first layer input nodes number: 6176
first layer output nodes number: 2256
edges number: 15008
----------------------------------------before model layer 0
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.0156097412109375  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([6176, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.0156097412109375  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.022084712982177734  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([2256, 256])
torch.Size([2256, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.024236202239990234  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.022084712982177734  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([2256, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.024236202239990234  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.02477407455444336  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

input nodes number: 2256
output nodes number: 637
edges number: 6295
----------------------------------------before model layer 1
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.024796009063720703  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([2256, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.024796009063720703  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.02606344223022461  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([637, 256])
torch.Size([637, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.02667093276977539  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.02606344223022461  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([637, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.02667093276977539  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.026823043823242188  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

input nodes number: 637
output nodes number: 74
edges number: 919
----------------------------------------before model layer 2
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.026828765869140625  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([637, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.026828765869140625  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.026978492736816406  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([74, 256])
torch.Size([74, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.02704906463623047  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.026978492736816406  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([74, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.02704906463623047  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.027066707611083984  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------input nodes number: 74
----------------output nodes number: 15
----------------edges number: 59
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.027068138122558594  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.027084827423095703  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([15, 3])
torch.Size([15, 3])
----------------------------------------after rst
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.027085304260253906  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.027084827423095703  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([15, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.027084827423095703  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.02708578109741211  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.01588726043701172  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

pseudo mini batch 3 input nodes size: 6225
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.015377521514892578  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.015377521514892578  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.02697277069091797  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.026973247528076172  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.015469074249267578  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.015594005584716797  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.015594005584716797  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

first layer input nodes number: 6225
first layer output nodes number: 2076
edges number: 12509
----------------------------------------before model layer 0
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.015656471252441406  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([6225, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.015656471252441406  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.021806716918945312  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([2076, 256])
torch.Size([2076, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.023786544799804688  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.021806716918945312  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([2076, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.023786544799804688  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.02428150177001953  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

input nodes number: 2076
output nodes number: 442
edges number: 3430
----------------------------------------before model layer 1
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.024300575256347656  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([2076, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.024300575256347656  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.025173187255859375  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([442, 256])
torch.Size([442, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.025594711303710938  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.025173187255859375  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([442, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.025594711303710938  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.025700092315673828  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

input nodes number: 442
output nodes number: 70
edges number: 541
----------------------------------------before model layer 2
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.025704383850097656  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([442, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.025704383850097656  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.02584362030029297  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([70, 256])
torch.Size([70, 256])
----------------------------------------after rst
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.025910377502441406  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.02584362030029297  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([70, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.025910377502441406  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.025927066802978516  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------input nodes number: 70
----------------output nodes number: 15
----------------edges number: 55
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.025928497314453125  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.025945186614990234  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([15, 3])
torch.Size([15, 3])
----------------------------------------after rst
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.025945663452148438  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.025945186614990234  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

torch.Size([15, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.025945186614990234  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.02594614028930664  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.015859127044677734  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.01973104476928711  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.3182373046875 GB
    Memory Allocated: 0.01973104476928711  GigaBytes
Max Memory Allocated: 0.04229402542114258  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.006179690361022949 |0.08604246377944946 |0.20807796716690063 |0.00017076730728149414 |0.0043746232986450195 |0.001981019973754883 |
----------------------------------------------------------pseudo_mini_loss sum 1.0945136547088623
Total (block generation + training)time/epoch 1.4272146224975586
Training time/epoch 1.2352187633514404
Training time without block to device /epoch 0.8910489082336426
Training time without total dataloading part /epoch 0.8524744510650635
load block tensor time/epoch 0.024718761444091797
block to device time/epoch 0.34416985511779785
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  44206
Number of first layer input nodes during this epoch:  29846
Number of first layer output nodes during this epoch:  11349
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=500, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=500, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=3, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=3, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  519680
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 500])
layers.0.fc_neigh.weight, torch.Size([256, 500])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([3, 256])
layers.3.fc_neigh.weight, torch.Size([3, 256])
----------------------------------------
un-trainable parameters
