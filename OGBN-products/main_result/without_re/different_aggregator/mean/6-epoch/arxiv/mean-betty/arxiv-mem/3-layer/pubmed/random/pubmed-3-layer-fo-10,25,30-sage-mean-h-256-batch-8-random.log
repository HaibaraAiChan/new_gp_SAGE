main start at this time 1657074228.8517663
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 19717
  NumEdges: 88651
  NumFeats: 500
  NumClasses: 3
  NumTrainingSamples: 60
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
60
500
19157
# Nodes: 19717
# Edges: 88648
# Train: 60
# Val: 500
# Test: 19157
# Classes: 3

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  500
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014476776123046875  GigaBytes
Max Memory Allocated: 0.0014476776123046875  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014476776123046875  GigaBytes
Max Memory Allocated: 0.0014476776123046875  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0029048919677734375
number of batches is  8
batch size is  8
random selection method spend 0.0008220672607421875
time for parepare:  5.269050598144531e-05
local_output_nid generation:  2.2172927856445312e-05
local_in_edges_tensor generation:  0.00023293495178222656
mini_batch_src_global generation:  2.6464462280273438e-05
r_  generation:  0.002765655517578125
local_output_nid generation:  5.9604644775390625e-06
local_in_edges_tensor generation:  0.00013756752014160156
mini_batch_src_global generation:  2.5272369384765625e-05
r_  generation:  2.6941299438476562e-05
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.0001049041748046875
mini_batch_src_global generation:  1.5974044799804688e-05
r_  generation:  2.5272369384765625e-05
local_output_nid generation:  0.0001251697540283203
local_in_edges_tensor generation:  0.00011563301086425781
mini_batch_src_global generation:  2.002716064453125e-05
r_  generation:  3.266334533691406e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010800361633300781
mini_batch_src_global generation:  1.5497207641601562e-05
r_  generation:  2.86102294921875e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.226799011230469e-05
mini_batch_src_global generation:  1.52587890625e-05
r_  generation:  2.3365020751953125e-05
local_output_nid generation:  4.0531158447265625e-06
local_in_edges_tensor generation:  9.179115295410156e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.6927719116210938e-05
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  9.012222290039062e-05
mini_batch_src_global generation:  1.4066696166992188e-05
r_  generation:  1.52587890625e-05
----------------------check_connections_block total spend ----------------------------- 0.004628658294677734
generate_one_block  0.002721071243286133
generate_one_block  0.001089334487915039
generate_one_block  0.0010228157043457031
generate_one_block  0.0009925365447998047
generate_one_block  0.0010437965393066406
generate_one_block  0.0009851455688476562
generate_one_block  0.0009741783142089844
generate_one_block  0.001039743423461914
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0012116432189941406
gen group dst list time:  4.649162292480469e-05
time for parepare:  0.0001971721649169922
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.0001838207244873047
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00022149085998535156
local_output_nid generation:  5.7220458984375e-06
local_in_edges_tensor generation:  0.00011754035949707031
mini_batch_src_global generation:  3.0040740966796875e-05
r_  generation:  0.00011324882507324219
local_output_nid generation:  5.245208740234375e-06
local_in_edges_tensor generation:  0.00011086463928222656
mini_batch_src_global generation:  2.8371810913085938e-05
r_  generation:  0.00016570091247558594
local_output_nid generation:  6.67572021484375e-06
local_in_edges_tensor generation:  0.00011324882507324219
mini_batch_src_global generation:  3.4809112548828125e-05
r_  generation:  0.0002167224884033203
local_output_nid generation:  7.152557373046875e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  3.457069396972656e-05
r_  generation:  0.00021076202392578125
local_output_nid generation:  5.0067901611328125e-06
local_in_edges_tensor generation:  0.00011301040649414062
mini_batch_src_global generation:  2.7418136596679688e-05
r_  generation:  0.000118255615234375
local_output_nid generation:  3.337860107421875e-06
local_in_edges_tensor generation:  0.00010776519775390625
mini_batch_src_global generation:  2.574920654296875e-05
r_  generation:  0.00012421607971191406
local_output_nid generation:  2.86102294921875e-06
local_in_edges_tensor generation:  0.00010514259338378906
mini_batch_src_global generation:  2.09808349609375e-05
r_  generation:  6.0558319091796875e-05
----------------------check_connections_block total spend ----------------------------- 0.003181934356689453
generate_one_block  0.001268625259399414
generate_one_block  0.001104116439819336
generate_one_block  0.0012629032135009766
generate_one_block  0.0012476444244384766
generate_one_block  0.0012183189392089844
generate_one_block  0.001218557357788086
generate_one_block  0.0011725425720214844
generate_one_block  0.0010426044464111328
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008041858673095703
gen group dst list time:  8.487701416015625e-05
time for parepare:  0.0005588531494140625
local_output_nid generation:  4.410743713378906e-05
local_in_edges_tensor generation:  0.0002620220184326172
mini_batch_src_global generation:  8.153915405273438e-05
r_  generation:  0.0008044242858886719
local_output_nid generation:  2.3603439331054688e-05
local_in_edges_tensor generation:  0.00014543533325195312
mini_batch_src_global generation:  7.271766662597656e-05
r_  generation:  0.0004291534423828125
local_output_nid generation:  3.528594970703125e-05
local_in_edges_tensor generation:  0.00015783309936523438
mini_batch_src_global generation:  7.605552673339844e-05
r_  generation:  0.0007073879241943359
local_output_nid generation:  3.0994415283203125e-05
local_in_edges_tensor generation:  0.00016427040100097656
mini_batch_src_global generation:  9.655952453613281e-05
r_  generation:  0.0008039474487304688
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00016069412231445312
mini_batch_src_global generation:  9.322166442871094e-05
r_  generation:  0.0008223056793212891
local_output_nid generation:  2.288818359375e-05
local_in_edges_tensor generation:  0.00014591217041015625
mini_batch_src_global generation:  6.961822509765625e-05
r_  generation:  0.0004525184631347656
local_output_nid generation:  3.5762786865234375e-05
local_in_edges_tensor generation:  0.00015401840209960938
mini_batch_src_global generation:  6.222724914550781e-05
r_  generation:  0.00048828125
local_output_nid generation:  9.5367431640625e-06
local_in_edges_tensor generation:  0.00012350082397460938
mini_batch_src_global generation:  4.458427429199219e-05
r_  generation:  0.00020241737365722656
----------------------check_connections_block total spend ----------------------------- 0.008877992630004883
generate_one_block  0.003000020980834961
generate_one_block  0.0016117095947265625
generate_one_block  0.001856088638305664
generate_one_block  0.002051115036010742
generate_one_block  0.002095460891723633
generate_one_block  0.0015578269958496094
generate_one_block  0.001600503921508789
generate_one_block  0.0011980533599853516
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014476776123046875  GigaBytes
Max Memory Allocated: 0.0014476776123046875  GigaBytes

connection checking time:  0.012059926986694336
block generation total time  0.024506092071533203
average batch blocks generation time:  0.0030632615089416504
block dataloader generation time/epoch 0.06428837776184082
pseudo mini batch 0 input nodes size: 1397
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014476776123046875  GigaBytes
Max Memory Allocated: 0.0014476776123046875  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0014476776123046875  GigaBytes
Max Memory Allocated: 0.0014476776123046875  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.004050254821777344  GigaBytes
Max Memory Allocated: 0.004050254821777344  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.004050731658935547  GigaBytes
Max Memory Allocated: 0.004050731658935547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.004050731658935547  GigaBytes
Max Memory Allocated: 0.004050731658935547  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.004077434539794922  GigaBytes
Max Memory Allocated: 0.004077434539794922  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.004077434539794922  GigaBytes
Max Memory Allocated: 0.004077434539794922  GigaBytes

first layer input nodes number: 1397
first layer output nodes number: 435
edges number: 2793
----------------------------------------before model layer 0
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0040912628173828125  GigaBytes
Max Memory Allocated: 0.004101753234863281  GigaBytes

torch.Size([1397, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0040912628173828125  GigaBytes
Max Memory Allocated: 0.004101753234863281  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.005339622497558594  GigaBytes
Max Memory Allocated: 0.0057373046875  GigaBytes

torch.Size([435, 256])
torch.Size([435, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0057544708251953125  GigaBytes
Max Memory Allocated: 0.006169319152832031  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005339622497558594  GigaBytes
Max Memory Allocated: 0.006169319152832031  GigaBytes

torch.Size([435, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0057544708251953125  GigaBytes
Max Memory Allocated: 0.006169319152832031  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005858421325683594  GigaBytes
Max Memory Allocated: 0.0062732696533203125  GigaBytes

input nodes number: 435
output nodes number: 49
edges number: 623
----------------------------------------before model layer 1
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005862236022949219  GigaBytes
Max Memory Allocated: 0.0062732696533203125  GigaBytes

torch.Size([435, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005862236022949219  GigaBytes
Max Memory Allocated: 0.0062732696533203125  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005961418151855469  GigaBytes
Max Memory Allocated: 0.0062732696533203125  GigaBytes

torch.Size([49, 256])
torch.Size([49, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006008148193359375  GigaBytes
Max Memory Allocated: 0.0062732696533203125  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.005961418151855469  GigaBytes
Max Memory Allocated: 0.0062732696533203125  GigaBytes

torch.Size([49, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006008148193359375  GigaBytes
Max Memory Allocated: 0.0062732696533203125  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006020069122314453  GigaBytes
Max Memory Allocated: 0.0062732696533203125  GigaBytes

----------------input nodes number: 49
----------------output nodes number: 8
----------------edges number: 41
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006021022796630859  GigaBytes
Max Memory Allocated: 0.0062732696533203125  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006031036376953125  GigaBytes
Max Memory Allocated: 0.0062732696533203125  GigaBytes

torch.Size([8, 3])
torch.Size([8, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006031513214111328  GigaBytes
Max Memory Allocated: 0.0062732696533203125  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006031036376953125  GigaBytes
Max Memory Allocated: 0.0062732696533203125  GigaBytes

torch.Size([8, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.006031513214111328  GigaBytes
Max Memory Allocated: 0.0062732696533203125  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2655029296875 GB
    Memory Allocated: 0.0060329437255859375  GigaBytes
Max Memory Allocated: 0.0062732696533203125  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0055828094482421875  GigaBytes
Max Memory Allocated: 0.007203102111816406  GigaBytes

pseudo mini batch 1 input nodes size: 933
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005499839782714844  GigaBytes
Max Memory Allocated: 0.007203102111816406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005499839782714844  GigaBytes
Max Memory Allocated: 0.007203102111816406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007237911224365234  GigaBytes
Max Memory Allocated: 0.007237911224365234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0072383880615234375  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004635334014892578  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004649639129638672  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004649639129638672  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

first layer input nodes number: 933
first layer output nodes number: 256
edges number: 1362
----------------------------------------before model layer 0
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004658699035644531  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

torch.Size([933, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004658699035644531  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005391597747802734  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

torch.Size([256, 256])
torch.Size([256, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005635738372802734  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005391597747802734  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

torch.Size([256, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005635738372802734  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005696773529052734  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

input nodes number: 256
output nodes number: 35
edges number: 295
----------------------------------------before model layer 1
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.00569915771484375  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

torch.Size([256, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.00569915771484375  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0057697296142578125  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

torch.Size([35, 256])
torch.Size([35, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005803108215332031  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0057697296142578125  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

torch.Size([35, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005803108215332031  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0058116912841796875  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

----------------input nodes number: 35
----------------output nodes number: 8
----------------edges number: 27
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005812644958496094  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005822658538818359  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

torch.Size([8, 3])
torch.Size([8, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0058231353759765625  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005822658538818359  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

torch.Size([8, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005822658538818359  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005823612213134766  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0046844482421875  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

pseudo mini batch 2 input nodes size: 1428
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004635334014892578  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004635334014892578  GigaBytes
Max Memory Allocated: 0.0072383880615234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0072956085205078125  GigaBytes
Max Memory Allocated: 0.0072956085205078125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007296085357666016  GigaBytes
Max Memory Allocated: 0.007296085357666016  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005557537078857422  GigaBytes
Max Memory Allocated: 0.007296085357666016  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005578517913818359  GigaBytes
Max Memory Allocated: 0.007296085357666016  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005578517913818359  GigaBytes
Max Memory Allocated: 0.007296085357666016  GigaBytes

first layer input nodes number: 1428
first layer output nodes number: 430
edges number: 2149
----------------------------------------before model layer 0
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005592823028564453  GigaBytes
Max Memory Allocated: 0.007296085357666016  GigaBytes

torch.Size([1428, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005592823028564453  GigaBytes
Max Memory Allocated: 0.007296085357666016  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006822109222412109  GigaBytes
Max Memory Allocated: 0.007296085357666016  GigaBytes

torch.Size([430, 256])
torch.Size([430, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007232189178466797  GigaBytes
Max Memory Allocated: 0.007642269134521484  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006822109222412109  GigaBytes
Max Memory Allocated: 0.007642269134521484  GigaBytes

torch.Size([430, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007232189178466797  GigaBytes
Max Memory Allocated: 0.007642269134521484  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007334709167480469  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

input nodes number: 430
output nodes number: 45
edges number: 495
----------------------------------------before model layer 1
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007338523864746094  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

torch.Size([430, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007338523864746094  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0074291229248046875  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

torch.Size([45, 256])
torch.Size([45, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007472038269042969  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0074291229248046875  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

torch.Size([45, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007472038269042969  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007483005523681641  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

----------------input nodes number: 45
----------------output nodes number: 8
----------------edges number: 37
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007483959197998047  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0074939727783203125  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

torch.Size([8, 3])
torch.Size([8, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007494449615478516  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0074939727783203125  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

torch.Size([8, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0074939727783203125  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007494926452636719  GigaBytes
Max Memory Allocated: 0.007744789123535156  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0056285858154296875  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

pseudo mini batch 3 input nodes size: 1254
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005557537078857422  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005557537078857422  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007893562316894531  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007894039154052734  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005233287811279297  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005260944366455078  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005260944366455078  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

first layer input nodes number: 1254
first layer output nodes number: 394
edges number: 2691
----------------------------------------before model layer 0
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0052738189697265625  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

torch.Size([1254, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0052738189697265625  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0064067840576171875  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

torch.Size([394, 256])
torch.Size([394, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.00678253173828125  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0064067840576171875  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

torch.Size([394, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.00678253173828125  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006876468658447266  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

input nodes number: 394
output nodes number: 69
edges number: 658
----------------------------------------before model layer 1
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006880760192871094  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

torch.Size([394, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006880760192871094  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.00701904296875  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

torch.Size([69, 256])
torch.Size([69, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007084846496582031  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.00701904296875  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

torch.Size([69, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007084846496582031  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007101535797119141  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------input nodes number: 69
----------------output nodes number: 8
----------------edges number: 61
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.00710296630859375  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007112979888916016  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

torch.Size([8, 3])
torch.Size([8, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007113456726074219  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007112979888916016  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

torch.Size([8, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007112979888916016  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007113933563232422  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005319118499755859  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

pseudo mini batch 4 input nodes size: 1511
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005233287811279297  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005233287811279297  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.008048057556152344  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.008048534393310547  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005712032318115234  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005736827850341797  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005736827850341797  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

first layer input nodes number: 1511
first layer output nodes number: 445
edges number: 2545
----------------------------------------before model layer 0
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005751609802246094  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

torch.Size([1511, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005751609802246094  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007026195526123047  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

torch.Size([445, 256])
torch.Size([445, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007450580596923828  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007026195526123047  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

torch.Size([445, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007450580596923828  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007556915283203125  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

input nodes number: 445
output nodes number: 64
edges number: 616
----------------------------------------before model layer 1
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.00756072998046875  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

torch.Size([445, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.00756072998046875  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0076885223388671875  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

torch.Size([64, 256])
torch.Size([64, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0077495574951171875  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0076885223388671875  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

torch.Size([64, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0077495574951171875  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0077648162841796875  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------input nodes number: 64
----------------output nodes number: 8
----------------edges number: 56
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007765769958496094  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007775783538818359  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

torch.Size([8, 3])
torch.Size([8, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0077762603759765625  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007775783538818359  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

torch.Size([8, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007775783538818359  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.007776737213134766  GigaBytes
Max Memory Allocated: 0.008172988891601562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005792140960693359  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

pseudo mini batch 5 input nodes size: 1010
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005712032318115234  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005712032318115234  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.008048057556152344  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.008048534393310547  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005233287811279297  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005247592926025391  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005247592926025391  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

first layer input nodes number: 1010
first layer output nodes number: 246
edges number: 1356
----------------------------------------before model layer 0
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005257129669189453  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([1010, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005257129669189453  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005961418151855469  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([246, 256])
torch.Size([246, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006196022033691406  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005961418151855469  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([246, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006196022033691406  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006254673004150391  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

input nodes number: 246
output nodes number: 48
edges number: 300
----------------------------------------before model layer 1
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006257057189941406  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([246, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006257057189941406  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006352424621582031  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([48, 256])
torch.Size([48, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006398200988769531  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006352424621582031  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([48, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006398200988769531  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006409645080566406  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------input nodes number: 48
----------------output nodes number: 8
----------------edges number: 40
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0064105987548828125  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006420612335205078  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([8, 3])
torch.Size([8, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006421089172363281  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006420612335205078  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([8, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006420612335205078  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006421566009521484  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005281925201416016  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

pseudo mini batch 6 input nodes size: 930
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005233287811279297  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005233287811279297  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.00696563720703125  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006966114044189453  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004629611968994141  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004644870758056641  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004644870758056641  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

first layer input nodes number: 930
first layer output nodes number: 330
edges number: 1470
----------------------------------------before model layer 0
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004654884338378906  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([930, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004654884338378906  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005597591400146484  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([330, 256])
torch.Size([330, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005912303924560547  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005597591400146484  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([330, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005912303924560547  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0059909820556640625  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

input nodes number: 330
output nodes number: 27
edges number: 373
----------------------------------------before model layer 1
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005994319915771484  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([330, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005994319915771484  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006049633026123047  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([27, 256])
torch.Size([27, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006075382232666016  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006049633026123047  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([27, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006075382232666016  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006082057952880859  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------input nodes number: 27
----------------output nodes number: 8
----------------edges number: 19
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006083011627197266  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006093025207519531  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([8, 3])
torch.Size([8, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006093502044677734  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006093025207519531  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([8, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.006093025207519531  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0060939788818359375  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0046825408935546875  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

pseudo mini batch 7 input nodes size: 395
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004629611968994141  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004629611968994141  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0053653717041015625  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.005365848541259766  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0036330223083496094  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.003639698028564453  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.003639698028564453  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

first layer input nodes number: 395
first layer output nodes number: 86
edges number: 548
----------------------------------------before model layer 0
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0036439895629882812  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([395, 500])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0036439895629882812  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.003891468048095703  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([86, 256])
torch.Size([86, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.003973484039306641  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.003891468048095703  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([86, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.003973484039306641  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.003993988037109375  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

input nodes number: 86
output nodes number: 19
edges number: 128
----------------------------------------before model layer 1
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.003995418548583984  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([86, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.003995418548583984  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004033565521240234  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([19, 256])
torch.Size([19, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004051685333251953  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004033565521240234  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([19, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004051685333251953  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004056453704833984  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------input nodes number: 19
----------------output nodes number: 4
----------------edges number: 15
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004057407379150391  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004063606262207031  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([4, 3])
torch.Size([4, 3])
----------------------------------------after rst
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004064083099365234  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004063606262207031  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

torch.Size([4, 3])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.004063606262207031  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0040645599365234375  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.0036573410034179688  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.006552696228027344  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.2713623046875 GB
    Memory Allocated: 0.006552696228027344  GigaBytes
Max Memory Allocated: 0.008425712585449219  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0027840733528137207 |0.04373851418495178 |0.10636496543884277 |0.00012990832328796387 |0.002552419900894165 |0.002178668975830078 |
----------------------------------------------------------pseudo_mini_loss sum 1.0945791006088257
Total (block generation + training)time/epoch 1.3355960845947266
Training time/epoch 1.271103858947754
Training time without block to device /epoch 0.9211957454681396
Training time without total dataloading part /epoch 0.8745570182800293
load block tensor time/epoch 0.022272586822509766
block to device time/epoch 0.34990811347961426
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  11836
Number of first layer input nodes during this epoch:  8858
Number of first layer output nodes during this epoch:  2622
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=500, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=500, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=3, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=3, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  388608
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 500])
layers.0.fc_neigh.weight, torch.Size([256, 500])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([3, 256])
layers.2.fc_neigh.weight, torch.Size([3, 256])
----------------------------------------
un-trainable parameters
