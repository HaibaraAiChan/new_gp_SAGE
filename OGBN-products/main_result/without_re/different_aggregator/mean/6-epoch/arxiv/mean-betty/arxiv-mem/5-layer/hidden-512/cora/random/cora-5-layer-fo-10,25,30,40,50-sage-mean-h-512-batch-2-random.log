main start at this time 1657105027.0468879
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.0113525390625  GigaBytes
Max Memory Allocated: 0.0113525390625  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.0113525390625  GigaBytes
Max Memory Allocated: 0.0113525390625  GigaBytes

The real block id is  4
get_global_graph_edges_ids_block function  spend 0.0011768341064453125
number of batches is  2
batch size is  70
random selection method spend 0.0003292560577392578
time for parepare:  6.890296936035156e-05
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.0002434253692626953
mini_batch_src_global generation:  3.600120544433594e-05
r_  generation:  0.0017251968383789062
local_output_nid generation:  2.0503997802734375e-05
local_in_edges_tensor generation:  0.00014972686767578125
mini_batch_src_global generation:  3.409385681152344e-05
r_  generation:  0.00012803077697753906
----------------------check_connections_block total spend ----------------------------- 0.0026290416717529297
generate_one_block  0.002262592315673828
generate_one_block  0.00127410888671875
The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0005350112915039062
gen group dst list time:  3.647804260253906e-05
time for parepare:  0.0001671314239501953
local_output_nid generation:  2.9802322387695312e-05
local_in_edges_tensor generation:  0.00025010108947753906
mini_batch_src_global generation:  9.918212890625e-05
r_  generation:  0.0007910728454589844
local_output_nid generation:  2.86102294921875e-05
local_in_edges_tensor generation:  0.00016117095947265625
mini_batch_src_global generation:  9.918212890625e-05
r_  generation:  0.0006477832794189453
----------------------check_connections_block total spend ----------------------------- 0.0027396678924560547
generate_one_block  0.0020470619201660156
generate_one_block  0.0018017292022705078
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0006029605865478516
gen group dst list time:  5.602836608886719e-05
time for parepare:  0.0001800060272216797
local_output_nid generation:  8.034706115722656e-05
local_in_edges_tensor generation:  0.00036454200744628906
mini_batch_src_global generation:  0.00021314620971679688
r_  generation:  0.001943349838256836
local_output_nid generation:  7.677078247070312e-05
local_in_edges_tensor generation:  0.0002532005310058594
mini_batch_src_global generation:  0.0002269744873046875
r_  generation:  0.0017414093017578125
----------------------check_connections_block total spend ----------------------------- 0.005983114242553711
generate_one_block  0.0032892227172851562
generate_one_block  0.0031795501708984375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0006673336029052734
gen group dst list time:  8.96453857421875e-05
time for parepare:  0.00019860267639160156
local_output_nid generation:  0.0001316070556640625
local_in_edges_tensor generation:  0.0004458427429199219
mini_batch_src_global generation:  0.00024199485778808594
r_  generation:  0.002839803695678711
local_output_nid generation:  0.00013899803161621094
local_in_edges_tensor generation:  0.00034499168395996094
mini_batch_src_global generation:  0.0003204345703125
r_  generation:  0.002807140350341797
----------------------check_connections_block total spend ----------------------------- 0.008988380432128906
generate_one_block  0.004253387451171875
generate_one_block  0.003915548324584961
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0008122920989990234
gen group dst list time:  0.00011229515075683594
time for parepare:  0.00020432472229003906
local_output_nid generation:  0.0001575946807861328
local_in_edges_tensor generation:  0.0005018711090087891
mini_batch_src_global generation:  0.0002570152282714844
r_  generation:  0.003118753433227539
local_output_nid generation:  0.0001678466796875
local_in_edges_tensor generation:  0.00038123130798339844
mini_batch_src_global generation:  0.00030040740966796875
r_  generation:  0.003130197525024414
----------------------check_connections_block total spend ----------------------------- 0.009751319885253906
generate_one_block  0.004417896270751953
generate_one_block  0.004179477691650391
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.0113525390625  GigaBytes
Max Memory Allocated: 0.0113525390625  GigaBytes

connection checking time:  0.027462482452392578
block generation total time  0.027083873748779297
average batch blocks generation time:  0.013541936874389648
block dataloader generation time/epoch 0.07281875610351562
pseudo mini batch 0 input nodes size: 2424
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.0113525390625  GigaBytes
Max Memory Allocated: 0.0113525390625  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.0113525390625  GigaBytes
Max Memory Allocated: 0.0113525390625  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.024292945861816406  GigaBytes
Max Memory Allocated: 0.024292945861816406  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.024293899536132812  GigaBytes
Max Memory Allocated: 0.024293899536132812  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0428466796875 GB
    Memory Allocated: 0.024293899536132812  GigaBytes
Max Memory Allocated: 0.024293899536132812  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.024483680725097656  GigaBytes
Max Memory Allocated: 0.024483680725097656  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.024483680725097656  GigaBytes
Max Memory Allocated: 0.024483680725097656  GigaBytes

first layer input nodes number: 2424
first layer output nodes number: 2276
edges number: 8688
----------------------------------------before model layer 0
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.024518966674804688  GigaBytes
Max Memory Allocated: 0.0245513916015625  GigaBytes

torch.Size([2424, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.024518966674804688  GigaBytes
Max Memory Allocated: 0.0245513916015625  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.04108381271362305  GigaBytes
Max Memory Allocated: 0.04890155792236328  GigaBytes

torch.Size([2276, 512])
torch.Size([2276, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.04607343673706055  GigaBytes
Max Memory Allocated: 0.0504145622253418  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.0417323112487793  GigaBytes
Max Memory Allocated: 0.0504145622253418  GigaBytes

torch.Size([2276, 512])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.04607343673706055  GigaBytes
Max Memory Allocated: 0.0504145622253418  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.047197818756103516  GigaBytes
Max Memory Allocated: 0.051538944244384766  GigaBytes

input nodes number: 2276
output nodes number: 1886
edges number: 8185
----------------------------------------before model layer 1
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.04722929000854492  GigaBytes
Max Memory Allocated: 0.051538944244384766  GigaBytes

torch.Size([2276, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3084716796875 GB
    Memory Allocated: 0.04722929000854492  GigaBytes
Max Memory Allocated: 0.051538944244384766  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.05524301528930664  GigaBytes
Max Memory Allocated: 0.05524301528930664  GigaBytes

torch.Size([1886, 512])
torch.Size([1886, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.058840274810791016  GigaBytes
Max Memory Allocated: 0.06243753433227539  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.054499149322509766  GigaBytes
Max Memory Allocated: 0.06243753433227539  GigaBytes

torch.Size([1886, 512])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.05809640884399414  GigaBytes
Max Memory Allocated: 0.06243753433227539  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.05973958969116211  GigaBytes
Max Memory Allocated: 0.06333684921264648  GigaBytes

input nodes number: 1886
output nodes number: 1159
edges number: 5701
----------------------------------------before model layer 2
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.05976295471191406  GigaBytes
Max Memory Allocated: 0.06333684921264648  GigaBytes

torch.Size([1886, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.05976295471191406  GigaBytes
Max Memory Allocated: 0.06333684921264648  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.06423664093017578  GigaBytes
Max Memory Allocated: 0.06423664093017578  GigaBytes

torch.Size([1159, 512])
torch.Size([1159, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.06644725799560547  GigaBytes
Max Memory Allocated: 0.06865787506103516  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.06423664093017578  GigaBytes
Max Memory Allocated: 0.06865787506103516  GigaBytes

torch.Size([1159, 512])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3280029296875 GB
    Memory Allocated: 0.06644725799560547  GigaBytes
Max Memory Allocated: 0.06865787506103516  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.06699991226196289  GigaBytes
Max Memory Allocated: 0.06921052932739258  GigaBytes

input nodes number: 1159
output nodes number: 389
edges number: 2416
----------------------------------------before model layer 3
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.06701231002807617  GigaBytes
Max Memory Allocated: 0.06921052932739258  GigaBytes

torch.Size([1159, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3299560546875 GB
    Memory Allocated: 0.06701231002807617  GigaBytes
Max Memory Allocated: 0.06921052932739258  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3319091796875 GB
    Memory Allocated: 0.06851816177368164  GigaBytes
Max Memory Allocated: 0.06921052932739258  GigaBytes

torch.Size([389, 512])
torch.Size([389, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.0692601203918457  GigaBytes
Max Memory Allocated: 0.07000207901000977  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06851816177368164  GigaBytes
Max Memory Allocated: 0.07000207901000977  GigaBytes

torch.Size([389, 512])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.0692601203918457  GigaBytes
Max Memory Allocated: 0.07000207901000977  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06944561004638672  GigaBytes
Max Memory Allocated: 0.07018756866455078  GigaBytes

----------------input nodes number: 389
----------------output nodes number: 70
----------------edges number: 353
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06944990158081055  GigaBytes
Max Memory Allocated: 0.07018756866455078  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06958913803100586  GigaBytes
Max Memory Allocated: 0.07018756866455078  GigaBytes

torch.Size([70, 7])
torch.Size([70, 7])
----------------------------------------after rst
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06959104537963867  GigaBytes
Max Memory Allocated: 0.07018756866455078  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06958913803100586  GigaBytes
Max Memory Allocated: 0.07018756866455078  GigaBytes

torch.Size([70, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06959104537963867  GigaBytes
Max Memory Allocated: 0.07018756866455078  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3338623046875 GB
    Memory Allocated: 0.06959390640258789  GigaBytes
Max Memory Allocated: 0.07018756866455078  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.036305904388427734  GigaBytes
Max Memory Allocated: 0.0734715461730957  GigaBytes

pseudo mini batch 1 input nodes size: 2440
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.03564929962158203  GigaBytes
Max Memory Allocated: 0.0734715461730957  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.03564929962158203  GigaBytes
Max Memory Allocated: 0.0734715461730957  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.04932117462158203  GigaBytes
Max Memory Allocated: 0.0734715461730957  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.04932212829589844  GigaBytes
Max Memory Allocated: 0.0734715461730957  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.036380767822265625  GigaBytes
Max Memory Allocated: 0.0734715461730957  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.03656291961669922  GigaBytes
Max Memory Allocated: 0.0734715461730957  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.03656291961669922  GigaBytes
Max Memory Allocated: 0.0734715461730957  GigaBytes

first layer input nodes number: 2440
first layer output nodes number: 2302
edges number: 8785
----------------------------------------before model layer 0
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.03659868240356445  GigaBytes
Max Memory Allocated: 0.0734715461730957  GigaBytes

torch.Size([2440, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.03659868240356445  GigaBytes
Max Memory Allocated: 0.0734715461730957  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.05335283279418945  GigaBytes
Max Memory Allocated: 0.0734715461730957  GigaBytes

torch.Size([2302, 512])
torch.Size([2302, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.05774354934692383  GigaBytes
Max Memory Allocated: 0.0734715461730957  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.05335283279418945  GigaBytes
Max Memory Allocated: 0.0734715461730957  GigaBytes

torch.Size([2302, 512])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.05774354934692383  GigaBytes
Max Memory Allocated: 0.0734715461730957  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.05930185317993164  GigaBytes
Max Memory Allocated: 0.0734715461730957  GigaBytes

input nodes number: 2302
output nodes number: 1855
edges number: 8082
----------------------------------------before model layer 1
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.059332847595214844  GigaBytes
Max Memory Allocated: 0.0734715461730957  GigaBytes

torch.Size([2302, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.059332847595214844  GigaBytes
Max Memory Allocated: 0.0734715461730957  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.0673370361328125  GigaBytes
Max Memory Allocated: 0.0734715461730957  GigaBytes

torch.Size([1855, 512])
torch.Size([1855, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.07087516784667969  GigaBytes
Max Memory Allocated: 0.07441329956054688  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.06648445129394531  GigaBytes
Max Memory Allocated: 0.07441329956054688  GigaBytes

torch.Size([1855, 512])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.07087516784667969  GigaBytes
Max Memory Allocated: 0.07441329956054688  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.0709071159362793  GigaBytes
Max Memory Allocated: 0.07529783248901367  GigaBytes

input nodes number: 1855
output nodes number: 1041
edges number: 5101
----------------------------------------before model layer 2
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.07092905044555664  GigaBytes
Max Memory Allocated: 0.07529783248901367  GigaBytes

torch.Size([1855, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.07092905044555664  GigaBytes
Max Memory Allocated: 0.07529783248901367  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.07582998275756836  GigaBytes
Max Memory Allocated: 0.07582998275756836  GigaBytes

torch.Size([1041, 512])
torch.Size([1041, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.07781553268432617  GigaBytes
Max Memory Allocated: 0.08066701889038086  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.07555913925170898  GigaBytes
Max Memory Allocated: 0.08066701889038086  GigaBytes

torch.Size([1041, 512])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.07781553268432617  GigaBytes
Max Memory Allocated: 0.08066701889038086  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.078460693359375  GigaBytes
Max Memory Allocated: 0.08071708679199219  GigaBytes

input nodes number: 1041
output nodes number: 307
edges number: 1839
----------------------------------------before model layer 3
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.07847118377685547  GigaBytes
Max Memory Allocated: 0.08071708679199219  GigaBytes

torch.Size([1041, 512])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.07847118377685547  GigaBytes
Max Memory Allocated: 0.08071708679199219  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3612060546875 GB
    Memory Allocated: 0.07965946197509766  GigaBytes
Max Memory Allocated: 0.08071708679199219  GigaBytes

torch.Size([307, 512])
torch.Size([307, 512])
----------------------------------------after rst
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.0802450180053711  GigaBytes
Max Memory Allocated: 0.08083057403564453  GigaBytes

----------------------------------------after model layer 3 x = layer(block, x)
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.07965946197509766  GigaBytes
Max Memory Allocated: 0.08083057403564453  GigaBytes

torch.Size([307, 512])
----------------------------------------after model layer 3 x = self.activation(x)
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.0802450180053711  GigaBytes
Max Memory Allocated: 0.08083057403564453  GigaBytes

----------------------------------------after model layer 3 x = self.dropout(x)
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.08039140701293945  GigaBytes
Max Memory Allocated: 0.08097696304321289  GigaBytes

----------------input nodes number: 307
----------------output nodes number: 70
----------------edges number: 285
----------------------------------------before mean aggregator
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.08039474487304688  GigaBytes
Max Memory Allocated: 0.08097696304321289  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.08053398132324219  GigaBytes
Max Memory Allocated: 0.08097696304321289  GigaBytes

torch.Size([70, 7])
torch.Size([70, 7])
----------------------------------------after rst
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.080535888671875  GigaBytes
Max Memory Allocated: 0.08097696304321289  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.08053398132324219  GigaBytes
Max Memory Allocated: 0.08097696304321289  GigaBytes

torch.Size([70, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.08053398132324219  GigaBytes
Max Memory Allocated: 0.08097696304321289  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.0805363655090332  GigaBytes
Max Memory Allocated: 0.08097696304321289  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.03700733184814453  GigaBytes
Max Memory Allocated: 0.08362483978271484  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.060194969177246094  GigaBytes
Max Memory Allocated: 0.08362483978271484  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.060194969177246094  GigaBytes
Max Memory Allocated: 0.08362483978271484  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.007351994514465332 |0.17432034015655518 |0.4019937515258789 |0.0002046823501586914 |0.0073528289794921875 |0.0029230117797851562 |
----------------------------------------------------------pseudo_mini_loss sum 1.9500715732574463
Total (block generation + training)time/epoch 1.265321969985962
Training time/epoch 1.1922311782836914
Training time without block to device /epoch 0.843590497970581
Training time without total dataloading part /epoch 0.8220255374908447
load block tensor time/epoch 0.014703989028930664
block to device time/epoch 0.34864068031311035
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 2.384185791015625e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  16079
Number of first layer input nodes during this epoch:  4864
Number of first layer output nodes during this epoch:  4578
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=1433, out_features=512, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=512, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=512, out_features=512, bias=False)
      (fc_neigh): Linear(in_features=512, out_features=512, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=512, out_features=512, bias=False)
      (fc_neigh): Linear(in_features=512, out_features=512, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=512, out_features=512, bias=False)
      (fc_neigh): Linear(in_features=512, out_features=512, bias=False)
    )
    (4): SAGEConv(
      (fc_self): Linear(in_features=512, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=512, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  3047424
trainable parameters
layers.0.fc_self.weight, torch.Size([512, 1433])
layers.0.fc_neigh.weight, torch.Size([512, 1433])
layers.1.fc_self.weight, torch.Size([512, 512])
layers.1.fc_neigh.weight, torch.Size([512, 512])
layers.2.fc_self.weight, torch.Size([512, 512])
layers.2.fc_neigh.weight, torch.Size([512, 512])
layers.3.fc_self.weight, torch.Size([512, 512])
layers.3.fc_neigh.weight, torch.Size([512, 512])
layers.4.fc_self.weight, torch.Size([7, 512])
layers.4.fc_neigh.weight, torch.Size([7, 512])
----------------------------------------
un-trainable parameters
