main start at this time 1657005734.7031472
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 3.528594970703125e-05  GigaBytes
Max Memory Allocated: 3.528594970703125e-05  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 3.528594970703125e-05  GigaBytes
Max Memory Allocated: 3.528594970703125e-05  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 3.528594970703125e-05  GigaBytes
Max Memory Allocated: 3.528594970703125e-05  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.08755278587341309
pseudo mini batch 0 input nodes size: 849440
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 3.528594970703125e-05  GigaBytes
Max Memory Allocated: 3.528594970703125e-05  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 3.528594970703125e-05  GigaBytes
Max Memory Allocated: 3.528594970703125e-05  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.31647634506225586  GigaBytes
Max Memory Allocated: 0.31647634506225586  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.31839466094970703  GigaBytes
Max Memory Allocated: 0.31839466094970703  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.31839466094970703  GigaBytes
Max Memory Allocated: 0.31839466094970703  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.332916259765625  GigaBytes
Max Memory Allocated: 0.332916259765625  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4197998046875 GB
    Memory Allocated: 0.332916259765625  GigaBytes
Max Memory Allocated: 0.332916259765625  GigaBytes

torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9334716796875 GB
    Memory Allocated: 0.49097299575805664  GigaBytes
Max Memory Allocated: 0.525390625  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.9334716796875 GB
    Memory Allocated: 0.5253915786743164  GigaBytes
Max Memory Allocated: 0.5253920555114746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.38262414932250977  GigaBytes
Max Memory Allocated: 0.5957040786743164  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.38269472122192383  GigaBytes
Max Memory Allocated: 0.5957040786743164  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.38269472122192383  GigaBytes
Max Memory Allocated: 0.5957040786743164  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.19966363906860352 |0.34264254570007324 |0.7587833404541016 |0.0002551078796386719 |0.00895547866821289 |0.002040863037109375 |
----------------------------------------------------------pseudo_mini_loss sum 5.12290096282959
Total (block generation + training)time/epoch 1.4047935009002686
Training time/epoch 1.3169045448303223
Training time without block to device /epoch 0.974261999130249
Training time without total dataloading part /epoch 0.7700347900390625
load block tensor time/epoch 0.19966363906860352
block to device time/epoch 0.34264254570007324
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  849440
Number of first layer input nodes during this epoch:  849440
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.3826942443847656  GigaBytes
Max Memory Allocated: 0.5957040786743164  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.3826942443847656  GigaBytes
Max Memory Allocated: 0.5957040786743164  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.18385887145996094
pseudo mini batch 0 input nodes size: 847718
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.3529181480407715  GigaBytes
Max Memory Allocated: 0.5957040786743164  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.3529181480407715  GigaBytes
Max Memory Allocated: 0.5957040786743164  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.6693243980407715  GigaBytes
Max Memory Allocated: 0.6693243980407715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.6707892417907715  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3524298667907715  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.36695146560668945  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.36695146560668945  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.4913291931152344  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.5264863967895508  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38294506072998047  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38294506072998047  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38294506072998047  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.20085573196411133 |0.00868988037109375 |0.0015006065368652344 |0.0001609325408935547 |0.0011839866638183594 |0.0012645721435546875 |
----------------------------------------------------------pseudo_mini_loss sum 4.811762809753418
Total (block generation + training)time/epoch 0.9554201364517212
Training time/epoch 0.22562241554260254
Training time without block to device /epoch 0.2169325351715088
Training time without total dataloading part /epoch 0.004110097885131836
load block tensor time/epoch 0.20085573196411133
block to device time/epoch 0.00868988037109375
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  847718
Number of first layer input nodes during this epoch:  847718
Number of first layer output nodes during this epoch:  196571
----------------------------------------before generate dataloader block 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38294458389282227  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38294458389282227  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

connection checking time:  0
block generation total time  0
average batch blocks generation time:  0
block dataloader generation time/epoch 0.19039511680603027
pseudo mini batch 0 input nodes size: 848141
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3531684875488281  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3531684875488281  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.669126033782959  GigaBytes
Max Memory Allocated: 0.6707892417907715  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.6715278625488281  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3536567687988281  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3681783676147461  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.3681783676147461  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

torch.Size([196571, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.49107885360717773  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.5262360572814941  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38343334197998047  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38343334197998047  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.3201904296875 GB
    Memory Allocated: 0.38343334197998047  GigaBytes
Max Memory Allocated: 0.6715278625488281  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.12295222282409668 |0.007584571838378906 |0.002460479736328125 |0.0001761913299560547 |0.0012297630310058594 |0.0015840530395507812 |
----------------------------------------------------------pseudo_mini_loss sum 4.521127223968506
Total (block generation + training)time/epoch 0.7539467811584473
Training time/epoch 0.14734816551208496
Training time without block to device /epoch 0.13976359367370605
Training time without total dataloading part /epoch 0.00545048713684082
load block tensor time/epoch 0.12295222282409668
block to device time/epoch 0.007584571838378906
input features size transfer per epoch 1.341104507446289e-07
blocks size to device per epoch 8.940696716308594e-08
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  848141
Number of first layer input nodes during this epoch:  848141
Number of first layer output nodes during this epoch:  196571
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  9400
trainable parameters
layers.0.fc_self.weight, torch.Size([47, 100])
layers.0.fc_neigh.weight, torch.Size([47, 100])
----------------------------------------
un-trainable parameters
