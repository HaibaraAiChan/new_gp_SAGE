main start at this time 1657097952.3196974
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  602
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.0022029876708984375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.0022029876708984375  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.45699143409729004
global_2_local spend time (sec) 0.05944490432739258
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.050688982009887695
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({40: 128251, 0: 72233, 1: 1391, 2: 1221, 3: 1053, 4: 986, 5: 920, 6: 875, 7: 814, 8: 799, 11: 702, 9: 695, 13: 691, 10: 690, 12: 684, 14: 652, 15: 643, 16: 607, 19: 606, 17: 598, 18: 563, 21: 562, 22: 556, 23: 543, 20: 538, 28: 532, 27: 528, 25: 525, 26: 521, 24: 521, 32: 520, 29: 511, 30: 509, 31: 480, 33: 467, 37: 465, 38: 459, 34: 458, 36: 447, 35: 444, 39: 404})

A = g.adjacency_matrix() spent  0.0894472599029541
auxiliary_graph
Graph(num_nodes=225664, num_edges=327958581,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.1251983642578125
remove nodes length  72233

auxiliary_graph.remove_nodes spent  17.80359959602356
after remove non output nodes the auxiliary_graph
Graph(num_nodes=153431, num_edges=327958581,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  12.941048860549927

the counter of shared neighbor distribution
Counter({1.0: 289477776, 2.0: 29084900, 3.0: 5471040, 4.0: 1661006, 5.0: 743546, 6.0: 411060, 7.0: 256134, 8.0: 168238, 9.0: 115996, 10.0: 83578, 11.0: 62060, 12.0: 47414, 13.0: 37292, 14.0: 29470, 15.0: 23804, 16.0: 20196, 17.0: 16566, 18.0: 14276, 19.0: 12164, 20.0: 9978, 21.0: 8368, 22.0: 7312, 23.0: 5784, 24.0: 4890, 25.0: 4824, 26.0: 3954, 27.0: 3586, 28.0: 2934, 30.0: 2712, 29.0: 2696, 31.0: 2294, 32.0: 2068, 33.0: 1608, 35.0: 1520, 34.0: 1506, 36.0: 1012, 37.0: 674, 38.0: 532, 39.0: 382})
327805150
Convert a graph into a bidirected graph: 24.255 seconds
Metis partitioning: 74.464 seconds
Split the graph: 19.542 seconds
Construct subgraphs: 0.111 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  118.51138281822205
37750
38999
39064
37618
total k batches seeds list generation spend  193.97565150260925
after graph partition
graph partition algorithm spend time 194.60856223106384
37750
38999
39064
37618
partition_len_list
[104129, 107602, 102455, 116396]
REG selection method  spend 194.75236225128174
time for parepare:  0.027813196182250977
local_output_nid generation:  0.005574464797973633
local_in_edges_tensor generation:  0.012846946716308594
mini_batch_src_global generation:  0.04673624038696289
r_  generation:  0.399519681930542
local_output_nid generation:  0.006804227828979492
local_in_edges_tensor generation:  0.029415369033813477
mini_batch_src_global generation:  0.05719709396362305
r_  generation:  0.47486019134521484
local_output_nid generation:  0.010400772094726562
local_in_edges_tensor generation:  0.0654764175415039
mini_batch_src_global generation:  0.05373191833496094
r_  generation:  0.44240307807922363
local_output_nid generation:  0.00746917724609375
local_in_edges_tensor generation:  0.02158069610595703
mini_batch_src_global generation:  0.056665658950805664
r_  generation:  0.4784989356994629
----------------------check_connections_block total spend ----------------------------- 2.5455050468444824
generate_one_block  0.6409468650817871
generate_one_block  0.6780972480773926
generate_one_block  0.5887548923492432
generate_one_block  0.7313392162322998
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.7455687522888184
gen group dst list time:  0.012076139450073242
time for parepare:  0.031224489212036133
local_output_nid generation:  0.01824808120727539
local_in_edges_tensor generation:  0.09061241149902344
mini_batch_src_global generation:  0.08999824523925781
r_  generation:  0.9356491565704346
local_output_nid generation:  0.023163795471191406
local_in_edges_tensor generation:  0.07156729698181152
mini_batch_src_global generation:  0.11923933029174805
r_  generation:  0.9979631900787354
local_output_nid generation:  0.02398395538330078
local_in_edges_tensor generation:  0.06197524070739746
mini_batch_src_global generation:  0.11251616477966309
r_  generation:  0.9227657318115234
local_output_nid generation:  0.025859832763671875
local_in_edges_tensor generation:  0.07106733322143555
mini_batch_src_global generation:  0.12394475936889648
r_  generation:  1.0594055652618408
----------------------check_connections_block total spend ----------------------------- 5.535552024841309
generate_one_block  1.4952890872955322
generate_one_block  1.3644709587097168
generate_one_block  1.1625432968139648
generate_one_block  1.3946318626403809
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.5337052345275879
gen group dst list time:  0.045094966888427734
time for parepare:  0.03954648971557617
local_output_nid generation:  0.043672800064086914
local_in_edges_tensor generation:  0.1521766185760498
mini_batch_src_global generation:  0.16350436210632324
r_  generation:  1.6118881702423096
local_output_nid generation:  0.04741406440734863
local_in_edges_tensor generation:  0.12974810600280762
mini_batch_src_global generation:  0.21397066116333008
r_  generation:  1.570629358291626
local_output_nid generation:  0.04955339431762695
local_in_edges_tensor generation:  0.10940170288085938
mini_batch_src_global generation:  0.18607330322265625
r_  generation:  1.551393985748291
local_output_nid generation:  0.048699140548706055
local_in_edges_tensor generation:  0.14631152153015137
mini_batch_src_global generation:  0.20610952377319336
r_  generation:  1.5622296333312988
----------------------check_connections_block total spend ----------------------------- 9.105358600616455
generate_one_block  2.4192302227020264
generate_one_block  2.0744566917419434
generate_one_block  2.0665504932403564
generate_one_block  2.3045811653137207
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.2826578617095947
gen group dst list time:  0.03981947898864746
time for parepare:  0.048526763916015625
local_output_nid generation:  0.053621768951416016
local_in_edges_tensor generation:  0.08193755149841309
mini_batch_src_global generation:  0.07188773155212402
r_  generation:  0.7940313816070557
local_output_nid generation:  0.06282687187194824
local_in_edges_tensor generation:  0.08077478408813477
mini_batch_src_global generation:  0.09710693359375
r_  generation:  0.7999022006988525
local_output_nid generation:  0.058536529541015625
local_in_edges_tensor generation:  0.07765436172485352
mini_batch_src_global generation:  0.08408164978027344
r_  generation:  0.8598370552062988
local_output_nid generation:  0.06334662437438965
local_in_edges_tensor generation:  0.056672096252441406
mini_batch_src_global generation:  0.08391952514648438
r_  generation:  0.8179528713226318
----------------------check_connections_block total spend ----------------------------- 4.894621849060059
generate_one_block  1.2972519397735596
generate_one_block  0.967698335647583
generate_one_block  1.0087964534759521
generate_one_block  1.146315097808838
----------===============-------------===============-------------the number of batches *****---- 4

original number of batches:  4
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.0022029876708984375  GigaBytes

connection checking time:  22.081037521362305
block generation total time  21.340953826904297
average batch blocks generation time:  1.3338096141815186
block dataloader generation time/epoch 241.75172233581543
pseudo mini batch 0 input nodes size: 224657
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.0022029876708984375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.0022029876708984375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.5061092376708984  GigaBytes
Max Memory Allocated: 0.5061092376708984  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.5063905715942383  GigaBytes
Max Memory Allocated: 0.5063905715942383  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5233154296875 GB
    Memory Allocated: 0.5063905715942383  GigaBytes
Max Memory Allocated: 0.5063905715942383  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.593501091003418  GigaBytes
Max Memory Allocated: 0.593501091003418  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.593501091003418  GigaBytes
Max Memory Allocated: 0.593501091003418  GigaBytes

first layer input nodes number: 224657
first layer output nodes number: 222367
edges number: 2195395
----------------------------------------before model layer 0
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.596832275390625  GigaBytes
Max Memory Allocated: 0.605010986328125  GigaBytes

torch.Size([224657, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.7088623046875 GB
    Memory Allocated: 0.596832275390625  GigaBytes
Max Memory Allocated: 0.605010986328125  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.4530029296875 GB
    Memory Allocated: 1.3247699737548828  GigaBytes
Max Memory Allocated: 1.6122188568115234  GigaBytes

torch.Size([222367, 256])
torch.Size([222367, 256])
----------------------------------------after rst
 Nvidia-smi: 3.6658935546875 GB
    Memory Allocated: 1.5376605987548828  GigaBytes
Max Memory Allocated: 1.7497262954711914  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.6658935546875 GB
    Memory Allocated: 1.3255949020385742  GigaBytes
Max Memory Allocated: 1.7497262954711914  GigaBytes

torch.Size([222367, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.6658935546875 GB
    Memory Allocated: 1.5376605987548828  GigaBytes
Max Memory Allocated: 1.7497262954711914  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.6658935546875 GB
    Memory Allocated: 1.590677261352539  GigaBytes
Max Memory Allocated: 1.8027429580688477  GigaBytes

input nodes number: 222367
output nodes number: 203586
edges number: 4963616
----------------------------------------before model layer 1
 Nvidia-smi: 3.6658935546875 GB
    Memory Allocated: 1.5938515663146973  GigaBytes
Max Memory Allocated: 1.8027429580688477  GigaBytes

torch.Size([222367, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.6658935546875 GB
    Memory Allocated: 1.5938515663146973  GigaBytes
Max Memory Allocated: 1.8027429580688477  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.9549560546875 GB
    Memory Allocated: 2.020660877227783  GigaBytes
Max Memory Allocated: 2.020660877227783  GigaBytes

torch.Size([203586, 256])
torch.Size([203586, 256])
----------------------------------------after rst
 Nvidia-smi: 4.3455810546875 GB
    Memory Allocated: 2.214815616607666  GigaBytes
Max Memory Allocated: 2.408970355987549  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.3455810546875 GB
    Memory Allocated: 2.020660877227783  GigaBytes
Max Memory Allocated: 2.408970355987549  GigaBytes

torch.Size([203586, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.3455810546875 GB
    Memory Allocated: 2.214815616607666  GigaBytes
Max Memory Allocated: 2.408970355987549  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.3944091796875 GB
    Memory Allocated: 2.263643741607666  GigaBytes
Max Memory Allocated: 2.457798480987549  GigaBytes

input nodes number: 203586
output nodes number: 104129
edges number: 3026312
----------------------------------------before model layer 2
 Nvidia-smi: 4.3944091796875 GB
    Memory Allocated: 2.265937328338623  GigaBytes
Max Memory Allocated: 2.457798480987549  GigaBytes

torch.Size([203586, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 4.3944091796875 GB
    Memory Allocated: 2.265937328338623  GigaBytes
Max Memory Allocated: 2.457798480987549  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 4.4940185546875 GB
    Memory Allocated: 2.4881768226623535  GigaBytes
Max Memory Allocated: 2.4881768226623535  GigaBytes

torch.Size([104129, 256])
torch.Size([104129, 256])
----------------------------------------after rst
 Nvidia-smi: 4.6932373046875 GB
    Memory Allocated: 2.5877861976623535  GigaBytes
Max Memory Allocated: 2.6873955726623535  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 4.6932373046875 GB
    Memory Allocated: 2.488481044769287  GigaBytes
Max Memory Allocated: 2.6873955726623535  GigaBytes

torch.Size([104129, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 4.6932373046875 GB
    Memory Allocated: 2.588090419769287  GigaBytes
Max Memory Allocated: 2.6873955726623535  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 4.6932373046875 GB
    Memory Allocated: 2.612612724304199  GigaBytes
Max Memory Allocated: 2.712222099304199  GigaBytes

----------------input nodes number: 104129
----------------output nodes number: 37750
----------------edges number: 1386842
----------------------------------------before mean aggregator
 Nvidia-smi: 4.6951904296875 GB
    Memory Allocated: 2.6136703491210938  GigaBytes
Max Memory Allocated: 2.712222099304199  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 4.6951904296875 GB
    Memory Allocated: 2.6669092178344727  GigaBytes
Max Memory Allocated: 2.712222099304199  GigaBytes

torch.Size([37750, 41])
torch.Size([37750, 41])
----------------------------------------after rst
 Nvidia-smi: 4.6951904296875 GB
    Memory Allocated: 2.672675132751465  GigaBytes
Max Memory Allocated: 2.712222099304199  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.6951904296875 GB
    Memory Allocated: 2.6669092178344727  GigaBytes
Max Memory Allocated: 2.712222099304199  GigaBytes

torch.Size([37750, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.6951904296875 GB
    Memory Allocated: 2.6734261512756348  GigaBytes
Max Memory Allocated: 2.712222099304199  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.6951904296875 GB
    Memory Allocated: 2.6791930198669434  GigaBytes
Max Memory Allocated: 2.712222099304199  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 0.7737131118774414  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

pseudo mini batch 1 input nodes size: 225476
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 0.5151114463806152  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.6131591796875 GB
    Memory Allocated: 0.5151114463806152  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.1190185546875 GB
    Memory Allocated: 1.0209708213806152  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 6.1190185546875 GB
    Memory Allocated: 1.0212616920471191  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.1190185546875 GB
    Memory Allocated: 0.5170741081237793  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.1190185546875 GB
    Memory Allocated: 0.6051449775695801  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.1190185546875 GB
    Memory Allocated: 0.6051449775695801  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

first layer input nodes number: 225476
first layer output nodes number: 223385
edges number: 2202128
----------------------------------------before model layer 0
 Nvidia-smi: 6.1190185546875 GB
    Memory Allocated: 0.6086597442626953  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

torch.Size([225476, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.1190185546875 GB
    Memory Allocated: 0.6086597442626953  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.3399057388305664  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

torch.Size([223385, 256])
torch.Size([223385, 256])
----------------------------------------after rst
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.5529422760009766  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.3399057388305664  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

torch.Size([223385, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.5529422760009766  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.6062016487121582  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

input nodes number: 223385
output nodes number: 201701
edges number: 4899821
----------------------------------------before model layer 1
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.6093692779541016  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

torch.Size([223385, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 1.6093692779541016  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.032093048095703  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

torch.Size([201701, 256])
torch.Size([201701, 256])
----------------------------------------after rst
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.22445011138916  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.032093048095703  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

torch.Size([201701, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.22445011138916  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.27327823638916  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

input nodes number: 201701
output nodes number: 107602
edges number: 3117714
----------------------------------------before model layer 2
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.276092052459717  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

torch.Size([201701, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.276092052459717  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.5053582191467285  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

torch.Size([107602, 256])
torch.Size([107602, 256])
----------------------------------------after rst
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.607975482940674  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.5053582191467285  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

torch.Size([107602, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.607975482940674  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.63362979888916  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

----------------input nodes number: 107602
----------------output nodes number: 38999
----------------edges number: 1437329
----------------------------------------before mean aggregator
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.6347227096557617  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.6888723373413086  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

torch.Size([38999, 41])
torch.Size([38999, 41])
----------------------------------------after rst
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.694828987121582  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.6888723373413086  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

torch.Size([38999, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.68831205368042  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.6229248046875 GB
    Memory Allocated: 2.6942691802978516  GigaBytes
Max Memory Allocated: 2.842136859893799  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.7773346900939941  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

pseudo mini batch 2 input nodes size: 226197
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.5165138244628906  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.6268310546875 GB
    Memory Allocated: 0.5165138244628906  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 1.0243263244628906  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 1.0246176719665527  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 0.5184674263000488  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 0.6012053489685059  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 0.6012053489685059  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

first layer input nodes number: 226197
first layer output nodes number: 223676
edges number: 2196704
----------------------------------------before model layer 0
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 0.6045575141906738  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([226197, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 0.6045575141906738  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 1.3366937637329102  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([223676, 256])
torch.Size([223676, 256])
----------------------------------------after rst
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 1.5500078201293945  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 1.3366937637329102  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([223676, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 1.5500078201293945  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 1.6033363342285156  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

input nodes number: 223676
output nodes number: 194700
edges number: 4669597
----------------------------------------before model layer 1
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 1.6074895858764648  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([223676, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 1.6074895858764648  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 2.0150938034057617  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([194700, 256])
torch.Size([194700, 256])
----------------------------------------after rst
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 2.2007741928100586  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 2.0150938034057617  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([194700, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 2.2007741928100586  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 2.247194290161133  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

input nodes number: 194700
output nodes number: 102455
edges number: 2861376
----------------------------------------before model layer 2
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 2.2500929832458496  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([194700, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 2.2500929832458496  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 2.4682817459106445  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([102455, 256])
torch.Size([102455, 256])
----------------------------------------after rst
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 2.565990447998047  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 2.4682817459106445  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([102455, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 2.565990447998047  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 2.5904178619384766  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------input nodes number: 102455
----------------output nodes number: 39064
----------------edges number: 1328046
----------------------------------------before mean aggregator
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 2.591472625732422  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 2.645063877105713  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([39064, 41])
torch.Size([39064, 41])
----------------------------------------after rst
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 2.6510305404663086  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 2.645063877105713  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([39064, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 2.645073890686035  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 2.651041030883789  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 0.7659540176391602  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

pseudo mini batch 3 input nodes size: 226026
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 0.5184774398803711  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.1346435546875 GB
    Memory Allocated: 0.5184774398803711  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6424560546875 GB
    Memory Allocated: 1.026289939880371  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6424560546875 GB
    Memory Allocated: 1.0265703201293945  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6424560546875 GB
    Memory Allocated: 0.5184664726257324  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6424560546875 GB
    Memory Allocated: 0.6069331169128418  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6424560546875 GB
    Memory Allocated: 0.6069331169128418  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

first layer input nodes number: 226026
first layer output nodes number: 223984
edges number: 2206912
----------------------------------------before model layer 0
 Nvidia-smi: 7.6424560546875 GB
    Memory Allocated: 0.6104302406311035  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([226026, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.6424560546875 GB
    Memory Allocated: 0.6104302406311035  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 1.3445110321044922  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([223984, 256])
torch.Size([223984, 256])
----------------------------------------after rst
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 1.5581188201904297  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 1.3445110321044922  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([223984, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 1.5581188201904297  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 1.611520767211914  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

input nodes number: 223984
output nodes number: 201786
edges number: 4888591
----------------------------------------before model layer 1
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 1.6150178909301758  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([223984, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 1.6150178909301758  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 2.0378217697143555  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([201786, 256])
torch.Size([201786, 256])
----------------------------------------after rst
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 2.230259895324707  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 2.0378217697143555  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([201786, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 2.230259895324707  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 2.279088020324707  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

input nodes number: 201786
output nodes number: 116396
edges number: 3378579
----------------------------------------before model layer 2
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 2.281458854675293  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([201786, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 2.281458854675293  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 2.529507637023926  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([116396, 256])
torch.Size([116396, 256])
----------------------------------------after rst
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 2.6405115127563477  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 2.529507637023926  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([116396, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 2.6405115127563477  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 2.668262481689453  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------input nodes number: 116396
----------------output nodes number: 37618
----------------edges number: 1399303
----------------------------------------before mean aggregator
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 2.669410228729248  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 2.721738338470459  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([37618, 41])
torch.Size([37618, 41])
----------------------------------------after rst
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 2.7274842262268066  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 2.721738338470459  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

torch.Size([37618, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 2.721517562866211  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 2.727263927459717  GigaBytes
Max Memory Allocated: 2.8621087074279785  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6444091796875 GB
    Memory Allocated: 0.7843480110168457  GigaBytes
Max Memory Allocated: 2.9135079383850098  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 7.6502685546875 GB
    Memory Allocated: 0.7887539863586426  GigaBytes
Max Memory Allocated: 2.9135079383850098  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.6502685546875 GB
    Memory Allocated: 0.7887539863586426  GigaBytes
Max Memory Allocated: 2.9135079383850098  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1952022910118103 |0.1565534472465515 |0.2554472088813782 |0.00019872188568115234 |0.03586763143539429 |0.00619196891784668 |
----------------------------------------------------------pseudo_mini_loss sum 19.300525665283203
Total (block generation + training)time/epoch 244.36461520195007
Training time/epoch 2.6125705242156982
Training time without block to device /epoch 1.9863567352294922
Training time without total dataloading part /epoch 1.1722462177276611
load block tensor time/epoch 0.7808091640472412
block to device time/epoch 0.626213788986206
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3028123
Number of first layer input nodes during this epoch:  902356
Number of first layer output nodes during this epoch:  893412
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=602, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=602, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=41, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=41, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  591360
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 602])
layers.0.fc_neigh.weight, torch.Size([256, 602])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([41, 256])
layers.3.fc_neigh.weight, torch.Size([41, 256])
----------------------------------------
un-trainable parameters
