main start at this time 1657101244.7413075
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00372314453125  GigaBytes
Max Memory Allocated: 0.00372314453125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00372314453125  GigaBytes
Max Memory Allocated: 0.00372314453125  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.0012853145599365234
global_2_local spend time (sec) 0.00017189979553222656
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0008001327514648438
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 504, 3: 26, 2: 25, 4: 22, 1: 20, 5: 15, 6: 11, 7: 4, 9: 4, 8: 3, 10: 3, 12: 2, 11: 1, 21: 1, 19: 1, 36: 1, 32: 1})

A = g.adjacency_matrix() spent  0.0004582405090332031
auxiliary_graph
Graph(num_nodes=644, num_edges=438,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.0007462501525878906
remove nodes length  504

auxiliary_graph.remove_nodes spent  0.0011706352233886719
after remove non output nodes the auxiliary_graph
Graph(num_nodes=140, num_edges=438,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  0.0008528232574462891

the counter of shared neighbor distribution
Counter({1.0: 252, 2.0: 30, 3.0: 14, 4.0: 2})
298
Convert a graph into a bidirected graph: 0.000 seconds
Metis partitioning: 0.000 seconds
Split the graph: 0.001 seconds
Construct subgraphs: 0.001 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  0.002263307571411133
34
35
36
35
total k batches seeds list generation spend  0.01207733154296875
after graph partition
graph partition algorithm spend time 0.09717392921447754
34
35
36
35
partition_len_list
[138, 202, 171, 146]
REG selection method  spend 0.09757232666015625
time for parepare:  6.198883056640625e-05
local_output_nid generation:  5.4836273193359375e-06
local_in_edges_tensor generation:  0.00011014938354492188
mini_batch_src_global generation:  3.0517578125e-05
r_  generation:  6.175041198730469e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010538101196289062
mini_batch_src_global generation:  2.47955322265625e-05
r_  generation:  8.440017700195312e-05
local_output_nid generation:  4.5299530029296875e-06
local_in_edges_tensor generation:  0.00010418891906738281
mini_batch_src_global generation:  2.1696090698242188e-05
r_  generation:  7.343292236328125e-05
local_output_nid generation:  4.291534423828125e-06
local_in_edges_tensor generation:  0.00010323524475097656
mini_batch_src_global generation:  1.9073486328125e-05
r_  generation:  4.935264587402344e-05
----------------------check_connections_block total spend ----------------------------- 0.0010974407196044922
generate_one_block  0.0015163421630859375
generate_one_block  0.0011489391326904297
generate_one_block  0.001115560531616211
generate_one_block  0.0010793209075927734
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0005125999450683594
gen group dst list time:  4.363059997558594e-05
time for parepare:  0.0001609325408935547
local_output_nid generation:  1.1920928955078125e-05
local_in_edges_tensor generation:  0.00018739700317382812
mini_batch_src_global generation:  3.7670135498046875e-05
r_  generation:  0.0002646446228027344
local_output_nid generation:  1.6689300537109375e-05
local_in_edges_tensor generation:  0.0001361370086669922
mini_batch_src_global generation:  5.1021575927734375e-05
r_  generation:  0.0004074573516845703
local_output_nid generation:  1.5735626220703125e-05
local_in_edges_tensor generation:  0.00013136863708496094
mini_batch_src_global generation:  5.054473876953125e-05
r_  generation:  0.0003352165222167969
local_output_nid generation:  1.2874603271484375e-05
local_in_edges_tensor generation:  0.0001239776611328125
mini_batch_src_global generation:  3.910064697265625e-05
r_  generation:  0.0002434253692626953
----------------------check_connections_block total spend ----------------------------- 0.002652406692504883
generate_one_block  0.0014159679412841797
generate_one_block  0.0014853477478027344
generate_one_block  0.001407623291015625
generate_one_block  0.0012874603271484375
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0005669593811035156
gen group dst list time:  6.151199340820312e-05
time for parepare:  0.00017142295837402344
local_output_nid generation:  3.409385681152344e-05
local_in_edges_tensor generation:  0.0002446174621582031
mini_batch_src_global generation:  7.843971252441406e-05
r_  generation:  0.0007884502410888672
local_output_nid generation:  7.843971252441406e-05
local_in_edges_tensor generation:  0.00020051002502441406
mini_batch_src_global generation:  0.0001285076141357422
r_  generation:  0.001127004623413086
local_output_nid generation:  3.552436828613281e-05
local_in_edges_tensor generation:  0.00016760826110839844
mini_batch_src_global generation:  9.703636169433594e-05
r_  generation:  0.0007786750793457031
local_output_nid generation:  3.0279159545898438e-05
local_in_edges_tensor generation:  0.00015616416931152344
mini_batch_src_global generation:  7.486343383789062e-05
r_  generation:  0.0006542205810546875
----------------------check_connections_block total spend ----------------------------- 0.005768299102783203
generate_one_block  0.001977682113647461
generate_one_block  0.0023021697998046875
generate_one_block  0.0019369125366210938
generate_one_block  0.0018017292022705078
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0007243156433105469
gen group dst list time:  0.00010395050048828125
time for parepare:  0.00018548965454101562
local_output_nid generation:  7.43865966796875e-05
local_in_edges_tensor generation:  0.00033473968505859375
mini_batch_src_global generation:  0.0001251697540283203
r_  generation:  0.0016200542449951172
local_output_nid generation:  9.679794311523438e-05
local_in_edges_tensor generation:  0.0002779960632324219
mini_batch_src_global generation:  0.0002346038818359375
r_  generation:  0.0019195079803466797
local_output_nid generation:  7.724761962890625e-05
local_in_edges_tensor generation:  0.0002295970916748047
mini_batch_src_global generation:  0.00019240379333496094
r_  generation:  0.0015447139739990234
local_output_nid generation:  7.033348083496094e-05
local_in_edges_tensor generation:  0.00021886825561523438
mini_batch_src_global generation:  0.00013637542724609375
r_  generation:  0.0014071464538574219
----------------------check_connections_block total spend ----------------------------- 0.010460853576660156
generate_one_block  0.0028858184814453125
generate_one_block  0.0030868053436279297
generate_one_block  0.002638578414916992
generate_one_block  0.002496957778930664
----------===============-------------===============-------------the number of batches *****---- 4

original number of batches:  4
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00372314453125  GigaBytes
Max Memory Allocated: 0.00372314453125  GigaBytes

connection checking time:  0.019979000091552734
block generation total time  0.029583215713500977
average batch blocks generation time:  0.001848950982093811
block dataloader generation time/epoch 0.15806365013122559
pseudo mini batch 0 input nodes size: 1823
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00372314453125  GigaBytes
Max Memory Allocated: 0.00372314453125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00372314453125  GigaBytes
Max Memory Allocated: 0.00372314453125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.013455390930175781  GigaBytes
Max Memory Allocated: 0.013455390930175781  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.013455867767333984  GigaBytes
Max Memory Allocated: 0.013455867767333984  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.013455867767333984  GigaBytes
Max Memory Allocated: 0.013455867767333984  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.013516902923583984  GigaBytes
Max Memory Allocated: 0.013516902923583984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.013516902923583984  GigaBytes
Max Memory Allocated: 0.013516902923583984  GigaBytes

first layer input nodes number: 1823
first layer output nodes number: 1127
edges number: 4852
----------------------------------------before model layer 0
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.013539314270019531  GigaBytes
Max Memory Allocated: 0.01355743408203125  GigaBytes

torch.Size([1823, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.013539314270019531  GigaBytes
Max Memory Allocated: 0.01355743408203125  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.020671367645263672  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

torch.Size([1127, 256])
torch.Size([1127, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.021746158599853516  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.020671367645263672  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

torch.Size([1127, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.021746158599853516  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.022015094757080078  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

input nodes number: 1127
output nodes number: 493
edges number: 2416
----------------------------------------before model layer 1
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.02202749252319336  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

torch.Size([1127, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.02202749252319336  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.022989749908447266  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

torch.Size([493, 256])
torch.Size([493, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.023459911346435547  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.022989749908447266  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

torch.Size([493, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.023459911346435547  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02357769012451172  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

input nodes number: 493
output nodes number: 138
edges number: 746
----------------------------------------before model layer 2
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.023582935333251953  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

torch.Size([493, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.023582935333251953  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.023853778839111328  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

torch.Size([138, 256])
torch.Size([138, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02398538589477539  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.023853778839111328  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

torch.Size([138, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02398538589477539  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.024018287658691406  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

----------------input nodes number: 138
----------------output nodes number: 34
----------------edges number: 119
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02402019500732422  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02405548095703125  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

torch.Size([34, 7])
torch.Size([34, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.024056434631347656  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02405548095703125  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

torch.Size([34, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.024056434631347656  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02405834197998047  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01738452911376953  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

pseudo mini batch 1 input nodes size: 1947
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017180919647216797  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017180919647216797  GigaBytes
Max Memory Allocated: 0.025617599487304688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.027575016021728516  GigaBytes
Max Memory Allocated: 0.027575016021728516  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02757549285888672  GigaBytes
Max Memory Allocated: 0.02757549285888672  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017842769622802734  GigaBytes
Max Memory Allocated: 0.02757549285888672  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017923831939697266  GigaBytes
Max Memory Allocated: 0.02757549285888672  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.017923831939697266  GigaBytes
Max Memory Allocated: 0.02757549285888672  GigaBytes

first layer input nodes number: 1947
first layer output nodes number: 1386
edges number: 5825
----------------------------------------before model layer 0
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01794910430908203  GigaBytes
Max Memory Allocated: 0.02757549285888672  GigaBytes

torch.Size([1947, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01794910430908203  GigaBytes
Max Memory Allocated: 0.02757549285888672  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02758026123046875  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([1386, 256])
torch.Size([1386, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028902053833007812  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.026719093322753906  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([1386, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02804088592529297  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028888702392578125  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

input nodes number: 1386
output nodes number: 658
edges number: 3411
----------------------------------------before model layer 1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028904438018798828  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([1386, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.028904438018798828  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.03019094467163086  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([658, 256])
torch.Size([658, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.030818462371826172  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.03019094467163086  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([658, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.030818462371826172  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.030975341796875  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

input nodes number: 658
output nodes number: 202
edges number: 1247
----------------------------------------before model layer 2
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.030982494354248047  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([658, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.030982494354248047  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.03137922286987305  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([202, 256])
torch.Size([202, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.03157186508178711  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.03137922286987305  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([202, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.03157186508178711  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.031620025634765625  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------input nodes number: 202
----------------output nodes number: 35
----------------edges number: 210
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.03162240982055664  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.031659603118896484  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([35, 7])
torch.Size([35, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.03166055679321289  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.031659603118896484  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([35, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.031659603118896484  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.031661033630371094  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.018111228942871094  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

pseudo mini batch 2 input nodes size: 1717
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.017842769622802734  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.017842769622802734  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.027009010314941406  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02700948715209961  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.016614913940429688  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.0166778564453125  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.0166778564453125  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

first layer input nodes number: 1717
first layer output nodes number: 1035
edges number: 4623
----------------------------------------before model layer 0
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.016698837280273438  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([1717, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.016698837280273438  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.023251056671142578  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([1035, 256])
torch.Size([1035, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.024238109588623047  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.023251056671142578  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([1035, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.024979591369628906  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.024485111236572266  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

input nodes number: 1035
output nodes number: 443
edges number: 2396
----------------------------------------before model layer 1
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02449655532836914  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([1035, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02449655532836914  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025363445281982422  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([443, 256])
torch.Size([443, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02578592300415039  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025363445281982422  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([443, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02578592300415039  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025891780853271484  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

input nodes number: 443
output nodes number: 171
edges number: 989
----------------------------------------before model layer 2
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025896549224853516  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([443, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025896549224853516  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.026232242584228516  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([171, 256])
torch.Size([171, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.026395320892333984  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.026232242584228516  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([171, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.026395320892333984  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.026436328887939453  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------input nodes number: 171
----------------output nodes number: 36
----------------edges number: 189
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.026438236236572266  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.026476383209228516  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([36, 7])
torch.Size([36, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.026477336883544922  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.026476383209228516  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([36, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.026476383209228516  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.026477813720703125  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.016822338104248047  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

pseudo mini batch 3 input nodes size: 1660
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.016614913940429688  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.016614913940429688  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025476932525634766  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02547740936279297  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.016310691833496094  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.016363143920898438  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.016363143920898438  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

first layer input nodes number: 1660
first layer output nodes number: 949
edges number: 4248
----------------------------------------before model layer 0
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.016382694244384766  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([1660, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.016382694244384766  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.022926807403564453  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([949, 256])
torch.Size([949, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.023831844329833984  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.022926807403564453  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([949, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.023831844329833984  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02405834197998047  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

input nodes number: 949
output nodes number: 356
edges number: 1888
----------------------------------------before model layer 1
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.024068355560302734  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([949, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.024068355560302734  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.024764537811279297  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([356, 256])
torch.Size([356, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025104045867919922  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.024764537811279297  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([356, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025104045867919922  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025188922882080078  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

input nodes number: 356
output nodes number: 146
edges number: 634
----------------------------------------before model layer 2
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025193214416503906  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([356, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025193214416503906  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025478363037109375  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([146, 256])
torch.Size([146, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025617599487304688  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025478363037109375  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([146, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025617599487304688  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025652408599853516  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------input nodes number: 146
----------------output nodes number: 35
----------------edges number: 120
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025654315948486328  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025690555572509766  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([35, 7])
torch.Size([35, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025691509246826172  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025690555572509766  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

torch.Size([35, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025690555572509766  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.025691986083984375  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.01648426055908203  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02474689483642578  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.2967529296875 GB
    Memory Allocated: 0.02474689483642578  GigaBytes
Max Memory Allocated: 0.03280162811279297  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.010473370552062988 |0.08648449182510376 |0.2049555778503418 |0.00016313791275024414 |0.00432056188583374 |0.0017254352569580078 |
----------------------------------------------------------pseudo_mini_loss sum 1.964450716972351
Total (block generation + training)time/epoch 1.3976809978485107
Training time/epoch 1.2394261360168457
Training time without block to device /epoch 0.8934881687164307
Training time without total dataloading part /epoch 0.8394825458526611
load block tensor time/epoch 0.04189348220825195
block to device time/epoch 0.34593796730041504
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  14251
Number of first layer input nodes during this epoch:  7147
Number of first layer output nodes during this epoch:  4497
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=1433, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  999424
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 1433])
layers.0.fc_neigh.weight, torch.Size([256, 1433])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([7, 256])
layers.3.fc_neigh.weight, torch.Size([7, 256])
----------------------------------------
un-trainable parameters
