main start at this time 1657071818.4012237
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.03738045692443848
global_2_local spend time (sec) 0.03526043891906738
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0048253536224365234
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 64794, 1: 13428, 2: 11706, 3: 9277, 30: 7479, 4: 7320, 5: 6222, 6: 4868, 7: 4045, 8: 3472, 9: 2976, 10: 2599, 11: 2203, 12: 1937, 13: 1656, 14: 1434, 15: 1289, 16: 1111, 17: 1030, 18: 948, 19: 836, 20: 807, 21: 717, 22: 556, 24: 525, 23: 519, 25: 483, 26: 409, 27: 390, 28: 370, 29: 329})

A = g.adjacency_matrix() spent  0.008972406387329102
auxiliary_graph
Graph(num_nodes=155735, num_edges=31735755,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.08776736259460449
remove nodes length  64794

auxiliary_graph.remove_nodes spent  1.39499831199646
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=31735755,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.5977637767791748

the counter of shared neighbor distribution
Counter({1.0: 25124188, 2.0: 4626802, 3.0: 1218314, 4.0: 388536, 5.0: 147564, 6.0: 65410, 7.0: 32316, 8.0: 17018, 9.0: 9606, 10.0: 5710, 11.0: 3458, 12.0: 2188, 13.0: 1298, 14.0: 804, 15.0: 550, 16.0: 350, 17.0: 250, 18.0: 152, 19.0: 130, 20.0: 70, 21.0: 38, 22.0: 38, 23.0: 16, 24.0: 4, 25.0: 4})
31644814
Convert a graph into a bidirected graph: 1.367 seconds
Metis partitioning: 5.445 seconds
Split the graph: 2.207 seconds
Construct subgraphs: 0.089 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  9.123323440551758
11174
11128
11330
11035
11596
11481
11605
11592
total k batches seeds list generation spend  16.74136209487915
after graph partition
graph partition algorithm spend time 16.838764190673828
11174
11128
11330
11035
11596
11481
11605
11592
partition_len_list
[28710, 35744, 42241, 48851, 20587, 21707, 25380, 19976]
REG selection method  spend 16.920809745788574
time for parepare:  0.01698160171508789
local_output_nid generation:  0.0018687248229980469
local_in_edges_tensor generation:  0.0021255016326904297
mini_batch_src_global generation:  0.002576112747192383
r_  generation:  0.025279521942138672
local_output_nid generation:  0.0026290416717529297
local_in_edges_tensor generation:  0.0026972293853759766
mini_batch_src_global generation:  0.0032842159271240234
r_  generation:  0.028778791427612305
local_output_nid generation:  0.002950906753540039
local_in_edges_tensor generation:  0.0032317638397216797
mini_batch_src_global generation:  0.005078792572021484
r_  generation:  0.04659247398376465
local_output_nid generation:  0.003216981887817383
local_in_edges_tensor generation:  0.003032684326171875
mini_batch_src_global generation:  0.0044672489166259766
r_  generation:  0.04416227340698242
local_output_nid generation:  0.0034286975860595703
local_in_edges_tensor generation:  0.0023336410522460938
mini_batch_src_global generation:  0.003740072250366211
r_  generation:  0.0339045524597168
local_output_nid generation:  0.0032100677490234375
local_in_edges_tensor generation:  0.002173185348510742
mini_batch_src_global generation:  0.0028328895568847656
r_  generation:  0.029896259307861328
local_output_nid generation:  0.003104686737060547
local_in_edges_tensor generation:  0.002127408981323242
mini_batch_src_global generation:  0.003104686737060547
r_  generation:  0.03332257270812988
local_output_nid generation:  0.003076314926147461
local_in_edges_tensor generation:  0.0020427703857421875
mini_batch_src_global generation:  0.0024471282958984375
r_  generation:  0.025796175003051758
----------------------check_connections_block total spend ----------------------------- 0.4225633144378662
generate_one_block  0.04138946533203125
generate_one_block  0.0395357608795166
generate_one_block  0.06712937355041504
generate_one_block  0.05965924263000488
generate_one_block  0.04333066940307617
generate_one_block  0.038507699966430664
generate_one_block  0.04293417930603027
generate_one_block  0.036081790924072266
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.05568575859069824
gen group dst list time:  0.006700992584228516
time for parepare:  0.022763729095458984
local_output_nid generation:  0.005133867263793945
local_in_edges_tensor generation:  0.015286445617675781
mini_batch_src_global generation:  0.008310556411743164
r_  generation:  0.08718609809875488
local_output_nid generation:  0.009368181228637695
local_in_edges_tensor generation:  0.013036966323852539
mini_batch_src_global generation:  0.01452779769897461
r_  generation:  0.13213419914245605
local_output_nid generation:  0.009647607803344727
local_in_edges_tensor generation:  0.015193700790405273
mini_batch_src_global generation:  0.021144390106201172
r_  generation:  0.1920475959777832
local_output_nid generation:  0.011001110076904297
local_in_edges_tensor generation:  0.015631437301635742
mini_batch_src_global generation:  0.026053905487060547
r_  generation:  0.21876931190490723
local_output_nid generation:  0.005239725112915039
local_in_edges_tensor generation:  0.004786491394042969
mini_batch_src_global generation:  0.011541128158569336
r_  generation:  0.06457901000976562
local_output_nid generation:  0.005357265472412109
local_in_edges_tensor generation:  0.004904508590698242
mini_batch_src_global generation:  0.007031679153442383
r_  generation:  0.06135439872741699
local_output_nid generation:  0.006124973297119141
local_in_edges_tensor generation:  0.005636930465698242
mini_batch_src_global generation:  0.008900642395019531
r_  generation:  0.08377337455749512
local_output_nid generation:  0.00501251220703125
local_in_edges_tensor generation:  0.004394054412841797
mini_batch_src_global generation:  0.005925893783569336
r_  generation:  0.04726743698120117
----------------------check_connections_block total spend ----------------------------- 1.349778175354004
generate_one_block  0.15053510665893555
generate_one_block  0.17247939109802246
generate_one_block  0.2656373977661133
generate_one_block  0.29306483268737793
generate_one_block  0.08183765411376953
generate_one_block  0.0778355598449707
generate_one_block  0.1028444766998291
generate_one_block  0.05719423294067383
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.03259110450744629
gen group dst list time:  0.018555402755737305
time for parepare:  0.020967960357666016
local_output_nid generation:  0.0147705078125
local_in_edges_tensor generation:  0.04684805870056152
mini_batch_src_global generation:  0.01829671859741211
r_  generation:  0.19267678260803223
local_output_nid generation:  0.021238327026367188
local_in_edges_tensor generation:  0.02582240104675293
mini_batch_src_global generation:  0.02790093421936035
r_  generation:  0.2342076301574707
local_output_nid generation:  0.01804065704345703
local_in_edges_tensor generation:  0.017678499221801758
mini_batch_src_global generation:  0.023196697235107422
r_  generation:  0.21708083152770996
local_output_nid generation:  0.021733522415161133
local_in_edges_tensor generation:  0.022489547729492188
mini_batch_src_global generation:  0.02699756622314453
r_  generation:  0.25349855422973633
local_output_nid generation:  0.009497642517089844
local_in_edges_tensor generation:  0.008072137832641602
mini_batch_src_global generation:  0.013220071792602539
r_  generation:  0.09466838836669922
local_output_nid generation:  0.012221813201904297
local_in_edges_tensor generation:  0.011384963989257812
mini_batch_src_global generation:  0.01229715347290039
r_  generation:  0.10611128807067871
local_output_nid generation:  0.01510930061340332
local_in_edges_tensor generation:  0.01272726058959961
mini_batch_src_global generation:  0.015475273132324219
r_  generation:  0.16846251487731934
local_output_nid generation:  0.009593725204467773
local_in_edges_tensor generation:  0.011419057846069336
mini_batch_src_global generation:  0.01106572151184082
r_  generation:  0.07930827140808105
----------------------check_connections_block total spend ----------------------------- 2.1172399520874023
generate_one_block  0.2612791061401367
generate_one_block  0.2950108051300049
generate_one_block  0.2689075469970703
generate_one_block  0.3324706554412842
generate_one_block  0.10837316513061523
generate_one_block  0.13172483444213867
generate_one_block  0.1804511547088623
generate_one_block  0.09287357330322266
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

connection checking time:  3.8895814418792725
block generation total time  3.2410876750946045
average batch blocks generation time:  0.13504531979560852
block dataloader generation time/epoch 24.423850774765015
pseudo mini batch 0 input nodes size: 123349
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0780029296875 GB
    Memory Allocated: 0.059626102447509766  GigaBytes
Max Memory Allocated: 0.059626102447509766  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0780029296875 GB
    Memory Allocated: 0.05970954895019531  GigaBytes
Max Memory Allocated: 0.05970954895019531  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0780029296875 GB
    Memory Allocated: 0.05970954895019531  GigaBytes
Max Memory Allocated: 0.05970954895019531  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1619873046875 GB
    Memory Allocated: 0.06705999374389648  GigaBytes
Max Memory Allocated: 0.06705999374389648  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1619873046875 GB
    Memory Allocated: 0.06705999374389648  GigaBytes
Max Memory Allocated: 0.06705999374389648  GigaBytes

first layer input nodes number: 123349
first layer output nodes number: 76293
edges number: 549904
----------------------------------------before model layer 0
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06854820251464844  GigaBytes
Max Memory Allocated: 0.07059717178344727  GigaBytes

torch.Size([123349, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.06854820251464844  GigaBytes
Max Memory Allocated: 0.07059717178344727  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.5194091796875 GB
    Memory Allocated: 0.1827988624572754  GigaBytes
Max Memory Allocated: 0.1827988624572754  GigaBytes

torch.Size([76293, 256])
torch.Size([76293, 256])
----------------------------------------after rst
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.2555575370788574  GigaBytes
Max Memory Allocated: 0.32831621170043945  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.1827988624572754  GigaBytes
Max Memory Allocated: 0.32831621170043945  GigaBytes

torch.Size([76293, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.2555575370788574  GigaBytes
Max Memory Allocated: 0.32831621170043945  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.27374744415283203  GigaBytes
Max Memory Allocated: 0.34650611877441406  GigaBytes

input nodes number: 76293
output nodes number: 28710
edges number: 264700
----------------------------------------before model layer 1
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.27453041076660156  GigaBytes
Max Memory Allocated: 0.34650611877441406  GigaBytes

torch.Size([76293, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.27453041076660156  GigaBytes
Max Memory Allocated: 0.34650611877441406  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.3324251174926758  GigaBytes
Max Memory Allocated: 0.34650611877441406  GigaBytes

torch.Size([28710, 256])
torch.Size([28710, 256])
----------------------------------------after rst
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.3598051071166992  GigaBytes
Max Memory Allocated: 0.38718509674072266  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.3324251174926758  GigaBytes
Max Memory Allocated: 0.38718509674072266  GigaBytes

torch.Size([28710, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.3598051071166992  GigaBytes
Max Memory Allocated: 0.38718509674072266  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.3666501045227051  GigaBytes
Max Memory Allocated: 0.3940300941467285  GigaBytes

----------------input nodes number: 28710
----------------output nodes number: 11174
----------------edges number: 72059
----------------------------------------before mean aggregator
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.36694765090942383  GigaBytes
Max Memory Allocated: 0.3940300941467285  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.3801417350769043  GigaBytes
Max Memory Allocated: 0.3940300941467285  GigaBytes

torch.Size([11174, 40])
torch.Size([11174, 40])
----------------------------------------after rst
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.3818068504333496  GigaBytes
Max Memory Allocated: 0.3940300941467285  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.37988996505737305  GigaBytes
Max Memory Allocated: 0.3940300941467285  GigaBytes

torch.Size([11174, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.3817291259765625  GigaBytes
Max Memory Allocated: 0.3940300941467285  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.38364696502685547  GigaBytes
Max Memory Allocated: 0.3940300941467285  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9061279296875 GB
    Memory Allocated: 0.08378887176513672  GigaBytes
Max Memory Allocated: 0.42987871170043945  GigaBytes

pseudo mini batch 1 input nodes size: 123851
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9061279296875 GB
    Memory Allocated: 0.06235837936401367  GigaBytes
Max Memory Allocated: 0.42987871170043945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9061279296875 GB
    Memory Allocated: 0.06235837936401367  GigaBytes
Max Memory Allocated: 0.42987871170043945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9061279296875 GB
    Memory Allocated: 0.1214151382446289  GigaBytes
Max Memory Allocated: 0.42987871170043945  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9061279296875 GB
    Memory Allocated: 0.12149810791015625  GigaBytes
Max Memory Allocated: 0.42987871170043945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9061279296875 GB
    Memory Allocated: 0.06259727478027344  GigaBytes
Max Memory Allocated: 0.42987871170043945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9061279296875 GB
    Memory Allocated: 0.07108879089355469  GigaBytes
Max Memory Allocated: 0.42987871170043945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9061279296875 GB
    Memory Allocated: 0.07108879089355469  GigaBytes
Max Memory Allocated: 0.42987871170043945  GigaBytes

first layer input nodes number: 123851
first layer output nodes number: 86913
edges number: 651983
----------------------------------------before model layer 0
 Nvidia-smi: 1.9061279296875 GB
    Memory Allocated: 0.07265996932983398  GigaBytes
Max Memory Allocated: 0.42987871170043945  GigaBytes

torch.Size([123851, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.9061279296875 GB
    Memory Allocated: 0.07265996932983398  GigaBytes
Max Memory Allocated: 0.42987871170043945  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.9959716796875 GB
    Memory Allocated: 0.20217227935791016  GigaBytes
Max Memory Allocated: 0.42987871170043945  GigaBytes

torch.Size([86913, 256])
torch.Size([86913, 256])
----------------------------------------after rst
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.28505897521972656  GigaBytes
Max Memory Allocated: 0.42987871170043945  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.20217227935791016  GigaBytes
Max Memory Allocated: 0.42987871170043945  GigaBytes

torch.Size([86913, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.28505897521972656  GigaBytes
Max Memory Allocated: 0.42987871170043945  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.30578088760375977  GigaBytes
Max Memory Allocated: 0.42987871170043945  GigaBytes

input nodes number: 86913
output nodes number: 35744
edges number: 407201
----------------------------------------before model layer 1
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.30669546127319336  GigaBytes
Max Memory Allocated: 0.42987871170043945  GigaBytes

torch.Size([86913, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.30669546127319336  GigaBytes
Max Memory Allocated: 0.42987871170043945  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.37906742095947266  GigaBytes
Max Memory Allocated: 0.42987871170043945  GigaBytes

torch.Size([35744, 256])
torch.Size([35744, 256])
----------------------------------------after rst
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.41315555572509766  GigaBytes
Max Memory Allocated: 0.44724369049072266  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.37906742095947266  GigaBytes
Max Memory Allocated: 0.44724369049072266  GigaBytes

torch.Size([35744, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.41315555572509766  GigaBytes
Max Memory Allocated: 0.44724369049072266  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.42173051834106445  GigaBytes
Max Memory Allocated: 0.45581865310668945  GigaBytes

----------------input nodes number: 35744
----------------output nodes number: 11128
----------------edges number: 80279
----------------------------------------before mean aggregator
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.42208003997802734  GigaBytes
Max Memory Allocated: 0.45581865310668945  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.1658935546875 GB
    Memory Allocated: 0.43503284454345703  GigaBytes
Max Memory Allocated: 0.45581865310668945  GigaBytes

torch.Size([11128, 40])
torch.Size([11128, 40])
----------------------------------------after rst
 Nvidia-smi: 2.1658935546875 GB
    Memory Allocated: 0.4366912841796875  GigaBytes
Max Memory Allocated: 0.45581865310668945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.1658935546875 GB
    Memory Allocated: 0.43503284454345703  GigaBytes
Max Memory Allocated: 0.45581865310668945  GigaBytes

torch.Size([11128, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.1658935546875 GB
    Memory Allocated: 0.43485212326049805  GigaBytes
Max Memory Allocated: 0.45581865310668945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.1658935546875 GB
    Memory Allocated: 0.4365110397338867  GigaBytes
Max Memory Allocated: 0.45581865310668945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.08771944046020508  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

pseudo mini batch 2 input nodes size: 107731
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.06241655349731445  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.06241655349731445  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.11378669738769531  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.11387157440185547  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.05473184585571289  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.06502580642700195  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.06502580642700195  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

first layer input nodes number: 107731
first layer output nodes number: 77371
edges number: 610357
----------------------------------------before model layer 0
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.0664052963256836  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

torch.Size([107731, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.0664052963256836  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.1825699806213379  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

torch.Size([77371, 256])
torch.Size([77371, 256])
----------------------------------------after rst
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.2567887306213379  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.1825699806213379  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

torch.Size([77371, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.2567887306213379  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.275235652923584  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

input nodes number: 77371
output nodes number: 42241
edges number: 623072
----------------------------------------before model layer 1
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.27612733840942383  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

torch.Size([77371, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.27612733840942383  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.36165380477905273  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

torch.Size([42241, 256])
torch.Size([42241, 256])
----------------------------------------after rst
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.40193796157836914  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.36165380477905273  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

torch.Size([42241, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.40193796157836914  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.41278791427612305  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

----------------input nodes number: 42241
----------------output nodes number: 11330
----------------edges number: 147985
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.41318798065185547  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.4272184371948242  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

torch.Size([11330, 40])
torch.Size([11330, 40])
----------------------------------------after rst
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.42947864532470703  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.4274415969848633  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

torch.Size([11330, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.42782020568847656  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.4299306869506836  GigaBytes
Max Memory Allocated: 0.49144887924194336  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.08505058288574219  GigaBytes
Max Memory Allocated: 0.49654245376586914  GigaBytes

pseudo mini batch 3 input nodes size: 124436
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.05511045455932617  GigaBytes
Max Memory Allocated: 0.49654245376586914  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.05511045455932617  GigaBytes
Max Memory Allocated: 0.49654245376586914  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.11444616317749023  GigaBytes
Max Memory Allocated: 0.49654245376586914  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.11452865600585938  GigaBytes
Max Memory Allocated: 0.49654245376586914  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.06307363510131836  GigaBytes
Max Memory Allocated: 0.49654245376586914  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.07543087005615234  GigaBytes
Max Memory Allocated: 0.49654245376586914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.07543087005615234  GigaBytes
Max Memory Allocated: 0.49654245376586914  GigaBytes

first layer input nodes number: 124436
first layer output nodes number: 93543
edges number: 715240
----------------------------------------before model layer 0
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.07705545425415039  GigaBytes
Max Memory Allocated: 0.49654245376586914  GigaBytes

torch.Size([124436, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 0.07705545425415039  GigaBytes
Max Memory Allocated: 0.49654245376586914  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4256591796875 GB
    Memory Allocated: 0.21792888641357422  GigaBytes
Max Memory Allocated: 0.49654245376586914  GigaBytes

torch.Size([93543, 256])
torch.Size([93543, 256])
----------------------------------------after rst
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 0.3077726364135742  GigaBytes
Max Memory Allocated: 0.49654245376586914  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 0.21792888641357422  GigaBytes
Max Memory Allocated: 0.49654245376586914  GigaBytes

torch.Size([93543, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 0.3077726364135742  GigaBytes
Max Memory Allocated: 0.49654245376586914  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 0.3300752639770508  GigaBytes
Max Memory Allocated: 0.49654245376586914  GigaBytes

input nodes number: 93543
output nodes number: 48851
edges number: 689760
----------------------------------------before model layer 1
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 0.33113670349121094  GigaBytes
Max Memory Allocated: 0.49654245376586914  GigaBytes

torch.Size([93543, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.6053466796875 GB
    Memory Allocated: 0.33113670349121094  GigaBytes
Max Memory Allocated: 0.49654245376586914  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.42981624603271484  GigaBytes
Max Memory Allocated: 0.49654245376586914  GigaBytes

torch.Size([48851, 256])
torch.Size([48851, 256])
----------------------------------------after rst
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.47640419006347656  GigaBytes
Max Memory Allocated: 0.5229921340942383  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.42981624603271484  GigaBytes
Max Memory Allocated: 0.5229921340942383  GigaBytes

torch.Size([48851, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.47640419006347656  GigaBytes
Max Memory Allocated: 0.5229921340942383  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.4880514144897461  GigaBytes
Max Memory Allocated: 0.5346393585205078  GigaBytes

----------------input nodes number: 48851
----------------output nodes number: 11035
----------------edges number: 126013
----------------------------------------before mean aggregator
 Nvidia-smi: 2.6072998046875 GB
    Memory Allocated: 0.4884982109069824  GigaBytes
Max Memory Allocated: 0.5346393585205078  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.6092529296875 GB
    Memory Allocated: 0.501899242401123  GigaBytes
Max Memory Allocated: 0.5346393585205078  GigaBytes

torch.Size([11035, 40])
torch.Size([11035, 40])
----------------------------------------after rst
 Nvidia-smi: 2.6092529296875 GB
    Memory Allocated: 0.5035438537597656  GigaBytes
Max Memory Allocated: 0.5346393585205078  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.6092529296875 GB
    Memory Allocated: 0.5016889572143555  GigaBytes
Max Memory Allocated: 0.5346393585205078  GigaBytes

torch.Size([11035, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6092529296875 GB
    Memory Allocated: 0.5015068054199219  GigaBytes
Max Memory Allocated: 0.5346393585205078  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.6092529296875 GB
    Memory Allocated: 0.5035443305969238  GigaBytes
Max Memory Allocated: 0.5346393585205078  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.0977182388305664  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

pseudo mini batch 4 input nodes size: 63644
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.06289148330688477  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.06289148330688477  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.09323930740356445  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.09332609176635742  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.03390789031982422  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.037865638732910156  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.037865638732910156  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

first layer input nodes number: 63644
first layer output nodes number: 35545
edges number: 240077
----------------------------------------before model layer 0
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.0386052131652832  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([63644, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.0386052131652832  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.09137439727783203  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([35545, 256])
torch.Size([35545, 256])
----------------------------------------after rst
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.1252727508544922  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.09137439727783203  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([35545, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.1252727508544922  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.13374757766723633  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

input nodes number: 35545
output nodes number: 20587
edges number: 189135
----------------------------------------before model layer 1
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.13416624069213867  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([35545, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.13416624069213867  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.17499589920043945  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([20587, 256])
torch.Size([20587, 256])
----------------------------------------after rst
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.19462919235229492  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.17499589920043945  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([20587, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.19462919235229492  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.1995377540588379  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------input nodes number: 20587
----------------output nodes number: 11596
----------------edges number: 101806
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7069091796875 GB
    Memory Allocated: 0.19977807998657227  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.2137007713317871  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([11596, 40])
torch.Size([11596, 40])
----------------------------------------after rst
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.21542882919311523  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.2134108543395996  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([11596, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.21328401565551758  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.2150125503540039  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.04572582244873047  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

pseudo mini batch 5 input nodes size: 80977
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.03378105163574219  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.03378105163574219  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.07239389419555664  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.0724797248840332  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.04204511642456055  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.046205997467041016  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.046205997467041016  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

first layer input nodes number: 80977
first layer output nodes number: 43464
edges number: 286846
----------------------------------------before model layer 0
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.0471339225769043  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([80977, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.0471339225769043  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.11174917221069336  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([43464, 256])
torch.Size([43464, 256])
----------------------------------------after rst
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.1531996726989746  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.11174917221069336  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([43464, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.1531996726989746  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.16356229782104492  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

input nodes number: 43464
output nodes number: 21707
edges number: 182546
----------------------------------------before model layer 1
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.1640486717224121  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([43464, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.1640486717224121  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.20699834823608398  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([21707, 256])
torch.Size([21707, 256])
----------------------------------------after rst
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.22769975662231445  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.20697450637817383  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([21707, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.22769975662231445  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.23285150527954102  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------input nodes number: 21707
----------------output nodes number: 11481
----------------edges number: 88858
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.23309946060180664  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.24662494659423828  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([11481, 40])
torch.Size([11481, 40])
----------------------------------------after rst
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.2483358383178711  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.24650812149047852  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([11481, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.24660778045654297  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.24831914901733398  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.05482196807861328  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

pseudo mini batch 6 input nodes size: 103719
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.042144775390625  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.042144775390625  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.09160184860229492  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.09168863296508789  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.052989959716796875  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.05848407745361328  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.05848407745361328  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

first layer input nodes number: 103719
first layer output nodes number: 57096
edges number: 403322
----------------------------------------before model layer 0
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.05968284606933594  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([103719, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.05968284606933594  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.14514636993408203  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([57096, 256])
torch.Size([57096, 256])
----------------------------------------after rst
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.19959735870361328  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.14514636993408203  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([57096, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.19959735870361328  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.2132101058959961  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

input nodes number: 57096
output nodes number: 25380
edges number: 236295
----------------------------------------before model layer 1
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.21382522583007812  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([57096, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.21382522583007812  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.264742374420166  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([25380, 256])
torch.Size([25380, 256])
----------------------------------------after rst
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.28894662857055664  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.26418495178222656  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([25380, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.28894662857055664  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.29444026947021484  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------input nodes number: 25380
----------------output nodes number: 11605
----------------edges number: 97620
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.29471635818481445  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.3086695671081543  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([11605, 40])
torch.Size([11605, 40])
----------------------------------------after rst
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.31039905548095703  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.30832767486572266  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([11605, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.30857133865356445  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.3103013038635254  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.07002925872802734  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

pseudo mini batch 7 input nodes size: 62139
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.05323362350463867  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.05323362350463867  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08286380767822266  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08295059204101562  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.033406734466552734  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.03638029098510742  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.03638029098510742  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

first layer input nodes number: 62139
first layer output nodes number: 33788
edges number: 198117
----------------------------------------before model layer 0
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.037095069885253906  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([62139, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.037095069885253906  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08703136444091797  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([33788, 256])
torch.Size([33788, 256])
----------------------------------------after rst
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.11925411224365234  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.08703136444091797  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([33788, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.11925411224365234  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.12730979919433594  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

input nodes number: 33788
output nodes number: 19976
edges number: 130231
----------------------------------------before model layer 1
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.12771081924438477  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([33788, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.12771081924438477  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.16741323471069336  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([19976, 256])
torch.Size([19976, 256])
----------------------------------------after rst
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.1864638328552246  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.1669325828552246  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([19976, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.1864638328552246  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.19074583053588867  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------input nodes number: 19976
----------------output nodes number: 11592
----------------edges number: 70640
----------------------------------------before mean aggregator
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.19098186492919922  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.2043776512145996  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([11592, 40])
torch.Size([11592, 40])
----------------------------------------after rst
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.20610523223876953  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.2043776512145996  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

torch.Size([11592, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.20403385162353516  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.20576190948486328  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.042304039001464844  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.043921470642089844  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.7088623046875 GB
    Memory Allocated: 0.043921470642089844  GigaBytes
Max Memory Allocated: 0.583594799041748  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.023947149515151978 |0.04754874110221863 |0.10757583379745483 |0.00014090538024902344 |0.0054295361042022705 |0.0015497207641601562 |
----------------------------------------------------------pseudo_mini_loss sum 4.580308437347412
Total (block generation + training)time/epoch 25.925929069519043
Training time/epoch 1.5018281936645508
Training time without block to device /epoch 1.1214382648468018
Training time without total dataloading part /epoch 0.9067199230194092
load block tensor time/epoch 0.19157719612121582
block to device time/epoch 0.380389928817749
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  1537055
Number of first layer input nodes during this epoch:  789846
Number of first layer output nodes during this epoch:  504013
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  217088
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([40, 256])
layers.2.fc_neigh.weight, torch.Size([40, 256])
----------------------------------------
un-trainable parameters
