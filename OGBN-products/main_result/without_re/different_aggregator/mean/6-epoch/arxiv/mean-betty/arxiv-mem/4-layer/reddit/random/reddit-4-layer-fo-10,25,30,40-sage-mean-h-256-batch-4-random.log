main start at this time 1657099926.099262
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  602
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.0022029876708984375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.0022029876708984375  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.45233988761901855
number of batches is  4
batch size is  38358
random selection method spend 0.011759042739868164
time for parepare:  0.027968168258666992
local_output_nid generation:  0.016254186630249023
local_in_edges_tensor generation:  0.030385255813598633
mini_batch_src_global generation:  0.04297590255737305
r_  generation:  0.4446988105773926
local_output_nid generation:  0.020198583602905273
local_in_edges_tensor generation:  0.03375124931335449
mini_batch_src_global generation:  0.05181694030761719
r_  generation:  0.47772836685180664
local_output_nid generation:  0.02010059356689453
local_in_edges_tensor generation:  0.05882596969604492
mini_batch_src_global generation:  0.056550025939941406
r_  generation:  0.48433470726013184
local_output_nid generation:  0.020218372344970703
local_in_edges_tensor generation:  0.02298903465270996
mini_batch_src_global generation:  0.06098461151123047
r_  generation:  0.4998433589935303
----------------------check_connections_block total spend ----------------------------- 2.719600200653076
generate_one_block  0.5641982555389404
generate_one_block  0.5653786659240723
generate_one_block  0.580744743347168
generate_one_block  0.5745606422424316
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.556769847869873
gen group dst list time:  0.02205634117126465
time for parepare:  0.028181791305541992
local_output_nid generation:  0.043190717697143555
local_in_edges_tensor generation:  0.15887165069580078
mini_batch_src_global generation:  0.17694425582885742
r_  generation:  1.7339584827423096
local_output_nid generation:  0.04926800727844238
local_in_edges_tensor generation:  0.14432740211486816
mini_batch_src_global generation:  0.22016596794128418
r_  generation:  1.782029628753662
local_output_nid generation:  0.049132347106933594
local_in_edges_tensor generation:  0.14632606506347656
mini_batch_src_global generation:  0.22448420524597168
r_  generation:  1.7781791687011719
local_output_nid generation:  0.04988455772399902
local_in_edges_tensor generation:  0.1451587677001953
mini_batch_src_global generation:  0.22157049179077148
r_  generation:  1.7665183544158936
----------------------check_connections_block total spend ----------------------------- 10.109227657318115
generate_one_block  2.3454926013946533
generate_one_block  2.3039934635162354
generate_one_block  2.4898557662963867
generate_one_block  2.8118057250976562
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.5754251480102539
gen group dst list time:  0.03801465034484863
time for parepare:  0.0309755802154541
local_output_nid generation:  0.05189228057861328
local_in_edges_tensor generation:  0.15749001502990723
mini_batch_src_global generation:  0.16595935821533203
r_  generation:  1.722717046737671
local_output_nid generation:  0.06108665466308594
local_in_edges_tensor generation:  0.1401219367980957
mini_batch_src_global generation:  0.20691275596618652
r_  generation:  1.7170765399932861
local_output_nid generation:  0.05939912796020508
local_in_edges_tensor generation:  0.1425797939300537
mini_batch_src_global generation:  0.2123701572418213
r_  generation:  1.7348549365997314
local_output_nid generation:  0.05768585205078125
local_in_edges_tensor generation:  0.16613507270812988
mini_batch_src_global generation:  0.20215630531311035
r_  generation:  1.9142961502075195
----------------------check_connections_block total spend ----------------------------- 10.190085411071777
generate_one_block  3.0571374893188477
generate_one_block  3.517483949661255
generate_one_block  2.8374109268188477
generate_one_block  2.4119133949279785
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.30410075187683105
gen group dst list time:  0.052915096282958984
time for parepare:  0.03140115737915039
local_output_nid generation:  0.06258034706115723
local_in_edges_tensor generation:  0.11906623840332031
mini_batch_src_global generation:  0.0685727596282959
r_  generation:  0.8451797962188721
local_output_nid generation:  0.07454991340637207
local_in_edges_tensor generation:  0.09039855003356934
mini_batch_src_global generation:  0.09170913696289062
r_  generation:  0.8426640033721924
local_output_nid generation:  0.0634758472442627
local_in_edges_tensor generation:  0.09740257263183594
mini_batch_src_global generation:  0.09250426292419434
r_  generation:  0.9206371307373047
local_output_nid generation:  0.06431865692138672
local_in_edges_tensor generation:  0.07249045372009277
mini_batch_src_global generation:  0.08102536201477051
r_  generation:  0.8192672729492188
----------------------check_connections_block total spend ----------------------------- 5.183331727981567
generate_one_block  1.3566830158233643
generate_one_block  1.2244458198547363
generate_one_block  0.956916332244873
generate_one_block  0.9951248168945312
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.0022029876708984375  GigaBytes

connection checking time:  25.48264479637146
block generation total time  26.308263301849365
average batch blocks generation time:  6.577065825462341
block dataloader generation time/epoch 60.704777002334595
pseudo mini batch 0 input nodes size: 227413
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.0022029876708984375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0022029876708984375  GigaBytes
Max Memory Allocated: 0.0022029876708984375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5311279296875 GB
    Memory Allocated: 0.5122051239013672  GigaBytes
Max Memory Allocated: 0.5122051239013672  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5311279296875 GB
    Memory Allocated: 0.5124912261962891  GigaBytes
Max Memory Allocated: 0.5124912261962891  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5311279296875 GB
    Memory Allocated: 0.5124912261962891  GigaBytes
Max Memory Allocated: 0.5124912261962891  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.7244873046875 GB
    Memory Allocated: 0.6225290298461914  GigaBytes
Max Memory Allocated: 0.6225290298461914  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.7244873046875 GB
    Memory Allocated: 0.6225290298461914  GigaBytes
Max Memory Allocated: 0.6225290298461914  GigaBytes

first layer input nodes number: 227413
first layer output nodes number: 226737
edges number: 2226958
----------------------------------------before model layer 0
 Nvidia-smi: 1.7244873046875 GB
    Memory Allocated: 0.6260566711425781  GigaBytes
Max Memory Allocated: 0.6352672576904297  GigaBytes

torch.Size([227413, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.7244873046875 GB
    Memory Allocated: 0.6260566711425781  GigaBytes
Max Memory Allocated: 0.6352672576904297  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.4979248046875 GB
    Memory Allocated: 1.3691282272338867  GigaBytes
Max Memory Allocated: 1.6622262001037598  GigaBytes

torch.Size([226737, 256])
torch.Size([226737, 256])
----------------------------------------after rst
 Nvidia-smi: 3.7147216796875 GB
    Memory Allocated: 1.5859251022338867  GigaBytes
Max Memory Allocated: 1.8021583557128906  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7147216796875 GB
    Memory Allocated: 1.3696918487548828  GigaBytes
Max Memory Allocated: 1.8021583557128906  GigaBytes

torch.Size([226737, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7147216796875 GB
    Memory Allocated: 1.5859251022338867  GigaBytes
Max Memory Allocated: 1.8021583557128906  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7147216796875 GB
    Memory Allocated: 1.6399836540222168  GigaBytes
Max Memory Allocated: 1.8562169075012207  GigaBytes

input nodes number: 226737
output nodes number: 223205
edges number: 5351401
----------------------------------------before model layer 1
 Nvidia-smi: 3.7147216796875 GB
    Memory Allocated: 1.6434578895568848  GigaBytes
Max Memory Allocated: 1.8562169075012207  GigaBytes

torch.Size([226737, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.7147216796875 GB
    Memory Allocated: 1.6434578895568848  GigaBytes
Max Memory Allocated: 1.8562169075012207  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 4.0526123046875 GB
    Memory Allocated: 2.110747814178467  GigaBytes
Max Memory Allocated: 2.110747814178467  GigaBytes

torch.Size([223205, 256])
torch.Size([223205, 256])
----------------------------------------after rst
 Nvidia-smi: 4.4783935546875 GB
    Memory Allocated: 2.323638439178467  GigaBytes
Max Memory Allocated: 2.536529064178467  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.4783935546875 GB
    Memory Allocated: 2.1107735633850098  GigaBytes
Max Memory Allocated: 2.536529064178467  GigaBytes

torch.Size([223205, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.4783935546875 GB
    Memory Allocated: 2.3236641883850098  GigaBytes
Max Memory Allocated: 2.536529064178467  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.5330810546875 GB
    Memory Allocated: 2.37685489654541  GigaBytes
Max Memory Allocated: 2.58974552154541  GigaBytes

input nodes number: 223205
output nodes number: 200050
edges number: 5805298
----------------------------------------before model layer 2
 Nvidia-smi: 4.5330810546875 GB
    Memory Allocated: 2.3800668716430664  GigaBytes
Max Memory Allocated: 2.58974552154541  GigaBytes

torch.Size([223205, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 4.5330810546875 GB
    Memory Allocated: 2.3800668716430664  GigaBytes
Max Memory Allocated: 2.58974552154541  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 4.8162841796875 GB
    Memory Allocated: 2.807480812072754  GigaBytes
Max Memory Allocated: 2.807480812072754  GigaBytes

torch.Size([200050, 256])
torch.Size([200050, 256])
----------------------------------------after rst
 Nvidia-smi: 5.1990966796875 GB
    Memory Allocated: 2.998887062072754  GigaBytes
Max Memory Allocated: 3.190293312072754  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 5.1990966796875 GB
    Memory Allocated: 2.8081045150756836  GigaBytes
Max Memory Allocated: 3.190293312072754  GigaBytes

torch.Size([200050, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 5.1990966796875 GB
    Memory Allocated: 2.998887062072754  GigaBytes
Max Memory Allocated: 3.190293312072754  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.047206401824951  GigaBytes
Max Memory Allocated: 3.2379889488220215  GigaBytes

----------------input nodes number: 200050
----------------output nodes number: 38358
----------------edges number: 1385172
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.049041271209717  GigaBytes
Max Memory Allocated: 3.2379889488220215  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.1030020713806152  GigaBytes
Max Memory Allocated: 3.2379889488220215  GigaBytes

torch.Size([38358, 41])
torch.Size([38358, 41])
----------------------------------------after rst
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.108860969543457  GigaBytes
Max Memory Allocated: 3.2379889488220215  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.1030020713806152  GigaBytes
Max Memory Allocated: 3.2379889488220215  GigaBytes

torch.Size([38358, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.108860969543457  GigaBytes
Max Memory Allocated: 3.2379889488220215  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2479248046875 GB
    Memory Allocated: 3.11472225189209  GigaBytes
Max Memory Allocated: 3.2379889488220215  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.4920654296875 GB
    Memory Allocated: 0.8534197807312012  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

pseudo mini batch 1 input nodes size: 227390
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.4920654296875 GB
    Memory Allocated: 0.5205540657043457  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.4920654296875 GB
    Memory Allocated: 0.5205540657043457  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 1.0305047035217285  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 1.0307908058166504  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 0.5205025672912598  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 0.6304564476013184  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 0.6304564476013184  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

first layer input nodes number: 227390
first layer output nodes number: 226721
edges number: 2227062
----------------------------------------before model layer 0
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 0.6340885162353516  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([227390, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 0.6340885162353516  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 1.3767738342285156  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([226721, 256])
torch.Size([226721, 256])
----------------------------------------after rst
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 1.592991828918457  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 1.376194953918457  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([226721, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 1.592991828918457  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 1.647679328918457  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

input nodes number: 226721
output nodes number: 223221
edges number: 5351997
----------------------------------------before model layer 1
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 1.6512064933776855  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([226721, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 1.6512064933776855  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 2.1185269355773926  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([223221, 256])
torch.Size([223221, 256])
----------------------------------------after rst
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 2.3314175605773926  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 2.1185269355773926  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([223221, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 2.3314175605773926  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 2.3846378326416016  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

input nodes number: 223221
output nodes number: 199501
edges number: 5791073
----------------------------------------before model layer 2
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 2.387943744659424  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([223221, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 2.387943744659424  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 2.8130955696105957  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([199501, 256])
torch.Size([199501, 256])
----------------------------------------after rst
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 3.003354549407959  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 2.8130955696105957  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([199501, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 3.003354549407959  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 3.050919532775879  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------input nodes number: 199501
----------------output nodes number: 38358
----------------edges number: 1387505
----------------------------------------before mean aggregator
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 3.0527520179748535  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 3.106712818145752  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([38358, 41])
torch.Size([38358, 41])
----------------------------------------after rst
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 3.1125717163085938  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 3.106712818145752  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([38358, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 3.106712818145752  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0037841796875 GB
    Memory Allocated: 3.112572193145752  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 0.8526387214660645  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

pseudo mini batch 2 input nodes size: 227393
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 0.5205025672912598  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 0.5205025672912598  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 1.0304598808288574  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 1.0307459831237793  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 0.5205092430114746  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 0.6305580139160156  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 0.6305580139160156  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

first layer input nodes number: 227393
first layer output nodes number: 226685
edges number: 2226701
----------------------------------------before model layer 0
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 0.6341972351074219  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([227393, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 0.6341972351074219  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 1.3767991065979004  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([226685, 256])
torch.Size([226685, 256])
----------------------------------------after rst
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 1.5929827690124512  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 1.3761858940124512  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([226685, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 1.5929827690124512  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 1.6476702690124512  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

input nodes number: 226685
output nodes number: 223065
edges number: 5349479
----------------------------------------before model layer 1
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 1.6517729759216309  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([226685, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 1.6517729759216309  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 2.1190733909606934  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([223065, 256])
torch.Size([223065, 256])
----------------------------------------after rst
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 2.3319640159606934  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 2.1190733909606934  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([223065, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 2.3319640159606934  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 2.3851470947265625  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

input nodes number: 223065
output nodes number: 199331
edges number: 5787292
----------------------------------------before model layer 2
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 2.3883652687072754  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([223065, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 2.3883652687072754  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 2.813164234161377  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([199331, 256])
torch.Size([199331, 256])
----------------------------------------after rst
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 3.003261089324951  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 2.813164234161377  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([199331, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 3.003261089324951  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 3.050785541534424  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------input nodes number: 199331
----------------output nodes number: 38358
----------------edges number: 1390361
----------------------------------------before mean aggregator
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 3.0526275634765625  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 3.105713367462158  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([38358, 41])
torch.Size([38358, 41])
----------------------------------------after rst
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 3.111572265625  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 3.105713367462158  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([38358, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 3.105713367462158  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 3.111572742462158  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 0.8522825241088867  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

pseudo mini batch 3 input nodes size: 227334
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 0.5205092430114746  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 0.5205092430114746  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 1.03033447265625  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 1.0306205749511719  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 0.5203771591186523  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 0.6303195953369141  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 0.6303195953369141  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

first layer input nodes number: 227334
first layer output nodes number: 226636
edges number: 2226388
----------------------------------------before model layer 0
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 0.6340417861938477  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([227334, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 0.6340417861938477  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 1.3765311241149902  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([226636, 256])
torch.Size([226636, 256])
----------------------------------------after rst
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 1.592668056488037  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 1.375871181488037  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([226636, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 1.592668056488037  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 1.647355556488037  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

input nodes number: 226636
output nodes number: 223032
edges number: 5349275
----------------------------------------before model layer 1
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 1.6509108543395996  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([226636, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 1.6509108543395996  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 2.1182103157043457  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([223032, 256])
torch.Size([223032, 256])
----------------------------------------after rst
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 2.3311009407043457  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 2.1182103157043457  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([223032, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 2.3311009407043457  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 2.3842759132385254  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

input nodes number: 223032
output nodes number: 199506
edges number: 5791856
----------------------------------------before model layer 2
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 2.387847900390625  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([223032, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 2.387847900390625  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 2.8130149841308594  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([199506, 256])
torch.Size([199506, 256])
----------------------------------------after rst
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 3.0032787322998047  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 2.8130149841308594  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([199506, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 3.0032787322998047  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 3.050844669342041  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------input nodes number: 199506
----------------output nodes number: 38357
----------------edges number: 1388482
----------------------------------------before mean aggregator
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 3.052687168121338  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 3.1059632301330566  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([38357, 41])
torch.Size([38357, 41])
----------------------------------------after rst
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 3.1118221282958984  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 3.105757713317871  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

torch.Size([38357, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 3.105757713317871  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 3.1118226051330566  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.0057373046875 GB
    Memory Allocated: 0.8521809577941895  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.8565869331359863  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 7.0096435546875 GB
    Memory Allocated: 0.8565869331359863  GigaBytes
Max Memory Allocated: 3.4596118927001953  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.16575157642364502 |0.1883520483970642 |0.2725026607513428 |0.00018650293350219727 |0.01887047290802002 |0.0025894641876220703 |
----------------------------------------------------------pseudo_mini_loss sum 19.276222229003906
Total (block generation + training)time/epoch 63.37536406517029
Training time/epoch 2.670346260070801
Training time without block to device /epoch 1.916938066482544
Training time without total dataloading part /epoch 1.168828010559082
load block tensor time/epoch 0.6630063056945801
block to device time/epoch 0.7534081935882568
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  3507220
Number of first layer input nodes during this epoch:  909530
Number of first layer output nodes during this epoch:  906779
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=602, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=602, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=41, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=41, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  591360
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 602])
layers.0.fc_neigh.weight, torch.Size([256, 602])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([41, 256])
layers.3.fc_neigh.weight, torch.Size([41, 256])
----------------------------------------
un-trainable parameters
