main start at this time 1657071851.850938
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.01849532127380371
global_2_local spend time (sec) 0.03511548042297363
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.004541873931884766
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 64794, 1: 13428, 2: 11706, 3: 9277, 30: 7479, 4: 7320, 5: 6222, 6: 4868, 7: 4045, 8: 3472, 9: 2976, 10: 2599, 11: 2203, 12: 1937, 13: 1656, 14: 1434, 15: 1289, 16: 1111, 17: 1030, 18: 948, 19: 836, 20: 807, 21: 717, 22: 556, 24: 525, 23: 519, 25: 483, 26: 409, 27: 390, 28: 370, 29: 329})

A = g.adjacency_matrix() spent  0.008318662643432617
auxiliary_graph
Graph(num_nodes=155735, num_edges=31735755,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.07760357856750488
remove nodes length  64794

auxiliary_graph.remove_nodes spent  1.363600730895996
after remove non output nodes the auxiliary_graph
Graph(num_nodes=90941, num_edges=31735755,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  1.2644402980804443

the counter of shared neighbor distribution
Counter({1.0: 25124188, 2.0: 4626802, 3.0: 1218314, 4.0: 388536, 5.0: 147564, 6.0: 65410, 7.0: 32316, 8.0: 17018, 9.0: 9606, 10.0: 5710, 11.0: 3458, 12.0: 2188, 13.0: 1298, 14.0: 804, 15.0: 550, 16.0: 350, 17.0: 250, 18.0: 152, 19.0: 130, 20.0: 70, 21.0: 38, 22.0: 38, 23.0: 16, 24.0: 4, 25.0: 4})
31644814
Convert a graph into a bidirected graph: 1.329 seconds
Metis partitioning: 5.808 seconds
Split the graph: 1.204 seconds
Construct subgraphs: 0.058 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  8.413627624511719
5724
5762
5517
5517
5843
5517
5517
5517
5854
5526
5854
5589
5814
5768
5845
5777
total k batches seeds list generation spend  15.374722719192505
after graph partition
graph partition algorithm spend time 15.454375743865967
5724
5762
5517
5517
5843
5517
5517
5517
5854
5526
5854
5589
5814
5768
5845
5777
partition_len_list
[13748, 13684, 18548, 27681, 29164, 26224, 30289, 25379, 12384, 12439, 10913, 9659, 11213, 13270, 13953, 10008]
REG selection method  spend 15.537398338317871
time for parepare:  0.01648998260498047
local_output_nid generation:  0.0011572837829589844
local_in_edges_tensor generation:  0.0013363361358642578
mini_batch_src_global generation:  0.0013697147369384766
r_  generation:  0.01230478286743164
local_output_nid generation:  0.0013425350189208984
local_in_edges_tensor generation:  0.0012743473052978516
mini_batch_src_global generation:  0.0013158321380615234
r_  generation:  0.013282537460327148
local_output_nid generation:  0.0013670921325683594
local_in_edges_tensor generation:  0.0012128353118896484
mini_batch_src_global generation:  0.0013375282287597656
r_  generation:  0.013793706893920898
local_output_nid generation:  0.0014507770538330078
local_in_edges_tensor generation:  0.0011775493621826172
mini_batch_src_global generation:  0.0017337799072265625
r_  generation:  0.018811702728271484
local_output_nid generation:  0.0016105175018310547
local_in_edges_tensor generation:  0.001798391342163086
mini_batch_src_global generation:  0.0028429031372070312
r_  generation:  0.02829885482788086
local_output_nid generation:  0.0017476081848144531
local_in_edges_tensor generation:  0.001298666000366211
mini_batch_src_global generation:  0.0018329620361328125
r_  generation:  0.01983809471130371
local_output_nid generation:  0.0017430782318115234
local_in_edges_tensor generation:  0.0013134479522705078
mini_batch_src_global generation:  0.0018737316131591797
r_  generation:  0.021709918975830078
local_output_nid generation:  0.0017528533935546875
local_in_edges_tensor generation:  0.0012617111206054688
mini_batch_src_global generation:  0.0015299320220947266
r_  generation:  0.016416549682617188
local_output_nid generation:  0.0018277168273925781
local_in_edges_tensor generation:  0.0013146400451660156
mini_batch_src_global generation:  0.0015070438385009766
r_  generation:  0.017926931381225586
local_output_nid generation:  0.0016682147979736328
local_in_edges_tensor generation:  0.0011739730834960938
mini_batch_src_global generation:  0.0012562274932861328
r_  generation:  0.01356196403503418
local_output_nid generation:  0.0017387866973876953
local_in_edges_tensor generation:  0.0012524127960205078
mini_batch_src_global generation:  0.0014684200286865234
r_  generation:  0.01727604866027832
local_output_nid generation:  0.0016410350799560547
local_in_edges_tensor generation:  0.0011439323425292969
mini_batch_src_global generation:  0.0012814998626708984
r_  generation:  0.01400899887084961
local_output_nid generation:  0.0016124248504638672
local_in_edges_tensor generation:  0.001194000244140625
mini_batch_src_global generation:  0.0012271404266357422
r_  generation:  0.014227867126464844
local_output_nid generation:  0.001619100570678711
local_in_edges_tensor generation:  0.0011780261993408203
mini_batch_src_global generation:  0.0013191699981689453
r_  generation:  0.015271425247192383
local_output_nid generation:  0.001605987548828125
local_in_edges_tensor generation:  0.0012969970703125
mini_batch_src_global generation:  0.0015490055084228516
r_  generation:  0.01720905303955078
local_output_nid generation:  0.0015943050384521484
local_in_edges_tensor generation:  0.001111745834350586
mini_batch_src_global generation:  0.0013065338134765625
r_  generation:  0.010760307312011719
----------------------check_connections_block total spend ----------------------------- 0.41707921028137207
generate_one_block  0.022724628448486328
generate_one_block  0.0185391902923584
generate_one_block  0.02018284797668457
generate_one_block  0.027423858642578125
generate_one_block  0.04512286186218262
generate_one_block  0.027413129806518555
generate_one_block  0.0303041934967041
generate_one_block  0.022156715393066406
generate_one_block  0.02292323112487793
generate_one_block  0.018067121505737305
generate_one_block  0.02252340316772461
generate_one_block  0.020181655883789062
generate_one_block  0.01842331886291504
generate_one_block  0.020050525665283203
generate_one_block  0.0233304500579834
generate_one_block  0.025171756744384766
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03220987319946289
gen group dst list time:  0.0077838897705078125
time for parepare:  0.022037029266357422
local_output_nid generation:  0.0025968551635742188
local_in_edges_tensor generation:  0.00658726692199707
mini_batch_src_global generation:  0.003431558609008789
r_  generation:  0.03621315956115723
local_output_nid generation:  0.0039637088775634766
local_in_edges_tensor generation:  0.003948688507080078
mini_batch_src_global generation:  0.004264354705810547
r_  generation:  0.03885626792907715
local_output_nid generation:  0.005200862884521484
local_in_edges_tensor generation:  0.005112886428833008
mini_batch_src_global generation:  0.006647348403930664
r_  generation:  0.06844425201416016
local_output_nid generation:  0.007456302642822266
local_in_edges_tensor generation:  0.007300615310668945
mini_batch_src_global generation:  0.013194799423217773
r_  generation:  0.12252163887023926
local_output_nid generation:  0.0075321197509765625
local_in_edges_tensor generation:  0.01199030876159668
mini_batch_src_global generation:  0.018421173095703125
r_  generation:  0.14750027656555176
local_output_nid generation:  0.007035493850708008
local_in_edges_tensor generation:  0.008246660232543945
mini_batch_src_global generation:  0.01609206199645996
r_  generation:  0.12240362167358398
local_output_nid generation:  0.0077669620513916016
local_in_edges_tensor generation:  0.008896112442016602
mini_batch_src_global generation:  0.018924236297607422
r_  generation:  0.1436774730682373
local_output_nid generation:  0.007150888442993164
local_in_edges_tensor generation:  0.006623744964599609
mini_batch_src_global generation:  0.014150619506835938
r_  generation:  0.1122133731842041
local_output_nid generation:  0.0036344528198242188
local_in_edges_tensor generation:  0.003131866455078125
mini_batch_src_global generation:  0.0067942142486572266
r_  generation:  0.04139900207519531
local_output_nid generation:  0.0034863948822021484
local_in_edges_tensor generation:  0.003038644790649414
mini_batch_src_global generation:  0.0038917064666748047
r_  generation:  0.03611493110656738
local_output_nid generation:  0.0030107498168945312
local_in_edges_tensor generation:  0.002640962600708008
mini_batch_src_global generation:  0.0037987232208251953
r_  generation:  0.03557729721069336
local_output_nid generation:  0.0026471614837646484
local_in_edges_tensor generation:  0.0022258758544921875
mini_batch_src_global generation:  0.0026788711547851562
r_  generation:  0.025141477584838867
local_output_nid generation:  0.0030193328857421875
local_in_edges_tensor generation:  0.0024590492248535156
mini_batch_src_global generation:  0.002584218978881836
r_  generation:  0.029654502868652344
local_output_nid generation:  0.003457307815551758
local_in_edges_tensor generation:  0.002917051315307617
mini_batch_src_global generation:  0.003545045852661133
r_  generation:  0.038721561431884766
local_output_nid generation:  0.0037572383880615234
local_in_edges_tensor generation:  0.0035169124603271484
mini_batch_src_global generation:  0.004769563674926758
r_  generation:  0.04717397689819336
local_output_nid generation:  0.002790689468383789
local_in_edges_tensor generation:  0.0022749900817871094
mini_batch_src_global generation:  0.0027625560760498047
r_  generation:  0.022831439971923828
----------------------check_connections_block total spend ----------------------------- 1.6123371124267578
generate_one_block  0.04765486717224121
generate_one_block  0.05166912078857422
generate_one_block  0.09081721305847168
generate_one_block  0.16937875747680664
generate_one_block  0.20503664016723633
generate_one_block  0.16563630104064941
generate_one_block  0.20254039764404297
generate_one_block  0.14554262161254883
generate_one_block  0.0512537956237793
generate_one_block  0.046434879302978516
generate_one_block  0.044553518295288086
generate_one_block  0.03245949745178223
generate_one_block  0.03679370880126953
generate_one_block  0.051200151443481445
generate_one_block  0.0623018741607666
generate_one_block  0.027820110321044922
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.023073434829711914
gen group dst list time:  0.022284746170043945
time for parepare:  0.019365310668945312
local_output_nid generation:  0.007472515106201172
local_in_edges_tensor generation:  0.01115107536315918
mini_batch_src_global generation:  0.007843732833862305
r_  generation:  0.08913207054138184
local_output_nid generation:  0.01146554946899414
local_in_edges_tensor generation:  0.009435176849365234
mini_batch_src_global generation:  0.01051473617553711
r_  generation:  0.09951424598693848
local_output_nid generation:  0.014215707778930664
local_in_edges_tensor generation:  0.011414289474487305
mini_batch_src_global generation:  0.013782262802124023
r_  generation:  0.1561293601989746
local_output_nid generation:  0.020218849182128906
local_in_edges_tensor generation:  0.02120828628540039
mini_batch_src_global generation:  0.02212810516357422
r_  generation:  0.22581815719604492
local_output_nid generation:  0.015454530715942383
local_in_edges_tensor generation:  0.04143118858337402
mini_batch_src_global generation:  0.021763324737548828
r_  generation:  0.18461084365844727
local_output_nid generation:  0.016627788543701172
local_in_edges_tensor generation:  0.014210939407348633
mini_batch_src_global generation:  0.021235227584838867
r_  generation:  0.1905977725982666
local_output_nid generation:  0.01844024658203125
local_in_edges_tensor generation:  0.018970727920532227
mini_batch_src_global generation:  0.02379894256591797
r_  generation:  0.21281766891479492
local_output_nid generation:  0.02058863639831543
local_in_edges_tensor generation:  0.019892215728759766
mini_batch_src_global generation:  0.02494978904724121
r_  generation:  0.22650527954101562
local_output_nid generation:  0.007128238677978516
local_in_edges_tensor generation:  0.005305051803588867
mini_batch_src_global generation:  0.011060476303100586
r_  generation:  0.06438946723937988
local_output_nid generation:  0.008304834365844727
local_in_edges_tensor generation:  0.006426334381103516
mini_batch_src_global generation:  0.007804393768310547
r_  generation:  0.0738980770111084
local_output_nid generation:  0.006827116012573242
local_in_edges_tensor generation:  0.00541996955871582
mini_batch_src_global generation:  0.00761723518371582
r_  generation:  0.0632016658782959
local_output_nid generation:  0.005803823471069336
local_in_edges_tensor generation:  0.004530429840087891
mini_batch_src_global generation:  0.005621910095214844
r_  generation:  0.049767494201660156
local_output_nid generation:  0.006667613983154297
local_in_edges_tensor generation:  0.0051076412200927734
mini_batch_src_global generation:  0.005906820297241211
r_  generation:  0.05697011947631836
local_output_nid generation:  0.009338855743408203
local_in_edges_tensor generation:  0.00735783576965332
mini_batch_src_global generation:  0.009104251861572266
r_  generation:  0.08914709091186523
local_output_nid generation:  0.013074874877929688
local_in_edges_tensor generation:  0.009175777435302734
mini_batch_src_global generation:  0.01231694221496582
r_  generation:  0.11363983154296875
local_output_nid generation:  0.00598454475402832
local_in_edges_tensor generation:  0.004524946212768555
mini_batch_src_global generation:  0.0068356990814208984
r_  generation:  0.046521663665771484
----------------------check_connections_block total spend ----------------------------- 3.0084688663482666
generate_one_block  0.11718225479125977
generate_one_block  0.1281893253326416
generate_one_block  0.1797802448272705
generate_one_block  0.27883362770080566
generate_one_block  0.22548580169677734
generate_one_block  0.23164844512939453
generate_one_block  0.2599153518676758
generate_one_block  0.28255414962768555
generate_one_block  0.07802987098693848
generate_one_block  0.09013104438781738
generate_one_block  0.07583141326904297
generate_one_block  0.06738591194152832
generate_one_block  0.06864094734191895
generate_one_block  0.11741042137145996
generate_one_block  0.1441042423248291
generate_one_block  0.05650639533996582
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

connection checking time:  5.0378851890563965
block generation total time  4.217261791229248
average batch blocks generation time:  0.08785962065060933
block dataloader generation time/epoch 25.123547077178955
pseudo mini batch 0 input nodes size: 82653
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0008087158203125  GigaBytes
Max Memory Allocated: 0.0008087158203125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0584716796875 GB
    Memory Allocated: 0.04022073745727539  GigaBytes
Max Memory Allocated: 0.04022073745727539  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0584716796875 GB
    Memory Allocated: 0.04026365280151367  GigaBytes
Max Memory Allocated: 0.04026365280151367  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0584716796875 GB
    Memory Allocated: 0.04026365280151367  GigaBytes
Max Memory Allocated: 0.04026365280151367  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1248779296875 GB
    Memory Allocated: 0.04325246810913086  GigaBytes
Max Memory Allocated: 0.04325246810913086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1248779296875 GB
    Memory Allocated: 0.04325246810913086  GigaBytes
Max Memory Allocated: 0.04325246810913086  GigaBytes

first layer input nodes number: 82653
first layer output nodes number: 37200
edges number: 256777
----------------------------------------before model layer 0
 Nvidia-smi: 1.1268310546875 GB
    Memory Allocated: 0.044146060943603516  GigaBytes
Max Memory Allocated: 0.04510307312011719  GigaBytes

torch.Size([82653, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1268310546875 GB
    Memory Allocated: 0.044146060943603516  GigaBytes
Max Memory Allocated: 0.04510307312011719  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.3905029296875 GB
    Memory Allocated: 0.09941387176513672  GigaBytes
Max Memory Allocated: 0.09941387176513672  GigaBytes

torch.Size([37200, 256])
torch.Size([37200, 256])
----------------------------------------after rst
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.13489055633544922  GigaBytes
Max Memory Allocated: 0.17036724090576172  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.09941387176513672  GigaBytes
Max Memory Allocated: 0.17036724090576172  GigaBytes

torch.Size([37200, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.13489055633544922  GigaBytes
Max Memory Allocated: 0.17036724090576172  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.14375972747802734  GigaBytes
Max Memory Allocated: 0.17923641204833984  GigaBytes

input nodes number: 37200
output nodes number: 13748
edges number: 108559
----------------------------------------before model layer 1
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.14413976669311523  GigaBytes
Max Memory Allocated: 0.17923641204833984  GigaBytes

torch.Size([37200, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4647216796875 GB
    Memory Allocated: 0.14413976669311523  GigaBytes
Max Memory Allocated: 0.17923641204833984  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4666748046875 GB
    Memory Allocated: 0.17127466201782227  GigaBytes
Max Memory Allocated: 0.17923641204833984  GigaBytes

torch.Size([13748, 256])
torch.Size([13748, 256])
----------------------------------------after rst
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.18494653701782227  GigaBytes
Max Memory Allocated: 0.19861841201782227  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.17183542251586914  GigaBytes
Max Memory Allocated: 0.19861841201782227  GigaBytes

torch.Size([13748, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.18494653701782227  GigaBytes
Max Memory Allocated: 0.19861841201782227  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.18878507614135742  GigaBytes
Max Memory Allocated: 0.20189619064331055  GigaBytes

----------------input nodes number: 13748
----------------output nodes number: 5724
----------------edges number: 35542
----------------------------------------before mean aggregator
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.18893051147460938  GigaBytes
Max Memory Allocated: 0.20189619064331055  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.4940185546875 GB
    Memory Allocated: 0.19555044174194336  GigaBytes
Max Memory Allocated: 0.20189619064331055  GigaBytes

torch.Size([5724, 40])
torch.Size([5724, 40])
----------------------------------------after rst
 Nvidia-smi: 1.4959716796875 GB
    Memory Allocated: 0.19640350341796875  GigaBytes
Max Memory Allocated: 0.20189619064331055  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.4959716796875 GB
    Memory Allocated: 0.19555044174194336  GigaBytes
Max Memory Allocated: 0.20189619064331055  GigaBytes

torch.Size([5724, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.4959716796875 GB
    Memory Allocated: 0.19640350341796875  GigaBytes
Max Memory Allocated: 0.20189619064331055  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.4959716796875 GB
    Memory Allocated: 0.19725751876831055  GigaBytes
Max Memory Allocated: 0.20189619064331055  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.05079984664916992  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

pseudo mini batch 1 input nodes size: 84373
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.04192638397216797  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.5858154296875 GB
    Memory Allocated: 0.04192638397216797  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.08294200897216797  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.08298540115356445  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.04353046417236328  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.046726226806640625  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.046726226806640625  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

first layer input nodes number: 84373
first layer output nodes number: 38517
edges number: 275333
----------------------------------------before model layer 0
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.04764223098754883  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

torch.Size([84373, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.04764223098754883  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.1054525375366211  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

torch.Size([38517, 256])
torch.Size([38517, 256])
----------------------------------------after rst
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.1425619125366211  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.1054525375366211  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

torch.Size([38517, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.1425619125366211  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.15174531936645508  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

input nodes number: 38517
output nodes number: 13684
edges number: 115475
----------------------------------------before model layer 1
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.15213441848754883  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

torch.Size([38517, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.15213441848754883  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.18044137954711914  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

torch.Size([13684, 256])
torch.Size([13684, 256])
----------------------------------------after rst
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.19349145889282227  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.17981958389282227  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

torch.Size([13684, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.19349145889282227  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.19613218307495117  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

----------------input nodes number: 13684
----------------output nodes number: 5762
----------------edges number: 37878
----------------------------------------before mean aggregator
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.19627761840820312  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2029576301574707  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

torch.Size([5762, 40])
torch.Size([5762, 40])
----------------------------------------after rst
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.20381641387939453  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.2029576301574707  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

torch.Size([5762, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.20296335220336914  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.20382261276245117  GigaBytes
Max Memory Allocated: 0.2190699577331543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.05307149887084961  GigaBytes
Max Memory Allocated: 0.22905921936035156  GigaBytes

pseudo mini batch 2 input nodes size: 90706
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.04353618621826172  GigaBytes
Max Memory Allocated: 0.22905921936035156  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.6268310546875 GB
    Memory Allocated: 0.04353618621826172  GigaBytes
Max Memory Allocated: 0.22905921936035156  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.08678817749023438  GigaBytes
Max Memory Allocated: 0.22905921936035156  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.08682966232299805  GigaBytes
Max Memory Allocated: 0.22905921936035156  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.04577064514160156  GigaBytes
Max Memory Allocated: 0.22905921936035156  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.05081796646118164  GigaBytes
Max Memory Allocated: 0.22905921936035156  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.05081796646118164  GigaBytes
Max Memory Allocated: 0.22905921936035156  GigaBytes

first layer input nodes number: 90706
first layer output nodes number: 51325
edges number: 398614
----------------------------------------before model layer 0
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.05187654495239258  GigaBytes
Max Memory Allocated: 0.22905921936035156  GigaBytes

torch.Size([90706, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.6717529296875 GB
    Memory Allocated: 0.05187654495239258  GigaBytes
Max Memory Allocated: 0.22905921936035156  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.7283935546875 GB
    Memory Allocated: 0.12876415252685547  GigaBytes
Max Memory Allocated: 0.22905921936035156  GigaBytes

torch.Size([51325, 256])
torch.Size([51325, 256])
----------------------------------------after rst
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.17771148681640625  GigaBytes
Max Memory Allocated: 0.22905921936035156  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.12876415252685547  GigaBytes
Max Memory Allocated: 0.22905921936035156  GigaBytes

torch.Size([51325, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.17771148681640625  GigaBytes
Max Memory Allocated: 0.22905921936035156  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.19034719467163086  GigaBytes
Max Memory Allocated: 0.23929452896118164  GigaBytes

input nodes number: 51325
output nodes number: 18548
edges number: 212672
----------------------------------------before model layer 1
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.19086790084838867  GigaBytes
Max Memory Allocated: 0.23929452896118164  GigaBytes

torch.Size([51325, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.19086790084838867  GigaBytes
Max Memory Allocated: 0.23929452896118164  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.22796869277954102  GigaBytes
Max Memory Allocated: 0.23929452896118164  GigaBytes

torch.Size([18548, 256])
torch.Size([18548, 256])
----------------------------------------after rst
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.24565744400024414  GigaBytes
Max Memory Allocated: 0.26334619522094727  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.22796869277954102  GigaBytes
Max Memory Allocated: 0.26334619522094727  GigaBytes

torch.Size([18548, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.24565744400024414  GigaBytes
Max Memory Allocated: 0.26334619522094727  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2500796318054199  GigaBytes
Max Memory Allocated: 0.26776838302612305  GigaBytes

----------------input nodes number: 18548
----------------output nodes number: 5517
----------------edges number: 41133
----------------------------------------before mean aggregator
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2502593994140625  GigaBytes
Max Memory Allocated: 0.26776838302612305  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.25669240951538086  GigaBytes
Max Memory Allocated: 0.26776838302612305  GigaBytes

torch.Size([5517, 40])
torch.Size([5517, 40])
----------------------------------------after rst
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.25751495361328125  GigaBytes
Max Memory Allocated: 0.26776838302612305  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.25669240951538086  GigaBytes
Max Memory Allocated: 0.26776838302612305  GigaBytes

torch.Size([5517, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.2566561698913574  GigaBytes
Max Memory Allocated: 0.26776838302612305  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.8299560546875 GB
    Memory Allocated: 0.257479190826416  GigaBytes
Max Memory Allocated: 0.26776838302612305  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.06014204025268555  GigaBytes
Max Memory Allocated: 0.2930412292480469  GigaBytes

pseudo mini batch 3 input nodes size: 118673
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.045734405517578125  GigaBytes
Max Memory Allocated: 0.2930412292480469  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.9315185546875 GB
    Memory Allocated: 0.045734405517578125  GigaBytes
Max Memory Allocated: 0.2930412292480469  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.10237503051757812  GigaBytes
Max Memory Allocated: 0.2930412292480469  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.1024165153503418  GigaBytes
Max Memory Allocated: 0.2930412292480469  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.05912303924560547  GigaBytes
Max Memory Allocated: 0.2930412292480469  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.06707286834716797  GigaBytes
Max Memory Allocated: 0.2930412292480469  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.06707286834716797  GigaBytes
Max Memory Allocated: 0.2930412292480469  GigaBytes

first layer input nodes number: 118673
first layer output nodes number: 78043
edges number: 620942
----------------------------------------before model layer 0
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.06853914260864258  GigaBytes
Max Memory Allocated: 0.2930412292480469  GigaBytes

torch.Size([118673, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.9881591796875 GB
    Memory Allocated: 0.06853914260864258  GigaBytes
Max Memory Allocated: 0.2930412292480469  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.0780029296875 GB
    Memory Allocated: 0.18509864807128906  GigaBytes
Max Memory Allocated: 0.2930412292480469  GigaBytes

torch.Size([78043, 256])
torch.Size([78043, 256])
----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.25952625274658203  GigaBytes
Max Memory Allocated: 0.333953857421875  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.18509864807128906  GigaBytes
Max Memory Allocated: 0.333953857421875  GigaBytes

torch.Size([78043, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.25952625274658203  GigaBytes
Max Memory Allocated: 0.333953857421875  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.27905750274658203  GigaBytes
Max Memory Allocated: 0.353485107421875  GigaBytes

input nodes number: 78043
output nodes number: 27681
edges number: 388770
----------------------------------------before model layer 1
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.2798457145690918  GigaBytes
Max Memory Allocated: 0.353485107421875  GigaBytes

torch.Size([78043, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.2798457145690918  GigaBytes
Max Memory Allocated: 0.353485107421875  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.33608245849609375  GigaBytes
Max Memory Allocated: 0.353485107421875  GigaBytes

torch.Size([27681, 256])
torch.Size([27681, 256])
----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.36248111724853516  GigaBytes
Max Memory Allocated: 0.38887977600097656  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.33608245849609375  GigaBytes
Max Memory Allocated: 0.38887977600097656  GigaBytes

torch.Size([27681, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.36248111724853516  GigaBytes
Max Memory Allocated: 0.38887977600097656  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3690810203552246  GigaBytes
Max Memory Allocated: 0.395479679107666  GigaBytes

----------------input nodes number: 27681
----------------output nodes number: 5517
----------------edges number: 57066
----------------------------------------before mean aggregator
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.36932897567749023  GigaBytes
Max Memory Allocated: 0.395479679107666  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.376068115234375  GigaBytes
Max Memory Allocated: 0.395479679107666  GigaBytes

torch.Size([5517, 40])
torch.Size([5517, 40])
----------------------------------------after rst
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3768906593322754  GigaBytes
Max Memory Allocated: 0.395479679107666  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.376068115234375  GigaBytes
Max Memory Allocated: 0.395479679107666  GigaBytes

torch.Size([5517, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.376068115234375  GigaBytes
Max Memory Allocated: 0.395479679107666  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 0.3768911361694336  GigaBytes
Max Memory Allocated: 0.395479679107666  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.08228826522827148  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

pseudo mini batch 4 input nodes size: 91982
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.05912303924560547  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.05912303924560547  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.10298347473144531  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.10302734375  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.04634523391723633  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.05451345443725586  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.05451345443725586  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

first layer input nodes number: 91982
first layer output nodes number: 62502
edges number: 520940
----------------------------------------before model layer 0
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.055665016174316406  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([91982, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.055665016174316406  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.14918947219848633  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([62502, 256])
torch.Size([62502, 256])
----------------------------------------after rst
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.20879602432250977  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.14918947219848633  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([62502, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.20879602432250977  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.22369766235351562  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

input nodes number: 62502
output nodes number: 29164
edges number: 485806
----------------------------------------before model layer 1
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.2243809700012207  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([62502, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.2243809700012207  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.28432321548461914  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([29164, 256])
torch.Size([29164, 256])
----------------------------------------after rst
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.312136173248291  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.28432321548461914  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([29164, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.312136173248291  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.319089412689209  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------input nodes number: 29164
----------------output nodes number: 5843
----------------edges number: 89448
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3193507194519043  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3265042304992676  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([5843, 40])
torch.Size([5843, 40])
----------------------------------------after rst
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3273749351501465  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3265042304992676  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([5843, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3265523910522461  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3274235725402832  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.0702972412109375  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

pseudo mini batch 5 input nodes size: 98426
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.046393394470214844  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.046393394470214844  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.09332656860351562  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.0933680534362793  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.049463748931884766  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.057158470153808594  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.057158470153808594  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

first layer input nodes number: 98426
first layer output nodes number: 64920
edges number: 526750
----------------------------------------before model layer 0
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.05837583541870117  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([98426, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.05837583541870117  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.1554121971130371  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([64920, 256])
torch.Size([64920, 256])
----------------------------------------after rst
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.21732473373413086  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.1554121971130371  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([64920, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.21732473373413086  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.2328028678894043  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

input nodes number: 64920
output nodes number: 26224
edges number: 391451
----------------------------------------before model layer 1
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.23348236083984375  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([64920, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.23348236083984375  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.2873826026916504  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([26224, 256])
torch.Size([26224, 256])
----------------------------------------after rst
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3123917579650879  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.2873826026916504  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([26224, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3123917579650879  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.31864404678344727  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------input nodes number: 26224
----------------output nodes number: 5517
----------------edges number: 57016
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3188810348510742  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.32543230056762695  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([5517, 40])
torch.Size([5517, 40])
----------------------------------------after rst
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.32625484466552734  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.32543230056762695  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([5517, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.32538414001464844  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.32620716094970703  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.07164382934570312  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

pseudo mini batch 6 input nodes size: 105796
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.04941558837890625  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.04941558837890625  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.10019683837890625  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.10023832321166992  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.05326366424560547  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.06158161163330078  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.06158161163330078  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

first layer input nodes number: 105796
first layer output nodes number: 73710
edges number: 593542
----------------------------------------before model layer 0
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.06291961669921875  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([105796, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.06291961669921875  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.1734638214111328  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([73710, 256])
torch.Size([73710, 256])
----------------------------------------after rst
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.2437591552734375  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.1734638214111328  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([73710, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.2437591552734375  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.26133298873901367  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

input nodes number: 73710
output nodes number: 30289
edges number: 458628
----------------------------------------before model layer 1
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.26210832595825195  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([73710, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.26210832595825195  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.32402515411376953  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([30289, 256])
torch.Size([30289, 256])
----------------------------------------after rst
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.35291099548339844  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.32402515411376953  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([30289, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.35291099548339844  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.36013269424438477  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------input nodes number: 30289
----------------output nodes number: 5517
----------------edges number: 63965
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3604001998901367  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3676180839538574  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([5517, 40])
torch.Size([5517, 40])
----------------------------------------after rst
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3684406280517578  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3676180839538574  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([5517, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3676180839538574  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.368441104888916  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.07787609100341797  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

pseudo mini batch 7 input nodes size: 121375
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.05326366424560547  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.05326366424560547  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.11113977432250977  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.11118125915527344  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.060358524322509766  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.06789541244506836  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.06789541244506836  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

first layer input nodes number: 121375
first layer output nodes number: 79790
edges number: 630880
----------------------------------------before model layer 0
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.06939458847045898  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([121375, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.06939458847045898  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.18922996520996094  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([79790, 256])
torch.Size([79790, 256])
----------------------------------------after rst
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.26540184020996094  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.18922996520996094  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([79790, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.26540184020996094  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.28493309020996094  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

input nodes number: 79790
output nodes number: 25379
edges number: 336369
----------------------------------------before model layer 1
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.2857170104980469  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([79790, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.2857170104980469  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3372821807861328  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([25379, 256])
torch.Size([25379, 256])
----------------------------------------after rst
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.36148548126220703  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3372821807861328  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([25379, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.36148548126220703  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3675365447998047  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------input nodes number: 25379
----------------output nodes number: 5517
----------------edges number: 44259
----------------------------------------before mean aggregator
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.367767333984375  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3742232322692871  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([5517, 40])
torch.Size([5517, 40])
----------------------------------------after rst
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3750457763671875  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3742232322692871  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

torch.Size([5517, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3742232322692871  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.3750462532043457  GigaBytes
Max Memory Allocated: 0.43674421310424805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.08266925811767578  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

pseudo mini batch 8 input nodes size: 46395
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.060358524322509766  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.060358524322509766  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.08248138427734375  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.08252525329589844  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.02460765838623047  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.02717304229736328  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.02717304229736328  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

first layer input nodes number: 46395
first layer output nodes number: 24091
edges number: 168090
----------------------------------------before model layer 0
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.027698516845703125  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([46395, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.027698516845703125  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.06350421905517578  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([24091, 256])
torch.Size([24091, 256])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.08647918701171875  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.06350421905517578  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([24091, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.08647918701171875  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.0922231674194336  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

input nodes number: 24091
output nodes number: 12384
edges number: 122066
----------------------------------------before model layer 1
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.09249544143676758  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([24091, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.09249544143676758  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11711835861206055  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([12384, 256])
torch.Size([12384, 256])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.12892866134643555  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11711835861206055  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([12384, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.12892866134643555  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.13210487365722656  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------input nodes number: 12384
----------------output nodes number: 5854
----------------edges number: 53913
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.13224124908447266  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1391429901123047  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([5854, 40])
torch.Size([5854, 40])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1400156021118164  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1391429901123047  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([5854, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.13919305801391602  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.14006614685058594  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.032329559326171875  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

pseudo mini batch 9 input nodes size: 58926
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.024657726287841797  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.024657726287841797  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.05275583267211914  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.05279731750488281  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.03063058853149414  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.03317117691040039  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.03317117691040039  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

first layer input nodes number: 58926
first layer output nodes number: 28926
edges number: 194529
----------------------------------------before model layer 0
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.03382587432861328  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([58926, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.03382587432861328  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.07676219940185547  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([28926, 256])
torch.Size([28926, 256])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.10434818267822266  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.07676219940185547  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([28926, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.10434818267822266  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11124467849731445  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

input nodes number: 28926
output nodes number: 12439
edges number: 107275
----------------------------------------before model layer 1
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11155319213867188  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([28926, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11155319213867188  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.13617229461669922  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([12439, 256])
torch.Size([12439, 256])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.14803504943847656  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.13617229461669922  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([12439, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.14803504943847656  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1510009765625  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------input nodes number: 12439
----------------output nodes number: 5526
----------------edges number: 38938
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.15113544464111328  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1575617790222168  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([5526, 40])
torch.Size([5526, 40])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1583852767944336  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1575617790222168  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([5526, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.15751266479492188  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.15833663940429688  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.038181304931640625  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

pseudo mini batch 10 input nodes size: 46552
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.03058147430419922  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.03058147430419922  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.052779197692871094  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.05282306671142578  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.024683475494384766  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.027178287506103516  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.027178287506103516  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

first layer input nodes number: 46552
first layer output nodes number: 23887
edges number: 173251
----------------------------------------before model layer 0
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.02770376205444336  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([46552, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.02770376205444336  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.06325483322143555  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([23887, 256])
torch.Size([23887, 256])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.08603525161743164  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.06325483322143555  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([23887, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.08603525161743164  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.09173059463500977  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

input nodes number: 23887
output nodes number: 10913
edges number: 107616
----------------------------------------before model layer 1
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.09199047088623047  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([23887, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.09199047088623047  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11368942260742188  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([10913, 256])
torch.Size([10913, 256])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.12409687042236328  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11368942260742188  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([10913, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.12409687042236328  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.12736129760742188  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------input nodes number: 10913
----------------output nodes number: 5854
----------------edges number: 53867
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1274867057800293  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.13438749313354492  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([5854, 40])
torch.Size([5854, 40])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.13526010513305664  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.13438749313354492  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([5854, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.13443660736083984  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.13530969619750977  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.032118797302246094  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

pseudo mini batch 11 input nodes size: 46369
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.024732589721679688  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.024732589721679688  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.04684305191040039  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.046885013580322266  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.024643421173095703  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.026504039764404297  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.026504039764404297  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

first layer input nodes number: 46369
first layer output nodes number: 19885
edges number: 131664
----------------------------------------before model layer 0
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.026998043060302734  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([46369, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.026998043060302734  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.057066917419433594  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([19885, 256])
torch.Size([19885, 256])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.07603073120117188  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.056499481201171875  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([19885, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.07603073120117188  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.08077192306518555  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

input nodes number: 19885
output nodes number: 9659
edges number: 75738
----------------------------------------before model layer 1
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.08099222183227539  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([19885, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.08099222183227539  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1000523567199707  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([9659, 256])
torch.Size([9659, 256])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.10926389694213867  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1000523567199707  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([9659, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.10926389694213867  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11156702041625977  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------input nodes number: 9659
----------------output nodes number: 5589
----------------edges number: 42118
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11168098449707031  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11820077896118164  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([5589, 40])
torch.Size([5589, 40])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1190338134765625  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11820077896118164  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([5589, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11816120147705078  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11899471282958984  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.03027486801147461  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

pseudo mini batch 12 input nodes size: 50240
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.024603843688964844  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.024603843688964844  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.048560142517089844  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.04860353469848633  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.02645111083984375  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.028532981872558594  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.028532981872558594  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

first layer input nodes number: 50240
first layer output nodes number: 23090
edges number: 151183
----------------------------------------before model layer 0
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.029079437255859375  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([50240, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.029079437255859375  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.0633234977722168  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([23090, 256])
torch.Size([23090, 256])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.08534383773803711  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.0633234977722168  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([23090, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.08534383773803711  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.09084892272949219  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

input nodes number: 23090
output nodes number: 11213
edges number: 86674
----------------------------------------before model layer 1
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.09110498428344727  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([23090, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.09110498428344727  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11322259902954102  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([11213, 256])
torch.Size([11213, 256])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1239161491394043  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11322259902954102  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([11213, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1239161491394043  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.12689447402954102  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------input nodes number: 11213
----------------output nodes number: 5814
----------------edges number: 41302
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.12702178955078125  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.13378477096557617  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([5814, 40])
torch.Size([5814, 40])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.13465118408203125  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.13378477096557617  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([5814, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1338181495666504  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.13468503952026367  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.03281116485595703  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

pseudo mini batch 13 input nodes size: 75449
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.02648448944091797  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.02648448944091797  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.06246137619018555  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.06250476837158203  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.03850507736206055  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.04151773452758789  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.04151773452758789  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

first layer input nodes number: 75449
first layer output nodes number: 34282
edges number: 241564
----------------------------------------before model layer 0
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.04233551025390625  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([75449, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.04233551025390625  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.09330463409423828  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([34282, 256])
torch.Size([34282, 256])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.12599849700927734  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.09330463409423828  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([34282, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.12599849700927734  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1341719627380371  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

input nodes number: 34282
output nodes number: 13270
edges number: 117736
----------------------------------------before model layer 1
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.13452672958374023  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([34282, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.13452672958374023  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1608138084411621  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([13270, 256])
torch.Size([13270, 256])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.17346906661987305  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1608138084411621  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([13270, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.17346906661987305  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.17665338516235352  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------input nodes number: 13270
----------------output nodes number: 5768
----------------edges number: 44845
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.17679595947265625  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.18353509902954102  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([5768, 40])
torch.Size([5768, 40])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.18439483642578125  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.18353509902954102  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([5768, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.18352842330932617  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1843886375427246  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.04742765426635742  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

pseudo mini batch 14 input nodes size: 86643
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.0384984016418457  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.0384984016418457  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.07981300354003906  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.07985687255859375  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.04383659362792969  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.04761981964111328  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.04761981964111328  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

first layer input nodes number: 86643
first layer output nodes number: 40864
edges number: 310280
----------------------------------------before model layer 0
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.04857015609741211  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([86643, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.04857015609741211  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.10967588424682617  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([40864, 256])
torch.Size([40864, 256])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.14864683151245117  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.10967588424682617  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([40864, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.14864683151245117  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.15838956832885742  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

input nodes number: 40864
output nodes number: 13953
edges number: 145134
----------------------------------------before model layer 1
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1587986946105957  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([40864, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1587986946105957  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.18732881546020508  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([13953, 256])
torch.Size([13953, 256])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.20063543319702148  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.18696355819702148  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([13953, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.20063543319702148  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.2035970687866211  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------input nodes number: 13953
----------------output nodes number: 5845
----------------edges number: 52128
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.20374536514282227  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.21062374114990234  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([5845, 40])
torch.Size([5845, 40])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.21149492263793945  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.21062374114990234  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([5845, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.21063518524169922  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.21150684356689453  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.054963111877441406  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

pseudo mini batch 15 input nodes size: 44778
----------------------------------------before load block subtensor 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.04384803771972656  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.04384803771972656  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.0651998519897461  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.06524324417114258  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.02388477325439453  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.025468826293945312  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.025468826293945312  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

first layer input nodes number: 44778
first layer output nodes number: 19882
edges number: 119685
----------------------------------------before model layer 0
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.025950908660888672  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([44778, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.025950908660888672  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.05592966079711914  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([19882, 256])
torch.Size([19882, 256])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.0748906135559082  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.0553593635559082  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([19882, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.0748906135559082  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.07963085174560547  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

input nodes number: 19882
output nodes number: 10008
edges number: 60904
----------------------------------------before model layer 1
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.07985401153564453  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([19882, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.07985401153564453  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.0994720458984375  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([10008, 256])
torch.Size([10008, 256])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.10901641845703125  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.0994720458984375  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([10008, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.10945892333984375  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11140251159667969  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------input nodes number: 10008
----------------output nodes number: 5777
----------------edges number: 31842
----------------------------------------before mean aggregator
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11152076721191406  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11817264556884766  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([5777, 40])
torch.Size([5777, 40])
----------------------------------------after rst
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.1190338134765625  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11817264556884766  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

torch.Size([5777, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11816263198852539  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.11902427673339844  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.02880382537841797  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.03042125701904297  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 0.03042125701904297  GigaBytes
Max Memory Allocated: 0.44493532180786133  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.017490610480308533 |0.025716274976730347 |0.06022803485393524 |0.0001465827226638794 |0.0031944960355758667 |0.0017077922821044922 |
----------------------------------------------------------pseudo_mini_loss sum 4.591660022735596
Total (block generation + training)time/epoch 26.875312328338623
Training time/epoch 1.7512426376342773
Training time without block to device /epoch 1.3397822380065918
Training time without total dataloading part /epoch 1.0188136100769043
load block tensor time/epoch 0.2798497676849365
block to device time/epoch 0.41146039962768555
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2228806
Number of first layer input nodes during this epoch:  1249336
Number of first layer output nodes during this epoch:  700914
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  217088
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([40, 256])
layers.2.fc_neigh.weight, torch.Size([40, 256])
----------------------------------------
un-trainable parameters
