main start at this time 1657097312.7491028
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.047275543212890625
number of batches is  4
batch size is  22736
random selection method spend 0.006655216217041016
time for parepare:  0.018397092819213867
local_output_nid generation:  0.008239030838012695
local_in_edges_tensor generation:  0.008611679077148438
mini_batch_src_global generation:  0.006788492202758789
r_  generation:  0.08137035369873047
local_output_nid generation:  0.011446714401245117
local_in_edges_tensor generation:  0.005800485610961914
mini_batch_src_global generation:  0.008710384368896484
r_  generation:  0.08641815185546875
local_output_nid generation:  0.011744976043701172
local_in_edges_tensor generation:  0.005956411361694336
mini_batch_src_global generation:  0.0064411163330078125
r_  generation:  0.09011721611022949
local_output_nid generation:  0.01179957389831543
local_in_edges_tensor generation:  0.005640268325805664
mini_batch_src_global generation:  0.007355690002441406
r_  generation:  0.09178280830383301
----------------------check_connections_block total spend ----------------------------- 0.5487790107727051
generate_one_block  0.10056304931640625
generate_one_block  0.10150623321533203
generate_one_block  0.10516524314880371
generate_one_block  0.10305333137512207
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.02754044532775879
gen group dst list time:  0.01140904426574707
time for parepare:  0.018767833709716797
local_output_nid generation:  0.01960921287536621
local_in_edges_tensor generation:  0.03621411323547363
mini_batch_src_global generation:  0.03504586219787598
r_  generation:  0.38190364837646484
local_output_nid generation:  0.02458667755126953
local_in_edges_tensor generation:  0.03692364692687988
mini_batch_src_global generation:  0.04453873634338379
r_  generation:  0.3958444595336914
local_output_nid generation:  0.024649620056152344
local_in_edges_tensor generation:  0.030522823333740234
mini_batch_src_global generation:  0.04427528381347656
r_  generation:  0.46312975883483887
local_output_nid generation:  0.025435686111450195
local_in_edges_tensor generation:  0.027813434600830078
mini_batch_src_global generation:  0.0587925910949707
r_  generation:  0.39850497245788574
----------------------check_connections_block total spend ----------------------------- 2.415363311767578
generate_one_block  0.5175821781158447
generate_one_block  0.5403974056243896
generate_one_block  0.5070726871490479
generate_one_block  0.502328634262085
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.030878782272338867
gen group dst list time:  0.020582914352416992
time for parepare:  0.018283605575561523
local_output_nid generation:  0.028427839279174805
local_in_edges_tensor generation:  0.04432368278503418
mini_batch_src_global generation:  0.04403209686279297
r_  generation:  0.5018305778503418
local_output_nid generation:  0.03535580635070801
local_in_edges_tensor generation:  0.0496220588684082
mini_batch_src_global generation:  0.05492806434631348
r_  generation:  0.5007846355438232
local_output_nid generation:  0.03626894950866699
local_in_edges_tensor generation:  0.03295111656188965
mini_batch_src_global generation:  0.05054497718811035
r_  generation:  0.5058431625366211
local_output_nid generation:  0.03561711311340332
local_in_edges_tensor generation:  0.03712940216064453
mini_batch_src_global generation:  0.054060935974121094
r_  generation:  0.5091228485107422
----------------------check_connections_block total spend ----------------------------- 2.9800305366516113
generate_one_block  0.6212756633758545
generate_one_block  0.6300439834594727
generate_one_block  0.6522362232208252
generate_one_block  0.6273927688598633
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018151521682739258
gen group dst list time:  0.023164749145507812
time for parepare:  0.018218040466308594
local_output_nid generation:  0.03269147872924805
local_in_edges_tensor generation:  0.037883758544921875
mini_batch_src_global generation:  0.029792070388793945
r_  generation:  0.3708934783935547
local_output_nid generation:  0.038193702697753906
local_in_edges_tensor generation:  0.037134408950805664
mini_batch_src_global generation:  0.03795623779296875
r_  generation:  0.3987240791320801
local_output_nid generation:  0.03939652442932129
local_in_edges_tensor generation:  0.03672957420349121
mini_batch_src_global generation:  0.038765907287597656
r_  generation:  0.37827014923095703
local_output_nid generation:  0.039472103118896484
local_in_edges_tensor generation:  0.034326791763305664
mini_batch_src_global generation:  0.05242490768432617
r_  generation:  0.40828728675842285
----------------------check_connections_block total spend ----------------------------- 2.398340940475464
generate_one_block  0.48139214515686035
generate_one_block  0.4623250961303711
generate_one_block  0.45467567443847656
generate_one_block  0.4826192855834961
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

connection checking time:  7.793734788894653
block generation total time  6.479341745376587
average batch blocks generation time:  1.6198354363441467
block dataloader generation time/epoch 15.794094324111938
pseudo mini batch 0 input nodes size: 165979
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.0813751220703125  GigaBytes
Max Memory Allocated: 0.0813751220703125  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.08154487609863281  GigaBytes
Max Memory Allocated: 0.08154487609863281  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.08154487609863281  GigaBytes
Max Memory Allocated: 0.08154487609863281  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.11180305480957031  GigaBytes
Max Memory Allocated: 0.11180305480957031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.11180305480957031  GigaBytes
Max Memory Allocated: 0.11180305480957031  GigaBytes

first layer input nodes number: 165979
first layer output nodes number: 164088
edges number: 1037070
----------------------------------------before model layer 0
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.11426258087158203  GigaBytes
Max Memory Allocated: 0.11812639236450195  GigaBytes

torch.Size([165979, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.11426258087158203  GigaBytes
Max Memory Allocated: 0.11812639236450195  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.7987060546875 GB
    Memory Allocated: 0.3575296401977539  GigaBytes
Max Memory Allocated: 0.3575296401977539  GigaBytes

torch.Size([164088, 256])
torch.Size([164088, 256])
----------------------------------------after rst
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5140161514282227  GigaBytes
Max Memory Allocated: 0.6705026626586914  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.3575296401977539  GigaBytes
Max Memory Allocated: 0.6705026626586914  GigaBytes

torch.Size([164088, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5140161514282227  GigaBytes
Max Memory Allocated: 0.6705026626586914  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5531377792358398  GigaBytes
Max Memory Allocated: 0.7096242904663086  GigaBytes

input nodes number: 164088
output nodes number: 153855
edges number: 1537265
----------------------------------------before model layer 1
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5565710067749023  GigaBytes
Max Memory Allocated: 0.7096242904663086  GigaBytes

torch.Size([164088, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.5565710067749023  GigaBytes
Max Memory Allocated: 0.7096242904663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.3319091796875 GB
    Memory Allocated: 0.8626480102539062  GigaBytes
Max Memory Allocated: 0.8626480102539062  GigaBytes

torch.Size([153855, 256])
torch.Size([153855, 256])
----------------------------------------after rst
 Nvidia-smi: 2.6287841796875 GB
    Memory Allocated: 1.0093755722045898  GigaBytes
Max Memory Allocated: 1.1561031341552734  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.6287841796875 GB
    Memory Allocated: 0.8626480102539062  GigaBytes
Max Memory Allocated: 1.1561031341552734  GigaBytes

torch.Size([153855, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.6287841796875 GB
    Memory Allocated: 1.0093755722045898  GigaBytes
Max Memory Allocated: 1.1561031341552734  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.6287841796875 GB
    Memory Allocated: 1.0460577011108398  GigaBytes
Max Memory Allocated: 1.1927852630615234  GigaBytes

input nodes number: 153855
output nodes number: 101638
edges number: 1227473
----------------------------------------before model layer 2
 Nvidia-smi: 2.6287841796875 GB
    Memory Allocated: 1.048525333404541  GigaBytes
Max Memory Allocated: 1.1927852630615234  GigaBytes

torch.Size([153855, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.6287841796875 GB
    Memory Allocated: 1.048525333404541  GigaBytes
Max Memory Allocated: 1.1927852630615234  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.7264404296875 GB
    Memory Allocated: 1.2530150413513184  GigaBytes
Max Memory Allocated: 1.2530150413513184  GigaBytes

torch.Size([101638, 256])
torch.Size([101638, 256])
----------------------------------------after rst
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.3506712913513184  GigaBytes
Max Memory Allocated: 1.4483275413513184  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.25374174118042  GigaBytes
Max Memory Allocated: 1.4483275413513184  GigaBytes

torch.Size([101638, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.35139799118042  GigaBytes
Max Memory Allocated: 1.4483275413513184  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 2.9217529296875 GB
    Memory Allocated: 1.374903678894043  GigaBytes
Max Memory Allocated: 1.472559928894043  GigaBytes

----------------input nodes number: 101638
----------------output nodes number: 22736
----------------edges number: 212170
----------------------------------------before mean aggregator
 Nvidia-smi: 2.9237060546875 GB
    Memory Allocated: 1.375831127166748  GigaBytes
Max Memory Allocated: 1.472559928894043  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.9256591796875 GB
    Memory Allocated: 1.4035391807556152  GigaBytes
Max Memory Allocated: 1.472559928894043  GigaBytes

torch.Size([22736, 40])
torch.Size([22736, 40])
----------------------------------------after rst
 Nvidia-smi: 2.9256591796875 GB
    Memory Allocated: 1.4069271087646484  GigaBytes
Max Memory Allocated: 1.472559928894043  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.9256591796875 GB
    Memory Allocated: 1.4026527404785156  GigaBytes
Max Memory Allocated: 1.472559928894043  GigaBytes

torch.Size([22736, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.9256591796875 GB
    Memory Allocated: 1.4060406684875488  GigaBytes
Max Memory Allocated: 1.472559928894043  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.9256591796875 GB
    Memory Allocated: 1.409651279449463  GigaBytes
Max Memory Allocated: 1.472559928894043  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 0.18129777908325195  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

pseudo mini batch 1 input nodes size: 166001
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 0.08623075485229492  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 0.08623075485229492  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 0.16630887985229492  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 0.16647863388061523  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 0.08623075485229492  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 0.11684608459472656  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 0.11684608459472656  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

first layer input nodes number: 166001
first layer output nodes number: 164116
edges number: 1037288
----------------------------------------before model layer 0
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 0.1199793815612793  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([166001, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 0.1199793815612793  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 0.36308956146240234  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([164116, 256])
torch.Size([164116, 256])
----------------------------------------after rst
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 0.5196027755737305  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 0.36308956146240234  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([164116, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 0.5196027755737305  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 0.5587310791015625  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

input nodes number: 164116
output nodes number: 154038
edges number: 1537629
----------------------------------------before model layer 1
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 0.5621109008789062  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([164116, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 0.5621109008789062  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 0.868865966796875  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([154038, 256])
torch.Size([154038, 256])
----------------------------------------after rst
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 1.015768051147461  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 0.868865966796875  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([154038, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 1.015768051147461  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 1.0524935722351074  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

input nodes number: 154038
output nodes number: 101193
edges number: 1225831
----------------------------------------before model layer 2
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 1.0547833442687988  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([154038, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 1.0547833442687988  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 1.2576813697814941  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([101193, 256])
torch.Size([101193, 256])
----------------------------------------after rst
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 1.3541865348815918  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 1.2576813697814941  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([101193, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 1.3541865348815918  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 1.3783130645751953  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------input nodes number: 101193
----------------output nodes number: 22736
----------------edges number: 212273
----------------------------------------before mean aggregator
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 1.379237174987793  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 1.4061799049377441  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([22736, 40])
torch.Size([22736, 40])
----------------------------------------after rst
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 1.4095678329467773  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 1.406059741973877  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([22736, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 1.4061799049377441  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7459716796875 GB
    Memory Allocated: 1.4095683097839355  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.18232297897338867  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

pseudo mini batch 2 input nodes size: 165962
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.08635091781616211  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.08635091781616211  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.1664290428161621  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.16659879684448242  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.08635091781616211  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.11618757247924805  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.11618757247924805  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

first layer input nodes number: 165962
first layer output nodes number: 164106
edges number: 1036990
----------------------------------------before model layer 0
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.1187601089477539  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([165962, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.1187601089477539  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.36292076110839844  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([164106, 256])
torch.Size([164106, 256])
----------------------------------------after rst
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.5194244384765625  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.36292076110839844  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([164106, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.5194244384765625  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.5585503578186035  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

input nodes number: 164106
output nodes number: 153770
edges number: 1536508
----------------------------------------before model layer 1
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.5619492530822754  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([164106, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.5619492530822754  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.8678364753723145  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([153770, 256])
torch.Size([153770, 256])
----------------------------------------after rst
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.0144829750061035  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.8678364753723145  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([153770, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.0144829750061035  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.0511445999145508  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

input nodes number: 153770
output nodes number: 100807
edges number: 1220340
----------------------------------------before model layer 2
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.0536870956420898  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([153770, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.0536870956420898  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.2558050155639648  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([100807, 256])
torch.Size([100807, 256])
----------------------------------------after rst
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.3519420623779297  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.2558050155639648  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([100807, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.3519420623779297  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.3759765625  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------input nodes number: 100807
----------------output nodes number: 22736
----------------edges number: 210608
----------------------------------------before mean aggregator
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.3768978118896484  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.404325008392334  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([22736, 40])
torch.Size([22736, 40])
----------------------------------------after rst
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.4077129364013672  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.4037079811096191  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([22736, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.4042048454284668  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.4077134132385254  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.18233919143676758  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

pseudo mini batch 3 input nodes size: 166007
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.08684778213500977  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.08684778213500977  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.16692590713500977  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.16709566116333008  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.08684778213500977  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.11690330505371094  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.11690330505371094  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

first layer input nodes number: 166007
first layer output nodes number: 164041
edges number: 1036956
----------------------------------------before model layer 0
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.11998510360717773  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([166007, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.11998510360717773  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.36298561096191406  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([164041, 256])
torch.Size([164041, 256])
----------------------------------------after rst
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.5194272994995117  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.36298561096191406  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([164041, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.5194272994995117  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.5585379600524902  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

input nodes number: 164041
output nodes number: 153917
edges number: 1536782
----------------------------------------before model layer 1
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.5620608329772949  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([164041, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.5620608329772949  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.8685860633850098  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([153917, 256])
torch.Size([153917, 256])
----------------------------------------after rst
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.0153727531433105  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.8685860633850098  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([153917, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.0153727531433105  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.0520696640014648  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

input nodes number: 153917
output nodes number: 101322
edges number: 1219779
----------------------------------------before model layer 2
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.0544757843017578  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([153917, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.0544757843017578  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.2575759887695312  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([101322, 256])
torch.Size([101322, 256])
----------------------------------------after rst
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.3542041778564453  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.2575759887695312  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([101322, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.3542041778564453  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.3783612251281738  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------input nodes number: 101322
----------------output nodes number: 22733
----------------edges number: 211228
----------------------------------------before mean aggregator
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.379286289215088  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.406205177307129  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([22733, 40])
torch.Size([22733, 40])
----------------------------------------after rst
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.409593105316162  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.4060983657836914  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

torch.Size([22733, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.405588150024414  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.4095935821533203  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 0.18184709548950195  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.18444108963012695  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.7498779296875 GB
    Memory Allocated: 0.18444108963012695  GigaBytes
Max Memory Allocated: 1.578235149383545  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04004180431365967 |0.11132657527923584 |0.2250383496284485 |0.00017762184143066406 |0.017480194568634033 |0.002268075942993164 |
----------------------------------------------------------pseudo_mini_loss sum 6.494275093078613
Total (block generation + training)time/epoch 17.409056901931763
Training time/epoch 1.6146292686462402
Training time without block to device /epoch 1.1693229675292969
Training time without total dataloading part /epoch 0.9730527400970459
load block tensor time/epoch 0.16016721725463867
block to device time/epoch 0.44530630111694336
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  2340840
Number of first layer input nodes during this epoch:  663949
Number of first layer output nodes during this epoch:  656351
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  348160
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([40, 256])
layers.3.fc_neigh.weight, torch.Size([40, 256])
----------------------------------------
un-trainable parameters
