main start at this time 1657074087.5933917
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

  NumNodes: 2708
  NumEdges: 10556
  NumFeats: 1433
  NumClasses: 7
  NumTrainingSamples: 140
  NumValidationSamples: 500
  NumTestSamples: 1000
Done loading data from cached files.
success----------------------------------------
140
500
2068
# Nodes: 2708
# Edges: 10556
# Train: 140
# Val: 500
# Test: 2068
# Classes: 7

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  1433
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00323486328125  GigaBytes
Max Memory Allocated: 0.00323486328125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00323486328125  GigaBytes
Max Memory Allocated: 0.00323486328125  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.0014064311981201172
number of batches is  2
batch size is  70
random selection method spend 0.0006718635559082031
time for parepare:  7.724761962890625e-05
local_output_nid generation:  5.817413330078125e-05
local_in_edges_tensor generation:  0.00030541419982910156
mini_batch_src_global generation:  3.0994415283203125e-05
r_  generation:  0.002234935760498047
local_output_nid generation:  2.0265579223632812e-05
local_in_edges_tensor generation:  0.00013566017150878906
mini_batch_src_global generation:  3.62396240234375e-05
r_  generation:  0.00012040138244628906
----------------------check_connections_block total spend ----------------------------- 0.0032482147216796875
generate_one_block  0.004675388336181641
generate_one_block  0.0013060569763183594
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.0004780292510986328
gen group dst list time:  6.127357482910156e-05
time for parepare:  0.00014734268188476562
local_output_nid generation:  2.5272369384765625e-05
local_in_edges_tensor generation:  0.0002372264862060547
mini_batch_src_global generation:  8.392333984375e-05
r_  generation:  0.0006105899810791016
local_output_nid generation:  2.7894973754882812e-05
local_in_edges_tensor generation:  0.00018310546875
mini_batch_src_global generation:  8.20159912109375e-05
r_  generation:  0.0006623268127441406
----------------------check_connections_block total spend ----------------------------- 0.00244903564453125
generate_one_block  0.0017733573913574219
generate_one_block  0.0017583370208740234
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.0005757808685302734
gen group dst list time:  4.887580871582031e-05
time for parepare:  0.00016117095947265625
local_output_nid generation:  6.175041198730469e-05
local_in_edges_tensor generation:  0.0003044605255126953
mini_batch_src_global generation:  0.00011277198791503906
r_  generation:  0.001344442367553711
local_output_nid generation:  6.866455078125e-05
local_in_edges_tensor generation:  0.0002281665802001953
mini_batch_src_global generation:  0.00019097328186035156
r_  generation:  0.0015528202056884766
----------------------check_connections_block total spend ----------------------------- 0.004732608795166016
generate_one_block  0.0026903152465820312
generate_one_block  0.0026497840881347656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00323486328125  GigaBytes
Max Memory Allocated: 0.00323486328125  GigaBytes

connection checking time:  0.007181644439697266
block generation total time  0.008871793746948242
average batch blocks generation time:  0.004435896873474121
block dataloader generation time/epoch 0.03381085395812988
pseudo mini batch 0 input nodes size: 1723
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00323486328125  GigaBytes
Max Memory Allocated: 0.00323486328125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.00323486328125  GigaBytes
Max Memory Allocated: 0.00323486328125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.012433052062988281  GigaBytes
Max Memory Allocated: 0.012433052062988281  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.012434005737304688  GigaBytes
Max Memory Allocated: 0.012434005737304688  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0369873046875 GB
    Memory Allocated: 0.012434005737304688  GigaBytes
Max Memory Allocated: 0.012434005737304688  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.012483596801757812  GigaBytes
Max Memory Allocated: 0.012483596801757812  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.012483596801757812  GigaBytes
Max Memory Allocated: 0.012483596801757812  GigaBytes

first layer input nodes number: 1723
first layer output nodes number: 994
edges number: 4315
----------------------------------------before model layer 0
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.012504100799560547  GigaBytes
Max Memory Allocated: 0.012520313262939453  GigaBytes

torch.Size([1723, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.012504100799560547  GigaBytes
Max Memory Allocated: 0.012520313262939453  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2869873046875 GB
    Memory Allocated: 0.018795013427734375  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

torch.Size([994, 256])
torch.Size([994, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.019742965698242188  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.018795013427734375  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

torch.Size([994, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.019742965698242188  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01997995376586914  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

input nodes number: 994
output nodes number: 337
edges number: 1846
----------------------------------------before model layer 1
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01999044418334961  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

torch.Size([994, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.01999044418334961  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2889404296875 GB
    Memory Allocated: 0.020650386810302734  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

torch.Size([337, 256])
torch.Size([337, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02097177505493164  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.020650386810302734  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

torch.Size([337, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02097177505493164  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02105236053466797  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

----------------input nodes number: 337
----------------output nodes number: 70
----------------edges number: 307
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.021056175231933594  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02112865447998047  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

torch.Size([70, 7])
torch.Size([70, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02113056182861328  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02112865447998047  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

torch.Size([70, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.02113056182861328  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2908935546875 GB
    Memory Allocated: 0.0211334228515625  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01583385467529297  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

pseudo mini batch 1 input nodes size: 1728
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015671730041503906  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015671730041503906  GigaBytes
Max Memory Allocated: 0.023157596588134766  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024896621704101562  GigaBytes
Max Memory Allocated: 0.024896621704101562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02489757537841797  GigaBytes
Max Memory Allocated: 0.02489757537841797  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01569843292236328  GigaBytes
Max Memory Allocated: 0.02489757537841797  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01575183868408203  GigaBytes
Max Memory Allocated: 0.02489757537841797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01575183868408203  GigaBytes
Max Memory Allocated: 0.02489757537841797  GigaBytes

first layer input nodes number: 1728
first layer output nodes number: 1044
edges number: 4656
----------------------------------------before model layer 0
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01577281951904297  GigaBytes
Max Memory Allocated: 0.02489757537841797  GigaBytes

torch.Size([1728, 1433])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.01577281951904297  GigaBytes
Max Memory Allocated: 0.02489757537841797  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022381305694580078  GigaBytes
Max Memory Allocated: 0.026963233947753906  GigaBytes

torch.Size([1044, 256])
torch.Size([1044, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023376941680908203  GigaBytes
Max Memory Allocated: 0.026963233947753906  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.022381305694580078  GigaBytes
Max Memory Allocated: 0.026963233947753906  GigaBytes

torch.Size([1044, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024127483367919922  GigaBytes
Max Memory Allocated: 0.026963233947753906  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023625850677490234  GigaBytes
Max Memory Allocated: 0.026963233947753906  GigaBytes

input nodes number: 1044
output nodes number: 346
edges number: 2040
----------------------------------------before model layer 1
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023636817932128906  GigaBytes
Max Memory Allocated: 0.026963233947753906  GigaBytes

torch.Size([1044, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023636817932128906  GigaBytes
Max Memory Allocated: 0.026963233947753906  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02431488037109375  GigaBytes
Max Memory Allocated: 0.026963233947753906  GigaBytes

torch.Size([346, 256])
torch.Size([346, 256])
----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024644851684570312  GigaBytes
Max Memory Allocated: 0.026963233947753906  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02431488037109375  GigaBytes
Max Memory Allocated: 0.026963233947753906  GigaBytes

torch.Size([346, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024644851684570312  GigaBytes
Max Memory Allocated: 0.026963233947753906  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024727344512939453  GigaBytes
Max Memory Allocated: 0.026963233947753906  GigaBytes

----------------input nodes number: 346
----------------output nodes number: 70
----------------edges number: 323
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024731159210205078  GigaBytes
Max Memory Allocated: 0.026963233947753906  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024803638458251953  GigaBytes
Max Memory Allocated: 0.026963233947753906  GigaBytes

torch.Size([70, 7])
torch.Size([70, 7])
----------------------------------------after rst
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024805545806884766  GigaBytes
Max Memory Allocated: 0.026963233947753906  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024803638458251953  GigaBytes
Max Memory Allocated: 0.026963233947753906  GigaBytes

torch.Size([70, 7])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.024803638458251953  GigaBytes
Max Memory Allocated: 0.026963233947753906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.02480602264404297  GigaBytes
Max Memory Allocated: 0.026963233947753906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.015871047973632812  GigaBytes
Max Memory Allocated: 0.026963233947753906  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023107528686523438  GigaBytes
Max Memory Allocated: 0.027207374572753906  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 1.2947998046875 GB
    Memory Allocated: 0.023107528686523438  GigaBytes
Max Memory Allocated: 0.027207374572753906  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.0146104097366333 |0.17142093181610107 |0.3925027847290039 |0.000225067138671875 |0.004630327224731445 |0.002493619918823242 |
----------------------------------------------------------pseudo_mini_loss sum 1.9518232345581055
Total (block generation + training)time/epoch 1.2117969989776611
Training time/epoch 1.176990270614624
Training time without block to device /epoch 0.8341484069824219
Training time without total dataloading part /epoch 0.7972099781036377
load block tensor time/epoch 0.0292208194732666
block to device time/epoch 0.34284186363220215
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6172
Number of first layer input nodes during this epoch:  3451
Number of first layer output nodes during this epoch:  2038
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=1433, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=1433, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=7, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=7, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  868352
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 1433])
layers.0.fc_neigh.weight, torch.Size([256, 1433])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([7, 256])
layers.2.fc_neigh.weight, torch.Size([7, 256])
----------------------------------------
un-trainable parameters
