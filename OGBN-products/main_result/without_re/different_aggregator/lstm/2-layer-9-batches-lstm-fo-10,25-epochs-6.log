main start at this time 1656285680.043065
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2125530242919922
global_2_local spend time (sec) 0.44701051712036133
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.0500178337097168
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1008946, 25: 183378, 14: 695, 15: 673, 7: 655, 23: 648, 24: 645, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.07806730270385742
auxiliary_graph
Graph(num_nodes=1205517, num_edges=51765021,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.5140609741210938
remove nodes length  1008946

auxiliary_graph.remove_nodes spent  2.6696724891662598
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51765021,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.177517890930176

the counter of shared neighbor distribution
Counter({1.0: 42590028, 2.0: 5788940, 3.0: 1681220, 4.0: 685082, 5.0: 339486, 6.0: 181324, 7.0: 105316, 8.0: 61510, 9.0: 39426, 10.0: 25012, 11.0: 15858, 12.0: 10952, 13.0: 7442, 14.0: 6516, 15.0: 6134, 18.0: 4072, 16.0: 3816, 20.0: 2908, 17.0: 2726, 19.0: 2688, 22.0: 1912, 23.0: 1836, 21.0: 1684, 24.0: 1620, 25.0: 942})
51568450
Convert a graph into a bidirected graph: 2.966 seconds
Metis partitioning: 12.489 seconds
Split the graph: 1.832 seconds
Construct subgraphs: 0.380 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  17.688127040863037
22081
21248
21205
22445
21273
22490
22006
22436
21387
total k batches seeds list generation spend  32.287153244018555
after graph partition
graph partition algorithm spend time 32.89971899986267
22081
21248
21205
22445
21273
22490
22006
22436
21387
partition_len_list
[170623, 141387, 174132, 170663, 182573, 183236, 182972, 191285, 184014]
REG selection method  spend 33.583834171295166
time for parepare:  0.24540257453918457
local_output_nid generation:  0.005271196365356445
local_in_edges_tensor generation:  0.006850004196166992
mini_batch_src_global generation:  0.020679473876953125
r_  generation:  0.17814183235168457
local_output_nid generation:  0.00611424446105957
local_in_edges_tensor generation:  0.006555080413818359
mini_batch_src_global generation:  0.023935794830322266
r_  generation:  0.17522716522216797
local_output_nid generation:  0.00612330436706543
local_in_edges_tensor generation:  0.008954763412475586
mini_batch_src_global generation:  0.0246431827545166
r_  generation:  0.18863534927368164
local_output_nid generation:  0.006302356719970703
local_in_edges_tensor generation:  0.011820316314697266
mini_batch_src_global generation:  0.02379775047302246
r_  generation:  0.21157169342041016
local_output_nid generation:  0.006274223327636719
local_in_edges_tensor generation:  0.006718158721923828
mini_batch_src_global generation:  0.02338242530822754
r_  generation:  0.21773767471313477
local_output_nid generation:  0.006379842758178711
local_in_edges_tensor generation:  0.010157108306884766
mini_batch_src_global generation:  0.026238203048706055
r_  generation:  0.2447216510772705
local_output_nid generation:  0.0062541961669921875
local_in_edges_tensor generation:  0.006786346435546875
mini_batch_src_global generation:  0.025986433029174805
r_  generation:  0.2299633026123047
local_output_nid generation:  0.006334543228149414
local_in_edges_tensor generation:  0.0071108341217041016
mini_batch_src_global generation:  0.027721643447875977
r_  generation:  0.2597780227661133
local_output_nid generation:  0.006151914596557617
local_in_edges_tensor generation:  0.008006095886230469
mini_batch_src_global generation:  0.027504682540893555
r_  generation:  0.25038719177246094
----------------------check_connections_block total spend ----------------------------- 2.959228277206421
generate_one_block  1.8517587184906006
generate_one_block  0.2970709800720215
generate_one_block  0.33013153076171875
generate_one_block  0.3489954471588135
generate_one_block  0.38119983673095703
generate_one_block  0.3437931537628174
generate_one_block  0.2749519348144531
generate_one_block  0.29328012466430664
generate_one_block  0.2620248794555664
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7549588680267334
gen group dst list time:  0.0455927848815918
time for parepare:  0.3986976146697998
local_output_nid generation:  0.044435739517211914
local_in_edges_tensor generation:  0.11821770668029785
mini_batch_src_global generation:  0.052045345306396484
r_  generation:  0.6875886917114258
local_output_nid generation:  0.03655600547790527
local_in_edges_tensor generation:  0.0448307991027832
mini_batch_src_global generation:  0.0557398796081543
r_  generation:  0.5437405109405518
local_output_nid generation:  0.047507286071777344
local_in_edges_tensor generation:  0.053258419036865234
mini_batch_src_global generation:  0.06101655960083008
r_  generation:  0.7600069046020508
local_output_nid generation:  0.044814348220825195
local_in_edges_tensor generation:  0.04220461845397949
mini_batch_src_global generation:  0.07366681098937988
r_  generation:  0.747969388961792
local_output_nid generation:  0.04800128936767578
local_in_edges_tensor generation:  0.06109142303466797
mini_batch_src_global generation:  0.0726931095123291
r_  generation:  0.820671796798706
local_output_nid generation:  0.04881000518798828
local_in_edges_tensor generation:  0.06100916862487793
mini_batch_src_global generation:  0.07828259468078613
r_  generation:  0.8474278450012207
local_output_nid generation:  0.04882025718688965
local_in_edges_tensor generation:  0.048740386962890625
mini_batch_src_global generation:  0.07677650451660156
r_  generation:  0.8483948707580566
local_output_nid generation:  0.05067944526672363
local_in_edges_tensor generation:  0.05686759948730469
mini_batch_src_global generation:  0.08264613151550293
r_  generation:  0.9112825393676758
local_output_nid generation:  0.04989981651306152
local_in_edges_tensor generation:  0.10539364814758301
mini_batch_src_global generation:  0.0792703628540039
r_  generation:  0.8584578037261963
----------------------check_connections_block total spend ----------------------------- 10.54135537147522
generate_one_block  1.3238024711608887
generate_one_block  0.7085137367248535
generate_one_block  0.9290778636932373
generate_one_block  0.9024593830108643
generate_one_block  1.0081758499145508
generate_one_block  0.991447925567627
generate_one_block  0.9912004470825195
generate_one_block  1.0224087238311768
generate_one_block  0.9610741138458252
----------===============-------------===============-------------the number of batches *****---- 9

original number of batches:  9
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

connection checking time:  13.50058364868164
block generation total time  13.221367120742798
average batch blocks generation time:  0.7345203955968221
block dataloader generation time/epoch 62.37066340446472
pseudo mini batch 0 input nodes size: 445638
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1854248046875 GB
    Memory Allocated: 0.16855907440185547  GigaBytes
Max Memory Allocated: 0.16855907440185547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1854248046875 GB
    Memory Allocated: 0.16872406005859375  GigaBytes
Max Memory Allocated: 0.16872406005859375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1854248046875 GB
    Memory Allocated: 0.16872406005859375  GigaBytes
Max Memory Allocated: 0.16872406005859375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.18525123596191406  GigaBytes
Max Memory Allocated: 0.18525123596191406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2694091796875 GB
    Memory Allocated: 0.18525123596191406  GigaBytes
Max Memory Allocated: 0.18525123596191406  GigaBytes

first layer input nodes number: 445638
first layer output nodes number: 170623
edges number: 1673882
torch.Size([445638, 100])
torch.Size([170623, 256])
torch.Size([22081, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4979248046875 GB
    Memory Allocated: 18.1094069480896  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.4979248046875 GB
    Memory Allocated: 18.113582611083984  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.5487060546875 GB
    Memory Allocated: 0.21819782257080078  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

pseudo mini batch 1 input nodes size: 329101
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.5487060546875 GB
    Memory Allocated: 0.17513465881347656  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.5487060546875 GB
    Memory Allocated: 0.17513465881347656  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.5487060546875 GB
    Memory Allocated: 0.29773473739624023  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.5487060546875 GB
    Memory Allocated: 0.29789304733276367  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.5487060546875 GB
    Memory Allocated: 0.1317124366760254  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.5487060546875 GB
    Memory Allocated: 0.14562654495239258  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.5487060546875 GB
    Memory Allocated: 0.14562654495239258  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

first layer input nodes number: 329101
first layer output nodes number: 141387
edges number: 1364146
torch.Size([329101, 100])
torch.Size([141387, 256])
torch.Size([21248, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8201904296875 GB
    Memory Allocated: 15.598024368286133  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.8201904296875 GB
    Memory Allocated: 15.602368831634521  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.8240966796875 GB
    Memory Allocated: 0.16890478134155273  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

pseudo mini batch 2 input nodes size: 460524
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.8240966796875 GB
    Memory Allocated: 0.13156652450561523  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.8240966796875 GB
    Memory Allocated: 0.13156652450561523  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.8240966796875 GB
    Memory Allocated: 0.30312538146972656  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.8240966796875 GB
    Memory Allocated: 0.30328369140625  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.8240966796875 GB
    Memory Allocated: 0.1805253028869629  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.8240966796875 GB
    Memory Allocated: 0.19722366333007812  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8240966796875 GB
    Memory Allocated: 0.19722366333007812  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

first layer input nodes number: 460524
first layer output nodes number: 174132
edges number: 1683332
torch.Size([460524, 100])
torch.Size([174132, 256])
torch.Size([21205, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 17.711374282836914  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 17.715307235717773  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 0.22601699829101562  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

pseudo mini batch 3 input nodes size: 403817
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 0.18073749542236328  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 0.18073749542236328  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 0.33117151260375977  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 0.33133888244628906  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 0.1596217155456543  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 0.17579221725463867  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 0.17579221725463867  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

first layer input nodes number: 403817
first layer output nodes number: 170663
edges number: 1629070
torch.Size([403817, 100])
torch.Size([170663, 256])
torch.Size([22445, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 17.778120040893555  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 17.782050609588623  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 0.20304584503173828  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

pseudo mini batch 4 input nodes size: 540365
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 0.15980815887451172  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 0.15980815887451172  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 0.36111021041870117  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 0.3612689971923828  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 0.21066761016845703  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 0.22813129425048828  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4530029296875 GB
    Memory Allocated: 0.22813129425048828  GigaBytes
Max Memory Allocated: 19.13036346435547  GigaBytes

first layer input nodes number: 540365
first layer output nodes number: 182573
edges number: 1777471
torch.Size([540365, 100])
torch.Size([182573, 256])
torch.Size([21273, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7420654296875 GB
    Memory Allocated: 18.222156524658203  GigaBytes
Max Memory Allocated: 19.155667781829834  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.7420654296875 GB
    Memory Allocated: 18.22627592086792  GigaBytes
Max Memory Allocated: 19.155667781829834  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.7166748046875 GB
    Memory Allocated: 0.25614070892333984  GigaBytes
Max Memory Allocated: 19.155667781829834  GigaBytes

pseudo mini batch 5 input nodes size: 466023
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.7166748046875 GB
    Memory Allocated: 0.21030330657958984  GigaBytes
Max Memory Allocated: 19.155667781829834  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.7166748046875 GB
    Memory Allocated: 0.21030330657958984  GigaBytes
Max Memory Allocated: 19.155667781829834  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.7166748046875 GB
    Memory Allocated: 0.3839106559753418  GigaBytes
Max Memory Allocated: 19.155667781829834  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.7166748046875 GB
    Memory Allocated: 0.3840785026550293  GigaBytes
Max Memory Allocated: 19.155667781829834  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.7166748046875 GB
    Memory Allocated: 0.1826176643371582  GigaBytes
Max Memory Allocated: 19.155667781829834  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.7166748046875 GB
    Memory Allocated: 0.20041704177856445  GigaBytes
Max Memory Allocated: 19.155667781829834  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7166748046875 GB
    Memory Allocated: 0.20041704177856445  GigaBytes
Max Memory Allocated: 19.155667781829834  GigaBytes

first layer input nodes number: 466023
first layer output nodes number: 183236
edges number: 1810592
torch.Size([466023, 100])
torch.Size([183236, 256])
torch.Size([22490, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6014404296875 GB
    Memory Allocated: 19.13176727294922  GigaBytes
Max Memory Allocated: 20.176743030548096  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.6014404296875 GB
    Memory Allocated: 19.135705947875977  GigaBytes
Max Memory Allocated: 20.176743030548096  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.23023128509521484  GigaBytes
Max Memory Allocated: 20.176743030548096  GigaBytes

pseudo mini batch 6 input nodes size: 512063
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.18284320831298828  GigaBytes
Max Memory Allocated: 20.176743030548096  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.18284320831298828  GigaBytes
Max Memory Allocated: 20.176743030548096  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.37360191345214844  GigaBytes
Max Memory Allocated: 20.176743030548096  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.3737659454345703  GigaBytes
Max Memory Allocated: 20.176743030548096  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.19999074935913086  GigaBytes
Max Memory Allocated: 20.176743030548096  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.21746015548706055  GigaBytes
Max Memory Allocated: 20.176743030548096  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6639404296875 GB
    Memory Allocated: 0.21746015548706055  GigaBytes
Max Memory Allocated: 20.176743030548096  GigaBytes

first layer input nodes number: 512063
first layer output nodes number: 182972
edges number: 1795692
torch.Size([512063, 100])
torch.Size([182972, 256])
torch.Size([22006, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0936279296875 GB
    Memory Allocated: 18.330060482025146  GigaBytes
Max Memory Allocated: 20.176743030548096  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.0936279296875 GB
    Memory Allocated: 18.333914279937744  GigaBytes
Max Memory Allocated: 20.176743030548096  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.24507570266723633  GigaBytes
Max Memory Allocated: 20.176743030548096  GigaBytes

pseudo mini batch 7 input nodes size: 474138
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.19986391067504883  GigaBytes
Max Memory Allocated: 20.176743030548096  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.19986391067504883  GigaBytes
Max Memory Allocated: 20.176743030548096  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.3764944076538086  GigaBytes
Max Memory Allocated: 20.176743030548096  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.3766617774963379  GigaBytes
Max Memory Allocated: 20.176743030548096  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.18573904037475586  GigaBytes
Max Memory Allocated: 20.176743030548096  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.2039656639099121  GigaBytes
Max Memory Allocated: 20.176743030548096  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0975341796875 GB
    Memory Allocated: 0.2039656639099121  GigaBytes
Max Memory Allocated: 20.176743030548096  GigaBytes

first layer input nodes number: 474138
first layer output nodes number: 191285
edges number: 1888973
torch.Size([474138, 100])
torch.Size([191285, 256])
torch.Size([22436, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0877685546875 GB
    Memory Allocated: 19.59506607055664  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.0877685546875 GB
    Memory Allocated: 19.598995208740234  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.23321866989135742  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

pseudo mini batch 8 input nodes size: 451689
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.18581438064575195  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.18581438064575195  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.3540821075439453  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.35424184799194336  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.1774439811706543  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.19510650634765625  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.19510650634765625  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

first layer input nodes number: 451689
first layer output nodes number: 184014
edges number: 1820642
torch.Size([451689, 100])
torch.Size([184014, 256])
torch.Size([21387, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 18.760286808013916  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 18.7640323638916  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.22363615036010742  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.22872304916381836  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.22872304916381836  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.14097430970933703 |0.0500436888800727 |0.34873032569885254 |0.00015044212341308594 |0.24058686362372506 |0.0070858001708984375 |
----------------------------------------------------------pseudo_mini_loss sum 5.39233922958374
Total (block generation + training)time/epoch 69.55478143692017
Training time/epoch 7.183754205703735
Training time without block to device /epoch 6.733361005783081
Training time without total dataloading part /epoch 5.3122944831848145
load block tensor time/epoch 1.2687687873840332
block to device time/epoch 0.4503931999206543
input features size transfer per epoch 1.2069940567016602e-06
blocks size to device per epoch 8.046627044677734e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5664243
Number of first layer input nodes during this epoch:  4083358
Number of first layer output nodes during this epoch:  1580885
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.22872257232666016  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.31278276443481445
global_2_local spend time (sec) 0.48278021812438965
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.024730443954467773
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1009318, 25: 183378, 14: 695, 15: 673, 7: 655, 23: 648, 24: 645, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.08291077613830566
auxiliary_graph
Graph(num_nodes=1205889, num_edges=51794985,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.5327255725860596
remove nodes length  1009318

auxiliary_graph.remove_nodes spent  2.6559059619903564
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51794985,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.1599373817443848

the counter of shared neighbor distribution
Counter({1.0: 42607278, 2.0: 5798590, 3.0: 1682278, 4.0: 687306, 5.0: 338416, 6.0: 180568, 7.0: 105940, 8.0: 61720, 9.0: 39912, 10.0: 24758, 11.0: 16230, 12.0: 10690, 13.0: 7820, 14.0: 6560, 15.0: 6006, 18.0: 4060, 16.0: 4020, 20.0: 2902, 17.0: 2700, 19.0: 2636, 22.0: 1974, 23.0: 1828, 21.0: 1678, 24.0: 1600, 25.0: 944})
51598414
Convert a graph into a bidirected graph: 2.962 seconds
Metis partitioning: 13.208 seconds
Split the graph: 1.758 seconds
Construct subgraphs: 0.032 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  17.979262113571167
22156
22497
21214
21324
21321
21750
22496
21320
22493
total k batches seeds list generation spend  32.73683190345764
after graph partition
graph partition algorithm spend time 33.34687519073486
22156
22497
21214
21324
21321
21750
22496
21320
22493
partition_len_list
[201221, 184596, 174931, 171435, 153163, 173034, 169157, 158294, 174956]
REG selection method  spend 34.11018371582031
time for parepare:  0.2657654285430908
local_output_nid generation:  0.00577545166015625
local_in_edges_tensor generation:  0.006925344467163086
mini_batch_src_global generation:  0.02726578712463379
r_  generation:  0.20421314239501953
local_output_nid generation:  0.006827354431152344
local_in_edges_tensor generation:  0.008169174194335938
mini_batch_src_global generation:  0.026475906372070312
r_  generation:  0.22123193740844727
local_output_nid generation:  0.00657200813293457
local_in_edges_tensor generation:  0.007575273513793945
mini_batch_src_global generation:  0.020357608795166016
r_  generation:  0.19512200355529785
local_output_nid generation:  0.006571054458618164
local_in_edges_tensor generation:  0.0066072940826416016
mini_batch_src_global generation:  0.02177906036376953
r_  generation:  0.1938333511352539
local_output_nid generation:  0.022504329681396484
local_in_edges_tensor generation:  0.006617546081542969
mini_batch_src_global generation:  0.020689964294433594
r_  generation:  0.20407986640930176
local_output_nid generation:  0.007405996322631836
local_in_edges_tensor generation:  0.006972074508666992
mini_batch_src_global generation:  0.02363133430480957
r_  generation:  0.24653267860412598
local_output_nid generation:  0.008388042449951172
local_in_edges_tensor generation:  0.007118940353393555
mini_batch_src_global generation:  0.02510666847229004
r_  generation:  0.23318886756896973
local_output_nid generation:  0.006610870361328125
local_in_edges_tensor generation:  0.008265495300292969
mini_batch_src_global generation:  0.02375006675720215
r_  generation:  0.21573567390441895
local_output_nid generation:  0.008451223373413086
local_in_edges_tensor generation:  0.011069297790527344
mini_batch_src_global generation:  0.025156497955322266
r_  generation:  0.231703519821167
----------------------check_connections_block total spend ----------------------------- 3.0058481693267822
generate_one_block  0.557427167892456
generate_one_block  0.3659346103668213
generate_one_block  0.297435998916626
generate_one_block  0.25885605812072754
generate_one_block  0.2643256187438965
generate_one_block  0.2730424404144287
generate_one_block  0.2777750492095947
generate_one_block  0.3129308223724365
generate_one_block  0.26548027992248535
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7936046123504639
gen group dst list time:  0.049249887466430664
time for parepare:  0.4114234447479248
local_output_nid generation:  0.05547809600830078
local_in_edges_tensor generation:  0.12365078926086426
mini_batch_src_global generation:  0.06345248222351074
r_  generation:  0.8451941013336182
local_output_nid generation:  0.051117897033691406
local_in_edges_tensor generation:  0.06853222846984863
mini_batch_src_global generation:  0.07916617393493652
r_  generation:  0.7831528186798096
local_output_nid generation:  0.047081947326660156
local_in_edges_tensor generation:  0.05157279968261719
mini_batch_src_global generation:  0.0661163330078125
r_  generation:  0.7612950801849365
local_output_nid generation:  0.04874157905578613
local_in_edges_tensor generation:  0.05333757400512695
mini_batch_src_global generation:  0.06949520111083984
r_  generation:  0.7880196571350098
local_output_nid generation:  0.04027915000915527
local_in_edges_tensor generation:  0.034325599670410156
mini_batch_src_global generation:  0.06561589241027832
r_  generation:  0.6642313003540039
local_output_nid generation:  0.046770334243774414
local_in_edges_tensor generation:  0.04791855812072754
mini_batch_src_global generation:  0.07085919380187988
r_  generation:  0.8088724613189697
local_output_nid generation:  0.046759605407714844
local_in_edges_tensor generation:  0.13323187828063965
mini_batch_src_global generation:  0.08179569244384766
r_  generation:  0.8098275661468506
local_output_nid generation:  0.06586170196533203
local_in_edges_tensor generation:  0.05957317352294922
mini_batch_src_global generation:  0.06757974624633789
r_  generation:  0.7425131797790527
local_output_nid generation:  0.05800890922546387
local_in_edges_tensor generation:  0.04561161994934082
mini_batch_src_global generation:  0.0775001049041748
r_  generation:  0.8088874816894531
----------------------check_connections_block total spend ----------------------------- 10.609140872955322
generate_one_block  1.5208353996276855
generate_one_block  0.9657266139984131
generate_one_block  0.9765036106109619
generate_one_block  0.955420970916748
generate_one_block  0.7743375301361084
generate_one_block  0.9400482177734375
generate_one_block  0.8923454284667969
generate_one_block  0.8698458671569824
generate_one_block  0.9912524223327637
----------===============-------------===============-------------the number of batches *****---- 9

original number of batches:  9
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.22872257232666016  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

connection checking time:  13.614989042282104
block generation total time  11.75952410697937
average batch blocks generation time:  0.6533068948321872
block dataloader generation time/epoch 62.05794811248779
pseudo mini batch 0 input nodes size: 497607
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.18247556686401367  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.18247556686401367  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.36784887313842773  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.3680143356323242  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.1995868682861328  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.21855926513671875  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1580810546875 GB
    Memory Allocated: 0.21855926513671875  GigaBytes
Max Memory Allocated: 20.64892292022705  GigaBytes

first layer input nodes number: 497607
first layer output nodes number: 201221
edges number: 1994647
torch.Size([497607, 100])
torch.Size([201221, 256])
torch.Size([22156, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 20.176621437072754  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 20.18050193786621  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5897216796875 GB
    Memory Allocated: 0.25033998489379883  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 1 input nodes size: 412863
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5897216796875 GB
    Memory Allocated: 0.19990205764770508  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5897216796875 GB
    Memory Allocated: 0.19990205764770508  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5897216796875 GB
    Memory Allocated: 0.35370588302612305  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5897216796875 GB
    Memory Allocated: 0.35387372970581055  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5897216796875 GB
    Memory Allocated: 0.1683349609375  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5897216796875 GB
    Memory Allocated: 0.18617725372314453  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5897216796875 GB
    Memory Allocated: 0.18617725372314453  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 412863
first layer output nodes number: 184596
edges number: 1825019
torch.Size([412863, 100])
torch.Size([184596, 256])
torch.Size([22497, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2772216796875 GB
    Memory Allocated: 19.18819236755371  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2772216796875 GB
    Memory Allocated: 19.192131996154785  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2811279296875 GB
    Memory Allocated: 0.21377801895141602  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 2 input nodes size: 517256
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2811279296875 GB
    Memory Allocated: 0.16808557510375977  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2811279296875 GB
    Memory Allocated: 0.16808557510375977  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2811279296875 GB
    Memory Allocated: 0.36077880859375  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2811279296875 GB
    Memory Allocated: 0.36093711853027344  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2811279296875 GB
    Memory Allocated: 0.20696544647216797  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2811279296875 GB
    Memory Allocated: 0.22342395782470703  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2811279296875 GB
    Memory Allocated: 0.22342395782470703  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 517256
first layer output nodes number: 174931
edges number: 1701807
torch.Size([517256, 100])
torch.Size([174931, 256])
torch.Size([21214, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6717529296875 GB
    Memory Allocated: 17.73997449874878  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6717529296875 GB
    Memory Allocated: 17.743914127349854  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6737060546875 GB
    Memory Allocated: 0.2507805824279785  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 3 input nodes size: 520497
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6737060546875 GB
    Memory Allocated: 0.2067856788635254  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6737060546875 GB
    Memory Allocated: 0.2067856788635254  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6737060546875 GB
    Memory Allocated: 0.40068626403808594  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6737060546875 GB
    Memory Allocated: 0.4008455276489258  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6737060546875 GB
    Memory Allocated: 0.2079939842224121  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6737060546875 GB
    Memory Allocated: 0.22418451309204102  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6737060546875 GB
    Memory Allocated: 0.22418451309204102  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 520497
first layer output nodes number: 171435
edges number: 1684020
torch.Size([520497, 100])
torch.Size([171435, 256])
torch.Size([21324, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8143310546875 GB
    Memory Allocated: 17.368753910064697  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.8143310546875 GB
    Memory Allocated: 17.373327255249023  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.25240182876586914  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 4 input nodes size: 361292
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.20880746841430664  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.20880746841430664  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.3433995246887207  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.34355878829956055  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.14949893951416016  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.16505956649780273  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.16505956649780273  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 361292
first layer output nodes number: 153163
edges number: 1486913
torch.Size([361292, 100])
torch.Size([153163, 256])
torch.Size([21321, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 16.39926767349243  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 16.403841018676758  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.18957281112670898  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 5 input nodes size: 454411
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.14865922927856445  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.14865922927856445  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.31794071197509766  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.3181028366088867  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.1833515167236328  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.20046329498291016  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.20046329498291016  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 454411
first layer output nodes number: 173034
edges number: 1700902
torch.Size([454411, 100])
torch.Size([173034, 256])
torch.Size([21750, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 18.13516664505005  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 18.138975620269775  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.2277817726135254  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 6 input nodes size: 436259
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.1834268569946289  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.1834268569946289  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.3459463119506836  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.3461141586303711  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.17667055130004883  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.19315576553344727  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.19315576553344727  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 436259
first layer output nodes number: 169157
edges number: 1657560
torch.Size([436259, 100])
torch.Size([169157, 256])
torch.Size([22496, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 18.140528678894043  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 18.14521026611328  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.22043132781982422  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 7 input nodes size: 421706
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.17706537246704102  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.17706537246704102  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.33416318893432617  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.334322452545166  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.17163515090942383  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.18771791458129883  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.18771791458129883  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 421706
first layer output nodes number: 158294
edges number: 1519237
torch.Size([421706, 100])
torch.Size([158294, 256])
torch.Size([21320, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 16.742048740386963  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 16.746066093444824  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.21257257461547852  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 8 input nodes size: 421990
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.1714487075805664  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.1714487075805664  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.32865238189697266  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.32882022857666016  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.17156314849853516  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.18807697296142578  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.18807697296142578  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 421990
first layer output nodes number: 174956
edges number: 1673866
torch.Size([421990, 100])
torch.Size([174956, 256])
torch.Size([22493, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 18.071775436401367  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 18.075714588165283  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.21704864501953125  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.21704864501953125  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.21704864501953125  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.14828912417093912 |0.017858717176649306 |0.2050021489461263 |0.00015722380744086372 |0.2369084358215332 |0.006192445755004883 |
----------------------------------------------------------pseudo_mini_loss sum 4.861458778381348
Total (block generation + training)time/epoch 68.46679711341858
Training time/epoch 5.6331846714019775
Training time without block to device /epoch 5.472456216812134
Training time without total dataloading part /epoch 3.984802722930908
load block tensor time/epoch 1.3346021175384521
block to device time/epoch 0.16072845458984375
input features size transfer per epoch 1.2069940567016602e-06
blocks size to device per epoch 8.046627044677734e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  5604668
Number of first layer input nodes during this epoch:  4043881
Number of first layer output nodes during this epoch:  1560787
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.21704816818237305  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.33030104637145996
global_2_local spend time (sec) 0.510472297668457
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.03908872604370117
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1008915, 25: 183378, 14: 695, 15: 673, 7: 655, 23: 648, 24: 645, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.07877469062805176
auxiliary_graph
Graph(num_nodes=1205486, num_edges=51680989,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.5579433441162109
remove nodes length  1008915

auxiliary_graph.remove_nodes spent  2.7237937450408936
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51680989,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.17535400390625

the counter of shared neighbor distribution
Counter({1.0: 42525518, 2.0: 5772154, 3.0: 1684528, 4.0: 682952, 5.0: 337318, 6.0: 181116, 7.0: 105554, 8.0: 60676, 9.0: 39064, 10.0: 24336, 11.0: 16226, 12.0: 10550, 13.0: 7768, 14.0: 6400, 15.0: 6118, 18.0: 4068, 16.0: 3784, 20.0: 2932, 17.0: 2722, 19.0: 2600, 22.0: 1916, 23.0: 1810, 21.0: 1744, 24.0: 1628, 25.0: 936})
51484418
Convert a graph into a bidirected graph: 2.405 seconds
Metis partitioning: 13.392 seconds
Split the graph: 2.097 seconds
Construct subgraphs: 0.023 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  17.936835527420044
21206
21533
21204
21618
22444
22462
22497
21263
22344
total k batches seeds list generation spend  32.65106010437012
after graph partition
graph partition algorithm spend time 33.25955629348755
21206
21533
21204
21618
22444
22462
22497
21263
22344
partition_len_list
[160947, 153180, 175524, 162299, 183721, 192626, 186152, 186011, 205448]
REG selection method  spend 34.02681279182434
time for parepare:  0.24396181106567383
local_output_nid generation:  0.005493879318237305
local_in_edges_tensor generation:  0.0069577693939208984
mini_batch_src_global generation:  0.017418622970581055
r_  generation:  0.15987825393676758
local_output_nid generation:  0.0064203739166259766
local_in_edges_tensor generation:  0.006964683532714844
mini_batch_src_global generation:  0.022745132446289062
r_  generation:  0.18642497062683105
local_output_nid generation:  0.0064809322357177734
local_in_edges_tensor generation:  0.006802082061767578
mini_batch_src_global generation:  0.021544456481933594
r_  generation:  0.18436932563781738
local_output_nid generation:  0.006558418273925781
local_in_edges_tensor generation:  0.0071620941162109375
mini_batch_src_global generation:  0.020726442337036133
r_  generation:  0.20547699928283691
local_output_nid generation:  0.007999420166015625
local_in_edges_tensor generation:  0.010685920715332031
mini_batch_src_global generation:  0.022318363189697266
r_  generation:  0.22093892097473145
local_output_nid generation:  0.011718034744262695
local_in_edges_tensor generation:  0.007334709167480469
mini_batch_src_global generation:  0.025206565856933594
r_  generation:  0.2500314712524414
local_output_nid generation:  0.0066699981689453125
local_in_edges_tensor generation:  0.007355928421020508
mini_batch_src_global generation:  0.02465677261352539
r_  generation:  0.2527604103088379
local_output_nid generation:  0.0064754486083984375
local_in_edges_tensor generation:  0.007036924362182617
mini_batch_src_global generation:  0.027175426483154297
r_  generation:  0.2141132354736328
local_output_nid generation:  0.0066678524017333984
local_in_edges_tensor generation:  0.007309436798095703
mini_batch_src_global generation:  0.025237321853637695
r_  generation:  0.2557089328765869
----------------------check_connections_block total spend ----------------------------- 2.9517929553985596
generate_one_block  0.48477745056152344
generate_one_block  0.347928524017334
generate_one_block  0.31252336502075195
generate_one_block  0.2712886333465576
generate_one_block  0.28719210624694824
generate_one_block  0.2850382328033447
generate_one_block  0.27933239936828613
generate_one_block  0.24530410766601562
generate_one_block  0.272899866104126
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7940006256103516
gen group dst list time:  0.04816436767578125
time for parepare:  0.4062168598175049
local_output_nid generation:  0.0410466194152832
local_in_edges_tensor generation:  0.12243342399597168
mini_batch_src_global generation:  0.05527305603027344
r_  generation:  0.6219334602355957
local_output_nid generation:  0.04243159294128418
local_in_edges_tensor generation:  0.05247354507446289
mini_batch_src_global generation:  0.06962370872497559
r_  generation:  0.6611666679382324
local_output_nid generation:  0.050731658935546875
local_in_edges_tensor generation:  0.05251145362854004
mini_batch_src_global generation:  0.06289982795715332
r_  generation:  0.7705173492431641
local_output_nid generation:  0.043485403060913086
local_in_edges_tensor generation:  0.04633450508117676
mini_batch_src_global generation:  0.0704202651977539
r_  generation:  0.6974711418151855
local_output_nid generation:  0.050215721130371094
local_in_edges_tensor generation:  0.09858107566833496
mini_batch_src_global generation:  0.07149219512939453
r_  generation:  0.8232541084289551
local_output_nid generation:  0.05222368240356445
local_in_edges_tensor generation:  0.10547208786010742
mini_batch_src_global generation:  0.08320760726928711
r_  generation:  0.8836064338684082
local_output_nid generation:  0.05074429512023926
local_in_edges_tensor generation:  0.0485384464263916
mini_batch_src_global generation:  0.07782125473022461
r_  generation:  0.852135181427002
local_output_nid generation:  0.05449080467224121
local_in_edges_tensor generation:  0.055541038513183594
mini_batch_src_global generation:  0.07722353935241699
r_  generation:  0.8927385807037354
local_output_nid generation:  0.06498098373413086
local_in_edges_tensor generation:  0.06506085395812988
mini_batch_src_global generation:  0.08899784088134766
r_  generation:  0.960439920425415
----------------------check_connections_block total spend ----------------------------- 10.870870351791382
generate_one_block  1.2049214839935303
generate_one_block  0.9295198917388916
generate_one_block  0.9573590755462646
generate_one_block  0.7902896404266357
generate_one_block  1.0094130039215088
generate_one_block  1.0717520713806152
generate_one_block  0.946993350982666
generate_one_block  1.0334949493408203
generate_one_block  1.1240074634552002
----------===============-------------===============-------------the number of batches *****---- 9

original number of batches:  9
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.21704816818237305  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

connection checking time:  13.822663307189941
block generation total time  11.85403561592102
average batch blocks generation time:  0.6585575342178345
block dataloader generation time/epoch 62.016398668289185
pseudo mini batch 0 input nodes size: 430352
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.17148399353027344  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.17148399353027344  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.3318028450012207  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.33196115493774414  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.1745896339416504  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.19013595581054688  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.19013595581054688  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 430352
first layer output nodes number: 160947
edges number: 1562484
torch.Size([430352, 100])
torch.Size([160947, 256])
torch.Size([21206, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 16.8238844871521  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 16.827598571777344  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.2156505584716797  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 1 input nodes size: 410667
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.17436504364013672  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.17436504364013672  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.3273506164550781  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.3275113105773926  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.16703414916992188  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.1826763153076172  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.1826763153076172  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 410667
first layer output nodes number: 153180
edges number: 1494187
torch.Size([410667, 100])
torch.Size([153180, 256])
torch.Size([21533, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 16.787481784820557  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 16.791254997253418  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.20748186111450195  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 2 input nodes size: 467052
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.16709375381469727  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.16709375381469727  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.34108448028564453  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.34124279022216797  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.1880965232849121  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.20452165603637695  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.20452165603637695  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 467052
first layer output nodes number: 175524
edges number: 1692306
torch.Size([467052, 100])
torch.Size([175524, 256])
torch.Size([21204, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 17.738625526428223  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 17.74233865737915  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.23111248016357422  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 3 input nodes size: 396412
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.18803644180297852  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.18803644180297852  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.3357114791870117  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.3358726501464844  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.16172361373901367  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.17734003067016602  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.17734003067016602  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 396412
first layer output nodes number: 162299
edges number: 1551013
torch.Size([396412, 100])
torch.Size([162299, 256])
torch.Size([21618, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 17.01980972290039  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 17.023595333099365  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.20245027542114258  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 4 input nodes size: 463593
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.16179609298706055  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.16179609298706055  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.33449840545654297  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.33466577529907227  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.1868295669555664  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.20456790924072266  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.20456790924072266  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 463593
first layer output nodes number: 183721
edges number: 1788459
torch.Size([463593, 100])
torch.Size([183721, 256])
torch.Size([22444, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 18.720415592193604  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 18.724346160888672  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.23526525497436523  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 5 input nodes size: 479650
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.18697452545166016  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.18697452545166016  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.3656582832336426  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.3658256530761719  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.19295597076416016  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.21132659912109375  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8162841796875 GB
    Memory Allocated: 0.21132659912109375  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 479650
first layer output nodes number: 192626
edges number: 1906940
torch.Size([479650, 100])
torch.Size([192626, 256])
torch.Size([22462, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 19.68893527984619  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 19.693135738372803  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.24288606643676758  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 6 input nodes size: 436703
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.19322586059570312  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.19322586059570312  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.3559107780456543  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.3560786247253418  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.17722749710083008  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.19509649276733398  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.19509649276733398  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 436703
first layer output nodes number: 186152
edges number: 1840268
torch.Size([436703, 100])
torch.Size([186152, 256])
torch.Size([22497, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 19.264049530029297  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 19.26827621459961  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.2244243621826172  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 7 input nodes size: 581688
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.17725372314453125  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.17725372314453125  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.3939495086669922  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.39410829544067383  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.23125553131103516  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.24865055084228516  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.24865055084228516  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 581688
first layer output nodes number: 186011
edges number: 1828294
torch.Size([581688, 100])
torch.Size([186011, 256])
torch.Size([21263, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 18.41475820541382  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 18.41860580444336  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.2769298553466797  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 8 input nodes size: 530176
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.23087644577026367  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.23087644577026367  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.42838239669799805  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.42854928970336914  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.21169471740722656  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.2308521270751953  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3455810546875 GB
    Memory Allocated: 0.2308521270751953  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 530176
first layer output nodes number: 205448
edges number: 2029773
torch.Size([530176, 100])
torch.Size([205448, 256])
torch.Size([22344, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6873779296875 GB
    Memory Allocated: 20.208388805389404  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6873779296875 GB
    Memory Allocated: 20.21241855621338  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.4158935546875 GB
    Memory Allocated: 0.2627229690551758  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.4158935546875 GB
    Memory Allocated: 0.2627229690551758  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.4158935546875 GB
    Memory Allocated: 0.2627229690551758  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.15146777364942762 |0.0200702879163954 |0.19550763236151802 |0.00014779302808973525 |0.2546715471479628 |0.006072521209716797 |
----------------------------------------------------------pseudo_mini_loss sum 2.5804407596588135
Total (block generation + training)time/epoch 68.21266452471416
Training time/epoch 5.770748615264893
Training time without block to device /epoch 5.590116024017334
Training time without total dataloading part /epoch 4.059015274047852
load block tensor time/epoch 1.3632099628448486
block to device time/epoch 0.1806325912475586
input features size transfer per epoch 1.2069940567016602e-06
blocks size to device per epoch 8.046627044677734e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  5802201
Number of first layer input nodes during this epoch:  4196293
Number of first layer output nodes during this epoch:  1605908
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.4158935546875 GB
    Memory Allocated: 0.2627224922180176  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2518739700317383
global_2_local spend time (sec) 0.49702930450439453
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.02369999885559082
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1008663, 25: 183378, 14: 695, 15: 673, 7: 655, 23: 648, 24: 645, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.0661773681640625
auxiliary_graph
Graph(num_nodes=1205234, num_edges=51727221,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.5801906585693359
remove nodes length  1008663

auxiliary_graph.remove_nodes spent  2.764247417449951
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51727221,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.164543867111206

the counter of shared neighbor distribution
Counter({1.0: 42595512, 2.0: 5754626, 3.0: 1678820, 4.0: 681354, 5.0: 337640, 6.0: 180922, 7.0: 105058, 8.0: 60946, 9.0: 38874, 10.0: 25412, 11.0: 16072, 12.0: 10712, 13.0: 7784, 14.0: 6484, 15.0: 6256, 18.0: 4068, 16.0: 3842, 20.0: 2830, 17.0: 2714, 19.0: 2682, 22.0: 1924, 23.0: 1782, 21.0: 1714, 24.0: 1684, 25.0: 938})
51530650
Convert a graph into a bidirected graph: 2.612 seconds
Metis partitioning: 13.796 seconds
Split the graph: 1.780 seconds
Construct subgraphs: 0.029 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  18.237890481948853
21209
21204
21265
22486
22486
21679
21282
22465
22495
total k batches seeds list generation spend  33.02191352844238
after graph partition
graph partition algorithm spend time 33.64923930168152
21209
21204
21265
22486
22486
21679
21282
22465
22495
partition_len_list
[166647, 180804, 167674, 161547, 197972, 172036, 187228, 184114, 198142]
REG selection method  spend 34.42397093772888
time for parepare:  0.24397492408752441
local_output_nid generation:  0.005692243576049805
local_in_edges_tensor generation:  0.006685495376586914
mini_batch_src_global generation:  0.01776742935180664
r_  generation:  0.16431522369384766
local_output_nid generation:  0.006483316421508789
local_in_edges_tensor generation:  0.0066471099853515625
mini_batch_src_global generation:  0.022597312927246094
r_  generation:  0.20300722122192383
local_output_nid generation:  0.006456136703491211
local_in_edges_tensor generation:  0.008313655853271484
mini_batch_src_global generation:  0.018979549407958984
r_  generation:  0.19956445693969727
local_output_nid generation:  0.0067560672760009766
local_in_edges_tensor generation:  0.007558584213256836
mini_batch_src_global generation:  0.025941848754882812
r_  generation:  0.21013307571411133
local_output_nid generation:  0.00675511360168457
local_in_edges_tensor generation:  0.008018732070922852
mini_batch_src_global generation:  0.024312257766723633
r_  generation:  0.24224114418029785
local_output_nid generation:  0.006561994552612305
local_in_edges_tensor generation:  0.006793022155761719
mini_batch_src_global generation:  0.02380990982055664
r_  generation:  0.22099709510803223
local_output_nid generation:  0.006517648696899414
local_in_edges_tensor generation:  0.006521940231323242
mini_batch_src_global generation:  0.022406816482543945
r_  generation:  0.21692395210266113
local_output_nid generation:  0.006805419921875
local_in_edges_tensor generation:  0.006962776184082031
mini_batch_src_global generation:  0.026178598403930664
r_  generation:  0.27127814292907715
local_output_nid generation:  0.006760835647583008
local_in_edges_tensor generation:  0.0069561004638671875
mini_batch_src_global generation:  0.025627613067626953
r_  generation:  0.25618886947631836
----------------------check_connections_block total spend ----------------------------- 2.9793426990509033
generate_one_block  0.5047540664672852
generate_one_block  0.3740518093109131
generate_one_block  0.30245232582092285
generate_one_block  0.2838561534881592
generate_one_block  0.3077242374420166
generate_one_block  0.2707846164703369
generate_one_block  0.25336313247680664
generate_one_block  0.27690911293029785
generate_one_block  0.2887434959411621
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7992517948150635
gen group dst list time:  0.04817700386047363
time for parepare:  0.3872528076171875
local_output_nid generation:  0.04230785369873047
local_in_edges_tensor generation:  0.13225650787353516
mini_batch_src_global generation:  0.051145076751708984
r_  generation:  0.6677706241607666
local_output_nid generation:  0.050994873046875
local_in_edges_tensor generation:  0.049529314041137695
mini_batch_src_global generation:  0.07682585716247559
r_  generation:  0.7713842391967773
local_output_nid generation:  0.04759383201599121
local_in_edges_tensor generation:  0.04870796203613281
mini_batch_src_global generation:  0.06465315818786621
r_  generation:  0.756277322769165
local_output_nid generation:  0.044348716735839844
local_in_edges_tensor generation:  0.04186654090881348
mini_batch_src_global generation:  0.06631231307983398
r_  generation:  0.7255537509918213
local_output_nid generation:  0.054355621337890625
local_in_edges_tensor generation:  0.05394935607910156
mini_batch_src_global generation:  0.0806124210357666
r_  generation:  0.9377925395965576
local_output_nid generation:  0.04442000389099121
local_in_edges_tensor generation:  0.03806734085083008
mini_batch_src_global generation:  0.08108067512512207
r_  generation:  0.7835958003997803
local_output_nid generation:  0.052376747131347656
local_in_edges_tensor generation:  0.05922698974609375
mini_batch_src_global generation:  0.08139395713806152
r_  generation:  0.897559642791748
local_output_nid generation:  0.05049920082092285
local_in_edges_tensor generation:  0.05625271797180176
mini_batch_src_global generation:  0.0869593620300293
r_  generation:  0.8580870628356934
local_output_nid generation:  0.054816484451293945
local_in_edges_tensor generation:  0.0603179931640625
mini_batch_src_global generation:  0.08920168876647949
r_  generation:  0.9466001987457275
----------------------check_connections_block total spend ----------------------------- 10.922264814376831
generate_one_block  0.9240150451660156
generate_one_block  1.1218998432159424
generate_one_block  0.9625859260559082
generate_one_block  0.9407517910003662
generate_one_block  1.3133659362792969
generate_one_block  0.9278831481933594
generate_one_block  1.0660638809204102
generate_one_block  0.9421133995056152
generate_one_block  1.1192820072174072
----------===============-------------===============-------------the number of batches *****---- 9

original number of batches:  9
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.4158935546875 GB
    Memory Allocated: 0.2627224922180176  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

connection checking time:  13.901607513427734
block generation total time  12.180599927902222
average batch blocks generation time:  0.6766999959945679
block dataloader generation time/epoch 62.188244223594666
pseudo mini batch 0 input nodes size: 469532
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.4158935546875 GB
    Memory Allocated: 0.2117762565612793  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.4158935546875 GB
    Memory Allocated: 0.2117762565612793  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.4158935546875 GB
    Memory Allocated: 0.386690616607666  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.4158935546875 GB
    Memory Allocated: 0.38684892654418945  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.4158935546875 GB
    Memory Allocated: 0.18917608261108398  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.4158935546875 GB
    Memory Allocated: 0.20498991012573242  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.4158935546875 GB
    Memory Allocated: 0.20498991012573242  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 469532
first layer output nodes number: 166647
edges number: 1618824
torch.Size([469532, 100])
torch.Size([166647, 256])
torch.Size([21209, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8533935546875 GB
    Memory Allocated: 17.17511510848999  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.8533935546875 GB
    Memory Allocated: 17.178846836090088  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.8553466796875 GB
    Memory Allocated: 0.23241472244262695  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 1 input nodes size: 527222
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.8553466796875 GB
    Memory Allocated: 0.1889781951904297  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.8553466796875 GB
    Memory Allocated: 0.1889781951904297  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.8553466796875 GB
    Memory Allocated: 0.38538408279418945  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.8553466796875 GB
    Memory Allocated: 0.3855423927307129  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.8553466796875 GB
    Memory Allocated: 0.21046972274780273  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.8553466796875 GB
    Memory Allocated: 0.2279973030090332  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8553466796875 GB
    Memory Allocated: 0.2279973030090332  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 527222
first layer output nodes number: 180804
edges number: 1763968
torch.Size([527222, 100])
torch.Size([180804, 256])
torch.Size([21204, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4549560546875 GB
    Memory Allocated: 18.2609806060791  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.4549560546875 GB
    Memory Allocated: 18.26469373703003  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.4588623046875 GB
    Memory Allocated: 0.25608396530151367  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 2 input nodes size: 459235
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.4588623046875 GB
    Memory Allocated: 0.21045160293579102  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.4588623046875 GB
    Memory Allocated: 0.21045160293579102  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.4588623046875 GB
    Memory Allocated: 0.3815302848815918  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.4588623046875 GB
    Memory Allocated: 0.38168907165527344  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.4588623046875 GB
    Memory Allocated: 0.18512487411499023  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.4588623046875 GB
    Memory Allocated: 0.2010941505432129  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4588623046875 GB
    Memory Allocated: 0.2010941505432129  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 459235
first layer output nodes number: 167674
edges number: 1625238
torch.Size([459235, 100])
torch.Size([167674, 256])
torch.Size([21265, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.5037841796875 GB
    Memory Allocated: 17.421041011810303  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.5037841796875 GB
    Memory Allocated: 17.42476511001587  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.5076904296875 GB
    Memory Allocated: 0.2276010513305664  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 3 input nodes size: 364499
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.5076904296875 GB
    Memory Allocated: 0.1851358413696289  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.5076904296875 GB
    Memory Allocated: 0.1851358413696289  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.5076904296875 GB
    Memory Allocated: 0.3209223747253418  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.5076904296875 GB
    Memory Allocated: 0.3210902214050293  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.5076904296875 GB
    Memory Allocated: 0.14985275268554688  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.5076904296875 GB
    Memory Allocated: 0.16553974151611328  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.5076904296875 GB
    Memory Allocated: 0.16553974151611328  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 364499
first layer output nodes number: 161547
edges number: 1539781
torch.Size([364499, 100])
torch.Size([161547, 256])
torch.Size([22486, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9549560546875 GB
    Memory Allocated: 17.220126628875732  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9549560546875 GB
    Memory Allocated: 17.224064350128174  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.9588623046875 GB
    Memory Allocated: 0.19250869750976562  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 4 input nodes size: 509640
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.9588623046875 GB
    Memory Allocated: 0.15093469619750977  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.9588623046875 GB
    Memory Allocated: 0.15093469619750977  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.9588623046875 GB
    Memory Allocated: 0.3407907485961914  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.9588623046875 GB
    Memory Allocated: 0.3409585952758789  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.9588623046875 GB
    Memory Allocated: 0.20500421524047852  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.9588623046875 GB
    Memory Allocated: 0.22375917434692383  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9588623046875 GB
    Memory Allocated: 0.22375917434692383  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 509640
first layer output nodes number: 197972
edges number: 1959877
torch.Size([509640, 100])
torch.Size([197972, 256])
torch.Size([22486, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8612060546875 GB
    Memory Allocated: 20.007132053375244  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.8612060546875 GB
    Memory Allocated: 20.011938095092773  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.3983154296875 GB
    Memory Allocated: 0.2542448043823242  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 5 input nodes size: 443794
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.3983154296875 GB
    Memory Allocated: 0.20413589477539062  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.3983154296875 GB
    Memory Allocated: 0.20413589477539062  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.3983154296875 GB
    Memory Allocated: 0.3694624900817871  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.3983154296875 GB
    Memory Allocated: 0.36962413787841797  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.3983154296875 GB
    Memory Allocated: 0.17960023880004883  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.3983154296875 GB
    Memory Allocated: 0.19655656814575195  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.3983154296875 GB
    Memory Allocated: 0.19655656814575195  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 443794
first layer output nodes number: 172036
edges number: 1667978
torch.Size([443794, 100])
torch.Size([172036, 256])
torch.Size([21679, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2420654296875 GB
    Memory Allocated: 17.748307704925537  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.2420654296875 GB
    Memory Allocated: 17.75210428237915  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.2420654296875 GB
    Memory Allocated: 0.22515869140625  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 6 input nodes size: 559620
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.2420654296875 GB
    Memory Allocated: 0.18024444580078125  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.2420654296875 GB
    Memory Allocated: 0.18024444580078125  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2420654296875 GB
    Memory Allocated: 0.3887195587158203  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2420654296875 GB
    Memory Allocated: 0.38887834548950195  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.2420654296875 GB
    Memory Allocated: 0.2233901023864746  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.2420654296875 GB
    Memory Allocated: 0.24075841903686523  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2420654296875 GB
    Memory Allocated: 0.24075841903686523  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 559620
first layer output nodes number: 187228
edges number: 1842248
torch.Size([559620, 100])
torch.Size([187228, 256])
torch.Size([21282, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.332295894622803  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.7479248046875 GB
    Memory Allocated: 18.33684253692627  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.7518310546875 GB
    Memory Allocated: 0.2705693244934082  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 7 input nodes size: 425043
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.7518310546875 GB
    Memory Allocated: 0.22335481643676758  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.7518310546875 GB
    Memory Allocated: 0.22335481643676758  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.7518310546875 GB
    Memory Allocated: 0.3816957473754883  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.7518310546875 GB
    Memory Allocated: 0.3818635940551758  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.7518310546875 GB
    Memory Allocated: 0.17322969436645508  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.7518310546875 GB
    Memory Allocated: 0.1910548210144043  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7518310546875 GB
    Memory Allocated: 0.1910548210144043  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 425043
first layer output nodes number: 184114
edges number: 1817641
torch.Size([425043, 100])
torch.Size([184114, 256])
torch.Size([22465, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5545654296875 GB
    Memory Allocated: 19.1214542388916  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5545654296875 GB
    Memory Allocated: 19.125946521759033  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.0916748046875 GB
    Memory Allocated: 0.21947956085205078  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 8 input nodes size: 491800
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.0916748046875 GB
    Memory Allocated: 0.1728363037109375  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.0916748046875 GB
    Memory Allocated: 0.1728363037109375  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.0916748046875 GB
    Memory Allocated: 0.356046199798584  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.0916748046875 GB
    Memory Allocated: 0.3562140464782715  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.0916748046875 GB
    Memory Allocated: 0.19770526885986328  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.0916748046875 GB
    Memory Allocated: 0.21648883819580078  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0916748046875 GB
    Memory Allocated: 0.21648883819580078  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 491800
first layer output nodes number: 198142
edges number: 1961325
torch.Size([491800, 100])
torch.Size([198142, 256])
torch.Size([22495, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 20.04264736175537  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 20.046586513519287  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.6092529296875 GB
    Memory Allocated: 0.24680566787719727  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.6092529296875 GB
    Memory Allocated: 0.24680566787719727  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.6092529296875 GB
    Memory Allocated: 0.24680566787719727  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.15575030114915636 |0.013837999767727323 |0.2561464044782851 |0.0001461505889892578 |0.21341387430826822 |0.0060231685638427734 |
----------------------------------------------------------pseudo_mini_loss sum 2.3028783798217773
Total (block generation + training)time/epoch 68.31559813022614
Training time/epoch 5.920269966125488
Training time without block to device /epoch 5.795727968215942
Training time without total dataloading part /epoch 4.233381032943726
load block tensor time/epoch 1.4017527103424072
block to device time/epoch 0.1245419979095459
input features size transfer per epoch 1.2069940567016602e-06
blocks size to device per epoch 8.046627044677734e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  5866549
Number of first layer input nodes during this epoch:  4250385
Number of first layer output nodes during this epoch:  1616164
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.6092529296875 GB
    Memory Allocated: 0.24680519104003906  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.3258023262023926
global_2_local spend time (sec) 0.5238876342773438
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.024700164794921875
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1009797, 25: 183378, 14: 695, 15: 673, 7: 655, 23: 648, 24: 645, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.08911871910095215
auxiliary_graph
Graph(num_nodes=1206368, num_edges=51813681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.5532045364379883
remove nodes length  1009797

auxiliary_graph.remove_nodes spent  2.723179578781128
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51813681,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.1714296340942383

the counter of shared neighbor distribution
Counter({1.0: 42628350, 2.0: 5795342, 3.0: 1685632, 4.0: 686214, 5.0: 337984, 6.0: 181092, 7.0: 106452, 8.0: 60880, 9.0: 38846, 10.0: 24748, 11.0: 16280, 12.0: 10764, 13.0: 7688, 14.0: 6428, 15.0: 6070, 18.0: 3948, 16.0: 3890, 20.0: 2870, 17.0: 2830, 19.0: 2762, 22.0: 1950, 23.0: 1804, 21.0: 1712, 24.0: 1638, 25.0: 936})
51617110
Convert a graph into a bidirected graph: 2.414 seconds
Metis partitioning: 13.647 seconds
Split the graph: 1.760 seconds
Construct subgraphs: 0.028 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  17.86982822418213
21248
22490
21211
21415
22474
21474
21310
22492
22457
total k batches seeds list generation spend  32.808058977127075
after graph partition
graph partition algorithm spend time 33.42203426361084
21248
22490
21211
21415
22474
21474
21310
22492
22457
partition_len_list
[163891, 170151, 168897, 170643, 199358, 171480, 185708, 193711, 198908]
REG selection method  spend 34.195799350738525
time for parepare:  0.23921442031860352
local_output_nid generation:  0.005570173263549805
local_in_edges_tensor generation:  0.006589651107788086
mini_batch_src_global generation:  0.02051520347595215
r_  generation:  0.1685774326324463
local_output_nid generation:  0.006704568862915039
local_in_edges_tensor generation:  0.006777286529541016
mini_batch_src_global generation:  0.025771617889404297
r_  generation:  0.1953890323638916
local_output_nid generation:  0.006369113922119141
local_in_edges_tensor generation:  0.006260871887207031
mini_batch_src_global generation:  0.021471023559570312
r_  generation:  0.18178820610046387
local_output_nid generation:  0.006463289260864258
local_in_edges_tensor generation:  0.006459951400756836
mini_batch_src_global generation:  0.023201704025268555
r_  generation:  0.2054429054260254
local_output_nid generation:  0.006766557693481445
local_in_edges_tensor generation:  0.006841182708740234
mini_batch_src_global generation:  0.026047945022583008
r_  generation:  0.2316112518310547
local_output_nid generation:  0.00649714469909668
local_in_edges_tensor generation:  0.006534099578857422
mini_batch_src_global generation:  0.02593827247619629
r_  generation:  0.2092888355255127
local_output_nid generation:  0.006434440612792969
local_in_edges_tensor generation:  0.006315946578979492
mini_batch_src_global generation:  0.024964570999145508
r_  generation:  0.21277332305908203
local_output_nid generation:  0.006685972213745117
local_in_edges_tensor generation:  0.007718801498413086
mini_batch_src_global generation:  0.02869248390197754
r_  generation:  0.25360107421875
local_output_nid generation:  0.006610393524169922
local_in_edges_tensor generation:  0.007594585418701172
mini_batch_src_global generation:  0.028653621673583984
r_  generation:  0.24879956245422363
----------------------check_connections_block total spend ----------------------------- 2.9028491973876953
generate_one_block  0.48429036140441895
generate_one_block  0.37390828132629395
generate_one_block  0.31513547897338867
generate_one_block  0.29044222831726074
generate_one_block  0.303516149520874
generate_one_block  0.26663947105407715
generate_one_block  0.25243091583251953
generate_one_block  0.28984904289245605
generate_one_block  0.28845882415771484
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.8390188217163086
gen group dst list time:  0.04918026924133301
time for parepare:  0.4034101963043213
local_output_nid generation:  0.0449061393737793
local_in_edges_tensor generation:  0.11883115768432617
mini_batch_src_global generation:  0.05779242515563965
r_  generation:  0.6487987041473389
local_output_nid generation:  0.04593849182128906
local_in_edges_tensor generation:  0.05685758590698242
mini_batch_src_global generation:  0.06877636909484863
r_  generation:  0.6967546939849854
local_output_nid generation:  0.04694056510925293
local_in_edges_tensor generation:  0.048099517822265625
mini_batch_src_global generation:  0.0689249038696289
r_  generation:  0.7194507122039795
local_output_nid generation:  0.05023336410522461
local_in_edges_tensor generation:  0.06235027313232422
mini_batch_src_global generation:  0.07356405258178711
r_  generation:  0.771204948425293
local_output_nid generation:  0.053675174713134766
local_in_edges_tensor generation:  0.060738325119018555
mini_batch_src_global generation:  0.09376883506774902
r_  generation:  0.9183926582336426
local_output_nid generation:  0.045295000076293945
local_in_edges_tensor generation:  0.044782161712646484
mini_batch_src_global generation:  0.07998228073120117
r_  generation:  0.7699611186981201
local_output_nid generation:  0.052648067474365234
local_in_edges_tensor generation:  0.05083346366882324
mini_batch_src_global generation:  0.07986974716186523
r_  generation:  0.8671722412109375
local_output_nid generation:  0.05236101150512695
local_in_edges_tensor generation:  0.09932160377502441
mini_batch_src_global generation:  0.08349728584289551
r_  generation:  0.9009191989898682
local_output_nid generation:  0.0546109676361084
local_in_edges_tensor generation:  0.05453681945800781
mini_batch_src_global generation:  0.08378458023071289
r_  generation:  0.9362049102783203
----------------------check_connections_block total spend ----------------------------- 10.856956481933594
generate_one_block  0.816779375076294
generate_one_block  0.9093515872955322
generate_one_block  0.8793962001800537
generate_one_block  0.907020092010498
generate_one_block  1.0588598251342773
generate_one_block  0.8868348598480225
generate_one_block  1.013253927230835
generate_one_block  1.0361990928649902
generate_one_block  1.150796890258789
----------===============-------------===============-------------the number of batches *****---- 9

original number of batches:  9
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.6092529296875 GB
    Memory Allocated: 0.24680519104003906  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

connection checking time:  13.759805679321289
block generation total time  11.523162603378296
average batch blocks generation time:  0.6401757001876831
block dataloader generation time/epoch 62.10007929801941
pseudo mini batch 0 input nodes size: 431334
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.6092529296875 GB
    Memory Allocated: 0.19749021530151367  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.6092529296875 GB
    Memory Allocated: 0.19749021530151367  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.6092529296875 GB
    Memory Allocated: 0.35817480087280273  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.6092529296875 GB
    Memory Allocated: 0.35833311080932617  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.6092529296875 GB
    Memory Allocated: 0.1749553680419922  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.6092529296875 GB
    Memory Allocated: 0.19057941436767578  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6092529296875 GB
    Memory Allocated: 0.19057941436767578  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 431334
first layer output nodes number: 163891
edges number: 1581290
torch.Size([431334, 100])
torch.Size([163891, 256])
torch.Size([21248, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.7010498046875 GB
    Memory Allocated: 17.161413192749023  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.7010498046875 GB
    Memory Allocated: 17.16513442993164  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.6893310546875 GB
    Memory Allocated: 0.2188277244567871  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 1 input nodes size: 400911
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.6893310546875 GB
    Memory Allocated: 0.17534732818603516  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.6893310546875 GB
    Memory Allocated: 0.17534732818603516  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.6893310546875 GB
    Memory Allocated: 0.32469844818115234  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.6893310546875 GB
    Memory Allocated: 0.32486629486083984  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.6893310546875 GB
    Memory Allocated: 0.16402339935302734  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.6893310546875 GB
    Memory Allocated: 0.18016624450683594  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6893310546875 GB
    Memory Allocated: 0.18016624450683594  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 400911
first layer output nodes number: 170151
edges number: 1624433
torch.Size([400911, 100])
torch.Size([170151, 256])
torch.Size([22490, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.3729248046875 GB
    Memory Allocated: 17.765786170959473  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.3729248046875 GB
    Memory Allocated: 17.76972484588623  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.3748779296875 GB
    Memory Allocated: 0.20806598663330078  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 2 input nodes size: 469332
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.3748779296875 GB
    Memory Allocated: 0.16422462463378906  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.3748779296875 GB
    Memory Allocated: 0.16422462463378906  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.3748779296875 GB
    Memory Allocated: 0.3390645980834961  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.3748779296875 GB
    Memory Allocated: 0.33922290802001953  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.3748779296875 GB
    Memory Allocated: 0.18970394134521484  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.3748779296875 GB
    Memory Allocated: 0.20565032958984375  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.3748779296875 GB
    Memory Allocated: 0.20565032958984375  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 469332
first layer output nodes number: 168897
edges number: 1638264
torch.Size([469332, 100])
torch.Size([168897, 256])
torch.Size([21211, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0682373046875 GB
    Memory Allocated: 17.273894786834717  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.0682373046875 GB
    Memory Allocated: 17.277819633483887  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.0701904296875 GB
    Memory Allocated: 0.23166799545288086  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 3 input nodes size: 459440
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.0701904296875 GB
    Memory Allocated: 0.18909740447998047  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.0701904296875 GB
    Memory Allocated: 0.18909740447998047  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.0701904296875 GB
    Memory Allocated: 0.36025238037109375  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.0701904296875 GB
    Memory Allocated: 0.3604121208190918  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.0701904296875 GB
    Memory Allocated: 0.18541383743286133  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.0701904296875 GB
    Memory Allocated: 0.20183897018432617  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0701904296875 GB
    Memory Allocated: 0.20183897018432617  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 459440
first layer output nodes number: 170643
edges number: 1676708
torch.Size([459440, 100])
torch.Size([170643, 256])
torch.Size([21415, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2889404296875 GB
    Memory Allocated: 17.857565879821777  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.2889404296875 GB
    Memory Allocated: 17.861316204071045  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2889404296875 GB
    Memory Allocated: 0.2296457290649414  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 4 input nodes size: 507555
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2889404296875 GB
    Memory Allocated: 0.18616151809692383  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2889404296875 GB
    Memory Allocated: 0.18616151809692383  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2889404296875 GB
    Memory Allocated: 0.3752408027648926  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2889404296875 GB
    Memory Allocated: 0.3754086494445801  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2889404296875 GB
    Memory Allocated: 0.20409393310546875  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2889404296875 GB
    Memory Allocated: 0.2229633331298828  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2889404296875 GB
    Memory Allocated: 0.2229633331298828  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 507555
first layer output nodes number: 199358
edges number: 1975869
torch.Size([507555, 100])
torch.Size([199358, 256])
torch.Size([22474, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5233154296875 GB
    Memory Allocated: 20.14505958557129  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5233154296875 GB
    Memory Allocated: 20.148995399475098  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5897216796875 GB
    Memory Allocated: 0.2527585029602051  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 5 input nodes size: 465479
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5897216796875 GB
    Memory Allocated: 0.20335721969604492  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5897216796875 GB
    Memory Allocated: 0.20335721969604492  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5897216796875 GB
    Memory Allocated: 0.37676191329956055  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5897216796875 GB
    Memory Allocated: 0.3769221305847168  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5897216796875 GB
    Memory Allocated: 0.18767499923706055  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5897216796875 GB
    Memory Allocated: 0.20386934280395508  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5897216796875 GB
    Memory Allocated: 0.20386934280395508  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 465479
first layer output nodes number: 171480
edges number: 1660555
torch.Size([465479, 100])
torch.Size([171480, 256])
torch.Size([21474, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.0916748046875 GB
    Memory Allocated: 17.641157150268555  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.0916748046875 GB
    Memory Allocated: 17.644917488098145  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.0760498046875 GB
    Memory Allocated: 0.2301921844482422  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 6 input nodes size: 572730
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.0760498046875 GB
    Memory Allocated: 0.1874995231628418  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.0760498046875 GB
    Memory Allocated: 0.1874995231628418  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.0760498046875 GB
    Memory Allocated: 0.40085840225219727  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.0760498046875 GB
    Memory Allocated: 0.4010171890258789  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.0760498046875 GB
    Memory Allocated: 0.22745227813720703  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.0760498046875 GB
    Memory Allocated: 0.24477100372314453  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.0760498046875 GB
    Memory Allocated: 0.24477100372314453  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 572730
first layer output nodes number: 185708
edges number: 1820419
torch.Size([572730, 100])
torch.Size([185708, 256])
torch.Size([21310, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5389404296875 GB
    Memory Allocated: 18.214954376220703  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5389404296875 GB
    Memory Allocated: 18.21941041946411  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5408935546875 GB
    Memory Allocated: 0.2746725082397461  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 7 input nodes size: 455779
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5408935546875 GB
    Memory Allocated: 0.2281479835510254  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5408935546875 GB
    Memory Allocated: 0.2281479835510254  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5408935546875 GB
    Memory Allocated: 0.39793920516967773  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5408935546875 GB
    Memory Allocated: 0.39810705184936523  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5408935546875 GB
    Memory Allocated: 0.18458938598632812  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5408935546875 GB
    Memory Allocated: 0.20304298400878906  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5408935546875 GB
    Memory Allocated: 0.20304298400878906  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 455779
first layer output nodes number: 193711
edges number: 1917158
torch.Size([455779, 100])
torch.Size([193711, 256])
torch.Size([22492, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2088623046875 GB
    Memory Allocated: 19.766908168792725  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2088623046875 GB
    Memory Allocated: 19.771364212036133  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.2830810546875 GB
    Memory Allocated: 0.2340540885925293  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 8 input nodes size: 496607
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.2830810546875 GB
    Memory Allocated: 0.1847524642944336  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.2830810546875 GB
    Memory Allocated: 0.1847524642944336  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.2830810546875 GB
    Memory Allocated: 0.369753360748291  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.2830810546875 GB
    Memory Allocated: 0.3699207305908203  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.2830810546875 GB
    Memory Allocated: 0.19996166229248047  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.2830810546875 GB
    Memory Allocated: 0.21876907348632812  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2830810546875 GB
    Memory Allocated: 0.21876907348632812  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 496607
first layer output nodes number: 198908
edges number: 1966300
torch.Size([496607, 100])
torch.Size([198908, 256])
torch.Size([22457, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5447998046875 GB
    Memory Allocated: 20.08247470855713  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5447998046875 GB
    Memory Allocated: 20.087093830108643  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 0.24971723556518555  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 0.24971723556518555  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 0.24971723556518555  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.15747565693325466 |0.014339023166232638 |0.3558177947998047 |0.0001461770799424913 |0.22160008218553331 |0.004002571105957031 |
----------------------------------------------------------pseudo_mini_loss sum 1.814419150352478
Total (block generation + training)time/epoch 68.38251447677612
Training time/epoch 6.902409791946411
Training time without block to device /epoch 6.773358583450317
Training time without total dataloading part /epoch 5.2020790576934814
load block tensor time/epoch 1.417280912399292
block to device time/epoch 0.12905120849609375
input features size transfer per epoch 1.2069940567016602e-06
blocks size to device per epoch 8.046627044677734e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  5881914
Number of first layer input nodes during this epoch:  4259167
Number of first layer output nodes during this epoch:  1622747
----------------------------------------before generate dataloader block 
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 0.24971675872802734  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.26032114028930664
global_2_local spend time (sec) 0.4901466369628906
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.023540019989013672
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1008590, 25: 183378, 14: 695, 15: 673, 7: 655, 23: 648, 24: 645, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.08124327659606934
auxiliary_graph
Graph(num_nodes=1205161, num_edges=51894469,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.5850975513458252
remove nodes length  1008590

auxiliary_graph.remove_nodes spent  2.759420394897461
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51894469,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.2085752487182617

the counter of shared neighbor distribution
Counter({1.0: 42715030, 2.0: 5796518, 3.0: 1682256, 4.0: 682536, 5.0: 336592, 6.0: 181714, 7.0: 105900, 8.0: 61816, 9.0: 39396, 10.0: 25084, 11.0: 15730, 12.0: 10742, 13.0: 7742, 14.0: 6378, 15.0: 6294, 18.0: 4010, 16.0: 3836, 20.0: 2928, 17.0: 2724, 19.0: 2620, 22.0: 2042, 23.0: 1772, 21.0: 1672, 24.0: 1608, 25.0: 958})
51697898
Convert a graph into a bidirected graph: 2.630 seconds
Metis partitioning: 13.677 seconds
Split the graph: 1.495 seconds
Construct subgraphs: 0.030 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  17.8525447845459
21899
22357
21261
21255
21215
22335
22496
22453
21300
total k batches seeds list generation spend  33.01080536842346
after graph partition
graph partition algorithm spend time 33.67100524902344
21899
22357
21261
21255
21215
22335
22496
22453
21300
partition_len_list
[191940, 211232, 179067, 171099, 149818, 180294, 175849, 178999, 160598]
REG selection method  spend 34.43548583984375
time for parepare:  0.2503621578216553
local_output_nid generation:  0.005877494812011719
local_in_edges_tensor generation:  0.007298707962036133
mini_batch_src_global generation:  0.019812583923339844
r_  generation:  0.20319676399230957
local_output_nid generation:  0.006694793701171875
local_in_edges_tensor generation:  0.012407541275024414
mini_batch_src_global generation:  0.024840831756591797
r_  generation:  0.21650409698486328
local_output_nid generation:  0.007986068725585938
local_in_edges_tensor generation:  0.006830453872680664
mini_batch_src_global generation:  0.018253803253173828
r_  generation:  0.2020127773284912
local_output_nid generation:  0.00655674934387207
local_in_edges_tensor generation:  0.00667572021484375
mini_batch_src_global generation:  0.022820711135864258
r_  generation:  0.19189238548278809
local_output_nid generation:  0.01001882553100586
local_in_edges_tensor generation:  0.006851673126220703
mini_batch_src_global generation:  0.021056413650512695
r_  generation:  0.19745945930480957
local_output_nid generation:  0.011312007904052734
local_in_edges_tensor generation:  0.010575056076049805
mini_batch_src_global generation:  0.025893211364746094
r_  generation:  0.2459862232208252
local_output_nid generation:  0.00752568244934082
local_in_edges_tensor generation:  0.009192228317260742
mini_batch_src_global generation:  0.025495290756225586
r_  generation:  0.22965145111083984
local_output_nid generation:  0.0066945552825927734
local_in_edges_tensor generation:  0.007065534591674805
mini_batch_src_global generation:  0.024166345596313477
r_  generation:  0.2437455654144287
local_output_nid generation:  0.0067102909088134766
local_in_edges_tensor generation:  0.0066835880279541016
mini_batch_src_global generation:  0.025484800338745117
r_  generation:  0.21331048011779785
----------------------check_connections_block total spend ----------------------------- 3.0268032550811768
generate_one_block  0.5581984519958496
generate_one_block  0.38742923736572266
generate_one_block  0.2986605167388916
generate_one_block  0.25540876388549805
generate_one_block  0.26433563232421875
generate_one_block  0.27916669845581055
generate_one_block  0.27194786071777344
generate_one_block  0.26708483695983887
generate_one_block  0.24909234046936035
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.8192028999328613
gen group dst list time:  0.05038595199584961
time for parepare:  0.4286797046661377
local_output_nid generation:  0.05170416831970215
local_in_edges_tensor generation:  0.13649725914001465
mini_batch_src_global generation:  0.07455730438232422
r_  generation:  0.7946975231170654
local_output_nid generation:  0.05750846862792969
local_in_edges_tensor generation:  0.059967041015625
mini_batch_src_global generation:  0.08425068855285645
r_  generation:  0.9449658393859863
local_output_nid generation:  0.04879021644592285
local_in_edges_tensor generation:  0.07608723640441895
mini_batch_src_global generation:  0.07784271240234375
r_  generation:  0.7980568408966064
local_output_nid generation:  0.047756195068359375
local_in_edges_tensor generation:  0.04596138000488281
mini_batch_src_global generation:  0.07687234878540039
r_  generation:  0.7950870990753174
local_output_nid generation:  0.03997397422790527
local_in_edges_tensor generation:  0.05266976356506348
mini_batch_src_global generation:  0.07944798469543457
r_  generation:  0.6681289672851562
local_output_nid generation:  0.04886174201965332
local_in_edges_tensor generation:  0.05123281478881836
mini_batch_src_global generation:  0.07445168495178223
r_  generation:  0.829392671585083
local_output_nid generation:  0.04885745048522949
local_in_edges_tensor generation:  0.09645819664001465
mini_batch_src_global generation:  0.08219385147094727
r_  generation:  0.8194730281829834
local_output_nid generation:  0.04877209663391113
local_in_edges_tensor generation:  0.04703354835510254
mini_batch_src_global generation:  0.07604813575744629
r_  generation:  0.8267486095428467
local_output_nid generation:  0.045276641845703125
local_in_edges_tensor generation:  0.05639052391052246
mini_batch_src_global generation:  0.07017755508422852
r_  generation:  0.7327489852905273
----------------------check_connections_block total spend ----------------------------- 10.903148651123047
generate_one_block  1.0447375774383545
generate_one_block  1.2556467056274414
generate_one_block  0.9673209190368652
generate_one_block  0.9131011962890625
generate_one_block  0.7534115314483643
generate_one_block  1.017390489578247
generate_one_block  1.061969518661499
generate_one_block  1.0365777015686035
generate_one_block  0.891516923904419
----------===============-------------===============-------------the number of batches *****---- 9

original number of batches:  9
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 0.24971675872802734  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

connection checking time:  13.929951906204224
block generation total time  11.77299690246582
average batch blocks generation time:  0.6540553834703233
block dataloader generation time/epoch 62.14058379332224
pseudo mini batch 0 input nodes size: 477595
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 0.19927406311035156  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 0.19927406311035156  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 0.37719249725341797  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 0.37735605239868164  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 0.19218778610229492  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 0.21039247512817383  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 0.21039247512817383  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 477595
first layer output nodes number: 191940
edges number: 1898388
torch.Size([477595, 100])
torch.Size([191940, 256])
torch.Size([21899, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 19.46408176422119  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 19.468554973602295  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 0.2425861358642578  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

pseudo mini batch 1 input nodes size: 498775
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 0.19266796112060547  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 0.19266796112060547  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 0.3784761428833008  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 0.3786430358886719  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 0.2005610466003418  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 0.22031736373901367  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.6151123046875 GB
    Memory Allocated: 0.22031736373901367  GigaBytes
Max Memory Allocated: 21.22313165664673  GigaBytes

first layer input nodes number: 498775
first layer output nodes number: 211232
edges number: 2094738
torch.Size([498775, 100])
torch.Size([211232, 256])
torch.Size([22357, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.2830810546875 GB
    Memory Allocated: 20.800848484039307  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.2830810546875 GB
    Memory Allocated: 20.804763793945312  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.6932373046875 GB
    Memory Allocated: 0.25147104263305664  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

pseudo mini batch 2 input nodes size: 539698
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.6932373046875 GB
    Memory Allocated: 0.20021867752075195  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.6932373046875 GB
    Memory Allocated: 0.20021867752075195  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.6932373046875 GB
    Memory Allocated: 0.4012722969055176  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.6932373046875 GB
    Memory Allocated: 0.4014310836791992  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.6932373046875 GB
    Memory Allocated: 0.2154560089111328  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.6932373046875 GB
    Memory Allocated: 0.23291301727294922  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6932373046875 GB
    Memory Allocated: 0.23291301727294922  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

first layer input nodes number: 539698
first layer output nodes number: 179067
edges number: 1742421
torch.Size([539698, 100])
torch.Size([179067, 256])
torch.Size([21261, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6151123046875 GB
    Memory Allocated: 18.003721237182617  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.6151123046875 GB
    Memory Allocated: 18.007444381713867  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.6190185546875 GB
    Memory Allocated: 0.2598886489868164  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

pseudo mini batch 3 input nodes size: 509340
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.6190185546875 GB
    Memory Allocated: 0.21510982513427734  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.6190185546875 GB
    Memory Allocated: 0.21510982513427734  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.6190185546875 GB
    Memory Allocated: 0.40485382080078125  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.6190185546875 GB
    Memory Allocated: 0.4050126075744629  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.6190185546875 GB
    Memory Allocated: 0.20380020141601562  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.6190185546875 GB
    Memory Allocated: 0.21998214721679688  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.6190185546875 GB
    Memory Allocated: 0.21998214721679688  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

first layer input nodes number: 509340
first layer output nodes number: 171099
edges number: 1681415
torch.Size([509340, 100])
torch.Size([171099, 256])
torch.Size([21255, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7459716796875 GB
    Memory Allocated: 17.36922025680542  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.7459716796875 GB
    Memory Allocated: 17.37294340133667  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.7498779296875 GB
    Memory Allocated: 0.24724531173706055  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

pseudo mini batch 4 input nodes size: 369998
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.7498779296875 GB
    Memory Allocated: 0.20438051223754883  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.7498779296875 GB
    Memory Allocated: 0.20438051223754883  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.7498779296875 GB
    Memory Allocated: 0.34221553802490234  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.7498779296875 GB
    Memory Allocated: 0.3423738479614258  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.7498779296875 GB
    Memory Allocated: 0.15247106552124023  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.7498779296875 GB
    Memory Allocated: 0.1669936180114746  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7498779296875 GB
    Memory Allocated: 0.1669936180114746  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

first layer input nodes number: 369998
first layer output nodes number: 149818
edges number: 1447505
torch.Size([369998, 100])
torch.Size([149818, 256])
torch.Size([21215, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7498779296875 GB
    Memory Allocated: 16.087621212005615  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.7498779296875 GB
    Memory Allocated: 16.091336250305176  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.7498779296875 GB
    Memory Allocated: 0.19069194793701172  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

pseudo mini batch 5 input nodes size: 459880
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.7498779296875 GB
    Memory Allocated: 0.15188264846801758  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.7498779296875 GB
    Memory Allocated: 0.15188264846801758  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.7498779296875 GB
    Memory Allocated: 0.32320165634155273  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.7498779296875 GB
    Memory Allocated: 0.3233680725097656  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.7498779296875 GB
    Memory Allocated: 0.18537473678588867  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.7498779296875 GB
    Memory Allocated: 0.20316267013549805  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.7498779296875 GB
    Memory Allocated: 0.20316267013549805  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

first layer input nodes number: 459880
first layer output nodes number: 180294
edges number: 1777141
torch.Size([459880, 100])
torch.Size([180294, 256])
torch.Size([22335, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8748779296875 GB
    Memory Allocated: 18.84547233581543  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.8748779296875 GB
    Memory Allocated: 18.84938383102417  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.8787841796875 GB
    Memory Allocated: 0.23142576217651367  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

pseudo mini batch 6 input nodes size: 465443
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.8787841796875 GB
    Memory Allocated: 0.18557119369506836  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.8787841796875 GB
    Memory Allocated: 0.18557119369506836  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.8787841796875 GB
    Memory Allocated: 0.3589625358581543  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.8787841796875 GB
    Memory Allocated: 0.3591303825378418  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.8787841796875 GB
    Memory Allocated: 0.18764495849609375  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.8787841796875 GB
    Memory Allocated: 0.20545673370361328  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.8787841796875 GB
    Memory Allocated: 0.20545673370361328  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

first layer input nodes number: 465443
first layer output nodes number: 175849
edges number: 1726146
torch.Size([465443, 100])
torch.Size([175849, 256])
torch.Size([22496, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4373779296875 GB
    Memory Allocated: 18.584126472473145  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.4373779296875 GB
    Memory Allocated: 18.58834934234619  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.4393310546875 GB
    Memory Allocated: 0.2339491844177246  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

pseudo mini batch 7 input nodes size: 449235
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.4393310546875 GB
    Memory Allocated: 0.18787336349487305  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.4393310546875 GB
    Memory Allocated: 0.18787336349487305  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.4393310546875 GB
    Memory Allocated: 0.3552265167236328  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.4393310546875 GB
    Memory Allocated: 0.3553938865661621  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.4393310546875 GB
    Memory Allocated: 0.18183469772338867  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.4393310546875 GB
    Memory Allocated: 0.20001935958862305  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.4393310546875 GB
    Memory Allocated: 0.20001935958862305  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

first layer input nodes number: 449235
first layer output nodes number: 178999
edges number: 1714951
torch.Size([449235, 100])
torch.Size([178999, 256])
torch.Size([22453, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6990966796875 GB
    Memory Allocated: 18.285303592681885  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6990966796875 GB
    Memory Allocated: 18.289443492889404  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.22747564315795898  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

pseudo mini batch 8 input nodes size: 412610
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1816267967224121  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1816267967224121  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.33533620834350586  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.3354949951171875  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.16797447204589844  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1835627555847168  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.1835627555847168  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

first layer input nodes number: 412610
first layer output nodes number: 160598
edges number: 1541860
torch.Size([412610, 100])
torch.Size([160598, 256])
torch.Size([21300, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 16.856258869171143  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 16.86042594909668  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.20966243743896484  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.20966243743896484  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.7030029296875 GB
    Memory Allocated: 0.20966243743896484  GigaBytes
Max Memory Allocated: 21.856839179992676  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1595900058746338 |0.014989323086208768 |0.2066557142469618 |0.0001494619581434462 |0.24431178304884169 |0.0059702396392822266 |
----------------------------------------------------------pseudo_mini_loss sum 1.443663239479065
Total (block generation + training)time/epoch 68.33652345339458
Training time/epoch 5.763116121292114
Training time without block to device /epoch 5.628212213516235
Training time without total dataloading part /epoch 4.066022872924805
load block tensor time/epoch 1.436310052871704
block to device time/epoch 0.1349039077758789
input features size transfer per epoch 1.2069940567016602e-06
blocks size to device per epoch 8.046627044677734e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  5781470
Number of first layer input nodes during this epoch:  4182574
Number of first layer output nodes during this epoch:  1598896
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  682400
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([400, 100])
layers.0.lstm.weight_hh_l0, torch.Size([400, 100])
layers.0.lstm.bias_ih_l0, torch.Size([400])
layers.0.lstm.bias_hh_l0, torch.Size([400])
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([47, 256])
layers.1.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
