main start at this time 1655789346.8730657
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.20711874961853027
global_2_local spend time (sec) 0.39187097549438477
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.04910135269165039
A = g.adjacency_matrix() spent  0.07392263412475586
auxiliary_graph
Graph(num_nodes=1205586, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.592400312423706
remove nodes length
1009015
auxiliary_graph.remove_nodes spent  2.704643726348877
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.075833559036255

the counter of shared neighbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
51547892
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 51547889, 51547890, 51547891])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
Convert a graph into a bidirected graph: 2.960 seconds
Metis partitioning: 12.505 seconds
Split the graph: 1.552 seconds
Construct subgraphs: 0.397 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  17.435059070587158
11225
11448
11287
11868
11225
11764
11865
11906
11225
11276
11314
11644
11882
11900
11510
11821
11411
total k batches seeds list generation spend  38.47857880592346
after graph partition
graph partition algorithm spend time 39.076918840408325
11225
11448
11287
11868
11225
11764
11865
11906
11225
11276
11314
11644
11882
11900
11510
11821
11411
partition_len_list
[101515, 85651, 104104, 95383, 108197, 77925, 87923, 92825, 100095, 94843, 120081, 82064, 111217, 121660, 109607, 108462, 112089]
shared_neighbor_graph_partition_s0 selection method  spend 39.72741913795471
time for parepare:  0.24574685096740723
local_output_nid generation:  0.004736423492431641
local_in_edges_tensor generation:  0.030845165252685547
mini_batch_src_global generation:  0.008983135223388672
r_  generation:  0.09351563453674316
local_output_nid generation:  0.004189014434814453
local_in_edges_tensor generation:  0.011715173721313477
mini_batch_src_global generation:  0.011409759521484375
r_  generation:  0.09568643569946289
local_output_nid generation:  0.004233360290527344
local_in_edges_tensor generation:  0.0061724185943603516
mini_batch_src_global generation:  0.008912324905395508
r_  generation:  0.1050405502319336
local_output_nid generation:  0.004342555999755859
local_in_edges_tensor generation:  0.004586696624755859
mini_batch_src_global generation:  0.010682821273803711
r_  generation:  0.11044907569885254
local_output_nid generation:  0.004126787185668945
local_in_edges_tensor generation:  0.00397181510925293
mini_batch_src_global generation:  0.010124921798706055
r_  generation:  0.11046290397644043
local_output_nid generation:  0.00432133674621582
local_in_edges_tensor generation:  0.003985404968261719
mini_batch_src_global generation:  0.011698484420776367
r_  generation:  0.10168790817260742
local_output_nid generation:  0.004323005676269531
local_in_edges_tensor generation:  0.004144191741943359
mini_batch_src_global generation:  0.010944366455078125
r_  generation:  0.10904121398925781
local_output_nid generation:  0.004307746887207031
local_in_edges_tensor generation:  0.00453495979309082
mini_batch_src_global generation:  0.01626753807067871
r_  generation:  0.11653542518615723
local_output_nid generation:  0.004134416580200195
local_in_edges_tensor generation:  0.0039010047912597656
mini_batch_src_global generation:  0.011167287826538086
r_  generation:  0.11087298393249512
local_output_nid generation:  0.004174947738647461
local_in_edges_tensor generation:  0.003932952880859375
mini_batch_src_global generation:  0.011105775833129883
r_  generation:  0.10037398338317871
local_output_nid generation:  0.004198551177978516
local_in_edges_tensor generation:  0.003816366195678711
mini_batch_src_global generation:  0.010679006576538086
r_  generation:  0.11040925979614258
local_output_nid generation:  0.004323005676269531
local_in_edges_tensor generation:  0.00400233268737793
mini_batch_src_global generation:  0.011977910995483398
r_  generation:  0.10500454902648926
local_output_nid generation:  0.0043621063232421875
local_in_edges_tensor generation:  0.004114627838134766
mini_batch_src_global generation:  0.011715888977050781
r_  generation:  0.12505841255187988
local_output_nid generation:  0.00433802604675293
local_in_edges_tensor generation:  0.004882097244262695
mini_batch_src_global generation:  0.01401066780090332
r_  generation:  0.12742400169372559
local_output_nid generation:  0.004265785217285156
local_in_edges_tensor generation:  0.0040264129638671875
mini_batch_src_global generation:  0.011794805526733398
r_  generation:  0.12462973594665527
local_output_nid generation:  0.004395246505737305
local_in_edges_tensor generation:  0.004041433334350586
mini_batch_src_global generation:  0.013039112091064453
r_  generation:  0.12681078910827637
local_output_nid generation:  0.004251956939697266
local_in_edges_tensor generation:  0.0040874481201171875
mini_batch_src_global generation:  0.01253366470336914
r_  generation:  0.12735891342163086
----------------------check_connections_block total spend ----------------------------- 2.949850559234619
generate_one_block  1.5533301830291748
generate_one_block  0.13594579696655273
generate_one_block  0.14310145378112793
generate_one_block  0.1725163459777832
generate_one_block  0.17296385765075684
generate_one_block  0.15497231483459473
generate_one_block  0.1724376678466797
generate_one_block  0.18084049224853516
generate_one_block  0.1826038360595703
generate_one_block  0.17333364486694336
generate_one_block  0.2130293846130371
generate_one_block  0.16132903099060059
generate_one_block  0.17171525955200195
generate_one_block  0.17217302322387695
generate_one_block  0.15222954750061035
generate_one_block  0.15166306495666504
generate_one_block  0.14590811729431152
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.71323561668396
gen group dst list time:  0.045169830322265625
time for parepare:  0.3957982063293457
local_output_nid generation:  0.02528095245361328
local_in_edges_tensor generation:  0.09118890762329102
mini_batch_src_global generation:  0.03059673309326172
r_  generation:  0.39303088188171387
local_output_nid generation:  0.02549290657043457
local_in_edges_tensor generation:  0.031592369079589844
mini_batch_src_global generation:  0.033922433853149414
r_  generation:  0.35912370681762695
local_output_nid generation:  0.030240774154663086
local_in_edges_tensor generation:  0.035141706466674805
mini_batch_src_global generation:  0.035953521728515625
r_  generation:  0.4398481845855713
local_output_nid generation:  0.027149200439453125
local_in_edges_tensor generation:  0.03472781181335449
mini_batch_src_global generation:  0.03930401802062988
r_  generation:  0.41439318656921387
local_output_nid generation:  0.030966997146606445
local_in_edges_tensor generation:  0.03520989418029785
mini_batch_src_global generation:  0.042724609375
r_  generation:  0.4895925521850586
local_output_nid generation:  0.021164894104003906
local_in_edges_tensor generation:  0.018450260162353516
mini_batch_src_global generation:  0.03629159927368164
r_  generation:  0.3258168697357178
local_output_nid generation:  0.0238494873046875
local_in_edges_tensor generation:  0.02107715606689453
mini_batch_src_global generation:  0.03552126884460449
r_  generation:  0.38739943504333496
local_output_nid generation:  0.027369022369384766
local_in_edges_tensor generation:  0.03228926658630371
mini_batch_src_global generation:  0.04057788848876953
r_  generation:  0.4099001884460449
local_output_nid generation:  0.028388023376464844
local_in_edges_tensor generation:  0.028586626052856445
mini_batch_src_global generation:  0.042942047119140625
r_  generation:  0.46341896057128906
local_output_nid generation:  0.028397798538208008
local_in_edges_tensor generation:  0.03263425827026367
mini_batch_src_global generation:  0.04189491271972656
r_  generation:  0.4404592514038086
local_output_nid generation:  0.03373908996582031
local_in_edges_tensor generation:  0.03814077377319336
mini_batch_src_global generation:  0.04762673377990723
r_  generation:  0.6038002967834473
local_output_nid generation:  0.02189922332763672
local_in_edges_tensor generation:  0.02111506462097168
mini_batch_src_global generation:  0.0395817756652832
r_  generation:  0.36859655380249023
local_output_nid generation:  0.031534671783447266
local_in_edges_tensor generation:  0.031524658203125
mini_batch_src_global generation:  0.04478335380554199
r_  generation:  0.5271933078765869
local_output_nid generation:  0.0338895320892334
local_in_edges_tensor generation:  0.05382728576660156
mini_batch_src_global generation:  0.053157806396484375
r_  generation:  0.5721831321716309
local_output_nid generation:  0.03635716438293457
local_in_edges_tensor generation:  0.04677104949951172
mini_batch_src_global generation:  0.04835033416748047
r_  generation:  0.5242617130279541
local_output_nid generation:  0.038245201110839844
local_in_edges_tensor generation:  0.03424191474914551
mini_batch_src_global generation:  0.04843759536743164
r_  generation:  0.5005824565887451
local_output_nid generation:  0.03354239463806152
local_in_edges_tensor generation:  0.04129981994628906
mini_batch_src_global generation:  0.04714679718017578
r_  generation:  0.5462510585784912
----------------------check_connections_block total spend ----------------------------- 11.707562685012817
generate_one_block  0.8795819282531738
generate_one_block  0.46628713607788086
generate_one_block  0.5608172416687012
generate_one_block  0.4947082996368408
generate_one_block  0.5788688659667969
generate_one_block  0.36794495582580566
generate_one_block  0.45337939262390137
generate_one_block  0.48671698570251465
generate_one_block  0.543450117111206
generate_one_block  0.5178976058959961
generate_one_block  0.6640610694885254
generate_one_block  0.4036424160003662
generate_one_block  0.6224479675292969
generate_one_block  0.6946954727172852
generate_one_block  0.5800554752349854
generate_one_block  0.603186845779419
generate_one_block  0.6602966785430908
----------===============-------------===============-------------the number of batches *****---- 17

original number of batches:  17
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

connection checking time:  14.657413244247437
block generation total time  13.788131475448608
average batch blocks generation time:  0.40553327868966493
block dataloader generation time/epoch 70.20851230621338
pseudo mini batch 0 input nodes size: 316098
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1385498046875 GB
    Memory Allocated: 0.1202993392944336  GigaBytes
Max Memory Allocated: 0.1202993392944336  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1385498046875 GB
    Memory Allocated: 0.12038326263427734  GigaBytes
Max Memory Allocated: 0.12038326263427734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1385498046875 GB
    Memory Allocated: 0.12038326263427734  GigaBytes
Max Memory Allocated: 0.12038326263427734  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.13007688522338867  GigaBytes
Max Memory Allocated: 0.13007688522338867  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.13007688522338867  GigaBytes
Max Memory Allocated: 0.13007688522338867  GigaBytes

first layer input nodes number: 316098
first layer output nodes number: 101515
edges number: 980286
----------------------------------------before model layer 0
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.13318920135498047  GigaBytes
Max Memory Allocated: 0.1368412971496582  GigaBytes

torch.Size([316098, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.13318920135498047  GigaBytes
Max Memory Allocated: 0.1368412971496582  GigaBytes

m.shape torch.Size([312, 1, 100])
----------------------------------------1
 Nvidia-smi: 1.7244873046875 GB
    Memory Allocated: 0.508878231048584  GigaBytes
Max Memory Allocated: 0.5243659019470215  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7244873046875 GB
    Memory Allocated: 0.508878231048584  GigaBytes
Max Memory Allocated: 0.5243659019470215  GigaBytes

 h.shape torch.Size([1, 312, 100]), torch.Size([1, 312, 100])
----------------------------------------3
 Nvidia-smi: 1.7244873046875 GB
    Memory Allocated: 0.5091109275817871  GigaBytes
Max Memory Allocated: 0.5243659019470215  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.5109710693359375  GigaBytes
Max Memory Allocated: 0.5243659019470215  GigaBytes

rst.shape  torch.Size([1, 312, 100])
m.shape torch.Size([503, 2, 100])
----------------------------------------1
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.5112295150756836  GigaBytes
Max Memory Allocated: 0.5243659019470215  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.5112295150756836  GigaBytes
Max Memory Allocated: 0.5243659019470215  GigaBytes

 h.shape torch.Size([1, 503, 100]), torch.Size([1, 503, 100])
----------------------------------------3
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.5116043090820312  GigaBytes
Max Memory Allocated: 0.5243659019470215  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7342529296875 GB
    Memory Allocated: 0.5172262191772461  GigaBytes
Max Memory Allocated: 0.5243659019470215  GigaBytes

rst.shape  torch.Size([1, 503, 100])
m.shape torch.Size([647, 3, 100])
----------------------------------------1
 Nvidia-smi: 1.7342529296875 GB
    Memory Allocated: 0.5177621841430664  GigaBytes
Max Memory Allocated: 0.5243659019470215  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7342529296875 GB
    Memory Allocated: 0.5177621841430664  GigaBytes
Max Memory Allocated: 0.5243659019470215  GigaBytes

 h.shape torch.Size([1, 647, 100]), torch.Size([1, 647, 100])
----------------------------------------3
 Nvidia-smi: 1.7342529296875 GB
    Memory Allocated: 0.518244743347168  GigaBytes
Max Memory Allocated: 0.5243659019470215  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7459716796875 GB
    Memory Allocated: 0.5288524627685547  GigaBytes
Max Memory Allocated: 0.5295758247375488  GigaBytes

rst.shape  torch.Size([1, 647, 100])
m.shape torch.Size([888, 4, 100])
----------------------------------------1
 Nvidia-smi: 1.7459716796875 GB
    Memory Allocated: 0.5301737785339355  GigaBytes
Max Memory Allocated: 0.5302138328552246  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7459716796875 GB
    Memory Allocated: 0.5301737785339355  GigaBytes
Max Memory Allocated: 0.5302138328552246  GigaBytes

 h.shape torch.Size([1, 888, 100]), torch.Size([1, 888, 100])
----------------------------------------3
 Nvidia-smi: 1.7459716796875 GB
    Memory Allocated: 0.5308356285095215  GigaBytes
Max Memory Allocated: 0.5308356285095215  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5500235557556152  GigaBytes
Max Memory Allocated: 0.5513467788696289  GigaBytes

rst.shape  torch.Size([1, 888, 100])
m.shape torch.Size([1083, 5, 100])
----------------------------------------1
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5517101287841797  GigaBytes
Max Memory Allocated: 0.5517711639404297  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5517101287841797  GigaBytes
Max Memory Allocated: 0.5517711639404297  GigaBytes

 h.shape torch.Size([1, 1083, 100]), torch.Size([1, 1083, 100])
----------------------------------------3
 Nvidia-smi: 1.7498779296875 GB
    Memory Allocated: 0.5525178909301758  GigaBytes
Max Memory Allocated: 0.5525178909301758  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7947998046875 GB
    Memory Allocated: 0.581758975982666  GigaBytes
Max Memory Allocated: 0.5837764739990234  GigaBytes

rst.shape  torch.Size([1, 1083, 100])
m.shape torch.Size([1169, 6, 100])
----------------------------------------1
 Nvidia-smi: 1.7947998046875 GB
    Memory Allocated: 0.5839681625366211  GigaBytes
Max Memory Allocated: 0.5840468406677246  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7947998046875 GB
    Memory Allocated: 0.5839681625366211  GigaBytes
Max Memory Allocated: 0.5840468406677246  GigaBytes

 h.shape torch.Size([1, 1169, 100]), torch.Size([1, 1169, 100])
----------------------------------------3
 Nvidia-smi: 1.7967529296875 GB
    Memory Allocated: 0.5848398208618164  GigaBytes
Max Memory Allocated: 0.5848398208618164  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.6226692199707031  GigaBytes
Max Memory Allocated: 0.6252822875976562  GigaBytes

rst.shape  torch.Size([1, 1169, 100])
m.shape torch.Size([1310, 7, 100])
----------------------------------------1
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.6256499290466309  GigaBytes
Max Memory Allocated: 0.6257529258728027  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8416748046875 GB
    Memory Allocated: 0.6256499290466309  GigaBytes
Max Memory Allocated: 0.6257529258728027  GigaBytes

 h.shape torch.Size([1, 1310, 100]), torch.Size([1, 1310, 100])
----------------------------------------3
 Nvidia-smi: 1.8436279296875 GB
    Memory Allocated: 0.6266264915466309  GigaBytes
Max Memory Allocated: 0.6266264915466309  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.6759414672851562  GigaBytes
Max Memory Allocated: 0.6793580055236816  GigaBytes

rst.shape  torch.Size([1, 1310, 100])
m.shape torch.Size([1417, 8, 100])
----------------------------------------1
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.6796765327453613  GigaBytes
Max Memory Allocated: 0.6798038482666016  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8905029296875 GB
    Memory Allocated: 0.6796765327453613  GigaBytes
Max Memory Allocated: 0.6798038482666016  GigaBytes

 h.shape torch.Size([1, 1417, 100]), torch.Size([1, 1417, 100])
----------------------------------------3
 Nvidia-smi: 1.8924560546875 GB
    Memory Allocated: 0.6807332038879395  GigaBytes
Max Memory Allocated: 0.6807332038879395  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.7419772148132324  GigaBytes
Max Memory Allocated: 0.7462005615234375  GigaBytes

rst.shape  torch.Size([1, 1417, 100])
m.shape torch.Size([1320, 9, 100])
----------------------------------------1
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.7458748817443848  GigaBytes
Max Memory Allocated: 0.7462005615234375  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.7458748817443848  GigaBytes
Max Memory Allocated: 0.7462005615234375  GigaBytes

 h.shape torch.Size([1, 1320, 100]), torch.Size([1, 1320, 100])
----------------------------------------3
 Nvidia-smi: 1.9627685546875 GB
    Memory Allocated: 0.746859073638916  GigaBytes
Max Memory Allocated: 0.746859073638916  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0350341796875 GB
    Memory Allocated: 0.8098087310791016  GigaBytes
Max Memory Allocated: 0.814234733581543  GigaBytes

rst.shape  torch.Size([1, 1320, 100])
m.shape torch.Size([92866, 10, 100])
----------------------------------------1
 Nvidia-smi: 2.4022216796875 GB
    Memory Allocated: 1.1552696228027344  GigaBytes
Max Memory Allocated: 1.1656489372253418  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4022216796875 GB
    Memory Allocated: 1.1552696228027344  GigaBytes
Max Memory Allocated: 1.1656489372253418  GigaBytes

 h.shape torch.Size([1, 92866, 100]), torch.Size([1, 92866, 100])
----------------------------------------3
 Nvidia-smi: 2.4725341796875 GB
    Memory Allocated: 1.2255821228027344  GigaBytes
Max Memory Allocated: 1.2255821228027344  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.159175872802734  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 92866, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 5.794140815734863  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 5.890953063964844  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 5.987765312194824  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 5.890953063964844  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

torch.Size([101515, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 5.987765312194824  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.011968612670898  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.011968612670898  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

m.shape torch.Size([47, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.272149562835693  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.272149562835693  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.2722392082214355  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.272956371307373  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([38, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.272984981536865  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.272984981536865  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.273057460784912  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.274144649505615  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([29, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.2741923332214355  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.2741923332214355  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.274247646331787  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.2754645347595215  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([31, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.2755560874938965  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.2755560874938965  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.275615215301514  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.277329921722412  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.277454376220703  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.277454376220703  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.277515411376953  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.279712677001953  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([33, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.279872894287109  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.279872894287109  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.279935836791992  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.282642364501953  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([35, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.282846450805664  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.282846450805664  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.2829132080078125  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.286251068115234  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([37, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.286502361297607  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.286502361297607  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 7.7537841796875 GB
    Memory Allocated: 6.2865729331970215  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7557373046875 GB
    Memory Allocated: 6.290595531463623  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([26, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.7557373046875 GB
    Memory Allocated: 6.290785312652588  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7557373046875 GB
    Memory Allocated: 6.290785312652588  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 7.7557373046875 GB
    Memory Allocated: 6.290834903717041  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7596435546875 GB
    Memory Allocated: 6.294008731842041  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([39, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.7596435546875 GB
    Memory Allocated: 6.29435920715332  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7596435546875 GB
    Memory Allocated: 6.29435920715332  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 7.7596435546875 GB
    Memory Allocated: 6.29443359375  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7655029296875 GB
    Memory Allocated: 6.299715042114258  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([30, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.7655029296875 GB
    Memory Allocated: 6.299995422363281  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7655029296875 GB
    Memory Allocated: 6.299995422363281  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 7.7655029296875 GB
    Memory Allocated: 6.300052642822266  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7694091796875 GB
    Memory Allocated: 6.304515838623047  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.7694091796875 GB
    Memory Allocated: 6.304856300354004  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7694091796875 GB
    Memory Allocated: 6.304856300354004  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 7.7694091796875 GB
    Memory Allocated: 6.304917335510254  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7752685546875 GB
    Memory Allocated: 6.310105323791504  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.7752685546875 GB
    Memory Allocated: 6.310687065124512  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7752685546875 GB
    Memory Allocated: 6.310687065124512  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 7.7752685546875 GB
    Memory Allocated: 6.3107805252075195  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7850341796875 GB
    Memory Allocated: 6.319378852844238  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.7850341796875 GB
    Memory Allocated: 6.320045471191406  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7850341796875 GB
    Memory Allocated: 6.320045471191406  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 7.7850341796875 GB
    Memory Allocated: 6.320146560668945  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7967529296875 GB
    Memory Allocated: 6.3301544189453125  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.7967529296875 GB
    Memory Allocated: 6.33060884475708  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7967529296875 GB
    Memory Allocated: 6.33060884475708  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 7.7967529296875 GB
    Memory Allocated: 6.3306756019592285  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8026123046875 GB
    Memory Allocated: 6.337751865386963  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 6.338349342346191  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 6.338349342346191  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 7.8045654296875 GB
    Memory Allocated: 6.338427543640137  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8123779296875 GB
    Memory Allocated: 6.347264289855957  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([47, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.8143310546875 GB
    Memory Allocated: 6.34799337387085  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8143310546875 GB
    Memory Allocated: 6.34799337387085  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 7.8143310546875 GB
    Memory Allocated: 6.348083019256592  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8260498046875 GB
    Memory Allocated: 6.358840465545654  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.8260498046875 GB
    Memory Allocated: 6.359332084655762  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8260498046875 GB
    Memory Allocated: 6.359332084655762  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 7.8260498046875 GB
    Memory Allocated: 6.359391212463379  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8319091796875 GB
    Memory Allocated: 6.366900444030762  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([39, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.8338623046875 GB
    Memory Allocated: 6.367583274841309  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8338623046875 GB
    Memory Allocated: 6.367583274841309  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 7.8338623046875 GB
    Memory Allocated: 6.367657661437988  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8436279296875 GB
    Memory Allocated: 6.377625465393066  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.8436279296875 GB
    Memory Allocated: 6.3782806396484375  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8436279296875 GB
    Memory Allocated: 6.3782806396484375  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 7.8436279296875 GB
    Memory Allocated: 6.378349304199219  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8533935546875 GB
    Memory Allocated: 6.388031005859375  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([47, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.8553466796875 GB
    Memory Allocated: 6.388945579528809  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8553466796875 GB
    Memory Allocated: 6.388945579528809  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 7.8553466796875 GB
    Memory Allocated: 6.389035224914551  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8690185546875 GB
    Memory Allocated: 6.4023027420043945  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.8690185546875 GB
    Memory Allocated: 6.402976989746094  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8690185546875 GB
    Memory Allocated: 6.402976989746094  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 7.8690185546875 GB
    Memory Allocated: 6.403041839599609  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8787841796875 GB
    Memory Allocated: 6.413093566894531  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([47, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.8787841796875 GB
    Memory Allocated: 6.4147725105285645  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8787841796875 GB
    Memory Allocated: 6.4147725105285645  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 7.8787841796875 GB
    Memory Allocated: 6.414862155914307  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8944091796875 GB
    Memory Allocated: 6.429384708404541  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.8944091796875 GB
    Memory Allocated: 6.430262565612793  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8944091796875 GB
    Memory Allocated: 6.430262565612793  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 7.8944091796875 GB
    Memory Allocated: 6.4303388595581055  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9080810546875 GB
    Memory Allocated: 6.443232536315918  GigaBytes
Max Memory Allocated: 6.505128860473633  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([10317, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.1580810546875 GB
    Memory Allocated: 6.6912102699279785  GigaBytes
Max Memory Allocated: 6.692171573638916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1580810546875 GB
    Memory Allocated: 6.6912102699279785  GigaBytes
Max Memory Allocated: 6.692171573638916  GigaBytes

 h.shape torch.Size([1, 10317, 256]), torch.Size([1, 10317, 256])
----------------------------------------3
 Nvidia-smi: 8.1580810546875 GB
    Memory Allocated: 6.710888385772705  GigaBytes
Max Memory Allocated: 6.710888385772705  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.8729248046875 GB
    Memory Allocated: 10.17423677444458  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 10317, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.8729248046875 GB
    Memory Allocated: 9.917716979980469  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.8729248046875 GB
    Memory Allocated: 9.919682502746582  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.8729248046875 GB
    Memory Allocated: 9.921648025512695  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.8729248046875 GB
    Memory Allocated: 9.919598579406738  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

torch.Size([11225, 47])
input nodes number: 101515
output nodes number: 11225
edges number: 269650
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8729248046875 GB
    Memory Allocated: 9.922404766082764  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.8729248046875 GB
    Memory Allocated: 9.92240571975708  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.15271520614624023  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

pseudo mini batch 1 input nodes size: 235857
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.1248931884765625  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.1248931884765625  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.21275711059570312  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.21284246444702148  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.09500265121459961  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.10379934310913086  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.10379934310913086  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

first layer input nodes number: 235857
first layer output nodes number: 85651
edges number: 822998
----------------------------------------before model layer 0
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.10619544982910156  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

torch.Size([235857, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.10619544982910156  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

m.shape torch.Size([333, 1, 100])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.42160463333129883  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.42160463333129883  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 333, 100]), torch.Size([1, 333, 100])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.42185354232788086  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.4238405227661133  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 333, 100])
m.shape torch.Size([491, 2, 100])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.42408227920532227  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.42408227920532227  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 491, 100]), torch.Size([1, 491, 100])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.42444849014282227  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.42993879318237305  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 491, 100])
m.shape torch.Size([714, 3, 100])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.4305539131164551  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.4305539131164551  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 714, 100]), torch.Size([1, 714, 100])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.43108606338500977  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.44363927841186523  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 714, 100])
m.shape torch.Size([857, 4, 100])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.44465065002441406  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.44465065002441406  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 857, 100]), torch.Size([1, 857, 100])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.44528961181640625  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.4640355110168457  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 857, 100])
m.shape torch.Size([1028, 5, 100])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.46563100814819336  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.46563100814819336  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 1028, 100]), torch.Size([1, 1028, 100])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.466397762298584  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.494077205657959  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 1028, 100])
m.shape torch.Size([1078, 6, 100])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.49610376358032227  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.49610376358032227  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 1078, 100]), torch.Size([1, 1078, 100])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.49690771102905273  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.5324406623840332  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 1078, 100])
m.shape torch.Size([1159, 7, 100])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.5350613594055176  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.5350613594055176  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 1159, 100]), torch.Size([1, 1159, 100])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.5359253883361816  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.5795292854309082  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 1159, 100])
m.shape torch.Size([1188, 8, 100])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.5826377868652344  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.5826377868652344  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 1188, 100]), torch.Size([1, 1188, 100])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.5835237503051758  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.6339893341064453  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 1188, 100])
m.shape torch.Size([1142, 9, 100])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.6373753547668457  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.6373753547668457  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 1142, 100]), torch.Size([1, 1142, 100])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.6382269859313965  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.6935691833496094  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 1142, 100])
m.shape torch.Size([77661, 10, 100])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.9824533462524414  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 0.9824533462524414  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 77661, 100]), torch.Size([1, 77661, 100])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 1.0409016609191895  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.149109363555908  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 77661, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 4.843888282775879  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 4.925571441650391  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.007254600524902  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 4.925571441650391  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

torch.Size([85651, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.007254600524902  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.027675628662109  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.027675628662109  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

m.shape torch.Size([15, 1, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.293565273284912  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.293565273284912  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.293593883514404  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.293822765350342  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([21, 2, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.293848991394043  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.293848991394043  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.293889045715332  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.294489860534668  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([17, 3, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.294518947601318  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.294518947601318  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.294551372528076  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.295264720916748  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([27, 4, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.295352458953857  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.295352458953857  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.295403957366943  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.2968974113464355  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([41, 5, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.297069072723389  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.297069072723389  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.297147274017334  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.299962520599365  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([41, 6, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.300159931182861  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.300159931182861  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.300238132476807  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.303600788116455  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([42, 7, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.303844451904297  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.303844451904297  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.303924560546875  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.307929992675781  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([34, 8, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.308151721954346  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.308151721954346  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.308216571807861  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.311913013458252  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 9, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.312131881713867  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.312131881713867  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.312187194824219  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.315727233886719  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([42, 10, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.316103458404541  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.316103458404541  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.316183567047119  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.321871280670166  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([45, 11, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.322307109832764  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.322307109832764  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.32239294052124  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.329087734222412  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([46, 12, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.329575538635254  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.329575538635254  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.329663276672363  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.33712100982666  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([41, 13, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.337589740753174  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.337589740753174  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.337667942047119  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.344862461090088  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.3453216552734375  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.3453216552734375  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.345392227172852  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.352378845214844  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.352877140045166  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.352877140045166  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.35294771194458  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.360428333282471  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.361069679260254  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.361069679260254  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.361153602600098  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.370636940002441  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.371150970458984  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.371150970458984  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.3712158203125  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.378997802734375  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.379570960998535  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.379570960998535  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.379637718200684  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.388115882873535  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.388776779174805  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.388776779174805  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.388849258422852  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.398561477661133  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([46, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.399409770965576  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.399409770965576  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.3994975090026855  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.411868572235107  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.412632465362549  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.412632465362549  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.412708759307861  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.424000263214111  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([49, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.425065994262695  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.425065994262695  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.425159454345703  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.439645767211914  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([47, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.44070291519165  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.44070291519165  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.440792560577393  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.455315113067627  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.456216335296631  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.456216335296631  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.456294536590576  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.469510555267334  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([10559, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.7237443923950195  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.7237443923950195  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 10559, 256]), torch.Size([1, 10559, 256])
----------------------------------------3
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 5.743884086608887  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 9.341201782226562  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 10559, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 9.07852840423584  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 9.081336498260498  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 9.084144592285156  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 9.08125114440918  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

torch.Size([11448, 47])
input nodes number: 85651
output nodes number: 11448
edges number: 276079
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 9.082817554473877  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 9.082818031311035  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 12.6561279296875 GB
    Memory Allocated: 0.11890745162963867  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

pseudo mini batch 2 input nodes size: 307713
----------------------------------------before load block subtensor 
 Nvidia-smi: 12.6561279296875 GB
    Memory Allocated: 0.09584522247314453  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 12.6561279296875 GB
    Memory Allocated: 0.09584522247314453  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 12.6561279296875 GB
    Memory Allocated: 0.21047735214233398  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 12.6561279296875 GB
    Memory Allocated: 0.21056175231933594  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 12.6561279296875 GB
    Memory Allocated: 0.12261247634887695  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 12.6561279296875 GB
    Memory Allocated: 0.13289833068847656  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 12.6561279296875 GB
    Memory Allocated: 0.13289833068847656  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

first layer input nodes number: 307713
first layer output nodes number: 104104
edges number: 1005500
----------------------------------------before model layer 0
 Nvidia-smi: 12.6561279296875 GB
    Memory Allocated: 0.13596725463867188  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

torch.Size([307713, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.6561279296875 GB
    Memory Allocated: 0.13596725463867188  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

m.shape torch.Size([333, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.521693229675293  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.521693229675293  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 333, 100]), torch.Size([1, 333, 100])
----------------------------------------3
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.521942138671875  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.5239291191101074  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 333, 100])
m.shape torch.Size([505, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.5241813659667969  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.5241813659667969  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 505, 100]), torch.Size([1, 505, 100])
----------------------------------------3
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.5245580673217773  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.5302057266235352  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 505, 100])
m.shape torch.Size([733, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.5308365821838379  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.5308365821838379  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 733, 100]), torch.Size([1, 733, 100])
----------------------------------------3
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.5313830375671387  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.5447211265563965  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 733, 100])
m.shape torch.Size([923, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.5458235740661621  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.5458235740661621  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 923, 100]), torch.Size([1, 923, 100])
----------------------------------------3
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.5465121269226074  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.566650390625  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 923, 100])
m.shape torch.Size([1106, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.5683951377868652  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.5683951377868652  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 1106, 100]), torch.Size([1, 1106, 100])
----------------------------------------3
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.5692200660705566  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.5992555618286133  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 1106, 100])
m.shape torch.Size([1190, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.6015033721923828  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.6015033721923828  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 1190, 100]), torch.Size([1, 1190, 100])
----------------------------------------3
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.6023902893066406  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.6408357620239258  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 1190, 100])
m.shape torch.Size([1263, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.6436862945556641  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.6436862945556641  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 1263, 100]), torch.Size([1, 1263, 100])
----------------------------------------3
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.644627571105957  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.692960262298584  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 1263, 100])
m.shape torch.Size([1251, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.6962180137634277  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.6962180137634277  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 1251, 100]), torch.Size([1, 1251, 100])
----------------------------------------3
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.697150707244873  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.7524027824401855  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 1251, 100])
m.shape torch.Size([1253, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.7561378479003906  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.7561378479003906  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 1253, 100]), torch.Size([1, 1253, 100])
----------------------------------------3
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.7570714950561523  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 0.818941593170166  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 1253, 100])
m.shape torch.Size([95547, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 1.174415111541748  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 1.174415111541748  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 95547, 100]), torch.Size([1, 95547, 100])
----------------------------------------3
 Nvidia-smi: 13.0311279296875 GB
    Memory Allocated: 1.2456040382385254  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.304210662841797  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 95547, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 5.930450439453125  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.029731750488281  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.1290130615234375  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.029731750488281  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

torch.Size([104104, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.1290130615234375  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.153833389282227  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.153833389282227  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.4163737297058105  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.4163737297058105  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.416388988494873  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.416511058807373  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.416524887084961  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.416524887084961  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.416545867919922  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.416860580444336  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([19, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.416904926300049  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.416904926300049  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.416941165924072  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.417738437652588  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([28, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.41782808303833  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.41782808303833  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.417881488800049  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.419430255889893  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.419514179229736  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.419514179229736  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.419558048248291  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.42113733291626  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([39, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.421340465545654  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.421340465545654  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.421414852142334  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.4246134757995605  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([45, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.42487907409668  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.42487907409668  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.424964904785156  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.429256439208984  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([39, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.429513454437256  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.429513454437256  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.4295878410339355  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.433827877044678  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.43411111831665  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.43411111831665  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.4341816902160645  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.4386982917785645  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([39, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.439038276672363  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.439038276672363  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.439112663269043  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.444394111633301  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([47, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.444854259490967  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.444854259490967  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.444943904876709  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.4519362449646  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([35, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.452295303344727  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.452295303344727  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.452362060546875  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.458036422729492  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.458615303039551  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.458615303039551  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.458708763122559  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.467307090759277  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.467798709869385  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.467798709869385  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.467875003814697  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.475428104400635  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([40, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.475966930389404  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.475966930389404  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.476043224334717  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.484130382537842  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.484753608703613  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.484753608703613  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.484835624694824  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.49410343170166  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.494716167449951  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.494716167449951  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.494792461395264  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.503947734832764  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([41, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.504619121551514  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.504619121551514  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.504697322845459  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.514628887176514  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.515229225158691  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.515229225158691  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.51529598236084  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.5242414474487305  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.524765968322754  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.524765968322754  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.5248212814331055  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.532620429992676  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.533380031585693  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.533380031585693  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.533454418182373  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.544463634490967  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([42, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.545314788818359  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.545314788818359  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.5453948974609375  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.557811737060547  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([47, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.55889368057251  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.55889368057251  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.558983325958252  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.573505878448486  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([46, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.574522495269775  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.574522495269775  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.574610233306885  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.589437961578369  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([10426, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.840202808380127  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.840202808380127  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

 h.shape torch.Size([1, 10426, 256]), torch.Size([1, 10426, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 6.8604817390441895  GigaBytes
Max Memory Allocated: 10.42033052444458  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6326904296875 GB
    Memory Allocated: 10.36042070388794  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 10426, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.6326904296875 GB
    Memory Allocated: 10.101078033447266  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.6326904296875 GB
    Memory Allocated: 10.103057384490967  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.6326904296875 GB
    Memory Allocated: 10.105033874511719  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.6326904296875 GB
    Memory Allocated: 10.102970123291016  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

torch.Size([11287, 47])
input nodes number: 104104
output nodes number: 11287
edges number: 272561
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.6326904296875 GB
    Memory Allocated: 10.103001594543457  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.6326904296875 GB
    Memory Allocated: 10.103002071380615  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.14859628677368164  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

pseudo mini batch 3 input nodes size: 255256
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.12178373336791992  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.12178373336791992  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.2168741226196289  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.2169628143310547  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.10224628448486328  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.11120128631591797  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.11120128631591797  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

first layer input nodes number: 255256
first layer output nodes number: 95383
edges number: 914931
----------------------------------------before model layer 0
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.11467599868774414  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

torch.Size([255256, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.11467599868774414  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

m.shape torch.Size([345, 1, 100])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.46531152725219727  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.46531152725219727  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 345, 100]), torch.Size([1, 345, 100])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.46556901931762695  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.46762752532958984  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 345, 100])
m.shape torch.Size([592, 2, 100])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.4679398536682129  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.4679398536682129  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 592, 100]), torch.Size([1, 592, 100])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.468381404876709  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.47499895095825195  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 592, 100])
m.shape torch.Size([830, 3, 100])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.4757061004638672  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.4757061004638672  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 830, 100]), torch.Size([1, 830, 100])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.47632503509521484  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.49051952362060547  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 830, 100])
m.shape torch.Size([1020, 4, 100])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.4917302131652832  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.4917302131652832  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 1020, 100]), torch.Size([1, 1020, 100])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.492490291595459  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.5145325660705566  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 1020, 100])
m.shape torch.Size([1154, 5, 100])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.5167503356933594  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.5167503356933594  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 1154, 100]), torch.Size([1, 1154, 100])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.5176105499267578  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.5485711097717285  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 1154, 100])
m.shape torch.Size([1320, 6, 100])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.5510916709899902  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.5510916709899902  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 1320, 100]), torch.Size([1, 1320, 100])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.5520758628845215  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.5943703651428223  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 1320, 100])
m.shape torch.Size([1335, 7, 100])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.5973596572875977  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.5973596572875977  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 1335, 100]), torch.Size([1, 1335, 100])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.5983543395996094  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.6484131813049316  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 1335, 100])
m.shape torch.Size([1355, 8, 100])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.651954174041748  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.651954174041748  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 1355, 100]), torch.Size([1, 1355, 100])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.6529641151428223  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.7105193138122559  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 1355, 100])
m.shape torch.Size([1363, 9, 100])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.7145843505859375  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.7145843505859375  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 1363, 100]), torch.Size([1, 1363, 100])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.7156000137329102  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 0.7806024551391602  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 1363, 100])
m.shape torch.Size([86069, 10, 100])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 1.1007270812988281  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 1.1007270812988281  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 86069, 100]), torch.Size([1, 86069, 100])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 1.1648540496826172  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.717840194702148  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 86069, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.378685474395752  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.469649791717529  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.560614109039307  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.469649791717529  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

torch.Size([95383, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.560614109039307  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.58335542678833  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.58335542678833  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.859903812408447  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.859903812408447  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.859920978546143  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.860058307647705  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([17, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.860082626342773  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.860082626342773  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.860115051269531  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.860601425170898  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([24, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.860654830932617  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.860654830932617  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.860700607299805  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.86170768737793  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([26, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.861784934997559  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.861784934997559  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.861834526062012  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.863272666931152  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.863387584686279  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.863387584686279  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.863442897796631  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.865434169769287  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([33, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.865597248077393  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.865597248077393  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.865660190582275  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.868366718292236  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([27, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.86851692199707  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.86851692199707  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.868568420410156  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.871143341064453  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.8713483810424805  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.8713483810424805  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.871405601501465  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.874667167663574  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([42, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.875001907348633  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.875001907348633  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.875082015991211  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.880208969116211  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([43, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.880582332611084  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.880582332611084  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.880664348602295  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.8864874839782715  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([47, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.886943817138672  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.886943817138672  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.887033462524414  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.894025802612305  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([35, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.894384860992432  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.894384860992432  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.89445161819458  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.900125980377197  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.900730133056641  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.900730133056641  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.900827407836914  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.90977668762207  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.910400867462158  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.910400867462158  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.910496234893799  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.919937610626221  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.920437812805176  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.920437812805176  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.920510292053223  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.928193092346191  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.928741455078125  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.928741455078125  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.928813934326172  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.937004089355469  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([45, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.9377031326293945  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.9377031326293945  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.937788963317871  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.948088645935059  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.948738098144531  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.948738098144531  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.948814392089844  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.958503723144531  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([51, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.959397315979004  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.959397315979004  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.959494590759277  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.972529411315918  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.97334623336792  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.97334623336792  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.9734320640563965  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.985534191131592  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.986278533935547  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.986278533935547  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.986352920532227  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.99736213684082  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([50, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.998388290405273  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.998388290405273  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 5.998483657836914  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 6.013265609741211  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([50, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 6.014625549316406  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 6.014625549316406  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 6.014720916748047  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 6.030170440673828  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 6.030884265899658  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 6.030884265899658  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 16.8944091796875 GB
    Memory Allocated: 6.030947208404541  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 6.041584491729736  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([10976, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 6.305290222167969  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 6.305290222167969  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 10976, 256]), torch.Size([1, 10976, 256])
----------------------------------------3
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 6.326225280761719  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 10.010795593261719  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 10976, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 9.737805366516113  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 9.739883422851562  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 9.741961479187012  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 9.739794731140137  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

torch.Size([11868, 47])
input nodes number: 95383
output nodes number: 11868
edges number: 286892
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 9.740693092346191  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.8983154296875 GB
    Memory Allocated: 9.74069356918335  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.1285858154296875  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

pseudo mini batch 4 input nodes size: 336734
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.10234498977661133  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.10234498977661133  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.22778844833374023  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.22787237167358398  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.13269329071044922  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.14264965057373047  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.14264965057373047  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

first layer input nodes number: 336734
first layer output nodes number: 108197
edges number: 1064024
----------------------------------------before model layer 0
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.14623308181762695  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

torch.Size([336734, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.9022216796875 GB
    Memory Allocated: 0.14623308181762695  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

m.shape torch.Size([178, 1, 100])
----------------------------------------1
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5539431571960449  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5539431571960449  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 178, 100]), torch.Size([1, 178, 100])
----------------------------------------3
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5540766716003418  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.555140495300293  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 178, 100])
m.shape torch.Size([256, 2, 100])
----------------------------------------1
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5552644729614258  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5552644729614258  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 256, 100]), torch.Size([1, 256, 100])
----------------------------------------3
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.555455207824707  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5583162307739258  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 256, 100])
m.shape torch.Size([344, 3, 100])
----------------------------------------1
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5586056709289551  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5586056709289551  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 344, 100]), torch.Size([1, 344, 100])
----------------------------------------3
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5588622093200684  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5645017623901367  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 344, 100])
m.shape torch.Size([396, 4, 100])
----------------------------------------1
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5649638175964355  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5649638175964355  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 396, 100]), torch.Size([1, 396, 100])
----------------------------------------3
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5652594566345215  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5738215446472168  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 396, 100])
m.shape torch.Size([567, 5, 100])
----------------------------------------1
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5747299194335938  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5747299194335938  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 567, 100]), torch.Size([1, 567, 100])
----------------------------------------3
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5751523971557617  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5903615951538086  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 567, 100])
m.shape torch.Size([620, 6, 100])
----------------------------------------1
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5915365219116211  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5915365219116211  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 620, 100]), torch.Size([1, 620, 100])
----------------------------------------3
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.5919990539550781  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.6118707656860352  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 620, 100])
m.shape torch.Size([692, 7, 100])
----------------------------------------1
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.6134443283081055  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.6134443283081055  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 692, 100]), torch.Size([1, 692, 100])
----------------------------------------3
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.6139602661132812  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.6410689353942871  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 692, 100])
m.shape torch.Size([696, 8, 100])
----------------------------------------1
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.6428852081298828  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.6428852081298828  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 696, 100]), torch.Size([1, 696, 100])
----------------------------------------3
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.6434040069580078  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.6735849380493164  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 696, 100])
m.shape torch.Size([729, 9, 100])
----------------------------------------1
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.6757698059082031  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.6757698059082031  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 729, 100]), torch.Size([1, 729, 100])
----------------------------------------3
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.6763134002685547  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3006591796875 GB
    Memory Allocated: 0.7135729789733887  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 729, 100])
m.shape torch.Size([103719, 10, 100])
----------------------------------------1
 Nvidia-smi: 17.6873779296875 GB
    Memory Allocated: 1.100019931793213  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.6873779296875 GB
    Memory Allocated: 1.100019931793213  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 103719, 100]), torch.Size([1, 103719, 100])
----------------------------------------3
 Nvidia-smi: 17.6873779296875 GB
    Memory Allocated: 1.1772971153259277  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.6639485359191895  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 103719, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.268527030944824  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.371786117553711  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.474970817565918  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.371711730957031  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

torch.Size([108197, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.474970817565918  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.500767230987549  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.500767230987549  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

m.shape torch.Size([22, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.764101505279541  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.764101505279541  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.764143466949463  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.764479160308838  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([19, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.764494895935059  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.764494895935059  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.764531135559082  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.765074729919434  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.765120506286621  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.765120506286621  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.765162467956543  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.766085624694824  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.766153335571289  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.766153335571289  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.766197204589844  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.76746940612793  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.767577648162842  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.767577648162842  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.767629146575928  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.7694830894470215  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([39, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.76968240737915  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.76968240737915  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.76975679397583  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.772955417633057  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.773167610168457  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.773167610168457  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.773238182067871  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.776766777038574  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([35, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.777000904083252  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.777000904083252  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.7770676612854  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.780872821807861  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.7811079025268555  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.7811079025268555  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.781167030334473  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.784951210021973  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([37, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.785277366638184  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.785277366638184  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.785347938537598  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.790358543395996  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([27, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.790608882904053  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.790608882904053  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.790660381317139  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.794677257537842  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([28, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.7949748039245605  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.7949748039245605  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.795028209686279  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.799567699432373  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.7999162673950195  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.7999162673950195  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.799973487854004  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.805237770080566  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.805599689483643  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.805599689483643  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.805655002593994  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.811131000518799  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.811564922332764  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.811564922332764  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.811625957489014  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.818095684051514  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.818495750427246  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.818495750427246  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.818549156188965  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.824584007263184  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.825096607208252  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.825096607208252  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.825159549713135  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.832712650299072  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.833200454711914  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.833200454711914  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.833257675170898  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.840524673461914  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.841080665588379  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.841080665588379  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.841141700744629  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.849320411682129  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.849636077880859  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.849636077880859  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.84967041015625  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.854511260986328  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.8550190925598145  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.8550190925598145  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.855068683624268  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.86240816116333  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.863039016723633  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.863039016723633  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.86309814453125  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.872262954711914  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.872697830200195  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.872697830200195  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.872737884521484  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.8792266845703125  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.879875659942627  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.879875659942627  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.8799309730529785  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 6.889278888702393  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([10539, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 7.142897605895996  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 7.142897605895996  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

 h.shape torch.Size([1, 10539, 256]), torch.Size([1, 10539, 256])
----------------------------------------3
 Nvidia-smi: 20.1053466796875 GB
    Memory Allocated: 7.162999153137207  GigaBytes
Max Memory Allocated: 10.608995914459229  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.3572998046875 GB
    Memory Allocated: 10.739872932434082  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 10539, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.3572998046875 GB
    Memory Allocated: 10.480817317962646  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.3572998046875 GB
    Memory Allocated: 10.483194351196289  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.3572998046875 GB
    Memory Allocated: 10.485571384429932  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.3572998046875 GB
    Memory Allocated: 10.483110427856445  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

torch.Size([11225, 47])
input nodes number: 108197
output nodes number: 11225
edges number: 272083
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.3572998046875 GB
    Memory Allocated: 10.484299659729004  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.3572998046875 GB
    Memory Allocated: 10.484300136566162  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.16298532485961914  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

pseudo mini batch 5 input nodes size: 172775
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.13299226760864258  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.13299226760864258  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.1973562240600586  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.19744396209716797  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.07191658020019531  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.07958793640136719  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.07958793640136719  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

first layer input nodes number: 172775
first layer output nodes number: 77925
edges number: 751848
----------------------------------------before model layer 0
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.08145618438720703  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

torch.Size([172775, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.08145618438720703  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

m.shape torch.Size([188, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.3700594902038574  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.3700594902038574  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 188, 100]), torch.Size([1, 188, 100])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.37019968032836914  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.3713212013244629  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 188, 100])
m.shape torch.Size([394, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.37154483795166016  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.37154483795166016  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 394, 100]), torch.Size([1, 394, 100])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.3718385696411133  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.37624454498291016  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 394, 100])
m.shape torch.Size([483, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.37663793563842773  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.37663793563842773  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 483, 100]), torch.Size([1, 483, 100])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.3769984245300293  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.384920597076416  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 483, 100])
m.shape torch.Size([696, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.38577747344970703  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.38577747344970703  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 696, 100]), torch.Size([1, 696, 100])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.38629627227783203  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.4021272659301758  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 696, 100])
m.shape torch.Size([846, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.4034438133239746  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.4034438133239746  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 846, 100]), torch.Size([1, 846, 100])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.40407419204711914  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.42758798599243164  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 846, 100])
m.shape torch.Size([1028, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.42957067489624023  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.42957067489624023  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 1028, 100]), torch.Size([1, 1028, 100])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.43033742904663086  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.46328210830688477  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 1028, 100])
m.shape torch.Size([1061, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.4656658172607422  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.4656658172607422  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 1061, 100]), torch.Size([1, 1061, 100])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.46645641326904297  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.5072870254516602  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 1061, 100])
m.shape torch.Size([1154, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.5103311538696289  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.5103311538696289  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 1154, 100]), torch.Size([1, 1154, 100])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.5111913681030273  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.5603079795837402  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 1154, 100])
m.shape torch.Size([1168, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.5647168159484863  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.5647168159484863  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 1168, 100]), torch.Size([1, 1168, 100])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.5655875205993652  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.6212868690490723  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 1168, 100])
m.shape torch.Size([70907, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.8850007057189941  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.8850007057189941  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 70907, 100]), torch.Size([1, 70907, 100])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.9378314018249512  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.688767910003662  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 70907, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.409834861755371  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.484149932861328  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.558465003967285  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.484149932861328  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

torch.Size([77925, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.558465003967285  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.577996253967285  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.577996253967285  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

m.shape torch.Size([15, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.845373630523682  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.845373630523682  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.845402240753174  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.845631122589111  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([31, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.845676422119141  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.845676422119141  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.845735549926758  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.846622467041016  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([41, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.846711158752441  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.846711158752441  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.846789360046387  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.848509788513184  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([62, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.8487091064453125  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.8487091064453125  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.848827362060547  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.852256774902344  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([59, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.852481365203857  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.852481365203857  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.852593898773193  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.856645107269287  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([66, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.856969833374023  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.856969833374023  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.857095718383789  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.862508773803711  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([64, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.8628764152526855  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.8628764152526855  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.8629984855651855  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.8691020011901855  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([76, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.869625568389893  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.869625568389893  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.869770526885986  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.87803316116333  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([57, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.878454208374023  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.878454208374023  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.878562927246094  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.885520935058594  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([58, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.886024475097656  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.886024475097656  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.886135101318359  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.893989562988281  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.894568920135498  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.894568920135498  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.894683361053467  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.903609752655029  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.904163837432861  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.904163837432861  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.9042649269104  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.912857532501221  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([71, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.913694381713867  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.913694381713867  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.913829803466797  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.926288604736328  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([64, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.927082061767578  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.927082061767578  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.927204132080078  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.939289093017578  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([64, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.940150737762451  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.940150737762451  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.940272808074951  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.953212261199951  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([64, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.954135417938232  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.954135417938232  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.954257488250732  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.968051433563232  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([71, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.96927547454834  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.96927547454834  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.9694108963012695  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.985661506652832  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([58, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.986877918243408  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.986877918243408  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 4.986988544464111  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 5.001038074493408  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([68, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 5.0022687911987305  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 5.0022687911987305  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 5.002398490905762  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 5.019778251647949  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([54, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 5.020997524261475  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 5.020997524261475  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 5.0211005210876465  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 5.035623073577881  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([60, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 5.036980152130127  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 5.036980152130127  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 5.037094593048096  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6287841796875 GB
    Memory Allocated: 5.054031848907471  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([53, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.6287841796875 GB
    Memory Allocated: 5.05538272857666  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6287841796875 GB
    Memory Allocated: 5.05538272857666  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 20.6287841796875 GB
    Memory Allocated: 5.055483818054199  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6444091796875 GB
    Memory Allocated: 5.071152687072754  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([57, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.6444091796875 GB
    Memory Allocated: 5.072511196136475  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6444091796875 GB
    Memory Allocated: 5.072511196136475  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 20.6444091796875 GB
    Memory Allocated: 5.072619915008545  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6619873046875 GB
    Memory Allocated: 5.0902323722839355  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([63, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.6619873046875 GB
    Memory Allocated: 5.0916314125061035  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6619873046875 GB
    Memory Allocated: 5.0916314125061035  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 20.6619873046875 GB
    Memory Allocated: 5.091751575469971  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6834716796875 GB
    Memory Allocated: 5.112059116363525  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([10375, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.361898899078369  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.361898899078369  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 10375, 256]), torch.Size([1, 10375, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.381687641143799  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 8.864506244659424  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 10375, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 8.60082483291626  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 8.603465557098389  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 8.605525493621826  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 8.602797031402588  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

torch.Size([11764, 47])
input nodes number: 77925
output nodes number: 11764
edges number: 277634
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 8.603729248046875  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 8.603729724884033  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.09381914138793945  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

pseudo mini batch 6 input nodes size: 246019
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.07218027114868164  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.07218027114868164  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.16382980346679688  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.16391849517822266  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.09946680068969727  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.10806608200073242  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.10806608200073242  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

first layer input nodes number: 246019
first layer output nodes number: 87923
edges number: 861761
----------------------------------------before model layer 0
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.11055469512939453  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

torch.Size([246019, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.11055469512939453  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

m.shape torch.Size([135, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4406857490539551  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4406857490539551  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 135, 100]), torch.Size([1, 135, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.44078683853149414  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4415926933288574  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 135, 100])
m.shape torch.Size([290, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4417586326599121  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4417586326599121  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 290, 100]), torch.Size([1, 290, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.44197511672973633  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4452195167541504  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 290, 100])
m.shape torch.Size([328, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4454779624938965  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4454779624938965  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 328, 100]), torch.Size([1, 328, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4457230567932129  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.45110225677490234  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 328, 100])
m.shape torch.Size([488, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4517068862915039  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4517068862915039  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 488, 100]), torch.Size([1, 488, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4520711898803711  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4626188278198242  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 488, 100])
m.shape torch.Size([531, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.46372270584106445  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.46372270584106445  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 531, 100]), torch.Size([1, 531, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.46411848068237305  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4783663749694824  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 531, 100])
m.shape torch.Size([549, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.47939586639404297  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.47939586639404297  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 549, 100]), torch.Size([1, 549, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.47980499267578125  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.49739742279052734  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 549, 100])
m.shape torch.Size([609, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4987812042236328  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4987812042236328  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 609, 100]), torch.Size([1, 609, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4992351531982422  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5219326019287109  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 609, 100])
m.shape torch.Size([677, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5241875648498535  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5241875648498535  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 677, 100]), torch.Size([1, 677, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5246920585632324  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5546879768371582  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 677, 100])
m.shape torch.Size([678, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5567092895507812  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5567092895507812  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 678, 100]), torch.Size([1, 678, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5572147369384766  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5905089378356934  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 678, 100])
m.shape torch.Size([83638, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.901832103729248  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.901832103729248  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 83638, 100]), torch.Size([1, 83638, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.9641480445861816  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.3885369300842285  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 83638, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.0674543380737305  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.151304244995117  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.235154151916504  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.151304244995117  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

torch.Size([87923, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.235154151916504  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.25611686706543  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.25611686706543  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.537735939025879  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.537735939025879  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.537741661071777  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.537787437438965  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.537802219390869  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.537802219390869  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.5378193855285645  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.538076877593994  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.538088798522949  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.538088798522949  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.538102149963379  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.538395881652832  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([27, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.5384931564331055  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.5384931564331055  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.538544654846191  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.540038108825684  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.540055751800537  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.540055751800537  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.540072917938232  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.540690898895264  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([17, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.540780544281006  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.540780544281006  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.540812969207764  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.54220724105835  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([9, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.5422515869140625  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.5422515869140625  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.542268753051758  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.543127059936523  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([18, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.543257236480713  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.543257236480713  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.5432915687561035  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.545248508453369  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([30, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.5454912185668945  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.5454912185668945  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.545548439025879  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.549210548400879  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([13, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.549307346343994  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.549307346343994  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.549332141876221  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.551092624664307  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.551239013671875  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.551239013671875  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.551267623901367  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.553499221801758  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.553612232208252  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.553612232208252  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.553633213043213  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.555416584014893  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.555543899536133  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.555543899536133  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.555564880371094  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.5574951171875  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([16, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.557700157165527  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.557700157165527  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.557730674743652  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.560751914978027  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([21, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.561039447784424  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.561039447784424  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.561079502105713  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.5653252601623535  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.565536022186279  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.565536022186279  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.5655646324157715  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.568797588348389  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.56901216506958  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.56901216506958  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.5690388679504395  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.5722432136535645  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.5725932121276855  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.5725932121276855  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.572633266448975  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.5777201652526855  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.578029155731201  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.578029155731201  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.578063488006592  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.5826640129089355  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.583166122436523  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.583166122436523  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.583217620849609  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.590478897094727  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.590816497802734  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.590816497802734  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.590850830078125  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.5959320068359375  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.596401214599609  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.596401214599609  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.596445083618164  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.603244781494141  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.603466033935547  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.603466033935547  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.603487014770508  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.60688591003418  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.607452392578125  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.607452392578125  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.607500076293945  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.615558624267578  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([11477, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.891305923461914  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.891305923461914  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 11477, 256]), torch.Size([1, 11477, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.914743423461914  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 9.798994064331055  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 11477, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 9.5192289352417  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 9.521853923797607  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 9.523931503295898  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 9.521217823028564  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

torch.Size([11865, 47])
input nodes number: 87923
output nodes number: 11865
edges number: 292283
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 9.52194595336914  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 9.521946430206299  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.12298393249511719  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

pseudo mini batch 7 input nodes size: 266618
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.09945106506347656  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.09945106506347656  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.1987743377685547  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.19886350631713867  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.10712528228759766  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.11621904373168945  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.11621904373168945  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

first layer input nodes number: 266618
first layer output nodes number: 92825
edges number: 907284
----------------------------------------before model layer 0
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.1188974380493164  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

torch.Size([266618, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.1188974380493164  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

m.shape torch.Size([195, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.46649646759033203  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.46649646759033203  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 195, 100]), torch.Size([1, 195, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4666423797607422  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4678068161010742  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 195, 100])
m.shape torch.Size([246, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.46791744232177734  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.46791744232177734  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 246, 100]), torch.Size([1, 246, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.46810150146484375  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4708538055419922  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 246, 100])
m.shape torch.Size([400, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4712090492248535  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4712090492248535  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 400, 100]), torch.Size([1, 400, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.47150754928588867  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.47806596755981445  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 400, 100])
m.shape torch.Size([526, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4787006378173828  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4787006378173828  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 526, 100]), torch.Size([1, 526, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4790925979614258  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4904594421386719  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 526, 100])
m.shape torch.Size([664, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4915003776550293  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.4915003776550293  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 664, 100]), torch.Size([1, 664, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.49199533462524414  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5113134384155273  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 664, 100])
m.shape torch.Size([768, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5127825736999512  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5127825736999512  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 768, 100]), torch.Size([1, 768, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5133547782897949  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5387115478515625  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 768, 100])
m.shape torch.Size([843, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5406241416931152  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5406241416931152  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 843, 100]), torch.Size([1, 843, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.541252613067627  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5734872817993164  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 843, 100])
m.shape torch.Size([793, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5755367279052734  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5755367279052734  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 793, 100]), torch.Size([1, 793, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5761280059814453  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.6098194122314453  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 793, 100])
m.shape torch.Size([780, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.6121392250061035  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.6121392250061035  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 780, 100]), torch.Size([1, 780, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.6127209663391113  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.650996208190918  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 780, 100])
m.shape torch.Size([87610, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.9770784378051758  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.9770784378051758  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 87610, 100]), torch.Size([1, 87610, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 1.042353630065918  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.676863670349121  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 87610, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.339653015136719  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.428177833557129  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.516702651977539  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.428177833557129  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

torch.Size([92825, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.516702651977539  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.538834095001221  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.538834095001221  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.820574760437012  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.820574760437012  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.820591926574707  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.8207292556762695  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.820730686187744  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.820730686187744  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.820740222930908  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.820883274078369  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.8209075927734375  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.8209075927734375  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.820926666259766  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.821346282958984  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([16, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.8213982582092285  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.8213982582092285  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.8214287757873535  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.8223137855529785  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.822375774383545  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.822375774383545  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.82240629196167  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.82350492477417  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.823570728302002  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.823570728302002  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.823597431182861  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.8247456550598145  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([21, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.824873924255371  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.824873924255371  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.82491397857666  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.826916694641113  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([17, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.827027797698975  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.827027797698975  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.827060222625732  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.828908443450928  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([26, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.829117298126221  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.829117298126221  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.829166889190674  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.832340717315674  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([14, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.832450866699219  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.832450866699219  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.832477569580078  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.834373474121094  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([21, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.834582328796387  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.834582328796387  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.834622383117676  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.837746620178223  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([21, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.837968826293945  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.837968826293945  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.838008880615234  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.841413497924805  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.841581344604492  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.841581344604492  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.841609954833984  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.844242095947266  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([22, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.844523906707764  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.844523906707764  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.8445658683776855  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.848720073699951  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.849189281463623  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.849189281463623  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.849254131317139  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.856128215789795  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([16, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.85634183883667  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.85634183883667  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.856372356414795  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.85982084274292  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.860230445861816  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.860230445861816  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.8602800369262695  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.8662309646606445  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.866552352905273  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.866552352905273  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.86659049987793  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.871435165405273  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.871836185455322  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.871836185455322  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.871880054473877  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.877758502960205  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.878025054931641  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.878025054931641  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.878053665161133  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.882087707519531  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.882457256317139  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.882457256317139  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.882493495941162  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.887856960296631  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.8883466720581055  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.8883466720581055  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.888392448425293  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.8954877853393555  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.896039962768555  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.896039962768555  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.896089553833008  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.904123306274414  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.904652118682861  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.904652118682861  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.904697895050049  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.912434101104736  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([11452, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.187966823577881  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.187966823577881  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 11452, 256]), torch.Size([1, 11452, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.211404323577881  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 10.090264797210693  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 11452, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 9.811379432678223  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 9.813482761383057  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 9.816001415252686  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 9.813808917999268  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

torch.Size([11906, 47])
input nodes number: 92825
output nodes number: 11906
edges number: 292626
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 9.81406831741333  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 9.814068794250488  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.13126325607299805  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

pseudo mini batch 8 input nodes size: 346340
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.10660362243652344  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.10660362243652344  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.2356257438659668  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.23570966720581055  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.13629722595214844  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.14594697952270508  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.14594697952270508  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

first layer input nodes number: 346340
first layer output nodes number: 100095
edges number: 990357
----------------------------------------before model layer 0
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.14927339553833008  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

torch.Size([346340, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.14927339553833008  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

m.shape torch.Size([82, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5292620658874512  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5292620658874512  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 82, 100]), torch.Size([1, 82, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5293240547180176  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.529815673828125  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 82, 100])
m.shape torch.Size([136, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5298862457275391  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5298862457275391  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 136, 100]), torch.Size([1, 136, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5299882888793945  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5315103530883789  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 136, 100])
m.shape torch.Size([224, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5317096710205078  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5317096710205078  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 224, 100]), torch.Size([1, 224, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5318765640258789  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.535548210144043  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 224, 100])
m.shape torch.Size([232, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5358104705810547  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5358104705810547  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 232, 100]), torch.Size([1, 232, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5359840393066406  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5410003662109375  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 232, 100])
m.shape torch.Size([296, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5414652824401855  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5414652824401855  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 296, 100]), torch.Size([1, 296, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5416865348815918  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5496301651000977  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 296, 100])
m.shape torch.Size([338, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5502753257751465  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5502753257751465  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 338, 100]), torch.Size([1, 338, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5505280494689941  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5613694190979004  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 338, 100])
m.shape torch.Size([448, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5624113082885742  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5624113082885742  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 448, 100]), torch.Size([1, 448, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5627450942993164  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5794343948364258  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 448, 100])
m.shape torch.Size([521, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5808205604553223  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5808205604553223  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 521, 100]), torch.Size([1, 521, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.581209659576416  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.6033539772033691  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 521, 100])
m.shape torch.Size([589, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.6051344871520996  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.6051344871520996  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 589, 100]), torch.Size([1, 589, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.6055741310119629  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.6336727142333984  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 589, 100])
m.shape torch.Size([97229, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.995659351348877  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.995659351348877  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 97229, 100]), torch.Size([1, 97229, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 1.068101406097412  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.21144437789917  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 97229, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.841699600219727  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.93715763092041  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.032615661621094  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.93715763092041  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

torch.Size([100095, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.032615661621094  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.056480407714844  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.056480407714844  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.3224592208862305  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.3224592208862305  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.322464942932129  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.322510719299316  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.322515964508057  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.322515964508057  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.322523593902588  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.322638034820557  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([23, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.3227009773254395  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.3227009773254395  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.322744846343994  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.323709964752197  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.3237152099609375  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.3237152099609375  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.323728561401367  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.324115753173828  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.324133396148682  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.324133396148682  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.324142932891846  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.324486255645752  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.324527740478516  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.324527740478516  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.324542999267578  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.325199127197266  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([19, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.325319766998291  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.325319766998291  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.3253560066223145  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.327167987823486  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([8, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.327211380004883  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.327211380004883  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.327226638793945  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.328096389770508  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([25, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.328305244445801  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.328305244445801  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.328352928161621  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.331404685974121  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.331573486328125  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.331573486328125  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.331611633300781  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.334320068359375  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.334428310394287  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.334428310394287  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.334451198577881  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.336236476898193  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([38, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.336663722991943  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.336663722991943  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.33673620223999  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.342896938323975  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([27, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.343198299407959  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.343198299407959  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.343249797821045  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.347987651824951  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([16, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.348177433013916  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.348177433013916  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.348207950592041  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.351229190826416  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([39, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.351776599884033  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.351776599884033  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.351850986480713  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.35973596572876  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.360052585601807  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.360052585601807  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.360096454620361  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.365053653717041  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.365309715270996  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.365309715270996  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.365342140197754  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.369233131408691  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.369874477386475  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.369874477386475  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.3699469566345215  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.379151821136475  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.37973690032959  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.37973690032959  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.3798017501831055  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.388491630554199  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.3891706466674805  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.3891706466674805  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.3892412185668945  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.399191856384277  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([50, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.400166034698486  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.400166034698486  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.400261402130127  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.4143757820129395  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([37, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.4151105880737305  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.4151105880737305  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.4151811599731445  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.426119804382324  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.426747798919678  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.426747798919678  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.426805019378662  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.436074733734131  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([46, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.437107563018799  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.437107563018799  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.437195301055908  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.452023029327393  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([10659, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.708095073699951  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.708095073699951  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 10659, 256]), torch.Size([1, 10659, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.7284255027771  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 10.324050426483154  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 10659, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 10.061704158782959  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 10.063679218292236  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 10.06564474105835  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 10.063585758209229  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

torch.Size([11225, 47])
input nodes number: 100095
output nodes number: 11225
edges number: 275411
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 10.064287185668945  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 10.064287662506104  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.16421985626220703  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

pseudo mini batch 9 input nodes size: 352089
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.1361689567565918  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.1361689567565918  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.2673325538635254  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.26741695404052734  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.13831090927124023  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.14773225784301758  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.14773225784301758  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

first layer input nodes number: 352089
first layer output nodes number: 94843
edges number: 931816
----------------------------------------before model layer 0
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.1510624885559082  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

torch.Size([352089, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.1510624885559082  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

m.shape torch.Size([177, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5085606575012207  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5085606575012207  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 177, 100]), torch.Size([1, 177, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5086932182312012  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5097508430480957  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 177, 100])
m.shape torch.Size([217, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5098466873168945  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5098466873168945  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 217, 100]), torch.Size([1, 217, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5100088119506836  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5124378204345703  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 217, 100])
m.shape torch.Size([368, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5127682685852051  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5127682685852051  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 368, 100]), torch.Size([1, 368, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5130429267883301  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5190768241882324  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 368, 100])
m.shape torch.Size([410, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5195508003234863  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5195508003234863  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 410, 100]), torch.Size([1, 410, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5198569297790527  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5287232398986816  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 410, 100])
m.shape torch.Size([448, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5294046401977539  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5294046401977539  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 448, 100]), torch.Size([1, 448, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5297384262084961  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5417547225952148  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 448, 100])
m.shape torch.Size([557, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5428924560546875  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5428924560546875  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 557, 100]), torch.Size([1, 557, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5433082580566406  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.561161994934082  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 557, 100])
m.shape torch.Size([608, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5625395774841309  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5625395774841309  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 608, 100]), torch.Size([1, 608, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5629925727844238  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5856423377990723  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 608, 100])
m.shape torch.Size([642, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5873293876647949  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5873293876647949  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 642, 100]), torch.Size([1, 642, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.5878081321716309  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.6150851249694824  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 642, 100])
m.shape torch.Size([673, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.6171026229858398  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.6171026229858398  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 673, 100]), torch.Size([1, 673, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.6176042556762695  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.650179386138916  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 673, 100])
m.shape torch.Size([90743, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.9879727363586426  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 0.9879727363586426  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 90743, 100]), torch.Size([1, 90743, 100])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 1.0555815696716309  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.855808734893799  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 90743, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.507905960083008  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.598355293273926  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.688804626464844  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.598355293273926  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

torch.Size([94843, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.688804626464844  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.711417198181152  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.711417198181152  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

m.shape torch.Size([28, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.9586029052734375  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.9586029052734375  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.958656311035156  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.959083557128906  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.959105014801025  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.959105014801025  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.959152698516846  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.95986795425415  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([69, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.960043430328369  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.960043430328369  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.960175037384033  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.963070392608643  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([80, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.963312149047852  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.963312149047852  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.963464736938477  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.967889785766602  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([68, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.968140602111816  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.968140602111816  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.968270301818848  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.972939491271973  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([111, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.973515033721924  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.973515033721924  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.973726749420166  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.98283052444458  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([128, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.983585834503174  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.983585834503174  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.983829975128174  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.996037006378174  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([73, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.996476650238037  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.996476650238037  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 5.996615886688232  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.004552364349365  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([123, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.00577974319458  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.00577974319458  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.006014347076416  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.021028995513916  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([139, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.022274017333984  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.022274017333984  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.022539138793945  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.041362762451172  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([106, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.042591094970703  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.042591094970703  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.042793273925781  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.058563232421875  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([104, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.059823513031006  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.059823513031006  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.060021877288818  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.076882839202881  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([73, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.077695846557617  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.077695846557617  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.0778350830078125  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.090644836425781  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([111, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.092069149017334  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.092069149017334  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.092280864715576  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.113240718841553  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([161, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.1154561042785645  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.1154561042785645  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 161, 256]), torch.Size([1, 161, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.115763187408447  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.148313999176025  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 161, 256])
m.shape torch.Size([86, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.14952278137207  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.14952278137207  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 20.6873779296875 GB
    Memory Allocated: 6.149686813354492  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6893310546875 GB
    Memory Allocated: 6.168222427368164  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.6893310546875 GB
    Memory Allocated: 6.169299602508545  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6893310546875 GB
    Memory Allocated: 6.169299602508545  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 20.6893310546875 GB
    Memory Allocated: 6.1694159507751465  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7010498046875 GB
    Memory Allocated: 6.183377742767334  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([65, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.7010498046875 GB
    Memory Allocated: 6.184535980224609  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7010498046875 GB
    Memory Allocated: 6.184535980224609  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 20.7010498046875 GB
    Memory Allocated: 6.184659957885742  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7166748046875 GB
    Memory Allocated: 6.200405120849609  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([70, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.7166748046875 GB
    Memory Allocated: 6.201704978942871  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7166748046875 GB
    Memory Allocated: 6.201704978942871  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 20.7186279296875 GB
    Memory Allocated: 6.201838493347168  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7362060546875 GB
    Memory Allocated: 6.219729423522949  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([75, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.7362060546875 GB
    Memory Allocated: 6.221104621887207  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7362060546875 GB
    Memory Allocated: 6.221104621887207  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 20.7362060546875 GB
    Memory Allocated: 6.221247673034668  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7557373046875 GB
    Memory Allocated: 6.24141788482666  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([61, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.7557373046875 GB
    Memory Allocated: 6.242708206176758  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7557373046875 GB
    Memory Allocated: 6.242708206176758  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 20.7557373046875 GB
    Memory Allocated: 6.242824554443359  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7733154296875 GB
    Memory Allocated: 6.260044097900391  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([44, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.7752685546875 GB
    Memory Allocated: 6.260916709899902  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7752685546875 GB
    Memory Allocated: 6.260916709899902  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 20.7752685546875 GB
    Memory Allocated: 6.261000633239746  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7889404296875 GB
    Memory Allocated: 6.274008750915527  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([90, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.7889404296875 GB
    Memory Allocated: 6.27600622177124  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7889404296875 GB
    Memory Allocated: 6.27600622177124  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 20.7889404296875 GB
    Memory Allocated: 6.276177883148193  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.8162841796875 GB
    Memory Allocated: 6.3039870262146  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([80, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.8162841796875 GB
    Memory Allocated: 6.305746555328369  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.8162841796875 GB
    Memory Allocated: 6.305746555328369  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 20.8162841796875 GB
    Memory Allocated: 6.305899143218994  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.8416748046875 GB
    Memory Allocated: 6.331686496734619  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([9245, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.8455810546875 GB
    Memory Allocated: 6.553750514984131  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.8455810546875 GB
    Memory Allocated: 6.553750514984131  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 9245, 256]), torch.Size([1, 9245, 256])
----------------------------------------3
 Nvidia-smi: 20.8455810546875 GB
    Memory Allocated: 6.572179317474365  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.8455810546875 GB
    Memory Allocated: 9.67566442489624  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 9245, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.8455810546875 GB
    Memory Allocated: 9.432567119598389  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.8455810546875 GB
    Memory Allocated: 9.435469150543213  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.8455810546875 GB
    Memory Allocated: 9.438371181488037  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.8455810546875 GB
    Memory Allocated: 9.435384750366211  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

torch.Size([11276, 47])
input nodes number: 94843
output nodes number: 11276
edges number: 256697
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8455810546875 GB
    Memory Allocated: 9.437102794647217  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8455810546875 GB
    Memory Allocated: 9.437103271484375  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8475341796875 GB
    Memory Allocated: 0.16429853439331055  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

pseudo mini batch 10 input nodes size: 429661
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8475341796875 GB
    Memory Allocated: 0.1392378807067871  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8475341796875 GB
    Memory Allocated: 0.1392378807067871  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8475341796875 GB
    Memory Allocated: 0.2992992401123047  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8475341796875 GB
    Memory Allocated: 0.29938364028930664  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8475341796875 GB
    Memory Allocated: 0.1681356430053711  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8475341796875 GB
    Memory Allocated: 0.17891883850097656  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8475341796875 GB
    Memory Allocated: 0.17891883850097656  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

first layer input nodes number: 429661
first layer output nodes number: 120081
edges number: 1180573
----------------------------------------before model layer 0
 Nvidia-smi: 20.8475341796875 GB
    Memory Allocated: 0.1830153465270996  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

torch.Size([429661, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.8475341796875 GB
    Memory Allocated: 0.1830153465270996  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

m.shape torch.Size([145, 1, 100])
----------------------------------------1
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.635251522064209  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.635251522064209  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 145, 100]), torch.Size([1, 145, 100])
----------------------------------------3
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.6353602409362793  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.6362271308898926  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 145, 100])
m.shape torch.Size([270, 2, 100])
----------------------------------------1
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.6363739967346191  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.6363739967346191  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 270, 100]), torch.Size([1, 270, 100])
----------------------------------------3
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.6365752220153809  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.6395936012268066  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 270, 100])
m.shape torch.Size([437, 3, 100])
----------------------------------------1
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.639981746673584  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.639981746673584  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 437, 100]), torch.Size([1, 437, 100])
----------------------------------------3
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.6403079032897949  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.6474747657775879  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 437, 100])
m.shape torch.Size([516, 4, 100])
----------------------------------------1
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.6480808258056641  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.6480808258056641  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 516, 100]), torch.Size([1, 516, 100])
----------------------------------------3
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.6484661102294922  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.6596221923828125  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 516, 100])
m.shape torch.Size([637, 5, 100])
----------------------------------------1
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.6610379219055176  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.6610379219055176  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 637, 100]), torch.Size([1, 637, 100])
----------------------------------------3
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.6615128517150879  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.6786031723022461  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 637, 100])
m.shape torch.Size([637, 6, 100])
----------------------------------------1
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.6805181503295898  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.6805181503295898  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 637, 100]), torch.Size([1, 637, 100])
----------------------------------------3
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.6809930801391602  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.7014064788818359  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 637, 100])
m.shape torch.Size([830, 7, 100])
----------------------------------------1
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.703333854675293  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.703333854675293  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 830, 100]), torch.Size([1, 830, 100])
----------------------------------------3
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.7039527893066406  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.7356739044189453  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 830, 100])
m.shape torch.Size([807, 8, 100])
----------------------------------------1
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.737769603729248  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.737769603729248  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 807, 100]), torch.Size([1, 807, 100])
----------------------------------------3
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.7383713722229004  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.7750611305236816  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 807, 100])
m.shape torch.Size([780, 9, 100])
----------------------------------------1
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.7780609130859375  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.7780609130859375  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 780, 100]), torch.Size([1, 780, 100])
----------------------------------------3
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.7786426544189453  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.2889404296875 GB
    Memory Allocated: 0.816035270690918  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 780, 100])
m.shape torch.Size([115022, 10, 100])
----------------------------------------1
 Nvidia-smi: 21.7186279296875 GB
    Memory Allocated: 1.2442350387573242  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.7186279296875 GB
    Memory Allocated: 1.2442350387573242  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 115022, 100]), torch.Size([1, 115022, 100])
----------------------------------------3
 Nvidia-smi: 21.7186279296875 GB
    Memory Allocated: 1.3302674293518066  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.419143199920654  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 115022, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 6.9789838790893555  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.093502044677734  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.208020210266113  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.093502044677734  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

torch.Size([120081, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.208020210266113  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.236649990081787  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.236649990081787  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.490920066833496  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.490920066833496  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.490931510925293  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.491023063659668  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([23, 2, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.491061687469482  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.491061687469482  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.491105556488037  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.491763591766357  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([78, 3, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.491966724395752  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.491966724395752  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.492115497589111  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.495388507843018  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([61, 4, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.495548725128174  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.495548725128174  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.495665073394775  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.499039173126221  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([84, 5, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.499384880065918  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.499384880065918  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.499545097351074  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.505312919616699  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([73, 6, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.5056538581848145  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.5056538581848145  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.50579309463501  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.511780261993408  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([111, 7, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.512457847595215  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.512457847595215  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.512669563293457  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.523255348205566  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([69, 8, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.523680210113525  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.523680210113525  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.5238118171691895  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.531313419342041  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([35, 9, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.531550407409668  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.531550407409668  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.531617164611816  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.535889625549316  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.536548614501953  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.536548614501953  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.536685943603516  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.546436309814453  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([80, 11, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.547213554382324  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.547213554382324  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.547366142272949  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.559267997741699  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([53, 12, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.559803009033203  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.559803009033203  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.559904098510742  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.5684967041015625  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([79, 13, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.569651126861572  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.569651126861572  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.5698018074035645  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.583664417266846  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([118, 14, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.585176944732666  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.585176944732666  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.585402011871338  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.6076836585998535  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.6081624031066895  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.6081624031066895  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.608240604400635  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.616529941558838  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([76, 16, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.617659568786621  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.617659568786621  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.617804527282715  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.634184837341309  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([60, 17, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.635092735290527  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.635092735290527  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.635207176208496  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.648940086364746  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([81, 18, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.6509528160095215  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.6509528160095215  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.651107311248779  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.6707282066345215  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.67123556137085  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.67123556137085  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.6712965965271  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.6794753074646  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([75, 20, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.680886745452881  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.680886745452881  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.681029796600342  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.701200008392334  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([52, 21, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.702232837677002  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.702232837677002  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.702332019805908  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.717010974884033  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([66, 22, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.719122886657715  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.719122886657715  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.7192487716674805  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.738760948181152  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([78, 23, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.74042272567749  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.74042272567749  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.74057149887085  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.764672756195068  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([84, 24, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.766536235809326  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.766536235809326  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.766696453094482  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 7.793773174285889  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([9727, 25, 256])
----------------------------------------1
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 8.027414798736572  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 8.027414798736572  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

 h.shape torch.Size([1, 9727, 256]), torch.Size([1, 9727, 256])
----------------------------------------3
 Nvidia-smi: 23.1795654296875 GB
    Memory Allocated: 8.04596757888794  GigaBytes
Max Memory Allocated: 10.991826057434082  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 11.311859130859375  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 9727, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 11.061474323272705  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 11.063916683197021  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 11.066359043121338  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 11.06383228302002  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

torch.Size([11314, 47])
input nodes number: 120081
output nodes number: 11314
edges number: 263893
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 11.064352035522461  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.4119873046875 GB
    Memory Allocated: 11.06435251235962  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.19760417938232422  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

pseudo mini batch 11 input nodes size: 225952
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.16767597198486328  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.16767597198486328  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.2518496513366699  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.2519364356994629  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.09179067611694336  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.10053443908691406  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.10053443908691406  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

first layer input nodes number: 225952
first layer output nodes number: 82064
edges number: 786554
----------------------------------------before model layer 0
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.10353755950927734  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

torch.Size([225952, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.10353755950927734  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

m.shape torch.Size([110, 1, 100])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.4049081802368164  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.4049081802368164  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 110, 100]), torch.Size([1, 110, 100])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.40499019622802734  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.40564632415771484  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 110, 100])
m.shape torch.Size([211, 2, 100])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.4057626724243164  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.4057626724243164  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 211, 100]), torch.Size([1, 211, 100])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.40592002868652344  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.4082803726196289  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 211, 100])
m.shape torch.Size([485, 3, 100])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.40874385833740234  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.40874385833740234  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 485, 100]), torch.Size([1, 485, 100])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.4091053009033203  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.4170570373535156  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 485, 100])
m.shape torch.Size([963, 4, 100])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.41831159591674805  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.41831159591674805  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 963, 100]), torch.Size([1, 963, 100])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.41902971267700195  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.4401974678039551  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 963, 100])
m.shape torch.Size([1281, 5, 100])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.44222450256347656  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.44222450256347656  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 1281, 100]), torch.Size([1, 1281, 100])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.4431791305541992  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.4780693054199219  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 1281, 100])
m.shape torch.Size([1451, 6, 100])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.4808354377746582  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.4808354377746582  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 1451, 100]), torch.Size([1, 1451, 100])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.4819169044494629  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.5302343368530273  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 1451, 100])
m.shape torch.Size([1646, 7, 100])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.5339860916137695  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.5339860916137695  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 1646, 100]), torch.Size([1, 1646, 100])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.535212516784668  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.5972175598144531  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 1646, 100])
m.shape torch.Size([1675, 8, 100])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.6015963554382324  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.6015963554382324  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 1675, 100]), torch.Size([1, 1675, 100])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.6028447151184082  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.6739897727966309  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 1675, 100])
m.shape torch.Size([1738, 9, 100])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.6791930198669434  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.6791930198669434  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 1738, 100]), torch.Size([1, 1738, 100])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.680488109588623  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 0.763373851776123  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 1738, 100])
m.shape torch.Size([72504, 10, 100])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 1.032824993133545  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 1.032824993133545  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 72504, 100]), torch.Size([1, 72504, 100])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 1.0868449211120605  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 4.922245502471924  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 72504, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 4.63125467300415  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 4.709517002105713  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 4.787779331207275  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 4.709517002105713  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

torch.Size([82064, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 4.787779331207275  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 4.807344913482666  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 4.807344913482666  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.073296546936035  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.073296546936035  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.073302268981934  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.073348045349121  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.073353290557861  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.073353290557861  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.073360919952393  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.073475360870361  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([14, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.073512077331543  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.073512077331543  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.073538780212402  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.074126243591309  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([23, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.074201583862305  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.074201583862305  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.074245452880859  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.075517654418945  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([29, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.0756354331970215  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.0756354331970215  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.075690746307373  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.077682018280029  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([46, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.077919960021973  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.077919960021973  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.078007698059082  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.081780433654785  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([65, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.082174301147461  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.082174301147461  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.082298278808594  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.088497161865234  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([52, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.0888352394104  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.0888352394104  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.088934421539307  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.094587802886963  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([69, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.09513521194458  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.09513521194458  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.095266819000244  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.103689670562744  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([95, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.104537010192871  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.104537010192871  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.104718208312988  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.117583274841309  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([99, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.1194891929626465  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.1194891929626465  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.119678020477295  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.134406566619873  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([78, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.135211944580078  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.135211944580078  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.1353607177734375  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.148006439208984  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([75, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.148869514465332  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.148869514465332  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.149012565612793  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.162173271179199  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([87, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.163272857666016  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.163272857666016  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.16343879699707  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.179866790771484  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([96, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.181168079376221  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.181168079376221  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.181351184844971  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.200760364532471  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([99, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.202191352844238  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.202191352844238  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.202380180358887  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.22371768951416  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([75, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.225127220153809  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.225127220153809  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.2252702713012695  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.242436408996582  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([97, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.244043350219727  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.244043350219727  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.244228363037109  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.267724990844727  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([83, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.269601821899414  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.269601821899414  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.2697601318359375  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.290973663330078  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([68, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.292201995849609  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.292201995849609  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.292331695556641  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.310619354248047  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([88, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.312893867492676  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.312893867492676  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.313061714172363  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.337903022766113  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([91, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.339743614196777  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.339743614196777  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.339917182922363  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.366820335388184  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([81, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.368524551391602  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.368524551391602  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 10.1112060546875 GB
    Memory Allocated: 5.368679046630859  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1326904296875 GB
    Memory Allocated: 5.393707275390625  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([62, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.1326904296875 GB
    Memory Allocated: 5.395354747772217  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1326904296875 GB
    Memory Allocated: 5.395354747772217  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 10.1326904296875 GB
    Memory Allocated: 5.395473003387451  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.1522216796875 GB
    Memory Allocated: 5.4154582023620605  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([10065, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.1561279296875 GB
    Memory Allocated: 5.657242298126221  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.1561279296875 GB
    Memory Allocated: 5.657242298126221  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 10065, 256]), torch.Size([1, 10065, 256])
----------------------------------------3
 Nvidia-smi: 10.1561279296875 GB
    Memory Allocated: 5.676873683929443  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6502685546875 GB
    Memory Allocated: 9.061134338378906  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 10065, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.6502685546875 GB
    Memory Allocated: 8.79977560043335  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.6502685546875 GB
    Memory Allocated: 8.802507400512695  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.6502685546875 GB
    Memory Allocated: 8.805276870727539  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.6502685546875 GB
    Memory Allocated: 8.8024582862854  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

torch.Size([11644, 47])
input nodes number: 82064
output nodes number: 11644
edges number: 275034
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6502685546875 GB
    Memory Allocated: 8.803446292877197  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.6502685546875 GB
    Memory Allocated: 8.803446769714355  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.11660337448120117  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

pseudo mini batch 12 input nodes size: 343980
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.09208011627197266  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.09208011627197266  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.22022294998168945  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.22031164169311523  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.13605117797851562  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.14658021926879883  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.14658021926879883  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

first layer input nodes number: 343980
first layer output nodes number: 111217
edges number: 1095320
----------------------------------------before model layer 0
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.14997196197509766  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

torch.Size([343980, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.14997196197509766  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

m.shape torch.Size([194, 1, 100])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.5695652961730957  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.5695652961730957  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 194, 100]), torch.Size([1, 194, 100])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.5697102546691895  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.5708684921264648  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 194, 100])
m.shape torch.Size([254, 2, 100])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.5709853172302246  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.5709853172302246  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 254, 100]), torch.Size([1, 254, 100])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.5711750984191895  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.5740160942077637  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 254, 100])
m.shape torch.Size([310, 3, 100])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.5742678642272949  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.5742678642272949  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 310, 100]), torch.Size([1, 310, 100])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.5744996070861816  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.579585075378418  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 310, 100])
m.shape torch.Size([419, 4, 100])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.5800938606262207  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.5800938606262207  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 419, 100]), torch.Size([1, 419, 100])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.580406665802002  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.5894665718078613  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 419, 100])
m.shape torch.Size([491, 5, 100])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.5902247428894043  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.5902247428894043  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 491, 100]), torch.Size([1, 491, 100])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.5905909538269043  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.6037673950195312  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 491, 100])
m.shape torch.Size([580, 6, 100])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.6048808097839355  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.6048808097839355  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 580, 100]), torch.Size([1, 580, 100])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.605313777923584  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.6239056587219238  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 580, 100])
m.shape torch.Size([574, 7, 100])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.6251864433288574  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.6251864433288574  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 574, 100]), torch.Size([1, 574, 100])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.6256146430969238  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.6470046043395996  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 574, 100])
m.shape torch.Size([622, 8, 100])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.6486444473266602  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.6486444473266602  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 622, 100]), torch.Size([1, 622, 100])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.6491079330444336  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.6755266189575195  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 622, 100])
m.shape torch.Size([647, 9, 100])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.677464485168457  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.677464485168457  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 647, 100]), torch.Size([1, 647, 100])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.6779470443725586  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 0.7088050842285156  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 647, 100])
m.shape torch.Size([107126, 10, 100])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 1.1076393127441406  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 1.1076393127441406  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 107126, 100]), torch.Size([1, 107126, 100])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 1.187455177307129  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.855126857757568  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 107126, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.446532249450684  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.5525970458984375  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.658661842346191  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.5525970458984375  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

torch.Size([111217, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.658661842346191  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.685178279876709  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.685178279876709  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.968677043914795  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.968677043914795  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.9686808586120605  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.9687113761901855  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.968715667724609  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.968715667724609  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.968721389770508  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.968807220458984  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.968827724456787  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.968827724456787  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.96884298324585  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.969178676605225  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.96919059753418  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.96919059753418  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.969200134277344  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.969476699829102  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([12, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.969529628753662  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.969529628753662  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.969552516937256  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.970376491546631  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.970376968383789  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.970376968383789  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.970380783081055  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.970544815063477  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([15, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.970643997192383  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.970643997192383  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.970672607421875  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.972103118896484  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.972204208374023  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.972204208374023  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.972232818603516  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.97386360168457  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.97396183013916  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.97396183013916  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.973986625671387  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.975573539733887  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([18, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.975734233856201  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.975734233856201  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.975768566131592  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.978206157684326  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.978337287902832  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.978337287902832  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.978363990783691  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.980446815490723  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.980560779571533  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.980560779571533  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.980581760406494  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.982365131378174  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([9, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.982467174530029  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.982467174530029  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.982484340667725  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.984063625335693  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([15, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.984257221221924  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.984257221221924  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.984285831451416  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.987118244171143  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.987262725830078  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.987262725830078  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.987283706665039  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.989507675170898  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([18, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.989774227142334  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.989774227142334  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.989808559417725  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.993688106536865  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.993899822235107  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.993899822235107  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.993926525115967  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.997130870819092  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.997498512268066  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.997498512268066  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 6.997540473937988  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.002869606018066  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([12, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.003067970275879  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.003067970275879  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.003090858459473  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.006157875061035  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.006608009338379  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.006608009338379  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.006653785705566  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.013108253479004  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.013368129730225  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.013368129730225  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.013394832611084  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.0173468589782715  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([21, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.017777919769287  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.017777919769287  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.017817974090576  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.024026393890381  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.024360179901123  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.024360179901123  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.024390697479248  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.029334545135498  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.029827117919922  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.029827117919922  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.029869079589844  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.036960601806641  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([11566, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.314901828765869  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.314901828765869  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 11566, 256]), torch.Size([1, 11566, 256])
----------------------------------------3
 Nvidia-smi: 10.6522216796875 GB
    Memory Allocated: 7.338339328765869  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.2205810546875 GB
    Memory Allocated: 11.268394470214844  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 11566, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.2205810546875 GB
    Memory Allocated: 10.988202571868896  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.2205810546875 GB
    Memory Allocated: 10.990383625030518  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.2205810546875 GB
    Memory Allocated: 10.992464065551758  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.2205810546875 GB
    Memory Allocated: 10.990194320678711  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

torch.Size([11882, 47])
input nodes number: 111217
output nodes number: 11882
edges number: 293856
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2205810546875 GB
    Memory Allocated: 10.99056100845337  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.2205810546875 GB
    Memory Allocated: 10.990561485290527  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.2205810546875 GB
    Memory Allocated: 0.16434431076049805  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

pseudo mini batch 13 input nodes size: 345465
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.2205810546875 GB
    Memory Allocated: 0.13550043106079102  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.2205810546875 GB
    Memory Allocated: 0.13550043106079102  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.2205810546875 GB
    Memory Allocated: 0.26419639587402344  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 13.2205810546875 GB
    Memory Allocated: 0.2642850875854492  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.2205810546875 GB
    Memory Allocated: 0.13605356216430664  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.2205810546875 GB
    Memory Allocated: 0.14725160598754883  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2205810546875 GB
    Memory Allocated: 0.14725160598754883  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

first layer input nodes number: 345465
first layer output nodes number: 121660
edges number: 1206733
----------------------------------------before model layer 0
 Nvidia-smi: 13.2205810546875 GB
    Memory Allocated: 0.15073204040527344  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

torch.Size([345465, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.2205810546875 GB
    Memory Allocated: 0.15073204040527344  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

m.shape torch.Size([112, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6130948066711426  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6130948066711426  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 112, 100]), torch.Size([1, 112, 100])
----------------------------------------3
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6131787300109863  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6138472557067871  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 112, 100])
m.shape torch.Size([170, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6139321327209473  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6139321327209473  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 170, 100]), torch.Size([1, 170, 100])
----------------------------------------3
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6140589714050293  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6159615516662598  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 170, 100])
m.shape torch.Size([188, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6161084175109863  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6161084175109863  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 188, 100]), torch.Size([1, 188, 100])
----------------------------------------3
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.616248607635498  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6193327903747559  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 188, 100])
m.shape torch.Size([237, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6196160316467285  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6196160316467285  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 237, 100]), torch.Size([1, 237, 100])
----------------------------------------3
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6197934150695801  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6249203681945801  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 237, 100])
m.shape torch.Size([270, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6253347396850586  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6253347396850586  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 270, 100]), torch.Size([1, 270, 100])
----------------------------------------3
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6255359649658203  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6327800750732422  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 270, 100])
m.shape torch.Size([299, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6333479881286621  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6333479881286621  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 299, 100]), torch.Size([1, 299, 100])
----------------------------------------3
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6335711479187012  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6431584358215332  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 299, 100])
m.shape torch.Size([358, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6439805030822754  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6439805030822754  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 358, 100]), torch.Size([1, 358, 100])
----------------------------------------3
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6442475318908691  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6575889587402344  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 358, 100])
m.shape torch.Size([369, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6590838432312012  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6590838432312012  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 369, 100]), torch.Size([1, 369, 100])
----------------------------------------3
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6593594551086426  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.675046443939209  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 369, 100])
m.shape torch.Size([403, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6762599945068359  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6762599945068359  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 403, 100]), torch.Size([1, 403, 100])
----------------------------------------3
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6765604019165039  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6737060546875 GB
    Memory Allocated: 0.6957864761352539  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 403, 100])
m.shape torch.Size([119254, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.1190185546875 GB
    Memory Allocated: 1.1398921012878418  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1190185546875 GB
    Memory Allocated: 1.1398921012878418  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 119254, 100]), torch.Size([1, 119254, 100])
----------------------------------------3
 Nvidia-smi: 14.1190185546875 GB
    Memory Allocated: 1.2297358512878418  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.5490899085998535  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 119254, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.0971760749816895  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.213200092315674  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.329224109649658  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.213200092315674  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

torch.Size([121660, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.329224109649658  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.358230113983154  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.358230113983154  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.643680095672607  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.643680095672607  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.64368200302124  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.643697261810303  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([10, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.643734931945801  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.643734931945801  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.643754005432129  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.6443071365356445  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.644312381744385  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.644312381744385  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.644318103790283  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.644524097442627  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.644550323486328  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.644550323486328  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.644559860229492  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.644969940185547  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.644985675811768  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.644985675811768  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.644991397857666  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.645277500152588  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([11, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.645370006561279  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.645370006561279  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.64539098739624  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.64673376083374  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.646790981292725  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.646790981292725  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.646804332733154  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.647752285003662  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.647819995880127  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.647819995880127  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.647833347320557  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.648874759674072  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.648914337158203  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.648914337158203  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.648921966552734  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.649570465087891  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.649666786193848  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.649666786193848  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.64968204498291  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.65108585357666  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.651145935058594  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.651145935058594  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.651155471801758  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.652099609375  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.652210235595703  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.652210235595703  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.652225494384766  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.653842926025391  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([4, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.653896808624268  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.653896808624268  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.653904438018799  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.65476655960083  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.654877185821533  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.654877185821533  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.654890537261963  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.656492710113525  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.656659126281738  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.656659126281738  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.656678199768066  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.659100532531738  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([5, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.659182548522949  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.659182548522949  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.659192085266113  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.660470008850098  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.660561561584473  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.660561561584473  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.660571098327637  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.6619157791137695  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.661971569061279  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.661971569061279  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.661977291107178  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.6628241539001465  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.662906169891357  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.662906169891357  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.662913799285889  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.664096355438232  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.66426944732666  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.66426944732666  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.664284706115723  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.666756629943848  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.666864395141602  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.666864395141602  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.666873931884766  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.668485641479492  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([11777, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.951460361480713  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.951460361480713  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

 h.shape torch.Size([1, 11777, 256]), torch.Size([1, 11777, 256])
----------------------------------------3
 Nvidia-smi: 14.5643310546875 GB
    Memory Allocated: 7.974897861480713  GigaBytes
Max Memory Allocated: 11.544281005859375  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 11.933520317077637  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 11777, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 11.650972366333008  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 11.653192043304443  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 11.656017303466797  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 11.653708934783936  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

torch.Size([11900, 47])
input nodes number: 121660
output nodes number: 11900
edges number: 296133
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 11.654606819152832  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 11.65460729598999  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.16750526428222656  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

pseudo mini batch 14 input nodes size: 299868
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.1359562873840332  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.1359562873840332  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.2476658821105957  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.24775171279907227  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.11896705627441406  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.12987661361694336  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.12987661361694336  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

first layer input nodes number: 299868
first layer output nodes number: 109607
edges number: 1085035
----------------------------------------before model layer 0
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.13292789459228516  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

torch.Size([299868, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.13292789459228516  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

m.shape torch.Size([150, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.548548698425293  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.548548698425293  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 150, 100]), torch.Size([1, 150, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5486612319946289  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5495572090148926  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 150, 100])
m.shape torch.Size([182, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5496368408203125  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5496368408203125  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 182, 100]), torch.Size([1, 182, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5497732162475586  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5518102645874023  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 182, 100])
m.shape torch.Size([206, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5519723892211914  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5519723892211914  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 206, 100]), torch.Size([1, 206, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5521259307861328  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5555038452148438  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 206, 100])
m.shape torch.Size([253, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5558042526245117  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5558042526245117  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 253, 100]), torch.Size([1, 253, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5559930801391602  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5614633560180664  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 253, 100])
m.shape torch.Size([316, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.561957836151123  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.561957836151123  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 316, 100]), torch.Size([1, 316, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5621933937072754  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5706734657287598  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 316, 100])
m.shape torch.Size([317, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5712642669677734  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5712642669677734  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 317, 100]), torch.Size([1, 317, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5715007781982422  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5816621780395508  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 317, 100])
m.shape torch.Size([381, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5826983451843262  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5826983451843262  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 381, 100]), torch.Size([1, 381, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5829825401306152  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5971822738647461  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 381, 100])
m.shape torch.Size([413, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.598271369934082  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.598271369934082  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 413, 100]), torch.Size([1, 413, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5985794067382812  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.6161260604858398  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 413, 100])
m.shape torch.Size([452, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.618375301361084  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.618375301361084  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 452, 100]), torch.Size([1, 452, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.6187129020690918  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.6402807235717773  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 452, 100])
m.shape torch.Size([106937, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 1.0384836196899414  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 1.0384836196899414  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 106937, 100]), torch.Size([1, 106937, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 1.1181583404541016  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.775049209594727  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 106937, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.369787216186523  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.474316596984863  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.578845977783203  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.474316596984863  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

torch.Size([109607, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.578845977783203  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.604978561401367  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.604978561401367  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.88083553314209  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.88083553314209  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.8808393478393555  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.8808698654174805  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.8808722496032715  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.8808722496032715  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.880876064300537  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.8809332847595215  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.880937576293945  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.880937576293945  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.880941390991211  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.881025314331055  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([9, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.881058216094971  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.881058216094971  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.881075382232666  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.88157320022583  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.881582260131836  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.881582260131836  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.881587982177734  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.881834030151367  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([25, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.881999492645264  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.881999492645264  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.882047176361084  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.8844313621521  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.88442325592041  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.88442325592041  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.884427070617676  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.884644508361816  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.884694576263428  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.884694576263428  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.884706020355225  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.885438442230225  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.885538578033447  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.885538578033447  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.885557651519775  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.887045383453369  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.887163162231445  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.887163162231445  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.887184143066406  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.888967514038086  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([5, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.889019966125488  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.889019966125488  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.889029502868652  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.889906883239746  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.889955997467041  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.889955997467041  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.889963626861572  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.890718936920166  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([11, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.890873908996582  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.890873908996582  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.890894889831543  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.893118858337402  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.89332389831543  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.89332389831543  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.893350601196289  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.896368026733398  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([3, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.896403789520264  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.896403789520264  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.896409511566162  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.897096157073975  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.897214412689209  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.897214412689209  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.897227764129639  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.898923397064209  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.899190902709961  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.899190902709961  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.899219512939453  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.903053283691406  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.903231620788574  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.903231620788574  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.903250694274902  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.905940055847168  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.906213283538818  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.906213283538818  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.906239986419678  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.910192012786865  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.910453796386719  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.910453796386719  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.910478591918945  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.9143218994140625  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.914619445800781  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.914619445800781  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.914646148681641  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.918972015380859  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.919304847717285  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.919304847717285  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.919333457946777  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.924168586730957  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11313, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.196913242340088  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.196913242340088  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 11313, 256]), torch.Size([1, 11313, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.220350742340088  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 11.026355266571045  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 11313, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 10.753728866577148  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 10.756086349487305  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 10.75810194015503  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 10.755658626556396  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

torch.Size([11510, 47])
input nodes number: 109607
output nodes number: 11510
edges number: 285812
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 10.756834983825684  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 10.756835460662842  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.14800405502319336  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

pseudo mini batch 15 input nodes size: 274303
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.11924076080322266  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.11924076080322266  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.22142696380615234  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.22151517868041992  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.10971975326538086  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.11991643905639648  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.11991643905639648  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

first layer input nodes number: 274303
first layer output nodes number: 108462
edges number: 1073977
----------------------------------------before model layer 0
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.12276840209960938  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

torch.Size([274303, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.12276840209960938  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

m.shape torch.Size([123, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5341424942016602  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5341424942016602  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 123, 100]), torch.Size([1, 123, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5342350006103516  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.534970760345459  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 123, 100])
m.shape torch.Size([172, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5350527763366699  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5350527763366699  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 172, 100]), torch.Size([1, 172, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5351815223693848  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.537106990814209  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 172, 100])
m.shape torch.Size([187, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5372519493103027  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5372519493103027  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 187, 100]), torch.Size([1, 187, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5373921394348145  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5404634475708008  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 187, 100])
m.shape torch.Size([253, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5407705307006836  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5407705307006836  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 253, 100]), torch.Size([1, 253, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.540959358215332  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5464296340942383  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 253, 100])
m.shape torch.Size([303, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5468997955322266  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5468997955322266  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 303, 100]), torch.Size([1, 303, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5471258163452148  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5552554130554199  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 303, 100])
m.shape torch.Size([320, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5558576583862305  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5558576583862305  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 320, 100]), torch.Size([1, 320, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.556096076965332  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5663480758666992  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 320, 100])
m.shape torch.Size([403, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5677509307861328  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5677509307861328  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 403, 100]), torch.Size([1, 403, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5680513381958008  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5830717086791992  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 403, 100])
m.shape torch.Size([420, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5845942497253418  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5845942497253418  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 420, 100]), torch.Size([1, 420, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5849080085754395  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.6027579307556152  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 420, 100])
m.shape torch.Size([489, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.604240894317627  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.604240894317627  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 489, 100]), torch.Size([1, 489, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.6046061515808105  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.6279439926147461  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 489, 100])
m.shape torch.Size([105792, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 1.021867275238037  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 1.021867275238037  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 105792, 100]), torch.Size([1, 105792, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 1.1006884574890137  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.69699239730835  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 105792, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.295871734619141  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.3999481201171875  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.503385543823242  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.399309158325195  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

torch.Size([108462, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.503385543823242  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.528605937957764  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.528605937957764  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.8122782707214355  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.8122782707214355  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.812289714813232  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.812541484832764  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.812564849853516  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.812564849853516  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.8125762939453125  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.81298828125  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.813011646270752  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.813011646270752  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.813021183013916  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.813431262969971  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.813440322875977  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.813440322875977  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.813444137573242  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.813634872436523  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.813648700714111  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.813648700714111  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.813652515411377  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.813869953155518  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.813920021057129  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.813920021057129  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.813931465148926  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.814663887023926  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.814677715301514  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.814677715301514  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.814681529998779  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.814952373504639  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.814992904663086  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.814992904663086  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.815000534057617  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.815595626831055  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.815695762634277  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.815695762634277  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.815712928771973  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.817172050476074  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.817226409912109  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.817226409912109  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.817235946655273  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.818113327026367  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.818202972412109  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.818202972412109  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.818216323852539  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.819538116455078  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([2, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.819560527801514  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.819560527801514  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.819564342498779  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.8199687004089355  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.819982528686523  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.819982528686523  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.819984436035156  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.820199966430664  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.820231914520264  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.820231914520264  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.820235729217529  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.820693492889404  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.8207783699035645  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.8207783699035645  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.8207879066467285  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.8219990730285645  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.822122573852539  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.822122573852539  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.822135925292969  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.823925018310547  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.823995590209961  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.823995590209961  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.824003219604492  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.825078964233398  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.825236797332764  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.825236797332764  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.825252056121826  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.827510356903076  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.827608585357666  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.827608585357666  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.82761812210083  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.82909631729126  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.829224586486816  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.829224586486816  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.829236030578613  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.831089973449707  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.831637859344482  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.831637859344482  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.83168363571167  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.839419841766357  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([11703, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.121144771575928  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.121144771575928  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 11703, 256]), torch.Size([1, 11703, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.144582271575928  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 11.085742473602295  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 11703, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 10.804687023162842  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 10.806918621063232  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 10.809150218963623  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 10.806830406188965  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

torch.Size([11821, 47])
input nodes number: 108462
output nodes number: 11821
edges number: 294447
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 10.807600975036621  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 10.80760145187378  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.13709545135498047  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

pseudo mini batch 16 input nodes size: 346005
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.10959386825561523  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.10959386825561523  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.23849105834960938  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.23857641220092773  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.13630199432373047  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.14713048934936523  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.14713048934936523  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

first layer input nodes number: 346005
first layer output nodes number: 112089
edges number: 1109501
----------------------------------------before model layer 0
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.1505441665649414  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

torch.Size([346005, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.1505441665649414  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

m.shape torch.Size([139, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5755329132080078  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5755329132080078  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 139, 100]), torch.Size([1, 139, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5756368637084961  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5764670372009277  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 139, 100])
m.shape torch.Size([205, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5765681266784668  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5765681266784668  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 205, 100]), torch.Size([1, 205, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5767216682434082  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5790162086486816  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 205, 100])
m.shape torch.Size([225, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5791912078857422  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5791912078857422  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 225, 100]), torch.Size([1, 225, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5793590545654297  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5830516815185547  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 225, 100])
m.shape torch.Size([246, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5833344459533691  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5833344459533691  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 246, 100]), torch.Size([1, 246, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5835185050964355  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.588839054107666  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 246, 100])
m.shape torch.Size([301, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5893077850341797  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5893077850341797  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 301, 100]), torch.Size([1, 301, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5895328521728516  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5976138114929199  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 301, 100])
m.shape torch.Size([334, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5982480049133301  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5982480049133301  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 334, 100]), torch.Size([1, 334, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.5984969139099121  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.6092000007629395  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 334, 100])
m.shape torch.Size([392, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.6100978851318359  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.6100978851318359  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 392, 100]), torch.Size([1, 392, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.6103906631469727  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.6249995231628418  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 392, 100])
m.shape torch.Size([445, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.6261796951293945  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.6261796951293945  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 445, 100]), torch.Size([1, 445, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.6265115737915039  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.6454172134399414  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 445, 100])
m.shape torch.Size([540, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.647061824798584  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.647061824798584  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 540, 100]), torch.Size([1, 540, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.6474642753601074  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.6732211112976074  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 540, 100])
m.shape torch.Size([109262, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 1.0800528526306152  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 1.0800528526306152  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 109262, 100]), torch.Size([1, 109262, 100])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 1.1614594459533691  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.9413275718688965  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 109262, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.526961803436279  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.6338582038879395  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.7407546043396  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.6338582038879395  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

torch.Size([112089, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.7407546043396  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.767478942871094  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 6.767478942871094  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.040297985076904  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.040297985076904  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.0403151512146  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.040572643280029  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.040578842163086  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.040578842163086  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.04058837890625  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.040798187255859  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([21, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.040874481201172  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.040874481201172  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.040914535522461  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.042076110839844  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.0420660972595215  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.0420660972595215  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.042069911956787  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.04220724105835  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([15, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.04229211807251  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.04229211807251  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.042320728302002  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.043550968170166  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([7, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.043583869934082  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.043583869934082  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.043597221374512  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.044264793395996  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.044296741485596  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.044296741485596  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.04430627822876  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.044849872589111  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([10, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.044931888580322  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.044931888580322  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.04495096206665  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.04617166519165  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.046181678771973  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.046181678771973  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.046185493469238  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.046456336975098  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([14, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.046616077423096  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.046616077423096  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.046642780303955  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.048912525177002  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.049111843109131  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.049111843109131  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.049144268035889  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.052127361297607  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([21, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.052393913269043  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.052393913269043  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.052433967590332  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.056399345397949  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([3, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.056422710418701  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.056422710418701  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.0564284324646  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.057034969329834  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.057093620300293  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.057093620300293  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.057101249694824  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.0579633712768555  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.058073997497559  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.058073997497559  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.058087348937988  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.059689521789551  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.05973482131958  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.05973482131958  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.0597405433654785  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.06046724319458  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.060866355895996  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.060866355895996  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.060908317565918  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.066531181335449  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([4, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.066587448120117  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.066587448120117  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.066595077514648  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.067670822143555  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.06782865524292  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.06782865524292  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.067843914031982  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.070102214813232  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.070200443267822  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.070200443267822  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.070209980010986  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.071688175201416  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.072103500366211  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.072103500366211  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.072139739990234  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.078010559082031  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.078131198883057  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.078131198883057  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.0781426429748535  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.080076694488525  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([11202, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.349234104156494  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.349234104156494  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

 h.shape torch.Size([1, 11202, 256]), torch.Size([1, 11202, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 7.371457576751709  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 11.134027004241943  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

rst.shape  torch.Size([1, 11202, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 10.864296913146973  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 10.866408348083496  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 10.868597984313965  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 10.866401195526123  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

torch.Size([11411, 47])
input nodes number: 112089
output nodes number: 11411
edges number: 282788
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 10.867201805114746  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 10.867202281951904  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.16525554656982422  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.17034244537353516  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 0.17034244537353516  GigaBytes
Max Memory Allocated: 12.214770317077637  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.07136598755331601 |0.02548987725201775 |0.21381308050716624 |0.00012127090902889476 |0.13227037822498994 |0.0053136348724365234 |
----------------------------------------------------------pseudo_mini_loss sum 5.390032768249512
Total (block generation + training)time/epoch 77.86844897270203
* Pure training time/epoch 7.537343740463257
Training time/epoch 7.659656763076782
Training time without block to device /epoch 7.2263288497924805
Training time without total dataloading part /epoch 5.890794038772583
load block tensor time/epoch 1.213221788406372
block to device time/epoch 0.43332791328430176
input features size transfer per epoch 2.2798776626586914e-06
blocks size to device per epoch 1.519918441772461e-06
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6814374
Number of first layer input nodes during this epoch:  5100733
Number of first layer output nodes during this epoch:  1713641
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  682400
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([400, 100])
layers.0.lstm.weight_hh_l0, torch.Size([400, 100])
layers.0.lstm.bias_ih_l0, torch.Size([400])
layers.0.lstm.bias_hh_l0, torch.Size([400])
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([47, 256])
layers.1.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
