main start at this time 1655792817.909235
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.22272562980651855
global_2_local spend time (sec) 0.3804612159729004
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.05124211311340332
A = g.adjacency_matrix() spent  0.0749361515045166
auxiliary_graph
Graph(num_nodes=1205586, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.590233564376831
remove nodes length
1009015
auxiliary_graph.remove_nodes spent  2.684403419494629
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.0600392818450928

the counter of shared neighbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
51547892
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 51547889, 51547890, 51547891])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
Convert a graph into a bidirected graph: 2.891 seconds
Metis partitioning: 12.470 seconds
Split the graph: 0.826 seconds
Construct subgraphs: 0.285 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  16.492294311523438
10023
10048
9542
9575
9541
10015
10119
10067
9791
9541
10107
10118
9705
9592
9548
10085
9541
10091
9935
9587
total k batches seeds list generation spend  37.51921629905701
after graph partition
graph partition algorithm spend time 38.04041266441345
10023
10048
9542
9575
9541
10015
10119
10067
9791
9541
10107
10118
9705
9592
9548
10085
9541
10091
9935
9587
partition_len_list
[96786, 77212, 97527, 77890, 94395, 100111, 105853, 89774, 99609, 91292, 84919, 91504, 69562, 68567, 84673, 76303, 88692, 84955, 95413, 83370]
shared_neighbor_graph_partition_s0 selection method  spend 38.666542053222656
time for parepare:  0.2307744026184082
local_output_nid generation:  0.003236055374145508
local_in_edges_tensor generation:  0.003929853439331055
mini_batch_src_global generation:  0.016948699951171875
r_  generation:  0.08096647262573242
local_output_nid generation:  0.003744363784790039
local_in_edges_tensor generation:  0.0038542747497558594
mini_batch_src_global generation:  0.010109186172485352
r_  generation:  0.08080053329467773
local_output_nid generation:  0.003648042678833008
local_in_edges_tensor generation:  0.003668546676635742
mini_batch_src_global generation:  0.0071985721588134766
r_  generation:  0.0805501937866211
local_output_nid generation:  0.0037267208099365234
local_in_edges_tensor generation:  0.003743886947631836
mini_batch_src_global generation:  0.007699012756347656
r_  generation:  0.07370233535766602
local_output_nid generation:  0.003591775894165039
local_in_edges_tensor generation:  0.0037670135498046875
mini_batch_src_global generation:  0.007731914520263672
r_  generation:  0.08472967147827148
local_output_nid generation:  0.0037851333618164062
local_in_edges_tensor generation:  0.003942728042602539
mini_batch_src_global generation:  0.012548685073852539
r_  generation:  0.09795570373535156
local_output_nid generation:  0.00380706787109375
local_in_edges_tensor generation:  0.003986835479736328
mini_batch_src_global generation:  0.011577844619750977
r_  generation:  0.10364007949829102
local_output_nid generation:  0.003820180892944336
local_in_edges_tensor generation:  0.003904104232788086
mini_batch_src_global generation:  0.010475397109985352
r_  generation:  0.10156559944152832
local_output_nid generation:  0.0037734508514404297
local_in_edges_tensor generation:  0.003828287124633789
mini_batch_src_global generation:  0.009997367858886719
r_  generation:  0.09881806373596191
local_output_nid generation:  0.003650665283203125
local_in_edges_tensor generation:  0.0038285255432128906
mini_batch_src_global generation:  0.00999593734741211
r_  generation:  0.09935712814331055
local_output_nid generation:  0.0038270950317382812
local_in_edges_tensor generation:  0.00391387939453125
mini_batch_src_global generation:  0.010059356689453125
r_  generation:  0.09528255462646484
local_output_nid generation:  0.005129098892211914
local_in_edges_tensor generation:  0.004020214080810547
mini_batch_src_global generation:  0.01047658920288086
r_  generation:  0.10079836845397949
local_output_nid generation:  0.0037212371826171875
local_in_edges_tensor generation:  0.003957986831665039
mini_batch_src_global generation:  0.010429143905639648
r_  generation:  0.08941459655761719
local_output_nid generation:  0.003679513931274414
local_in_edges_tensor generation:  0.004037380218505859
mini_batch_src_global generation:  0.009087085723876953
r_  generation:  0.08119773864746094
local_output_nid generation:  0.003641366958618164
local_in_edges_tensor generation:  0.0037484169006347656
mini_batch_src_global generation:  0.00942373275756836
r_  generation:  0.08472561836242676
local_output_nid generation:  0.0038399696350097656
local_in_edges_tensor generation:  0.0038993358612060547
mini_batch_src_global generation:  0.00982666015625
r_  generation:  0.0901634693145752
local_output_nid generation:  0.0036487579345703125
local_in_edges_tensor generation:  0.003793001174926758
mini_batch_src_global generation:  0.00916290283203125
r_  generation:  0.09244942665100098
local_output_nid generation:  0.0038154125213623047
local_in_edges_tensor generation:  0.004033803939819336
mini_batch_src_global generation:  0.0189206600189209
r_  generation:  0.09318828582763672
local_output_nid generation:  0.0037713050842285156
local_in_edges_tensor generation:  0.0038716793060302734
mini_batch_src_global generation:  0.00971364974975586
r_  generation:  0.09821033477783203
local_output_nid generation:  0.003710508346557617
local_in_edges_tensor generation:  0.0041234493255615234
mini_batch_src_global generation:  0.011034965515136719
r_  generation:  0.09540581703186035
----------------------check_connections_block total spend ----------------------------- 2.897926092147827
generate_one_block  1.5226051807403564
generate_one_block  0.11642098426818848
generate_one_block  0.16139554977416992
generate_one_block  0.10387730598449707
generate_one_block  0.11544013023376465
generate_one_block  0.12323832511901855
generate_one_block  0.12703990936279297
generate_one_block  0.12285065650939941
generate_one_block  0.1216888427734375
generate_one_block  0.11895322799682617
generate_one_block  0.12391209602355957
generate_one_block  0.12581086158752441
generate_one_block  0.12032604217529297
generate_one_block  0.1139833927154541
generate_one_block  0.1188497543334961
generate_one_block  0.1227266788482666
generate_one_block  0.11918306350708008
generate_one_block  0.12043190002441406
generate_one_block  0.12135148048400879
generate_one_block  0.11454463005065918
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6423373222351074
gen group dst list time:  0.04790639877319336
time for parepare:  0.4004487991333008
local_output_nid generation:  0.02368307113647461
local_in_edges_tensor generation:  0.07375907897949219
mini_batch_src_global generation:  0.02881145477294922
r_  generation:  0.3668227195739746
local_output_nid generation:  0.0215606689453125
local_in_edges_tensor generation:  0.026343584060668945
mini_batch_src_global generation:  0.0365450382232666
r_  generation:  0.29904794692993164
local_output_nid generation:  0.028784990310668945
local_in_edges_tensor generation:  0.03199887275695801
mini_batch_src_global generation:  0.036257266998291016
r_  generation:  0.4454221725463867
local_output_nid generation:  0.02350330352783203
local_in_edges_tensor generation:  0.026875734329223633
mini_batch_src_global generation:  0.03322911262512207
r_  generation:  0.3481724262237549
local_output_nid generation:  0.027123212814331055
local_in_edges_tensor generation:  0.026532649993896484
mini_batch_src_global generation:  0.03655362129211426
r_  generation:  0.4295182228088379
local_output_nid generation:  0.0278322696685791
local_in_edges_tensor generation:  0.031597137451171875
mini_batch_src_global generation:  0.044420719146728516
r_  generation:  0.4597949981689453
local_output_nid generation:  0.030162334442138672
local_in_edges_tensor generation:  0.0320131778717041
mini_batch_src_global generation:  0.047264814376831055
r_  generation:  0.5024430751800537
local_output_nid generation:  0.024422407150268555
local_in_edges_tensor generation:  0.022354841232299805
mini_batch_src_global generation:  0.04226231575012207
r_  generation:  0.40049052238464355
local_output_nid generation:  0.029310941696166992
local_in_edges_tensor generation:  0.03375124931335449
mini_batch_src_global generation:  0.04522371292114258
r_  generation:  0.46713995933532715
local_output_nid generation:  0.0255892276763916
local_in_edges_tensor generation:  0.0241701602935791
mini_batch_src_global generation:  0.043289899826049805
r_  generation:  0.42251133918762207
local_output_nid generation:  0.024411678314208984
local_in_edges_tensor generation:  0.023482799530029297
mini_batch_src_global generation:  0.03819584846496582
r_  generation:  0.39623498916625977
local_output_nid generation:  0.025147676467895508
local_in_edges_tensor generation:  0.026012659072875977
mini_batch_src_global generation:  0.04145359992980957
r_  generation:  0.41397666931152344
local_output_nid generation:  0.019789457321166992
local_in_edges_tensor generation:  0.018088817596435547
mini_batch_src_global generation:  0.03377056121826172
r_  generation:  0.3341543674468994
local_output_nid generation:  0.01881551742553711
local_in_edges_tensor generation:  0.01710820198059082
mini_batch_src_global generation:  0.0329897403717041
r_  generation:  0.2895817756652832
local_output_nid generation:  0.02381300926208496
local_in_edges_tensor generation:  0.02475428581237793
mini_batch_src_global generation:  0.0354762077331543
r_  generation:  0.38997745513916016
local_output_nid generation:  0.021795988082885742
local_in_edges_tensor generation:  0.0221250057220459
mini_batch_src_global generation:  0.03620147705078125
r_  generation:  0.3449671268463135
local_output_nid generation:  0.025485754013061523
local_in_edges_tensor generation:  0.023939132690429688
mini_batch_src_global generation:  0.03627490997314453
r_  generation:  0.41500020027160645
local_output_nid generation:  0.02406930923461914
local_in_edges_tensor generation:  0.026768207550048828
mini_batch_src_global generation:  0.03993654251098633
r_  generation:  0.38781142234802246
local_output_nid generation:  0.02684640884399414
local_in_edges_tensor generation:  0.027873992919921875
mini_batch_src_global generation:  0.03862428665161133
r_  generation:  0.44443511962890625
local_output_nid generation:  0.02566075325012207
local_in_edges_tensor generation:  0.025925874710083008
mini_batch_src_global generation:  0.04072761535644531
r_  generation:  0.38228487968444824
----------------------check_connections_block total spend ----------------------------- 11.959048509597778
generate_one_block  0.7951796054840088
generate_one_block  0.40207862854003906
generate_one_block  0.5751914978027344
generate_one_block  0.43123650550842285
generate_one_block  0.5647363662719727
generate_one_block  0.5308730602264404
generate_one_block  0.568584680557251
generate_one_block  0.45105767250061035
generate_one_block  0.5290615558624268
generate_one_block  0.46909523010253906
generate_one_block  0.43653440475463867
generate_one_block  0.4743988513946533
generate_one_block  0.3523094654083252
generate_one_block  0.324840784072876
generate_one_block  0.4383418560028076
generate_one_block  0.36894798278808594
generate_one_block  0.4701418876647949
generate_one_block  0.4292111396789551
generate_one_block  0.4941236972808838
generate_one_block  0.43795013427734375
----------===============-------------===============-------------the number of batches *****---- 20

original number of batches:  20
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

connection checking time:  14.856974601745605
block generation total time  13.378525018692017
average batch blocks generation time:  0.3344631254673004
block dataloader generation time/epoch 68.83670496940613
pseudo mini batch 0 input nodes size: 311818
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1365966796875 GB
    Memory Allocated: 0.11870479583740234  GigaBytes
Max Memory Allocated: 0.11870479583740234  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1365966796875 GB
    Memory Allocated: 0.11877965927124023  GigaBytes
Max Memory Allocated: 0.11877965927124023  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1365966796875 GB
    Memory Allocated: 0.11877965927124023  GigaBytes
Max Memory Allocated: 0.11877965927124023  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.12763643264770508  GigaBytes
Max Memory Allocated: 0.12763643264770508  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.12763643264770508  GigaBytes
Max Memory Allocated: 0.12763643264770508  GigaBytes

first layer input nodes number: 311818
first layer output nodes number: 96786
edges number: 948207
----------------------------------------before model layer 0
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.13068151473999023  GigaBytes
Max Memory Allocated: 0.13421392440795898  GigaBytes

torch.Size([311818, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2225341796875 GB
    Memory Allocated: 0.13068151473999023  GigaBytes
Max Memory Allocated: 0.13421392440795898  GigaBytes

m.shape torch.Size([86, 1, 100])
----------------------------------------1
 Nvidia-smi: 1.7127685546875 GB
    Memory Allocated: 0.4941883087158203  GigaBytes
Max Memory Allocated: 0.5092849731445312  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7127685546875 GB
    Memory Allocated: 0.4941883087158203  GigaBytes
Max Memory Allocated: 0.5092849731445312  GigaBytes

 h.shape torch.Size([1, 86, 100]), torch.Size([1, 86, 100])
----------------------------------------3
 Nvidia-smi: 1.7127685546875 GB
    Memory Allocated: 0.49425315856933594  GigaBytes
Max Memory Allocated: 0.5092849731445312  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.4947676658630371  GigaBytes
Max Memory Allocated: 0.5092849731445312  GigaBytes

rst.shape  torch.Size([1, 86, 100])
m.shape torch.Size([165, 2, 100])
----------------------------------------1
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.4948582649230957  GigaBytes
Max Memory Allocated: 0.5092849731445312  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.4948582649230957  GigaBytes
Max Memory Allocated: 0.5092849731445312  GigaBytes

 h.shape torch.Size([1, 165, 100]), torch.Size([1, 165, 100])
----------------------------------------3
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.4949812889099121  GigaBytes
Max Memory Allocated: 0.5092849731445312  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.4968266487121582  GigaBytes
Max Memory Allocated: 0.5092849731445312  GigaBytes

rst.shape  torch.Size([1, 165, 100])
m.shape torch.Size([297, 3, 100])
----------------------------------------1
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.4970974922180176  GigaBytes
Max Memory Allocated: 0.5092849731445312  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.4970974922180176  GigaBytes
Max Memory Allocated: 0.5092849731445312  GigaBytes

 h.shape torch.Size([1, 297, 100]), torch.Size([1, 297, 100])
----------------------------------------3
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.49731969833374023  GigaBytes
Max Memory Allocated: 0.5092849731445312  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7205810546875 GB
    Memory Allocated: 0.5021953582763672  GigaBytes
Max Memory Allocated: 0.5092849731445312  GigaBytes

rst.shape  torch.Size([1, 297, 100])
m.shape torch.Size([508, 4, 100])
----------------------------------------1
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.5028414726257324  GigaBytes
Max Memory Allocated: 0.5092849731445312  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.5028414726257324  GigaBytes
Max Memory Allocated: 0.5092849731445312  GigaBytes

 h.shape torch.Size([1, 508, 100]), torch.Size([1, 508, 100])
----------------------------------------3
 Nvidia-smi: 1.7225341796875 GB
    Memory Allocated: 0.5032200813293457  GigaBytes
Max Memory Allocated: 0.5092849731445312  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7342529296875 GB
    Memory Allocated: 0.5141997337341309  GigaBytes
Max Memory Allocated: 0.5149569511413574  GigaBytes

rst.shape  torch.Size([1, 508, 100])
m.shape torch.Size([666, 5, 100])
----------------------------------------1
 Nvidia-smi: 1.7342529296875 GB
    Memory Allocated: 0.5152511596679688  GigaBytes
Max Memory Allocated: 0.515289306640625  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7342529296875 GB
    Memory Allocated: 0.5152511596679688  GigaBytes
Max Memory Allocated: 0.515289306640625  GigaBytes

 h.shape torch.Size([1, 666, 100]), torch.Size([1, 666, 100])
----------------------------------------3
 Nvidia-smi: 1.7342529296875 GB
    Memory Allocated: 0.5157480239868164  GigaBytes
Max Memory Allocated: 0.5157480239868164  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.5344986915588379  GigaBytes
Max Memory Allocated: 0.5357394218444824  GigaBytes

rst.shape  torch.Size([1, 666, 100])
m.shape torch.Size([779, 6, 100])
----------------------------------------1
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.5359916687011719  GigaBytes
Max Memory Allocated: 0.5360445976257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7362060546875 GB
    Memory Allocated: 0.5359916687011719  GigaBytes
Max Memory Allocated: 0.5360445976257324  GigaBytes

 h.shape torch.Size([1, 779, 100]), torch.Size([1, 779, 100])
----------------------------------------3
 Nvidia-smi: 1.7381591796875 GB
    Memory Allocated: 0.5365724563598633  GigaBytes
Max Memory Allocated: 0.5365724563598633  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7615966796875 GB
    Memory Allocated: 0.5617771148681641  GigaBytes
Max Memory Allocated: 0.5635185241699219  GigaBytes

rst.shape  torch.Size([1, 779, 100])
m.shape torch.Size([966, 7, 100])
----------------------------------------1
 Nvidia-smi: 1.7615966796875 GB
    Memory Allocated: 0.5647625923156738  GigaBytes
Max Memory Allocated: 0.5648384094238281  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7615966796875 GB
    Memory Allocated: 0.5647625923156738  GigaBytes
Max Memory Allocated: 0.5648384094238281  GigaBytes

 h.shape torch.Size([1, 966, 100]), torch.Size([1, 966, 100])
----------------------------------------3
 Nvidia-smi: 1.7615966796875 GB
    Memory Allocated: 0.5654826164245605  GigaBytes
Max Memory Allocated: 0.5654826164245605  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.6022906303405762  GigaBytes
Max Memory Allocated: 0.6048097610473633  GigaBytes

rst.shape  torch.Size([1, 966, 100])
m.shape torch.Size([1026, 8, 100])
----------------------------------------1
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.6049885749816895  GigaBytes
Max Memory Allocated: 0.6050810813903809  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.6049885749816895  GigaBytes
Max Memory Allocated: 0.6050810813903809  GigaBytes

 h.shape torch.Size([1, 1026, 100]), torch.Size([1, 1026, 100])
----------------------------------------3
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.6057534217834473  GigaBytes
Max Memory Allocated: 0.6057534217834473  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.6497073173522949  GigaBytes
Max Memory Allocated: 0.6527652740478516  GigaBytes

rst.shape  torch.Size([1, 1026, 100])
m.shape torch.Size([1036, 9, 100])
----------------------------------------1
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.6527986526489258  GigaBytes
Max Memory Allocated: 0.6529030799865723  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8533935546875 GB
    Memory Allocated: 0.6527986526489258  GigaBytes
Max Memory Allocated: 0.6529030799865723  GigaBytes

 h.shape torch.Size([1, 1036, 100]), torch.Size([1, 1036, 100])
----------------------------------------3
 Nvidia-smi: 1.8553466796875 GB
    Memory Allocated: 0.6535711288452148  GigaBytes
Max Memory Allocated: 0.6535711288452148  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9217529296875 GB
    Memory Allocated: 0.7037343978881836  GigaBytes
Max Memory Allocated: 0.7072081565856934  GigaBytes

rst.shape  torch.Size([1, 1036, 100])
m.shape torch.Size([91257, 10, 100])
----------------------------------------1
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 1.0433073043823242  GigaBytes
Max Memory Allocated: 1.0535063743591309  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2635498046875 GB
    Memory Allocated: 1.0433073043823242  GigaBytes
Max Memory Allocated: 1.0535063743591309  GigaBytes

 h.shape torch.Size([1, 91257, 100]), torch.Size([1, 91257, 100])
----------------------------------------3
 Nvidia-smi: 2.3338623046875 GB
    Memory Allocated: 1.1112995147705078  GigaBytes
Max Memory Allocated: 1.1112995147705078  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5506591796875 GB
    Memory Allocated: 5.960776329040527  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 91257, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.5506591796875 GB
    Memory Allocated: 5.607507228851318  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.5506591796875 GB
    Memory Allocated: 5.699809551239014  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.5506591796875 GB
    Memory Allocated: 5.792111873626709  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.5506591796875 GB
    Memory Allocated: 5.699809551239014  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

torch.Size([96786, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.5506591796875 GB
    Memory Allocated: 5.792111873626709  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.5506591796875 GB
    Memory Allocated: 5.815187454223633  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.5506591796875 GB
    Memory Allocated: 5.815187454223633  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.046637535095215  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.046637535095215  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.0466508865356445  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.046757698059082  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.046757221221924  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.046757221221924  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.046762943267822  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.046848773956299  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([12, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.046880722045898  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.046880722045898  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.046903610229492  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.047407150268555  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.047434329986572  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.047434329986572  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.0474534034729  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.048006534576416  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([15, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.048069477081299  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.048069477081299  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.048098087310791  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.04912805557251  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([22, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.049241065979004  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.049241065979004  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.049283027648926  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.051087379455566  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([42, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.05134916305542  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.05134916305542  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 7.5526123046875 GB
    Memory Allocated: 6.051429271697998  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5545654296875 GB
    Memory Allocated: 6.055434703826904  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([27, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.5545654296875 GB
    Memory Allocated: 6.055602550506592  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5545654296875 GB
    Memory Allocated: 6.055602550506592  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 7.5545654296875 GB
    Memory Allocated: 6.055654048919678  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 6.058589458465576  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([40, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 6.058909893035889  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 6.058909893035889  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 7.5565185546875 GB
    Memory Allocated: 6.058986186981201  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5623779296875 GB
    Memory Allocated: 6.063868999481201  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([70, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.5623779296875 GB
    Memory Allocated: 6.0645036697387695  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5623779296875 GB
    Memory Allocated: 6.0645036697387695  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 7.5623779296875 GB
    Memory Allocated: 6.064637184143066  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5721435546875 GB
    Memory Allocated: 6.0741167068481445  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([64, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.5721435546875 GB
    Memory Allocated: 6.074726581573486  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5721435546875 GB
    Memory Allocated: 6.074726581573486  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 7.5721435546875 GB
    Memory Allocated: 6.074848651885986  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5838623046875 GB
    Memory Allocated: 6.084370136260986  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([57, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.5838623046875 GB
    Memory Allocated: 6.084966659545898  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5838623046875 GB
    Memory Allocated: 6.084966659545898  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 7.5838623046875 GB
    Memory Allocated: 6.085075378417969  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5936279296875 GB
    Memory Allocated: 6.094316482543945  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.5936279296875 GB
    Memory Allocated: 6.094811916351318  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5936279296875 GB
    Memory Allocated: 6.094811916351318  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 7.5936279296875 GB
    Memory Allocated: 6.094895839691162  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6014404296875 GB
    Memory Allocated: 6.102616786956787  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([63, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6014404296875 GB
    Memory Allocated: 6.10342264175415  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6014404296875 GB
    Memory Allocated: 6.10342264175415  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 7.6014404296875 GB
    Memory Allocated: 6.103542804718018  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 6.115438938140869  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([52, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 6.116128921508789  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 6.116128921508789  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 7.6151123046875 GB
    Memory Allocated: 6.116228103637695  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 6.126741409301758  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([59, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 6.127599239349365  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 6.127599239349365  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 7.6268310546875 GB
    Memory Allocated: 6.127711772918701  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6405029296875 GB
    Memory Allocated: 6.140428066253662  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6405029296875 GB
    Memory Allocated: 6.141025543212891  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6405029296875 GB
    Memory Allocated: 6.141025543212891  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 7.6405029296875 GB
    Memory Allocated: 6.141101837158203  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6502685546875 GB
    Memory Allocated: 6.150257110595703  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([70, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6502685546875 GB
    Memory Allocated: 6.152066230773926  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6502685546875 GB
    Memory Allocated: 6.152066230773926  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 7.6502685546875 GB
    Memory Allocated: 6.152199745178223  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6658935546875 GB
    Memory Allocated: 6.169156074523926  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([50, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 6.170002460479736  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 6.170002460479736  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 7.6678466796875 GB
    Memory Allocated: 6.170097827911377  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6815185546875 GB
    Memory Allocated: 6.182877063751221  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6815185546875 GB
    Memory Allocated: 6.183732986450195  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6815185546875 GB
    Memory Allocated: 6.183732986450195  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 7.6815185546875 GB
    Memory Allocated: 6.1838226318359375  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6951904296875 GB
    Memory Allocated: 6.196462631225586  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([58, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6951904296875 GB
    Memory Allocated: 6.19760799407959  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6951904296875 GB
    Memory Allocated: 6.19760799407959  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 7.6951904296875 GB
    Memory Allocated: 6.197718620300293  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7108154296875 GB
    Memory Allocated: 6.2140913009643555  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([62, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.7108154296875 GB
    Memory Allocated: 6.2153472900390625  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7108154296875 GB
    Memory Allocated: 6.2153472900390625  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 7.7108154296875 GB
    Memory Allocated: 6.215465545654297  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7283935546875 GB
    Memory Allocated: 6.233795166015625  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([69, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.7283935546875 GB
    Memory Allocated: 6.2352614402771  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7283935546875 GB
    Memory Allocated: 6.2352614402771  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 7.7283935546875 GB
    Memory Allocated: 6.235393047332764  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7498779296875 GB
    Memory Allocated: 6.256713390350342  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([37, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 6.257501125335693  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 6.257501125335693  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 7.7518310546875 GB
    Memory Allocated: 6.257571697235107  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.7635498046875 GB
    Memory Allocated: 6.269498348236084  GigaBytes
Max Memory Allocated: 6.3007354736328125  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([9003, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 6.485983848571777  GigaBytes
Max Memory Allocated: 6.486822605133057  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 6.485983848571777  GigaBytes
Max Memory Allocated: 6.486822605133057  GigaBytes

 h.shape torch.Size([1, 9003, 256]), torch.Size([1, 9003, 256])
----------------------------------------3
 Nvidia-smi: 7.9822998046875 GB
    Memory Allocated: 6.503155708312988  GigaBytes
Max Memory Allocated: 6.503155708312988  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1268310546875 GB
    Memory Allocated: 9.58309268951416  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 9003, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.1268310546875 GB
    Memory Allocated: 9.354601860046387  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.1268310546875 GB
    Memory Allocated: 9.356961250305176  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.1268310546875 GB
    Memory Allocated: 9.359320640563965  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.1268310546875 GB
    Memory Allocated: 9.356886386871338  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

torch.Size([10023, 47])
input nodes number: 96786
output nodes number: 10023
edges number: 240394
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1268310546875 GB
    Memory Allocated: 9.360042095184326  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.1268310546875 GB
    Memory Allocated: 9.360043048858643  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.14778995513916016  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

pseudo mini batch 1 input nodes size: 209103
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.12368345260620117  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.12368345260620117  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.20158052444458008  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.20165538787841797  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.0854191780090332  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.09273576736450195  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.09273576736450195  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

first layer input nodes number: 209103
first layer output nodes number: 77212
edges number: 740740
----------------------------------------before model layer 0
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.09486961364746094  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

torch.Size([209103, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.09486961364746094  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

m.shape torch.Size([151, 1, 100])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.37870311737060547  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.37870311737060547  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 151, 100]), torch.Size([1, 151, 100])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.3788156509399414  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.3797159194946289  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 151, 100])
m.shape torch.Size([248, 2, 100])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.37984466552734375  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.37984466552734375  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 248, 100]), torch.Size([1, 248, 100])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.38002967834472656  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.38280200958251953  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 248, 100])
m.shape torch.Size([451, 3, 100])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.38321399688720703  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.38321399688720703  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 451, 100]), torch.Size([1, 451, 100])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.38355064392089844  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.3909482955932617  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 451, 100])
m.shape torch.Size([864, 4, 100])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.39206743240356445  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.39206743240356445  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 864, 100]), torch.Size([1, 864, 100])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.39271116256713867  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.4120907783508301  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 864, 100])
m.shape torch.Size([1128, 5, 100])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.41387033462524414  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.41387033462524414  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 1128, 100]), torch.Size([1, 1128, 100])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.41471147537231445  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.44497108459472656  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 1128, 100])
m.shape torch.Size([1277, 6, 100])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.4474048614501953  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.4474048614501953  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 1277, 100]), torch.Size([1, 1277, 100])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.44835662841796875  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.4897747039794922  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 1277, 100])
m.shape torch.Size([1431, 7, 100])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.4930305480957031  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.4930305480957031  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 1431, 100]), torch.Size([1, 1431, 100])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.4940967559814453  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.5477466583251953  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 1431, 100])
m.shape torch.Size([1545, 8, 100])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.5518183708190918  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.5518183708190918  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 1545, 100]), torch.Size([1, 1545, 100])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.5529704093933105  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.6186022758483887  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 1545, 100])
m.shape torch.Size([1565, 9, 100])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.6232733726501465  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.6232733726501465  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 1565, 100]), torch.Size([1, 1565, 100])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.6244397163391113  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.7011404037475586  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 1565, 100])
m.shape torch.Size([68552, 10, 100])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.9559335708618164  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 0.9559335708618164  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 68552, 100]), torch.Size([1, 68552, 100])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 1.007009506225586  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.633358001708984  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 68552, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.359188079833984  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.432823181152344  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.506458282470703  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.432823181152344  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

torch.Size([77212, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.506458282470703  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.524867057800293  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.524867057800293  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.757538318634033  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.757538318634033  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.757551670074463  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.757751941680908  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([12, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.757780075073242  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.757780075073242  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.757802963256836  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.758306503295898  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([20, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.7583723068237305  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.7583723068237305  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.758410453796387  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.759516716003418  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.759570121765137  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.759570121765137  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.759598731994629  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.760628700256348  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([31, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.760793209075928  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.760793209075928  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.760852336883545  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.763394832611084  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.763554096221924  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.763554096221924  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.763607501983643  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.76627779006958  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([40, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.766558647155762  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.766558647155762  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.766634941101074  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.770983695983887  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([44, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.771326541900635  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.771326541900635  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.7714104652404785  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.7767815589904785  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([55, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.777268409729004  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.777268409729004  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.777373313903809  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.784821510314941  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.785340309143066  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.785340309143066  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.785443305969238  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.7934770584106445  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([42, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.793910026550293  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.793910026550293  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.793990135192871  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.800799369812012  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.80139684677124  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.80139684677124  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.801494121551514  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.81044340133667  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([48, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.811040878295898  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.811040878295898  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.811132431030273  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.820196151733398  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([65, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.821087837219238  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.821087837219238  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.821211814880371  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.834353446960449  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([65, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.835341453552246  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.835341453552246  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.835465431213379  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.849474906921387  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([59, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.850377082824707  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.850377082824707  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.850489616394043  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.8639936447143555  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([48, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.864768028259277  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.864768028259277  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.864859580993652  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.876486778259277  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([59, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.877559661865234  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.877559661865234  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.87767219543457  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.892751693725586  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([46, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.893579959869385  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.893579959869385  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.893667697906494  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.906038761138916  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.907113552093506  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.907113552093506  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.907216548919678  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.922460079193115  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([58, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.9237494468688965  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.9237494468688965  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.9238600730896  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.941007137298584  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([57, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.942858695983887  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.942858695983887  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.942967414855957  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.960579872131348  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([44, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.961644172668457  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.961644172668457  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 11.5916748046875 GB
    Memory Allocated: 4.961728096008301  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5955810546875 GB
    Memory Allocated: 4.9759111404418945  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([9046, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.5994873046875 GB
    Memory Allocated: 5.193844318389893  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.5994873046875 GB
    Memory Allocated: 5.193844318389893  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 9046, 256]), torch.Size([1, 9046, 256])
----------------------------------------3
 Nvidia-smi: 11.5994873046875 GB
    Memory Allocated: 5.211905002593994  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5994873046875 GB
    Memory Allocated: 8.300370216369629  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 9046, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.5994873046875 GB
    Memory Allocated: 8.070652484893799  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.5994873046875 GB
    Memory Allocated: 8.072929859161377  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.5994873046875 GB
    Memory Allocated: 8.075207233428955  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.5994873046875 GB
    Memory Allocated: 8.072854995727539  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

torch.Size([10048, 47])
input nodes number: 77212
output nodes number: 10048
edges number: 241136
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.5994873046875 GB
    Memory Allocated: 8.073423385620117  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.5994873046875 GB
    Memory Allocated: 8.073423862457275  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.5994873046875 GB
    Memory Allocated: 0.10516500473022461  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

pseudo mini batch 2 input nodes size: 366616
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.5994873046875 GB
    Memory Allocated: 0.08533716201782227  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.5994873046875 GB
    Memory Allocated: 0.08533716201782227  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.5994873046875 GB
    Memory Allocated: 0.22205591201782227  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 11.5994873046875 GB
    Memory Allocated: 0.22212743759155273  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.5994873046875 GB
    Memory Allocated: 0.14415550231933594  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.5994873046875 GB
    Memory Allocated: 0.15294456481933594  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.5994873046875 GB
    Memory Allocated: 0.15294456481933594  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

first layer input nodes number: 366616
first layer output nodes number: 97527
edges number: 959342
----------------------------------------before model layer 0
 Nvidia-smi: 11.5994873046875 GB
    Memory Allocated: 0.1564030647277832  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

torch.Size([366616, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.5994873046875 GB
    Memory Allocated: 0.1564030647277832  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

m.shape torch.Size([134, 1, 100])
----------------------------------------1
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5241618156433105  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5241618156433105  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 134, 100]), torch.Size([1, 134, 100])
----------------------------------------3
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5242619514465332  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5250616073608398  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 134, 100])
m.shape torch.Size([234, 2, 100])
----------------------------------------1
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5251860618591309  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5251860618591309  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 234, 100]), torch.Size([1, 234, 100])
----------------------------------------3
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5253605842590332  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5279784202575684  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 234, 100])
m.shape torch.Size([347, 3, 100])
----------------------------------------1
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5282793045043945  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5282793045043945  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 347, 100]), torch.Size([1, 347, 100])
----------------------------------------3
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.528538703918457  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5342326164245605  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 347, 100])
m.shape torch.Size([435, 4, 100])
----------------------------------------1
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5347514152526855  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5347514152526855  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 435, 100]), torch.Size([1, 435, 100])
----------------------------------------3
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5350756645202637  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5444788932800293  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 435, 100])
m.shape torch.Size([475, 5, 100])
----------------------------------------1
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5452017784118652  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5452017784118652  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 475, 100]), torch.Size([1, 475, 100])
----------------------------------------3
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5455565452575684  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5583066940307617  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 475, 100])
m.shape torch.Size([480, 6, 100])
----------------------------------------1
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5592021942138672  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5592021942138672  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 480, 100]), torch.Size([1, 480, 100])
----------------------------------------3
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5595598220825195  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5749378204345703  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 480, 100])
m.shape torch.Size([604, 7, 100])
----------------------------------------1
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5763344764709473  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5763344764709473  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 604, 100]), torch.Size([1, 604, 100])
----------------------------------------3
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.576784610748291  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.5992913246154785  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 604, 100])
m.shape torch.Size([570, 8, 100])
----------------------------------------1
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.6007652282714844  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.6007652282714844  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 570, 100]), torch.Size([1, 570, 100])
----------------------------------------3
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.6011905670166016  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.6254119873046875  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 570, 100])
m.shape torch.Size([564, 9, 100])
----------------------------------------1
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.6270904541015625  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.6270904541015625  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 564, 100]), torch.Size([1, 564, 100])
----------------------------------------3
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.6275110244750977  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 0.6544146537780762  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 564, 100])
m.shape torch.Size([93684, 10, 100])
----------------------------------------1
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 1.0032048225402832  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 1.0032048225402832  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 93684, 100]), torch.Size([1, 93684, 100])
----------------------------------------3
 Nvidia-smi: 11.9569091796875 GB
    Memory Allocated: 1.0735173225402832  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.034963130950928  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 93684, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 5.676636219024658  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 5.7696452140808105  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 5.862654209136963  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 5.7696452140808105  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

torch.Size([97527, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 5.862654209136963  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 5.8868327140808105  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 5.8868327140808105  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.098936557769775  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.098936557769775  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.098949909210205  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.099056720733643  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([24, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.099096298217773  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.099096298217773  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.099142074584961  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.099828720092773  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([68, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.100002288818359  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.100002288818359  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.100131988525391  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.102985382080078  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([84, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.103243827819824  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.103243827819824  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.1034040451049805  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.108050346374512  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([84, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.108374118804932  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.108374118804932  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.108534336090088  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.114302158355713  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([74, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.114648818969727  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.114648818969727  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.114789962768555  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.120859146118164  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([117, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.121575832366943  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.121575832366943  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 117, 256]), torch.Size([1, 117, 256])
----------------------------------------3
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.121798992156982  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.1329569816589355  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 117, 256])
m.shape torch.Size([69, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.133376121520996  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.133376121520996  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.13350772857666  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.141009330749512  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([39, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.1412811279296875  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.1412811279296875  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.141355514526367  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.146116256713867  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([54, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.1465983390808105  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.1465983390808105  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.146701335906982  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.1540141105651855  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([67, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.1546711921691895  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.1546711921691895  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.154798984527588  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.164766788482666  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([39, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.1651530265808105  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.1651530265808105  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.16522741317749  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.171550273895264  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([66, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.172338008880615  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.172338008880615  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.172463893890381  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.184045314788818  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([124, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.1856513023376465  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.1856513023376465  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.185887813568115  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.2093024253845215  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.20967435836792  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.20967435836792  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.2097392082214355  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.216613292694092  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([76, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.21774959564209  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.21774959564209  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.217894554138184  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.234274864196777  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.235052108764648  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.235052108764648  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.235151290893555  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.247053146362305  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([72, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.248713493347168  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.248713493347168  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 15.4002685546875 GB
    Memory Allocated: 6.2488508224487305  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4119873046875 GB
    Memory Allocated: 6.266291618347168  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.4119873046875 GB
    Memory Allocated: 6.266697883605957  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4119873046875 GB
    Memory Allocated: 6.266697883605957  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 15.4119873046875 GB
    Memory Allocated: 6.26674747467041  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4197998046875 GB
    Memory Allocated: 6.273392677307129  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([51, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.4197998046875 GB
    Memory Allocated: 6.274348258972168  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4197998046875 GB
    Memory Allocated: 6.274348258972168  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 15.4197998046875 GB
    Memory Allocated: 6.274445533752441  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 6.288161277770996  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([44, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 6.289000988006592  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 6.289000988006592  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 15.4354248046875 GB
    Memory Allocated: 6.2890849113464355  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4471435546875 GB
    Memory Allocated: 6.3015055656433105  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([50, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.4471435546875 GB
    Memory Allocated: 6.302521228790283  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4471435546875 GB
    Memory Allocated: 6.302521228790283  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 15.4471435546875 GB
    Memory Allocated: 6.302616596221924  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4627685546875 GB
    Memory Allocated: 6.317398548126221  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([56, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.4627685546875 GB
    Memory Allocated: 6.318589210510254  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4627685546875 GB
    Memory Allocated: 6.318589210510254  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 15.4627685546875 GB
    Memory Allocated: 6.318696022033691  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4803466796875 GB
    Memory Allocated: 6.335999488830566  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([93, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.4803466796875 GB
    Memory Allocated: 6.3380913734436035  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4803466796875 GB
    Memory Allocated: 6.3380913734436035  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 15.4803466796875 GB
    Memory Allocated: 6.338268756866455  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5096435546875 GB
    Memory Allocated: 6.368246555328369  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([8072, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.5135498046875 GB
    Memory Allocated: 6.562113285064697  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5135498046875 GB
    Memory Allocated: 6.562113285064697  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 8072, 256]), torch.Size([1, 8072, 256])
----------------------------------------3
 Nvidia-smi: 15.5135498046875 GB
    Memory Allocated: 6.57750940322876  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 9.287647724151611  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 8072, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 9.078773021697998  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 9.080443859100342  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 9.082908153533936  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 9.081165790557861  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

torch.Size([9542, 47])
input nodes number: 97527
output nodes number: 9542
edges number: 220284
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 9.081357479095459  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7069091796875 GB
    Memory Allocated: 9.081357955932617  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.1680140495300293  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

pseudo mini batch 3 input nodes size: 295724
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.14354896545410156  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.14354896545410156  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.25371503829956055  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.253786563873291  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.11699628829956055  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.12431097030639648  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.12431097030639648  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

first layer input nodes number: 295724
first layer output nodes number: 77890
edges number: 765089
----------------------------------------before model layer 0
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.12735605239868164  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

torch.Size([295724, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.12735605239868164  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

m.shape torch.Size([143, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.4204578399658203  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.4204578399658203  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 143, 100]), torch.Size([1, 143, 100])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.4205646514892578  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.4214177131652832  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 143, 100])
m.shape torch.Size([163, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.42148590087890625  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.42148590087890625  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 163, 100]), torch.Size([1, 163, 100])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.42160797119140625  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.4234333038330078  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 163, 100])
m.shape torch.Size([301, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.4237089157104492  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.4237089157104492  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 301, 100]), torch.Size([1, 301, 100])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.4239339828491211  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.42887258529663086  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 301, 100])
m.shape torch.Size([337, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.429262638092041  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.429262638092041  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 337, 100]), torch.Size([1, 337, 100])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.42951440811157227  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.43680429458618164  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 337, 100])
m.shape torch.Size([376, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.4373788833618164  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.4373788833618164  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 376, 100]), torch.Size([1, 376, 100])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.43765926361083984  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.44774580001831055  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 376, 100])
m.shape torch.Size([460, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.4489259719848633  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.4489259719848633  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 460, 100]), torch.Size([1, 460, 100])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.44926929473876953  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.46401500701904297  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 460, 100])
m.shape torch.Size([567, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.46532201766967773  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.46532201766967773  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 567, 100]), torch.Size([1, 567, 100])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.4657444953918457  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.48686838150024414  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 567, 100])
m.shape torch.Size([534, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.4882488250732422  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.4882488250732422  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 534, 100]), torch.Size([1, 534, 100])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.4886474609375  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.5113353729248047  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 534, 100])
m.shape torch.Size([602, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.5131545066833496  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.5131545066833496  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 602, 100]), torch.Size([1, 602, 100])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.513603687286377  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.542325496673584  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 602, 100])
m.shape torch.Size([74407, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.8192887306213379  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.8192887306213379  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 74407, 100]), torch.Size([1, 74407, 100])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 0.8747267723083496  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.8107991218566895  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 74407, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.525618076324463  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.599899768829346  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.6741814613342285  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.599899768829346  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

torch.Size([77890, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.6741814613342285  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.6937127113342285  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.6937127113342285  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

m.shape torch.Size([20, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.902223110198975  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.902223110198975  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.902261257171631  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.902566432952881  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.9025726318359375  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.9025726318359375  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.902597427368164  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.9029693603515625  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([58, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.9031243324279785  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.9031243324279785  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.903234958648682  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.90566873550415  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([61, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.905848026275635  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.905848026275635  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.905964374542236  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.909338474273682  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([58, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.90955924987793  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.90955924987793  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.909669876098633  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.913652420043945  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([88, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.91410493850708  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.91410493850708  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.914272785186768  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.92149019241333  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([144, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.922375202178955  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.922375202178955  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 144, 256]), torch.Size([1, 144, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.92264986038208  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.93638277053833  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 144, 256])
m.shape torch.Size([64, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.936737537384033  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.936737537384033  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.936859607696533  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.943817615509033  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([120, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.944794654846191  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.944794654846191  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.945023536682129  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.959671974182129  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([138, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.960884094238281  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.960884094238281  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.961147308349609  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.979835510253906  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([97, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.980729579925537  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.980729579925537  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.98091459274292  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.995345592498779  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([101, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.996417999267578  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.996417999267578  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 4.996610641479492  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.0129852294921875  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([68, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.013738632202148  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.013738632202148  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.01386833190918  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.025800704956055  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([105, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.027148723602295  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.027148723602295  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.02734899520874  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.047175884246826  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([156, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.049324989318848  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.049324989318848  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 156, 256]), torch.Size([1, 156, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.049622535705566  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.081162452697754  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 156, 256])
m.shape torch.Size([76, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.083071231842041  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.083071231842041  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.083216190338135  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.0995965003967285  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([56, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.100439071655273  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.100439071655273  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.100545883178711  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.113363265991211  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([55, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.114261627197266  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.114261627197266  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.11436653137207  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.127689361572266  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([71, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.128933906555176  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.128933906555176  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.1290693283081055  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.147215843200684  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([56, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.148226737976074  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.148226737976074  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.148333549499512  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.163393974304199  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([58, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.164511680603027  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.164511680603027  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.1646223068237305  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.180994987487793  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([42, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.181828022003174  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.181828022003174  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 15.9197998046875 GB
    Memory Allocated: 5.181908130645752  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9256591796875 GB
    Memory Allocated: 5.194324970245361  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([79, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.9256591796875 GB
    Memory Allocated: 5.19603157043457  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9256591796875 GB
    Memory Allocated: 5.19603157043457  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 15.9256591796875 GB
    Memory Allocated: 5.1961822509765625  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9490966796875 GB
    Memory Allocated: 5.220592498779297  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([61, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.9490966796875 GB
    Memory Allocated: 5.221988201141357  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9490966796875 GB
    Memory Allocated: 5.221988201141357  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 15.9490966796875 GB
    Memory Allocated: 5.222104549407959  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9686279296875 GB
    Memory Allocated: 5.241767406463623  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([7730, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 5.4274468421936035  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 5.4274468421936035  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 7730, 256]), torch.Size([1, 7730, 256])
----------------------------------------3
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 5.442321300506592  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 8.038537502288818  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 7730, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 7.833598613739014  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 7.8352885246276855  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 7.836965084075928  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 7.835203647613525  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

torch.Size([9575, 47])
input nodes number: 77890
output nodes number: 9575
edges number: 216535
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 7.835875034332275  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.9725341796875 GB
    Memory Allocated: 7.835875511169434  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.1375722885131836  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

pseudo mini batch 4 input nodes size: 344956
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.11701536178588867  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.11701536178588867  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.24552154541015625  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.24559307098388672  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.13535547256469727  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.1440291404724121  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.1440291404724121  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

first layer input nodes number: 344956
first layer output nodes number: 94395
edges number: 933218
----------------------------------------before model layer 0
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.14730262756347656  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

torch.Size([344956, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.14730262756347656  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

m.shape torch.Size([107, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5047693252563477  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5047693252563477  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 107, 100]), torch.Size([1, 107, 100])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5048494338989258  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5054888725280762  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 107, 100])
m.shape torch.Size([167, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5055732727050781  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5055732727050781  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 167, 100]), torch.Size([1, 167, 100])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5056982040405273  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5075664520263672  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 167, 100])
m.shape torch.Size([260, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5077948570251465  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5077948570251465  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 260, 100]), torch.Size([1, 260, 100])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5079894065856934  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5122566223144531  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 260, 100])
m.shape torch.Size([264, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5125527381896973  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5125527381896973  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 264, 100]), torch.Size([1, 264, 100])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5127501487731934  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5184578895568848  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 264, 100])
m.shape torch.Size([266, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.518855094909668  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.518855094909668  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 266, 100]), torch.Size([1, 266, 100])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5190534591674805  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5261945724487305  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 266, 100])
m.shape torch.Size([342, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.526860237121582  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.526860237121582  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 342, 100]), torch.Size([1, 342, 100])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5271158218383789  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5380802154541016  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 342, 100])
m.shape torch.Size([377, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5392117500305176  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5392117500305176  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 377, 100]), torch.Size([1, 377, 100])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5394930839538574  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5535497665405273  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 377, 100])
m.shape torch.Size([375, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5553674697875977  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5553674697875977  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 375, 100]), torch.Size([1, 375, 100])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5556468963623047  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5715742111206055  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 375, 100])
m.shape torch.Size([450, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.573582649230957  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.573582649230957  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 450, 100]), torch.Size([1, 450, 100])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.573918342590332  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.5953898429870605  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 450, 100])
m.shape torch.Size([91787, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.9371552467346191  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.9371552467346191  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 91787, 100]), torch.Size([1, 91787, 100])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 1.0074677467346191  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.88411283493042  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 91787, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.53373908996582  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.623761177062988  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.713783264160156  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.623761177062988  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

torch.Size([94395, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.713783264160156  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.736289024353027  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.736289024353027  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.958503246307373  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.958503246307373  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.958516597747803  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.95862340927124  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([12, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.958640098571777  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.958640098571777  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.958662986755371  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.959006309509277  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([41, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.959113121032715  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.959113121032715  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.95919132232666  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.960911750793457  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([27, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.960976600646973  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.960976600646973  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.961028099060059  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.962521553039551  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([13, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.962558746337891  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.962558746337891  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.962583541870117  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.963476181030273  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([39, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.963688850402832  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.963688850402832  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.963763236999512  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.966961860656738  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([27, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.967106342315674  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.967106342315674  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.96715784072876  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.969732761383057  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([9, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.969776630401611  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.969776630401611  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.969793796539307  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.9707722663879395  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([31, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.97103214263916  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.97103214263916  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.971091270446777  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.974875450134277  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([17, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.975009441375732  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.975009441375732  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.97504186630249  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.977344036102295  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.977529048919678  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.977529048919678  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.977565288543701  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.980391979217529  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([37, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.980800628662109  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.980800628662109  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.980871200561523  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.986869812011719  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.987259387969971  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.987259387969971  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.987324237823486  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.993290424346924  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([20, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.993527412414551  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.993527412414551  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.993565559387207  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.997342109680176  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([38, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.997870922088623  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.997870922088623  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 5.99794340133667  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.005626201629639  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.006020545959473  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.006020545959473  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.006073951721191  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.01210880279541  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.012327194213867  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.012327194213867  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.012355804443359  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.015789031982422  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([47, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.01658821105957  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.01658821105957  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.0166778564453125  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.02806282043457  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.028602600097656  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.028602600097656  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.028663635253906  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.036842346191406  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([67, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.038099765777588  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.038099765777588  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.038227558135986  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.056246280670166  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([51, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.057211875915527  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.057211875915527  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.057309150695801  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.0717058181762695  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([40, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.072503089904785  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.072503089904785  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.072579383850098  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.084404945373535  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.08509635925293  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.08509635925293  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.0851593017578125  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.095355987548828  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([48, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.096706867218018  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.096706867218018  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.096798419952393  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.112270832061768  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([8809, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.323889255523682  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.323889255523682  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 8809, 256]), torch.Size([1, 8809, 256])
----------------------------------------3
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 6.340691089630127  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 9.297973155975342  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 8809, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 9.078363418579102  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 9.080392360687256  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 9.0820631980896  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 9.079962730407715  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

torch.Size([9541, 47])
input nodes number: 94395
output nodes number: 9541
edges number: 230800
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 9.081076622009277  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 9.081077098846436  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.15955018997192383  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

pseudo mini batch 5 input nodes size: 320222
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.1356945037841797  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.1356945037841797  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.2549867630004883  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.25506162643432617  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.12648391723632812  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.13566207885742188  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.13566207885742188  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

first layer input nodes number: 320222
first layer output nodes number: 100111
edges number: 984948
----------------------------------------before model layer 0
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.1387944221496582  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

torch.Size([320222, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.9744873046875 GB
    Memory Allocated: 0.1387944221496582  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

m.shape torch.Size([139, 1, 100])
----------------------------------------1
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5163626670837402  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5163626670837402  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 139, 100]), torch.Size([1, 139, 100])
----------------------------------------3
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5164666175842285  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5172967910766602  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 139, 100])
m.shape torch.Size([234, 2, 100])
----------------------------------------1
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5174193382263184  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5174193382263184  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 234, 100]), torch.Size([1, 234, 100])
----------------------------------------3
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5175938606262207  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5202116966247559  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 234, 100])
m.shape torch.Size([295, 3, 100])
----------------------------------------1
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5204544067382812  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5204544067382812  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 295, 100]), torch.Size([1, 295, 100])
----------------------------------------3
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5206747055053711  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5255126953125  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 295, 100])
m.shape torch.Size([411, 4, 100])
----------------------------------------1
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5260152816772461  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5260152816772461  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 411, 100]), torch.Size([1, 411, 100])
----------------------------------------3
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5263223648071289  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5352106094360352  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 411, 100])
m.shape torch.Size([511, 5, 100])
----------------------------------------1
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5360093116760254  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5360093116760254  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 511, 100]), torch.Size([1, 511, 100])
----------------------------------------3
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5363907814025879  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5501022338867188  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 511, 100])
m.shape torch.Size([591, 6, 100])
----------------------------------------1
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5512328147888184  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5512328147888184  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 591, 100]), torch.Size([1, 591, 100])
----------------------------------------3
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.551673412322998  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.570610523223877  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 591, 100])
m.shape torch.Size([575, 7, 100])
----------------------------------------1
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5721149444580078  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5721149444580078  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 575, 100]), torch.Size([1, 575, 100])
----------------------------------------3
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5725440979003906  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5939717292785645  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 575, 100])
m.shape torch.Size([626, 8, 100])
----------------------------------------1
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5956230163574219  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5956230163574219  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 626, 100]), torch.Size([1, 626, 100])
----------------------------------------3
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.5960903167724609  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.6226921081542969  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 626, 100])
m.shape torch.Size([612, 9, 100])
----------------------------------------1
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.6245107650756836  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.6245107650756836  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 612, 100]), torch.Size([1, 612, 100])
----------------------------------------3
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.6249675750732422  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.6541647911071777  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 612, 100])
m.shape torch.Size([96117, 10, 100])
----------------------------------------1
 Nvidia-smi: 16.7010498046875 GB
    Memory Allocated: 1.012000560760498  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.7010498046875 GB
    Memory Allocated: 1.012000560760498  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 96117, 100]), torch.Size([1, 96117, 100])
----------------------------------------3
 Nvidia-smi: 16.7010498046875 GB
    Memory Allocated: 1.0836138725280762  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.168139934539795  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 96117, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 5.800566673278809  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 5.896039962768555  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 5.991513252258301  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 5.896039962768555  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

torch.Size([100111, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 5.991513252258301  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.016348838806152  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.016348838806152  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.25404691696167  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.25404691696167  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.254048824310303  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.254064083099365  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.254067420959473  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.254067420959473  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.254071235656738  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.254128456115723  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.254147052764893  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.254147052764893  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.254160404205322  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.254454135894775  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([13, 4, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.254497528076172  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.254497528076172  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.254522323608398  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.255241394042969  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 5, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.255291938781738  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.255291938781738  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.255316734313965  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.256209373474121  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.256231784820557  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.256231784820557  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.2562432289123535  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.256735324859619  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([13, 7, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.25681734085083  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.25681734085083  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.256842136383057  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.258081912994385  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 8, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.258184909820557  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.258184909820557  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.258213520050049  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.2598443031311035  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 9, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.259951114654541  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.259951114654541  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.2599778175354  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.2616868019104  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([20, 10, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.261866092681885  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.261866092681885  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.261904239654541  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.264612674713135  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([14, 11, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.264741897583008  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.264741897583008  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.264768600463867  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.266851425170898  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 12, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.267057418823242  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.267057418823242  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.267093658447266  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.270174026489258  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([11, 13, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.270293712615967  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.270293712615967  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.270314693450928  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.272244930267334  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 14, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.272423267364502  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.272423267364502  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.272449970245361  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.2750935554504395  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([8, 15, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.275195598602295  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.275195598602295  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.275210857391357  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.276828289031982  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([19, 16, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.27711296081543  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.27711296081543  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.277149200439453  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.281244277954102  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 17, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.281438827514648  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.281438827514648  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.281463623046875  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.2844390869140625  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 18, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.284703731536865  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.284703731536865  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.28473424911499  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.288609981536865  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.288923740386963  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.288923740386963  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.2889580726623535  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.293558597564697  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.2939839363098145  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.2939839363098145  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.294027805328369  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.30021333694458  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.300474166870117  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.300474166870117  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.300500869750977  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.304452896118164  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.3048624992370605  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.3048624992370605  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.304900646209717  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.3108134269714355  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.311192512512207  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.311192512512207  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.311226844787598  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.316788673400879  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.317440509796143  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.317440509796143  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.317495822906494  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.326843738555908  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([9675, 25, 256])
----------------------------------------1
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.559288501739502  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.559288501739502  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

 h.shape torch.Size([1, 9675, 256]), torch.Size([1, 9675, 256])
----------------------------------------3
 Nvidia-smi: 19.0838623046875 GB
    Memory Allocated: 6.578354358673096  GigaBytes
Max Memory Allocated: 9.79793643951416  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 9.826574802398682  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 9675, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 9.5919828414917  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 9.59373664855957  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 9.595490455627441  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 9.593661785125732  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

torch.Size([10015, 47])
input nodes number: 100111
output nodes number: 10015
edges number: 246891
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 9.595038414001465  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 9.595038890838623  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.5526123046875 GB
    Memory Allocated: 0.15197324752807617  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

pseudo mini batch 6 input nodes size: 338558
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.5526123046875 GB
    Memory Allocated: 0.12703943252563477  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.5526123046875 GB
    Memory Allocated: 0.12703943252563477  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.5526123046875 GB
    Memory Allocated: 0.2531623840332031  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 19.5526123046875 GB
    Memory Allocated: 0.2532382011413574  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.5526123046875 GB
    Memory Allocated: 0.13387107849121094  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.5526123046875 GB
    Memory Allocated: 0.14375829696655273  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5526123046875 GB
    Memory Allocated: 0.14375829696655273  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

first layer input nodes number: 338558
first layer output nodes number: 105853
edges number: 1049813
----------------------------------------before model layer 0
 Nvidia-smi: 19.5526123046875 GB
    Memory Allocated: 0.14706945419311523  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

torch.Size([338558, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.5526123046875 GB
    Memory Allocated: 0.14706945419311523  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

m.shape torch.Size([137, 1, 100])
----------------------------------------1
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5491924285888672  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5491924285888672  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 137, 100]), torch.Size([1, 137, 100])
----------------------------------------3
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5492954254150391  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5501151084899902  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 137, 100])
m.shape torch.Size([167, 2, 100])
----------------------------------------1
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5501880645751953  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5501880645751953  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 167, 100]), torch.Size([1, 167, 100])
----------------------------------------3
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5503129959106445  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5521812438964844  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 167, 100])
m.shape torch.Size([154, 3, 100])
----------------------------------------1
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5522909164428711  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5522909164428711  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 154, 100]), torch.Size([1, 154, 100])
----------------------------------------3
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5524063110351562  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.554936408996582  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 154, 100])
m.shape torch.Size([195, 4, 100])
----------------------------------------1
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5551695823669434  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5551695823669434  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 195, 100]), torch.Size([1, 195, 100])
----------------------------------------3
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5553154945373535  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5595355033874512  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 195, 100])
m.shape torch.Size([225, 5, 100])
----------------------------------------1
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5598816871643066  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5598816871643066  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 225, 100]), torch.Size([1, 225, 100])
----------------------------------------3
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5600495338439941  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5660920143127441  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 225, 100])
m.shape torch.Size([245, 6, 100])
----------------------------------------1
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5665559768676758  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5665559768676758  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 245, 100]), torch.Size([1, 245, 100])
----------------------------------------3
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5667390823364258  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5745954513549805  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 245, 100])
m.shape torch.Size([293, 7, 100])
----------------------------------------1
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5752682685852051  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5752682685852051  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 293, 100]), torch.Size([1, 293, 100])
----------------------------------------3
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5754866600036621  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5864062309265137  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 293, 100])
m.shape torch.Size([290, 8, 100])
----------------------------------------1
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5871615409851074  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5871615409851074  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 290, 100]), torch.Size([1, 290, 100])
----------------------------------------3
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5873780250549316  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.5997061729431152  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 290, 100])
m.shape torch.Size([336, 9, 100])
----------------------------------------1
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.6010899543762207  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.6010899543762207  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 336, 100]), torch.Size([1, 336, 100])
----------------------------------------3
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.6013407707214355  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9471435546875 GB
    Memory Allocated: 0.6173672676086426  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 336, 100])
m.shape torch.Size([103811, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.3358154296875 GB
    Memory Allocated: 1.0039682388305664  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.3358154296875 GB
    Memory Allocated: 1.0039682388305664  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 103811, 100]), torch.Size([1, 103811, 100])
----------------------------------------3
 Nvidia-smi: 20.3358154296875 GB
    Memory Allocated: 1.0813140869140625  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.573225975036621  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 103811, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.180917739868164  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.281867027282715  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.382816314697266  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.281867027282715  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

torch.Size([105853, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.382816314697266  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.408053874969482  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.408053874969482  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.650427341461182  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.650427341461182  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.650434970855713  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.650656223297119  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.65067195892334  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.65067195892334  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.650679588317871  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.650954246520996  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.650968074798584  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.650968074798584  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.650973796844482  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.651219844818115  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.651230812072754  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.651230812072754  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.6512346267700195  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.651425361633301  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.65144681930542  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.65144681930542  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.651452541351318  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.651778697967529  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 9, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.651836395263672  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.651836395263672  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.651849746704102  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.652704238891602  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 10, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.652755260467529  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.652755260467529  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.652766704559326  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.653579235076904  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 11, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.653615951538086  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.653615951538086  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.653623580932617  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.654218673706055  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 12, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.6543073654174805  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.6543073654174805  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.654322624206543  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.6556196212768555  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 13, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.65572452545166  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.65572452545166  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.6557416915893555  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.657320976257324  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([4, 14, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.6573662757873535  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.6573662757873535  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.657373905181885  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.6581292152404785  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([10, 15, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.658269882202148  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.658269882202148  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.658288955688477  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.660310745239258  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([5, 16, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.660378456115723  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.660378456115723  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.660387992858887  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.661465644836426  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 17, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.6615753173828125  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.6615753173828125  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.661588668823242  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.663190841674805  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 18, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.663340091705322  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.663340091705322  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.663357257843018  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.665537357330322  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 19, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.665657043457031  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.665657043457031  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.665670394897461  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.667459487915039  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 20, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.667568206787109  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.667568206787109  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.667579650878906  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.669193267822266  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.6693291664123535  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.6693291664123535  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.669342517852783  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.671318531036377  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.671502590179443  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.671502590179443  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.671519756317139  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.674180507659912  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.674348831176758  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.674348831176758  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.67436408996582  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.676836013793945  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.677059173583984  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.677059173583984  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.6770782470703125  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.680301666259766  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9987, 25, 256])
----------------------------------------1
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.920346260070801  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.920346260070801  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

 h.shape torch.Size([1, 9987, 256]), torch.Size([1, 9987, 256])
----------------------------------------3
 Nvidia-smi: 21.6619873046875 GB
    Memory Allocated: 6.939394950866699  GigaBytes
Max Memory Allocated: 10.057244777679443  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9002685546875 GB
    Memory Allocated: 10.30371904373169  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 9987, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.9002685546875 GB
    Memory Allocated: 10.063070297241211  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.9002685546875 GB
    Memory Allocated: 10.064866542816162  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 21.9002685546875 GB
    Memory Allocated: 10.067075252532959  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 21.9002685546875 GB
    Memory Allocated: 10.065203189849854  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([10119, 47])
input nodes number: 105853
output nodes number: 10119
edges number: 251736
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.9002685546875 GB
    Memory Allocated: 10.065279483795166  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.9002685546875 GB
    Memory Allocated: 10.065279960632324  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1595463752746582  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

pseudo mini batch 7 input nodes size: 233373
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.13308286666870117  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.13308286666870117  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.22002124786376953  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.22009658813476562  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.09389781951904297  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10239791870117188  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10239791870117188  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

first layer input nodes number: 233373
first layer output nodes number: 89774
edges number: 889668
----------------------------------------before model layer 0
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10480594635009766  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([233373, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10480594635009766  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([88, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.44558000564575195  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.44558000564575195  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 88, 100]), torch.Size([1, 88, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.445645809173584  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4461708068847656  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 88, 100])
m.shape torch.Size([142, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4462437629699707  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4462437629699707  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 142, 100]), torch.Size([1, 142, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4463496208190918  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4479374885559082  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 142, 100])
m.shape torch.Size([148, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.44805002212524414  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.44805002212524414  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 148, 100]), torch.Size([1, 148, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.44816064834594727  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4505901336669922  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 148, 100])
m.shape torch.Size([201, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4508347511291504  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4508347511291504  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 201, 100]), torch.Size([1, 201, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4509854316711426  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4553380012512207  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 201, 100])
m.shape torch.Size([227, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4556856155395508  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4556856155395508  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 227, 100]), torch.Size([1, 227, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4558553695678711  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.46195220947265625  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 227, 100])
m.shape torch.Size([238, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4623994827270508  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4623994827270508  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 238, 100]), torch.Size([1, 238, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.46257686614990234  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.47020435333251953  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 238, 100])
m.shape torch.Size([272, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4708251953125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4708251953125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 272, 100]), torch.Size([1, 272, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.47102832794189453  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.48116493225097656  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 272, 100])
m.shape torch.Size([334, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4820590019226074  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4820590019226074  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 334, 100]), torch.Size([1, 334, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.48230791091918945  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.49649572372436523  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 334, 100])
m.shape torch.Size([331, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4974813461303711  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4974813461303711  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 331, 100]), torch.Size([1, 331, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4977283477783203  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5135235786437988  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 331, 100])
m.shape torch.Size([87793, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.8404545783996582  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.8404545783996582  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 87793, 100]), torch.Size([1, 87793, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.9058661460876465  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.550058841705322  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 87793, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.217686176300049  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3033013343811035  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.388916492462158  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3033013343811035  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([89774, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.388916492462158  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.410320281982422  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.410320281982422  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.652831554412842  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.652831554412842  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.652833461761475  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.652848720550537  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.6528520584106445  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.6528520584106445  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.65285587310791  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.6529130935668945  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.652914524078369  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.652914524078369  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.652916431427002  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.652958393096924  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.652961730957031  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.652961730957031  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.652963638305664  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.653018951416016  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.653025150299072  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.653025150299072  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.653027057647705  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.653122425079346  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.653129577636719  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.653129577636719  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.653131484985352  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.653240203857422  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.653265476226807  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.653265476226807  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.653271198272705  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.653637409210205  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.653676986694336  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.653676986694336  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.653684616088867  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.654279708862305  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.654310703277588  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.654310703277588  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.654316425323486  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.6548027992248535  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.654837608337402  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.654837608337402  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.654843330383301  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.655369758605957  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.655447959899902  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.655447959899902  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.655459403991699  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.65659236907959  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.656644344329834  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.656644344329834  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.656651973724365  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.657460689544678  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.657503128051758  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.657503128051758  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.657508850097656  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.65815544128418  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.658187389373779  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.658187389373779  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.658191204071045  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.658675670623779  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.658783435821533  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.658783435821533  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.65879487991333  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.660328388214111  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([1, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.660342216491699  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.660342216491699  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.660344123840332  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.660613059997559  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.660713195800781  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.660713195800781  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.660722732543945  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.662134170532227  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.662214279174805  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.662214279174805  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.662221908569336  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.66340446472168  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.663533687591553  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.663533687591553  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.66354513168335  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.665399074554443  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.665647506713867  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.665647506713867  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.665668487548828  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.669214248657227  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([9999, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.910048961639404  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.910048961639404  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 9999, 256]), torch.Size([1, 9999, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.9291205406188965  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.296750545501709  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 9999, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.056300163269043  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.058750629425049  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.061201095581055  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.058675289154053  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([10067, 47])
input nodes number: 89774
output nodes number: 10067
edges number: 251105
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.060073852539062  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.06007432937622  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.11728286743164062  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

pseudo mini batch 8 input nodes size: 321286
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.09455204010009766  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.09455204010009766  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.21424055099487305  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.21431350708007812  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.12729978561401367  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.13646364212036133  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.13646364212036133  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

first layer input nodes number: 321286
first layer output nodes number: 99609
edges number: 986547
----------------------------------------before model layer 0
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.13960027694702148  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([321286, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.13960027694702148  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([111, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5174870491027832  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5174870491027832  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 111, 100]), torch.Size([1, 111, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5175700187683105  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5182323455810547  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 111, 100])
m.shape torch.Size([162, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5183119773864746  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5183119773864746  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 162, 100]), torch.Size([1, 162, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5184330940246582  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5202469825744629  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 162, 100])
m.shape torch.Size([186, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5203943252563477  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5203943252563477  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 186, 100]), torch.Size([1, 186, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.520533561706543  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5235881805419922  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 186, 100])
m.shape torch.Size([187, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5237975120544434  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5237975120544434  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 187, 100]), torch.Size([1, 187, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5239377021789551  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5279860496520996  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 187, 100])
m.shape torch.Size([286, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5284490585327148  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5284490585327148  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 286, 100]), torch.Size([1, 286, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5286626815795898  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5363388061523438  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 286, 100])
m.shape torch.Size([265, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5368247032165527  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5368247032165527  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 265, 100]), torch.Size([1, 265, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5370230674743652  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5455269813537598  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 265, 100])
m.shape torch.Size([363, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5463747978210449  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5463747978210449  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 363, 100]), torch.Size([1, 363, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5466456413269043  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5601778030395508  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 363, 100])
m.shape torch.Size([386, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5611968040466309  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5611968040466309  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 386, 100]), torch.Size([1, 386, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5614848136901855  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5778899192810059  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 386, 100])
m.shape torch.Size([473, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5793318748474121  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5793318748474121  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 473, 100]), torch.Size([1, 473, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5796847343444824  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.6022548675537109  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 473, 100])
m.shape torch.Size([97190, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.964139461517334  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.964139461517334  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 97190, 100]), torch.Size([1, 97190, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 1.0365519523620605  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.1778244972229  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 97190, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.809342861175537  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.904752731323242  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.999747276306152  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.904337406158447  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([99609, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.999747276306152  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.023086071014404  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.023086071014404  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.257244110107422  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.257244110107422  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.257259368896484  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.257488250732422  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.257486820220947  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.257486820220947  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.257490634918213  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.257574558258057  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.2575883865356445  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.2575883865356445  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.257596015930176  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.257817268371582  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.257833003997803  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.257833003997803  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.257840633392334  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.258115291595459  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.258175373077393  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.258175373077393  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.2581963539123535  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.259098529815674  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.259101867675781  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.259101867675781  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.259105682373047  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.259296417236328  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.2593255043029785  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.2593255043029785  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.25933313369751  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.259768009185791  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.259833812713623  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.259833812713623  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.2598490715026855  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.2608256340026855  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.260828971862793  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.260828971862793  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.260830879211426  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.260979652404785  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([16, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.261163234710693  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.261163234710693  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.261193752288818  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.263787746429443  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.2639851570129395  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.2639851570129395  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.264017581939697  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.267000675201416  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([2, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.267011642456055  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.267011642456055  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.26701545715332  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.267393112182617  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.267420291900635  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.267420291900635  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.2674241065979  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.267828464508057  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.2678728103637695  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.2678728103637695  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.267878532409668  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.268525123596191  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.268636703491211  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.268636703491211  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.268650054931641  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.270252227783203  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.270315170288086  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.270315170288086  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.270322799682617  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.271291732788086  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.271434307098389  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.271434307098389  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.271449565887451  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.273494243621826  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.273582935333252  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.273582935333252  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.273592472076416  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.274937152862549  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.275134563446045  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.275134563446045  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.275153636932373  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.2779765129089355  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.278094291687012  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.278094291687012  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.278105735778809  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.279879570007324  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.280073165893555  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.280073165893555  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.28009033203125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.282871246337891  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.283162593841553  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.283162593841553  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.283187389373779  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.287377834320068  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([9645, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.519343852996826  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.519343852996826  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 9645, 256]), torch.Size([1, 9645, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.537740230560303  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.775502681732178  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 9645, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.543495178222656  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.545722484588623  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.54794979095459  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.545649528503418  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([9791, 47])
input nodes number: 99609
output nodes number: 9791
edges number: 243201
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.546241760253906  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.546242237091064  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1519489288330078  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

pseudo mini batch 9 input nodes size: 244943
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1270766258239746  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1270766258239746  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.21832513809204102  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.21839666366577148  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.09863519668579102  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10714197158813477  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10714197158813477  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

first layer input nodes number: 244943
first layer output nodes number: 91292
edges number: 903862
----------------------------------------before model layer 0
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10964775085449219  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([244943, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10964775085449219  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([115, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4558701515197754  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4558701515197754  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 115, 100]), torch.Size([1, 115, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45595598220825195  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45664262771606445  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 115, 100])
m.shape torch.Size([160, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45671892166137695  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45671892166137695  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 160, 100]), torch.Size([1, 160, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45683813095092773  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45862627029418945  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 160, 100])
m.shape torch.Size([162, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45874786376953125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45874786376953125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 162, 100]), torch.Size([1, 162, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45886898040771484  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4615292549133301  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 162, 100])
m.shape torch.Size([202, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.46177005767822266  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.46177005767822266  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 202, 100]), torch.Size([1, 202, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.46192073822021484  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4662904739379883  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 202, 100])
m.shape torch.Size([232, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4666476249694824  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4666476249694824  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 232, 100]), torch.Size([1, 232, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.46682119369506836  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.47304821014404297  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 232, 100])
m.shape torch.Size([287, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4736032485961914  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4736032485961914  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 287, 100]), torch.Size([1, 287, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4738178253173828  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4830188751220703  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 287, 100])
m.shape torch.Size([321, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4837489128112793  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4837489128112793  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 321, 100]), torch.Size([1, 321, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.48398828506469727  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4959568977355957  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 321, 100])
m.shape torch.Size([353, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.49755144119262695  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.49755144119262695  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 353, 100]), torch.Size([1, 353, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4978146553039551  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5128178596496582  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 353, 100])
m.shape torch.Size([420, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5140948295593262  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5140948295593262  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 420, 100]), torch.Size([1, 420, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5144085884094238  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5344505310058594  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 420, 100])
m.shape torch.Size([89040, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.8659934997558594  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.8659934997558594  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 89040, 100]), torch.Size([1, 89040, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.9323339462280273  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.642477035522461  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 89040, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.304890155792236  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.391952991485596  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.479015827178955  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.391952991485596  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([91292, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.479015827178955  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.500781536102295  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.500781536102295  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.729740619659424  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.729740619659424  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.729742527008057  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.729757785797119  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.729761123657227  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.729761123657227  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.729764938354492  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.729822158813477  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.729832172393799  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.729832172393799  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.72983980178833  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.730007648468018  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.730023384094238  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.730023384094238  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.7300310134887695  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.7303056716918945  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.73031759262085  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.73031759262085  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.730321407318115  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.730538845062256  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.7305803298950195  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.7305803298950195  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.730589866638184  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.731200218200684  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.731215000152588  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.731215000152588  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.7312188148498535  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.731489658355713  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.73151969909668  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.73151969909668  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.731525421142578  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.731971740722656  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.731980800628662  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.731980800628662  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.731982707977295  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.732144832611084  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.732171058654785  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.732171058654785  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.732174873352051  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.732552528381348  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.732565402984619  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.732565402984619  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.732567310333252  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.73276948928833  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.732799530029297  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.732799530029297  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.7328033447265625  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.733234405517578  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.733265399932861  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.733265399932861  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.733269214630127  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.733726978302002  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.733794689178467  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.733794689178467  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.733802318572998  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.734771251678467  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.73505973815918  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.73505973815918  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.735090255737305  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.739179611206055  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.739299297332764  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.739299297332764  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.739312648773193  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.741195201873779  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.741269588470459  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.741269588470459  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.74127721786499  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.742406368255615  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.74244499206543  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.74244499206543  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.742448806762695  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.743040084838867  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.743237495422363  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.743237495422363  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.743254661560059  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.746035575866699  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.746119499206543  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.746119499206543  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.746127128601074  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.7474164962768555  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9464, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.975038051605225  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.975038051605225  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 9464, 256]), torch.Size([1, 9464, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.993089199066162  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.170457363128662  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 9464, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.94352388381958  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.945469379425049  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.947455406188965  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.945438385009766  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([9541, 47])
input nodes number: 91292
output nodes number: 9541
edges number: 237819
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.945908546447754  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.945909023284912  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.12111330032348633  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

pseudo mini batch 10 input nodes size: 231140
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.09835338592529297  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.09835338592529297  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.18446016311645508  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.18453550338745117  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.0932154655456543  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10129499435424805  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10129499435424805  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

first layer input nodes number: 231140
first layer output nodes number: 84919
edges number: 834654
----------------------------------------before model layer 0
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10365009307861328  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([231140, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10365009307861328  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([141, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4233970642089844  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4233970642089844  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 141, 100]), torch.Size([1, 141, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.42350292205810547  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4243454933166504  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 141, 100])
m.shape torch.Size([186, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.42443132400512695  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.42443132400512695  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 186, 100]), torch.Size([1, 186, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.42457056045532227  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4266533851623535  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 186, 100])
m.shape torch.Size([277, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4268937110900879  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4268937110900879  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 277, 100]), torch.Size([1, 277, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.42710065841674805  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.43164491653442383  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 277, 100])
m.shape torch.Size([388, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.43211984634399414  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.43211984634399414  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 388, 100]), torch.Size([1, 388, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.43240976333618164  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.44080018997192383  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 388, 100])
m.shape torch.Size([451, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.441495418548584  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.441495418548584  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 451, 100]), torch.Size([1, 451, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4418320655822754  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4539370536804199  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 451, 100])
m.shape torch.Size([515, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45492029190063477  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45492029190063477  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 515, 100]), torch.Size([1, 515, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4553046226501465  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4718136787414551  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 515, 100])
m.shape torch.Size([524, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4738955497741699  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4738955497741699  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 524, 100]), torch.Size([1, 524, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4742865562438965  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4938168525695801  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 524, 100])
m.shape torch.Size([554, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4952726364135742  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4952726364135742  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 554, 100]), torch.Size([1, 554, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4956855773925781  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5192232131958008  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 554, 100])
m.shape torch.Size([517, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5207505226135254  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5207505226135254  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 517, 100]), torch.Size([1, 517, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5211358070373535  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5457940101623535  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 517, 100])
m.shape torch.Size([81366, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.8487133979797363  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.8487133979797363  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 81366, 100]), torch.Size([1, 81366, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.909888744354248  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.214090824127197  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 81366, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.902885437011719  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.983870506286621  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.064855575561523  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.983870506286621  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([84919, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.064855575561523  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.085102081298828  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.085102081298828  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.325656414031982  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.325656414031982  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.325667858123779  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.325759410858154  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.325756072998047  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.325756072998047  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.32575798034668  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.325786590576172  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.325794696807861  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.325794696807861  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.32580041885376  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.325926303863525  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.325946807861328  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.325946807861328  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.325958251953125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.326290130615234  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.326327800750732  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.326327800750732  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.326344966888428  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.326962947845459  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.327000617980957  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.327000617980957  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3270158767700195  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.327672004699707  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([12, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.32774543762207  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.32774543762207  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.327768325805664  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.328912734985352  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.328993797302246  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.328993797302246  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.32901668548584  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.330321311950684  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([21, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.330491542816162  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.330491542816162  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.330531597137451  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.333095073699951  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([11, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.333180904388428  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.333180904388428  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.333201885223389  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.334691524505615  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.334829330444336  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.334829330444336  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.334856033325195  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.336938858032227  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([10, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.337040901184082  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.337040901184082  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.33705997467041  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.338681221008301  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.338821887969971  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.338821887969971  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3388447761535645  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3409504890441895  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.341100692749023  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.341100692749023  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.341123580932617  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.343389511108398  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([22, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.343695640563965  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.343695640563965  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.343737602233887  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3481855392456055  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([12, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.348349094390869  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.348349094390869  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.348371982574463  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.350958347320557  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3511433601379395  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3511433601379395  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.351166248321533  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.353912830352783  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.354161262512207  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.354161262512207  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.354189872741699  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.357823371887207  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([7, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.357937335968018  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.357937335968018  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.357950687408447  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.359739780426025  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.359944820404053  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.359944820404053  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.359965801239014  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.362924098968506  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.363135814666748  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.363135814666748  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.363156795501709  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.366261959075928  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.366547584533691  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.366547584533691  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.366574287414551  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.370713233947754  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.371053695678711  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.371053695678711  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.371084213256836  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.376028060913086  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.376312732696533  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.376312732696533  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.37633752822876  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.380527973175049  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([9837, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.616880416870117  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.616880416870117  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 9837, 256]), torch.Size([1, 9837, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.635643005371094  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.946162700653076  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 9837, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.707152366638184  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.708948135375977  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.710718154907227  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.708847045898438  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([10107, 47])
input nodes number: 84919
output nodes number: 10107
edges number: 249704
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.709405422210693  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.709405899047852  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.11481952667236328  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

pseudo mini batch 11 input nodes size: 252956
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.09306573867797852  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.09306573867797852  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.18729925155639648  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.18737506866455078  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10119295120239258  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10983705520629883  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10983705520629883  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

first layer input nodes number: 252956
first layer output nodes number: 91504
edges number: 908147
----------------------------------------before model layer 0
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.11240386962890625  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([252956, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.11240386962890625  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([72, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4603443145751953  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4603443145751953  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 72, 100]), torch.Size([1, 72, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.46039867401123047  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4608292579650879  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 72, 100])
m.shape torch.Size([95, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4608731269836426  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4608731269836426  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 95, 100]), torch.Size([1, 95, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.46094465255737305  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4620089530944824  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 95, 100])
m.shape torch.Size([124, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4621119499206543  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4621119499206543  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 124, 100]), torch.Size([1, 124, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4622044563293457  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.46423959732055664  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 124, 100])
m.shape torch.Size([130, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4643874168395996  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4643874168395996  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 130, 100]), torch.Size([1, 130, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.46448469161987305  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4672999382019043  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 130, 100])
m.shape torch.Size([206, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4676351547241211  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4676351547241211  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 206, 100]), torch.Size([1, 206, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4677886962890625  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4733161926269531  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 206, 100])
m.shape torch.Size([229, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4737515449523926  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4737515449523926  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 229, 100]), torch.Size([1, 229, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4739222526550293  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4812626838684082  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 229, 100])
m.shape torch.Size([294, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.48194408416748047  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.48194408416748047  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 294, 100]), torch.Size([1, 294, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4821634292602539  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4931206703186035  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 294, 100])
m.shape torch.Size([314, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.49394702911376953  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.49394702911376953  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 314, 100]), torch.Size([1, 314, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.49418163299560547  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5075311660766602  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 314, 100])
m.shape torch.Size([381, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5086913108825684  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5086913108825684  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 381, 100]), torch.Size([1, 381, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5089755058288574  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5271511077880859  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 381, 100])
m.shape torch.Size([89659, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.8610148429870605  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.8610148429870605  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 89659, 100]), torch.Size([1, 89659, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.9278168678283691  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.670717716217041  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 89659, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.331381320953369  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.418646335601807  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.505911350250244  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.418646335601807  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([91504, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.505911350250244  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.5277276039123535  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.5277276039123535  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.770329475402832  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.770329475402832  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.770333290100098  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.770417213439941  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.770444393157959  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.770444393157959  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.770453929901123  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.770864009857178  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.770890235900879  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.770890235900879  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.77089786529541  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.771332740783691  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([11, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.771424293518066  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.771424293518066  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.771445274353027  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.772788047790527  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.772806644439697  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.772806644439697  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.772812366485596  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.773218631744385  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.773268699645996  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.773268699645996  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.77327823638916  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.774022102355957  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.774086952209473  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.774086952209473  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.7740983963012695  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.775071144104004  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.775115489959717  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.775115489959717  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.775123119354248  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.775825023651123  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.775915622711182  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.775915622711182  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.775928974151611  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.77725076675415  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.777316570281982  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.777316570281982  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.7773261070251465  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.778337001800537  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.778393745422363  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.778393745422363  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.7784013748168945  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.779263496398926  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.779292583465576  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.779292583465576  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.779296398162842  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.779754161834717  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.779821872711182  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.779821872711182  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.779829502105713  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.780798435211182  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.780941009521484  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.780941009521484  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.780956268310547  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.783000946044922  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.783089637756348  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.783089637756348  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.783099174499512  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.7844438552856445  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.784620761871338  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.784620761871338  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.784637928009033  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.7871785163879395  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.787275791168213  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.787275791168213  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.787285327911377  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.788763523101807  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.7889204025268555  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.7889204025268555  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.788933753967285  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.791190147399902  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10022, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.031993389129639  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.031993389129639  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 10022, 256]), torch.Size([1, 10022, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.051700592041016  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.426414489746094  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 10022, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.185562133789062  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.187334060668945  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.189105987548828  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.187258243560791  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([10118, 47])
input nodes number: 91504
output nodes number: 10118
edges number: 251988
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.187992095947266  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.187992572784424  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1244821548461914  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

pseudo mini batch 12 input nodes size: 213563
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10116910934448242  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10116910934448242  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.18072795867919922  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1808004379272461  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.08649110794067383  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.09333181381225586  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.09333181381225586  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

first layer input nodes number: 213563
first layer output nodes number: 69562
edges number: 679420
----------------------------------------before model layer 0
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.09544134140014648  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([213563, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.09544134140014648  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([120, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.35573291778564453  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.35573291778564453  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 120, 100]), torch.Size([1, 120, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3558225631713867  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3565382957458496  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 120, 100])
m.shape torch.Size([258, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3566861152648926  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3566861152648926  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 258, 100]), torch.Size([1, 258, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.35687875747680664  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.35976552963256836  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 258, 100])
m.shape torch.Size([315, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.36002159118652344  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.36002159118652344  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 315, 100]), torch.Size([1, 315, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3602571487426758  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.36542654037475586  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 315, 100])
m.shape torch.Size([457, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.36599016189575195  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.36599016189575195  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 457, 100]), torch.Size([1, 457, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3663315773010254  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.37621545791625977  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 457, 100])
m.shape torch.Size([497, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3769707679748535  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3769707679748535  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 497, 100]), torch.Size([1, 497, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.37734174728393555  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3906826972961426  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 497, 100])
m.shape torch.Size([527, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.39184141159057617  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.39184141159057617  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 527, 100]), torch.Size([1, 527, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.39223432540893555  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.409121036529541  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 527, 100])
m.shape torch.Size([555, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.410372257232666  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.410372257232666  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 555, 100]), torch.Size([1, 555, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.41078615188598633  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4314708709716797  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 555, 100])
m.shape torch.Size([625, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.43312692642211914  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.43312692642211914  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 625, 100]), torch.Size([1, 625, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4335932731628418  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.46015214920043945  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 625, 100])
m.shape torch.Size([601, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.46193408966064453  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.46193408966064453  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 601, 100]), torch.Size([1, 601, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.46238231658935547  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.491055965423584  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 601, 100])
m.shape torch.Size([65607, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.7352371215820312  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.7352371215820312  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 65607, 100]), torch.Size([1, 65607, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.78411865234375  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.254678726196289  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 65607, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.001742839813232  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.068082332611084  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.1344218254089355  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.068082332611084  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([69562, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.1344218254089355  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.151006698608398  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.151006698608398  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.380796909332275  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.380796909332275  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.380802631378174  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.380848407745361  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.380859375  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.380859375  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.38087272644043  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.381072998046875  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.381086826324463  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.381086826324463  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.381100177764893  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.381393909454346  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([26, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.3814873695373535  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.3814873695373535  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.381536960601807  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.382975101470947  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.382984161376953  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.382984161376953  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.382997512817383  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.383478164672852  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([18, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.383575439453125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.383575439453125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.383609771728516  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.3850860595703125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.385149955749512  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.385149955749512  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.3851728439331055  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.386317253112793  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([18, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.386444568634033  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.386444568634033  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.386478900909424  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.3884358406066895  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.388539791107178  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.388539791107178  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.388566493988037  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.390275478363037  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([12, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.390377521514893  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.390377521514893  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.390400409698486  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.392025470733643  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.392141342163086  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.392141342163086  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.39216423034668  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.393949508666992  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.394076824188232  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.394076824188232  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.394099712371826  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.396045207977295  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.396183967590332  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.396183967590332  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.396206855773926  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.398312568664551  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([17, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.398530006408691  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.398530006408691  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.398562431335449  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.401772499084473  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([21, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.402059078216553  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.402059078216553  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.402099132537842  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.406344890594482  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([14, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.406540393829346  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.406540393829346  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.406567096710205  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.4095845222473145  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.409816265106201  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.409816265106201  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.409844875335693  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.413278102874756  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.4135236740112305  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.4135236740112305  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.413552284240723  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.4171857833862305  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.4175004959106445  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.4175004959106445  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.417534828186035  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.422135353088379  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.422560691833496  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.422560691833496  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.422604560852051  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.428790092468262  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.429091453552246  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.429091453552246  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.429121971130371  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.433638572692871  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.434046268463135  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.434046268463135  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.434084415435791  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.43999719619751  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.440243721008301  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.440243721008301  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.4402666091918945  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.443974494934082  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.444493770599365  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.444493770599365  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.44453763961792  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.451951503753662  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([9351, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.677364826202393  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.677364826202393  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 9351, 256]), torch.Size([1, 9351, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.6958489418029785  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 7.836013317108154  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 9351, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 7.607964992523193  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 7.609762668609619  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 7.611560344696045  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 7.609690189361572  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([9705, 47])
input nodes number: 69562
output nodes number: 9705
edges number: 238674
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 7.610306739807129  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 7.610307216644287  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10523223876953125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

pseudo mini batch 13 input nodes size: 161514
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.0865168571472168  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.0865168571472168  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.14668560028076172  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1467571258544922  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.06712579727172852  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.0737156867980957  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.0737156867980957  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

first layer input nodes number: 161514
first layer output nodes number: 68567
edges number: 660003
----------------------------------------before model layer 0
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.07543039321899414  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([161514, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.07543039321899414  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([167, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.32833290100097656  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.32833290100097656  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 167, 100]), torch.Size([1, 167, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3284578323364258  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3294544219970703  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 167, 100])
m.shape torch.Size([359, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.32965946197509766  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.32965946197509766  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 359, 100]), torch.Size([1, 359, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3299274444580078  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3339414596557617  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 359, 100])
m.shape torch.Size([471, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3343338966369629  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3343338966369629  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 471, 100]), torch.Size([1, 471, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3346848487854004  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3424057960510254  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 471, 100])
m.shape torch.Size([591, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3431110382080078  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3431110382080078  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 591, 100]), torch.Size([1, 591, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3435516357421875  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3563232421875  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 591, 100])
m.shape torch.Size([835, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.35765838623046875  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.35765838623046875  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 835, 100]), torch.Size([1, 835, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.35828113555908203  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.38139915466308594  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 835, 100])
m.shape torch.Size([958, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.38322925567626953  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.38322925567626953  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 958, 100]), torch.Size([1, 958, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3839435577392578  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4162745475769043  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 958, 100])
m.shape torch.Size([1051, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4186582565307617  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4186582565307617  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1051, 100]), torch.Size([1, 1051, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.41944217681884766  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45934247970581055  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1051, 100])
m.shape torch.Size([1089, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.46219635009765625  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.46219635009765625  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1089, 100]), torch.Size([1, 1089, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.46300792694091797  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5094318389892578  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1089, 100])
m.shape torch.Size([1111, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5127511024475098  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5127511024475098  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1111, 100]), torch.Size([1, 1111, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5135788917541504  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5665574073791504  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1111, 100])
m.shape torch.Size([61935, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.7968697547912598  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.7968697547912598  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 61935, 100]), torch.Size([1, 61935, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.843015193939209  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.119327068328857  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 61935, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 3.874640464782715  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 3.940031051635742  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.0054216384887695  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 3.940031051635742  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([68567, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.0054216384887695  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.0217695236206055  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.0217695236206055  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([20, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.2386794090271  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.2386794090271  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.238717555999756  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.239022731781006  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([30, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.23906135559082  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.23906135559082  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.239118576049805  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.23997688293457  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([35, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.240049362182617  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.240049362182617  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.240116119384766  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.241584777832031  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([42, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.241713047027588  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.241713047027588  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.241793155670166  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.244116306304932  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([51, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.244321346282959  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.244321346282959  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.244418621063232  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.247920513153076  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([67, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.248258590698242  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.248258590698242  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.248386383056641  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.253881454467773  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([60, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.254221439361572  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.254221439361572  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.254335880279541  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.2600579261779785  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([67, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.260516166687012  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.260516166687012  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.26064395904541  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.267928123474121  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([59, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.268374919891357  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.268374919891357  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.268487453460693  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.275689601898193  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([68, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.276287078857422  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.276287078857422  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.276416778564453  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.285625457763672  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([53, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.286121368408203  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.286121368408203  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.286222457885742  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.294107437133789  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([47, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.2945990562438965  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.2945990562438965  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.294688701629639  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.302308559417725  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.30302619934082  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.30302619934082  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.303142547607422  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.313846588134766  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([65, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.314663410186768  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.314663410186768  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.3147873878479  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.327061176300049  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([65, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.32793664932251  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.32793664932251  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.328060626983643  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.341202259063721  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([58, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.342032432556152  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.342032432556152  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.3421430587768555  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.354643821716309  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([70, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.355917453765869  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.355917453765869  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.356050968170166  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.372072696685791  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.37341833114624  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.37341833114624  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.37354040145874  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.38904333114624  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([67, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.390687465667725  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.390687465667725  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.390815258026123  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.407939434051514  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.408740997314453  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.408740997314453  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.40882682800293  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.420928955078125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.421976089477539  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.421976089477539  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.422079086303711  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.437322616577148  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([55, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.439174175262451  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.439174175262451  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.439279079437256  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.455539226531982  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([51, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.4566144943237305  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.4566144943237305  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.456711769104004  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.472470283508301  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([57, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.474496841430664  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.474496841430664  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.474605560302734  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.492979049682617  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([8281, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.691901683807373  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.691901683807373  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 8281, 256]), torch.Size([1, 8281, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.707696437835693  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 7.487573146820068  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 8281, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 7.2737836837768555  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 7.27549934387207  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 7.277592658996582  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 7.275805473327637  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([9592, 47])
input nodes number: 68567
output nodes number: 9592
edges number: 224355
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 7.27630615234375  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 7.276306629180908  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.08473968505859375  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

pseudo mini batch 14 input nodes size: 252085
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.06704378128051758  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.06704378128051758  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.16095304489135742  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1610245704650879  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1007843017578125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10867118835449219  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10867118835449219  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

first layer input nodes number: 252085
first layer output nodes number: 84673
edges number: 829526
----------------------------------------before model layer 0
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.11118078231811523  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([252085, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.11118078231811523  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([164, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.42897796630859375  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.42897796630859375  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 164, 100]), torch.Size([1, 164, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.42910099029541016  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4300808906555176  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 164, 100])
m.shape torch.Size([245, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.43020200729370117  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.43020200729370117  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 245, 100]), torch.Size([1, 245, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.43038511276245117  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.43312597274780273  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 245, 100])
m.shape torch.Size([322, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4333944320678711  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4333944320678711  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 322, 100]), torch.Size([1, 322, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.43363475799560547  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4389176368713379  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 322, 100])
m.shape torch.Size([466, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.43949222564697266  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.43949222564697266  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 466, 100]), torch.Size([1, 466, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.43984031677246094  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4499177932739258  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 466, 100])
m.shape torch.Size([488, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.450653076171875  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.450653076171875  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 488, 100]), torch.Size([1, 488, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4510173797607422  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4641108512878418  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 488, 100])
m.shape torch.Size([595, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4652590751647949  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4652590751647949  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 595, 100]), torch.Size([1, 595, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.46570253372192383  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4847712516784668  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 595, 100])
m.shape torch.Size([606, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4861302375793457  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4861302375793457  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 606, 100]), torch.Size([1, 606, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.48658227920532227  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5091643333435059  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 606, 100])
m.shape torch.Size([682, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5113186836242676  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5113186836242676  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 682, 100]), torch.Size([1, 682, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5118269920349121  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5410161018371582  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 682, 100])
m.shape torch.Size([716, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5431628227233887  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5431628227233887  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 716, 100]), torch.Size([1, 716, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5436968803405762  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5781593322753906  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 716, 100])
m.shape torch.Size([80389, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.8773651123046875  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.8773651123046875  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 80389, 100]), torch.Size([1, 80389, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.9372596740722656  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.1897735595703125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 80389, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.880759239196777  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.961509704589844  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.04226016998291  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.961509704589844  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([84673, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.04226016998291  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.063096046447754  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.063096046447754  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([23, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.283492565155029  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.283492565155029  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.283536434173584  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2838873863220215  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([24, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.28391170501709  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.28391170501709  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.283957481384277  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.28464412689209  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([27, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.284699440002441  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.284699440002441  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.284750938415527  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.285883903503418  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([51, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.286054611206055  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.286054611206055  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.286151885986328  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.288972854614258  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([35, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.289092540740967  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.289092540740967  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.289159297943115  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.291562557220459  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([34, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2917256355285645  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2917256355285645  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.29179048538208  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.294579029083252  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([40, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.294816017150879  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.294816017150879  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.294892311096191  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.298707008361816  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([41, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.298984527587891  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.298984527587891  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.299062728881836  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.303520202636719  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([31, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3037495613098145  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3037495613098145  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.303808689117432  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.307592868804932  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.307832717895508  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.307832717895508  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.307886123657227  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.311677932739258  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([39, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.312063694000244  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.312063694000244  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.312138080596924  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3179402351379395  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([28, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.318226337432861  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.318226337432861  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.31827974319458  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.322819232940674  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3232927322387695  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3232927322387695  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.323369026184082  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.330388069152832  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([24, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3306732177734375  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3306732177734375  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.330718994140625  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3352508544921875  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3357038497924805  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3357038497924805  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.335766792297363  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.342438697814941  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([29, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.342853546142578  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.342853546142578  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.34290885925293  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.349159240722656  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.349720001220703  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.349720001220703  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.349788665771484  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.358028411865234  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.358496189117432  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.358496189117432  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.358551502227783  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.365576267242432  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.366115093231201  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.366115093231201  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.366174221038818  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3740973472595215  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.374606132507324  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.374606132507324  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.374659538269043  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.382189750671387  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.382748603820801  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.382748603820801  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.382803916931152  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.390990257263184  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([30, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.391597270965576  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.391597270965576  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3916544914245605  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.400523662567139  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.401114463806152  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.401114463806152  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.401167869567871  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.409819602966309  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.410577297210693  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.410577297210693  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.410642147064209  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.42160177230835  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([8776, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.6332621574401855  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.6332621574401855  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 8776, 256]), torch.Size([1, 8776, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.650001049041748  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.602253437042236  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 8776, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.384309768676758  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.385988235473633  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.387666702270508  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.385916709899902  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([9548, 47])
input nodes number: 84673
output nodes number: 9548
edges number: 228894
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.386582374572754  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.386582851409912  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.12210655212402344  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

pseudo mini batch 15 input nodes size: 210650
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10074710845947266  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10074710845947266  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.17922067642211914  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.17929601669311523  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.08531522750854492  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.09259653091430664  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.09259653091430664  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

first layer input nodes number: 210650
first layer output nodes number: 76303
edges number: 733737
----------------------------------------before model layer 0
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.09473514556884766  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([210650, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.09473514556884766  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([300, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3759341239929199  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3759341239929199  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 300, 100]), torch.Size([1, 300, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3761582374572754  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3779482841491699  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 300, 100])
m.shape torch.Size([437, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3781619071960449  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3781619071960449  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 437, 100]), torch.Size([1, 437, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.37848806381225586  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3833746910095215  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 437, 100])
m.shape torch.Size([606, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.38388919830322266  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.38388919830322266  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 606, 100]), torch.Size([1, 606, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3843412399291992  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.39427757263183594  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 606, 100])
m.shape torch.Size([744, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3951601982116699  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.3951601982116699  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 744, 100]), torch.Size([1, 744, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.39571523666381836  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4121689796447754  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 744, 100])
m.shape torch.Size([872, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4135160446166992  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4135160446166992  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 872, 100]), torch.Size([1, 872, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4141664505004883  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4375596046447754  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 872, 100])
m.shape torch.Size([965, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4393916130065918  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4393916130065918  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 965, 100]), torch.Size([1, 965, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4401106834411621  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4718661308288574  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 965, 100])
m.shape torch.Size([1009, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4741377830505371  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4741377830505371  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1009, 100]), torch.Size([1, 1009, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.47489023208618164  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5129151344299316  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1009, 100])
m.shape torch.Size([1069, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5157251358032227  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5157251358032227  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1069, 100]), torch.Size([1, 1069, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5165224075317383  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5627603530883789  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1069, 100])
m.shape torch.Size([1006, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.56573486328125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.56573486328125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1006, 100]), torch.Size([1, 1006, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5664844512939453  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.6145000457763672  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1006, 100])
m.shape torch.Size([69295, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.8722696304321289  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.8722696304321289  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 69295, 100]), torch.Size([1, 69295, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.9238986968994141  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.589548110961914  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 69295, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.317390441894531  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.390158653259277  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.462926864624023  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.390158653259277  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([76303, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.462926864624023  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.481119155883789  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.481119155883789  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([13, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.71576452255249  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.71576452255249  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.715789318084717  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.715987682342529  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([18, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.716010093688965  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.716010093688965  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.7160444259643555  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.716559410095215  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.716594219207764  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.716594219207764  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.716628551483154  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.717383861541748  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([26, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.717466831207275  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.717466831207275  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.7175164222717285  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.718954563140869  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([32, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.719083786010742  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.719083786010742  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.719144821166992  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.721342086791992  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.721513748168945  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.721513748168945  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.721580505371094  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.724451065063477  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([35, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.724653244018555  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.724653244018555  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.724720001220703  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.728057861328125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.72824764251709  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.72824764251709  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.728302955627441  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.7314558029174805  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([22, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.731618881225586  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.731618881225586  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.731660842895508  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.734346389770508  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([31, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.734623432159424  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.734623432159424  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.734682559967041  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.738880634307861  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([37, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.7392425537109375  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.7392425537109375  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.739313125610352  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.744817733764648  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([40, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.745244026184082  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.745244026184082  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.7453203201293945  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.751805305480957  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([33, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.7521796226501465  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.7521796226501465  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.752242565155029  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.758033275604248  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.758486270904541  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.758486270904541  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.758554935455322  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.765352725982666  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.765794277191162  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.765794277191162  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.765857219696045  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.772529125213623  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.773066997528076  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.773066997528076  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.77313756942749  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.781112194061279  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.781599998474121  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.781599998474121  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.781661033630371  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.788985252380371  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.789474010467529  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.789474010467529  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.789531230926514  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.796798229217529  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([36, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.797427177429199  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.797427177429199  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.7974958419799805  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.806696891784668  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.807412624359131  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.807412624359131  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.8074870109558105  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.8179755210876465  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([34, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.818624973297119  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.818624973297119  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.818689823150635  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.828287601470947  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([46, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.829227924346924  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.829227924346924  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.829315662384033  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.842915058135986  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.843777656555176  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.843777656555176  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.843855857849121  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.856524467468262  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([37, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.857338905334473  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.857338905334473  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.857409477233887  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.869336128234863  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([9315, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.093122959136963  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.093122959136963  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 9315, 256]), torch.Size([1, 9315, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.1113481521606445  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.23833179473877  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 9315, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.006435871124268  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.00883150100708  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.010597705841064  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.008126735687256  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([10085, 47])
input nodes number: 76303
output nodes number: 10085
edges number: 243449
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.009488105773926  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.009488582611084  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10579872131347656  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

pseudo mini batch 16 input nodes size: 281782
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.08603239059448242  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.08603239059448242  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.19100475311279297  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.19107627868652344  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.11252737045288086  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1206212043762207  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1206212043762207  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

first layer input nodes number: 281782
first layer output nodes number: 88692
edges number: 857053
----------------------------------------before model layer 0
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1233816146850586  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([281782, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1233816146850586  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([296, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45180511474609375  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45180511474609375  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 296, 100]), torch.Size([1, 296, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4520263671875  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45379209518432617  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 296, 100])
m.shape torch.Size([448, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45401525497436523  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45401525497436523  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 448, 100]), torch.Size([1, 448, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4543490409851074  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45935583114624023  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 448, 100])
m.shape torch.Size([600, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45985984802246094  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45985984802246094  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 600, 100]), torch.Size([1, 600, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.46030712127685547  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.47014284133911133  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 600, 100])
m.shape torch.Size([760, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4710516929626465  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4710516929626465  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 760, 100]), torch.Size([1, 760, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4716181755065918  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4881706237792969  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 760, 100])
m.shape torch.Size([936, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.48963117599487305  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.48963117599487305  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 936, 100]), torch.Size([1, 936, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4903292655944824  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5160603523254395  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 936, 100])
m.shape torch.Size([952, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5178394317626953  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5178394317626953  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 952, 100]), torch.Size([1, 952, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5185489654541016  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5496687889099121  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 952, 100])
m.shape torch.Size([1046, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5520420074462891  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5520420074462891  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1046, 100]), torch.Size([1, 1046, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5528221130371094  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5927004814147949  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1046, 100])
m.shape torch.Size([1095, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.595573902130127  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.595573902130127  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1095, 100]), torch.Size([1, 1095, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5963902473449707  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.6429224014282227  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1095, 100])
m.shape torch.Size([1043, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.6460113525390625  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.6460113525390625  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1043, 100]), torch.Size([1, 1043, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.6467885971069336  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.6976175308227539  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1043, 100])
m.shape torch.Size([81516, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 1.0008997917175293  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 1.0008997917175293  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 81516, 100]), torch.Size([1, 81516, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 1.0616345405578613  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.373773097991943  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 81516, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.055508613586426  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.140091896057129  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.224675178527832  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.140091896057129  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([88692, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.224675178527832  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.245820999145508  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.245820999145508  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([40, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.466481685638428  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.466481685638428  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.46655797958374  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.46716833114624  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([33, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.467194080352783  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.467194080352783  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.467257022857666  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.468201160430908  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([20, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.468227386474609  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.468227386474609  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.468265533447266  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.469104766845703  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.469159126281738  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.469159126281738  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.469195365905762  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.470246315002441  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([34, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.470391750335693  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.470391750335693  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.470456600189209  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.4727911949157715  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([28, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.4729204177856445  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.4729204177856445  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.472973823547363  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.4752702713012695  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([35, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.4754791259765625  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.4754791259765625  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.475545883178711  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.478883743286133  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([33, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.479104518890381  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.479104518890381  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.479167461395264  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.482755184173584  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([24, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.482931613922119  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.482931613922119  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.482977390289307  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.485907077789307  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([34, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.48621129989624  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.48621129989624  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.486276149749756  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.490880489349365  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([27, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.491133689880371  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.491133689880371  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.491185188293457  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.49520206451416  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.495522499084473  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.495522499084473  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.495579719543457  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.500443458557129  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.500915050506592  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.500915050506592  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.500991344451904  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.508010387420654  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.508605003356934  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.508605003356934  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.508694648742676  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.517569541931152  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([27, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.517914295196533  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.517914295196533  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.517965793609619  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.5234246253967285  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.523937225341797  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.523937225341797  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.524003982543945  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.531547546386719  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.532200813293457  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.532200813293457  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.532280921936035  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.54189395904541  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.542304039001465  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.542304039001465  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.542353630065918  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.548651695251465  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.549156665802002  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.549156665802002  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.5492119789123535  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.556623935699463  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.557154178619385  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.557154178619385  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.557209491729736  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.565008640289307  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.565707683563232  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.565707683563232  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.565776348114014  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.575938701629639  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.576454162597656  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.576454162597656  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.576503753662109  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.584190368652344  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.585050106048584  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.585050106048584  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.5851263999938965  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.5974860191345215  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.598116874694824  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.598116874694824  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.598172187805176  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.60752010345459  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([8778, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.818892002105713  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.818892002105713  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 8778, 256]), torch.Size([1, 8778, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.835634708404541  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.782351016998291  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 8778, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.564343452453613  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.566014289855957  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.5676851272583  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.565942764282227  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([9541, 47])
input nodes number: 88692
output nodes number: 9541
edges number: 229152
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.565950393676758  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.565950870513916  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.13388776779174805  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

pseudo mini batch 17 input nodes size: 238451
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.11180257797241211  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.11180257797241211  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.20063257217407227  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.20070791244506836  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.09566402435302734  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10359382629394531  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.10359382629394531  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

first layer input nodes number: 238451
first layer output nodes number: 84955
edges number: 819235
----------------------------------------before model layer 0
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1060037612915039  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([238451, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1060037612915039  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([278, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4199404716491699  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4199404716491699  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 278, 100]), torch.Size([1, 278, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4201483726501465  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.42180728912353516  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 278, 100])
m.shape torch.Size([463, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.42204856872558594  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.42204856872558594  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 463, 100]), torch.Size([1, 463, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.422393798828125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4275693893432617  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 463, 100])
m.shape torch.Size([636, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.42810773849487305  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.42810773849487305  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 636, 100]), torch.Size([1, 636, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.42858171463012695  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4390091896057129  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 636, 100])
m.shape torch.Size([775, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4399271011352539  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4399271011352539  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 775, 100]), torch.Size([1, 775, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4405050277709961  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4581794738769531  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 775, 100])
m.shape torch.Size([924, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4596118927001953  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4596118927001953  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 924, 100]), torch.Size([1, 924, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4603004455566406  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.48561859130859375  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 924, 100])
m.shape torch.Size([1001, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.48751211166381836  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.48751211166381836  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1001, 100]), torch.Size([1, 1001, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.48825883865356445  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5210156440734863  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1001, 100])
m.shape torch.Size([1047, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5233726501464844  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5233726501464844  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1047, 100]), torch.Size([1, 1047, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5241527557373047  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5639667510986328  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1047, 100])
m.shape torch.Size([1082, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5668015480041504  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5668015480041504  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1082, 100]), torch.Size([1, 1082, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5676083564758301  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.6140375137329102  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1082, 100])
m.shape torch.Size([1078, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.61724853515625  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.61724853515625  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1078, 100]), torch.Size([1, 1078, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.6180524826049805  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.6697201728820801  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1078, 100])
m.shape torch.Size([77671, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.9586653709411621  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.9586653709411621  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 77671, 100]), torch.Size([1, 77671, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 1.0165352821350098  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.125270366668701  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 77671, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.821203708648682  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.902223110198975  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.983242511749268  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.902223110198975  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([84955, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.983242511749268  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.004222393035889  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.004222393035889  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2400288581848145  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2400288581848145  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.24004602432251  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.240183353424072  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([15, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.240203857421875  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.240203857421875  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.240232467651367  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.24066162109375  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2406907081604  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2406907081604  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.240719318389893  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.241348743438721  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([21, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.241415500640869  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.241415500640869  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.241455554962158  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.242617130279541  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2426934242248535  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2426934242248535  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.24273157119751  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.244104862213135  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([21, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.24420690536499  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.24420690536499  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.244246959686279  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.245969295501709  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.246070384979248  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.246070384979248  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.246104717254639  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.24782133102417  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([22, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.247973442077637  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.247973442077637  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.248015403747559  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2504072189331055  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([35, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2506890296936035  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2506890296936035  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.250755786895752  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.255028247833252  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.255292892456055  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.255292892456055  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.255352020263672  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.259550094604492  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.259838104248047  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.259838104248047  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.259895324707031  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2643585205078125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.264664649963379  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.264664649963379  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2647199630737305  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.269421577453613  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([44, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.269943714141846  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.269943714141846  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2700276374816895  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2777485847473145  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([30, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.278110504150391  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.278110504150391  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.278167724609375  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.283832550048828  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.284236907958984  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.284236907958984  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.284294128417969  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2903594970703125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.290807723999023  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.290807723999023  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.290866851806641  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.297548294067383  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.298058032989502  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.298058032989502  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.298120975494385  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.305674076080322  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.306161880493164  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.306161880493164  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.306219100952148  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.313486099243164  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([39, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.314169883728027  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.314169883728027  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.314244270324707  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.324212074279785  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([38, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3249053955078125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3249053955078125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.324977874755859  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.335197448730469  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3358073234558105  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3358073234558105  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3358683586120605  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3449015617370605  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([40, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.345716953277588  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.345716953277588  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3457932472229  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.357618808746338  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([45, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.358992099761963  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.358992099761963  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.3590779304504395  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.372982501983643  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.373654842376709  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.373654842376709  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.373713970184326  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.383706569671631  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([9402, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.609589576721191  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.609589576721191  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 9402, 256]), torch.Size([1, 9402, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.6275224685668945  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.783711433410645  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 9402, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.55058479309082  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.552974700927734  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.554741859436035  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.552276611328125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([10091, 47])
input nodes number: 84955
output nodes number: 10091
edges number: 244920
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.553704261779785  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.553704738616943  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.11785745620727539  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

pseudo mini batch 18 input nodes size: 290917
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.09638309478759766  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.09638309478759766  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.2047581672668457  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.2048325538635254  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.11592721939086914  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.12455224990844727  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.12455224990844727  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

first layer input nodes number: 290917
first layer output nodes number: 95413
edges number: 918595
----------------------------------------before model layer 0
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.12743091583251953  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([290917, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.12743091583251953  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([336, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.48001766204833984  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.48001766204833984  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 336, 100]), torch.Size([1, 336, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4802684783935547  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4822721481323242  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 336, 100])
m.shape torch.Size([516, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4825315475463867  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4825315475463867  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 516, 100]), torch.Size([1, 516, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.48291683197021484  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.48868751525878906  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 516, 100])
m.shape torch.Size([739, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.489321231842041  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.489321231842041  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 739, 100]), torch.Size([1, 739, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.48987245559692383  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.502596378326416  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 739, 100])
m.shape torch.Size([925, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5036993026733398  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5036993026733398  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 925, 100]), torch.Size([1, 925, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5043888092041016  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.524378776550293  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 925, 100])
m.shape torch.Size([1122, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5261240005493164  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5261240005493164  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1122, 100]), torch.Size([1, 1122, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5269603729248047  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5577812194824219  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1122, 100])
m.shape torch.Size([1188, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5600185394287109  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5600185394287109  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1188, 100]), torch.Size([1, 1188, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5609045028686523  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5990309715270996  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1188, 100])
m.shape torch.Size([1212, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.6017489433288574  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.6017489433288574  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1212, 100]), torch.Size([1, 1212, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.6026520729064941  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.6480298042297363  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1212, 100])
m.shape torch.Size([1231, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.6512470245361328  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.6512470245361328  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1231, 100]), torch.Size([1, 1231, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.6521644592285156  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.7044467926025391  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1231, 100])
m.shape torch.Size([1200, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.7080116271972656  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.7080116271972656  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 1200, 100]), torch.Size([1, 1200, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.7089061737060547  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.7661314010620117  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 1200, 100])
m.shape torch.Size([86944, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 1.0895757675170898  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 1.0895757675170898  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 86944, 100]), torch.Size([1, 86944, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 1.1543540954589844  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.753615379333496  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 86944, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.412779808044434  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.503772735595703  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.594765663146973  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.503772735595703  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([95413, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.594765663146973  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.617514133453369  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.617514133453369  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([10, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.847492218017578  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.847492218017578  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.847511291503906  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.847663879394531  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.847675800323486  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.847675800323486  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.847696781158447  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.848011493682861  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([27, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.848079204559326  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.848079204559326  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.848130702972412  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.849263668060303  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.849330425262451  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.849330425262451  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.849376201629639  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.850703716278076  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.8507914543151855  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.8507914543151855  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.85083532333374  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.852414608001709  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([43, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.8526411056518555  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.8526411056518555  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.852723121643066  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.856249809265137  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([44, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.856504917144775  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.856504917144775  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.856588840484619  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.860785007476807  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([40, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.861050605773926  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.861050605773926  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.861126899719238  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.865475654602051  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([31, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.865705966949463  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.865705966949463  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.86576509475708  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.86954927444458  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([41, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.8699140548706055  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.8699140548706055  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.869992256164551  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.875544548034668  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([47, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.876002788543701  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.876002788543701  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.876092433929443  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.883084774017334  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([36, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.883455276489258  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.883455276489258  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.883523941040039  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.889360427856445  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.889901161193848  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.889901161193848  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.889988899230957  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.8980607986450195  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([40, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.898555278778076  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.898555278778076  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.898631572723389  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.906184673309326  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.906665802001953  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.906665802001953  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.906734466552734  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.914012908935547  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.914593696594238  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.914593696594238  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.914669990539551  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.923291206359863  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.923857688903809  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.923857688903809  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.923928260803223  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.93239688873291  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.9330363273620605  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.9330363273620605  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.93311071395874  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.9425578117370605  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.943014144897461  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.943014144897461  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.943065643310547  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.9499664306640625  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.95040225982666  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.95040225982666  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.950448036193848  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.956902503967285  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.957626819610596  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.957626819610596  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.95769739151001  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.968142032623291  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.968677997589111  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.968677997589111  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.968729496002197  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.976711750030518  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([51, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.977851390838623  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.977851390838623  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.9779486656188965  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.993707180023193  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.994627475738525  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.994627475738525  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.9947075843811035  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.008245944976807  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([9112, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.228125095367432  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.228125095367432  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 9112, 256]), torch.Size([1, 9112, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 6.245504856109619  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.334217548370361  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 9112, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.107000827789307  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.10886526107788  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.111016750335693  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.10907793045044  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([9935, 47])
input nodes number: 95413
output nodes number: 9935
edges number: 238862
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.10933780670166  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 9.109338283538818  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1394062042236328  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

pseudo mini batch 19 input nodes size: 277934
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1154017448425293  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1154017448425293  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.21894025802612305  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.21901178359985352  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.11056232452392578  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1183633804321289  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1183633804321289  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

first layer input nodes number: 277934
first layer output nodes number: 83370
edges number: 813046
----------------------------------------before model layer 0
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.12105560302734375  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([277934, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.12105560302734375  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([166, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4331784248352051  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4331784248352051  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 166, 100]), torch.Size([1, 166, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4333024024963379  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4342927932739258  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 166, 100])
m.shape torch.Size([255, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4344210624694824  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4344210624694824  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 255, 100]), torch.Size([1, 255, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.43461179733276367  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.43746423721313477  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 255, 100])
m.shape torch.Size([434, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4378542900085449  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4378542900085449  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 434, 100]), torch.Size([1, 434, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.43817853927612305  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4452991485595703  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 434, 100])
m.shape torch.Size([520, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.44591188430786133  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.44591188430786133  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 520, 100]), torch.Size([1, 520, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.44630002975463867  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45753908157348633  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 520, 100])
m.shape torch.Size([645, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45854663848876953  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.45854663848876953  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 645, 100]), torch.Size([1, 645, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4590272903442383  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4763307571411133  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 645, 100])
m.shape torch.Size([738, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4777402877807617  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4777402877807617  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 738, 100]), torch.Size([1, 738, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.4782905578613281  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5023937225341797  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 738, 100])
m.shape torch.Size([824, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.504267692565918  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.504267692565918  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 824, 100]), torch.Size([1, 824, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5048818588256836  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5365390777587891  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 824, 100])
m.shape torch.Size([753, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5384764671325684  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5384764671325684  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 753, 100]), torch.Size([1, 753, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5390381813049316  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5716843605041504  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 753, 100])
m.shape torch.Size([807, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5741095542907715  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5741095542907715  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 807, 100]), torch.Size([1, 807, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.5747113227844238  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.6139583587646484  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 807, 100])
m.shape torch.Size([78228, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.9050798416137695  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.9050798416137695  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 78228, 100]), torch.Size([1, 78228, 100])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.9633646011352539  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.101568222045898  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 78228, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.799037456512451  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.87854528427124  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.958053112030029  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.87854528427124  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([83370, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.958053112030029  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.978202819824219  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 4.978202819824219  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.203474521636963  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.203474521636963  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.203484058380127  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2035603523254395  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.203573226928711  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.203573226928711  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.203590393066406  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.203847885131836  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([15, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.203882694244385  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.203882694244385  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.203911304473877  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.204540729522705  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.204592227935791  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.204592227935791  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.204624652862549  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.205564975738525  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([24, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.205664157867432  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.205664157867432  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.205709934234619  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.207357883453369  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([17, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.207433223724365  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.207433223724365  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.207465648651123  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.208859920501709  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([23, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.208998680114746  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.208998680114746  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.209042549133301  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.211236000061035  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([12, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.211306571960449  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.211306571960449  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.211329460144043  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.212634086608887  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([17, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.212769985198975  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.212769985198975  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.212802410125732  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.214877605438232  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.215044021606445  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.215044021606445  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.215080261230469  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.217653274536133  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([33, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.217984199523926  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.217984199523926  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.218047142028809  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.222956657409668  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([22, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.223179340362549  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.223179340362549  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.223221302032471  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.22678804397583  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.227017402648926  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.227017402648926  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.227055549621582  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.230565071105957  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([29, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.230936527252197  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.230936527252197  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.230991840362549  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2364678382873535  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.236887454986572  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.236887454986572  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2369465827941895  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.243214130401611  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([18, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.243461608886719  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.243461608886719  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.243495941162109  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.24737548828125  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([26, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.247783184051514  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.247783184051514  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.247832775115967  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.253783702850342  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.254191875457764  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.254191875457764  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.254239559173584  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.260295391082764  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.260801315307617  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.260801315307617  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.260856628417969  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.268268585205078  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2686448097229  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2686448097229  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.2686848640441895  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.274332523345947  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.274776935577393  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.274776935577393  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.274820804595947  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.281313419342041  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.282052993774414  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.282052993774414  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.282121658325195  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.292764663696289  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.293172836303711  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.293172836303711  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.293210983276367  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.29939079284668  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.299879550933838  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.299879550933838  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.29992151260376  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.307013034820557  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([9074, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.525023460388184  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.525023460388184  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

 h.shape torch.Size([1, 9074, 256]), torch.Size([1, 9074, 256])
----------------------------------------3
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 5.542330741882324  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.626330375671387  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

rst.shape  torch.Size([1, 9074, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.403475284576416  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.405210018157959  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.407433986663818  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.405627727508545  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

torch.Size([9587, 47])
input nodes number: 83370
output nodes number: 9587
edges number: 233980
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.406190872192383  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 8.406191349029541  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.1324477195739746  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.13753461837768555  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.1405029296875 GB
    Memory Allocated: 0.13753461837768555  GigaBytes
Max Memory Allocated: 10.54200029373169  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.06801142692565917 |0.021641552448272705 |0.19450533390045166 |9.802579879760742e-05 |0.10601675510406494 |0.004708051681518555 |
----------------------------------------------------------pseudo_mini_loss sum 5.387495040893555
Total (block generation + training)time/epoch 76.77126693725586
* Pure training time/epoch 7.81016993522644
Training time/epoch 7.934279680252075
Training time without block to device /epoch 7.501448631286621
Training time without total dataloading part /epoch 6.017110347747803
load block tensor time/epoch 1.3602285385131836
block to device time/epoch 0.4328310489654541
input features size transfer per epoch 2.682209014892578e-06
blocks size to device per epoch 1.7881393432617188e-06
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7155998
Number of first layer input nodes during this epoch:  5397591
Number of first layer output nodes during this epoch:  1758407
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  682400
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([400, 100])
layers.0.lstm.weight_hh_l0, torch.Size([400, 100])
layers.0.lstm.bias_ih_l0, torch.Size([400])
layers.0.lstm.bias_hh_l0, torch.Size([400])
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([47, 256])
layers.1.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
