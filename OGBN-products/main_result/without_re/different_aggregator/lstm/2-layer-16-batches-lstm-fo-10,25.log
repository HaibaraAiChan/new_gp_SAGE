main start at this time 1655789630.5509503
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.3064591884613037
global_2_local spend time (sec) 0.39727091789245605
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.04853177070617676
A = g.adjacency_matrix() spent  0.08197188377380371
auxiliary_graph
Graph(num_nodes=1205586, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.5987350940704346
remove nodes length
1009015
auxiliary_graph.remove_nodes spent  2.903273344039917
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.1600890159606934

the counter of shared neighbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
51547892
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 51547889, 51547890, 51547891])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
Convert a graph into a bidirected graph: 3.197 seconds
Metis partitioning: 12.674 seconds
Split the graph: 1.216 seconds
Construct subgraphs: 0.393 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  17.5022075176239
12544
11929
11928
12635
12607
12549
11927
12557
12454
12196
11957
11933
12653
11927
12142
12633
total k batches seeds list generation spend  40.35510540008545
after graph partition
graph partition algorithm spend time 40.92578959465027
12544
11929
11928
12635
12607
12549
11927
12557
12454
12196
11957
11933
12653
11927
12142
12633
partition_len_list
[115574, 91531, 103437, 107156, 111445, 105654, 91831, 80899, 120041, 87128, 105207, 123164, 119500, 101065, 119233, 119051]
shared_neighbor_graph_partition_s0 selection method  spend 41.58290457725525
time for parepare:  0.2590017318725586
local_output_nid generation:  0.0039000511169433594
local_in_edges_tensor generation:  0.004625558853149414
mini_batch_src_global generation:  0.009823322296142578
r_  generation:  0.10577225685119629
local_output_nid generation:  0.0043752193450927734
local_in_edges_tensor generation:  0.004374504089355469
mini_batch_src_global generation:  0.011896133422851562
r_  generation:  0.10391879081726074
local_output_nid generation:  0.004355669021606445
local_in_edges_tensor generation:  0.004467010498046875
mini_batch_src_global generation:  0.009555578231811523
r_  generation:  0.10943388938903809
local_output_nid generation:  0.004535675048828125
local_in_edges_tensor generation:  0.004675388336181641
mini_batch_src_global generation:  0.013849973678588867
r_  generation:  0.1204519271850586
local_output_nid generation:  0.005644321441650391
local_in_edges_tensor generation:  0.019900798797607422
mini_batch_src_global generation:  0.012076139450073242
r_  generation:  0.1259632110595703
local_output_nid generation:  0.0045888423919677734
local_in_edges_tensor generation:  0.022583723068237305
mini_batch_src_global generation:  0.019231319427490234
r_  generation:  0.12590312957763672
local_output_nid generation:  0.004378795623779297
local_in_edges_tensor generation:  0.008435964584350586
mini_batch_src_global generation:  0.011919021606445312
r_  generation:  0.11353325843811035
local_output_nid generation:  0.004561424255371094
local_in_edges_tensor generation:  0.005527019500732422
mini_batch_src_global generation:  0.01648855209350586
r_  generation:  0.10998988151550293
local_output_nid generation:  0.005868434906005859
local_in_edges_tensor generation:  0.004625082015991211
mini_batch_src_global generation:  0.013092041015625
r_  generation:  0.11713886260986328
local_output_nid generation:  0.00444340705871582
local_in_edges_tensor generation:  0.004366159439086914
mini_batch_src_global generation:  0.012183666229248047
r_  generation:  0.1094048023223877
local_output_nid generation:  0.004381656646728516
local_in_edges_tensor generation:  0.0041599273681640625
mini_batch_src_global generation:  0.011014938354492188
r_  generation:  0.10801267623901367
local_output_nid generation:  0.004374265670776367
local_in_edges_tensor generation:  0.005753040313720703
mini_batch_src_global generation:  0.013261556625366211
r_  generation:  0.11728358268737793
local_output_nid generation:  0.004633665084838867
local_in_edges_tensor generation:  0.004460811614990234
mini_batch_src_global generation:  0.012848615646362305
r_  generation:  0.13115596771240234
local_output_nid generation:  0.004372596740722656
local_in_edges_tensor generation:  0.005151987075805664
mini_batch_src_global generation:  0.013136148452758789
r_  generation:  0.12525701522827148
local_output_nid generation:  0.004443645477294922
local_in_edges_tensor generation:  0.00429081916809082
mini_batch_src_global generation:  0.012928247451782227
r_  generation:  0.12946486473083496
local_output_nid generation:  0.0046117305755615234
local_in_edges_tensor generation:  0.004357576370239258
mini_batch_src_global generation:  0.014862775802612305
r_  generation:  0.13583970069885254
----------------------check_connections_block total spend ----------------------------- 2.9790992736816406
generate_one_block  1.5473761558532715
generate_one_block  0.1479477882385254
generate_one_block  0.1456742286682129
generate_one_block  0.1649487018585205
generate_one_block  0.1564335823059082
generate_one_block  0.15184807777404785
generate_one_block  0.13989615440368652
generate_one_block  0.14091277122497559
generate_one_block  0.1515185832977295
generate_one_block  0.1389479637145996
generate_one_block  0.13626432418823242
generate_one_block  0.1549816131591797
generate_one_block  0.16320562362670898
generate_one_block  0.14566373825073242
generate_one_block  0.15644383430480957
generate_one_block  0.16296982765197754
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6621644496917725
gen group dst list time:  0.04895758628845215
time for parepare:  0.3947114944458008
local_output_nid generation:  0.028123140335083008
local_in_edges_tensor generation:  0.08245730400085449
mini_batch_src_global generation:  0.03323078155517578
r_  generation:  0.44457054138183594
local_output_nid generation:  0.027141809463500977
local_in_edges_tensor generation:  0.033036231994628906
mini_batch_src_global generation:  0.038976192474365234
r_  generation:  0.3609635829925537
local_output_nid generation:  0.031351327896118164
local_in_edges_tensor generation:  0.05957913398742676
mini_batch_src_global generation:  0.03789782524108887
r_  generation:  0.4537160396575928
local_output_nid generation:  0.0303494930267334
local_in_edges_tensor generation:  0.036853790283203125
mini_batch_src_global generation:  0.046146392822265625
r_  generation:  0.460888147354126
local_output_nid generation:  0.029711008071899414
local_in_edges_tensor generation:  0.031026363372802734
mini_batch_src_global generation:  0.04624295234680176
r_  generation:  0.49007558822631836
local_output_nid generation:  0.029481887817382812
local_in_edges_tensor generation:  0.028992891311645508
mini_batch_src_global generation:  0.04813265800476074
r_  generation:  0.46326112747192383
local_output_nid generation:  0.026017189025878906
local_in_edges_tensor generation:  0.025371313095092773
mini_batch_src_global generation:  0.040012359619140625
r_  generation:  0.4044456481933594
local_output_nid generation:  0.021418333053588867
local_in_edges_tensor generation:  0.018331050872802734
mini_batch_src_global generation:  0.03655195236206055
r_  generation:  0.3290085792541504
local_output_nid generation:  0.03949379920959473
local_in_edges_tensor generation:  0.05582308769226074
mini_batch_src_global generation:  0.04631948471069336
r_  generation:  0.5664193630218506
local_output_nid generation:  0.0229189395904541
local_in_edges_tensor generation:  0.029831409454345703
mini_batch_src_global generation:  0.04166817665100098
r_  generation:  0.3750734329223633
local_output_nid generation:  0.031010150909423828
local_in_edges_tensor generation:  0.030520915985107422
mini_batch_src_global generation:  0.04100632667541504
r_  generation:  0.5288798809051514
local_output_nid generation:  0.03494620323181152
local_in_edges_tensor generation:  0.03821277618408203
mini_batch_src_global generation:  0.05478382110595703
r_  generation:  0.6055154800415039
local_output_nid generation:  0.032677650451660156
local_in_edges_tensor generation:  0.02915477752685547
mini_batch_src_global generation:  0.05015873908996582
r_  generation:  0.5629420280456543
local_output_nid generation:  0.02730107307434082
local_in_edges_tensor generation:  0.023302078247070312
mini_batch_src_global generation:  0.04781150817871094
r_  generation:  0.45439815521240234
local_output_nid generation:  0.0335850715637207
local_in_edges_tensor generation:  0.029356718063354492
mini_batch_src_global generation:  0.051935434341430664
r_  generation:  0.567002534866333
local_output_nid generation:  0.03823447227478027
local_in_edges_tensor generation:  0.03179645538330078
mini_batch_src_global generation:  0.053449153900146484
r_  generation:  0.5578830242156982
----------------------check_connections_block total spend ----------------------------- 11.445604801177979
generate_one_block  0.8949778079986572
generate_one_block  0.5654375553131104
generate_one_block  0.571420431137085
generate_one_block  0.5484292507171631
generate_one_block  0.5945956707000732
generate_one_block  0.5435876846313477
generate_one_block  0.47210144996643066
generate_one_block  0.3801133632659912
generate_one_block  0.6461873054504395
generate_one_block  0.448272705078125
generate_one_block  0.5623760223388672
generate_one_block  0.7143881320953369
generate_one_block  0.6482882499694824
generate_one_block  0.5235652923583984
generate_one_block  0.6485333442687988
generate_one_block  0.6302485466003418
----------===============-------------===============-------------the number of batches *****---- 16

original number of batches:  16
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

connection checking time:  14.42470407485962
block generation total time  13.197555780410767
average batch blocks generation time:  0.41242361813783646
block dataloader generation time/epoch 71.26172494888306
pseudo mini batch 0 input nodes size: 336152
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1463623046875 GB
    Memory Allocated: 0.12776994705200195  GigaBytes
Max Memory Allocated: 0.12776994705200195  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1463623046875 GB
    Memory Allocated: 0.12786340713500977  GigaBytes
Max Memory Allocated: 0.12786340713500977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1463623046875 GB
    Memory Allocated: 0.12786340713500977  GigaBytes
Max Memory Allocated: 0.12786340713500977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.13904619216918945  GigaBytes
Max Memory Allocated: 0.13904619216918945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.13904619216918945  GigaBytes
Max Memory Allocated: 0.13904619216918945  GigaBytes

first layer input nodes number: 336152
first layer output nodes number: 115574
edges number: 1117023
----------------------------------------before model layer 0
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.1424121856689453  GigaBytes
Max Memory Allocated: 0.14657354354858398  GigaBytes

torch.Size([336152, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2303466796875 GB
    Memory Allocated: 0.1424121856689453  GigaBytes
Max Memory Allocated: 0.14657354354858398  GigaBytes

m.shape torch.Size([368, 1, 100])
----------------------------------------1
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.5704479217529297  GigaBytes
Max Memory Allocated: 0.5880961418151855  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.5704479217529297  GigaBytes
Max Memory Allocated: 0.5880961418151855  GigaBytes

 h.shape torch.Size([1, 368, 100]), torch.Size([1, 368, 100])
----------------------------------------3
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.5707225799560547  GigaBytes
Max Memory Allocated: 0.5880961418151855  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.5729169845581055  GigaBytes
Max Memory Allocated: 0.5880961418151855  GigaBytes

rst.shape  torch.Size([1, 368, 100])
m.shape torch.Size([572, 2, 100])
----------------------------------------1
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.5732059478759766  GigaBytes
Max Memory Allocated: 0.5880961418151855  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.5732059478759766  GigaBytes
Max Memory Allocated: 0.5880961418151855  GigaBytes

 h.shape torch.Size([1, 572, 100]), torch.Size([1, 572, 100])
----------------------------------------3
 Nvidia-smi: 1.8104248046875 GB
    Memory Allocated: 0.5736322402954102  GigaBytes
Max Memory Allocated: 0.5880961418151855  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8162841796875 GB
    Memory Allocated: 0.5800266265869141  GigaBytes
Max Memory Allocated: 0.5880961418151855  GigaBytes

rst.shape  torch.Size([1, 572, 100])
m.shape torch.Size([780, 3, 100])
----------------------------------------1
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.5806856155395508  GigaBytes
Max Memory Allocated: 0.5880961418151855  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.5806856155395508  GigaBytes
Max Memory Allocated: 0.5880961418151855  GigaBytes

 h.shape torch.Size([1, 780, 100]), torch.Size([1, 780, 100])
----------------------------------------3
 Nvidia-smi: 1.8182373046875 GB
    Memory Allocated: 0.5812673568725586  GigaBytes
Max Memory Allocated: 0.5880961418151855  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8221435546875 GB
    Memory Allocated: 0.5958952903747559  GigaBytes
Max Memory Allocated: 0.5967674255371094  GigaBytes

rst.shape  torch.Size([1, 780, 100])
m.shape torch.Size([987, 4, 100])
----------------------------------------1
 Nvidia-smi: 1.8221435546875 GB
    Memory Allocated: 0.5970754623413086  GigaBytes
Max Memory Allocated: 0.5971198081970215  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8221435546875 GB
    Memory Allocated: 0.5970754623413086  GigaBytes
Max Memory Allocated: 0.5971198081970215  GigaBytes

 h.shape torch.Size([1, 987, 100]), torch.Size([1, 987, 100])
----------------------------------------3
 Nvidia-smi: 1.8221435546875 GB
    Memory Allocated: 0.5978116989135742  GigaBytes
Max Memory Allocated: 0.5978116989135742  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.6201128959655762  GigaBytes
Max Memory Allocated: 0.6215839385986328  GigaBytes

rst.shape  torch.Size([1, 987, 100])
m.shape torch.Size([1173, 5, 100])
----------------------------------------1
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.6219301223754883  GigaBytes
Max Memory Allocated: 0.6219959259033203  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.6219301223754883  GigaBytes
Max Memory Allocated: 0.6219959259033203  GigaBytes

 h.shape torch.Size([1, 1173, 100]), torch.Size([1, 1173, 100])
----------------------------------------3
 Nvidia-smi: 1.8260498046875 GB
    Memory Allocated: 0.6228046417236328  GigaBytes
Max Memory Allocated: 0.6228046417236328  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.6549086570739746  GigaBytes
Max Memory Allocated: 0.6570940017700195  GigaBytes

rst.shape  torch.Size([1, 1173, 100])
m.shape torch.Size([1306, 6, 100])
----------------------------------------1
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.6573905944824219  GigaBytes
Max Memory Allocated: 0.6574788093566895  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8709716796875 GB
    Memory Allocated: 0.6573905944824219  GigaBytes
Max Memory Allocated: 0.6574788093566895  GigaBytes

 h.shape torch.Size([1, 1306, 100]), torch.Size([1, 1306, 100])
----------------------------------------3
 Nvidia-smi: 1.8729248046875 GB
    Memory Allocated: 0.6583642959594727  GigaBytes
Max Memory Allocated: 0.6583642959594727  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.7002830505371094  GigaBytes
Max Memory Allocated: 0.7032022476196289  GigaBytes

rst.shape  torch.Size([1, 1306, 100])
m.shape torch.Size([1354, 7, 100])
----------------------------------------1
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.7033271789550781  GigaBytes
Max Memory Allocated: 0.7034339904785156  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9178466796875 GB
    Memory Allocated: 0.7033271789550781  GigaBytes
Max Memory Allocated: 0.7034339904785156  GigaBytes

 h.shape torch.Size([1, 1354, 100]), torch.Size([1, 1354, 100])
----------------------------------------3
 Nvidia-smi: 1.9197998046875 GB
    Memory Allocated: 0.7043361663818359  GigaBytes
Max Memory Allocated: 0.7043361663818359  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.7547855377197266  GigaBytes
Max Memory Allocated: 0.7583165168762207  GigaBytes

rst.shape  torch.Size([1, 1354, 100])
m.shape torch.Size([1470, 8, 100])
----------------------------------------1
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.758662223815918  GigaBytes
Max Memory Allocated: 0.758793830871582  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9686279296875 GB
    Memory Allocated: 0.758662223815918  GigaBytes
Max Memory Allocated: 0.758793830871582  GigaBytes

 h.shape torch.Size([1, 1470, 100]), torch.Size([1, 1470, 100])
----------------------------------------3
 Nvidia-smi: 1.9705810546875 GB
    Memory Allocated: 0.7597579956054688  GigaBytes
Max Memory Allocated: 0.7597579956054688  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0604248046875 GB
    Memory Allocated: 0.8230457305908203  GigaBytes
Max Memory Allocated: 0.8274269104003906  GigaBytes

rst.shape  torch.Size([1, 1470, 100])
m.shape torch.Size([1356, 9, 100])
----------------------------------------1
 Nvidia-smi: 2.0604248046875 GB
    Memory Allocated: 0.8270444869995117  GigaBytes
Max Memory Allocated: 0.8274269104003906  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0604248046875 GB
    Memory Allocated: 0.8270444869995117  GigaBytes
Max Memory Allocated: 0.8274269104003906  GigaBytes

 h.shape torch.Size([1, 1356, 100]), torch.Size([1, 1356, 100])
----------------------------------------3
 Nvidia-smi: 2.0604248046875 GB
    Memory Allocated: 0.8280553817749023  GigaBytes
Max Memory Allocated: 0.8280553817749023  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1326904296875 GB
    Memory Allocated: 0.8937211036682129  GigaBytes
Max Memory Allocated: 0.8982677459716797  GigaBytes

rst.shape  torch.Size([1, 1356, 100])
m.shape torch.Size([106208, 10, 100])
----------------------------------------1
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 1.2897000312805176  GigaBytes
Max Memory Allocated: 1.301569938659668  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.5291748046875 GB
    Memory Allocated: 1.2897000312805176  GigaBytes
Max Memory Allocated: 1.301569938659668  GigaBytes

 h.shape torch.Size([1, 106208, 100]), torch.Size([1, 106208, 100])
----------------------------------------3
 Nvidia-smi: 2.6112060546875 GB
    Memory Allocated: 1.3688311576843262  GigaBytes
Max Memory Allocated: 1.3688311576843262  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 6.987141132354736  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 106208, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 6.572344779968262  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 6.682564735412598  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 6.792784690856934  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 6.682564735412598  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

torch.Size([115574, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 6.792784690856934  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 6.820339679718018  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 6.820339679718018  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.113556385040283  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.113556385040283  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.11356782913208  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.113659381866455  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.113675117492676  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.113675117492676  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.113696098327637  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.114010810852051  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([18, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.1140522956848145  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.1140522956848145  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.114086627960205  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.114841938018799  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([22, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.114909648895264  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.114909648895264  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.1149516105651855  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.11616849899292  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([27, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.116277694702148  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.116277694702148  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.116329193115234  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.118183135986328  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([29, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.1183247566223145  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.1183247566223145  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.118380069732666  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.120758533477783  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([41, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.121006965637207  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.121006965637207  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.121085166931152  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.124995231628418  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([36, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.125233173370361  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.125233173370361  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.125301837921143  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.129215717315674  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([37, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.129501819610596  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.129501819610596  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 8.7147216796875 GB
    Memory Allocated: 7.12957239151001  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7186279296875 GB
    Memory Allocated: 7.13408899307251  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([38, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.7186279296875 GB
    Memory Allocated: 7.134418964385986  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7186279296875 GB
    Memory Allocated: 7.134418964385986  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 8.7186279296875 GB
    Memory Allocated: 7.134491443634033  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7244873046875 GB
    Memory Allocated: 7.139637470245361  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([39, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.7244873046875 GB
    Memory Allocated: 7.140013694763184  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7244873046875 GB
    Memory Allocated: 7.140013694763184  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 8.7244873046875 GB
    Memory Allocated: 7.140088081359863  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7303466796875 GB
    Memory Allocated: 7.145890235900879  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([34, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.7303466796875 GB
    Memory Allocated: 7.14624547958374  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7303466796875 GB
    Memory Allocated: 7.14624547958374  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 8.7303466796875 GB
    Memory Allocated: 7.146310329437256  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7362060546875 GB
    Memory Allocated: 7.151822566986084  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([52, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.7362060546875 GB
    Memory Allocated: 7.152440071105957  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7362060546875 GB
    Memory Allocated: 7.152440071105957  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 8.7362060546875 GB
    Memory Allocated: 7.152539253234863  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7459716796875 GB
    Memory Allocated: 7.161664009094238  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.7479248046875 GB
    Memory Allocated: 7.162341117858887  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7479248046875 GB
    Memory Allocated: 7.162341117858887  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 8.7479248046875 GB
    Memory Allocated: 7.162444114685059  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 7.172640800476074  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([37, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 7.173122882843018  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 7.173122882843018  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 8.7576904296875 GB
    Memory Allocated: 7.173193454742432  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7655029296875 GB
    Memory Allocated: 7.180674076080322  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([50, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.7674560546875 GB
    Memory Allocated: 7.181407928466797  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7674560546875 GB
    Memory Allocated: 7.181407928466797  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 8.7674560546875 GB
    Memory Allocated: 7.1815032958984375  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7772216796875 GB
    Memory Allocated: 7.192279815673828  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([57, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.7791748046875 GB
    Memory Allocated: 7.193163871765137  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7791748046875 GB
    Memory Allocated: 7.193163871765137  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 8.7791748046875 GB
    Memory Allocated: 7.193272590637207  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.7928466796875 GB
    Memory Allocated: 7.2063188552856445  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([38, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.7928466796875 GB
    Memory Allocated: 7.2069220542907715  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7928466796875 GB
    Memory Allocated: 7.2069220542907715  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 8.7928466796875 GB
    Memory Allocated: 7.206994533538818  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8026123046875 GB
    Memory Allocated: 7.2161993980407715  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.8026123046875 GB
    Memory Allocated: 7.216784477233887  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8026123046875 GB
    Memory Allocated: 7.216784477233887  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 8.8026123046875 GB
    Memory Allocated: 7.216849327087402  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8104248046875 GB
    Memory Allocated: 7.225539207458496  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([29, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.8104248046875 GB
    Memory Allocated: 7.226064682006836  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8104248046875 GB
    Memory Allocated: 7.226064682006836  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 8.8104248046875 GB
    Memory Allocated: 7.2261199951171875  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8201904296875 GB
    Memory Allocated: 7.233919143676758  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([42, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.8201904296875 GB
    Memory Allocated: 7.234739303588867  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8201904296875 GB
    Memory Allocated: 7.234739303588867  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 8.8201904296875 GB
    Memory Allocated: 7.234819412231445  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 7.246675491333008  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 7.247312068939209  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 7.247312068939209  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 8.8319091796875 GB
    Memory Allocated: 7.247373104095459  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8416748046875 GB
    Memory Allocated: 7.256833553314209  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([49, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.8416748046875 GB
    Memory Allocated: 7.258155345916748  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8416748046875 GB
    Memory Allocated: 7.258155345916748  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 8.8416748046875 GB
    Memory Allocated: 7.258248805999756  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8572998046875 GB
    Memory Allocated: 7.2733893394470215  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([48, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.8572998046875 GB
    Memory Allocated: 7.274720668792725  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8572998046875 GB
    Memory Allocated: 7.274720668792725  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 8.8572998046875 GB
    Memory Allocated: 7.2748122215271  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8729248046875 GB
    Memory Allocated: 7.290284633636475  GigaBytes
Max Memory Allocated: 7.383625507354736  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([11684, 25, 256])
----------------------------------------1
 Nvidia-smi: 9.1522216796875 GB
    Memory Allocated: 7.571712493896484  GigaBytes
Max Memory Allocated: 7.57316255569458  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.1522216796875 GB
    Memory Allocated: 7.571712493896484  GigaBytes
Max Memory Allocated: 7.57316255569458  GigaBytes

 h.shape torch.Size([1, 11684, 256]), torch.Size([1, 11684, 256])
----------------------------------------3
 Nvidia-smi: 9.1522216796875 GB
    Memory Allocated: 7.594139099121094  GigaBytes
Max Memory Allocated: 7.594139099121094  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.1815185546875 GB
    Memory Allocated: 11.566993713378906  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 11684, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.1815185546875 GB
    Memory Allocated: 11.276268005371094  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.1815185546875 GB
    Memory Allocated: 11.278576374053955  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.1815185546875 GB
    Memory Allocated: 11.281000137329102  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.1815185546875 GB
    Memory Allocated: 11.278598308563232  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

torch.Size([12544, 47])
input nodes number: 115574
output nodes number: 12544
edges number: 304235
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.1815185546875 GB
    Memory Allocated: 11.281749248504639  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.1815185546875 GB
    Memory Allocated: 11.281750202178955  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.16263437271118164  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

pseudo mini batch 1 input nodes size: 254181
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.13260412216186523  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.13260412216186523  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.2272939682006836  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.22738313674926758  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.10206317901611328  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.11076736450195312  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.11076736450195312  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

first layer input nodes number: 254181
first layer output nodes number: 91531
edges number: 880217
----------------------------------------before model layer 0
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.11334371566772461  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

torch.Size([254181, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.11334371566772461  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

m.shape torch.Size([359, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.45067739486694336  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.45067739486694336  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 359, 100]), torch.Size([1, 359, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.4509453773498535  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.45308637619018555  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 359, 100])
m.shape torch.Size([525, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.45334386825561523  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.45334386825561523  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 525, 100]), torch.Size([1, 525, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.4537358283996582  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.4596066474914551  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 525, 100])
m.shape torch.Size([736, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.460233211517334  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.460233211517334  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 736, 100]), torch.Size([1, 736, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.4607815742492676  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.4736318588256836  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 736, 100])
m.shape torch.Size([886, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.47467803955078125  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.47467803955078125  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 886, 100]), torch.Size([1, 886, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.4753389358520508  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.49454689025878906  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 886, 100])
m.shape torch.Size([1076, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.49622106552124023  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.49622106552124023  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 1076, 100]), torch.Size([1, 1076, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.4970231056213379  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5268764495849609  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 1076, 100])
m.shape torch.Size([1124, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5289878845214844  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5289878845214844  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 1124, 100]), torch.Size([1, 1124, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5298261642456055  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5666770935058594  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 1124, 100])
m.shape torch.Size([1202, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5693926811218262  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5693926811218262  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 1202, 100]), torch.Size([1, 1202, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.570289134979248  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6179914474487305  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 1202, 100])
m.shape torch.Size([1254, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6212806701660156  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6212806701660156  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 1254, 100]), torch.Size([1, 1254, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6222152709960938  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6775016784667969  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 1254, 100])
m.shape torch.Size([1204, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6810712814331055  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6810712814331055  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 1204, 100]), torch.Size([1, 1204, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6819686889648438  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.7435564994812012  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 1204, 100])
m.shape torch.Size([83165, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.0529217720031738  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.0529217720031738  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 83165, 100]), torch.Size([1, 83165, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.114884853363037  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.514249324798584  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 83165, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.187746047973633  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.275036811828613  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.362327575683594  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.275036811828613  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

torch.Size([91531, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.362327575683594  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.384150505065918  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.384150505065918  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

m.shape torch.Size([17, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.662216663360596  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.662216663360596  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.6622490882873535  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.662508487701416  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([22, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.662534713745117  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.662534713745117  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.662576675415039  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.663206100463867  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.66323709487915  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.66323709487915  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.663271427154541  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.664026737213135  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([27, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.664113521575928  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.664113521575928  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.664165019989014  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.665658473968506  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([39, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.665820598602295  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.665820598602295  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.665894985198975  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.668572902679443  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([41, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.668772220611572  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.668772220611572  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.668850421905518  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.672213077545166  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([44, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.6724700927734375  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.6724700927734375  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.672554016113281  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.676750183105469  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([36, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.676985263824463  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.676985263824463  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.677053928375244  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.680967807769775  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([29, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.681184768676758  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.681184768676758  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.681240081787109  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.684780120849609  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([42, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.685156345367432  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.685156345367432  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.68523645401001  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.690924167633057  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([44, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.691349506378174  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.691349506378174  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.691433429718018  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.69797945022583  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([48, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.698491096496582  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.698491096496582  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.698582649230957  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.706364631652832  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.7068562507629395  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.7068562507629395  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.70693826675415  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.714483737945557  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.71500825881958  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.71500825881958  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.715088367462158  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.723019123077393  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.723498344421387  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.723498344421387  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.723567008972168  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.7308454513549805  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([43, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.731472492218018  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.731472492218018  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.7315545082092285  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.7408223152160645  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([40, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.7414350509643555  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.7414350509643555  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.741511344909668  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.750666618347168  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.751199722290039  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.751199722290039  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.751262664794922  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.759256362915039  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([39, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.759937286376953  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.759937286376953  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.760011672973633  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.769979476928711  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([46, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.770826816558838  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.770826816558838  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.770914554595947  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.783285617828369  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.783988952636719  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.783988952636719  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.784059524536133  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.794504165649414  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([50, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.796145439147949  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.796145439147949  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.79624080657959  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.811022758483887  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([46, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.81265115737915  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.81265115737915  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.81273889541626  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.8269524574279785  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([43, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.827906131744385  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.827906131744385  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.827988147735596  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.841848850250244  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([11024, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.1067728996276855  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.1067728996276855  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 11024, 256]), torch.Size([1, 11024, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.1277995109558105  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 9.82848310470581  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 11024, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 9.554563045501709  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 9.55666446685791  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 9.559051036834717  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 9.556860446929932  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

torch.Size([11929, 47])
input nodes number: 91531
output nodes number: 11929
edges number: 287878
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 9.557537078857422  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 9.55753755569458  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.127685546875  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

pseudo mini batch 2 input nodes size: 332365
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.10196828842163086  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.10196828842163086  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.2257843017578125  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.22587347030639648  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.13109445571899414  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.14173507690429688  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.14173507690429688  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

first layer input nodes number: 332365
first layer output nodes number: 103437
edges number: 1007013
----------------------------------------before model layer 0
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.14498281478881836  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

torch.Size([332365, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.14498281478881836  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

m.shape torch.Size([200, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5307931900024414  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5307931900024414  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 200, 100]), torch.Size([1, 200, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5309429168701172  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5321364402770996  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 200, 100])
m.shape torch.Size([347, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.532320499420166  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.532320499420166  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 347, 100]), torch.Size([1, 347, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5325798988342285  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5364623069763184  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 347, 100])
m.shape torch.Size([559, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5369577407836914  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5369577407836914  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 559, 100]), torch.Size([1, 559, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5373744964599609  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5465388298034668  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 559, 100])
m.shape torch.Size([735, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5480690002441406  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5480690002441406  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 735, 100]), torch.Size([1, 735, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5486173629760742  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.565432071685791  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 735, 100])
m.shape torch.Size([832, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.567018985748291  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.567018985748291  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 832, 100]), torch.Size([1, 832, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5676388740539551  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5905156135559082  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 832, 100])
m.shape torch.Size([990, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5924186706542969  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5924186706542969  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 990, 100]), torch.Size([1, 990, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5931568145751953  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6254715919494629  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 990, 100])
m.shape torch.Size([1082, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6279244422912598  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6279244422912598  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 1082, 100]), torch.Size([1, 1082, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6287312507629395  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6699118614196777  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 1082, 100])
m.shape torch.Size([997, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.673163890838623  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.673163890838623  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 997, 100]), torch.Size([1, 997, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6739068031311035  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.7162528038024902  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 997, 100])
m.shape torch.Size([1098, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.7195630073547363  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.7195630073547363  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 1098, 100]), torch.Size([1, 1098, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.7203812599182129  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.7738456726074219  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 1098, 100])
m.shape torch.Size([96597, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.133288860321045  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.133288860321045  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 96597, 100]), torch.Size([1, 96597, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.2059063911437988  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.31581449508667  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 96597, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 5.941285610198975  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.039930820465088  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.138576030731201  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.039930820465088  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

torch.Size([103437, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.138576030731201  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.163237571716309  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.163237571716309  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.443463325500488  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.443463325500488  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.443476676940918  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.4435834884643555  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.443594455718994  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.443594455718994  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.4436116218566895  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.443869113922119  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([15, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.443903923034668  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.443903923034668  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.44393253326416  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.444561958312988  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([31, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.444666862487793  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.444666862487793  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.44472599029541  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.446440696716309  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([24, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.446526527404785  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.446526527404785  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.446572303771973  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.448220252990723  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([24, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.448336124420166  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.448336124420166  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.4483819007873535  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.450350284576416  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([31, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.450536251068115  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.450536251068115  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.450595378875732  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.453551769256592  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([21, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.453683853149414  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.453683853149414  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.453723907470703  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.45600700378418  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([26, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.456212043762207  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.456212043762207  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.45626163482666  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.45943546295166  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([32, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.459718227386475  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.459718227386475  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.459779262542725  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.464112758636475  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([43, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.464537143707275  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.464537143707275  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.464619159698486  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.4710164070129395  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([29, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.471310138702393  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.471310138702393  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.471365451812744  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.476067066192627  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([29, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.4764018058776855  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.4764018058776855  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.476457118988037  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.481545925140381  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.4820027351379395  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.4820027351379395  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.482071399688721  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.4888691902160645  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.489339828491211  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.489339828491211  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.489406585693359  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.496482849121094  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.496803283691406  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.496803283691406  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.496847152709961  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.501804351806641  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.502305507659912  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.502305507659912  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.502366542816162  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.509690761566162  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([34, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.51024866104126  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.51024866104126  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.510313510894775  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.51854944229126  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.519064903259277  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.519064903259277  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.519122123718262  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.526789665222168  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.527261257171631  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.527261257171631  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.527310848236084  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.534303188323975  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.53500509262085  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.53500509262085  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.535073757171631  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.545236110687256  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([41, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.546069145202637  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.546069145202637  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.546147346496582  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.5582685470581055  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.558959007263184  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.558959007263184  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.559021949768066  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.569218635559082  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([28, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.569833278656006  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.569833278656006  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.569886684417725  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.578912258148193  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([11253, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.8496599197387695  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.8496599197387695  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 11253, 256]), torch.Size([1, 11253, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.871123313903809  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 10.648680686950684  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 11253, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 10.37189245223999  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 10.37398099899292  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 10.37606954574585  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 10.373891830444336  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

torch.Size([11928, 47])
input nodes number: 103437
output nodes number: 11928
edges number: 290652
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 10.375401973724365  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 10.375402450561523  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.16001224517822266  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

pseudo mini batch 3 input nodes size: 287148
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.131744384765625  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.131744384765625  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.23871564865112305  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.23881006240844727  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.11490488052368164  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.12486124038696289  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.12486124038696289  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

first layer input nodes number: 287148
first layer output nodes number: 107156
edges number: 1030545
----------------------------------------before model layer 0
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.12779951095581055  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

torch.Size([287148, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.12779951095581055  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

m.shape torch.Size([363, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.522925853729248  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.522925853729248  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 363, 100]), torch.Size([1, 363, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5231966972351074  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5253620147705078  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 363, 100])
m.shape torch.Size([593, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5256686210632324  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5256686210632324  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 593, 100]), torch.Size([1, 593, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5261111259460449  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.532742977142334  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 593, 100])
m.shape torch.Size([874, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5342841148376465  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5342841148376465  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 874, 100]), torch.Size([1, 874, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.534935474395752  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5492653846740723  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 874, 100])
m.shape torch.Size([1066, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5505285263061523  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5505285263061523  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 1066, 100]), torch.Size([1, 1066, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5513229370117188  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5744071006774902  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 1066, 100])
m.shape torch.Size([1288, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5764093399047852  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5764093399047852  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 1288, 100]), torch.Size([1, 1288, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.5773696899414062  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6123905181884766  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 1288, 100])
m.shape torch.Size([1375, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6159520149230957  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6159520149230957  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 1375, 100]), torch.Size([1, 1375, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6169772148132324  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6610350608825684  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 1375, 100])
m.shape torch.Size([1433, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6642594337463379  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6642594337463379  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 1433, 100]), torch.Size([1, 1433, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.6653275489807129  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.7187232971191406  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 1433, 100])
m.shape torch.Size([1412, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.7223973274230957  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.7223973274230957  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 1412, 100]), torch.Size([1, 1412, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.7234501838684082  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.7834286689758301  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 1412, 100])
m.shape torch.Size([1427, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.787686824798584  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.787686824798584  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 1427, 100]), torch.Size([1, 1427, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.788750171661377  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 0.8574032783508301  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 1427, 100])
m.shape torch.Size([97325, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.219435691833496  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.219435691833496  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 97325, 100]), torch.Size([1, 97325, 100])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 1.2919492721557617  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.440370559692383  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 97325, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.058117389678955  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.160309314727783  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.262501239776611  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.160309314727783  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

torch.Size([107156, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.262501239776611  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.288049221038818  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.288049221038818  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

m.shape torch.Size([10, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.582272529602051  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.582272529602051  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.582291603088379  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.582444190979004  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([16, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.582465648651123  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.582465648651123  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.582496166229248  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.582953929901123  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([27, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.583016872406006  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.583016872406006  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.583068370819092  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.584201335906982  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.584252834320068  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.584252834320068  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.584290981292725  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.585397243499756  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([32, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.585532188415527  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.585532188415527  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.585593223571777  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.587790489196777  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([40, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.587990760803223  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.587990760803223  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.588067054748535  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.591347694396973  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([34, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.591538429260254  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.591538429260254  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.5916032791137695  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.594845771789551  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([40, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.595120906829834  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.595120906829834  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.5951972007751465  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.599545955657959  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([38, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.599836826324463  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.599836826324463  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.59990930557251  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.60454797744751  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([42, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.604915618896484  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.604915618896484  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.6049957275390625  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.610683441162109  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([47, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.611140727996826  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.611140727996826  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.611230373382568  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.618222713470459  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([37, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.61860466003418  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.61860466003418  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.618675231933594  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.624673843383789  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([54, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.6253132820129395  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.6253132820129395  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.625416278839111  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.634891986846924  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([42, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.635406017303467  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.635406017303467  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.635486125946045  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.643416881561279  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([47, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.644054889678955  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.644054889678955  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.644144535064697  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.653646945953369  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([46, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.6543097496032715  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.6543097496032715  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.654397487640381  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.66431188583374  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([37, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.664872646331787  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.664872646331787  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.664943218231201  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.673411846160889  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.674051284790039  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.674051284790039  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.674125671386719  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.683572769165039  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.684503555297852  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.684503555297852  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.684604644775391  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.698150634765625  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([51, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.699080467224121  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.699080467224121  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.6991777420043945  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.712893486022949  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.7137532234191895  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.7137532234191895  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.713839054107666  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.726541996002197  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([52, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.727604389190674  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.727604389190674  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.72770357131958  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.743076801300049  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([62, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.74451208114624  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.74451208114624  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 13.7713623046875 GB
    Memory Allocated: 6.744630336761475  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7772216796875 GB
    Memory Allocated: 6.763787746429443  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([40, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.7772216796875 GB
    Memory Allocated: 6.764651298522949  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7772216796875 GB
    Memory Allocated: 6.764651298522949  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 13.7772216796875 GB
    Memory Allocated: 6.764727592468262  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7908935546875 GB
    Memory Allocated: 6.777621269226074  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([11684, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.7908935546875 GB
    Memory Allocated: 7.058328151702881  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7908935546875 GB
    Memory Allocated: 7.058328151702881  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 11684, 256]), torch.Size([1, 11684, 256])
----------------------------------------3
 Nvidia-smi: 13.7908935546875 GB
    Memory Allocated: 7.081765651702881  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7908935546875 GB
    Memory Allocated: 11.036988735198975  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 11684, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7908935546875 GB
    Memory Allocated: 10.746249675750732  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7908935546875 GB
    Memory Allocated: 10.748831748962402  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7908935546875 GB
    Memory Allocated: 10.751044273376465  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7908935546875 GB
    Memory Allocated: 10.74836778640747  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

torch.Size([12635, 47])
input nodes number: 107156
output nodes number: 12635
edges number: 305548
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7908935546875 GB
    Memory Allocated: 10.749091625213623  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.7908935546875 GB
    Memory Allocated: 10.749092102050781  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.14197540283203125  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

pseudo mini batch 4 input nodes size: 304009
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.11473560333251953  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.11473560333251953  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.22798824310302734  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.22808218002319336  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.1210165023803711  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.13158226013183594  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.13158226013183594  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

first layer input nodes number: 304009
first layer output nodes number: 111445
edges number: 1104476
----------------------------------------before model layer 0
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.13467836380004883  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

torch.Size([304009, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.13467836380004883  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

m.shape torch.Size([94, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5577216148376465  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5577216148376465  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 94, 100]), torch.Size([1, 94, 100])
----------------------------------------3
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5577921867370605  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5583539009094238  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 94, 100])
m.shape torch.Size([133, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.558417797088623  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.558417797088623  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 133, 100]), torch.Size([1, 133, 100])
----------------------------------------3
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5585169792175293  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.560004711151123  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 133, 100])
m.shape torch.Size([178, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5601544380187988  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5601544380187988  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 178, 100]), torch.Size([1, 178, 100])
----------------------------------------3
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5602879524230957  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5632123947143555  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 178, 100])
m.shape torch.Size([232, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5634913444519043  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5634913444519043  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 232, 100]), torch.Size([1, 232, 100])
----------------------------------------3
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5636649131774902  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5686812400817871  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 232, 100])
m.shape torch.Size([314, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5691795349121094  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5691795349121094  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 314, 100]), torch.Size([1, 314, 100])
----------------------------------------3
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5694141387939453  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.577845573425293  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 314, 100])
m.shape torch.Size([320, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5784435272216797  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5784435272216797  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 320, 100]), torch.Size([1, 320, 100])
----------------------------------------3
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5786819458007812  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5889339447021484  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 320, 100])
m.shape torch.Size([399, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5899677276611328  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5899677276611328  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 399, 100]), torch.Size([1, 399, 100])
----------------------------------------3
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.5902652740478516  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.6051325798034668  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 399, 100])
m.shape torch.Size([428, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.6062593460083008  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.6062593460083008  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 428, 100]), torch.Size([1, 428, 100])
----------------------------------------3
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.6065788269042969  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.6247663497924805  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 428, 100])
m.shape torch.Size([523, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.6263604164123535  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.6263604164123535  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 523, 100]), torch.Size([1, 523, 100])
----------------------------------------3
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.6267504692077637  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.0877685546875 GB
    Memory Allocated: 0.6517009735107422  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 523, 100])
m.shape torch.Size([108824, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.4940185546875 GB
    Memory Allocated: 1.057755947113037  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.4940185546875 GB
    Memory Allocated: 1.057755947113037  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 108824, 100]), torch.Size([1, 108824, 100])
----------------------------------------3
 Nvidia-smi: 14.4940185546875 GB
    Memory Allocated: 1.139787197113037  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 6.906467437744141  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 108824, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 6.493433952331543  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 6.5997161865234375  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 6.705998420715332  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 6.5997161865234375  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

torch.Size([111445, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 6.705998420715332  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 6.732569217681885  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 6.732569217681885  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.035948753356934  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.035948753356934  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.035956382751465  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.036124229431152  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 4, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.036128520965576  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.036128520965576  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.036132335662842  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.036242961883545  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.0362653732299805  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.0362653732299805  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.0362749099731445  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.036618232727051  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 6, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.0366597175598145  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.0366597175598145  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.036674976348877  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.0373311042785645  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.037330627441406  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.037330627441406  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.037332534790039  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.03742790222168  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([7, 8, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.03748083114624  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.03748083114624  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.03749418258667  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.038255214691162  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.038274765014648  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.038274765014648  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.038280487060547  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.038646697998047  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([9, 10, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.038730621337891  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.038730621337891  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.038747787475586  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.039966583251953  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([6, 11, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.040021896362305  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.040021896362305  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.040033340454102  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.040925979614258  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 12, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.041001319885254  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.041001319885254  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.041014671325684  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.042149543762207  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 13, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.042230606079102  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.042230606079102  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.042243957519531  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.0434722900390625  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([11, 14, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.043613910675049  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.043613910675049  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.04363489151001  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.045711994171143  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 15, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.045845985412598  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.045845985412598  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.045865058898926  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.047886848449707  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([7, 16, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.047985076904297  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.047985076904297  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.047998428344727  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.049507141113281  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 17, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.049598693847656  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.049598693847656  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.049610137939453  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.050983428955078  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 18, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.051150798797607  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.051150798797607  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.0511698722839355  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.053592205047607  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6, 19, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.05369234085083  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.05369234085083  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.053703784942627  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.055237293243408  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.0555009841918945  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.0555009841918945  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.055527687072754  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.059292793273926  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.059542179107666  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.059542179107666  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.059566974639893  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.063236713409424  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.063562870025635  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.063562870025635  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.06359338760376  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.068323612213135  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.068375110626221  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.068375110626221  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.068380832672119  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.069307804107666  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.069512844085693  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.069512844085693  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.069530010223389  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.0724310874938965  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12443, 25, 256])
----------------------------------------1
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.371404647827148  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.371404647827148  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

 h.shape torch.Size([1, 12443, 256]), torch.Size([1, 12443, 256])
----------------------------------------3
 Nvidia-smi: 18.3455810546875 GB
    Memory Allocated: 7.395137786865234  GigaBytes
Max Memory Allocated: 11.846290588378906  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.6424560546875 GB
    Memory Allocated: 11.574761867523193  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 12443, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.6424560546875 GB
    Memory Allocated: 11.275589942932129  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.6424560546875 GB
    Memory Allocated: 11.27779769897461  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.6424560546875 GB
    Memory Allocated: 11.28000545501709  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.6424560546875 GB
    Memory Allocated: 11.277703762054443  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

torch.Size([12607, 47])
input nodes number: 111445
output nodes number: 12607
edges number: 313591
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6424560546875 GB
    Memory Allocated: 11.27825403213501  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.6424560546875 GB
    Memory Allocated: 11.278254508972168  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.15058565139770508  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

pseudo mini batch 5 input nodes size: 277707
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.12064218521118164  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.12064218521118164  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.22409629821777344  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.22419023513793945  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.11084365844726562  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.12092208862304688  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.12092208862304688  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

first layer input nodes number: 277707
first layer output nodes number: 105654
edges number: 1038350
----------------------------------------before model layer 0
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.12454700469970703  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

torch.Size([277707, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.12454700469970703  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

m.shape torch.Size([227, 1, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5224533081054688  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5224533081054688  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 227, 100]), torch.Size([1, 227, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5226230621337891  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5239782333374023  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 227, 100])
m.shape torch.Size([268, 2, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5240931510925293  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5240931510925293  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 268, 100]), torch.Size([1, 268, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5242934226989746  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5272917747497559  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 268, 100])
m.shape torch.Size([343, 3, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5275750160217285  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5275750160217285  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 343, 100]), torch.Size([1, 343, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5278306007385254  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5334534645080566  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 343, 100])
m.shape torch.Size([468, 4, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5340232849121094  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5340232849121094  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 468, 100]), torch.Size([1, 468, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5343723297119141  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5444889068603516  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 468, 100])
m.shape torch.Size([555, 5, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5453481674194336  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5453481674194336  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 555, 100]), torch.Size([1, 555, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5457620620727539  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5606551170349121  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 555, 100])
m.shape torch.Size([570, 6, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5617222785949707  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5617222785949707  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 570, 100]), torch.Size([1, 570, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5621476173400879  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5804200172424316  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 570, 100])
m.shape torch.Size([623, 7, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5818324089050293  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5818324089050293  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 623, 100]), torch.Size([1, 623, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5822968482971191  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.6055088043212891  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 623, 100])
m.shape torch.Size([621, 8, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.6071276664733887  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.6071276664733887  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 621, 100]), torch.Size([1, 621, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.6075911521911621  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.6339755058288574  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 621, 100])
m.shape torch.Size([628, 9, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.6358494758605957  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.6358494758605957  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 628, 100]), torch.Size([1, 628, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.6363177299499512  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.6662731170654297  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 628, 100])
m.shape torch.Size([101351, 10, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 1.0436010360717773  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 1.0436010360717773  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 101351, 100]), torch.Size([1, 101351, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 1.1191139221191406  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.480500221252441  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 101351, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.093311786651611  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.194071292877197  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.294830799102783  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.194071292877197  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

torch.Size([105654, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.294830799102783  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.32002067565918  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.32002067565918  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

m.shape torch.Size([47, 1, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.617138862609863  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.617138862609863  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.6172285079956055  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.617945671081543  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([31, 2, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.617960453033447  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.617960453033447  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.6180195808410645  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.618906497955322  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([15, 3, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.61892032623291  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.61892032623291  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.618948936462402  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.6195783615112305  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([20, 4, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.619641304016113  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.619641304016113  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.6196794509887695  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.620785713195801  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 5, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.620858192443848  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.620858192443848  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.620894432067871  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.622199058532715  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 6, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.622302055358887  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.622302055358887  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.622342109680176  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.6240644454956055  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 7, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.624172687530518  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.624172687530518  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.624208927154541  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.626020908355713  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 8, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.626125812530518  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.626125812530518  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.626156330108643  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.627895832061768  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([38, 9, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.628209590911865  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.628209590911865  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.628282070159912  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.632920742034912  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([18, 10, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.633057594299316  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.633057594299316  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.633091926574707  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.635529518127441  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 11, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.635692119598389  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.635692119598389  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.6357245445251465  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.638253688812256  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 12, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.638410568237305  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.638410568237305  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.638439178466797  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.640871047973633  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 13, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.641081809997559  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.641081809997559  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.641116142272949  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.644274711608887  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 14, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.644526958465576  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.644526958465576  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.644565105438232  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.648341655731201  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([25, 15, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.648683071136475  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.648683071136475  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.648730754852295  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.653785228729248  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([13, 16, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.653961658477783  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.653961658477783  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.65398645401001  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.656788349151611  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.6570210456848145  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.6570210456848145  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.657049655914307  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.660482883453369  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.660797595977783  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.660797595977783  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.660833835601807  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.665436267852783  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.66571044921875  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.66571044921875  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.665740966796875  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.669830322265625  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.6701226234436035  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.6701226234436035  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.6701531410217285  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.6744561195373535  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.6747236251831055  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.6747236251831055  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.674750328063965  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.678702354431152  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.679006576538086  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.679006576538086  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.679035186767578  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.683469772338867  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.683853626251221  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.683853626251221  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.683887958526611  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.689449787139893  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.6898016929626465  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.6898016929626465  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.6898322105407715  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.6949896812438965  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12068, 25, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.984946250915527  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.984946250915527  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 12068, 256]), torch.Size([1, 12068, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 7.008383750915527  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 11.067713737487793  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 12068, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 10.774943351745605  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 10.77802562713623  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 10.78022289276123  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 10.77704668045044  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

torch.Size([12549, 47])
input nodes number: 105654
output nodes number: 12549
edges number: 307045
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 10.778802394866943  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 10.778802871704102  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.14185619354248047  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

pseudo mini batch 6 input nodes size: 264937
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.11171817779541016  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.11171817779541016  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.21041536331176758  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.21050453186035156  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.10695648193359375  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.11573982238769531  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.11573982238769531  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

first layer input nodes number: 264937
first layer output nodes number: 91831
edges number: 891922
----------------------------------------before model layer 0
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.11935949325561523  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

torch.Size([264937, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.11935949325561523  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

m.shape torch.Size([231, 1, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.4611039161682129  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.4611039161682129  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 231, 100]), torch.Size([1, 231, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.4612765312194824  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.46265459060668945  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 231, 100])
m.shape torch.Size([387, 2, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.4628567695617676  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.4628567695617676  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 387, 100]), torch.Size([1, 387, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.46314573287963867  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.46747446060180664  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 387, 100])
m.shape torch.Size([502, 3, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.46789121627807617  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.46789121627807617  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 502, 100]), torch.Size([1, 502, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.46826601028442383  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.4764986038208008  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 502, 100])
m.shape torch.Size([678, 4, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.4773216247558594  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.4773216247558594  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 678, 100]), torch.Size([1, 678, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.4778270721435547  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.49249982833862305  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 678, 100])
m.shape torch.Size([860, 5, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.4938492774963379  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.4938492774963379  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 860, 100]), torch.Size([1, 860, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.4944901466369629  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.518496036529541  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 860, 100])
m.shape torch.Size([859, 6, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5200958251953125  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5200958251953125  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 859, 100]), torch.Size([1, 859, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5207366943359375  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5492935180664062  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 859, 100])
m.shape torch.Size([939, 7, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.551729679107666  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.551729679107666  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 939, 100]), torch.Size([1, 939, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5524296760559082  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5884647369384766  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 939, 100])
m.shape torch.Size([1038, 8, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5912084579467773  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5912084579467773  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 1038, 100]), torch.Size([1, 1038, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5919818878173828  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.6388201713562012  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 1038, 100])
m.shape torch.Size([1002, 9, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.6417932510375977  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.6417932510375977  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 1002, 100]), torch.Size([1, 1002, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.6425399780273438  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.6911153793334961  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 1002, 100])
m.shape torch.Size([85335, 10, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 1.0086398124694824  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 1.0086398124694824  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 85335, 100]), torch.Size([1, 85335, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 1.0722193717956543  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.586368083953857  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 85335, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.254800796508789  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.342377662658691  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.429954528808594  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.342377662658691  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

torch.Size([91831, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.429954528808594  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.451848983764648  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.451848983764648  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

m.shape torch.Size([23, 1, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.728279113769531  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.728279113769531  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.728322982788086  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.728673934936523  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([24, 2, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.728698253631592  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.728698253631592  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.728744029998779  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.729430675506592  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([26, 3, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.729483127593994  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.729483127593994  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.729532718658447  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.730623722076416  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([56, 4, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.730814456939697  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.730814456939697  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.730921268463135  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.734018802642822  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([32, 5, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.734119415283203  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.734119415283203  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.734180450439453  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.736377716064453  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([45, 6, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.736607074737549  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.736607074737549  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.736692905426025  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.740383625030518  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([44, 7, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.740636825561523  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.740636825561523  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.740720748901367  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.744916915893555  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([51, 8, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.745267391204834  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.745267391204834  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.745364665985107  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.750909328460693  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([41, 9, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.75121545791626  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.75121545791626  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.751293659210205  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.756298542022705  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([42, 10, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.7566633224487305  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.7566633224487305  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.756743431091309  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.7624311447143555  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([39, 11, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.762803554534912  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.762803554534912  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.762877941131592  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.768680095672607  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 12, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.7690582275390625  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.7690582275390625  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.769126892089844  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.77496337890625  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.77536678314209  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.77536678314209  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.775433540344238  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.7815752029418945  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([41, 14, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.782093524932861  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.782093524932861  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.782171726226807  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.789913654327393  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([42, 15, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.790480136871338  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.790480136871338  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.790560245513916  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.799051761627197  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.799581050872803  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.799581050872803  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.799651622772217  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.807626247406006  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.808277606964111  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.808277606964111  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.8083577156066895  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.8179707527160645  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([40, 18, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.818623065948486  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.818623065948486  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.818699359893799  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.828388690948486  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([47, 19, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.829208850860596  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.829208850860596  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.829298496246338  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.841310977935791  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.8419389724731445  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.8419389724731445  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.842005729675293  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.851418495178223  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 21, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.851970672607422  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.851970672607422  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.852025985717773  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.860212326049805  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([42, 22, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.861073017120361  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.861073017120361  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.8611531257629395  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.873569965362549  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.8742594718933105  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.8742594718933105  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.874322414398193  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.884519100189209  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([47, 24, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.8857035636901855  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.8857035636901855  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.885793209075928  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.900943279266357  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([10998, 25, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.165795803070068  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.165795803070068  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 10998, 256]), torch.Size([1, 10998, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 6.18677282333374  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 9.87872838973999  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 10998, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 9.605844497680664  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 9.60881233215332  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 9.611780166625977  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 9.608723163604736  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

torch.Size([11927, 47])
input nodes number: 91831
output nodes number: 11927
edges number: 286817
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 9.609382152557373  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 9.609382629394531  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.13222360610961914  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

pseudo mini batch 7 input nodes size: 175158
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.106842041015625  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.106842041015625  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.17209386825561523  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.17218780517578125  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.07340145111083984  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.08143138885498047  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.08143138885498047  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

first layer input nodes number: 175158
first layer output nodes number: 80899
edges number: 780403
----------------------------------------before model layer 0
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.08333969116210938  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

torch.Size([175158, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.08333969116210938  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

m.shape torch.Size([193, 1, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.3827519416809082  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.3827519416809082  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 193, 100]), torch.Size([1, 193, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.38289594650268555  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.3840479850769043  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 193, 100])
m.shape torch.Size([411, 2, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.38428258895874023  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.38428258895874023  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 411, 100]), torch.Size([1, 411, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.38458967208862305  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.3891873359680176  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 411, 100])
m.shape torch.Size([523, 3, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.3896183967590332  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.3896183967590332  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 523, 100]), torch.Size([1, 523, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.39000844955444336  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.39858531951904297  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 523, 100])
m.shape torch.Size([708, 4, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.3994455337524414  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.3994455337524414  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 708, 100]), torch.Size([1, 708, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.39997386932373047  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.4158315658569336  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 708, 100])
m.shape torch.Size([879, 5, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.4172048568725586  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.4172048568725586  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 879, 100]), torch.Size([1, 879, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.4178600311279297  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.44151782989501953  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 879, 100])
m.shape torch.Size([1077, 6, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.44359779357910156  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.44359779357910156  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 1077, 100]), torch.Size([1, 1077, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.4444007873535156  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.480741024017334  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 1077, 100])
m.shape torch.Size([1108, 7, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.4832291603088379  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.4832291603088379  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 1108, 100]), torch.Size([1, 1108, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.4840550422668457  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5263237953186035  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 1108, 100])
m.shape torch.Size([1203, 8, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5294961929321289  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5294961929321289  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 1203, 100]), torch.Size([1, 1203, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5303926467895508  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5853357315063477  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 1203, 100])
m.shape torch.Size([1220, 9, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5889782905578613  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5889782905578613  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 1220, 100]), torch.Size([1, 1220, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.5898880958557129  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.6508612632751465  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 1220, 100])
m.shape torch.Size([73577, 10, 100])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.9245023727416992  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.9245023727416992  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 73577, 100]), torch.Size([1, 73577, 100])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 0.9793224334716797  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 4.871503829956055  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 73577, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 4.581697940826416  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 4.658849239349365  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 4.7360005378723145  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 4.658849239349365  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

torch.Size([80899, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 4.7360005378723145  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 4.7555317878723145  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 4.7555317878723145  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

m.shape torch.Size([17, 1, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.0423502922058105  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.0423502922058105  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.042382717132568  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.042642116546631  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([34, 2, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.042691707611084  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.042691707611084  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.0427565574646  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.043729305267334  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([45, 3, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.043827056884766  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.043827056884766  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.043912887573242  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.045801162719727  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([58, 4, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.045981407165527  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.045981407165527  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.0460920333862305  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.049300193786621  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([58, 5, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.049523830413818  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.049523830413818  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.0496344566345215  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.053617000579834  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([65, 6, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.053936958312988  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.053936958312988  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.054060935974121  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.059391975402832  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([65, 7, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.059767723083496  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.059767723083496  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.059891700744629  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.0660905838012695  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([73, 8, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.066590309143066  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.066590309143066  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.066729545593262  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.0746660232543945  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([60, 9, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.07511568069458  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.07511568069458  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.075230121612549  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.082554340362549  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([59, 10, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.083064556121826  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.083064556121826  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.083177089691162  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.091166973114014  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.091745376586914  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.091745376586914  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.091859817504883  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.100786209106445  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.1013288497924805  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.1013288497924805  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.101428031921387  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.109858512878418  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([70, 13, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.110683917999268  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.110683917999268  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.1108174324035645  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.123100757598877  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([63, 14, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.123881816864014  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.123881816864014  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.124001979827881  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.135898113250732  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([70, 15, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.136847496032715  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.136847496032715  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.136981010437012  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.1511335372924805  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([60, 16, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.151989459991455  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.151989459991455  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.152103900909424  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.165035724639893  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([72, 17, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.166614532470703  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.166614532470703  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.166751861572266  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.183231353759766  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([60, 18, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.184200763702393  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.184200763702393  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.184315204620361  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.198849201202393  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([68, 19, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.200034141540527  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.200034141540527  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.200163841247559  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.217543601989746  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([53, 20, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.2184977531433105  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.2184977531433105  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.21859884262085  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.232852458953857  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([63, 21, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.234739780426025  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.234739780426025  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.234859943389893  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.252644062042236  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([55, 22, 256])
----------------------------------------1
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.25374698638916  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.25374698638916  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 18.9432373046875 GB
    Memory Allocated: 5.253851890563965  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9588623046875 GB
    Memory Allocated: 5.270112037658691  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([57, 23, 256])
----------------------------------------1
 Nvidia-smi: 18.9588623046875 GB
    Memory Allocated: 5.27131986618042  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9588623046875 GB
    Memory Allocated: 5.27131986618042  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 18.9588623046875 GB
    Memory Allocated: 5.27142858505249  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9764404296875 GB
    Memory Allocated: 5.289041042327881  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([66, 24, 256])
----------------------------------------1
 Nvidia-smi: 18.9764404296875 GB
    Memory Allocated: 5.290509223937988  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9764404296875 GB
    Memory Allocated: 5.290509223937988  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 18.9764404296875 GB
    Memory Allocated: 5.290635108947754  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9979248046875 GB
    Memory Allocated: 5.3119096755981445  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([11154, 25, 256])
----------------------------------------1
 Nvidia-smi: 18.9979248046875 GB
    Memory Allocated: 5.58029317855835  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.9979248046875 GB
    Memory Allocated: 5.58029317855835  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 11154, 256]), torch.Size([1, 11154, 256])
----------------------------------------3
 Nvidia-smi: 18.9979248046875 GB
    Memory Allocated: 5.601808547973633  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.9979248046875 GB
    Memory Allocated: 9.346132278442383  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 11154, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.9979248046875 GB
    Memory Allocated: 9.063671588897705  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.9979248046875 GB
    Memory Allocated: 9.066044330596924  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.9979248046875 GB
    Memory Allocated: 9.068417072296143  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.9979248046875 GB
    Memory Allocated: 9.065950393676758  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

torch.Size([12557, 47])
input nodes number: 80899
output nodes number: 12557
edges number: 297321
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.9998779296875 GB
    Memory Allocated: 9.066052436828613  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.9998779296875 GB
    Memory Allocated: 9.066052913665771  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.0037841796875 GB
    Memory Allocated: 0.09539270401000977  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

pseudo mini batch 8 input nodes size: 394099
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.0037841796875 GB
    Memory Allocated: 0.07280635833740234  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.0037841796875 GB
    Memory Allocated: 0.07280635833740234  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.0037841796875 GB
    Memory Allocated: 0.2196197509765625  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 19.0037841796875 GB
    Memory Allocated: 0.2197127342224121  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.0037841796875 GB
    Memory Allocated: 0.15436697006225586  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.0037841796875 GB
    Memory Allocated: 0.16608572006225586  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0037841796875 GB
    Memory Allocated: 0.16608572006225586  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

first layer input nodes number: 394099
first layer output nodes number: 120041
edges number: 1172670
----------------------------------------before model layer 0
 Nvidia-smi: 19.0037841796875 GB
    Memory Allocated: 0.16991662979125977  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

torch.Size([394099, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.0037841796875 GB
    Memory Allocated: 0.16991662979125977  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

m.shape torch.Size([182, 1, 100])
----------------------------------------1
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6198515892028809  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6198515892028809  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 182, 100]), torch.Size([1, 182, 100])
----------------------------------------3
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.619987964630127  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6210746765136719  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 182, 100])
m.shape torch.Size([373, 2, 100])
----------------------------------------1
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6212844848632812  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6212844848632812  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 373, 100]), torch.Size([1, 373, 100])
----------------------------------------3
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6215629577636719  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6257343292236328  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 373, 100])
m.shape torch.Size([516, 3, 100])
----------------------------------------1
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6261720657348633  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6261720657348633  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 516, 100]), torch.Size([1, 516, 100])
----------------------------------------3
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6265573501586914  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6350207328796387  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 516, 100])
m.shape torch.Size([730, 4, 100])
----------------------------------------1
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6359162330627441  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6359162330627441  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 730, 100]), torch.Size([1, 730, 100])
----------------------------------------3
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6364607810974121  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.653078556060791  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 730, 100])
m.shape torch.Size([874, 5, 100])
----------------------------------------1
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6544346809387207  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6544346809387207  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 874, 100]), torch.Size([1, 874, 100])
----------------------------------------3
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6550860404968262  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6788473129272461  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 874, 100])
m.shape torch.Size([937, 6, 100])
----------------------------------------1
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6806163787841797  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6806163787841797  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 937, 100]), torch.Size([1, 937, 100])
----------------------------------------3
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.6813154220581055  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.7119293212890625  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 937, 100])
m.shape torch.Size([1160, 7, 100])
----------------------------------------1
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.7146048545837402  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.7146048545837402  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 1160, 100]), torch.Size([1, 1160, 100])
----------------------------------------3
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.7154698371887207  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.7586889266967773  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 1160, 100])
m.shape torch.Size([1211, 8, 100])
----------------------------------------1
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.7618656158447266  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.7618656158447266  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 1211, 100]), torch.Size([1, 1211, 100])
----------------------------------------3
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.7627687454223633  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.8168821334838867  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 1211, 100])
m.shape torch.Size([1106, 9, 100])
----------------------------------------1
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.8201389312744141  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.8201389312744141  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 1106, 100]), torch.Size([1, 1106, 100])
----------------------------------------3
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.8209638595581055  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4412841796875 GB
    Memory Allocated: 0.8743219375610352  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 1106, 100])
m.shape torch.Size([112952, 10, 100])
----------------------------------------1
 Nvidia-smi: 19.8631591796875 GB
    Memory Allocated: 1.2946887016296387  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8631591796875 GB
    Memory Allocated: 1.2946887016296387  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 112952, 100]), torch.Size([1, 112952, 100])
----------------------------------------3
 Nvidia-smi: 19.8631591796875 GB
    Memory Allocated: 1.3793158531188965  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.354380130767822  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 112952, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 6.9176812171936035  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.032161235809326  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.146641254425049  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.032161235809326  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

torch.Size([120041, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.146641254425049  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.175261497497559  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.175261497497559  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.456741809844971  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.456741809844971  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.456758975982666  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.4568963050842285  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([22, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.456930160522461  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.456930160522461  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.456972122192383  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.457601547241211  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([65, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.457768440246582  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.457768440246582  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.457892417907715  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.460619926452637  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([70, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.460827350616455  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.460827350616455  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.460960865020752  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.464832782745361  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([84, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.465169906616211  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.465169906616211  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.465330123901367  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.471097946166992  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([79, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.471473693847656  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.471473693847656  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.471624374389648  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.4781036376953125  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([106, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.478741645812988  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.478741645812988  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.478943824768066  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.489052772521973  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([75, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.489528656005859  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.489528656005859  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.48967170715332  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.497825622558594  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([44, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.498135089874268  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.498135089874268  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.498219013214111  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.503590106964111  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([78, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.504298210144043  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.504298210144043  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.504446983337402  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.515009880065918  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([79, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.51577091217041  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.51577091217041  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.515921592712402  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.527674674987793  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([50, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.528176307678223  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.528176307678223  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.528271675109863  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.536377906799316  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([78, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.537304878234863  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.537304878234863  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.537453651428223  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.551140785217285  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([115, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.552689075469971  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.552689075469971  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.552908420562744  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.5746235847473145  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.575033187866211  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.575033187866211  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.575101852416992  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.582380294799805  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([86, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.583703994750977  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.583703994750977  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.583868026733398  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.60240364074707  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([57, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.603253364562988  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.603253364562988  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.603362083435059  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.616408348083496  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([69, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.6176605224609375  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.6176605224609375  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.617792129516602  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.6345062255859375  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.635116100311279  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.635116100311279  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.635186672210693  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.644643306732178  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([59, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.645964622497559  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.645964622497559  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.6460771560668945  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.661944389343262  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([61, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.663245677947998  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.663245677947998  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.6633620262146  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.680581569671631  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([52, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.681948661804199  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.681948661804199  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.6820478439331055  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.697421073913574  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([71, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.698994159698486  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.698994159698486  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.699129581451416  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.721067905426025  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([88, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.723859786987305  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.723859786987305  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 22.4940185546875 GB
    Memory Allocated: 7.724027633666992  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 7.75239372253418  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([10884, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 8.0146484375  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 8.0146484375  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

 h.shape torch.Size([1, 10884, 256]), torch.Size([1, 10884, 256])
----------------------------------------3
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 8.035408020019531  GigaBytes
Max Memory Allocated: 11.871636867523193  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7733154296875 GB
    Memory Allocated: 11.689094543457031  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 10884, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.7733154296875 GB
    Memory Allocated: 11.41156816482544  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.7733154296875 GB
    Memory Allocated: 11.413963794708252  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.7733154296875 GB
    Memory Allocated: 11.416807651519775  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.7733154296875 GB
    Memory Allocated: 11.414319038391113  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

torch.Size([12454, 47])
input nodes number: 120041
output nodes number: 12454
edges number: 292313
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.7733154296875 GB
    Memory Allocated: 11.415329456329346  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.7733154296875 GB
    Memory Allocated: 11.415329933166504  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.18551015853881836  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

pseudo mini batch 9 input nodes size: 240922
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.1543898582458496  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.1543898582458496  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.244140625  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.2442317008972168  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.09732532501220703  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.10570049285888672  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.10570049285888672  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

first layer input nodes number: 240922
first layer output nodes number: 87128
edges number: 835902
----------------------------------------before model layer 0
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.10814523696899414  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

torch.Size([240922, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.10814523696899414  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

m.shape torch.Size([112, 1, 100])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.4284172058105469  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.4284172058105469  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 112, 100]), torch.Size([1, 112, 100])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.4285011291503906  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.4291696548461914  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 112, 100])
m.shape torch.Size([223, 2, 100])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.4292941093444824  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.4292941093444824  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 223, 100]), torch.Size([1, 223, 100])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.4294610023498535  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.43195581436157227  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 223, 100])
m.shape torch.Size([496, 3, 100])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.43242692947387695  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.43242692947387695  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 496, 100]), torch.Size([1, 496, 100])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.4327969551086426  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.44092893600463867  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 496, 100])
m.shape torch.Size([992, 4, 100])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.4422922134399414  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.4422922134399414  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 992, 100]), torch.Size([1, 992, 100])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.44303131103515625  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.4644651412963867  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 992, 100])
m.shape torch.Size([1342, 5, 100])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.4665956497192383  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.4665956497192383  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 1342, 100]), torch.Size([1, 1342, 100])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.46759605407714844  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.5038590431213379  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 1342, 100])
m.shape torch.Size([1501, 6, 100])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.5067138671875  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.5067138671875  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 1501, 100]), torch.Size([1, 1501, 100])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.5078325271606445  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.5575299263000488  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 1501, 100])
m.shape torch.Size([1713, 7, 100])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.5614376068115234  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.5614376068115234  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 1713, 100]), torch.Size([1, 1713, 100])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.5627145767211914  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.6267681121826172  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 1713, 100])
m.shape torch.Size([1748, 8, 100])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.6313390731811523  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.6313390731811523  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 1748, 100]), torch.Size([1, 1748, 100])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.6326417922973633  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.7068853378295898  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 1748, 100])
m.shape torch.Size([1813, 9, 100])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.712742805480957  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.712742805480957  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 1813, 100]), torch.Size([1, 1813, 100])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.7140941619873047  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 0.806025505065918  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 1813, 100])
m.shape torch.Size([77188, 10, 100])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 1.092897891998291  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 1.092897891998291  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 77188, 100]), torch.Size([1, 77188, 100])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 1.1504082679748535  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.233602046966553  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 77188, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 4.924274921417236  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.00736665725708  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.090458393096924  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.00736665725708  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

torch.Size([87128, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.090458393096924  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.111231327056885  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.111231327056885  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.389078140258789  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.389078140258789  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.389091491699219  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.389198303222656  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.389199733734131  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.389199733734131  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.389207363128662  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.389321804046631  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([14, 3, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.3893585205078125  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.3893585205078125  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.389385223388672  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.389972686767578  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([25, 4, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.3900556564331055  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.3900556564331055  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.390103340148926  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.391486167907715  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 5, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.391602039337158  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.391602039337158  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.39165735244751  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.393648624420166  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([44, 6, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.3938751220703125  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.3938751220703125  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.393959045410156  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.3975677490234375  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([65, 7, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.397963523864746  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.397963523864746  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.398087501525879  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.4042863845825195  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([54, 8, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.404639720916748  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.404639720916748  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.40474271774292  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.410613536834717  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([75, 9, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.411211013793945  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.411211013793945  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.411354064941406  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.420509338378906  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([99, 10, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.421389579772949  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.421389579772949  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.421578407287598  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.434985160827637  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([106, 11, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.436198711395264  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.436198711395264  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.436400890350342  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.4521708488464355  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([83, 12, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.453027248382568  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.453027248382568  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.453185558319092  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.466641902923584  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([74, 13, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.467487812042236  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.467487812042236  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.4676289558410645  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.480614185333252  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([94, 14, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.4818525314331055  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.4818525314331055  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.48203182220459  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.499781608581543  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([101, 15, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.5012102127075195  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.5012102127075195  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.501402854919434  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.521822929382324  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([100, 16, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.523458003997803  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.523458003997803  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.523648738861084  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.545201778411865  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([79, 17, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.546415328979492  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.546415328979492  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.546566009521484  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.564647674560547  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([104, 18, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.566713809967041  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.566713809967041  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 104, 256]), torch.Size([1, 104, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.5669121742248535  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.592104434967041  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 104, 256])
m.shape torch.Size([83, 19, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.593523979187012  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.593523979187012  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.593682289123535  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.614895820617676  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([68, 20, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.616126537322998  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.616126537322998  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.616256237030029  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.6345438957214355  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([93, 21, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.636356353759766  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.636356353759766  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.636533737182617  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.662786483764648  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([100, 22, 256])
----------------------------------------1
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.6648125648498535  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.6648125648498535  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 23.0565185546875 GB
    Memory Allocated: 5.665003299713135  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0740966796875 GB
    Memory Allocated: 5.6945672035217285  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([86, 23, 256])
----------------------------------------1
 Nvidia-smi: 23.0740966796875 GB
    Memory Allocated: 5.696372985839844  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0740966796875 GB
    Memory Allocated: 5.696372985839844  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 23.0740966796875 GB
    Memory Allocated: 5.696537017822266  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1014404296875 GB
    Memory Allocated: 5.723110198974609  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([68, 24, 256])
----------------------------------------1
 Nvidia-smi: 23.1014404296875 GB
    Memory Allocated: 5.724645614624023  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1014404296875 GB
    Memory Allocated: 5.724645614624023  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 23.1014404296875 GB
    Memory Allocated: 5.724775314331055  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 5.746694564819336  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([10541, 25, 256])
----------------------------------------1
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 6.000591278076172  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 6.000591278076172  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 10541, 256]), torch.Size([1, 10541, 256])
----------------------------------------3
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 6.020696640014648  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 9.560182571411133  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 10541, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 9.286609649658203  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 9.288817405700684  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 9.291025161743164  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 9.288726329803467  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

torch.Size([12196, 47])
input nodes number: 87128
output nodes number: 12196
edges number: 288113
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1248779296875 GB
    Memory Allocated: 9.289278984069824  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.1248779296875 GB
    Memory Allocated: 9.289279460906982  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.12081718444824219  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

pseudo mini batch 10 input nodes size: 390015
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.097137451171875  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.097137451171875  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.2424297332763672  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.24251890182495117  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.15267705917358398  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.1624312400817871  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.1624312400817871  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

first layer input nodes number: 390015
first layer output nodes number: 105207
edges number: 1035077
----------------------------------------before model layer 0
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.1661210060119629  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

torch.Size([390015, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.1661210060119629  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

m.shape torch.Size([188, 1, 100])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5626430511474609  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5626430511474609  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 188, 100]), torch.Size([1, 188, 100])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5627832412719727  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5639047622680664  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 188, 100])
m.shape torch.Size([233, 2, 100])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5640087127685547  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5640087127685547  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 233, 100]), torch.Size([1, 233, 100])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.564183235168457  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5667924880981445  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 233, 100])
m.shape torch.Size([370, 3, 100])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5671191215515137  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5671191215515137  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 370, 100]), torch.Size([1, 370, 100])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5673956871032715  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5734672546386719  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 370, 100])
m.shape torch.Size([396, 4, 100])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5739192962646484  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5739192962646484  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 396, 100]), torch.Size([1, 396, 100])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5742149353027344  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5827770233154297  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 396, 100])
m.shape torch.Size([456, 5, 100])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5834789276123047  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5834789276123047  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 456, 100]), torch.Size([1, 456, 100])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5838193893432617  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5960545539855957  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 456, 100])
m.shape torch.Size([553, 6, 100])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5978488922119141  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.5978488922119141  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 553, 100]), torch.Size([1, 553, 100])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.598261833190918  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.615992546081543  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 553, 100])
m.shape torch.Size([669, 7, 100])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.6175308227539062  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.6175308227539062  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 669, 100]), torch.Size([1, 669, 100])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.6180295944213867  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.6439824104309082  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 669, 100])
m.shape torch.Size([645, 8, 100])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.645655632019043  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.645655632019043  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 645, 100]), torch.Size([1, 645, 100])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.6461362838745117  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.6735334396362305  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 645, 100])
m.shape torch.Size([682, 9, 100])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.6755800247192383  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.6755800247192383  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 682, 100]), torch.Size([1, 682, 100])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.6760883331298828  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 0.7095489501953125  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 682, 100])
m.shape torch.Size([101015, 10, 100])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 1.0856051445007324  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 1.0856051445007324  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 101015, 100]), torch.Size([1, 101015, 100])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 1.1608672142028809  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.50447416305542  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 101015, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.118469715118408  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.2188029289245605  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.319136142730713  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.2188029289245605  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

torch.Size([105207, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.319136142730713  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.34421968460083  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.34421968460083  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

m.shape torch.Size([23, 1, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.608500003814697  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.608500003814697  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.608543872833252  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.6088948249816895  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([29, 2, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.608928680419922  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.608928680419922  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.608983993530273  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.609813690185547  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([69, 3, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.6099853515625  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.6099853515625  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.610116958618164  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.613012313842773  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([72, 4, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.613223552703857  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.613223552703857  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.61336088180542  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.617343425750732  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([65, 5, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.617587566375732  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.617587566375732  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.617711544036865  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.6221747398376465  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([109, 6, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.62274169921875  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.62274169921875  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.622949600219727  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.631889343261719  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([152, 7, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.63332986831665  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.63332986831665  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.633619785308838  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.648115634918213  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([66, 8, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.6484785079956055  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.6484785079956055  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.648604393005371  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.655779838562012  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([118, 9, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.657547950744629  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.657547950744629  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.657773017883301  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.672177314758301  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([141, 10, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.674117088317871  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.674117088317871  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 141, 256]), torch.Size([1, 141, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.674386024475098  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.693480491638184  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 141, 256])
m.shape torch.Size([98, 11, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.694382190704346  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.694382190704346  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.694569110870361  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.70914888381958  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([105, 12, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.710606098175049  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.710606098175049  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.710806369781494  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.727829456329346  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([75, 13, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.72866678237915  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.72866678237915  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.728809833526611  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.741970539093018  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([110, 14, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.743379592895508  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.743379592895508  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.743589401245117  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.764360427856445  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([159, 15, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.766548156738281  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.766548156738281  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.766851425170898  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.79899787902832  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([83, 16, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.800772190093994  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.800772190093994  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.800930500030518  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.818819522857666  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([61, 17, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.819858551025391  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.819858551025391  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.819974899291992  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.83393669128418  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([63, 18, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.834968566894531  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.834968566894531  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.835088729858398  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.850349426269531  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([73, 19, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.851622581481934  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.851622581481934  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.851761817932129  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.870419502258301  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([66, 20, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.871618747711182  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.871618747711182  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.871744632720947  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.8894944190979  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([61, 21, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.891567230224609  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.891567230224609  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.891683578491211  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.908903121948242  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([39, 22, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.909669876098633  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.909669876098633  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.9097442626953125  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.921274185180664  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([89, 23, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.92320442199707  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.92320442199707  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.923374176025391  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.950874328613281  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([59, 24, 256])
----------------------------------------1
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.952232837677002  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.952232837677002  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 23.1287841796875 GB
    Memory Allocated: 6.952345371246338  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1444091796875 GB
    Memory Allocated: 6.971363544464111  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([9972, 25, 256])
----------------------------------------1
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 7.210916042327881  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 7.210916042327881  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 9972, 256]), torch.Size([1, 9972, 256])
----------------------------------------3
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 7.230180263519287  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 10.581010341644287  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 9972, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 10.322020053863525  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 10.324228763580322  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 10.32643747329712  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 10.324139595031738  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

torch.Size([11957, 47])
input nodes number: 105207
output nodes number: 11957
edges number: 273965
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 10.325013637542725  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.1483154296875 GB
    Memory Allocated: 10.325014114379883  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.1502685546875 GB
    Memory Allocated: 0.18077945709228516  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

pseudo mini batch 11 input nodes size: 430858
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.1502685546875 GB
    Memory Allocated: 0.1526780128479004  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.1502685546875 GB
    Memory Allocated: 0.1526780128479004  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.1502685546875 GB
    Memory Allocated: 0.3131852149963379  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 23.1502685546875 GB
    Memory Allocated: 0.3132743835449219  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.1502685546875 GB
    Memory Allocated: 0.1678929328918457  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.1502685546875 GB
    Memory Allocated: 0.17956972122192383  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1502685546875 GB
    Memory Allocated: 0.17956972122192383  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

first layer input nodes number: 430858
first layer output nodes number: 123164
edges number: 1219738
----------------------------------------before model layer 0
 Nvidia-smi: 23.1502685546875 GB
    Memory Allocated: 0.18369817733764648  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

torch.Size([430858, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 23.1502685546875 GB
    Memory Allocated: 0.18369817733764648  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

m.shape torch.Size([128, 1, 100])
----------------------------------------1
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6515913009643555  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6515913009643555  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 128, 100]), torch.Size([1, 128, 100])
----------------------------------------3
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6516866683959961  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6524496078491211  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 128, 100])
m.shape torch.Size([186, 2, 100])
----------------------------------------1
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6525406837463379  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6525406837463379  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 186, 100]), torch.Size([1, 186, 100])
----------------------------------------3
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6526799201965332  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6547627449035645  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 186, 100])
m.shape torch.Size([270, 3, 100])
----------------------------------------1
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6549949645996094  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6549949645996094  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 270, 100]), torch.Size([1, 270, 100])
----------------------------------------3
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6551961898803711  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6596231460571289  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 270, 100])
m.shape torch.Size([285, 4, 100])
----------------------------------------1
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.659947395324707  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.659947395324707  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 285, 100]), torch.Size([1, 285, 100])
----------------------------------------3
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6601600646972656  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6663217544555664  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 285, 100])
m.shape torch.Size([293, 5, 100])
----------------------------------------1
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6667613983154297  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6667613983154297  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 293, 100]), torch.Size([1, 293, 100])
----------------------------------------3
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6669797897338867  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6748418807983398  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 293, 100])
m.shape torch.Size([352, 6, 100])
----------------------------------------1
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6755194664001465  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6755194664001465  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 352, 100]), torch.Size([1, 352, 100])
----------------------------------------3
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6757817268371582  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6870589256286621  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 352, 100])
m.shape torch.Size([445, 7, 100])
----------------------------------------1
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6883163452148438  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6883163452148438  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 445, 100]), torch.Size([1, 445, 100])
----------------------------------------3
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.6886482238769531  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.7052321434020996  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 445, 100])
m.shape torch.Size([469, 8, 100])
----------------------------------------1
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.7064642906188965  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.7064642906188965  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 469, 100]), torch.Size([1, 469, 100])
----------------------------------------3
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.7068142890930176  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.7267413139343262  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 469, 100])
m.shape torch.Size([516, 9, 100])
----------------------------------------1
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.7291321754455566  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.7291321754455566  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 516, 100]), torch.Size([1, 516, 100])
----------------------------------------3
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.7295174598693848  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.6072998046875 GB
    Memory Allocated: 0.7541370391845703  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 516, 100])
m.shape torch.Size([120220, 10, 100])
----------------------------------------1
 Nvidia-smi: 2.4354248046875 GB
    Memory Allocated: 1.201798915863037  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4354248046875 GB
    Memory Allocated: 1.201798915863037  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 120220, 100]), torch.Size([1, 120220, 100])
----------------------------------------3
 Nvidia-smi: 2.5252685546875 GB
    Memory Allocated: 1.291642665863037  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.670548915863037  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 120220, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.213991641998291  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.33144998550415  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.44890832901001  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.33144998550415  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

torch.Size([123164, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.44890832901001  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.478272914886475  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.478272914886475  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.758477210998535  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.758477210998535  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.758482933044434  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.758528709411621  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.758535861968994  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.758535861968994  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.758545398712158  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.758688449859619  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([33, 3, 256])
----------------------------------------1
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.758779048919678  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.758779048919678  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.7588419914245605  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.760226726531982  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([32, 4, 256])
----------------------------------------1
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.760318279266357  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.760318279266357  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.760379314422607  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.762149333953857  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.762157440185547  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.762157440185547  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.762172698974609  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.762722015380859  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([19, 6, 256])
----------------------------------------1
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.762824058532715  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.762824058532715  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.762860298156738  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.764418601989746  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([28, 7, 256])
----------------------------------------1
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.764589309692383  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.764589309692383  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.764642715454102  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.767313003540039  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([14, 8, 256])
----------------------------------------1
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.767394065856934  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.767394065856934  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.767420768737793  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.768942832946777  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([29, 9, 256])
----------------------------------------1
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.769180774688721  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.769180774688721  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.769236087799072  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.772776126861572  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([18, 10, 256])
----------------------------------------1
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.772921562194824  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.772921562194824  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 9.3533935546875 GB
    Memory Allocated: 7.772955894470215  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3572998046875 GB
    Memory Allocated: 7.775393486022949  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 11, 256])
----------------------------------------1
 Nvidia-smi: 9.3572998046875 GB
    Memory Allocated: 7.775567054748535  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3572998046875 GB
    Memory Allocated: 7.775567054748535  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 9.3572998046875 GB
    Memory Allocated: 7.775601387023926  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3592529296875 GB
    Memory Allocated: 7.7782793045043945  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([41, 12, 256])
----------------------------------------1
 Nvidia-smi: 9.3592529296875 GB
    Memory Allocated: 7.778735160827637  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3592529296875 GB
    Memory Allocated: 7.778735160827637  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 9.3592529296875 GB
    Memory Allocated: 7.778813362121582  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3670654296875 GB
    Memory Allocated: 7.785460472106934  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([32, 13, 256])
----------------------------------------1
 Nvidia-smi: 9.3670654296875 GB
    Memory Allocated: 7.785821437835693  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3670654296875 GB
    Memory Allocated: 7.785821437835693  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 9.3670654296875 GB
    Memory Allocated: 7.785882472991943  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3729248046875 GB
    Memory Allocated: 7.791497707366943  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 9.3729248046875 GB
    Memory Allocated: 7.7919921875  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3729248046875 GB
    Memory Allocated: 7.7919921875  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 9.3729248046875 GB
    Memory Allocated: 7.79206657409668  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3807373046875 GB
    Memory Allocated: 7.799430847167969  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 9.3826904296875 GB
    Memory Allocated: 7.80008602142334  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3826904296875 GB
    Memory Allocated: 7.80008602142334  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 9.3826904296875 GB
    Memory Allocated: 7.800177574157715  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3924560546875 GB
    Memory Allocated: 7.809882164001465  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 9.3924560546875 GB
    Memory Allocated: 7.81023645401001  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3924560546875 GB
    Memory Allocated: 7.81023645401001  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 9.3924560546875 GB
    Memory Allocated: 7.810286045074463  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.3983154296875 GB
    Memory Allocated: 7.815889835357666  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 9.3983154296875 GB
    Memory Allocated: 7.8163228034973145  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.3983154296875 GB
    Memory Allocated: 7.8163228034973145  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 9.3983154296875 GB
    Memory Allocated: 7.816376209259033  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.4041748046875 GB
    Memory Allocated: 7.822784900665283  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([53, 18, 256])
----------------------------------------1
 Nvidia-smi: 9.4061279296875 GB
    Memory Allocated: 7.823675155639648  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.4061279296875 GB
    Memory Allocated: 7.823675155639648  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 9.4061279296875 GB
    Memory Allocated: 7.8237762451171875  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.4197998046875 GB
    Memory Allocated: 7.836614608764648  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([41, 19, 256])
----------------------------------------1
 Nvidia-smi: 9.4197998046875 GB
    Memory Allocated: 7.837313175201416  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.4197998046875 GB
    Memory Allocated: 7.837313175201416  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 9.4197998046875 GB
    Memory Allocated: 7.837391376495361  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.4295654296875 GB
    Memory Allocated: 7.847870349884033  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([65, 20, 256])
----------------------------------------1
 Nvidia-smi: 9.4295654296875 GB
    Memory Allocated: 7.849081039428711  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.4295654296875 GB
    Memory Allocated: 7.849081039428711  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 9.4295654296875 GB
    Memory Allocated: 7.849205017089844  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.4471435546875 GB
    Memory Allocated: 7.86668586730957  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([48, 21, 256])
----------------------------------------1
 Nvidia-smi: 9.4490966796875 GB
    Memory Allocated: 7.867592811584473  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.4490966796875 GB
    Memory Allocated: 7.867592811584473  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 9.4490966796875 GB
    Memory Allocated: 7.867684364318848  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.4627685546875 GB
    Memory Allocated: 7.881234169006348  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([56, 22, 256])
----------------------------------------1
 Nvidia-smi: 9.4627685546875 GB
    Memory Allocated: 7.882372856140137  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.4627685546875 GB
    Memory Allocated: 7.882372856140137  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 9.4627685546875 GB
    Memory Allocated: 7.882479667663574  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.4783935546875 GB
    Memory Allocated: 7.899035453796387  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([44, 23, 256])
----------------------------------------1
 Nvidia-smi: 9.4803466796875 GB
    Memory Allocated: 7.899954795837402  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.4803466796875 GB
    Memory Allocated: 7.899954795837402  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 9.4803466796875 GB
    Memory Allocated: 7.900038719177246  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.4940185546875 GB
    Memory Allocated: 7.913634300231934  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([62, 24, 256])
----------------------------------------1
 Nvidia-smi: 9.4940185546875 GB
    Memory Allocated: 7.915022850036621  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.4940185546875 GB
    Memory Allocated: 7.915022850036621  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 9.4940185546875 GB
    Memory Allocated: 7.9151411056518555  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.5135498046875 GB
    Memory Allocated: 7.935126304626465  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([11143, 25, 256])
----------------------------------------1
 Nvidia-smi: 9.7811279296875 GB
    Memory Allocated: 8.202812671661377  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------2
 Nvidia-smi: 9.7811279296875 GB
    Memory Allocated: 8.202812671661377  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

 h.shape torch.Size([1, 11143, 256]), torch.Size([1, 11143, 256])
----------------------------------------3
 Nvidia-smi: 9.7811279296875 GB
    Memory Allocated: 8.224066257476807  GigaBytes
Max Memory Allocated: 11.948860168457031  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5487060546875 GB
    Memory Allocated: 11.997571468353271  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 11143, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.5487060546875 GB
    Memory Allocated: 11.7211332321167  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.5487060546875 GB
    Memory Allocated: 11.723390579223633  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.5487060546875 GB
    Memory Allocated: 11.725805282592773  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.5487060546875 GB
    Memory Allocated: 11.723458766937256  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

torch.Size([11933, 47])
input nodes number: 123164
output nodes number: 11933
edges number: 290755
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5506591796875 GB
    Memory Allocated: 11.724514484405518  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.5506591796875 GB
    Memory Allocated: 11.724514961242676  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.1994619369506836  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

pseudo mini batch 12 input nodes size: 340758
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.16794157028198242  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.16794157028198242  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.29488420486450195  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.29497861862182617  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.1343822479248047  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.14618968963623047  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.14618968963623047  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

first layer input nodes number: 340758
first layer output nodes number: 119500
edges number: 1183416
----------------------------------------before model layer 0
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.14961957931518555  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

torch.Size([340758, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.14961957931518555  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

m.shape torch.Size([137, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6029157638549805  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6029157638549805  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 137, 100]), torch.Size([1, 137, 100])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6030187606811523  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6038384437561035  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 137, 100])
m.shape torch.Size([176, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6039180755615234  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6039180755615234  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 176, 100]), torch.Size([1, 176, 100])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6040496826171875  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.60601806640625  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 176, 100])
m.shape torch.Size([243, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6062240600585938  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6062240600585938  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 243, 100]), torch.Size([1, 243, 100])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6064052581787109  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6103916168212891  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 243, 100])
m.shape torch.Size([263, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6106929779052734  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6106929779052734  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 263, 100]), torch.Size([1, 263, 100])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6108894348144531  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6165752410888672  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 263, 100])
m.shape torch.Size([335, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6171011924743652  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6171011924743652  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 335, 100]), torch.Size([1, 335, 100])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6173510551452637  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6263389587402344  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 335, 100])
m.shape torch.Size([344, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6269831657409668  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6269831657409668  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 344, 100]), torch.Size([1, 344, 100])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6272397041320801  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6382622718811035  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 344, 100])
m.shape torch.Size([379, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.639122486114502  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.639122486114502  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 379, 100]), torch.Size([1, 379, 100])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6394057273864746  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6535377502441406  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 379, 100])
m.shape torch.Size([465, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6548323631286621  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6548323631286621  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 465, 100]), torch.Size([1, 465, 100])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.655179500579834  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6749434471130371  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 465, 100])
m.shape torch.Size([546, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6766009330749512  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6766009330749512  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 546, 100]), torch.Size([1, 546, 100])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.6770081520080566  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 0.7030572891235352  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 546, 100])
m.shape torch.Size([116612, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 1.1372675895690918  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 1.1372675895690918  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 116612, 100]), torch.Size([1, 116612, 100])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 1.2241511344909668  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.3928399085998535  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 116612, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 6.951226711273193  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.06519079208374  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.179154872894287  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.06519079208374  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

torch.Size([119500, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.179154872894287  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.207645893096924  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.207645893096924  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.511327266693115  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.511327266693115  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.511329174041748  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.5113444328308105  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.511349678039551  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.511349678039551  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.511355400085449  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.511441230773926  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.511453151702881  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.511453151702881  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.511462688446045  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.511672496795654  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.51169490814209  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.51169490814209  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.5117082595825195  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.5120954513549805  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([1, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.512094020843506  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.512094020843506  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.512095928192139  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.51216459274292  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.512202262878418  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.512202262878418  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.512211799621582  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.512755393981934  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.512820243835449  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.512820243835449  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.512835502624512  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.513812065124512  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.513814449310303  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.513814449310303  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.5138163566589355  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.513951778411865  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.513982772827148  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.513982772827148  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.513988494873047  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.514434814453125  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([21, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.514674186706543  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.514674186706543  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.514714241027832  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.518118858337402  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.51832389831543  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.51832389831543  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.51835823059082  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.521516799926758  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([2, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.52152681350708  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.52152681350708  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.521530628204346  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.521908283233643  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.521964073181152  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.521964073181152  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.521971702575684  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.522780418395996  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.522869110107422  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.522869110107422  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.522880554199219  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.524173736572266  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.524250030517578  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.524250030517578  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.524259567260742  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.52540397644043  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.525451183319092  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.525451183319092  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.52545690536499  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.526183605194092  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.526546001434326  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.526546001434326  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.526584148406982  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.53169584274292  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([4, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.531754016876221  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.531754016876221  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.531761646270752  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.532837390899658  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.532975196838379  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.532975196838379  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.532988548278809  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.534964561462402  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.535063743591309  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.535063743591309  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.535073280334473  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.536551475524902  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.5368123054504395  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.5368123054504395  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.536835193634033  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.540543079376221  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.540762424468994  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.540762424468994  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.540781497955322  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.544004917144775  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12502, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.844395160675049  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.844395160675049  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

 h.shape torch.Size([1, 12502, 256]), torch.Size([1, 12502, 256])
----------------------------------------3
 Nvidia-smi: 14.1092529296875 GB
    Memory Allocated: 7.868240833282471  GigaBytes
Max Memory Allocated: 12.263241291046143  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.0447998046875 GB
    Memory Allocated: 12.06507921218872  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 12502, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 17.0447998046875 GB
    Memory Allocated: 11.764739513397217  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 17.0447998046875 GB
    Memory Allocated: 11.767146587371826  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.0447998046875 GB
    Memory Allocated: 11.770265102386475  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 17.0447998046875 GB
    Memory Allocated: 11.767763614654541  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

torch.Size([12653, 47])
input nodes number: 119500
output nodes number: 12653
edges number: 314802
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0447998046875 GB
    Memory Allocated: 11.768898487091064  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0447998046875 GB
    Memory Allocated: 11.768898963928223  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.16643047332763672  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

pseudo mini batch 13 input nodes size: 260952
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.13453197479248047  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.13453197479248047  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.23174428939819336  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.23183345794677734  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.1047964096069336  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.11443901062011719  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.11443901062011719  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

first layer input nodes number: 260952
first layer output nodes number: 101065
edges number: 998004
----------------------------------------before model layer 0
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.11726856231689453  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

torch.Size([260952, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.11726856231689453  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

m.shape torch.Size([156, 1, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.49956798553466797  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.49956798553466797  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 156, 100]), torch.Size([1, 156, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.49968433380126953  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.500615119934082  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 156, 100])
m.shape torch.Size([212, 2, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5007152557373047  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5007152557373047  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 212, 100]), torch.Size([1, 212, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5008735656738281  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5032453536987305  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 212, 100])
m.shape torch.Size([235, 3, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5034289360046387  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5034289360046387  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 235, 100]), torch.Size([1, 235, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5036044120788574  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5074605941772461  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 235, 100])
m.shape torch.Size([279, 4, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5077886581420898  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5077886581420898  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 279, 100]), torch.Size([1, 279, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5079965591430664  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5140256881713867  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 279, 100])
m.shape torch.Size([365, 5, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5146017074584961  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5146017074584961  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 365, 100]), torch.Size([1, 365, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5148744583129883  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5246720314025879  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 365, 100])
m.shape torch.Size([374, 6, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5253720283508301  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5253720283508301  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 374, 100]), torch.Size([1, 374, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5256514549255371  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5376410484313965  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 374, 100])
m.shape torch.Size([441, 7, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5386514663696289  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5386514663696289  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 441, 100]), torch.Size([1, 441, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5389804840087891  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5554213523864746  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 441, 100])
m.shape torch.Size([514, 8, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5567889213562012  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5567889213562012  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 514, 100]), torch.Size([1, 514, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5571722984313965  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5790133476257324  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 514, 100])
m.shape torch.Size([555, 9, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5806827545166016  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5806827545166016  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 555, 100]), torch.Size([1, 555, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.5810966491699219  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6075730323791504  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 555, 100])
m.shape torch.Size([97934, 10, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.9721989631652832  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.9721989631652832  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 97934, 100]), torch.Size([1, 97934, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 1.0451655387878418  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.225792407989502  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 97934, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 5.853282451629639  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 5.949665546417236  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.046048641204834  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 5.949665546417236  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

torch.Size([101065, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.046048641204834  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.0701446533203125  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.0701446533203125  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.3556928634643555  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.3556928634643555  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.355708122253418  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.3559370040893555  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([12, 3, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.355964183807373  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.355964183807373  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.355987071990967  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.356490612030029  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.3564910888671875  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.3564910888671875  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.356496810913086  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.356662750244141  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.356679439544678  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.356679439544678  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.356687068939209  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.356961727142334  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([15, 6, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.357044696807861  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.357044696807861  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.3570733070373535  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.358303546905518  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.358309745788574  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.358309745788574  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.358315467834473  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.3586015701293945  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.358622074127197  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.358622074127197  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.358627796173096  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.358953952789307  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([9, 9, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.359029293060303  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.359029293060303  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.359046459197998  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.360145092010498  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.360165596008301  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.360165596008301  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.360171318054199  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.360577583312988  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 11, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.360617160797119  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.360617160797119  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.36062479019165  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.361219882965088  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 12, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.36128568649292  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.36128568649292  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.361297130584717  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.362269878387451  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 13, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.362376689910889  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.362376689910889  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.362393856048584  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.363973140716553  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([9, 14, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.364085674285889  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.364085674285889  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.364102840423584  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.36580228805542  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 15, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.365894794464111  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.365894794464111  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.365908145904541  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.367323398590088  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([13, 16, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.367516994476318  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.367516994476318  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.367541790008545  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.3703436851501465  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([5, 17, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.370413303375244  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.370413303375244  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.370422840118408  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.371567249298096  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 18, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.371701240539551  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.371701240539551  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.371716499328613  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.373654365539551  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.373939037322998  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.373939037322998  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.373969554901123  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.378058910369873  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.378293991088867  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.378293991088867  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.378318786621094  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.381814956665039  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.3821258544921875  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.3821258544921875  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.3821563720703125  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.3866729736328125  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.386848449707031  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.386848449707031  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.386865615844727  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.3895263671875  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.389894008636475  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.389894008636475  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.389926433563232  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.395179271697998  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.395762920379639  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.395762920379639  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.395812511444092  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.40419340133667  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([11709, 25, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.685539245605469  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.685539245605469  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 11709, 256]), torch.Size([1, 11709, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.708976745605469  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 10.669147491455078  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 11709, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 10.386495590209961  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 10.38858413696289  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 10.39067268371582  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 10.388494968414307  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

torch.Size([11927, 47])
input nodes number: 101065
output nodes number: 11927
edges number: 296069
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 10.389019012451172  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 10.38901948928833  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.13274860382080078  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

pseudo mini batch 14 input nodes size: 343632
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.1044778823852539  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.1044778823852539  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.23249101638793945  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.23258161544799805  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.13528013229370117  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.14725446701049805  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.14725446701049805  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

first layer input nodes number: 343632
first layer output nodes number: 119233
edges number: 1178357
----------------------------------------before model layer 0
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.15070390701293945  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

torch.Size([343632, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.15070390701293945  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

m.shape torch.Size([150, 1, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.602454662322998  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.602454662322998  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 150, 100]), torch.Size([1, 150, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.602567195892334  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6034631729125977  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 150, 100])
m.shape torch.Size([217, 2, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6035690307617188  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6035690307617188  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 217, 100]), torch.Size([1, 217, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6037311553955078  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6061601638793945  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 217, 100])
m.shape torch.Size([257, 3, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6063666343688965  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6063666343688965  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 257, 100]), torch.Size([1, 257, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6065583229064941  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6107754707336426  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 257, 100])
m.shape torch.Size([337, 4, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6111822128295898  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6111822128295898  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 337, 100]), torch.Size([1, 337, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6114339828491211  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6187238693237305  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 337, 100])
m.shape torch.Size([385, 5, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6193151473999023  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6193151473999023  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 385, 100]), torch.Size([1, 385, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6196022033691406  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6299362182617188  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 385, 100])
m.shape torch.Size([475, 6, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6316103935241699  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6316103935241699  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 475, 100]), torch.Size([1, 475, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.631965160369873  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6471943855285645  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 475, 100])
m.shape torch.Size([542, 7, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6484308242797852  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6484308242797852  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 542, 100]), torch.Size([1, 542, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6488351821899414  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6690330505371094  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 542, 100])
m.shape torch.Size([522, 8, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.670386791229248  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.670386791229248  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 522, 100]), torch.Size([1, 522, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6707758903503418  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6929545402526855  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 522, 100])
m.shape torch.Size([571, 9, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6946744918823242  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6946744918823242  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 571, 100]), torch.Size([1, 571, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6951007843017578  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.7223448753356934  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 571, 100])
m.shape torch.Size([115777, 10, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 1.1534347534179688  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 1.1534347534179688  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 115777, 100]), torch.Size([1, 115777, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 1.2396955490112305  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.3642120361328125  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 115777, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.924798011779785  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.038507461547852  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.152216911315918  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.038507461547852  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

torch.Size([119233, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.152216911315918  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.180644512176514  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.180644512176514  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.471518039703369  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.471518039703369  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.471521854400635  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.47155237197876  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.471554756164551  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.471554756164551  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.471558570861816  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.471615791320801  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.471628665924072  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.471628665924072  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.471638202667236  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.471848011016846  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.471870422363281  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.471870422363281  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.471883773803711  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.472270965576172  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([14, 5, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.472332000732422  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.472332000732422  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.472358703613281  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.473320007324219  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.4733357429504395  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.4733357429504395  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.4733452796936035  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.473755359649658  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([13, 7, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.4738383293151855  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.4738383293151855  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.473863124847412  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.47510290145874  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([7, 8, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.475144386291504  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.475144386291504  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.475157737731934  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.475918769836426  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([12, 9, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.476016044616699  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.476016044616699  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.476038932800293  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.477503776550293  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 10, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.477588653564453  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.477588653564453  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.477607727050781  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.478961944580078  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([15, 11, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.479111194610596  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.479111194610596  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.479139804840088  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.4813714027404785  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([9, 12, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.481461048126221  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.481461048126221  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.481478214263916  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.482937335968018  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 13, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483028888702393  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483028888702393  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483044147491455  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.484447956085205  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 14, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.484534740447998  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.484534740447998  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.484548091888428  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.485869884490967  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 15, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.485964298248291  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.485964298248291  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.485977649688721  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.487392902374268  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([12, 16, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.487570762634277  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.487570762634277  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.487593650817871  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.490180015563965  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 17, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.490332126617432  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.490332126617432  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.49035120010376  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.492640018463135  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.492976665496826  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.492976665496826  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.493014812469482  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.497859477996826  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.49802303314209  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.49802303314209  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.498042106628418  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.500597953796387  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 20, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.500819206237793  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.500819206237793  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.500842094421387  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.5040693283081055  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.5042195320129395  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.5042195320129395  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.504234790802002  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.506493091583252  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.506739616394043  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.506739616394043  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.506762504577637  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.510310173034668  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 23, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.510541915893555  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.510541915893555  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.510562896728516  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.5139617919921875  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.514343738555908  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.514343738555908  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.514376163482666  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.519855976104736  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11907, 25, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.805943012237549  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.805943012237549  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 11907, 256]), torch.Size([1, 11907, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.829380512237549  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 11.842686653137207  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 11907, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 11.555593490600586  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 11.557785511016846  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 11.559911727905273  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 11.557629108428955  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

torch.Size([12142, 47])
input nodes number: 119233
output nodes number: 12142
edges number: 301004
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 11.558712005615234  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 11.558712482452393  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.16878938674926758  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

pseudo mini batch 15 input nodes size: 348981
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.13538360595703125  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.13538360595703125  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.26538944244384766  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.2654838562011719  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.13738012313842773  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.14909887313842773  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.14909887313842773  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

first layer input nodes number: 348981
first layer output nodes number: 119051
edges number: 1178217
----------------------------------------before model layer 0
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.1525864601135254  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

torch.Size([348981, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.1525864601135254  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

m.shape torch.Size([162, 1, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6042437553405762  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6042437553405762  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 162, 100]), torch.Size([1, 162, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6043648719787598  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6053323745727539  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 162, 100])
m.shape torch.Size([228, 2, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6054420471191406  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6054420471191406  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 228, 100]), torch.Size([1, 228, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6056127548217773  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6081647872924805  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 228, 100])
m.shape torch.Size([215, 3, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6083197593688965  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6083197593688965  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 215, 100]), torch.Size([1, 215, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6084799766540527  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6120047569274902  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 215, 100])
m.shape torch.Size([287, 4, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6123523712158203  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6123523712158203  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 287, 100]), torch.Size([1, 287, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6125669479370117  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6187725067138672  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 287, 100])
m.shape torch.Size([324, 5, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6192688941955566  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6192688941955566  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 324, 100]), torch.Size([1, 324, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6195111274719238  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6282100677490234  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 324, 100])
m.shape torch.Size([401, 6, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6289854049682617  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6289854049682617  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 401, 100]), torch.Size([1, 401, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6292848587036133  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6421442031860352  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 401, 100])
m.shape torch.Size([397, 7, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6430301666259766  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6430301666259766  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 397, 100]), torch.Size([1, 397, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6433267593383789  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6581263542175293  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 397, 100])
m.shape torch.Size([428, 8, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6592535972595215  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6592535972595215  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 428, 100]), torch.Size([1, 428, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6595730781555176  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6777606010437012  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 428, 100])
m.shape torch.Size([513, 9, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6793212890625  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6793212890625  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 513, 100]), torch.Size([1, 513, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.6797037124633789  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.7041788101196289  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 513, 100])
m.shape torch.Size([116096, 10, 100])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 1.1364789009094238  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 1.1364789009094238  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 116096, 100]), torch.Size([1, 116096, 100])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 1.2229771614074707  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.364353656768799  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 116096, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 6.924877166748047  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.038413047790527  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.151948928833008  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.038413047790527  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

torch.Size([119051, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.151948928833008  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.180333137512207  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.180333137512207  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483290195465088  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483290195465088  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483292102813721  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483307361602783  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483308792114258  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483308792114258  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483310699462891  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483339309692383  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483347415924072  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483347415924072  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483353137969971  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483479022979736  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483491897583008  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483491897583008  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483499526977539  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483720779418945  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483736515045166  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483736515045166  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.483744144439697  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.484018802642822  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.4840497970581055  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.4840497970581055  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.484061241149902  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.484553337097168  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 7, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.484608173370361  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.484608173370361  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.484625339508057  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.485483646392822  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 8, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.485536575317383  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.485536575317383  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.485551834106445  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.486421585083008  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 9, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.486492156982422  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.486492156982422  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.486509323120117  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.487607955932617  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 10, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.487676620483398  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.487676620483398  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.487691879272461  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.488775253295898  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 11, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.488831520080566  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.488831520080566  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.488842964172363  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.4897356033325195  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 12, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.489845275878906  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.489845275878906  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.489864349365234  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.491485595703125  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 13, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.491638660430908  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.491638660430908  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.491663455963135  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.4939446449279785  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([10, 14, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.494067192077637  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.494067192077637  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.494086265563965  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.495974540710449  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 15, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.496095180511475  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.496095180511475  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.49611234664917  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.497931957244873  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([9, 16, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.4980621337890625  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.4980621337890625  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.498079299926758  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.500019073486328  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 17, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.500174045562744  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.500174045562744  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.500193119049072  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.502481937408447  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 18, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.5026631355285645  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.5026631355285645  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.502684116363525  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.5053486824035645  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.505539417266846  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.505539417266846  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.505560398101807  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.508371829986572  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.508649826049805  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.508649826049805  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.508678436279297  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.512712478637695  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.512960910797119  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.512960910797119  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.512985706329346  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.516655445098877  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.516981601715088  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.516981601715088  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.517012119293213  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.521742343902588  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.522103309631348  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.522103309631348  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.5221357345581055  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.527388572692871  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.527787685394287  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.527787685394287  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.527822017669678  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.533624172210693  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12412, 25, 256])
----------------------------------------1
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.831844329833984  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.831844329833984  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

 h.shape torch.Size([1, 12412, 256]), torch.Size([1, 12412, 256])
----------------------------------------3
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 7.855518341064453  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 12.022466659545898  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

rst.shape  torch.Size([1, 12412, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 11.7231764793396  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 11.72607946395874  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 11.728757858276367  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 11.725760459899902  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

torch.Size([12633, 47])
input nodes number: 119051
output nodes number: 12633
edges number: 313771
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 11.726762294769287  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 11.726762771606445  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.17020606994628906  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.17529296875  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.3455810546875 GB
    Memory Allocated: 0.17529296875  GigaBytes
Max Memory Allocated: 12.36390733718872  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08913396298885345 |0.02845992147922516 |0.2546062171459198 |0.00010551512241363525 |0.11805783212184906 |0.005229949951171875 |
----------------------------------------------------------pseudo_mini_loss sum 5.38755989074707
Total (block generation + training)time/epoch 79.24462342262268
* Pure training time/epoch 7.85104513168335
Training time/epoch 7.9826273918151855
Training time without block to device /epoch 7.527268648147583
Training time without total dataloading part /epoch 5.969542980194092
load block tensor time/epoch 1.4261434078216553
block to device time/epoch 0.45535874366760254
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6683790
Number of first layer input nodes during this epoch:  4981874
Number of first layer output nodes during this epoch:  1701916
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  682400
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([400, 100])
layers.0.lstm.weight_hh_l0, torch.Size([400, 100])
layers.0.lstm.bias_ih_l0, torch.Size([400])
layers.0.lstm.bias_hh_l0, torch.Size([400])
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([47, 256])
layers.1.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
