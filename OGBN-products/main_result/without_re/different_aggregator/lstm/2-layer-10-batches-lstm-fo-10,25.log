main start at this time 1655790368.3166237
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.20379257202148438
global_2_local spend time (sec) 0.3914363384246826
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.048575639724731445
A = g.adjacency_matrix() spent  0.07494139671325684
auxiliary_graph
Graph(num_nodes=1205586, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.5857806205749512
remove nodes length
1009015
auxiliary_graph.remove_nodes spent  2.679236888885498
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.0637800693511963

the counter of shared neighbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
51547892
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 51547889, 51547890, 51547891])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
Convert a graph into a bidirected graph: 2.932 seconds
Metis partitioning: 11.791 seconds
Split the graph: 1.599 seconds
Construct subgraphs: 0.236 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  16.57991313934326
20238
20193
19104
20106
19158
19183
19183
20185
19083
20138
total k batches seeds list generation spend  37.59913372993469
after graph partition
graph partition algorithm spend time 38.21314215660095
20238
20193
19104
20106
19158
19183
19183
20185
19083
20138
partition_len_list
[149441, 150351, 124062, 154517, 153548, 156069, 148650, 184302, 168386, 178140]
shared_neighbor_graph_partition_s0 selection method  spend 38.848153829574585
time for parepare:  0.2502870559692383
local_output_nid generation:  0.005288124084472656
local_in_edges_tensor generation:  0.006772279739379883
mini_batch_src_global generation:  0.015625953674316406
r_  generation:  0.17180562019348145
local_output_nid generation:  0.007253408432006836
local_in_edges_tensor generation:  0.006646156311035156
mini_batch_src_global generation:  0.02533411979675293
r_  generation:  0.19161629676818848
local_output_nid generation:  0.006204366683959961
local_in_edges_tensor generation:  0.006283998489379883
mini_batch_src_global generation:  0.034442901611328125
r_  generation:  0.1743621826171875
local_output_nid generation:  0.006138801574707031
local_in_edges_tensor generation:  0.006626129150390625
mini_batch_src_global generation:  0.022330045700073242
r_  generation:  0.19167780876159668
local_output_nid generation:  0.005982160568237305
local_in_edges_tensor generation:  0.008198261260986328
mini_batch_src_global generation:  0.021892547607421875
r_  generation:  0.18881750106811523
local_output_nid generation:  0.007911205291748047
local_in_edges_tensor generation:  0.008760929107666016
mini_batch_src_global generation:  0.021886825561523438
r_  generation:  0.1931018829345703
local_output_nid generation:  0.006891727447509766
local_in_edges_tensor generation:  0.006246805191040039
mini_batch_src_global generation:  0.021691560745239258
r_  generation:  0.1806638240814209
local_output_nid generation:  0.006299257278442383
local_in_edges_tensor generation:  0.008911371231079102
mini_batch_src_global generation:  0.025203227996826172
r_  generation:  0.23758816719055176
local_output_nid generation:  0.006025791168212891
local_in_edges_tensor generation:  0.0076906681060791016
mini_batch_src_global generation:  0.02419900894165039
r_  generation:  0.21239948272705078
local_output_nid generation:  0.00634312629699707
local_in_edges_tensor generation:  0.006710529327392578
mini_batch_src_global generation:  0.024834394454956055
r_  generation:  0.23860859870910645
----------------------check_connections_block total spend ----------------------------- 3.0297727584838867
generate_one_block  1.6410069465637207
generate_one_block  0.2459123134613037
generate_one_block  0.2210843563079834
generate_one_block  0.2407522201538086
generate_one_block  0.2323606014251709
generate_one_block  0.24344468116760254
generate_one_block  0.21322941780090332
generate_one_block  0.2607700824737549
generate_one_block  0.2406013011932373
generate_one_block  0.2537567615509033
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7575724124908447
gen group dst list time:  0.04534459114074707
time for parepare:  0.3968956470489502
local_output_nid generation:  0.03664231300354004
local_in_edges_tensor generation:  0.11324000358581543
mini_batch_src_global generation:  0.04411506652832031
r_  generation:  0.6171369552612305
local_output_nid generation:  0.03870701789855957
local_in_edges_tensor generation:  0.05205368995666504
mini_batch_src_global generation:  0.059560298919677734
r_  generation:  0.6515426635742188
local_output_nid generation:  0.03121781349182129
local_in_edges_tensor generation:  0.027051448822021484
mini_batch_src_global generation:  0.05845475196838379
r_  generation:  0.5042939186096191
local_output_nid generation:  0.04048299789428711
local_in_edges_tensor generation:  0.037293195724487305
mini_batch_src_global generation:  0.05468630790710449
r_  generation:  0.704716682434082
local_output_nid generation:  0.04157209396362305
local_in_edges_tensor generation:  0.047722578048706055
mini_batch_src_global generation:  0.060544490814208984
r_  generation:  0.704340934753418
local_output_nid generation:  0.041665077209472656
local_in_edges_tensor generation:  0.04394865036010742
mini_batch_src_global generation:  0.06579113006591797
r_  generation:  0.7182521820068359
local_output_nid generation:  0.03935694694519043
local_in_edges_tensor generation:  0.04132843017578125
mini_batch_src_global generation:  0.061573028564453125
r_  generation:  0.7208254337310791
local_output_nid generation:  0.04697680473327637
local_in_edges_tensor generation:  0.05476498603820801
mini_batch_src_global generation:  0.07078099250793457
r_  generation:  0.9078993797302246
local_output_nid generation:  0.044228553771972656
local_in_edges_tensor generation:  0.042215585708618164
mini_batch_src_global generation:  0.07102227210998535
r_  generation:  0.8020024299621582
local_output_nid generation:  0.047072649002075195
local_in_edges_tensor generation:  0.052140235900878906
mini_batch_src_global generation:  0.07349896430969238
r_  generation:  0.8938620090484619
----------------------check_connections_block total spend ----------------------------- 10.580353021621704
generate_one_block  0.9228887557983398
generate_one_block  0.8980836868286133
generate_one_block  0.6589772701263428
generate_one_block  0.8002052307128906
generate_one_block  0.7963004112243652
generate_one_block  0.9058952331542969
generate_one_block  0.7805490493774414
generate_one_block  1.0597777366638184
generate_one_block  0.8821237087249756
generate_one_block  1.0102384090423584
----------===============-------------===============-------------the number of batches *****---- 10

original number of batches:  10
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

connection checking time:  13.61012578010559
block generation total time  12.507958173751831
average batch blocks generation time:  0.6253979086875916
block dataloader generation time/epoch 66.98173713684082
pseudo mini batch 0 input nodes size: 386758
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.14707469940185547  GigaBytes
Max Memory Allocated: 0.14707469940185547  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.14722585678100586  GigaBytes
Max Memory Allocated: 0.14722585678100586  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1639404296875 GB
    Memory Allocated: 0.14722585678100586  GigaBytes
Max Memory Allocated: 0.14722585678100586  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.16183996200561523  GigaBytes
Max Memory Allocated: 0.16183996200561523  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2479248046875 GB
    Memory Allocated: 0.16183996200561523  GigaBytes
Max Memory Allocated: 0.16183996200561523  GigaBytes

first layer input nodes number: 386758
first layer output nodes number: 149441
edges number: 1462214
----------------------------------------before model layer 0
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.16675710678100586  GigaBytes
Max Memory Allocated: 0.17220449447631836  GigaBytes

torch.Size([386758, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2674560546875 GB
    Memory Allocated: 0.16675710678100586  GigaBytes
Max Memory Allocated: 0.17220449447631836  GigaBytes

m.shape torch.Size([295, 1, 100])
----------------------------------------1
 Nvidia-smi: 1.9569091796875 GB
    Memory Allocated: 0.7271456718444824  GigaBytes
Max Memory Allocated: 0.7520155906677246  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9569091796875 GB
    Memory Allocated: 0.7271456718444824  GigaBytes
Max Memory Allocated: 0.7520155906677246  GigaBytes

 h.shape torch.Size([1, 295, 100]), torch.Size([1, 295, 100])
----------------------------------------3
 Nvidia-smi: 1.9569091796875 GB
    Memory Allocated: 0.7273659706115723  GigaBytes
Max Memory Allocated: 0.7520155906677246  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.7291254997253418  GigaBytes
Max Memory Allocated: 0.7520155906677246  GigaBytes

rst.shape  torch.Size([1, 295, 100])
m.shape torch.Size([416, 2, 100])
----------------------------------------1
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.7293252944946289  GigaBytes
Max Memory Allocated: 0.7520155906677246  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9588623046875 GB
    Memory Allocated: 0.7293252944946289  GigaBytes
Max Memory Allocated: 0.7520155906677246  GigaBytes

 h.shape torch.Size([1, 416, 100]), torch.Size([1, 416, 100])
----------------------------------------3
 Nvidia-smi: 1.9608154296875 GB
    Memory Allocated: 0.7296352386474609  GigaBytes
Max Memory Allocated: 0.7520155906677246  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9647216796875 GB
    Memory Allocated: 0.7342844009399414  GigaBytes
Max Memory Allocated: 0.7520155906677246  GigaBytes

rst.shape  torch.Size([1, 416, 100])
m.shape torch.Size([641, 3, 100])
----------------------------------------1
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.7348461151123047  GigaBytes
Max Memory Allocated: 0.7520155906677246  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.7348461151123047  GigaBytes
Max Memory Allocated: 0.7520155906677246  GigaBytes

 h.shape torch.Size([1, 641, 100]), torch.Size([1, 641, 100])
----------------------------------------3
 Nvidia-smi: 1.9666748046875 GB
    Memory Allocated: 0.7353239059448242  GigaBytes
Max Memory Allocated: 0.7520155906677246  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.7458353042602539  GigaBytes
Max Memory Allocated: 0.7520155906677246  GigaBytes

rst.shape  torch.Size([1, 641, 100])
m.shape torch.Size([832, 4, 100])
----------------------------------------1
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.7468361854553223  GigaBytes
Max Memory Allocated: 0.7520155906677246  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.7468361854553223  GigaBytes
Max Memory Allocated: 0.7520155906677246  GigaBytes

 h.shape torch.Size([1, 832, 100]), torch.Size([1, 832, 100])
----------------------------------------3
 Nvidia-smi: 1.9783935546875 GB
    Memory Allocated: 0.7474560737609863  GigaBytes
Max Memory Allocated: 0.7520155906677246  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.7664475440979004  GigaBytes
Max Memory Allocated: 0.7676873207092285  GigaBytes

rst.shape  torch.Size([1, 832, 100])
m.shape torch.Size([994, 5, 100])
----------------------------------------1
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.7679891586303711  GigaBytes
Max Memory Allocated: 0.7680449485778809  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9803466796875 GB
    Memory Allocated: 0.7679891586303711  GigaBytes
Max Memory Allocated: 0.7680449485778809  GigaBytes

 h.shape torch.Size([1, 994, 100]), torch.Size([1, 994, 100])
----------------------------------------3
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.7687301635742188  GigaBytes
Max Memory Allocated: 0.7687301635742188  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.7953991889953613  GigaBytes
Max Memory Allocated: 0.7972507476806641  GigaBytes

rst.shape  torch.Size([1, 994, 100])
m.shape torch.Size([1116, 6, 100])
----------------------------------------1
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.7975234985351562  GigaBytes
Max Memory Allocated: 0.7975988388061523  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.7975234985351562  GigaBytes
Max Memory Allocated: 0.7975988388061523  GigaBytes

 h.shape torch.Size([1, 1116, 100]), torch.Size([1, 1116, 100])
----------------------------------------3
 Nvidia-smi: 2.0076904296875 GB
    Memory Allocated: 0.7983551025390625  GigaBytes
Max Memory Allocated: 0.7983551025390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0526123046875 GB
    Memory Allocated: 0.8344902992248535  GigaBytes
Max Memory Allocated: 0.8369851112365723  GigaBytes

rst.shape  torch.Size([1, 1116, 100])
m.shape torch.Size([1247, 7, 100])
----------------------------------------1
 Nvidia-smi: 2.0526123046875 GB
    Memory Allocated: 0.8373265266418457  GigaBytes
Max Memory Allocated: 0.8374247550964355  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0526123046875 GB
    Memory Allocated: 0.8373265266418457  GigaBytes
Max Memory Allocated: 0.8374247550964355  GigaBytes

 h.shape torch.Size([1, 1247, 100]), torch.Size([1, 1247, 100])
----------------------------------------3
 Nvidia-smi: 2.0545654296875 GB
    Memory Allocated: 0.8382563591003418  GigaBytes
Max Memory Allocated: 0.8382563591003418  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1014404296875 GB
    Memory Allocated: 0.8861970901489258  GigaBytes
Max Memory Allocated: 0.8894491195678711  GigaBytes

rst.shape  torch.Size([1, 1247, 100])
m.shape torch.Size([1186, 8, 100])
----------------------------------------1
 Nvidia-smi: 2.1014404296875 GB
    Memory Allocated: 0.8892669677734375  GigaBytes
Max Memory Allocated: 0.8894491195678711  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1014404296875 GB
    Memory Allocated: 0.8892669677734375  GigaBytes
Max Memory Allocated: 0.8894491195678711  GigaBytes

 h.shape torch.Size([1, 1186, 100]), torch.Size([1, 1186, 100])
----------------------------------------3
 Nvidia-smi: 2.1014404296875 GB
    Memory Allocated: 0.8901510238647461  GigaBytes
Max Memory Allocated: 0.8901510238647461  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1678466796875 GB
    Memory Allocated: 0.9407052993774414  GigaBytes
Max Memory Allocated: 0.9442400932312012  GigaBytes

rst.shape  torch.Size([1, 1186, 100])
m.shape torch.Size([1187, 9, 100])
----------------------------------------1
 Nvidia-smi: 2.1678466796875 GB
    Memory Allocated: 0.9442434310913086  GigaBytes
Max Memory Allocated: 0.9443631172180176  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1678466796875 GB
    Memory Allocated: 0.9442434310913086  GigaBytes
Max Memory Allocated: 0.9443631172180176  GigaBytes

 h.shape torch.Size([1, 1187, 100]), torch.Size([1, 1187, 100])
----------------------------------------3
 Nvidia-smi: 2.1697998046875 GB
    Memory Allocated: 0.9451284408569336  GigaBytes
Max Memory Allocated: 0.9451284408569336  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2381591796875 GB
    Memory Allocated: 1.001814842224121  GigaBytes
Max Memory Allocated: 1.0057950019836426  GigaBytes

rst.shape  torch.Size([1, 1187, 100])
m.shape torch.Size([141527, 10, 100])
----------------------------------------1
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.5287160873413086  GigaBytes
Max Memory Allocated: 1.5445332527160645  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.7850341796875 GB
    Memory Allocated: 1.5287160873413086  GigaBytes
Max Memory Allocated: 1.5445332527160645  GigaBytes

 h.shape torch.Size([1, 141527, 100]), torch.Size([1, 141527, 100])
----------------------------------------3
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.6341848373413086  GigaBytes
Max Memory Allocated: 1.6341848373413086  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 9.122466087341309  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 141527, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 8.577677249908447  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 8.720195293426514  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 8.86271333694458  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 8.720195293426514  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

torch.Size([149441, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 8.86271333694458  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 8.898343086242676  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.9061279296875 GB
    Memory Allocated: 8.898343086242676  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

m.shape torch.Size([10, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.379414081573486  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.379414081573486  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.379433155059814  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.37958574295044  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.379584312438965  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.379584312438965  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.379591941833496  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.379706382751465  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([17, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.379751682281494  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.379751682281494  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.379784107208252  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.380497455596924  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([16, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.380542755126953  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.380542755126953  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.380573272705078  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.381458282470703  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([24, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.381558418273926  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.381558418273926  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.381604194641113  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.383252143859863  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.383362293243408  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.383362293243408  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.383406162261963  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.385292530059814  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([22, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.385418891906738  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.385418891906738  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.38546085357666  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.387558937072754  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.387691974639893  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.387691974639893  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.387730121612549  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.389904499053955  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([29, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.39013671875  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.39013671875  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 11.3826904296875 GB
    Memory Allocated: 9.390192031860352  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3865966796875 GB
    Memory Allocated: 9.393732070922852  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([26, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.3865966796875 GB
    Memory Allocated: 9.393954753875732  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3865966796875 GB
    Memory Allocated: 9.393954753875732  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 11.3865966796875 GB
    Memory Allocated: 9.394004344940186  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3905029296875 GB
    Memory Allocated: 9.397525310516357  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([32, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.3905029296875 GB
    Memory Allocated: 9.397839069366455  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3905029296875 GB
    Memory Allocated: 9.397839069366455  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 11.3905029296875 GB
    Memory Allocated: 9.397900104522705  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3944091796875 GB
    Memory Allocated: 9.402660846710205  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([29, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.3944091796875 GB
    Memory Allocated: 9.402965068817139  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3944091796875 GB
    Memory Allocated: 9.402965068817139  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 11.3944091796875 GB
    Memory Allocated: 9.40302038192749  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4002685546875 GB
    Memory Allocated: 9.407721996307373  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.4002685546875 GB
    Memory Allocated: 9.407981872558594  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4002685546875 GB
    Memory Allocated: 9.407981872558594  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 11.4002685546875 GB
    Memory Allocated: 9.408025741577148  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4041748046875 GB
    Memory Allocated: 9.41206169128418  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([34, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.4041748046875 GB
    Memory Allocated: 9.412497520446777  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4041748046875 GB
    Memory Allocated: 9.412497520446777  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 11.4041748046875 GB
    Memory Allocated: 9.412562370300293  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4119873046875 GB
    Memory Allocated: 9.41898250579834  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([46, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.4119873046875 GB
    Memory Allocated: 9.419613361358643  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4119873046875 GB
    Memory Allocated: 9.419613361358643  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 11.4119873046875 GB
    Memory Allocated: 9.419701099395752  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4217529296875 GB
    Memory Allocated: 9.429001331329346  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.4217529296875 GB
    Memory Allocated: 9.429372787475586  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4217529296875 GB
    Memory Allocated: 9.429372787475586  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 11.4217529296875 GB
    Memory Allocated: 9.429424285888672  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4276123046875 GB
    Memory Allocated: 9.435243606567383  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([33, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.4276123046875 GB
    Memory Allocated: 9.435757160186768  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4276123046875 GB
    Memory Allocated: 9.435757160186768  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 11.4276123046875 GB
    Memory Allocated: 9.43582010269165  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4354248046875 GB
    Memory Allocated: 9.443373203277588  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.4354248046875 GB
    Memory Allocated: 9.44386100769043  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4354248046875 GB
    Memory Allocated: 9.44386100769043  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 11.4354248046875 GB
    Memory Allocated: 9.443918228149414  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4432373046875 GB
    Memory Allocated: 9.45118522644043  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.4432373046875 GB
    Memory Allocated: 9.451650142669678  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4432373046875 GB
    Memory Allocated: 9.451650142669678  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 11.4432373046875 GB
    Memory Allocated: 9.451701641082764  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4510498046875 GB
    Memory Allocated: 9.45860242843628  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.4510498046875 GB
    Memory Allocated: 9.459019184112549  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4510498046875 GB
    Memory Allocated: 9.459019184112549  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 11.4510498046875 GB
    Memory Allocated: 9.459063053131104  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4588623046875 GB
    Memory Allocated: 9.465248584747314  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.4588623046875 GB
    Memory Allocated: 9.465832233428955  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4588623046875 GB
    Memory Allocated: 9.465832233428955  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 11.4588623046875 GB
    Memory Allocated: 9.46588945388794  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4666748046875 GB
    Memory Allocated: 9.474358081817627  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.4686279296875 GB
    Memory Allocated: 9.475090980529785  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4686279296875 GB
    Memory Allocated: 9.475090980529785  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 11.4686279296875 GB
    Memory Allocated: 9.475159645080566  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4783935546875 GB
    Memory Allocated: 9.48580265045166  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.4783935546875 GB
    Memory Allocated: 9.486409664154053  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4783935546875 GB
    Memory Allocated: 9.486409664154053  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 11.4783935546875 GB
    Memory Allocated: 9.486464977264404  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4881591796875 GB
    Memory Allocated: 9.495425701141357  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([34, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.4901123046875 GB
    Memory Allocated: 9.496182441711426  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.4901123046875 GB
    Memory Allocated: 9.496182441711426  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 11.4901123046875 GB
    Memory Allocated: 9.496247291564941  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4998779296875 GB
    Memory Allocated: 9.507206916809082  GigaBytes
Max Memory Allocated: 9.649809837341309  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([19614, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.9686279296875 GB
    Memory Allocated: 9.978462219238281  GigaBytes
Max Memory Allocated: 9.980288982391357  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.9686279296875 GB
    Memory Allocated: 9.978462219238281  GigaBytes
Max Memory Allocated: 9.980288982391357  GigaBytes

 h.shape torch.Size([1, 19614, 256]), torch.Size([1, 19614, 256])
----------------------------------------3
 Nvidia-smi: 11.9686279296875 GB
    Memory Allocated: 10.017524719238281  GigaBytes
Max Memory Allocated: 10.017524719238281  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.4764404296875 GB
    Memory Allocated: 16.638625621795654  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 19614, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.4764404296875 GB
    Memory Allocated: 16.160836219787598  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.4764404296875 GB
    Memory Allocated: 16.164380073547363  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.4764404296875 GB
    Memory Allocated: 16.16792392730713  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.4764404296875 GB
    Memory Allocated: 16.164228916168213  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

torch.Size([20238, 47])
input nodes number: 149441
output nodes number: 20238
edges number: 499152
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4764404296875 GB
    Memory Allocated: 16.169039726257324  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.4764404296875 GB
    Memory Allocated: 16.16904067993164  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.4393310546875 GB
    Memory Allocated: 0.19445276260375977  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

pseudo mini batch 1 input nodes size: 368896
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.4393310546875 GB
    Memory Allocated: 0.15331411361694336  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.4393310546875 GB
    Memory Allocated: 0.15331411361694336  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.4393310546875 GB
    Memory Allocated: 0.290738582611084  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 19.4393310546875 GB
    Memory Allocated: 0.29088926315307617  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.4393310546875 GB
    Memory Allocated: 0.14620685577392578  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.4393310546875 GB
    Memory Allocated: 0.16245269775390625  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.4393310546875 GB
    Memory Allocated: 0.16245269775390625  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

first layer input nodes number: 368896
first layer output nodes number: 150351
edges number: 1478306
----------------------------------------before model layer 0
 Nvidia-smi: 19.4393310546875 GB
    Memory Allocated: 0.1663217544555664  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

torch.Size([368896, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.4393310546875 GB
    Memory Allocated: 0.1663217544555664  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

m.shape torch.Size([260, 1, 100])
----------------------------------------1
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.7331962585449219  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.7331962585449219  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 260, 100]), torch.Size([1, 260, 100])
----------------------------------------3
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.7333908081054688  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.7349429130554199  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 260, 100])
m.shape torch.Size([403, 2, 100])
----------------------------------------1
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.7351460456848145  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.7351460456848145  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 403, 100]), torch.Size([1, 403, 100])
----------------------------------------3
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.7354464530944824  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.739952564239502  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 403, 100])
m.shape torch.Size([475, 3, 100])
----------------------------------------1
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.7403335571289062  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.7403335571289062  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 475, 100]), torch.Size([1, 475, 100])
----------------------------------------3
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.7406883239746094  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.7484803199768066  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 475, 100])
m.shape torch.Size([650, 4, 100])
----------------------------------------1
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.7492718696594238  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.7492718696594238  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 650, 100]), torch.Size([1, 650, 100])
----------------------------------------3
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.7497563362121582  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.7638058662414551  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 650, 100])
m.shape torch.Size([767, 5, 100])
----------------------------------------1
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.7649927139282227  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.7649927139282227  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 767, 100]), torch.Size([1, 767, 100])
----------------------------------------3
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.7655649185180664  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.7863235473632812  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 767, 100])
m.shape torch.Size([764, 6, 100])
----------------------------------------1
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.787745475769043  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.787745475769043  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 764, 100]), torch.Size([1, 764, 100])
----------------------------------------3
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.7883148193359375  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.813509464263916  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 764, 100])
m.shape torch.Size([864, 7, 100])
----------------------------------------1
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.8154778480529785  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.8154778480529785  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 864, 100]), torch.Size([1, 864, 100])
----------------------------------------3
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.8161215782165527  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.849268913269043  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 864, 100])
m.shape torch.Size([962, 8, 100])
----------------------------------------1
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.8518142700195312  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.8518142700195312  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 962, 100]), torch.Size([1, 962, 100])
----------------------------------------3
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.8525314331054688  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.894289493560791  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 962, 100])
m.shape torch.Size([1008, 9, 100])
----------------------------------------1
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.897310733795166  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.897310733795166  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 1008, 100]), torch.Size([1, 1008, 100])
----------------------------------------3
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.8980622291564941  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 0.9461369514465332  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 1008, 100])
m.shape torch.Size([144198, 10, 100])
----------------------------------------1
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 1.482940673828125  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 1.482940673828125  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 144198, 100]), torch.Size([1, 144198, 100])
----------------------------------------3
 Nvidia-smi: 19.9901123046875 GB
    Memory Allocated: 1.590376853942871  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.8651123046875 GB
    Memory Allocated: 9.218331336975098  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 144198, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.8651123046875 GB
    Memory Allocated: 8.667032241821289  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.8651123046875 GB
    Memory Allocated: 8.810418128967285  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.8651123046875 GB
    Memory Allocated: 8.953804016113281  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.8651123046875 GB
    Memory Allocated: 8.810418128967285  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

torch.Size([150351, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.8651123046875 GB
    Memory Allocated: 8.953804016113281  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.8651123046875 GB
    Memory Allocated: 8.98965072631836  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.8651123046875 GB
    Memory Allocated: 8.98965072631836  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

m.shape torch.Size([45, 1, 256])
----------------------------------------1
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.467842102050781  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.467842102050781  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.467927932739258  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.46861457824707  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([32, 2, 256])
----------------------------------------1
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.46863317489624  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.46863317489624  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.46869421005249  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.46960973739624  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([22, 3, 256])
----------------------------------------1
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.469643115997314  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.469643115997314  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.469685077667236  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.470608234405518  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([40, 4, 256])
----------------------------------------1
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.470741271972656  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.470741271972656  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.470817565917969  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.473030090332031  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([18, 5, 256])
----------------------------------------1
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.473078727722168  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.473078727722168  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.473113059997559  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.474349021911621  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([29, 6, 256])
----------------------------------------1
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.474499225616455  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.474499225616455  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 12.3397216796875 GB
    Memory Allocated: 9.474554538726807  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3416748046875 GB
    Memory Allocated: 9.476933002471924  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([20, 7, 256])
----------------------------------------1
 Nvidia-smi: 12.3416748046875 GB
    Memory Allocated: 9.47704029083252  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3416748046875 GB
    Memory Allocated: 9.47704029083252  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 12.3416748046875 GB
    Memory Allocated: 9.477078437805176  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3436279296875 GB
    Memory Allocated: 9.478985786437988  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([32, 8, 256])
----------------------------------------1
 Nvidia-smi: 12.3436279296875 GB
    Memory Allocated: 9.479212760925293  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3436279296875 GB
    Memory Allocated: 9.479212760925293  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 12.3436279296875 GB
    Memory Allocated: 9.479273796081543  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3475341796875 GB
    Memory Allocated: 9.482752799987793  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([38, 9, 256])
----------------------------------------1
 Nvidia-smi: 12.3475341796875 GB
    Memory Allocated: 9.483051300048828  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3475341796875 GB
    Memory Allocated: 9.483051300048828  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 12.3475341796875 GB
    Memory Allocated: 9.483123779296875  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3514404296875 GB
    Memory Allocated: 9.487762451171875  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([21, 10, 256])
----------------------------------------1
 Nvidia-smi: 12.3514404296875 GB
    Memory Allocated: 9.48792839050293  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3514404296875 GB
    Memory Allocated: 9.48792839050293  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 12.3514404296875 GB
    Memory Allocated: 9.487968444824219  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 9.490812301635742  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 11, 256])
----------------------------------------1
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 9.49100399017334  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 9.49100399017334  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 12.3553466796875 GB
    Memory Allocated: 9.491042137145996  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3572998046875 GB
    Memory Allocated: 9.494017601013184  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 12, 256])
----------------------------------------1
 Nvidia-smi: 12.3572998046875 GB
    Memory Allocated: 9.494206428527832  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3572998046875 GB
    Memory Allocated: 9.494206428527832  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 12.3572998046875 GB
    Memory Allocated: 9.494240760803223  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3612060546875 GB
    Memory Allocated: 9.497159004211426  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 13, 256])
----------------------------------------1
 Nvidia-smi: 12.3612060546875 GB
    Memory Allocated: 9.4974045753479  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3612060546875 GB
    Memory Allocated: 9.4974045753479  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 12.3612060546875 GB
    Memory Allocated: 9.49744462966919  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3651123046875 GB
    Memory Allocated: 9.501129627227783  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([28, 14, 256])
----------------------------------------1
 Nvidia-smi: 12.3651123046875 GB
    Memory Allocated: 9.501486778259277  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3651123046875 GB
    Memory Allocated: 9.501486778259277  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 12.3651123046875 GB
    Memory Allocated: 9.501540184020996  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3709716796875 GB
    Memory Allocated: 9.506827354431152  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([29, 15, 256])
----------------------------------------1
 Nvidia-smi: 12.3709716796875 GB
    Memory Allocated: 9.507218837738037  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3709716796875 GB
    Memory Allocated: 9.507218837738037  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 12.3709716796875 GB
    Memory Allocated: 9.507274150848389  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3768310546875 GB
    Memory Allocated: 9.513137340545654  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([19, 16, 256])
----------------------------------------1
 Nvidia-smi: 12.3768310546875 GB
    Memory Allocated: 9.513401985168457  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3768310546875 GB
    Memory Allocated: 9.513401985168457  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 12.3768310546875 GB
    Memory Allocated: 9.51343822479248  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3826904296875 GB
    Memory Allocated: 9.517533302307129  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 12.3826904296875 GB
    Memory Allocated: 9.517809391021729  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3826904296875 GB
    Memory Allocated: 9.517809391021729  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 12.3826904296875 GB
    Memory Allocated: 9.51784372329712  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3865966796875 GB
    Memory Allocated: 9.521963596343994  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 12.3865966796875 GB
    Memory Allocated: 9.522379398345947  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3865966796875 GB
    Memory Allocated: 9.522379398345947  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 12.3865966796875 GB
    Memory Allocated: 9.522427082061768  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3924560546875 GB
    Memory Allocated: 9.528482913970947  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 12.3944091796875 GB
    Memory Allocated: 9.528934001922607  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3944091796875 GB
    Memory Allocated: 9.528934001922607  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 12.3944091796875 GB
    Memory Allocated: 9.52898359298706  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.4002685546875 GB
    Memory Allocated: 9.53562879562378  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([34, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.4002685546875 GB
    Memory Allocated: 9.53625774383545  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.4002685546875 GB
    Memory Allocated: 9.53625774383545  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 12.4002685546875 GB
    Memory Allocated: 9.536322593688965  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.4100341796875 GB
    Memory Allocated: 9.545466423034668  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.4100341796875 GB
    Memory Allocated: 9.545918464660645  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.4100341796875 GB
    Memory Allocated: 9.545918464660645  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 12.4100341796875 GB
    Memory Allocated: 9.545964241027832  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.4178466796875 GB
    Memory Allocated: 9.552739143371582  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.4178466796875 GB
    Memory Allocated: 9.553287506103516  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.4178466796875 GB
    Memory Allocated: 9.553287506103516  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 12.4178466796875 GB
    Memory Allocated: 9.553339004516602  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.4256591796875 GB
    Memory Allocated: 9.561321258544922  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.4256591796875 GB
    Memory Allocated: 9.561693668365479  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.4256591796875 GB
    Memory Allocated: 9.561693668365479  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 12.4256591796875 GB
    Memory Allocated: 9.56172800064087  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.4315185546875 GB
    Memory Allocated: 9.56728982925415  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.4334716796875 GB
    Memory Allocated: 9.567965030670166  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.4334716796875 GB
    Memory Allocated: 9.567965030670166  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 12.4334716796875 GB
    Memory Allocated: 9.56802225112915  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.4432373046875 GB
    Memory Allocated: 9.57769250869751  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([19559, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.9100341796875 GB
    Memory Allocated: 10.048104286193848  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.9100341796875 GB
    Memory Allocated: 10.048104286193848  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

 h.shape torch.Size([1, 19559, 256]), torch.Size([1, 19559, 256])
----------------------------------------3
 Nvidia-smi: 12.9100341796875 GB
    Memory Allocated: 10.085410118103027  GigaBytes
Max Memory Allocated: 17.10625982284546  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.6561279296875 GB
    Memory Allocated: 16.65919303894043  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 19559, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.6561279296875 GB
    Memory Allocated: 16.184393405914307  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.6561279296875 GB
    Memory Allocated: 16.188194274902344  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.6561279296875 GB
    Memory Allocated: 16.19199514389038  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.6561279296875 GB
    Memory Allocated: 16.18804359436035  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

torch.Size([20193, 47])
input nodes number: 150351
output nodes number: 20193
edges number: 496524
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.6561279296875 GB
    Memory Allocated: 16.18959331512451  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.6561279296875 GB
    Memory Allocated: 16.18959379196167  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.18827438354492188  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

pseudo mini batch 2 input nodes size: 276972
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.14646387100219727  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.14646387100219727  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.24964427947998047  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.2497868537902832  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.11221170425415039  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.1244816780090332  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.1244816780090332  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

first layer input nodes number: 276972
first layer output nodes number: 124062
edges number: 1194645
----------------------------------------before model layer 0
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.1274700164794922  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

torch.Size([276972, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.1274700164794922  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

m.shape torch.Size([323, 1, 100])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.5852398872375488  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.5852398872375488  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 323, 100]), torch.Size([1, 323, 100])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.5854811668395996  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.5874085426330566  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 323, 100])
m.shape torch.Size([646, 2, 100])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.5877695083618164  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.5877695083618164  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 646, 100]), torch.Size([1, 646, 100])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.5882511138916016  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.5954723358154297  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 646, 100])
m.shape torch.Size([812, 3, 100])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.5961394309997559  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.5961394309997559  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 812, 100]), torch.Size([1, 812, 100])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.5967450141906738  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.6112871170043945  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 812, 100])
m.shape torch.Size([1135, 4, 100])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.612675666809082  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.612675666809082  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1135, 100]), torch.Size([1, 1135, 100])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.6135215759277344  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.6380472183227539  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1135, 100])
m.shape torch.Size([1428, 5, 100])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.640284538269043  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.640284538269043  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1428, 100]), torch.Size([1, 1428, 100])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.6413488388061523  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.6801462173461914  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1428, 100])
m.shape torch.Size([1684, 6, 100])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.6842484474182129  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.6842484474182129  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1684, 100]), torch.Size([1, 1684, 100])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.6855034828186035  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.7394614219665527  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1684, 100])
m.shape torch.Size([1856, 7, 100])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.7436738014221191  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.7436738014221191  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1856, 100]), torch.Size([1, 1856, 100])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.7450566291809082  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.8145413398742676  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1856, 100])
m.shape torch.Size([1988, 8, 100])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.8197746276855469  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.8197746276855469  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1988, 100]), torch.Size([1, 1988, 100])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.8212566375732422  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.9056968688964844  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1988, 100])
m.shape torch.Size([1986, 9, 100])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.9116148948669434  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.9116148948669434  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1986, 100]), torch.Size([1, 1986, 100])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 0.9130949974060059  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 1.0078086853027344  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1986, 100])
m.shape torch.Size([112204, 10, 100])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 1.4250612258911133  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 1.4250612258911133  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 112204, 100]), torch.Size([1, 112204, 100])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 1.5086603164672852  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.444167137145996  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 112204, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.001222133636475  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.119536876678467  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.237851619720459  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.119536876678467  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

torch.Size([124062, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.237851619720459  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.267806529998779  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.267806529998779  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

m.shape torch.Size([34, 1, 256])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.703176498413086  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.703176498413086  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.703241348266602  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.703760147094727  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([56, 2, 256])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.703835487365723  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.703835487365723  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.70394229888916  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.705544471740723  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([58, 3, 256])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.705658435821533  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.705658435821533  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.705769062042236  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.708202838897705  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([90, 4, 256])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.708493709564209  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.708493709564209  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.708665370941162  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.713643550872803  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([85, 5, 256])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.713966369628906  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.713966369628906  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.714128494262695  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.719964981079102  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([99, 6, 256])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.720455169677734  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.720455169677734  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.720643997192383  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.728763580322266  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([102, 7, 256])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.729355812072754  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.729355812072754  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.729550361633301  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.7392778396606445  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([116, 8, 256])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.740072727203369  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.740072727203369  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.740293979644775  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.752905368804932  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([93, 9, 256])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.753599643707275  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.753599643707275  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.753777027130127  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.765129566192627  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([99, 10, 256])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.765992641448975  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.765992641448975  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.766181468963623  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.779588222503662  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([96, 11, 256])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.780529499053955  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.780529499053955  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.780712604522705  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.794994831085205  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([82, 12, 256])
----------------------------------------1
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.795849323272705  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.795849323272705  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 19.6072998046875 GB
    Memory Allocated: 7.796005725860596  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6209716796875 GB
    Memory Allocated: 7.809299945831299  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([105, 13, 256])
----------------------------------------1
 Nvidia-smi: 19.6209716796875 GB
    Memory Allocated: 7.810638904571533  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6209716796875 GB
    Memory Allocated: 7.810638904571533  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 19.6209716796875 GB
    Memory Allocated: 7.8108391761779785  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6385498046875 GB
    Memory Allocated: 7.829264163970947  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([93, 14, 256])
----------------------------------------1
 Nvidia-smi: 19.6385498046875 GB
    Memory Allocated: 7.830929756164551  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6385498046875 GB
    Memory Allocated: 7.830929756164551  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 19.6385498046875 GB
    Memory Allocated: 7.831107139587402  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6561279296875 GB
    Memory Allocated: 7.848668098449707  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([101, 15, 256])
----------------------------------------1
 Nvidia-smi: 19.6561279296875 GB
    Memory Allocated: 7.85034704208374  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6561279296875 GB
    Memory Allocated: 7.85034704208374  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 19.6561279296875 GB
    Memory Allocated: 7.850539684295654  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6776123046875 GB
    Memory Allocated: 7.870959758758545  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([88, 16, 256])
----------------------------------------1
 Nvidia-smi: 19.6776123046875 GB
    Memory Allocated: 7.872646808624268  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6776123046875 GB
    Memory Allocated: 7.872646808624268  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 19.6776123046875 GB
    Memory Allocated: 7.872814655303955  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.6951904296875 GB
    Memory Allocated: 7.891781330108643  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([111, 17, 256])
----------------------------------------1
 Nvidia-smi: 19.6951904296875 GB
    Memory Allocated: 7.893599033355713  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.6951904296875 GB
    Memory Allocated: 7.893599033355713  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 19.6971435546875 GB
    Memory Allocated: 7.893810749053955  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 7.919216632843018  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([91, 18, 256])
----------------------------------------1
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 7.920896053314209  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 7.920896053314209  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 19.7225341796875 GB
    Memory Allocated: 7.921069622039795  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 7.943112850189209  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([106, 19, 256])
----------------------------------------1
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 7.944982051849365  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 7.944982051849365  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 19.7459716796875 GB
    Memory Allocated: 7.945184230804443  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.7733154296875 GB
    Memory Allocated: 7.972276210784912  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([79, 20, 256])
----------------------------------------1
 Nvidia-smi: 19.7733154296875 GB
    Memory Allocated: 7.973959922790527  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.7733154296875 GB
    Memory Allocated: 7.973959922790527  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 19.7733154296875 GB
    Memory Allocated: 7.9741106033325195  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.7947998046875 GB
    Memory Allocated: 7.995356559753418  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([86, 21, 256])
----------------------------------------1
 Nvidia-smi: 19.7947998046875 GB
    Memory Allocated: 7.997259140014648  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.7947998046875 GB
    Memory Allocated: 7.997259140014648  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 19.7947998046875 GB
    Memory Allocated: 7.99742317199707  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8201904296875 GB
    Memory Allocated: 8.021699905395508  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([89, 22, 256])
----------------------------------------1
 Nvidia-smi: 19.8201904296875 GB
    Memory Allocated: 8.02359676361084  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8201904296875 GB
    Memory Allocated: 8.02359676361084  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 19.8201904296875 GB
    Memory Allocated: 8.02376651763916  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8455810546875 GB
    Memory Allocated: 8.050078392028809  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([86, 23, 256])
----------------------------------------1
 Nvidia-smi: 19.8455810546875 GB
    Memory Allocated: 8.051982402801514  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8455810546875 GB
    Memory Allocated: 8.051982402801514  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 19.8455810546875 GB
    Memory Allocated: 8.052146434783936  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8729248046875 GB
    Memory Allocated: 8.07871961593628  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([96, 24, 256])
----------------------------------------1
 Nvidia-smi: 19.8729248046875 GB
    Memory Allocated: 8.081592082977295  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8729248046875 GB
    Memory Allocated: 8.081592082977295  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 19.8729248046875 GB
    Memory Allocated: 8.081775188446045  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9041748046875 GB
    Memory Allocated: 8.112720012664795  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([16963, 25, 256])
----------------------------------------1
 Nvidia-smi: 19.9041748046875 GB
    Memory Allocated: 8.520217895507812  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9041748046875 GB
    Memory Allocated: 8.520217895507812  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 16963, 256]), torch.Size([1, 16963, 256])
----------------------------------------3
 Nvidia-smi: 19.9041748046875 GB
    Memory Allocated: 8.552572250366211  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9041748046875 GB
    Memory Allocated: 14.247314929962158  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 16963, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 19.9041748046875 GB
    Memory Allocated: 13.817511558532715  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 19.9041748046875 GB
    Memory Allocated: 13.82085657119751  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 19.9041748046875 GB
    Memory Allocated: 13.824201583862305  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 19.9041748046875 GB
    Memory Allocated: 13.820713996887207  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

torch.Size([19104, 47])
input nodes number: 124062
output nodes number: 19104
edges number: 452038
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9061279296875 GB
    Memory Allocated: 13.822059631347656  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.9061279296875 GB
    Memory Allocated: 13.822060108184814  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.1457371711730957  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

pseudo mini batch 3 input nodes size: 376609
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.11249017715454102  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.11249017715454102  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.25278806686401367  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.25293827056884766  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.14961528778076172  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.1649456024169922  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.1649456024169922  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

first layer input nodes number: 376609
first layer output nodes number: 154517
edges number: 1473619
----------------------------------------before model layer 0
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.16890335083007812  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

torch.Size([376609, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.16890335083007812  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

m.shape torch.Size([661, 1, 100])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.7337102890014648  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.7337102890014648  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 661, 100]), torch.Size([1, 661, 100])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.7342033386230469  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.7391057014465332  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 661, 100])
m.shape torch.Size([1090, 2, 100])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.7396717071533203  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.7396717071533203  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1090, 100]), torch.Size([1, 1090, 100])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.7404842376708984  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.7530980110168457  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1090, 100])
m.shape torch.Size([1494, 3, 100])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.754361629486084  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.754361629486084  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1494, 100]), torch.Size([1, 1494, 100])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.7554755210876465  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.7806205749511719  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1494, 100])
m.shape torch.Size([1860, 4, 100])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.7828354835510254  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.7828354835510254  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1860, 100]), torch.Size([1, 1860, 100])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.7842221260070801  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.8245458602905273  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1860, 100])
m.shape torch.Size([2186, 5, 100])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.8279247283935547  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.8279247283935547  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 2186, 100]), torch.Size([1, 2186, 100])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.8295536041259766  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.8881931304931641  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 2186, 100])
m.shape torch.Size([2385, 6, 100])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.8927097320556641  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.8927097320556641  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 2385, 100]), torch.Size([1, 2385, 100])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.8944873809814453  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.9714851379394531  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 2385, 100])
m.shape torch.Size([2424, 7, 100])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.9769177436828613  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.9769177436828613  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 2424, 100]), torch.Size([1, 2424, 100])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.9787240028381348  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 1.0690269470214844  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 2424, 100])
m.shape torch.Size([2531, 8, 100])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 1.075666904449463  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 1.075666904449463  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 2531, 100]), torch.Size([1, 2531, 100])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 1.0775532722473145  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 1.1863985061645508  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 2531, 100])
m.shape torch.Size([2460, 9, 100])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 1.1937031745910645  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 1.1937031745910645  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 2460, 100]), torch.Size([1, 2460, 100])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 1.1955361366271973  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 1.3128809928894043  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 2460, 100])
m.shape torch.Size([137426, 10, 100])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 1.8239164352416992  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 1.8239164352416992  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 137426, 100]), torch.Size([1, 137426, 100])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 1.9263076782226562  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.196043014526367  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 137426, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 8.650621891021729  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 8.797980785369873  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 8.945339679718018  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 8.797980785369873  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

torch.Size([154517, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 8.945339679718018  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 8.982179641723633  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 8.982179641723633  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

m.shape torch.Size([18, 1, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.449708938598633  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.449708938598633  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.449743270874023  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.450017929077148  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([29, 2, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.450056552886963  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.450056552886963  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.450111865997314  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.450941562652588  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([36, 3, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.4510178565979  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.4510178565979  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.451086521148682  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.45259714126587  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([41, 4, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.452720642089844  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.452720642089844  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.452798843383789  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.455066680908203  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([51, 5, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.455272674560547  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.455272674560547  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.45536994934082  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.458871841430664  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([66, 6, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.459204196929932  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.459204196929932  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.459330081939697  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.46474313735962  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([63, 7, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.465104103088379  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.465104103088379  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.465224266052246  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.471232414245605  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([65, 8, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.471672534942627  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.471672534942627  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.47179651260376  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.47886323928833  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([68, 9, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.479389667510986  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.479389667510986  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.479519367218018  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.487820148468018  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([80, 10, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.488524436950684  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.488524436950684  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.488677024841309  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.499510765075684  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([73, 11, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.500206470489502  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.500206470489502  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.500345706939697  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.511206150054932  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([60, 12, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.511828899383545  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.511828899383545  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.511943340301514  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.521670818328857  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([101, 13, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.522934913635254  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.522934913635254  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.523127555847168  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.540850639343262  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([95, 14, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.542235374450684  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.542235374450684  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.5424165725708  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.560355186462402  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([70, 15, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.56174373626709  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.56174373626709  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.561877250671387  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.576029777526855  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([87, 16, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.577444553375244  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.577444553375244  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.577610492706299  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.596361637115479  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([83, 17, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.59804916381836  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.59804916381836  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.598207473754883  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.617204666137695  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([71, 18, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.618894577026367  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.618894577026367  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.619029998779297  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.636228561401367  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([77, 19, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.63793134689331  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.63793134689331  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.638078212738037  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.657758235931396  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([75, 20, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.65912675857544  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.65912675857544  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.6592698097229  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.679440021514893  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([82, 21, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.681023597717285  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.681023597717285  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.681180000305176  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.704327583312988  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([77, 22, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.705877780914307  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.705877780914307  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.706024646759033  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.72878885269165  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([99, 23, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.73090410232544  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.73090410232544  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.731092929840088  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.761682987213135  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([81, 24, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.763457298278809  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.763457298278809  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.763611793518066  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 9.789721488952637  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([18458, 25, 256])
----------------------------------------1
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 10.233155727386475  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 10.233155727386475  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 18458, 256]), torch.Size([1, 18458, 256])
----------------------------------------3
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 10.268361568450928  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 16.464589595794678  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 18458, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 16.003501415252686  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 16.007112979888916  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 16.01063346862793  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 16.006871700286865  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

torch.Size([20106, 47])
input nodes number: 154517
output nodes number: 20106
edges number: 484719
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 16.00782585144043  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 16.007826328277588  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.19077777862548828  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

pseudo mini batch 4 input nodes size: 397827
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.14914751052856445  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.14914751052856445  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.2973499298095703  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.29749298095703125  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.1570448875427246  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.1729130744934082  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.1729130744934082  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

first layer input nodes number: 397827
first layer output nodes number: 153548
edges number: 1481400
----------------------------------------before model layer 0
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.17702198028564453  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

torch.Size([397827, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.9100341796875 GB
    Memory Allocated: 0.17702198028564453  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

m.shape torch.Size([514, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.745941162109375  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.745941162109375  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 514, 100]), torch.Size([1, 514, 100])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.7463245391845703  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.7493901252746582  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 514, 100])
m.shape torch.Size([772, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.7497739791870117  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.7497739791870117  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 772, 100]), torch.Size([1, 772, 100])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.7503499984741211  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.7589817047119141  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 772, 100])
m.shape torch.Size([1117, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.7599420547485352  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.7599420547485352  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1117, 100]), torch.Size([1, 1117, 100])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.7607746124267578  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.7800436019897461  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1117, 100])
m.shape torch.Size([1383, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.7816882133483887  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.7816882133483887  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1383, 100]), torch.Size([1, 1383, 100])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.7827191352844238  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.8126358985900879  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1383, 100])
m.shape torch.Size([1684, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.8152575492858887  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.8152575492858887  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1684, 100]), torch.Size([1, 1684, 100])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.8165125846862793  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.8616867065429688  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1684, 100])
m.shape torch.Size([1799, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.8650803565979004  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.8650803565979004  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1799, 100]), torch.Size([1, 1799, 100])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.8664212226867676  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.9255928993225098  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1799, 100])
m.shape torch.Size([1924, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.9299397468566895  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.9299397468566895  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1924, 100]), torch.Size([1, 1924, 100])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.9313740730285645  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 1.0036110877990723  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1924, 100])
m.shape torch.Size([1937, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 1.0086669921875  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 1.0086669921875  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1937, 100]), torch.Size([1, 1937, 100])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 1.010110855102539  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 1.0923881530761719  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1937, 100])
m.shape torch.Size([1899, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 1.0980334281921387  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 1.0980334281921387  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1899, 100]), torch.Size([1, 1899, 100])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 1.0994486808776855  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 1.190011978149414  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1899, 100])
m.shape torch.Size([140519, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 1.7127785682678223  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 1.7127785682678223  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 140519, 100]), torch.Size([1, 140519, 100])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 1.8174738883972168  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.250813007354736  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 140519, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 8.700060367584229  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 8.846495151519775  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 8.992929935455322  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 8.846495151519775  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

torch.Size([153548, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 8.992929935455322  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.030188083648682  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.030188083648682  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

m.shape torch.Size([22, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.475163459777832  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.475163459777832  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.475205421447754  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.475541114807129  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([29, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.475575923919678  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.475575923919678  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.47563123703003  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.476460933685303  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([37, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.476540088653564  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.476540088653564  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.476610660552979  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.478163242340088  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([51, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.47832441329956  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.47832441329956  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.478421688079834  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.481242656707764  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([61, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.481487274169922  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.481487274169922  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.481603622436523  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.48579216003418  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([64, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.486103057861328  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.486103057861328  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.486225128173828  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.491474151611328  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([75, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.491918087005615  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.491918087005615  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.492061138153076  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.499213695526123  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([57, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.49958086013794  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.49958086013794  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.49968957901001  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.505886554718018  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([49, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.506256103515625  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.506256103515625  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.506349563598633  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.512331008911133  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([62, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.512880325317383  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.512880325317383  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.512998580932617  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.521394729614258  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([79, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.522171020507812  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.522171020507812  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.522321701049805  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.534074783325195  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([73, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.534841537475586  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.534841537475586  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.534980773925781  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.546815872192383  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([72, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.547646045684814  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.547646045684814  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.547783374786377  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.560417652130127  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([64, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.56121015548706  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.56121015548706  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.56133222579956  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.57341718673706  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([64, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.574278831481934  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.574278831481934  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.574400901794434  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.587340354919434  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([68, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.588334560394287  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.588334560394287  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.588464260101318  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.60312032699585  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([64, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.604110717773438  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.604110717773438  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.604232788085938  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.618881225585938  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.620376586914062  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.620376586914062  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.620498657226562  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.636001586914062  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([67, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.637743949890137  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.637743949890137  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.637871742248535  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.654995918273926  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([69, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.656906604766846  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.656906604766846  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.65703821182251  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.675594806671143  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([65, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.67775011062622  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.67775011062622  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.677874088287354  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.69622278213501  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([77, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.698384284973145  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.698384284973145  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.698531150817871  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.721295356750488  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([76, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.723445892333984  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.723445892333984  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.723590850830078  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.747074127197266  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([62, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.749224185943604  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.749224185943604  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.749342441558838  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 9.769327640533447  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([17687, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 10.194441795349121  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 10.194441795349121  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 17687, 256]), torch.Size([1, 17687, 256])
----------------------------------------3
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 10.228177070617676  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 16.1655855178833  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 17687, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 15.725907802581787  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 15.729390144348145  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 15.733259677886963  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 15.729634284973145  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

torch.Size([19158, 47])
input nodes number: 153548
output nodes number: 19158
edges number: 462114
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 15.731750965118408  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 15.731751441955566  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.1990351676940918  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

pseudo mini batch 5 input nodes size: 477580
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.15691566467285156  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.15691566467285156  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.33482837677001953  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.33497142791748047  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.18662595748901367  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.2017664909362793  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.2017664909362793  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

first layer input nodes number: 477580
first layer output nodes number: 156069
edges number: 1515141
----------------------------------------before model layer 0
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.20648813247680664  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

torch.Size([477580, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.4627685546875 GB
    Memory Allocated: 0.20648813247680664  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

m.shape torch.Size([195, 1, 100])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.787238597869873  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.787238597869873  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 195, 100]), torch.Size([1, 195, 100])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.7873845100402832  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.7885489463806152  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 195, 100])
m.shape torch.Size([338, 2, 100])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.7887282371520996  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.7887282371520996  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 338, 100]), torch.Size([1, 338, 100])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.7889809608459473  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.7927632331848145  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 338, 100])
m.shape torch.Size([709, 3, 100])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.7934293746948242  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.7934293746948242  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 709, 100]), torch.Size([1, 709, 100])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.7939577102661133  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.8065323829650879  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 709, 100])
m.shape torch.Size([1243, 4, 100])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.8081207275390625  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.8081207275390625  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1243, 100]), torch.Size([1, 1243, 100])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.8090476989746094  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.8359127044677734  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1243, 100])
m.shape torch.Size([1634, 5, 100])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.8384928703308105  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.8384928703308105  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1634, 100]), torch.Size([1, 1634, 100])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.8397107124328613  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.8835954666137695  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1634, 100])
m.shape torch.Size([1863, 6, 100])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.887150764465332  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.887150764465332  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1863, 100]), torch.Size([1, 1863, 100])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.8885393142700195  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.9485001564025879  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1863, 100])
m.shape torch.Size([2126, 7, 100])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.9533500671386719  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.9533500671386719  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 2126, 100]), torch.Size([1, 2126, 100])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 0.9549341201782227  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 1.0357046127319336  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 2126, 100])
m.shape torch.Size([2205, 8, 100])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 1.0414843559265137  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 1.0414843559265137  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 2205, 100]), torch.Size([1, 2205, 100])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 1.0431275367736816  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 1.136777400970459  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 2205, 100])
m.shape torch.Size([2259, 9, 100])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 1.1435298919677734  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 1.1435298919677734  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 2259, 100]), torch.Size([1, 2259, 100])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 1.1452131271362305  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 1.2529401779174805  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 2259, 100])
m.shape torch.Size([143497, 10, 100])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 1.7866668701171875  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 1.7866668701171875  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 143497, 100]), torch.Size([1, 143497, 100])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 1.8935813903808594  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.484469413757324  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 143497, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 8.922115802764893  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.0709547996521  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.219793796539307  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.0709547996521  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

torch.Size([156069, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.219793796539307  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.257003784179688  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.257003784179688  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

m.shape torch.Size([13, 1, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.69939374923706  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.69939374923706  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.699418544769287  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.6996169090271  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.699620246887207  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.699620246887207  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.69963550567627  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.699864387512207  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([22, 3, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.699920654296875  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.699920654296875  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.699962615966797  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.700885772705078  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([31, 4, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.700984001159668  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.700984001159668  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.701043128967285  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.702757835388184  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([40, 5, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.702920913696289  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.702920913696289  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.702997207641602  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.705743789672852  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([49, 6, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.70598840713501  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.70598840713501  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.706081867218018  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.710100650787354  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([77, 7, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.710572242736816  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.710572242736816  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.710719108581543  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.718062400817871  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([58, 8, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.718435287475586  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.718435287475586  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.718545913696289  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.724851608276367  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([81, 9, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.725497245788574  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.725497245788574  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.725651741027832  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.735539436340332  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([130, 10, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.736814975738525  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.736814975738525  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.737062931060791  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.75466775894165  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([116, 11, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.756572246551514  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.756572246551514  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.75679349899292  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.774051189422607  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([105, 12, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.77604866027832  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.77604866027832  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.776248931884766  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.793272018432617  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([94, 13, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.794346809387207  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.794346809387207  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.794526100158691  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.811020851135254  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([107, 14, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.81247615814209  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.81247615814209  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.8126802444458  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.832884788513184  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([116, 15, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.834455490112305  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.834455490112305  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.834676742553711  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.858129501342773  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([119, 16, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.859848976135254  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.859848976135254  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.860075950622559  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.885724067687988  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([108, 17, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.887375354766846  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.887375354766846  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.88758134841919  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.91230058670044  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([119, 18, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.915183067321777  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.915183067321777  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.915410041809082  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.944235801696777  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([106, 19, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.94605827331543  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.94605827331543  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.946260452270508  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.973352432250977  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([88, 20, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.974943161010742  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.974943161010742  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.97511100769043  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 9.998777389526367  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([109, 21, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 10.00167989730835  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 10.00167989730835  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 109, 256]), torch.Size([1, 109, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 10.001887798309326  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 10.032657146453857  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 109, 256])
m.shape torch.Size([114, 22, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 10.035541534423828  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 10.035541534423828  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 10.035758972167969  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 10.069461822509766  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([124, 23, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 10.072343826293945  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 10.072343826293945  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 10.072580337524414  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 10.110895156860352  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([86, 24, 256])
----------------------------------------1
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 10.1127610206604  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 10.1127610206604  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 21.0272216796875 GB
    Memory Allocated: 10.112925052642822  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0487060546875 GB
    Memory Allocated: 10.14064645767212  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([17163, 25, 256])
----------------------------------------1
 Nvidia-smi: 21.0487060546875 GB
    Memory Allocated: 10.552981853485107  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0487060546875 GB
    Memory Allocated: 10.552981853485107  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 17163, 256]), torch.Size([1, 17163, 256])
----------------------------------------3
 Nvidia-smi: 21.0487060546875 GB
    Memory Allocated: 10.585717678070068  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0487060546875 GB
    Memory Allocated: 16.347222805023193  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 17163, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.0487060546875 GB
    Memory Allocated: 15.910863399505615  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.0487060546875 GB
    Memory Allocated: 15.91443395614624  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 21.0487060546875 GB
    Memory Allocated: 15.917792797088623  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 21.0487060546875 GB
    Memory Allocated: 15.914079189300537  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

torch.Size([19183, 47])
input nodes number: 156069
output nodes number: 19183
edges number: 459185
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.0487060546875 GB
    Memory Allocated: 15.915528774261475  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.0487060546875 GB
    Memory Allocated: 15.915529251098633  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.2279658317565918  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

pseudo mini batch 6 input nodes size: 446300
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.18671417236328125  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.18671417236328125  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.35297393798828125  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.3531169891357422  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.17506122589111328  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.19002056121826172  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.19002056121826172  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

first layer input nodes number: 446300
first layer output nodes number: 148650
edges number: 1457844
----------------------------------------before model layer 0
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.19445371627807617  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

torch.Size([446300, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.19445371627807617  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

m.shape torch.Size([270, 1, 100])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.7529449462890625  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.7529449462890625  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 270, 100]), torch.Size([1, 270, 100])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.7531461715698242  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.754755973815918  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 270, 100])
m.shape torch.Size([399, 2, 100])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.7549529075622559  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.7549529075622559  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 399, 100]), torch.Size([1, 399, 100])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.7552504539489746  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.7597107887268066  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 399, 100])
m.shape torch.Size([651, 3, 100])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.7602896690368652  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.7602896690368652  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 651, 100]), torch.Size([1, 651, 100])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.760775089263916  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.7714500427246094  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 651, 100])
m.shape torch.Size([754, 4, 100])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.7730398178100586  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.7730398178100586  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 754, 100]), torch.Size([1, 754, 100])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.7736024856567383  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.7915129661560059  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 754, 100])
m.shape torch.Size([807, 5, 100])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.7927350997924805  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.7927350997924805  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 807, 100]), torch.Size([1, 807, 100])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.7933368682861328  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.8152899742126465  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 807, 100])
m.shape torch.Size([879, 6, 100])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.8169541358947754  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.8169541358947754  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 879, 100]), torch.Size([1, 879, 100])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.8176093101501465  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.8467402458190918  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 879, 100])
m.shape torch.Size([1093, 7, 100])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.8492631912231445  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.8492631912231445  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1093, 100]), torch.Size([1, 1093, 100])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.8500776290893555  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.8908047676086426  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1093, 100])
m.shape torch.Size([1023, 8, 100])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.8934464454650879  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.8934464454650879  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1023, 100]), torch.Size([1, 1023, 100])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.8942093849182129  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.9382586479187012  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1023, 100])
m.shape torch.Size([1077, 9, 100])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.9414882659912109  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.9414882659912109  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1077, 100]), torch.Size([1, 1077, 100])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.942291259765625  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 0.994713306427002  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1077, 100])
m.shape torch.Size([141697, 10, 100])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 1.52217435836792  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 1.52217435836792  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 141697, 100]), torch.Size([1, 141697, 100])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 1.6277470588684082  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.123408794403076  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 141697, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 8.580260753631592  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 8.72202444076538  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 8.86378812789917  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 8.72202444076538  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

torch.Size([148650, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 8.86378812789917  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 8.899229049682617  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 8.899229049682617  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

m.shape torch.Size([27, 1, 256])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.31846570968628  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.31846570968628  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.318517208099365  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.318929195404053  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([48, 2, 256])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.318995952606201  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.318995952606201  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.319087505340576  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.320460796356201  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([157, 3, 256])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.320868015289307  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.320868015289307  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.321167469024658  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.327755451202393  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([146, 4, 256])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.32816743850708  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.32816743850708  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.32844591140747  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.336521625518799  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([142, 5, 256])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.33706521987915  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.33706521987915  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.33733606338501  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.347086429595947  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([194, 6, 256])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.34807014465332  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.34807014465332  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.348440170288086  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.364351272583008  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([266, 7, 256])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.36595630645752  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.36595630645752  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 266, 256]), torch.Size([1, 266, 256])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.366463661193848  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.39427375793457  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 266, 256])
m.shape torch.Size([137, 8, 256])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.395073890686035  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.395073890686035  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.39533519744873  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.410229682922363  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([172, 9, 256])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.411587238311768  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.411587238311768  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.411915302276611  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.432911396026611  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([192, 10, 256])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.434592723846436  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.434592723846436  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 192, 256]), torch.Size([1, 192, 256])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.434958934783936  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.460959911346436  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 192, 256])
m.shape torch.Size([173, 11, 256])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.462605953216553  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.462605953216553  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.46293592453003  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.488673686981201  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([164, 12, 256])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.490400314331055  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.490400314331055  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.490713119506836  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.517301559448242  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([155, 13, 256])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.519120216369629  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.519120216369629  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 155, 256]), torch.Size([1, 155, 256])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.519415855407715  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.546614646911621  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 155, 256])
m.shape torch.Size([220, 14, 256])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.549427509307861  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.549427509307861  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 220, 256]), torch.Size([1, 220, 256])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.54984712600708  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.591389179229736  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 220, 256])
m.shape torch.Size([217, 15, 256])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.594307899475098  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.594307899475098  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.594721794128418  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.638594627380371  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([159, 16, 256])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.64095401763916  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.64095401763916  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.641257286071777  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.67552661895752  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([100, 17, 256])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.677009105682373  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.677009105682373  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.677199840545654  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.700088024139404  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([157, 18, 256])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.702709197998047  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.702709197998047  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.703008651733398  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.741039276123047  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([110, 19, 256])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.743861675262451  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.743861675262451  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.74407148361206  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.772185802459717  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([153, 20, 256])
----------------------------------------1
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.775022029876709  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.775022029876709  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 21.0526123046875 GB
    Memory Allocated: 9.77531385421753  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0584716796875 GB
    Memory Allocated: 9.816461086273193  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([138, 21, 256])
----------------------------------------1
 Nvidia-smi: 21.0584716796875 GB
    Memory Allocated: 9.819100856781006  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0584716796875 GB
    Memory Allocated: 9.819100856781006  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 21.0584716796875 GB
    Memory Allocated: 9.819364070892334  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0994873046875 GB
    Memory Allocated: 9.858319759368896  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([114, 22, 256])
----------------------------------------1
 Nvidia-smi: 21.0994873046875 GB
    Memory Allocated: 9.86094045639038  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0994873046875 GB
    Memory Allocated: 9.86094045639038  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 21.0994873046875 GB
    Memory Allocated: 9.861157894134521  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.1326904296875 GB
    Memory Allocated: 9.894860744476318  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([150, 23, 256])
----------------------------------------1
 Nvidia-smi: 21.1326904296875 GB
    Memory Allocated: 9.898067951202393  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.1326904296875 GB
    Memory Allocated: 9.898067951202393  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 21.1326904296875 GB
    Memory Allocated: 9.898354053497314  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.1815185546875 GB
    Memory Allocated: 9.944702625274658  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([186, 24, 256])
----------------------------------------1
 Nvidia-smi: 21.1815185546875 GB
    Memory Allocated: 9.948850154876709  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.1815185546875 GB
    Memory Allocated: 9.948850154876709  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 186, 256]), torch.Size([1, 186, 256])
----------------------------------------3
 Nvidia-smi: 21.1815185546875 GB
    Memory Allocated: 9.949204921722412  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.2518310546875 GB
    Memory Allocated: 10.00916051864624  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 186, 256])
m.shape torch.Size([15506, 25, 256])
----------------------------------------1
 Nvidia-smi: 21.2518310546875 GB
    Memory Allocated: 10.381563663482666  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.2518310546875 GB
    Memory Allocated: 10.381563663482666  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 15506, 256]), torch.Size([1, 15506, 256])
----------------------------------------3
 Nvidia-smi: 21.2518310546875 GB
    Memory Allocated: 10.411139011383057  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.2518310546875 GB
    Memory Allocated: 15.616400241851807  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 15506, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.2518310546875 GB
    Memory Allocated: 15.204786777496338  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.2518310546875 GB
    Memory Allocated: 15.20814561843872  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 21.2518310546875 GB
    Memory Allocated: 15.211504459381104  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 21.2518310546875 GB
    Memory Allocated: 15.20800256729126  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

torch.Size([19183, 47])
input nodes number: 148650
output nodes number: 19183
edges number: 434889
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2518310546875 GB
    Memory Allocated: 15.209170818328857  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.2518310546875 GB
    Memory Allocated: 15.209171295166016  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.2557373046875 GB
    Memory Allocated: 0.21542787551879883  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

pseudo mini batch 7 input nodes size: 482971
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.2557373046875 GB
    Memory Allocated: 0.1748495101928711  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.2557373046875 GB
    Memory Allocated: 0.1748495101928711  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.2557373046875 GB
    Memory Allocated: 0.3547706604003906  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.2557373046875 GB
    Memory Allocated: 0.3549213409423828  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.2557373046875 GB
    Memory Allocated: 0.18851852416992188  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.2557373046875 GB
    Memory Allocated: 0.20578479766845703  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2557373046875 GB
    Memory Allocated: 0.20578479766845703  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

first layer input nodes number: 482971
first layer output nodes number: 184302
edges number: 1817202
----------------------------------------before model layer 0
 Nvidia-smi: 21.2557373046875 GB
    Memory Allocated: 0.2107682228088379  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

torch.Size([482971, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.2557373046875 GB
    Memory Allocated: 0.2107682228088379  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

m.shape torch.Size([262, 1, 100])
----------------------------------------1
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9076642990112305  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9076642990112305  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 262, 100]), torch.Size([1, 262, 100])
----------------------------------------3
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9078598022460938  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9094223976135254  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 262, 100])
m.shape torch.Size([383, 2, 100])
----------------------------------------1
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9096102714538574  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9096102714538574  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 383, 100]), torch.Size([1, 383, 100])
----------------------------------------3
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9098963737487793  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9141793251037598  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 383, 100])
m.shape torch.Size([517, 3, 100])
----------------------------------------1
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.914614200592041  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.914614200592041  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 517, 100]), torch.Size([1, 517, 100])
----------------------------------------3
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9149994850158691  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9234757423400879  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 517, 100])
m.shape torch.Size([614, 4, 100])
----------------------------------------1
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9241981506347656  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9241981506347656  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 614, 100]), torch.Size([1, 614, 100])
----------------------------------------3
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9246559143066406  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9379253387451172  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 614, 100])
m.shape torch.Size([770, 5, 100])
----------------------------------------1
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9391307830810547  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9391307830810547  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 770, 100]), torch.Size([1, 770, 100])
----------------------------------------3
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9397048950195312  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9607663154602051  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 770, 100])
m.shape torch.Size([880, 6, 100])
----------------------------------------1
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9624462127685547  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9624462127685547  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 880, 100]), torch.Size([1, 880, 100])
----------------------------------------3
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9631023406982422  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9921293258666992  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 880, 100])
m.shape torch.Size([900, 7, 100])
----------------------------------------1
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9941482543945312  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9941482543945312  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 900, 100]), torch.Size([1, 900, 100])
----------------------------------------3
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 0.9948196411132812  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 1.0283589363098145  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 900, 100])
m.shape torch.Size([1005, 8, 100])
----------------------------------------1
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 1.0310187339782715  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 1.0310187339782715  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1005, 100]), torch.Size([1, 1005, 100])
----------------------------------------3
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 1.0317683219909668  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 1.0751171112060547  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1005, 100])
m.shape torch.Size([1013, 9, 100])
----------------------------------------1
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 1.078138828277588  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 1.078138828277588  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 1013, 100]), torch.Size([1, 1013, 100])
----------------------------------------3
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 1.0788941383361816  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9373779296875 GB
    Memory Allocated: 1.1272568702697754  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 1013, 100])
m.shape torch.Size([177958, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.6014404296875 GB
    Memory Allocated: 1.7898244857788086  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6014404296875 GB
    Memory Allocated: 1.7898244857788086  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 177958, 100]), torch.Size([1, 177958, 100])
----------------------------------------3
 Nvidia-smi: 22.6014404296875 GB
    Memory Allocated: 1.9224138259887695  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7459716796875 GB
    Memory Allocated: 11.33981704711914  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 177958, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 10.661020755767822  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 10.836784839630127  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.012548923492432  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 10.836784839630127  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

torch.Size([184302, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.012548923492432  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.056489944458008  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.056489944458008  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.538899898529053  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.538899898529053  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.538905620574951  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.538951396942139  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.538958549499512  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.538958549499512  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.538968086242676  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.539111137390137  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.539132595062256  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.539132595062256  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.539149761199951  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.539527416229248  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([15, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.539576530456543  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.539576530456543  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.539605140686035  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.540434837341309  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.540483474731445  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.540483474731445  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.540508270263672  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.541400909423828  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.541423320770264  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.541423320770264  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.54143476486206  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.541926860809326  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([15, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.542022228240967  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.542022228240967  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.542050838470459  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.543481349945068  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.54360580444336  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.54360580444336  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.54364013671875  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.545597076416016  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.545735836029053  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.545735836029053  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.545770168304443  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.547967433929443  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.548142910003662  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.548142910003662  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 15.7479248046875 GB
    Memory Allocated: 11.548181056976318  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7498779296875 GB
    Memory Allocated: 11.550889492034912  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([25, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.7498779296875 GB
    Memory Allocated: 11.551135063171387  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7498779296875 GB
    Memory Allocated: 11.551135063171387  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 15.7498779296875 GB
    Memory Allocated: 11.551182746887207  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7537841796875 GB
    Memory Allocated: 11.554902076721191  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.7537841796875 GB
    Memory Allocated: 11.5551438331604  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7537841796875 GB
    Memory Allocated: 11.5551438331604  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 15.7537841796875 GB
    Memory Allocated: 11.555187702178955  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7576904296875 GB
    Memory Allocated: 11.558916568756104  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([12, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.7576904296875 GB
    Memory Allocated: 11.55904483795166  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7576904296875 GB
    Memory Allocated: 11.55904483795166  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 15.7576904296875 GB
    Memory Allocated: 11.559067726135254  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7596435546875 GB
    Memory Allocated: 11.561173439025879  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([19, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.7596435546875 GB
    Memory Allocated: 11.561418056488037  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7596435546875 GB
    Memory Allocated: 11.561418056488037  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 15.7596435546875 GB
    Memory Allocated: 11.56145429611206  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7635498046875 GB
    Memory Allocated: 11.56504201889038  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.7635498046875 GB
    Memory Allocated: 11.565196990966797  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7635498046875 GB
    Memory Allocated: 11.565196990966797  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 15.7635498046875 GB
    Memory Allocated: 11.56521987915039  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7655029296875 GB
    Memory Allocated: 11.567646026611328  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.7655029296875 GB
    Memory Allocated: 11.568019390106201  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7655029296875 GB
    Memory Allocated: 11.568019390106201  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 15.7655029296875 GB
    Memory Allocated: 11.568067073822021  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7713623046875 GB
    Memory Allocated: 11.573455333709717  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.7713623046875 GB
    Memory Allocated: 11.573758602142334  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7713623046875 GB
    Memory Allocated: 11.573758602142334  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 15.7713623046875 GB
    Memory Allocated: 11.57379674911499  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 11.57837438583374  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 11.578736305236816  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 11.578736305236816  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 11.578778266906738  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 11.584107398986816  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([25, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 11.584543228149414  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 11.584543228149414  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 15.7830810546875 GB
    Memory Allocated: 11.584590911865234  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 11.590980529785156  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.7908935546875 GB
    Memory Allocated: 11.591456890106201  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7908935546875 GB
    Memory Allocated: 11.591456890106201  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 15.7908935546875 GB
    Memory Allocated: 11.591506481170654  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7967529296875 GB
    Memory Allocated: 11.598498821258545  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.7967529296875 GB
    Memory Allocated: 11.598857879638672  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7967529296875 GB
    Memory Allocated: 11.598857879638672  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 15.7967529296875 GB
    Memory Allocated: 11.598894119262695  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8026123046875 GB
    Memory Allocated: 11.604257583618164  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.8026123046875 GB
    Memory Allocated: 11.60483169555664  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8026123046875 GB
    Memory Allocated: 11.60483169555664  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 15.8026123046875 GB
    Memory Allocated: 11.60488510131836  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8123779296875 GB
    Memory Allocated: 11.613162994384766  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.8123779296875 GB
    Memory Allocated: 11.6137113571167  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8123779296875 GB
    Memory Allocated: 11.6137113571167  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 15.8123779296875 GB
    Memory Allocated: 11.613760948181152  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8201904296875 GB
    Memory Allocated: 11.621794700622559  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([33, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.8221435546875 GB
    Memory Allocated: 11.622531414031982  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8221435546875 GB
    Memory Allocated: 11.622531414031982  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 15.8221435546875 GB
    Memory Allocated: 11.622594356536865  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8319091796875 GB
    Memory Allocated: 11.63323163986206  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([19748, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.8319091796875 GB
    Memory Allocated: 12.107707977294922  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8319091796875 GB
    Memory Allocated: 12.107707977294922  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

 h.shape torch.Size([1, 19748, 256]), torch.Size([1, 19748, 256])
----------------------------------------3
 Nvidia-smi: 15.8319091796875 GB
    Memory Allocated: 12.145374298095703  GigaBytes
Max Memory Allocated: 17.12598991394043  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.9061279296875 GB
    Memory Allocated: 18.837417602539062  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 19748, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.9061279296875 GB
    Memory Allocated: 18.35928773880005  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.9061279296875 GB
    Memory Allocated: 18.36283254623413  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.9061279296875 GB
    Memory Allocated: 18.36705207824707  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.9061279296875 GB
    Memory Allocated: 18.363356590270996  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

torch.Size([20185, 47])
input nodes number: 184302
output nodes number: 20185
edges number: 500201
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.9061279296875 GB
    Memory Allocated: 18.36528491973877  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.9061279296875 GB
    Memory Allocated: 18.365285396575928  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.23656940460205078  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

pseudo mini batch 8 input nodes size: 410176
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.1887044906616211  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.1887044906616211  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.3415069580078125  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.34164953231811523  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.16157770156860352  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.17752504348754883  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.17752504348754883  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

first layer input nodes number: 410176
first layer output nodes number: 168386
edges number: 1665874
----------------------------------------before model layer 0
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.18255853652954102  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

torch.Size([410176, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.18255853652954102  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

m.shape torch.Size([214, 1, 100])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8206639289855957  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8206639289855957  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 214, 100]), torch.Size([1, 214, 100])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.820824146270752  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8221015930175781  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 214, 100])
m.shape torch.Size([289, 2, 100])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8222370147705078  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8222370147705078  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 289, 100]), torch.Size([1, 289, 100])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8224525451660156  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8256855010986328  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 289, 100])
m.shape torch.Size([326, 3, 100])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8259425163269043  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8259425163269043  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 326, 100]), torch.Size([1, 326, 100])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8261857032775879  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8315315246582031  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 326, 100])
m.shape torch.Size([409, 4, 100])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8320198059082031  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8320198059082031  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 409, 100]), torch.Size([1, 409, 100])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8323249816894531  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8411693572998047  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 409, 100])
m.shape torch.Size([509, 5, 100])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8419651985168457  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8419651985168457  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 509, 100]), torch.Size([1, 509, 100])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8423447608947754  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8560018539428711  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 509, 100])
m.shape torch.Size([545, 6, 100])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8570303916931152  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8570303916931152  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 545, 100]), torch.Size([1, 545, 100])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8574366569519043  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.874906063079834  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 545, 100])
m.shape torch.Size([681, 7, 100])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8764791488647461  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8764791488647461  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 681, 100]), torch.Size([1, 681, 100])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8769874572753906  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9034662246704102  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 681, 100])
m.shape torch.Size([719, 8, 100])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9053549766540527  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9053549766540527  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 719, 100]), torch.Size([1, 719, 100])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.905890941619873  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9368610382080078  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 719, 100])
m.shape torch.Size([806, 9, 100])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.939295768737793  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.939295768737793  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 806, 100]), torch.Size([1, 806, 100])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9398965835571289  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9795689582824707  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 806, 100])
m.shape torch.Size([163888, 10, 100])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 1.589798927307129  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 1.589798927307129  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 163888, 100]), torch.Size([1, 163888, 100])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 1.7119054794311523  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.381442070007324  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 163888, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 9.759385108947754  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 9.919970512390137  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.08055591583252  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 9.919970512390137  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

torch.Size([168386, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.08055591583252  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.120702266693115  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.120702266693115  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.57812213897705  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.57812213897705  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.578124046325684  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.578139305114746  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([11, 3, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.57817029953003  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.57817029953003  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.57819128036499  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.57865285873413  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.578661918640137  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.578661918640137  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.5786714553833  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.578948020935059  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.578986644744873  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.578986644744873  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.579003810882568  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.5796217918396  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 6, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.579670906066895  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.579670906066895  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.579689979553223  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.580510139465332  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 7, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.580568313598633  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.580568313598633  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.580587387084961  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.581541061401367  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.581554889678955  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.581554889678955  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.581560611724854  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.581886768341064  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([20, 9, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.582056999206543  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.582056999206543  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.5820951461792  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.5845365524292  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([5, 10, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.58456563949585  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.58456563949585  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.584575176239014  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.585252285003662  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 11, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.58531141281128  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.58531141281128  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.585322856903076  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.586215496063232  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([11, 12, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.586337089538574  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.586337089538574  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.586358070373535  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.588141441345215  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 13, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.588268756866455  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.588268756866455  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.588289737701416  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.590219974517822  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 14, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.590357780456543  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.590357780456543  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.590378761291504  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.592455863952637  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 15, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.592560768127441  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.592560768127441  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.592576026916504  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.594193458557129  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([15, 16, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.594416618347168  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.594416618347168  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.59444522857666  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.597678184509277  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 17, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.597843647003174  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.597843647003174  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.597864627838135  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.600382328033447  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.600631713867188  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.600631713867188  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.60066032409668  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.604293823242188  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.604608535766602  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.604608535766602  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.604642868041992  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.609243392944336  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.609572410583496  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.609572410583496  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.609606742858887  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.614447593688965  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.614753723144531  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.614753723144531  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.614784240722656  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.619300842285156  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.619645118713379  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.619645118713379  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.619677543640137  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.624703407287598  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.625063419342041  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.625063419342041  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.625095844268799  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.630348682403564  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.630932331085205  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.630932331085205  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.630981922149658  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.639362812042236  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([18809, 25, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.091283321380615  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.091283321380615  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 18809, 256]), torch.Size([1, 18809, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.127158641815186  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 17.44158411026001  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 18809, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 16.988993644714355  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 16.99246883392334  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 16.995944023132324  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 16.992326259613037  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

torch.Size([19083, 47])
input nodes number: 168386
output nodes number: 19083
edges number: 474447
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 16.99376678466797  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 16.993767261505127  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.20548295974731445  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

pseudo mini batch 9 input nodes size: 459896
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.16150808334350586  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.16150808334350586  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.33283281326293945  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.33298301696777344  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.1800379753112793  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.19690942764282227  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.19690942764282227  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

first layer input nodes number: 459896
first layer output nodes number: 178140
edges number: 1763585
----------------------------------------before model layer 0
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.2017536163330078  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

torch.Size([459896, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.2017536163330078  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

m.shape torch.Size([256, 1, 100])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8777999877929688  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8777999877929688  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 256, 100]), torch.Size([1, 256, 100])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.87799072265625  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8795166015625  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 256, 100])
m.shape torch.Size([338, 2, 100])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8796734809875488  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8796734809875488  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 338, 100]), torch.Size([1, 338, 100])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8799262046813965  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8837084770202637  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 338, 100])
m.shape torch.Size([334, 3, 100])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8839554786682129  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8839554786682129  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 334, 100]), torch.Size([1, 334, 100])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8842043876647949  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8896803855895996  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 334, 100])
m.shape torch.Size([382, 4, 100])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8901252746582031  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8901252746582031  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 382, 100]), torch.Size([1, 382, 100])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8904104232788086  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8986682891845703  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 382, 100])
m.shape torch.Size([452, 5, 100])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8993678092956543  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8993678092956543  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 452, 100]), torch.Size([1, 452, 100])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.8997054100036621  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9118375778198242  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 452, 100])
m.shape torch.Size([516, 6, 100])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9133906364440918  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9133906364440918  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 516, 100]), torch.Size([1, 516, 100])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9137759208679199  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9303174018859863  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 516, 100])
m.shape torch.Size([588, 7, 100])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9316582679748535  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9316582679748535  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 588, 100]), torch.Size([1, 588, 100])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9320969581604004  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9540114402770996  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 588, 100])
m.shape torch.Size([646, 8, 100])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9557175636291504  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9557175636291504  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 646, 100]), torch.Size([1, 646, 100])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9561991691589355  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9836392402648926  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 646, 100])
m.shape torch.Size([797, 9, 100])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9860706329345703  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9860706329345703  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 797, 100]), torch.Size([1, 797, 100])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.9866647720336914  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 1.0258784294128418  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 797, 100])
m.shape torch.Size([173831, 10, 100])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 1.6731524467468262  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 1.6731524467468262  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 173831, 100]), torch.Size([1, 173831, 100])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 1.8026671409606934  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.998181819915771  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 173831, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.339470863342285  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.509358406066895  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.679245948791504  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.509358406066895  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

torch.Size([178140, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.679245948791504  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.721717834472656  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 10.721717834472656  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

m.shape torch.Size([10, 2, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.204392910003662  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.204392910003662  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.20441198348999  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.204698085784912  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.204703330993652  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.204703330993652  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.204712867736816  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.204922676086426  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([21, 4, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.204998970031738  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.204998970031738  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.205039024353027  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.20620059967041  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.206190586090088  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.206190586090088  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.206194400787354  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.206331729888916  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([10, 6, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.206387519836426  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.206387519836426  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.206406593322754  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.207226753234863  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([5, 7, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.207251071929932  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.207251071929932  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.207260608673096  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.207737445831299  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 8, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.207778930664062  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.207778930664062  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.20779037475586  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.208442687988281  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 9, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.20850658416748  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.20850658416748  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.208521842956543  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.209498405456543  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 10, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.20953893661499  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.20953893661499  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.209548473358154  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.210225582122803  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 11, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.2102632522583  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.2102632522583  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.210270881652832  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.21086597442627  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([18, 12, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.21107006072998  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.21107006072998  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.211104393005371  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.214022636413574  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 13, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.214268207550049  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.214268207550049  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.214308261871338  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.217993259429932  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([24, 14, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.218296527862549  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.218296527862549  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.218342304229736  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.222874164581299  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([10, 15, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.22299575805664  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.22299575805664  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.223014831542969  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.22503662109375  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([7, 16, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.22513484954834  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.22513484954834  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.22514820098877  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.226656913757324  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 17, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.226781368255615  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.226781368255615  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.226796627044678  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.228627681732178  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 18, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.228793144226074  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.228793144226074  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.228812217712402  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.231234550476074  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.231626987457275  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.231626987457275  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.231668949127197  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.237291812896729  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.237405776977539  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.237405776977539  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.237419128417969  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.239301681518555  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.239638328552246  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.239638328552246  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.239670753479004  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.24446964263916  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.244728565216064  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.244728565216064  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.244753360748291  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.248596668243408  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.249093055725098  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.249093055725098  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 11.249136924743652  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3905029296875 GB
    Memory Allocated: 11.256243705749512  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 21.3905029296875 GB
    Memory Allocated: 11.256475925445557  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3905029296875 GB
    Memory Allocated: 11.256475925445557  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 21.3905029296875 GB
    Memory Allocated: 11.256496906280518  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3924560546875 GB
    Memory Allocated: 11.260042667388916  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([19871, 25, 256])
----------------------------------------1
 Nvidia-smi: 21.3924560546875 GB
    Memory Allocated: 11.737495422363281  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3924560546875 GB
    Memory Allocated: 11.737495422363281  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

 h.shape torch.Size([1, 19871, 256]), torch.Size([1, 19871, 256])
----------------------------------------3
 Nvidia-smi: 21.3924560546875 GB
    Memory Allocated: 11.776557922363281  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3924560546875 GB
    Memory Allocated: 18.481935501098633  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

rst.shape  torch.Size([1, 19871, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.3924560546875 GB
    Memory Allocated: 18.004366874694824  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.3924560546875 GB
    Memory Allocated: 18.007893085479736  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 21.3924560546875 GB
    Memory Allocated: 18.01141929626465  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 21.3924560546875 GB
    Memory Allocated: 18.007742881774902  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

torch.Size([20138, 47])
input nodes number: 178140
output nodes number: 20138
edges number: 500610
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3924560546875 GB
    Memory Allocated: 18.009655952453613  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.3924560546875 GB
    Memory Allocated: 18.00965642929077  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.3963623046875 GB
    Memory Allocated: 0.22690296173095703  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 21.3963623046875 GB
    Memory Allocated: 0.23198986053466797  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.3963623046875 GB
    Memory Allocated: 0.23198986053466797  GigaBytes
Max Memory Allocated: 19.308246612548828  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1320636034011841 |0.03902647495269775 |0.33532850742340087 |0.00010755062103271485 |0.17834064960479737 |0.005285739898681641 |
----------------------------------------------------------pseudo_mini_loss sum 5.391512870788574
Total (block generation + training)time/epoch 73.93199586868286
* Pure training time/epoch 6.85395359992981
Training time/epoch 6.949978590011597
Training time without block to device /epoch 6.559713840484619
Training time without total dataloading part /epoch 5.143052816390991
load block tensor time/epoch 1.3206360340118408
block to device time/epoch 0.39026474952697754
input features size transfer per epoch 1.341104507446289e-06
blocks size to device per epoch 8.940696716308594e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5651451
Number of first layer input nodes during this epoch:  4083985
Number of first layer output nodes during this epoch:  1567466
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  682400
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([400, 100])
layers.0.lstm.weight_hh_l0, torch.Size([400, 100])
layers.0.lstm.bias_ih_l0, torch.Size([400])
layers.0.lstm.bias_hh_l0, torch.Size([400])
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([47, 256])
layers.1.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
