main start at this time 1655792612.9228208
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.20508933067321777
global_2_local spend time (sec) 0.3865525722503662
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.04938507080078125
A = g.adjacency_matrix() spent  0.07506322860717773
auxiliary_graph
Graph(num_nodes=1205586, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.581143856048584
remove nodes length
1009015
auxiliary_graph.remove_nodes spent  2.6947286128997803
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.105551242828369

the counter of shared neighbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
51547892
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 51547889, 51547890, 51547891])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
Convert a graph into a bidirected graph: 3.252 seconds
Metis partitioning: 13.262 seconds
Split the graph: 0.866 seconds
Construct subgraphs: 0.375 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  17.779696226119995
10293
10566
10069
10044
10100
10045
10413
10635
10526
10655
10472
10050
10047
10091
10656
10620
10574
10059
10656
total k batches seeds list generation spend  40.03096342086792
after graph partition
graph partition algorithm spend time 40.58827066421509
10293
10566
10069
10044
10100
10045
10413
10635
10526
10655
10472
10050
10047
10091
10656
10620
10574
10059
10656
partition_len_list
[73235, 98782, 74601, 84965, 93702, 89893, 80031, 85295, 101875, 76365, 104101, 95359, 106481, 95058, 107767, 100142, 99310, 101328, 107933]
shared_neighbor_graph_partition_s0 selection method  spend 41.22979116439819
time for parepare:  0.2630913257598877
local_output_nid generation:  0.003499746322631836
local_in_edges_tensor generation:  0.004392385482788086
mini_batch_src_global generation:  0.00952458381652832
r_  generation:  0.08335423469543457
local_output_nid generation:  0.003993034362792969
local_in_edges_tensor generation:  0.004036426544189453
mini_batch_src_global generation:  0.012304067611694336
r_  generation:  0.09659934043884277
local_output_nid generation:  0.003818511962890625
local_in_edges_tensor generation:  0.003960847854614258
mini_batch_src_global generation:  0.009912967681884766
r_  generation:  0.08516311645507812
local_output_nid generation:  0.003884553909301758
local_in_edges_tensor generation:  0.0039048194885253906
mini_batch_src_global generation:  0.009331226348876953
r_  generation:  0.08947610855102539
local_output_nid generation:  0.003873109817504883
local_in_edges_tensor generation:  0.004343509674072266
mini_batch_src_global generation:  0.010228395462036133
r_  generation:  0.0948479175567627
local_output_nid generation:  0.003846406936645508
local_in_edges_tensor generation:  0.004075288772583008
mini_batch_src_global generation:  0.009355783462524414
r_  generation:  0.10235118865966797
local_output_nid generation:  0.0040132999420166016
local_in_edges_tensor generation:  0.015720367431640625
mini_batch_src_global generation:  0.010645627975463867
r_  generation:  0.09524106979370117
local_output_nid generation:  0.004081249237060547
local_in_edges_tensor generation:  0.008133888244628906
mini_batch_src_global generation:  0.01661205291748047
r_  generation:  0.09702134132385254
local_output_nid generation:  0.0050275325775146484
local_in_edges_tensor generation:  0.005130767822265625
mini_batch_src_global generation:  0.010670900344848633
r_  generation:  0.10486054420471191
local_output_nid generation:  0.006852388381958008
local_in_edges_tensor generation:  0.00441741943359375
mini_batch_src_global generation:  0.010300636291503906
r_  generation:  0.09448099136352539
local_output_nid generation:  0.00399470329284668
local_in_edges_tensor generation:  0.006148338317871094
mini_batch_src_global generation:  0.010441780090332031
r_  generation:  0.10913276672363281
local_output_nid generation:  0.0038843154907226562
local_in_edges_tensor generation:  0.004094839096069336
mini_batch_src_global generation:  0.010652542114257812
r_  generation:  0.1000223159790039
local_output_nid generation:  0.0038514137268066406
local_in_edges_tensor generation:  0.004059314727783203
mini_batch_src_global generation:  0.009711027145385742
r_  generation:  0.10183835029602051
local_output_nid generation:  0.0039560794830322266
local_in_edges_tensor generation:  0.0039010047912597656
mini_batch_src_global generation:  0.009863853454589844
r_  generation:  0.09340023994445801
local_output_nid generation:  0.0040585994720458984
local_in_edges_tensor generation:  0.004118204116821289
mini_batch_src_global generation:  0.01054239273071289
r_  generation:  0.11708283424377441
local_output_nid generation:  0.004052162170410156
local_in_edges_tensor generation:  0.004116058349609375
mini_batch_src_global generation:  0.011731863021850586
r_  generation:  0.1135263442993164
local_output_nid generation:  0.00408172607421875
local_in_edges_tensor generation:  0.004282951354980469
mini_batch_src_global generation:  0.010938644409179688
r_  generation:  0.11549544334411621
local_output_nid generation:  0.0038480758666992188
local_in_edges_tensor generation:  0.004100799560546875
mini_batch_src_global generation:  0.011389493942260742
r_  generation:  0.10853171348571777
local_output_nid generation:  0.004082679748535156
local_in_edges_tensor generation:  0.004099845886230469
mini_batch_src_global generation:  0.011139392852783203
r_  generation:  0.11900138854980469
----------------------check_connections_block total spend ----------------------------- 3.012587308883667
generate_one_block  1.5903456211090088
generate_one_block  0.13382244110107422
generate_one_block  0.1679997444152832
generate_one_block  0.11755681037902832
generate_one_block  0.1243741512298584
generate_one_block  0.12691187858581543
generate_one_block  0.12359428405761719
generate_one_block  0.12916159629821777
generate_one_block  0.13001489639282227
generate_one_block  0.12386775016784668
generate_one_block  0.13413166999816895
generate_one_block  0.12048459053039551
generate_one_block  0.12958049774169922
generate_one_block  0.1133730411529541
generate_one_block  0.13891315460205078
generate_one_block  0.1374526023864746
generate_one_block  0.13482928276062012
generate_one_block  0.1333000659942627
generate_one_block  0.14270424842834473
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7295842170715332
gen group dst list time:  0.04729437828063965
time for parepare:  0.4037489891052246
local_output_nid generation:  0.018230676651000977
local_in_edges_tensor generation:  0.06592059135437012
mini_batch_src_global generation:  0.023860692977905273
r_  generation:  0.28142857551574707
local_output_nid generation:  0.031043052673339844
local_in_edges_tensor generation:  0.08022642135620117
mini_batch_src_global generation:  0.03802204132080078
r_  generation:  0.41248583793640137
local_output_nid generation:  0.022043704986572266
local_in_edges_tensor generation:  0.02261042594909668
mini_batch_src_global generation:  0.031220674514770508
r_  generation:  0.3097710609436035
local_output_nid generation:  0.024428844451904297
local_in_edges_tensor generation:  0.024378299713134766
mini_batch_src_global generation:  0.033496856689453125
r_  generation:  0.3531532287597656
local_output_nid generation:  0.027476072311401367
local_in_edges_tensor generation:  0.03082108497619629
mini_batch_src_global generation:  0.03864145278930664
r_  generation:  0.42095184326171875
local_output_nid generation:  0.0268709659576416
local_in_edges_tensor generation:  0.04851031303405762
mini_batch_src_global generation:  0.03777670860290527
r_  generation:  0.41248226165771484
local_output_nid generation:  0.029970169067382812
local_in_edges_tensor generation:  0.03766965866088867
mini_batch_src_global generation:  0.04190993309020996
r_  generation:  0.3555490970611572
local_output_nid generation:  0.03272366523742676
local_in_edges_tensor generation:  0.026558399200439453
mini_batch_src_global generation:  0.03577136993408203
r_  generation:  0.3790287971496582
local_output_nid generation:  0.029999494552612305
local_in_edges_tensor generation:  0.03243565559387207
mini_batch_src_global generation:  0.04172468185424805
r_  generation:  0.4726266860961914
local_output_nid generation:  0.02120232582092285
local_in_edges_tensor generation:  0.01908111572265625
mini_batch_src_global generation:  0.03601241111755371
r_  generation:  0.3419945240020752
local_output_nid generation:  0.028426408767700195
local_in_edges_tensor generation:  0.03093862533569336
mini_batch_src_global generation:  0.043595314025878906
r_  generation:  0.48331642150878906
local_output_nid generation:  0.02928447723388672
local_in_edges_tensor generation:  0.03337860107421875
mini_batch_src_global generation:  0.04287600517272949
r_  generation:  0.45824384689331055
local_output_nid generation:  0.032486915588378906
local_in_edges_tensor generation:  0.03661799430847168
mini_batch_src_global generation:  0.04738187789916992
r_  generation:  0.5546283721923828
local_output_nid generation:  0.02802586555480957
local_in_edges_tensor generation:  0.025578975677490234
mini_batch_src_global generation:  0.04307246208190918
r_  generation:  0.4653584957122803
local_output_nid generation:  0.03125190734863281
local_in_edges_tensor generation:  0.028858661651611328
mini_batch_src_global generation:  0.04843020439147949
r_  generation:  0.5132441520690918
local_output_nid generation:  0.029478788375854492
local_in_edges_tensor generation:  0.02634143829345703
mini_batch_src_global generation:  0.046150922775268555
r_  generation:  0.47910308837890625
local_output_nid generation:  0.028637409210205078
local_in_edges_tensor generation:  0.027347326278686523
mini_batch_src_global generation:  0.04642224311828613
r_  generation:  0.4712941646575928
local_output_nid generation:  0.030252695083618164
local_in_edges_tensor generation:  0.03618454933166504
mini_batch_src_global generation:  0.04825735092163086
r_  generation:  0.48665523529052734
local_output_nid generation:  0.03300619125366211
local_in_edges_tensor generation:  0.039380550384521484
mini_batch_src_global generation:  0.04826664924621582
r_  generation:  0.5220277309417725
----------------------check_connections_block total spend ----------------------------- 12.36443305015564
generate_one_block  0.6169242858886719
generate_one_block  0.6354906558990479
generate_one_block  0.42034268379211426
generate_one_block  0.6105399131774902
generate_one_block  0.7089314460754395
generate_one_block  0.5683689117431641
generate_one_block  0.41551923751831055
generate_one_block  0.4472923278808594
generate_one_block  0.6537227630615234
generate_one_block  0.6212813854217529
generate_one_block  0.6521344184875488
generate_one_block  0.5493595600128174
generate_one_block  0.6110372543334961
generate_one_block  0.5360958576202393
generate_one_block  0.6027975082397461
generate_one_block  0.6897494792938232
generate_one_block  0.6885623931884766
generate_one_block  0.6022019386291504
generate_one_block  0.610508918762207
----------===============-------------===============-------------the number of batches *****---- 19

original number of batches:  19
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

connection checking time:  15.377020359039307
block generation total time  15.193279266357422
average batch blocks generation time:  0.3998231385883532
block dataloader generation time/epoch 73.89021229743958
pseudo mini batch 0 input nodes size: 217383
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.08352518081665039  GigaBytes
Max Memory Allocated: 0.08352518081665039  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0836019515991211  GigaBytes
Max Memory Allocated: 0.0836019515991211  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1014404296875 GB
    Memory Allocated: 0.0836019515991211  GigaBytes
Max Memory Allocated: 0.0836019515991211  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1873779296875 GB
    Memory Allocated: 0.0908212661743164  GigaBytes
Max Memory Allocated: 0.0908212661743164  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1873779296875 GB
    Memory Allocated: 0.0908212661743164  GigaBytes
Max Memory Allocated: 0.0908212661743164  GigaBytes

first layer input nodes number: 217383
first layer output nodes number: 73235
edges number: 715518
----------------------------------------before model layer 0
 Nvidia-smi: 1.1873779296875 GB
    Memory Allocated: 0.092987060546875  GigaBytes
Max Memory Allocated: 0.09565258026123047  GigaBytes

torch.Size([217383, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1873779296875 GB
    Memory Allocated: 0.092987060546875  GigaBytes
Max Memory Allocated: 0.09565258026123047  GigaBytes

m.shape torch.Size([133, 1, 100])
----------------------------------------1
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.3671116828918457  GigaBytes
Max Memory Allocated: 0.37847042083740234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.3671116828918457  GigaBytes
Max Memory Allocated: 0.37847042083740234  GigaBytes

 h.shape torch.Size([1, 133, 100]), torch.Size([1, 133, 100])
----------------------------------------3
 Nvidia-smi: 1.5877685546875 GB
    Memory Allocated: 0.36721086502075195  GigaBytes
Max Memory Allocated: 0.37847042083740234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.36800432205200195  GigaBytes
Max Memory Allocated: 0.37847042083740234  GigaBytes

rst.shape  torch.Size([1, 133, 100])
m.shape torch.Size([274, 2, 100])
----------------------------------------1
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.36815929412841797  GigaBytes
Max Memory Allocated: 0.37847042083740234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.36815929412841797  GigaBytes
Max Memory Allocated: 0.37847042083740234  GigaBytes

 h.shape torch.Size([1, 274, 100]), torch.Size([1, 274, 100])
----------------------------------------3
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.3683643341064453  GigaBytes
Max Memory Allocated: 0.37847042083740234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.3714313507080078  GigaBytes
Max Memory Allocated: 0.37847042083740234  GigaBytes

rst.shape  torch.Size([1, 274, 100])
m.shape torch.Size([320, 3, 100])
----------------------------------------1
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.3716864585876465  GigaBytes
Max Memory Allocated: 0.37847042083740234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.3716864585876465  GigaBytes
Max Memory Allocated: 0.37847042083740234  GigaBytes

 h.shape torch.Size([1, 320, 100]), torch.Size([1, 320, 100])
----------------------------------------3
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.37192487716674805  GigaBytes
Max Memory Allocated: 0.37847042083740234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.3771700859069824  GigaBytes
Max Memory Allocated: 0.37847042083740234  GigaBytes

rst.shape  torch.Size([1, 320, 100])
m.shape torch.Size([478, 4, 100])
----------------------------------------1
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.3777632713317871  GigaBytes
Max Memory Allocated: 0.37847042083740234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.3777632713317871  GigaBytes
Max Memory Allocated: 0.37847042083740234  GigaBytes

 h.shape torch.Size([1, 478, 100]), torch.Size([1, 478, 100])
----------------------------------------3
 Nvidia-smi: 1.5994873046875 GB
    Memory Allocated: 0.37811994552612305  GigaBytes
Max Memory Allocated: 0.37847042083740234  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6131591796875 GB
    Memory Allocated: 0.38845205307006836  GigaBytes
Max Memory Allocated: 0.38916444778442383  GigaBytes

rst.shape  torch.Size([1, 478, 100])
m.shape torch.Size([517, 5, 100])
----------------------------------------1
 Nvidia-smi: 1.6131591796875 GB
    Memory Allocated: 0.3892369270324707  GigaBytes
Max Memory Allocated: 0.3892664909362793  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6131591796875 GB
    Memory Allocated: 0.3892369270324707  GigaBytes
Max Memory Allocated: 0.3892664909362793  GigaBytes

 h.shape torch.Size([1, 517, 100]), torch.Size([1, 517, 100])
----------------------------------------3
 Nvidia-smi: 1.6131591796875 GB
    Memory Allocated: 0.38962221145629883  GigaBytes
Max Memory Allocated: 0.38962221145629883  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.40349245071411133  GigaBytes
Max Memory Allocated: 0.40445566177368164  GigaBytes

rst.shape  torch.Size([1, 517, 100])
m.shape torch.Size([536, 6, 100])
----------------------------------------1
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.4044981002807617  GigaBytes
Max Memory Allocated: 0.40453481674194336  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.4044981002807617  GigaBytes
Max Memory Allocated: 0.40453481674194336  GigaBytes

 h.shape torch.Size([1, 536, 100]), torch.Size([1, 536, 100])
----------------------------------------3
 Nvidia-smi: 1.6287841796875 GB
    Memory Allocated: 0.40489768981933594  GigaBytes
Max Memory Allocated: 0.40489768981933594  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.4220714569091797  GigaBytes
Max Memory Allocated: 0.42326974868774414  GigaBytes

rst.shape  torch.Size([1, 536, 100])
m.shape torch.Size([568, 7, 100])
----------------------------------------1
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.4233531951904297  GigaBytes
Max Memory Allocated: 0.423398494720459  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.4233531951904297  GigaBytes
Max Memory Allocated: 0.423398494720459  GigaBytes

 h.shape torch.Size([1, 568, 100]), torch.Size([1, 568, 100])
----------------------------------------3
 Nvidia-smi: 1.6463623046875 GB
    Memory Allocated: 0.42377662658691406  GigaBytes
Max Memory Allocated: 0.42377662658691406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.44493818283081055  GigaBytes
Max Memory Allocated: 0.44641971588134766  GigaBytes

rst.shape  torch.Size([1, 568, 100])
m.shape torch.Size([645, 8, 100])
----------------------------------------1
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.44664907455444336  GigaBytes
Max Memory Allocated: 0.44670724868774414  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.44664907455444336  GigaBytes
Max Memory Allocated: 0.44670724868774414  GigaBytes

 h.shape torch.Size([1, 645, 100]), torch.Size([1, 645, 100])
----------------------------------------3
 Nvidia-smi: 1.6678466796875 GB
    Memory Allocated: 0.4471297264099121  GigaBytes
Max Memory Allocated: 0.4471297264099121  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.47452688217163086  GigaBytes
Max Memory Allocated: 0.4771738052368164  GigaBytes

rst.shape  torch.Size([1, 645, 100])
m.shape torch.Size([612, 9, 100])
----------------------------------------1
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.47693347930908203  GigaBytes
Max Memory Allocated: 0.4771738052368164  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.47693347930908203  GigaBytes
Max Memory Allocated: 0.4771738052368164  GigaBytes

 h.shape torch.Size([1, 612, 100]), torch.Size([1, 612, 100])
----------------------------------------3
 Nvidia-smi: 1.6951904296875 GB
    Memory Allocated: 0.4773902893066406  GigaBytes
Max Memory Allocated: 0.4773902893066406  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7264404296875 GB
    Memory Allocated: 0.5065875053405762  GigaBytes
Max Memory Allocated: 0.5086398124694824  GigaBytes

rst.shape  torch.Size([1, 612, 100])
m.shape torch.Size([69152, 10, 100])
----------------------------------------1
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.7641716003417969  GigaBytes
Max Memory Allocated: 0.7719001770019531  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9862060546875 GB
    Memory Allocated: 0.7641716003417969  GigaBytes
Max Memory Allocated: 0.7719001770019531  GigaBytes

 h.shape torch.Size([1, 69152, 100]), torch.Size([1, 69152, 100])
----------------------------------------3
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.8156938552856445  GigaBytes
Max Memory Allocated: 0.8156938552856445  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0057373046875 GB
    Memory Allocated: 4.487907409667969  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 69152, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0057373046875 GB
    Memory Allocated: 4.221563816070557  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0057373046875 GB
    Memory Allocated: 4.291406154632568  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0057373046875 GB
    Memory Allocated: 4.36124849319458  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0057373046875 GB
    Memory Allocated: 4.291406154632568  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

torch.Size([73235, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0057373046875 GB
    Memory Allocated: 4.36124849319458  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0057373046875 GB
    Memory Allocated: 4.378709316253662  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0057373046875 GB
    Memory Allocated: 4.378709316253662  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.623202323913574  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.623202323913574  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.6232099533081055  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.6232709884643555  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.623279094696045  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.623279094696045  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.623290538787842  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.623462200164795  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.623476982116699  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.623476982116699  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.623490333557129  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.623784065246582  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([25, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.623873710632324  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.623873710632324  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.6239213943481445  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.625304222106934  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.625314235687256  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.625314235687256  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.6253275871276855  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.625808238983154  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([17, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.625899791717529  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.625899791717529  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.625932216644287  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.627326488494873  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.627377986907959  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.627377986907959  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.627397060394287  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.628350734710693  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([18, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.628479957580566  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.628479957580566  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.628514289855957  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.630471229553223  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([13, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.630566596984863  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.630566596984863  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.63059139251709  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.63217830657959  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.632291316986084  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.632291316986084  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.6323161125183105  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.6340765953063965  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.634222984313965  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.634222984313965  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 6.2498779296875 GB
    Memory Allocated: 4.634251594543457  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2537841796875 GB
    Memory Allocated: 4.636483192443848  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.2537841796875 GB
    Memory Allocated: 4.636596202850342  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2537841796875 GB
    Memory Allocated: 4.636596202850342  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 6.2537841796875 GB
    Memory Allocated: 4.636617183685303  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2557373046875 GB
    Memory Allocated: 4.638400554656982  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.2557373046875 GB
    Memory Allocated: 4.638552665710449  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2557373046875 GB
    Memory Allocated: 4.638552665710449  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 6.2557373046875 GB
    Memory Allocated: 4.638577461242676  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2576904296875 GB
    Memory Allocated: 4.6408586502075195  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.2576904296875 GB
    Memory Allocated: 4.641048431396484  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2576904296875 GB
    Memory Allocated: 4.641048431396484  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 6.2576904296875 GB
    Memory Allocated: 4.641077041625977  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2596435546875 GB
    Memory Allocated: 4.643909454345703  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([25, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.2615966796875 GB
    Memory Allocated: 4.644255638122559  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2615966796875 GB
    Memory Allocated: 4.644255638122559  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 6.2615966796875 GB
    Memory Allocated: 4.644303321838379  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2655029296875 GB
    Memory Allocated: 4.649357795715332  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.2655029296875 GB
    Memory Allocated: 4.649610996246338  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2655029296875 GB
    Memory Allocated: 4.649610996246338  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 6.2655029296875 GB
    Memory Allocated: 4.6496453285217285  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2694091796875 GB
    Memory Allocated: 4.653524875640869  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.2694091796875 GB
    Memory Allocated: 4.65375280380249  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2694091796875 GB
    Memory Allocated: 4.65375280380249  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 6.2694091796875 GB
    Memory Allocated: 4.653781414031982  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2733154296875 GB
    Memory Allocated: 4.657214641571045  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.2733154296875 GB
    Memory Allocated: 4.657529354095459  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2733154296875 GB
    Memory Allocated: 4.657529354095459  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 6.2733154296875 GB
    Memory Allocated: 4.657565593719482  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2791748046875 GB
    Memory Allocated: 4.662168025970459  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.2791748046875 GB
    Memory Allocated: 4.662442207336426  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2791748046875 GB
    Memory Allocated: 4.662442207336426  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 6.2791748046875 GB
    Memory Allocated: 4.662472724914551  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2830810546875 GB
    Memory Allocated: 4.666562080383301  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.2830810546875 GB
    Memory Allocated: 4.667027473449707  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2830810546875 GB
    Memory Allocated: 4.667027473449707  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 6.2830810546875 GB
    Memory Allocated: 4.667075157165527  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2908935546875 GB
    Memory Allocated: 4.673798561096191  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.2908935546875 GB
    Memory Allocated: 4.674057483673096  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2908935546875 GB
    Memory Allocated: 4.674057483673096  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 6.2908935546875 GB
    Memory Allocated: 4.674084186553955  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.2947998046875 GB
    Memory Allocated: 4.678036212921143  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.2947998046875 GB
    Memory Allocated: 4.67850923538208  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2947998046875 GB
    Memory Allocated: 4.67850923538208  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 6.2947998046875 GB
    Memory Allocated: 4.678553104400635  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3026123046875 GB
    Memory Allocated: 4.685352802276611  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.3026123046875 GB
    Memory Allocated: 4.685596466064453  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3026123046875 GB
    Memory Allocated: 4.685596466064453  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 6.3026123046875 GB
    Memory Allocated: 4.685619354248047  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3065185546875 GB
    Memory Allocated: 4.689327239990234  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.3065185546875 GB
    Memory Allocated: 4.689823627471924  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.3065185546875 GB
    Memory Allocated: 4.689823627471924  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 6.3065185546875 GB
    Memory Allocated: 4.689865589141846  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.3143310546875 GB
    Memory Allocated: 4.696957111358643  GigaBytes
Max Memory Allocated: 4.745719909667969  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([9930, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.5565185546875 GB
    Memory Allocated: 4.935756206512451  GigaBytes
Max Memory Allocated: 4.936681270599365  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.5565185546875 GB
    Memory Allocated: 4.935756206512451  GigaBytes
Max Memory Allocated: 4.936681270599365  GigaBytes

 h.shape torch.Size([1, 9930, 256]), torch.Size([1, 9930, 256])
----------------------------------------3
 Nvidia-smi: 6.5565185546875 GB
    Memory Allocated: 4.954696178436279  GigaBytes
Max Memory Allocated: 4.954696178436279  GigaBytes

----------------------------------------4
 Nvidia-smi: 9.8807373046875 GB
    Memory Allocated: 8.30113935470581  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 9930, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 9.8807373046875 GB
    Memory Allocated: 8.058485984802246  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 9.8807373046875 GB
    Memory Allocated: 8.060288429260254  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 9.8807373046875 GB
    Memory Allocated: 8.062864303588867  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 9.8807373046875 GB
    Memory Allocated: 8.060985088348389  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

torch.Size([10293, 47])
input nodes number: 73235
output nodes number: 10293
edges number: 253329
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.8807373046875 GB
    Memory Allocated: 8.06341028213501  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.8807373046875 GB
    Memory Allocated: 8.063411235809326  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 10.3690185546875 GB
    Memory Allocated: 0.10764932632446289  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

pseudo mini batch 1 input nodes size: 273668
----------------------------------------before load block subtensor 
 Nvidia-smi: 10.3690185546875 GB
    Memory Allocated: 0.08794879913330078  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 10.3690185546875 GB
    Memory Allocated: 0.08794879913330078  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 10.3690185546875 GB
    Memory Allocated: 0.18989849090576172  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 10.3690185546875 GB
    Memory Allocated: 0.18997764587402344  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 10.3690185546875 GB
    Memory Allocated: 0.10891914367675781  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 10.3690185546875 GB
    Memory Allocated: 0.11813640594482422  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.3690185546875 GB
    Memory Allocated: 0.11813640594482422  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

first layer input nodes number: 273668
first layer output nodes number: 98782
edges number: 977351
----------------------------------------before model layer 0
 Nvidia-smi: 10.3690185546875 GB
    Memory Allocated: 0.12144851684570312  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

torch.Size([273668, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.3690185546875 GB
    Memory Allocated: 0.12144851684570312  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

m.shape torch.Size([158, 1, 100])
----------------------------------------1
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.4958324432373047  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.4958324432373047  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 158, 100]), torch.Size([1, 158, 100])
----------------------------------------3
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.49595069885253906  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.49689388275146484  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 158, 100])
m.shape torch.Size([186, 2, 100])
----------------------------------------1
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.49697351455688477  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.49697351455688477  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 186, 100]), torch.Size([1, 186, 100])
----------------------------------------3
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.4971127510070801  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.49919557571411133  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 186, 100])
m.shape torch.Size([193, 3, 100])
----------------------------------------1
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.4993419647216797  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.4993419647216797  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 193, 100]), torch.Size([1, 193, 100])
----------------------------------------3
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.49948596954345703  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5026540756225586  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 193, 100])
m.shape torch.Size([241, 4, 100])
----------------------------------------1
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5029416084289551  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5029416084289551  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 241, 100]), torch.Size([1, 241, 100])
----------------------------------------3
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5031218528747559  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5083374977111816  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 241, 100])
m.shape torch.Size([286, 5, 100])
----------------------------------------1
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5087804794311523  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5087804794311523  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 286, 100]), torch.Size([1, 286, 100])
----------------------------------------3
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5089941024780273  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5166702270507812  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 286, 100])
m.shape torch.Size([310, 6, 100])
----------------------------------------1
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5172567367553711  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5172567367553711  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 310, 100]), torch.Size([1, 310, 100])
----------------------------------------3
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5174884796142578  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5274276733398438  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 310, 100])
m.shape torch.Size([361, 7, 100])
----------------------------------------1
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5282535552978516  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5282535552978516  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 361, 100]), torch.Size([1, 361, 100])
----------------------------------------3
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5285234451293945  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5419878959655762  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 361, 100])
m.shape torch.Size([323, 8, 100])
----------------------------------------1
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5428156852722168  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5428156852722168  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 323, 100]), torch.Size([1, 323, 100])
----------------------------------------3
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5430569648742676  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5567870140075684  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 323, 100])
m.shape torch.Size([363, 9, 100])
----------------------------------------1
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.558232307434082  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.558232307434082  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 363, 100]), torch.Size([1, 363, 100])
----------------------------------------3
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5585031509399414  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7362060546875 GB
    Memory Allocated: 0.5758242607116699  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 363, 100])
m.shape torch.Size([96361, 10, 100])
----------------------------------------1
 Nvidia-smi: 11.0955810546875 GB
    Memory Allocated: 0.9350638389587402  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0955810546875 GB
    Memory Allocated: 0.9350638389587402  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 96361, 100]), torch.Size([1, 96361, 100])
----------------------------------------3
 Nvidia-smi: 11.0955810546875 GB
    Memory Allocated: 1.006859302520752  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.1250128746032715  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 96361, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 5.759973526000977  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 5.854665279388428  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 5.94887113571167  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 5.854179382324219  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

torch.Size([98782, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 5.94887113571167  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 5.9724225997924805  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 5.9724225997924805  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

m.shape torch.Size([42, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.222400188446045  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.222400188446045  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.222480297088623  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.223121166229248  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([26, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.22313117980957  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.22313117980957  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.223180770874023  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.22392463684082  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([16, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.2239460945129395  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.2239460945129395  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.2239766120910645  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.2246479988098145  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.224678993225098  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.224678993225098  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.224701881408691  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.22536563873291  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.225407123565674  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.225407123565674  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.225428104400635  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.2261834144592285  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.226271152496338  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.226271152496338  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.226303577423096  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.227697849273682  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([9, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.2277421951293945  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.2277421951293945  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.22775936126709  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.2286176681518555  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([9, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.2286787033081055  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.2286787033081055  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.228695869445801  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.229674339294434  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([26, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.229890823364258  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.229890823364258  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.229940414428711  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.233114242553711  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([10, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.233185768127441  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.233185768127441  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.2332048416137695  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.234559059143066  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([7, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.234623908996582  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.234623908996582  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.234637260437012  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.235678672790527  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.235764503479004  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.235764503479004  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.235779762268066  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.237076759338379  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.23716926574707  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.23716926574707  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.237184524536133  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.238588333129883  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([13, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.238755702972412  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.238755702972412  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.238780498504639  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.241235256195068  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([9, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.2413530349731445  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.2413530349731445  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.24137020111084  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.243189811706543  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.243288993835449  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.243288993835449  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.243302345275879  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.244811058044434  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.244935512542725  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.244935512542725  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.244950771331787  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.246781826019287  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.2468953132629395  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.2468953132629395  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.246908664703369  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.2486042976379395  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([12, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.248816967010498  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.248816967010498  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.248839855194092  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.251906871795654  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.252068519592285  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.252068519592285  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.2520856857299805  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.2545061111450195  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.254739761352539  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.254739761352539  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.254762649536133  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.258150100708008  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.258265972137451  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.258265972137451  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.258277416229248  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.260051250457764  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.260200500488281  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.260200500488281  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.260213851928711  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.26237678527832  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.26255464553833  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.26255464553833  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.262569904327393  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.265148639678955  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10267, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.51218843460083  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.51218843460083  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

 h.shape torch.Size([1, 10267, 256]), torch.Size([1, 10267, 256])
----------------------------------------3
 Nvidia-smi: 14.6346435546875 GB
    Memory Allocated: 6.531771183013916  GigaBytes
Max Memory Allocated: 8.537889003753662  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8807373046875 GB
    Memory Allocated: 9.979703426361084  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 10267, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.8807373046875 GB
    Memory Allocated: 9.732184410095215  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.8807373046875 GB
    Memory Allocated: 9.734447479248047  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 14.8807373046875 GB
    Memory Allocated: 9.736297607421875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 14.8807373046875 GB
    Memory Allocated: 9.733955383300781  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([10566, 47])
input nodes number: 98782
output nodes number: 10566
edges number: 259604
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8807373046875 GB
    Memory Allocated: 9.735231399536133  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.8807373046875 GB
    Memory Allocated: 9.735231876373291  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.13465261459350586  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

pseudo mini batch 2 input nodes size: 190262
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.10937976837158203  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.10937976837158203  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.18025827407836914  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.18033361434936523  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.07830476760864258  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.08547163009643555  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.08547163009643555  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

first layer input nodes number: 190262
first layer output nodes number: 74601
edges number: 723141
----------------------------------------before model layer 0
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.08744525909423828  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([190262, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.08744525909423828  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

m.shape torch.Size([166, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.3651900291442871  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.3651900291442871  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 166, 100]), torch.Size([1, 166, 100])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.3653140068054199  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.3663043975830078  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 166, 100])
m.shape torch.Size([332, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.36648988723754883  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.36648988723754883  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 332, 100]), torch.Size([1, 332, 100])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.36673784255981445  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.3704514503479004  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 332, 100])
m.shape torch.Size([403, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.37077808380126953  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.37077808380126953  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 403, 100]), torch.Size([1, 403, 100])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.3710784912109375  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.3776874542236328  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 403, 100])
m.shape torch.Size([595, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.37842416763305664  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.37842416763305664  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 595, 100]), torch.Size([1, 595, 100])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.37886762619018555  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.39172792434692383  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 595, 100])
m.shape torch.Size([702, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.3931589126586914  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.3931589126586914  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 702, 100]), torch.Size([1, 702, 100])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.39368247985839844  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.41298866271972656  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 702, 100])
m.shape torch.Size([858, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.414644718170166  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.414644718170166  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 858, 100]), torch.Size([1, 858, 100])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.4152846336364746  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.44278383255004883  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 858, 100])
m.shape torch.Size([858, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.4447016716003418  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.4447016716003418  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 858, 100]), torch.Size([1, 858, 100])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.4453415870666504  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.4779853820800781  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 858, 100])
m.shape torch.Size([921, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.48057126998901367  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.48057126998901367  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 921, 100]), torch.Size([1, 921, 100])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.48125791549682617  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.5206971168518066  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 921, 100])
m.shape torch.Size([970, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.5236063003540039  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.5236063003540039  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 970, 100]), torch.Size([1, 970, 100])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.5243291854858398  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.5720663070678711  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 970, 100])
m.shape torch.Size([68796, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.8279900550842285  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.8279900550842285  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 68796, 100]), torch.Size([1, 68796, 100])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 0.8792471885681152  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.518503665924072  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 68796, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.249876976013184  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.321022033691406  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.392167091369629  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.321022033691406  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([74601, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.392167091369629  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.409953594207764  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.409953594207764  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

m.shape torch.Size([17, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.639764785766602  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.639764785766602  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.639797210693359  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.640056610107422  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([31, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.640100002288818  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.640100002288818  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.6401591300964355  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.641046047210693  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([36, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.641120433807373  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.641120433807373  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.641189098358154  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.642699718475342  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([50, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.642858028411865  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.642858028411865  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.642953395843506  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.645719051361084  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([45, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.645887851715088  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.645887851715088  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.6459736824035645  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.649063587188721  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([52, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.649320602416992  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.649320602416992  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.649419784545898  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.653684616088867  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([54, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.653998374938965  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.653998374938965  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.654101371765137  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.6592512130737305  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([63, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.659684181213379  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.659684181213379  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.659804344177246  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.666653633117676  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([50, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.667026519775391  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.667026519775391  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.667121887207031  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.673225402832031  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([39, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.673552989959717  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.673552989959717  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.6736273765563965  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.678908824920654  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([51, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.679410934448242  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.679410934448242  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.679508209228516  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.687095642089844  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([35, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.687450885772705  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.687450885772705  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.6875176429748535  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.693192005157471  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.6937336921691895  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.6937336921691895  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.693821430206299  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.701893329620361  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([45, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.702455043792725  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.702455043792725  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.702540874481201  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.711038112640381  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.7116875648498535  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.7116875648498535  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.7117791175842285  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.7214837074279785  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.722114562988281  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.722114562988281  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.722198486328125  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.731681823730469  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([50, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.732457160949707  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.732457160949707  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.732552528381348  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.743996620178223  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([43, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.744693279266357  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.744693279266357  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.744775295257568  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.755191326141357  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([56, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.756263256072998  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.756263256072998  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.7563700675964355  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.7706828117370605  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.771475315093994  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.771475315093994  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.771559238433838  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.783392429351807  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.784077167510986  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.784077167510986  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 4.784145832061768  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1307373046875 GB
    Memory Allocated: 4.794308185577393  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([44, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.1307373046875 GB
    Memory Allocated: 4.7952046394348145  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1307373046875 GB
    Memory Allocated: 4.7952046394348145  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 15.1307373046875 GB
    Memory Allocated: 4.795288562774658  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 4.8082966804504395  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([45, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 4.809250831604004  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 4.809250831604004  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 15.1444091796875 GB
    Memory Allocated: 4.8093366622924805  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 4.823241233825684  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([49, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 4.824734687805176  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 4.824734687805176  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 4.824828147888184  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1737060546875 GB
    Memory Allocated: 4.840622901916504  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([8996, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.056772708892822  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.056772708892822  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 8996, 256]), torch.Size([1, 8996, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.074359893798828  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 8.094257354736328  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 8996, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 7.867453098297119  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 7.869530200958252  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 7.871902942657471  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 7.869750499725342  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([10069, 47])
input nodes number: 74601
output nodes number: 10069
edges number: 238682
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 7.8701958656311035  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 7.870196342468262  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.09810209274291992  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

pseudo mini batch 3 input nodes size: 262401
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.07811880111694336  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.07811880111694336  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.1758708953857422  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.17594575881958008  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.10499191284179688  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.1128854751586914  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.1128854751586914  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

first layer input nodes number: 262401
first layer output nodes number: 84965
edges number: 822614
----------------------------------------before model layer 0
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.11621761322021484  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([262401, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.11621761322021484  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

m.shape torch.Size([179, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.4314002990722656  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.4314002990722656  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 179, 100]), torch.Size([1, 179, 100])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.4315338134765625  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.4326019287109375  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 179, 100])
m.shape torch.Size([349, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.43279552459716797  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.43279552459716797  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 349, 100]), torch.Size([1, 349, 100])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.4330558776855469  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.43695831298828125  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 349, 100])
m.shape torch.Size([487, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.43737268447875977  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.43737268447875977  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 487, 100]), torch.Size([1, 487, 100])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.43773603439331055  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.4457211494445801  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 487, 100])
m.shape torch.Size([623, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.44646787643432617  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.44646787643432617  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 623, 100]), torch.Size([1, 623, 100])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.446932315826416  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.46039533615112305  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 623, 100])
m.shape torch.Size([855, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.46175575256347656  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.46175575256347656  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 855, 100]), torch.Size([1, 855, 100])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.46239280700683594  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.48532676696777344  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 855, 100])
m.shape torch.Size([967, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.4871697425842285  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.4871697425842285  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 967, 100]), torch.Size([1, 967, 100])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.48789072036743164  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.5198125839233398  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 967, 100])
m.shape torch.Size([1183, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.5225372314453125  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.5225372314453125  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1183, 100]), torch.Size([1, 1183, 100])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.5234193801879883  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.5685386657714844  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1183, 100])
m.shape torch.Size([1289, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.5719394683837891  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.5719394683837891  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1289, 100]), torch.Size([1, 1289, 100])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.5729007720947266  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.6286168098449707  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1289, 100])
m.shape torch.Size([1216, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.6322979927062988  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.6322979927062988  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1216, 100]), torch.Size([1, 1216, 100])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.6332039833068848  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.6911873817443848  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1216, 100])
m.shape torch.Size([77817, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.9806256294250488  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 0.9806256294250488  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 77817, 100]), torch.Size([1, 77817, 100])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 1.0386042594909668  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.1550726890563965  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 77817, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 4.849696636199951  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 4.930725574493408  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.011754512786865  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 4.930725574493408  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([84965, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.011754512786865  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.032011985778809  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.032011985778809  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

m.shape torch.Size([23, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.260000705718994  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.260000705718994  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.260044574737549  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.260395526885986  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([30, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.260431289672852  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.260431289672852  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.260488510131836  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.261346817016602  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.261402130126953  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.261402130126953  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.261457443237305  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.262674331665039  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([41, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.2628045082092285  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.2628045082092285  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.262882709503174  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.265150547027588  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([46, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.2653326988220215  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.2653326988220215  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.265420436859131  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.268579006195068  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([56, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.268858432769775  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.268858432769775  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.268965244293213  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.273558139801025  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([62, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.273921966552734  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.273921966552734  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.274040222167969  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.2799530029296875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([59, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.28034782409668  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.28034782409668  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.280460357666016  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.286874771118164  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([49, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.287242412567139  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.287242412567139  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.2873358726501465  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.2933173179626465  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([67, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.293914794921875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.293914794921875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.294042587280273  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.3031158447265625  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([52, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.3036017417907715  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.3036017417907715  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.303700923919678  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.311437129974365  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([52, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.311987400054932  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.311987400054932  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.312086582183838  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.320517063140869  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([64, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.321267127990723  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.321267127990723  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.321389198303223  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.332619667053223  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.333285331726074  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.333285331726074  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.333388328552246  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.343585014343262  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([56, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.344341278076172  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.344341278076172  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.344448089599609  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.355770111083984  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([47, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.356439590454102  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.356439590454102  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.356529235839844  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.366659164428711  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([66, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.367722988128662  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.367722988128662  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.367848873138428  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.382955074310303  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([50, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.383757591247559  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.383757591247559  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.383852958679199  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.395964622497559  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([57, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.397336483001709  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.397336483001709  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.397445201873779  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.412013530731201  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([37, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.412670612335205  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.412670612335205  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.412741184234619  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.422691822052002  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([57, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.424077033996582  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.424077033996582  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.424185752868652  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.440276145935059  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([49, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.441257953643799  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.441257953643799  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.441351413726807  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.455837726593018  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([52, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.457001209259033  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.457001209259033  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 15.1776123046875 GB
    Memory Allocated: 5.4571003913879395  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1932373046875 GB
    Memory Allocated: 5.473167896270752  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([53, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.1932373046875 GB
    Memory Allocated: 5.474340915679932  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1932373046875 GB
    Memory Allocated: 5.474340915679932  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 15.1932373046875 GB
    Memory Allocated: 5.474442005157471  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2108154296875 GB
    Memory Allocated: 5.491526126861572  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([8836, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.2127685546875 GB
    Memory Allocated: 5.7037882804870605  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2127685546875 GB
    Memory Allocated: 5.7037882804870605  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 8836, 256]), torch.Size([1, 8836, 256])
----------------------------------------3
 Nvidia-smi: 15.2127685546875 GB
    Memory Allocated: 5.720641613006592  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2127685546875 GB
    Memory Allocated: 8.686828136444092  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 8836, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2127685546875 GB
    Memory Allocated: 8.461965560913086  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2127685546875 GB
    Memory Allocated: 8.463812828063965  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2127685546875 GB
    Memory Allocated: 8.465883255004883  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2127685546875 GB
    Memory Allocated: 8.463961124420166  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([10044, 47])
input nodes number: 84965
output nodes number: 10044
edges number: 236781
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2127685546875 GB
    Memory Allocated: 8.464439392089844  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.2127685546875 GB
    Memory Allocated: 8.464439868927002  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.12702465057373047  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

pseudo mini batch 4 input nodes size: 325130
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.10476207733154297  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.10476207733154297  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.22588253021240234  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.22595787048339844  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.12813091278076172  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.13677406311035156  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.13677406311035156  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

first layer input nodes number: 325130
first layer output nodes number: 93702
edges number: 913627
----------------------------------------before model layer 0
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.13989543914794922  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([325130, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.13989543914794922  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

m.shape torch.Size([159, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4899153709411621  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4899153709411621  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 159, 100]), torch.Size([1, 159, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4900345802307129  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4909839630126953  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 159, 100])
m.shape torch.Size([298, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4911465644836426  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4911465644836426  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 298, 100]), torch.Size([1, 298, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.49136877059936523  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4947018623352051  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 298, 100])
m.shape torch.Size([466, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.49511194229125977  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.49511194229125977  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 466, 100]), torch.Size([1, 466, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.49546003341674805  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5031051635742188  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 466, 100])
m.shape torch.Size([603, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5038299560546875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5038299560546875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 603, 100]), torch.Size([1, 603, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5042800903320312  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5173168182373047  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 603, 100])
m.shape torch.Size([755, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.518498420715332  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.518498420715332  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 755, 100]), torch.Size([1, 755, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5190610885620117  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5402789115905762  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 755, 100])
m.shape torch.Size([814, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5418171882629395  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5418171882629395  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 814, 100]), torch.Size([1, 814, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5424237251281738  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5688614845275879  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 814, 100])
m.shape torch.Size([943, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5710177421569824  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5710177421569824  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 943, 100]), torch.Size([1, 943, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5717206001281738  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.6072545051574707  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 943, 100])
m.shape torch.Size([955, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.6097493171691895  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.6097493171691895  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 955, 100]), torch.Size([1, 955, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.6104617118835449  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.651033878326416  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 955, 100])
m.shape torch.Size([928, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.6537890434265137  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.6537890434265137  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 928, 100]), torch.Size([1, 928, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.6544804573059082  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.6997060775756836  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 928, 100])
m.shape torch.Size([87781, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 1.0263705253601074  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 1.0263705253601074  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 87781, 100]), torch.Size([1, 87781, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 1.0917725563049316  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.735316753387451  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 87781, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.395415782928467  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.484776973724365  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.574138164520264  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.484776973724365  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([93702, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.574138164520264  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.596478462219238  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.596478462219238  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.833611011505127  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.833611011505127  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.833618640899658  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.833679676055908  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.833697319030762  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.833697319030762  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.833718299865723  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.834033012390137  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.834043025970459  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.834043025970459  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.834056377410889  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.834350109100342  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([14, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.834397315979004  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.834397315979004  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.834424018859863  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.835198402404785  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([24, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.835300445556641  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.835300445556641  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.835346221923828  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.836994171142578  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([20, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.8370866775512695  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.8370866775512695  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.837124824523926  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.8387651443481445  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([22, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.838894367218018  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.838894367218018  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.8389363288879395  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.841034412384033  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.841152191162109  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.841152191162109  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.8411865234375  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.843143463134766  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.843265056610107  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.843265056610107  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.843295574188232  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.845248699188232  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([24, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.84546422958374  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.84546422958374  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.845510005950928  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.84876012802124  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([42, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.849181652069092  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.849181652069092  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.84926176071167  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.855510234832764  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([24, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.855747222900391  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.855747222900391  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.855792999267578  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.859683990478516  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([31, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.860048770904541  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.860048770904541  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.860107898712158  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.8655476570129395  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.865935325622559  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.865935325622559  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.865994453430176  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.871848106384277  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.872251510620117  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.872251510620117  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.872308731079102  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.878374099731445  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.878714561462402  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.878714561462402  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.87876033782959  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.883933067321777  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([30, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.884400367736816  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.884400367736816  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.884457588195801  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.891324043273926  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.891814708709717  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.891814708709717  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.891871929168701  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.899138927459717  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.899603843688965  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.899603843688965  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.899655342102051  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.906556129455566  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([31, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.907126426696777  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.907126426696777  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.9071855545043945  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.915522575378418  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.916240215301514  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.916240215301514  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.916310787200928  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.926755428314209  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.927375793457031  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.927375793457031  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.927434921264648  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.9365997314453125  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.93718957901001  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.93718957901001  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.9372429847717285  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.945894718170166  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.946560382843018  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.946560382843018  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.946617603302002  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.956287860870361  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([9514, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 6.184863090515137  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 6.184863090515137  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 9514, 256]), torch.Size([1, 9514, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 6.203009605407715  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 9.397168159484863  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 9514, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 9.162622928619385  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 9.16439151763916  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 9.166160106658936  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 9.164316177368164  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([10100, 47])
input nodes number: 93702
output nodes number: 10100
edges number: 246302
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 9.165011405944824  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 9.165011882781982  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.15180635452270508  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

pseudo mini batch 5 input nodes size: 292349
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.1280522346496582  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.1280522346496582  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.23696088790893555  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.23703575134277344  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.11583995819091797  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.12421035766601562  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.12421035766601562  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

first layer input nodes number: 292349
first layer output nodes number: 89893
edges number: 876849
----------------------------------------before model layer 0
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.1270585060119629  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([292349, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.1270585060119629  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

m.shape torch.Size([207, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.463010311126709  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.463010311126709  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 207, 100]), torch.Size([1, 207, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4631648063659668  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4643993377685547  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 207, 100])
m.shape torch.Size([269, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4645228385925293  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4645228385925293  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 269, 100]), torch.Size([1, 269, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.464724063873291  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.46773386001586914  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 269, 100])
m.shape torch.Size([434, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.46811866760253906  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.46811866760253906  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 434, 100]), torch.Size([1, 434, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4684429168701172  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.47556352615356445  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 434, 100])
m.shape torch.Size([583, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4762701988220215  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4762701988220215  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 583, 100]), torch.Size([1, 583, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.47670507431030273  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4893050193786621  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 583, 100])
m.shape torch.Size([665, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4903264045715332  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4903264045715332  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 665, 100]), torch.Size([1, 665, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.49082231521606445  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5087504386901855  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 665, 100])
m.shape torch.Size([803, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5102977752685547  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5102977752685547  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 803, 100]), torch.Size([1, 803, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5108966827392578  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5374794006347656  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 803, 100])
m.shape torch.Size([847, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5393891334533691  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5393891334533691  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 847, 100]), torch.Size([1, 847, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5400204658508301  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5726761817932129  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 847, 100])
m.shape torch.Size([802, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5747509002685547  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5747509002685547  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 802, 100]), torch.Size([1, 802, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5753488540649414  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.6094918251037598  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 802, 100])
m.shape torch.Size([848, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.6120362281799316  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.6120362281799316  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 848, 100]), torch.Size([1, 848, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.612668514251709  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.6537060737609863  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 848, 100])
m.shape torch.Size([84435, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.9679350852966309  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.9679350852966309  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 84435, 100]), torch.Size([1, 84435, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 1.0308442115783691  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.497392177581787  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 84435, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.171087265014648  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.2568159103393555  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.3425445556640625  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.2568159103393555  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([89893, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.3425445556640625  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.363976955413818  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.363976955413818  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

m.shape torch.Size([9, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.60130500793457  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.60130500793457  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.601322174072266  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.601459503173828  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.601457118988037  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.601457118988037  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.6014628410339355  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.601548671722412  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([11, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.6015777587890625  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.6015777587890625  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.601598739624023  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.602060317993164  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.602092266082764  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.602092266082764  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.602113246917725  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.602721691131592  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.602778911590576  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.602778911590576  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.6028056144714355  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.603766918182373  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.6038289070129395  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.6038289070129395  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.603853702545166  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.604919910430908  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([20, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.605042457580566  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.605042457580566  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.605080604553223  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.606987953186035  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.607061386108398  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.607061386108398  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.607084274291992  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.608388900756836  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([26, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.608602523803711  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.608602523803711  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.608652114868164  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.611825942993164  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.612031936645508  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.612031936645508  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.612077713012695  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.615327835083008  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.615506172180176  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.615506172180176  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.615542411804199  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.618369102478027  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.618593215942383  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.618593215942383  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.618633270263672  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.622037887573242  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.62220573425293  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.62220573425293  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.622234344482422  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.624866485595703  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([22, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.625148296356201  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.625148296356201  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.625190258026123  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.629344463348389  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.629611968994141  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.629611968994141  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.629650115966797  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.633693695068359  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.633920669555664  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.633920669555664  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.633951187133789  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.637399673461914  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.637743949890137  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.637743949890137  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.637785911560059  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.642821311950684  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.643181324005127  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.643181324005127  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.643223285675049  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.648552417755127  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([14, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.648787498474121  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.648787498474121  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.6488142013549805  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.652392387390137  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.65266752243042  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.65266752243042  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.652696132659912  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.6567301750183105  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.657039165496826  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.657039165496826  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.657069683074951  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.661586284637451  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.662099838256836  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.662099838256836  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.662147521972656  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.669538497924805  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.670001029968262  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.670001029968262  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.670042991638184  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.676840782165527  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.67737340927124  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.67737340927124  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.677419185638428  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.685155391693115  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([9629, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.916499614715576  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.916499614715576  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 9629, 256]), torch.Size([1, 9629, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.934865474700928  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 9.174546718597412  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 9629, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 8.939648628234863  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 8.94197940826416  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 8.944310188293457  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 8.941904544830322  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([10045, 47])
input nodes number: 89893
output nodes number: 10045
edges number: 246499
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 8.943211555480957  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 8.943212032318115  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.1392807960510254  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

pseudo mini batch 6 input nodes size: 220477
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.11640214920043945  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.11640214920043945  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.19853639602661133  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.19861412048339844  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.0896306037902832  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.0972447395324707  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.0972447395324707  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

first layer input nodes number: 220477
first layer output nodes number: 80031
edges number: 770374
----------------------------------------before model layer 0
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.09948396682739258  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([220477, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.09948396682739258  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

m.shape torch.Size([306, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.39471864700317383  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.39471864700317383  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 306, 100]), torch.Size([1, 306, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.39494752883911133  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.3967742919921875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 306, 100])
m.shape torch.Size([433, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.39698266983032227  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.39698266983032227  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 433, 100]), torch.Size([1, 433, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.397305965423584  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.40214967727661133  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 433, 100])
m.shape torch.Size([618, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4026789665222168  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4026789665222168  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 618, 100]), torch.Size([1, 618, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.403139591217041  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.41327333450317383  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 618, 100])
m.shape torch.Size([774, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4141964912414551  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4141964912414551  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 774, 100]), torch.Size([1, 774, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.41477346420288086  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4321408271789551  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 774, 100])
m.shape torch.Size([919, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4335641860961914  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4335641860961914  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 919, 100]), torch.Size([1, 919, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4342489242553711  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4592742919921875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 919, 100])
m.shape torch.Size([985, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4611339569091797  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4611339569091797  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 985, 100]), torch.Size([1, 985, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4618682861328125  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4944801330566406  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 985, 100])
m.shape torch.Size([1019, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.49677038192749023  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.49677038192749023  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1019, 100]), torch.Size([1, 1019, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.497530460357666  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5357732772827148  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1019, 100])
m.shape torch.Size([1065, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5385675430297852  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5385675430297852  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1065, 100]), torch.Size([1, 1065, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5393619537353516  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5855746269226074  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1065, 100])
m.shape torch.Size([1026, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5886178016662598  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5886178016662598  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1026, 100]), torch.Size([1, 1026, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5893826484680176  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.6390023231506348  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1026, 100])
m.shape torch.Size([72886, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.9101414680480957  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.9101414680480957  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 72886, 100]), torch.Size([1, 72886, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.9648289680480957  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.824653148651123  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 72886, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.538444995880127  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.6147685050964355  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.691092014312744  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.6147685050964355  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([80031, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.691092014312744  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.710623264312744  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.710623264312744  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

m.shape torch.Size([12, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.952782154083252  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.952782154083252  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.952805042266846  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.952988147735596  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([16, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.953007698059082  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.953007698059082  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.953038215637207  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.953495979309082  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.9535298347473145  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.9535298347473145  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.953562259674072  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.954275608062744  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([31, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.954378604888916  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.954378604888916  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.954437732696533  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.956152439117432  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([34, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.956286430358887  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.956286430358887  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.956351280212402  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.958685874938965  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([32, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.958837985992432  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.958837985992432  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.958899021148682  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.961523532867432  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([37, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.961742401123047  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.961742401123047  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.961812973022461  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.965341567993164  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.965529441833496  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.965529441833496  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.965584754943848  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.968737602233887  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.9689178466796875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.9689178466796875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.968963623046875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.971893310546875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([29, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.97214937210083  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.97214937210083  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.972204685211182  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.976131916046143  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([36, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.976485252380371  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.976485252380371  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.976553916931152  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.98190975189209  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([39, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.982325553894043  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.982325553894043  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.982399940490723  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.988722801208496  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([37, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.989148139953613  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.989148139953613  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.989218711853027  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.995711326599121  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([36, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.996160507202148  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.996160507202148  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.99622917175293  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.003026962280273  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.00349760055542  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.00349760055542  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.003564357757568  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.010640621185303  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([37, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.011176586151123  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.011176586151123  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.011247158050537  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.019221782684326  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.019742488861084  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.019742488861084  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.0198073387146  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.027589321136475  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.028093338012695  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.028093338012695  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.0281524658203125  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.035661697387695  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.0363264083862305  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.0363264083862305  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.036398887634277  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.046111106872559  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.0469207763671875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.0469207763671875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.047004699707031  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.058837890625  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.059502601623535  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.059502601623535  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.059569358825684  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.069449424743652  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([45, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.070367813110352  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.070367813110352  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.070453643798828  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.083757400512695  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([43, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.084665298461914  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.084665298461914  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.084747314453125  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.098033905029297  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.098708152770996  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.098708152770996  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.098767280578613  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.108759880065918  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([9631, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.340675354003906  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.340675354003906  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 9631, 256]), torch.Size([1, 9631, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.359045028686523  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 8.592164039611816  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 9631, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 8.35277509689331  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 8.355098247528076  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 8.357421398162842  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 8.355020523071289  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([10413, 47])
input nodes number: 80031
output nodes number: 10413
edges number: 251515
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 8.355687141418457  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 8.355687618255615  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.1102747917175293  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

pseudo mini batch 7 input nodes size: 229579
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.08962297439575195  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.08962297439575195  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.17514801025390625  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.17522764205932617  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.09301567077636719  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.10100173950195312  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.10100173950195312  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

first layer input nodes number: 229579
first layer output nodes number: 85295
edges number: 815665
----------------------------------------before model layer 0
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.1033482551574707  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([229579, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.1033482551574707  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

m.shape torch.Size([343, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.41596460342407227  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.41596460342407227  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 343, 100]), torch.Size([1, 343, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.41622018814086914  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.41826486587524414  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 343, 100])
m.shape torch.Size([587, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.41857481002807617  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.41857481002807617  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 587, 100]), torch.Size([1, 587, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.41901254653930664  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.42557573318481445  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 587, 100])
m.shape torch.Size([780, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.42622900009155273  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.42622900009155273  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 780, 100]), torch.Size([1, 780, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.42681074142456055  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.44023704528808594  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 780, 100])
m.shape torch.Size([955, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.44136953353881836  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.44136953353881836  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 955, 100]), torch.Size([1, 955, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.44208192825317383  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4627242088317871  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 955, 100])
m.shape torch.Size([1128, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.46446943283081055  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.46446943283081055  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1128, 100]), torch.Size([1, 1128, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.46531057357788086  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.49579811096191406  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1128, 100])
m.shape torch.Size([1242, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4981536865234375  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.4981536865234375  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1242, 100]), torch.Size([1, 1242, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.49907970428466797  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5388813018798828  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1242, 100])
m.shape torch.Size([1292, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5417876243591309  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5417876243591309  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1292, 100]), torch.Size([1, 1292, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5427508354187012  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5914444923400879  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1292, 100])
m.shape torch.Size([1299, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5948343276977539  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5948343276977539  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1299, 100]), torch.Size([1, 1299, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.5958023071289062  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.6513314247131348  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1299, 100])
m.shape torch.Size([1230, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.6549715995788574  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.6549715995788574  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1230, 100]), torch.Size([1, 1230, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.6558880805969238  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.7145652770996094  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1230, 100])
m.shape torch.Size([76439, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.9988646507263184  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.9988646507263184  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 76439, 100]), torch.Size([1, 76439, 100])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 1.0558161735534668  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.099374294281006  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 76439, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.797214508056641  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.879245758056641  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.960589408874512  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.878558158874512  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([85295, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.960589408874512  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.98023796081543  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 4.98023796081543  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

m.shape torch.Size([11, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.226833820343018  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.226833820343018  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.2268548011779785  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.227022647857666  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([16, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.227043151855469  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.227043151855469  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.227073669433594  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.227531433105469  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.2275710105896  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.2275710105896  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.227607250213623  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.228404521942139  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([23, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.228475093841553  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.228475093841553  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.228518962860107  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.229791164398193  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([32, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.229923248291016  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.229923248291016  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.229984283447266  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.232181549072266  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.232324123382568  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.232324123382568  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.232381343841553  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.234841823577881  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([28, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.235002040863037  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.235002040863037  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.235055446624756  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.237725734710693  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([33, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.237953186035156  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.237953186035156  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.238016128540039  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.241603851318359  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([45, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.24196195602417  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.24196195602417  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.2420477867126465  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.2475409507751465  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([42, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.247901916503906  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.247901916503906  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.247982025146484  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.253669738769531  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.253968238830566  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.253968238830566  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.254029273986816  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.258790016174316  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([40, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.259221076965332  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.259221076965332  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.2592973709106445  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.265782356262207  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.266356468200684  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.266356468200684  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.266449928283691  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.27504825592041  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.275634288787842  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.275634288787842  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.275723934173584  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.2845988273620605  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.285202980041504  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.285202980041504  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.2852888107299805  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.294386863708496  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([53, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.295159339904785  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.295159339904785  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.295260429382324  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.306683540344238  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([45, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.307368278503418  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.307368278503418  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.3074541091918945  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.317753791809082  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.318316459655762  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.318316459655762  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.31838321685791  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.326861381530762  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([53, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.32779598236084  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.32779598236084  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.327897071838379  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.341443061828613  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([43, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.342219352722168  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.342219352722168  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.342301368713379  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.353865623474121  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.354732990264893  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.354732990264893  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.354818820953369  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.3675217628479  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([41, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.368346214294434  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.368346214294434  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.368424415588379  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.380545616149902  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([53, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.381685256958008  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.381685256958008  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.381786346435547  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.398162841796875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([45, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.399322032928467  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.399322032928467  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.399407863616943  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.413913249969482  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([9730, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.647685527801514  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.647685527801514  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 9730, 256]), torch.Size([1, 9730, 256])
----------------------------------------3
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 5.667171001434326  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 8.94455099105835  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 9730, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 8.700936794281006  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 8.702882289886475  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 8.704827785491943  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 8.702802658081055  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([10635, 47])
input nodes number: 85295
output nodes number: 10635
edges number: 256125
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 8.703140258789062  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 8.70314073562622  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.11425638198852539  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

pseudo mini batch 8 input nodes size: 300177
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.09263801574707031  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.09263801574707031  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.20446300506591797  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.20454168319702148  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.11893701553344727  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.12813425064086914  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.12813425064086914  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

first layer input nodes number: 300177
first layer output nodes number: 101875
edges number: 980782
----------------------------------------before model layer 0
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.13113021850585938  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([300177, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.2147216796875 GB
    Memory Allocated: 0.13113021850585938  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

m.shape torch.Size([365, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5069870948791504  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5069870948791504  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 365, 100]), torch.Size([1, 365, 100])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5072598457336426  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5094375610351562  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 365, 100])
m.shape torch.Size([543, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5097060203552246  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5097060203552246  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 543, 100]), torch.Size([1, 543, 100])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5101113319396973  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5161824226379395  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 543, 100])
m.shape torch.Size([789, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5168619155883789  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5168619155883789  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 789, 100]), torch.Size([1, 789, 100])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5174503326416016  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5313553810119629  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 789, 100])
m.shape torch.Size([992, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5325393676757812  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5325393676757812  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 992, 100]), torch.Size([1, 992, 100])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5332784652709961  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5553627014160156  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 992, 100])
m.shape torch.Size([1179, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5571894645690918  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5571894645690918  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1179, 100]), torch.Size([1, 1179, 100])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5580687522888184  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5897016525268555  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1179, 100])
m.shape torch.Size([1277, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5921163558959961  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5921163558959961  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1277, 100]), torch.Size([1, 1277, 100])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5930681228637695  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.6340422630310059  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1277, 100])
m.shape torch.Size([1291, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.6369333267211914  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.6369333267211914  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1291, 100]), torch.Size([1, 1291, 100])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.6378955841064453  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.6875410079956055  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1291, 100])
m.shape torch.Size([1332, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.6910295486450195  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.6910295486450195  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1332, 100]), torch.Size([1, 1332, 100])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.6920223236083984  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.7485990524291992  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1332, 100])
m.shape torch.Size([1324, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.7525420188903809  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.7525420188903809  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1324, 100]), torch.Size([1, 1324, 100])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.7535290718078613  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.8166747093200684  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1324, 100])
m.shape torch.Size([92783, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 1.161825180053711  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 1.161825180053711  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 92783, 100]), torch.Size([1, 92783, 100])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 1.2309541702270508  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.139098167419434  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 92783, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 5.775208950042725  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 5.872364521026611  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 5.969520092010498  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 5.872364521026611  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([101875, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 5.969520092010498  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 5.993809223175049  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 5.993809223175049  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.237912178039551  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.237912178039551  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.2379255294799805  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.238032341003418  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([12, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.238049030303955  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.238049030303955  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.238071918487549  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.238415241241455  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([27, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.2384819984436035  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.2384819984436035  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.2385334968566895  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.23966646194458  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([27, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.239744663238525  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.239744663238525  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.239796161651611  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.2412896156311035  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.241369724273682  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.241369724273682  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.2414116859436035  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.242922306060791  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([42, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.243143558502197  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.243143558502197  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.243223667144775  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.246668338775635  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([41, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.246904373168945  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.246904373168945  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.246982574462891  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.250892639160156  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([43, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.251184463500977  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.251184463500977  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.2512664794921875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.255941390991211  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([32, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.2561774253845215  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.2561774253845215  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.2562384605407715  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.2601447105407715  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([37, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.260469913482666  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.260469913482666  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.26054048538208  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.2655510902404785  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([44, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.265981197357178  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.265981197357178  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.2660651206970215  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.272611141204834  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([33, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.272950172424316  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.272950172424316  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.273013114929199  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.278363227844238  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([55, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.279019355773926  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.279019355773926  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.2791242599487305  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.288775444030762  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.289355754852295  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.289355754852295  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.289445400238037  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.298320293426514  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([33, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.298751354217529  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.298751354217529  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.298814296722412  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.30548620223999  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.306100845336914  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.306100845336914  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.306180953979492  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.31523323059082  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([38, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.31581449508667  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.31581449508667  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.315886974334717  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.324584484100342  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([41, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.325257778167725  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.325257778167725  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.32533597946167  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.335267543792725  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([32, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.335813045501709  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.335813045501709  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.335874080657959  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.344052791595459  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.344541549682617  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.344541549682617  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.344593048095703  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.35185432434082  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([35, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.352535247802734  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.352535247802734  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.352602005004883  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.362482070922852  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.363189220428467  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.363189220428467  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.363255977630615  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.373603343963623  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([49, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.37468957901001  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.37468957901001  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.374783039093018  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.389923572540283  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([41, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.390822887420654  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.390822887420654  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.3909010887146  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.404117107391357  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([9684, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.637515068054199  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.637515068054199  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 9684, 256]), torch.Size([1, 9684, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 6.6559858322143555  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 9.906840324401855  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 9684, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 9.66563367843628  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 9.667754650115967  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 9.669875621795654  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 9.667675971984863  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([10526, 47])
input nodes number: 101875
output nodes number: 10526
edges number: 253539
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 9.668689250946045  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 9.668689727783203  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.1440286636352539  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

pseudo mini batch 9 input nodes size: 214432
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.11911249160766602  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.11911249160766602  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.19899463653564453  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.19907426834106445  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.08717060089111328  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.09450721740722656  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.09450721740722656  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

first layer input nodes number: 214432
first layer output nodes number: 76365
edges number: 733180
----------------------------------------before model layer 0
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.09722566604614258  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([214432, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.09722566604614258  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

m.shape torch.Size([93, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.37813711166381836  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.37813711166381836  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 93, 100]), torch.Size([1, 93, 100])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.378206729888916  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.37876224517822266  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 93, 100])
m.shape torch.Size([189, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.37886857986450195  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.37886857986450195  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 189, 100]), torch.Size([1, 189, 100])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.3790097236633301  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.38112401962280273  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 189, 100])
m.shape torch.Size([427, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.38153076171875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.38153076171875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 427, 100]), torch.Size([1, 427, 100])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.3818492889404297  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.388852596282959  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 427, 100])
m.shape torch.Size([865, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.3899827003479004  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.3899827003479004  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 865, 100]), torch.Size([1, 865, 100])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.390627384185791  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.41019296646118164  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 865, 100])
m.shape torch.Size([1172, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.41205406188964844  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.41205406188964844  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1172, 100]), torch.Size([1, 1172, 100])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.41292762756347656  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.4446868896484375  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1172, 100])
m.shape torch.Size([1268, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.4470844268798828  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.4470844268798828  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1268, 100]), torch.Size([1, 1268, 100])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.4480295181274414  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.48929405212402344  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1268, 100])
m.shape torch.Size([1484, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.4926915168762207  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.4926915168762207  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1484, 100]), torch.Size([1, 1484, 100])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.49379777908325195  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5492711067199707  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1484, 100])
m.shape torch.Size([1496, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5531764030456543  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5531764030456543  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1496, 100]), torch.Size([1, 1496, 100])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.5542912483215332  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.617825984954834  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1496, 100])
m.shape torch.Size([1566, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.6225190162658691  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.6225190162658691  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 1566, 100]), torch.Size([1, 1566, 100])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.6236863136291504  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.7003707885742188  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 1566, 100])
m.shape torch.Size([67805, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.9523806571960449  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 0.9523806571960449  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 67805, 100]), torch.Size([1, 67805, 100])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 1.0028996467590332  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.589733600616455  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 67805, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.318361282348633  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.391188621520996  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.464015960693359  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.391188621520996  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([76365, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.464015960693359  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.482223033905029  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.482223033905029  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.7243571281433105  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.7243571281433105  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.724362850189209  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.7244086265563965  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.724410057067871  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.724410057067871  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.724413871765137  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.724471092224121  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([12, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.724503993988037  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.724503993988037  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.724526882171631  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.725030422210693  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([24, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.725111484527588  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.725111484527588  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.725157260894775  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.726484775543213  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([28, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.726596832275391  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.726596832275391  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.726650238037109  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.728572845458984  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([39, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.728771209716797  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.728771209716797  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.728845596313477  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.732044219970703  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([61, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.732417583465576  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.732417583465576  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.732533931732178  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.738351345062256  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([49, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.738670349121094  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.738670349121094  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.738763809204102  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.744091033935547  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([66, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.74461555480957  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.74461555480957  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.744741439819336  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.752798080444336  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([101, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.753705978393555  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.753705978393555  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.753898620605469  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.767576217651367  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([95, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.76881217956543  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.76881217956543  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.768993377685547  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.7831268310546875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([73, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.783878326416016  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.783878326416016  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.784017562866211  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.7958526611328125  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.796545505523682  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.796545505523682  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.796661853790283  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.807365894317627  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([83, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.808652400970459  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.808652400970459  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.808810710906982  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.824483394622803  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([76, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.825992107391357  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.825992107391357  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.826137065887451  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.841502666473389  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([84, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.843137741088867  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.843137741088867  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.843297958374023  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.86140251159668  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([70, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.8630290031433105  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.8630290031433105  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.863162517547607  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.879184246063232  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([92, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.8808274269104  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.8808274269104  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.881002902984619  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.9032883644104  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([75, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.905014991760254  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.905014991760254  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.905158042907715  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.9243268966674805  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([57, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.926102638244629  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.926102638244629  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.926211357116699  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.941540718078613  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([84, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.943583965301514  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.943583965301514  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.94374418258667  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.967456340789795  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([89, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.969475269317627  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.969475269317627  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 15.5819091796875 GB
    Memory Allocated: 4.969645023345947  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.6033935546875 GB
    Memory Allocated: 4.995956897735596  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([81, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.6033935546875 GB
    Memory Allocated: 4.9979705810546875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.6033935546875 GB
    Memory Allocated: 4.9979705810546875  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 15.6033935546875 GB
    Memory Allocated: 4.998125076293945  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.6287841796875 GB
    Memory Allocated: 5.023153305053711  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([53, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.6287841796875 GB
    Memory Allocated: 5.025169849395752  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.6287841796875 GB
    Memory Allocated: 5.025169849395752  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 15.6287841796875 GB
    Memory Allocated: 5.025270938873291  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.6444091796875 GB
    Memory Allocated: 5.042355060577393  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([9197, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.6483154296875 GB
    Memory Allocated: 5.263662338256836  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.6483154296875 GB
    Memory Allocated: 5.263662338256836  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 9197, 256]), torch.Size([1, 9197, 256])
----------------------------------------3
 Nvidia-smi: 15.6483154296875 GB
    Memory Allocated: 5.2812042236328125  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.6483154296875 GB
    Memory Allocated: 8.368576049804688  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 9197, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.6483154296875 GB
    Memory Allocated: 8.129984378814697  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.6483154296875 GB
    Memory Allocated: 8.13197374343872  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.6483154296875 GB
    Memory Allocated: 8.133963108062744  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.6483154296875 GB
    Memory Allocated: 8.1318941116333  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([10655, 47])
input nodes number: 76365
output nodes number: 10655
edges number: 251489
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6483154296875 GB
    Memory Allocated: 8.132411479949951  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.6483154296875 GB
    Memory Allocated: 8.13241195678711  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.6502685546875 GB
    Memory Allocated: 0.10756301879882812  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

pseudo mini batch 10 input nodes size: 310631
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.6502685546875 GB
    Memory Allocated: 0.08703899383544922  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.6502685546875 GB
    Memory Allocated: 0.08703899383544922  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.6502685546875 GB
    Memory Allocated: 0.2027583122253418  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.6502685546875 GB
    Memory Allocated: 0.2028365135192871  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.6502685546875 GB
    Memory Allocated: 0.12287473678588867  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.6502685546875 GB
    Memory Allocated: 0.1324324607849121  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.6502685546875 GB
    Memory Allocated: 0.1324324607849121  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

first layer input nodes number: 310631
first layer output nodes number: 104101
edges number: 1025661
----------------------------------------before model layer 0
 Nvidia-smi: 15.6502685546875 GB
    Memory Allocated: 0.13552284240722656  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([310631, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.6502685546875 GB
    Memory Allocated: 0.13552284240722656  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

m.shape torch.Size([106, 1, 100])
----------------------------------------1
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5295538902282715  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5295538902282715  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 106, 100]), torch.Size([1, 106, 100])
----------------------------------------3
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5296330451965332  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.530266284942627  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 106, 100])
m.shape torch.Size([157, 2, 100])
----------------------------------------1
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5303440093994141  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5303440093994141  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 157, 100]), torch.Size([1, 157, 100])
----------------------------------------3
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.530461311340332  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5322179794311523  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 157, 100])
m.shape torch.Size([273, 3, 100])
----------------------------------------1
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5324645042419434  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5324645042419434  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 273, 100]), torch.Size([1, 273, 100])
----------------------------------------3
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5326685905456543  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5371499061584473  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 273, 100])
m.shape torch.Size([357, 4, 100])
----------------------------------------1
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5375800132751465  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5375800132751465  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 357, 100]), torch.Size([1, 357, 100])
----------------------------------------3
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5378460884094238  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5455622673034668  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 357, 100])
m.shape torch.Size([494, 5, 100])
----------------------------------------1
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5463495254516602  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5463495254516602  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 494, 100]), torch.Size([1, 494, 100])
----------------------------------------3
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.546717643737793  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5599699020385742  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 494, 100])
m.shape torch.Size([563, 6, 100])
----------------------------------------1
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5610446929931641  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5610446929931641  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 563, 100]), torch.Size([1, 563, 100])
----------------------------------------3
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5614643096923828  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5795078277587891  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 563, 100])
m.shape torch.Size([661, 7, 100])
----------------------------------------1
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5818037986755371  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5818037986755371  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 661, 100]), torch.Size([1, 661, 100])
----------------------------------------3
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.5822968482971191  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.6074357032775879  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 661, 100])
m.shape torch.Size([779, 8, 100])
----------------------------------------1
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.6095108985900879  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.6095108985900879  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 779, 100]), torch.Size([1, 779, 100])
----------------------------------------3
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.6100916862487793  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.6440339088439941  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 779, 100])
m.shape torch.Size([823, 9, 100])
----------------------------------------1
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.6465029716491699  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.6465029716491699  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 823, 100]), torch.Size([1, 823, 100])
----------------------------------------3
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.6471161842346191  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0330810546875 GB
    Memory Allocated: 0.6880784034729004  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 823, 100])
m.shape torch.Size([99888, 10, 100])
----------------------------------------1
 Nvidia-smi: 16.4061279296875 GB
    Memory Allocated: 1.0608186721801758  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4061279296875 GB
    Memory Allocated: 1.0608186721801758  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 99888, 100]), torch.Size([1, 99888, 100])
----------------------------------------3
 Nvidia-smi: 16.4061279296875 GB
    Memory Allocated: 1.1352415084838867  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.419234275817871  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 99888, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.036606788635254  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.135885238647461  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.235163688659668  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.135885238647461  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

torch.Size([104101, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.235163688659668  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.259983539581299  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.259983539581299  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.50747537612915  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.50747537612915  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.5074849128723145  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.507561206817627  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.507568359375  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.507568359375  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.507579803466797  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.50775146484375  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([16, 3, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.507791996002197  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.507791996002197  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.507822513580322  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.508493900299072  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([10, 4, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.508517265319824  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.508517265319824  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.508536338806152  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.509089469909668  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.509104251861572  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.509104251861572  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.509113788604736  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.509457111358643  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.50951623916626  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.50951623916626  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.509537220001221  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.510439395904541  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([19, 7, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.510557174682617  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.510557174682617  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.510593414306641  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.5124053955078125  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 8, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.512556552886963  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.512556552886963  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.512598514556885  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.514990329742432  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([14, 9, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.515090465545654  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.515090465545654  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.515117168426514  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.516826152801514  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 10, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.516966819763184  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.516966819763184  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.516997337341309  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.519164085388184  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 11, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.519350051879883  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.519350051879883  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.519386291503906  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.522212982177734  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 12, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.522449016571045  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.522449016571045  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.522490978240967  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.526057720184326  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([27, 13, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.526374340057373  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.526374340057373  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.526425838470459  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.531163692474365  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([28, 14, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.531515121459961  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.531515121459961  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.53156852722168  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.536855697631836  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 15, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.537189483642578  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.537189483642578  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.537237167358398  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.542291641235352  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([31, 16, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.5427446365356445  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.5427446365356445  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.542803764343262  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.549485206604004  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.549749851226807  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.549749851226807  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.549784183502197  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.553904056549072  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.554302215576172  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.554302215576172  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.554347991943359  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.560161590576172  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.560412883758545  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.560412883758545  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.560441493988037  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.56427526473999  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.56468391418457  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.56468391418457  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.564725875854492  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.570642471313477  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.571065902709961  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.571065902709961  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.571107864379883  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.57731819152832  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([16, 22, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.577635765075684  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.577635765075684  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.577666282653809  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.582396507263184  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([25, 23, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.5829339027404785  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.5829339027404785  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.582981586456299  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.5907063484191895  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.591097831726074  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.591097831726074  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.591132164001465  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.5969343185424805  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([10036, 25, 256])
----------------------------------------1
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.838717937469482  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.838717937469482  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

 h.shape torch.Size([1, 10036, 256]), torch.Size([1, 10036, 256])
----------------------------------------3
 Nvidia-smi: 18.5838623046875 GB
    Memory Allocated: 6.858249187469482  GigaBytes
Max Memory Allocated: 10.224487781524658  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.8240966796875 GB
    Memory Allocated: 10.268123149871826  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 10036, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 18.8240966796875 GB
    Memory Allocated: 10.023163795471191  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 18.8240966796875 GB
    Memory Allocated: 10.025014877319336  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 18.8240966796875 GB
    Memory Allocated: 10.02686595916748  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 18.8240966796875 GB
    Memory Allocated: 10.02493667602539  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

torch.Size([10472, 47])
input nodes number: 104101
output nodes number: 10472
edges number: 257062
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.8240966796875 GB
    Memory Allocated: 10.025652408599854  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.8240966796875 GB
    Memory Allocated: 10.025652885437012  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.1489543914794922  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

pseudo mini batch 11 input nodes size: 358679
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.12273645401000977  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.12273645401000977  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.25635480880737305  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.25643014907836914  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.14063262939453125  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.14943218231201172  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.14943218231201172  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

first layer input nodes number: 358679
first layer output nodes number: 95359
edges number: 939521
----------------------------------------before model layer 0
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.1528153419494629  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

torch.Size([358679, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.1528153419494629  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

m.shape torch.Size([146, 1, 100])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5127205848693848  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5127205848693848  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 146, 100]), torch.Size([1, 146, 100])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5128302574157715  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5137033462524414  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 146, 100])
m.shape torch.Size([195, 2, 100])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5137939453125  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5137939453125  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 195, 100]), torch.Size([1, 195, 100])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5139398574829102  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5161228179931641  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 195, 100])
m.shape torch.Size([281, 3, 100])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5163640975952148  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5163640975952148  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 281, 100]), torch.Size([1, 281, 100])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5165739059448242  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5211853981018066  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 281, 100])
m.shape torch.Size([346, 4, 100])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5215964317321777  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5215964317321777  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 346, 100]), torch.Size([1, 346, 100])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5218548774719238  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5293383598327637  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 346, 100])
m.shape torch.Size([397, 5, 100])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5299487113952637  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5299487113952637  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 397, 100]), torch.Size([1, 397, 100])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.530245304107666  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5409011840820312  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 397, 100])
m.shape torch.Size([453, 6, 100])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5419921875  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5419921875  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 453, 100]), torch.Size([1, 453, 100])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5423297882080078  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5568466186523438  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 453, 100])
m.shape torch.Size([542, 7, 100])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5590529441833496  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5590529441833496  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 542, 100]), torch.Size([1, 542, 100])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5594573020935059  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5796551704406738  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 542, 100])
m.shape torch.Size([567, 8, 100])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5811429023742676  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5811429023742676  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 567, 100]), torch.Size([1, 567, 100])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.5815653800964355  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.6056466102600098  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 567, 100])
m.shape torch.Size([595, 9, 100])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.6074304580688477  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.6074304580688477  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 595, 100]), torch.Size([1, 595, 100])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.6078739166259766  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.6362552642822266  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 595, 100])
m.shape torch.Size([91837, 10, 100])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.9781532287597656  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.9781532287597656  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 91837, 100]), torch.Size([1, 91837, 100])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 1.0465774536132812  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.9046831130981445  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 91837, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.5542097091674805  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.645151138305664  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.736092567443848  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.645151138305664  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

torch.Size([95359, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.736092567443848  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.758828163146973  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.758828163146973  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

m.shape torch.Size([13, 1, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.991203784942627  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.991203784942627  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.9912285804748535  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.991426944732666  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 2, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.9914398193359375  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.9914398193359375  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.991464614868164  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.9918365478515625  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.991844654083252  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.991844654083252  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.991858005523682  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.992151737213135  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([23, 4, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.992233753204346  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.992233753204346  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.9922776222229  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.993549823760986  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([21, 5, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.993628978729248  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.993628978729248  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.993669033050537  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.995110988616943  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.995154857635498  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.995154857635498  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.995175838470459  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.996078014373779  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([37, 7, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.996316909790039  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.996316909790039  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.996387481689453  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 5.999916076660156  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([26, 8, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.0000810623168945  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.0000810623168945  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.000130653381348  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.002957344055176  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([44, 9, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.0033135414123535  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.0033135414123535  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.003397464752197  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.008768558502197  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([21, 10, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.0089287757873535  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.0089287757873535  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.008968830108643  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.011812686920166  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([54, 11, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.012363910675049  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.012363910675049  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.012466907501221  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.020500659942627  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([54, 12, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.0210723876953125  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.0210723876953125  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.021175384521484  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.029930114746094  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([50, 13, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.030503749847412  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.030503749847412  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.030599117279053  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.03937292098999  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.039742469787598  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.039742469787598  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.039801597595215  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.045655250549316  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([120, 15, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.047356128692627  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.047356128692627  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.0475850105285645  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.0718464851379395  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.07248592376709  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.07248592376709  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.072579383850098  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.0831403732299805  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([51, 17, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.083927154541016  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.083927154541016  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.084024429321289  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.095697402954102  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.096323490142822  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.096323490142822  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.096397876739502  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.105844974517822  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([72, 19, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.107122898101807  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.107122898101807  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.107260227203369  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.125662326812744  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.126439571380615  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.126439571380615  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.126523494720459  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.138356685638428  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([53, 21, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.13960599899292  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.13960599899292  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.139707088470459  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.15466833114624  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([42, 22, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.155506134033203  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.155506134033203  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.155586242675781  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.168003082275391  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([61, 23, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.1702070236206055  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.1702070236206055  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.170323371887207  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.18917179107666  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([62, 24, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.190544128417969  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.190544128417969  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.190662384033203  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.2106475830078125  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([9052, 25, 256])
----------------------------------------1
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.428524017333984  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.428524017333984  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 9052, 256]), torch.Size([1, 9052, 256])
----------------------------------------3
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 6.445789337158203  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 9.484485626220703  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 9052, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 9.255061626434326  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 9.257327556610107  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 9.259593486785889  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 9.257252216339111  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

torch.Size([10050, 47])
input nodes number: 95359
output nodes number: 10050
edges number: 241351
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 9.258452892303467  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 9.258453369140625  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.16536235809326172  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

pseudo mini batch 12 input nodes size: 413982
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.14104747772216797  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.14104747772216797  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.29526805877685547  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.29534292221069336  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.16164922714233398  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.1713109016418457  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.1713109016418457  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

first layer input nodes number: 413982
first layer output nodes number: 106481
edges number: 1053781
----------------------------------------before model layer 0
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.17518901824951172  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

torch.Size([413982, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.0701904296875 GB
    Memory Allocated: 0.17518901824951172  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

m.shape torch.Size([110, 1, 100])
----------------------------------------1
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.5788407325744629  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.5788407325744629  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 110, 100]), torch.Size([1, 110, 100])
----------------------------------------3
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.5789227485656738  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.5795788764953613  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 110, 100])
m.shape torch.Size([166, 2, 100])
----------------------------------------1
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.5796618461608887  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.5796618461608887  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 166, 100]), torch.Size([1, 166, 100])
----------------------------------------3
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.5797858238220215  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.5816426277160645  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 166, 100])
m.shape torch.Size([249, 3, 100])
----------------------------------------1
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.5818591117858887  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.5818591117858887  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 249, 100]), torch.Size([1, 249, 100])
----------------------------------------3
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.5820450782775879  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.5861320495605469  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 249, 100])
m.shape torch.Size([267, 4, 100])
----------------------------------------1
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.5864372253417969  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.5864372253417969  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 267, 100]), torch.Size([1, 267, 100])
----------------------------------------3
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.5866365432739258  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.5924110412597656  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 267, 100])
m.shape torch.Size([297, 5, 100])
----------------------------------------1
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.592864990234375  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.592864990234375  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 297, 100]), torch.Size([1, 297, 100])
----------------------------------------3
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.5930871963500977  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.6010651588439941  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 297, 100])
m.shape torch.Size([330, 6, 100])
----------------------------------------1
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.601691722869873  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.601691722869873  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 330, 100]), torch.Size([1, 330, 100])
----------------------------------------3
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.6019377708435059  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.6125178337097168  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 330, 100])
m.shape torch.Size([413, 7, 100])
----------------------------------------1
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.6134719848632812  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.6134719848632812  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 413, 100]), torch.Size([1, 413, 100])
----------------------------------------3
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.6137800216674805  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.6291718482971191  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 413, 100])
m.shape torch.Size([430, 8, 100])
----------------------------------------1
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.6303439140319824  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.6303439140319824  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 430, 100]), torch.Size([1, 430, 100])
----------------------------------------3
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.6306643486022949  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.6489291191101074  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 430, 100])
m.shape torch.Size([462, 9, 100])
----------------------------------------1
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.6503181457519531  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.6503181457519531  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 462, 100]), torch.Size([1, 462, 100])
----------------------------------------3
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.6506624221801758  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.4647216796875 GB
    Memory Allocated: 0.6726961135864258  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 462, 100])
m.shape torch.Size([103757, 10, 100])
----------------------------------------1
 Nvidia-smi: 19.8514404296875 GB
    Memory Allocated: 1.0592427253723145  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8514404296875 GB
    Memory Allocated: 1.0592427253723145  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 103757, 100]), torch.Size([1, 103757, 100])
----------------------------------------3
 Nvidia-smi: 19.8514404296875 GB
    Memory Allocated: 1.1373677253723145  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.635047435760498  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 103757, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.240672588348389  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.342220783233643  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.4437689781188965  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.342220783233643  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

torch.Size([106481, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.4437689781188965  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.469156265258789  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.469156265258789  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.702989101409912  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.702989101409912  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.7029948234558105  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.703040599822998  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.703049659729004  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.703049659729004  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.703061103820801  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.703232765197754  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([32, 3, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.703319549560547  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.703319549560547  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.703380584716797  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.704723358154297  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 4, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.704827785491943  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.704827785491943  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.704894542694092  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.7068305015563965  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([12, 5, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.706854820251465  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.706854820251465  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.706877708435059  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.707701683044434  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([18, 6, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.707794189453125  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.707794189453125  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.707828521728516  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.7093048095703125  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([31, 7, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.70949649810791  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.70949649810791  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.709555625915527  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.712512016296387  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([16, 8, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.7126054763793945  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.7126054763793945  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.7126359939575195  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.7143754959106445  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([27, 9, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.714593887329102  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.714593887329102  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.7146453857421875  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.7179412841796875  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([36, 10, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.71826171875  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.71826171875  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.718330383300781  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.72320556640625  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([17, 11, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.723351001739502  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.723351001739502  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.72338342666626  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.725912570953369  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([41, 12, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.726369380950928  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.726369380950928  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.726447582244873  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.733094692230225  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([43, 13, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.733592987060547  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.733592987060547  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.733675003051758  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.741220474243164  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.741852283477783  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.741852283477783  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.741947650909424  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.751389026641846  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([52, 15, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.752091407775879  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.752091407775879  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.752190589904785  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.762703895568848  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.7630696296691895  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.7630696296691895  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.763121128082275  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.768940448760986  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.7693562507629395  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.7693562507629395  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.769407749176025  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.775587558746338  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([52, 18, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.776461601257324  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.776461601257324  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.7765607833862305  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.789156913757324  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.789783000946045  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.789783000946045  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.789853572845459  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.799310207366943  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([64, 20, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.800924301147461  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.800924301147461  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.801046371459961  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.818258285522461  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([56, 21, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.819846153259277  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.819846153259277  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.819952964782715  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.835761070251465  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([54, 22, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.8373565673828125  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.8373565673828125  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.837459564208984  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.853424072265625  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([48, 23, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.855020999908447  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.855020999908447  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.855112552642822  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.869944095611572  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([61, 24, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.871549129486084  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.871549129486084  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.8716654777526855  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 6.89132833480835  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([9202, 25, 256])
----------------------------------------1
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 7.112619400024414  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 7.112619400024414  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 9202, 256]), torch.Size([1, 9202, 256])
----------------------------------------3
 Nvidia-smi: 21.0194091796875 GB
    Memory Allocated: 7.130170822143555  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.2401123046875 GB
    Memory Allocated: 10.219221115112305  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 9202, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.2401123046875 GB
    Memory Allocated: 9.988194942474365  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.2401123046875 GB
    Memory Allocated: 9.990162372589111  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 21.2401123046875 GB
    Memory Allocated: 9.99214220046997  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 21.2401123046875 GB
    Memory Allocated: 9.990099906921387  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

torch.Size([10047, 47])
input nodes number: 106481
output nodes number: 10047
edges number: 242877
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.2401123046875 GB
    Memory Allocated: 9.99066972732544  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.2401123046875 GB
    Memory Allocated: 9.990670204162598  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.18806171417236328  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

pseudo mini batch 13 input nodes size: 351838
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.16135072708129883  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.16135072708129883  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.2924208641052246  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.2924962043762207  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.1382007598876953  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.14679241180419922  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.14679241180419922  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

first layer input nodes number: 351838
first layer output nodes number: 95058
edges number: 931049
----------------------------------------before model layer 0
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.15012264251708984  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

torch.Size([351838, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.15012264251708984  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

m.shape torch.Size([162, 1, 100])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5072379112243652  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5072379112243652  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 162, 100]), torch.Size([1, 162, 100])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5073590278625488  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.508326530456543  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 162, 100])
m.shape torch.Size([274, 2, 100])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5084705352783203  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5084705352783203  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 274, 100]), torch.Size([1, 274, 100])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5086755752563477  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5117425918579102  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 274, 100])
m.shape torch.Size([427, 3, 100])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5121173858642578  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5121173858642578  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 427, 100]), torch.Size([1, 427, 100])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5124359130859375  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5194392204284668  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 427, 100])
m.shape torch.Size([520, 4, 100])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.520054817199707  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.520054817199707  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 520, 100]), torch.Size([1, 520, 100])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5204429626464844  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.531682014465332  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 520, 100])
m.shape torch.Size([585, 5, 100])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5325779914855957  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5325779914855957  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 585, 100]), torch.Size([1, 585, 100])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5330147743225098  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5487174987792969  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 585, 100])
m.shape torch.Size([640, 6, 100])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5499296188354492  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5499296188354492  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 640, 100]), torch.Size([1, 640, 100])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5504064559936523  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5709104537963867  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 640, 100])
m.shape torch.Size([760, 7, 100])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5726542472839355  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5726542472839355  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 760, 100]), torch.Size([1, 760, 100])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.5732207298278809  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.601844310760498  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 760, 100])
m.shape torch.Size([677, 8, 100])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.603579044342041  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.603579044342041  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 677, 100]), torch.Size([1, 677, 100])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.6040835380554199  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.6332001686096191  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 677, 100])
m.shape torch.Size([653, 9, 100])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.6351375579833984  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.6351375579833984  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 653, 100]), torch.Size([1, 653, 100])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.635624885559082  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 0.6667752265930176  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 653, 100])
m.shape torch.Size([90360, 10, 100])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 1.0031490325927734  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 1.0031490325927734  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 90360, 100]), torch.Size([1, 90360, 100])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 1.0704727172851562  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.85044002532959  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 90360, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.503567695617676  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.594222068786621  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.684876441955566  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.594222068786621  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

torch.Size([95058, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.684876441955566  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.707633972167969  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.707633972167969  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

m.shape torch.Size([17, 1, 256])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.921477317810059  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.921477317810059  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.921509742736816  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.921769142150879  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([30, 2, 256])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.921810626983643  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.921810626983643  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.921867847442627  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.922726154327393  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([115, 3, 256])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.92302942276001  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.92302942276001  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.923248767852783  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.928074359893799  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([120, 4, 256])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.928426265716553  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.928426265716553  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 120, 256]), torch.Size([1, 120, 256])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.92865514755249  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.935292720794678  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 120, 256])
m.shape torch.Size([122, 5, 256])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.935764789581299  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.935764789581299  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.935997486114502  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.9443745613098145  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([172, 6, 256])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.945250511169434  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.945250511169434  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.945578575134277  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.959685325622559  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([205, 7, 256])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.960900783538818  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.960900783538818  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.961291790008545  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.980842113494873  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([94, 8, 256])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.981369495391846  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.981369495391846  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.98154878616333  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.9917683601379395  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.992569923400879  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.992569923400879  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 5.992766380310059  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.005339622497559  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([157, 10, 256])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.006750583648682  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.006750583648682  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 157, 256]), torch.Size([1, 157, 256])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.007050037384033  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.028311252593994  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 157, 256])
m.shape torch.Size([118, 11, 256])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.029469013214111  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.029469013214111  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.029694080352783  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.0472493171691895  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([85, 12, 256])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.048117160797119  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.048117160797119  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.048279285430908  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.0620598793029785  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([78, 13, 256])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.062953472137451  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.062953472137451  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.0631022453308105  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.076789379119873  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([167, 14, 256])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.078962326049805  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.078962326049805  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.079280853271484  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.110815048217773  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([68, 15, 256])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.111636161804199  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.111636161804199  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.1117658615112305  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.125514030456543  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([100, 16, 256])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.1276140213012695  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.1276140213012695  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.127804756164551  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.149357795715332  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([49, 17, 256])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.150063514709473  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.150063514709473  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.1501569747924805  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.161372184753418  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([82, 18, 256])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.162744522094727  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.162744522094727  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.162900924682617  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.182764053344727  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.183160781860352  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.183160781860352  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.183210372924805  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.189855575561523  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([65, 20, 256])
----------------------------------------1
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.191604137420654  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.191604137420654  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 21.4725341796875 GB
    Memory Allocated: 6.191728115081787  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4901123046875 GB
    Memory Allocated: 6.209208965301514  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 21.4901123046875 GB
    Memory Allocated: 6.209934234619141  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4901123046875 GB
    Memory Allocated: 6.209934234619141  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 21.4901123046875 GB
    Memory Allocated: 6.21000862121582  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5018310546875 GB
    Memory Allocated: 6.221017837524414  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([46, 22, 256])
----------------------------------------1
 Nvidia-smi: 21.5018310546875 GB
    Memory Allocated: 6.221953392028809  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5018310546875 GB
    Memory Allocated: 6.221953392028809  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 21.5018310546875 GB
    Memory Allocated: 6.222041130065918  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5155029296875 GB
    Memory Allocated: 6.235640525817871  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([66, 23, 256])
----------------------------------------1
 Nvidia-smi: 21.5155029296875 GB
    Memory Allocated: 6.237055778503418  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5155029296875 GB
    Memory Allocated: 6.237055778503418  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 21.5155029296875 GB
    Memory Allocated: 6.237181663513184  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5350341796875 GB
    Memory Allocated: 6.257575035095215  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([80, 24, 256])
----------------------------------------1
 Nvidia-smi: 21.5350341796875 GB
    Memory Allocated: 6.259357452392578  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5350341796875 GB
    Memory Allocated: 6.259357452392578  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 21.5350341796875 GB
    Memory Allocated: 6.259510040283203  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5623779296875 GB
    Memory Allocated: 6.285297393798828  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([7887, 25, 256])
----------------------------------------1
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 6.475383758544922  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 6.475383758544922  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 7887, 256]), torch.Size([1, 7887, 256])
----------------------------------------3
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 6.490427017211914  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 9.138040542602539  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 7887, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 8.928680419921875  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 8.931043148040771  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 8.933405876159668  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 8.930967807769775  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

torch.Size([10091, 47])
input nodes number: 95058
output nodes number: 10091
edges number: 222065
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 8.932147026062012  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 8.93214750289917  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 0.16272830963134766  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

pseudo mini batch 14 input nodes size: 317337
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 0.1385960578918457  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 0.1385960578918457  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 0.25681352615356445  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 0.2568931579589844  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 0.1257476806640625  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 0.13567638397216797  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 0.13567638397216797  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

first layer input nodes number: 317337
first layer output nodes number: 107767
edges number: 1067725
----------------------------------------before model layer 0
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 0.13884401321411133  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

torch.Size([317337, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.5662841796875 GB
    Memory Allocated: 0.13884401321411133  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

m.shape torch.Size([124, 1, 100])
----------------------------------------1
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5485000610351562  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5485000610351562  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 124, 100]), torch.Size([1, 124, 100])
----------------------------------------3
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5485925674438477  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5493326187133789  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 124, 100])
m.shape torch.Size([153, 2, 100])
----------------------------------------1
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.549400806427002  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.549400806427002  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 153, 100]), torch.Size([1, 153, 100])
----------------------------------------3
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5495152473449707  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5512290000915527  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 153, 100])
m.shape torch.Size([184, 3, 100])
----------------------------------------1
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5513777732849121  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5513777732849121  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 184, 100]), torch.Size([1, 184, 100])
----------------------------------------3
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5515151023864746  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5545320510864258  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 184, 100])
m.shape torch.Size([239, 4, 100])
----------------------------------------1
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5548195838928223  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5548195838928223  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 239, 100]), torch.Size([1, 239, 100])
----------------------------------------3
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5549979209899902  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5601639747619629  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 239, 100])
m.shape torch.Size([288, 5, 100])
----------------------------------------1
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5606112480163574  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5606112480163574  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 288, 100]), torch.Size([1, 288, 100])
----------------------------------------3
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5608258247375488  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5685505867004395  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 288, 100])
m.shape torch.Size([303, 6, 100])
----------------------------------------1
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5691208839416504  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5691208839416504  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 303, 100]), torch.Size([1, 303, 100])
----------------------------------------3
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5693469047546387  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5790572166442871  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 303, 100])
m.shape torch.Size([345, 7, 100])
----------------------------------------1
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5798439979553223  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5798439979553223  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 345, 100]), torch.Size([1, 345, 100])
----------------------------------------3
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.580101490020752  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5929660797119141  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 345, 100])
m.shape torch.Size([381, 8, 100])
----------------------------------------1
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5939731597900391  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5939731597900391  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 381, 100]), torch.Size([1, 381, 100])
----------------------------------------3
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.5942573547363281  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.6104450225830078  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 381, 100])
m.shape torch.Size([434, 9, 100])
----------------------------------------1
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.6124272346496582  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.6124272346496582  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 434, 100]), torch.Size([1, 434, 100])
----------------------------------------3
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.6127514839172363  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 0.6334648132324219  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 434, 100])
m.shape torch.Size([105316, 10, 100])
----------------------------------------1
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 1.0258808135986328  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 1.0258808135986328  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 105316, 100]), torch.Size([1, 105316, 100])
----------------------------------------3
 Nvidia-smi: 21.9647216796875 GB
    Memory Allocated: 1.1043481826782227  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.675488471984863  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 105316, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.275949478149414  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.379465103149414  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.482980728149414  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.379465103149414  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

torch.Size([107767, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.482980728149414  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.508674621582031  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.508674621582031  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.764134407043457  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.764134407043457  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.764138221740723  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.764222145080566  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.764235973358154  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.764235973358154  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.7642436027526855  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.764464855194092  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.764490127563477  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.764490127563477  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.764501571655273  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.764913558959961  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.764936923980713  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.764936923980713  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.764946460723877  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.765356540679932  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.765378952026367  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.765378952026367  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.765386581420898  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.765768051147461  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.765787601470947  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.765787601470947  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.765793323516846  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.766119480133057  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([13, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.766229152679443  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.766229152679443  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.76625394821167  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.76784086227417  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([5, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.767876625061035  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.767876625061035  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.767886161804199  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.768563270568848  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.768632888793945  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.768632888793945  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.768646240234375  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.769687652587891  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.769750595092773  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.769750595092773  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.76976203918457  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.770734786987305  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.770804405212402  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.770804405212402  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.770815849304199  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.771868705749512  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.77191686630249  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.77191686630249  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.7719244956970215  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.772679805755615  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([11, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.772834777832031  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.772834777832031  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.772855758666992  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.775079727172852  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.775300025939941  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.775300025939941  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.775328636169434  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.778561592102051  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.778710842132568  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.778710842132568  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.7787299156188965  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.7810187339782715  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.781182289123535  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.781182289123535  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.781201362609863  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.783623695373535  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.783815383911133  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.783815383911133  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.783836364746094  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.786647796630859  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.786868095397949  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.786868095397949  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.786890983581543  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.790118217468262  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.790349006652832  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.790349006652832  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.790371894836426  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.793759346008301  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.793980598449707  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.793980598449707  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.794001579284668  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.797253608703613  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.797619342803955  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.797619342803955  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.797651767730713  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.8029046058654785  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.803142547607422  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.803142547607422  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.803163528442383  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.806709289550781  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10471, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 7.058319568634033  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 7.058319568634033  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

 h.shape torch.Size([1, 10471, 256]), torch.Size([1, 10471, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 7.078291416168213  GigaBytes
Max Memory Allocated: 10.508357524871826  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 10.593336582183838  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 10471, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 10.340836524963379  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 10.342730522155762  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 10.34459638595581  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 10.342622756958008  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

torch.Size([10656, 47])
input nodes number: 107767
output nodes number: 10656
edges number: 264712
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 10.343036651611328  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 10.343037128448486  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.15327072143554688  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

pseudo mini batch 15 input nodes size: 308960
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.12527894973754883  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.12527894973754883  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.24037551879882812  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.24045467376708984  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.12215757369995117  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.13148927688598633  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.13148927688598633  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

first layer input nodes number: 308960
first layer output nodes number: 100142
edges number: 989252
----------------------------------------before model layer 0
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.1345376968383789  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

torch.Size([308960, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.1345376968383789  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

m.shape torch.Size([142, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5143160820007324  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5143160820007324  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 142, 100]), torch.Size([1, 142, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5144219398498535  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5152688026428223  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 142, 100])
m.shape torch.Size([202, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5153665542602539  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5153665542602539  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 202, 100]), torch.Size([1, 202, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5155172348022461  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5177774429321289  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 202, 100])
m.shape torch.Size([210, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.517937183380127  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.517937183380127  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 210, 100]), torch.Size([1, 210, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.518094539642334  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5215435028076172  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 210, 100])
m.shape torch.Size([294, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5219030380249023  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5219030380249023  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 294, 100]), torch.Size([1, 294, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5221223831176758  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.528477668762207  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 294, 100])
m.shape torch.Size([355, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.529029369354248  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.529029369354248  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 355, 100]), torch.Size([1, 355, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.529294490814209  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5388245582580566  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 355, 100])
m.shape torch.Size([425, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.539642333984375  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.539642333984375  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 425, 100]), torch.Size([1, 425, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5399599075317383  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5535898208618164  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 425, 100])
m.shape torch.Size([398, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.554469108581543  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.554469108581543  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 398, 100]), torch.Size([1, 398, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5547657012939453  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5695953369140625  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 398, 100])
m.shape torch.Size([444, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.570770263671875  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.570770263671875  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 444, 100]), torch.Size([1, 444, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.571101188659668  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5899639129638672  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 444, 100])
m.shape torch.Size([483, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.591649055480957  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.591649055480957  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 483, 100]), torch.Size([1, 483, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5920095443725586  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.6150550842285156  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 483, 100])
m.shape torch.Size([97189, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.9769325256347656  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.9769325256347656  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 97189, 100]), torch.Size([1, 97189, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 1.0493440628051758  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.190563201904297  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 97189, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 5.821262359619141  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 5.916765213012695  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.01226806640625  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 5.916765213012695  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

torch.Size([100142, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.01226806640625  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.036143779754639  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.036143779754639  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.291013240814209  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.291013240814209  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.291015148162842  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.291030406951904  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.291033744812012  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.291033744812012  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.291037559509277  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.291094779968262  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.291107654571533  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.291107654571533  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.291117191314697  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.291326999664307  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.29133415222168  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.29133415222168  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.291339874267578  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.291505813598633  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([10, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.291551113128662  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.291551113128662  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.29157018661499  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.292256832122803  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.292253494262695  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.292253494262695  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.292255401611328  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.292337417602539  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([11, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.292410850524902  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.292410850524902  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.292431831359863  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.29348087310791  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.293547630310059  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.293547630310059  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.293566703796387  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.29465389251709  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.294739723205566  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.294739723205566  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.294760704040527  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.296103477478027  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.296237468719482  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.296237468719482  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.296266078948975  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.29829740524292  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([8, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.298367977142334  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.298367977142334  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.2983832359313965  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.2995734214782715  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.2996697425842285  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.2996697425842285  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.299686908721924  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.301146030426025  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.301225185394287  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.301225185394287  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.301238536834717  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.302466869354248  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.302595138549805  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.302595138549805  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.302614212036133  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.304502487182617  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.304651737213135  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.304651737213135  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.304672718048096  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.306896686553955  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.307070732116699  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.307070732116699  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.307093620300293  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.309679985046387  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.309848308563232  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.309848308563232  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.309869289398193  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.312386989593506  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.312670707702637  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.312670707702637  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.3127031326293945  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.316821098327637  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.317024230957031  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.317024230957031  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.317047119140625  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.3201141357421875  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.320448875427246  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.320448875427246  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.320483207702637  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.325324058532715  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.325549125671387  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.325549125671387  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.3255720138549805  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.3289594650268555  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.329307556152344  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.329307556152344  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.329339981079102  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.3343658447265625  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.334615230560303  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.334615230560303  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.3346381187438965  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.338346004486084  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.338773250579834  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.338773250579834  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.338809490203857  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.344933986663818  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([10376, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.595155715942383  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.595155715942383  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 10376, 256]), torch.Size([1, 10376, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.614946365356445  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 10.098100662231445  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 10376, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 9.847176551818848  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 9.849038124084473  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 9.85135555267334  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 9.849414825439453  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

torch.Size([10620, 47])
input nodes number: 100142
output nodes number: 10620
edges number: 263117
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 9.850207805633545  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 9.850208282470703  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.1506791114807129  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

pseudo mini batch 16 input nodes size: 270387
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.12212514877319336  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.12212514877319336  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.22285223007202148  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.2229313850402832  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.10775566101074219  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.11788272857666016  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.11788272857666016  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

first layer input nodes number: 270387
first layer output nodes number: 99310
edges number: 984859
----------------------------------------before model layer 0
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.12063741683959961  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

torch.Size([270387, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.12063741683959961  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

m.shape torch.Size([92, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.4981675148010254  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.4981675148010254  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 92, 100]), torch.Size([1, 92, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.49823617935180664  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.49878549575805664  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 92, 100])
m.shape torch.Size([137, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.4988536834716797  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.4988536834716797  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 137, 100]), torch.Size([1, 137, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.49895668029785156  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.500493049621582  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 137, 100])
m.shape torch.Size([156, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5006160736083984  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5006160736083984  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 156, 100]), torch.Size([1, 156, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.500732421875  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5032920837402344  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 156, 100])
m.shape torch.Size([193, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5035219192504883  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5035219192504883  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 193, 100]), torch.Size([1, 193, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5036659240722656  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5078420639038086  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 193, 100])
m.shape torch.Size([231, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5082006454467773  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5082006454467773  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 231, 100]), torch.Size([1, 231, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5083732604980469  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5145730972290039  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 231, 100])
m.shape torch.Size([258, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5150637626647949  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5150637626647949  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 258, 100]), torch.Size([1, 258, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.515256404876709  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.523531436920166  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 258, 100])
m.shape torch.Size([285, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5241785049438477  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5241785049438477  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 285, 100]), torch.Size([1, 285, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5243911743164062  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5350146293640137  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 285, 100])
m.shape torch.Size([348, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5359454154968262  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5359454154968262  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 348, 100]), torch.Size([1, 348, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5362048149108887  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5509905815124512  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 348, 100])
m.shape torch.Size([329, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5526633262634277  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5526633262634277  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 329, 100]), torch.Size([1, 329, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5529093742370605  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5686178207397461  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 329, 100])
m.shape torch.Size([97281, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.9308948516845703  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.9308948516845703  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 97281, 100]), torch.Size([1, 97281, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 1.0033750534057617  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.149469375610352  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 97281, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 5.7811760902404785  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 5.876450061798096  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 5.9711594581604  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 5.875885486602783  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

torch.Size([99310, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 5.9711594581604  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 5.994928359985352  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 5.994928359985352  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.248875617980957  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.248875617980957  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.24887752532959  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.248892784118652  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.24889612197876  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.24889612197876  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.248899936676025  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.24895715713501  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.248958587646484  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.248958587646484  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.248960494995117  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.249002456665039  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.249009609222412  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.249009609222412  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.249013423919678  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.249124050140381  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.249128341674805  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.249128341674805  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.2491302490234375  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.249212265014648  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.249218463897705  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.249218463897705  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.249220371246338  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.2493157386779785  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.249322891235352  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.249322891235352  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.249324798583984  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.249433517456055  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.2494587898254395  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.2494587898254395  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.249464511871338  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.249830722808838  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.249859809875488  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.249859809875488  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.249865531921387  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.250311851501465  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([10, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.250424385070801  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.250424385070801  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.250443458557129  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.2520647048950195  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([2, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.25208044052124  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.25208044052124  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.252084255218506  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.252435207366943  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.252514362335205  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.252514362335205  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.252525806427002  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.253658771514893  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.253696441650391  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.253696441650391  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.253702163696289  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.254308700561523  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.25435209274292  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.25435209274292  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.254357814788818  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.255004405975342  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.25501823425293  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.25501823425293  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.2550201416015625  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.2552490234375  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.255282878875732  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.255282878875732  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.255286693572998  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.255771160125732  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.255878925323486  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.255878925323486  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.255890369415283  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.2574238777160645  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([1, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.257437705993652  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.257437705993652  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.257439613342285  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.257708549499512  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.257808685302734  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.257808685302734  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.257818222045898  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.25922966003418  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.259309768676758  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.259309768676758  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.259317398071289  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.260499954223633  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.26060676574707  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.26060676574707  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.260616302490234  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.2621612548828125  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.262640953063965  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.262640953063965  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.262681007385254  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.2694501876831055  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([10490, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.5220489501953125  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.5220489501953125  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 10490, 256]), torch.Size([1, 10490, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.542057037353516  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 10.063480377197266  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 10490, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 9.81187915802002  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 9.813878059387207  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 9.816700458526611  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 9.814622402191162  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

torch.Size([10574, 47])
input nodes number: 99310
output nodes number: 10574
edges number: 263669
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 9.815578937530518  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 9.815579414367676  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.13384532928466797  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

pseudo mini batch 17 input nodes size: 275211
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.10789299011230469  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.10789299011230469  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.2104172706604004  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.21049261093139648  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.10968637466430664  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.11902761459350586  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.11902761459350586  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

first layer input nodes number: 275211
first layer output nodes number: 101328
edges number: 1002963
----------------------------------------before model layer 0
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.12183380126953125  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

torch.Size([275211, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.12183380126953125  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

m.shape torch.Size([132, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5060186386108398  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5060186386108398  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 132, 100]), torch.Size([1, 132, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5061178207397461  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5069069862365723  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 132, 100])
m.shape torch.Size([162, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5069785118103027  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5069785118103027  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 162, 100]), torch.Size([1, 162, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5070996284484863  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.508913516998291  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 162, 100])
m.shape torch.Size([205, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5090823173522949  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5090823173522949  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 205, 100]), torch.Size([1, 205, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5092358589172363  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5126008987426758  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 205, 100])
m.shape torch.Size([229, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5128655433654785  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5128655433654785  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 229, 100]), torch.Size([1, 229, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5130362510681152  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5179867744445801  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 229, 100])
m.shape torch.Size([267, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5183987617492676  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5183987617492676  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 267, 100]), torch.Size([1, 267, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5185980796813965  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5257663726806641  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 267, 100])
m.shape torch.Size([326, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5263957977294922  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5263957977294922  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 326, 100]), torch.Size([1, 326, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5266389846801758  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5370874404907227  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 326, 100])
m.shape torch.Size([374, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5379414558410645  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5379414558410645  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 374, 100]), torch.Size([1, 374, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5382208824157715  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5521621704101562  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 374, 100])
m.shape torch.Size([390, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5537290573120117  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5537290573120117  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 390, 100]), torch.Size([1, 390, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5540199279785156  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5705881118774414  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 390, 100])
m.shape torch.Size([483, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5720624923706055  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5720624923706055  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 483, 100]), torch.Size([1, 483, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.572422981262207  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5954685211181641  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 483, 100])
m.shape torch.Size([98760, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.963198184967041  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.963198184967041  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 98760, 100]), torch.Size([1, 98760, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 1.036780834197998  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.261106014251709  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 98760, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 5.886530876159668  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 5.9831647872924805  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.079798698425293  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 5.9831647872924805  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

torch.Size([101328, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.079798698425293  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.103957176208496  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.103957176208496  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345266819000244  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345266819000244  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345268726348877  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.3452839851379395  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345294952392578  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345294952392578  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345302581787109  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345470428466797  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345470905303955  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345470905303955  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345472812652588  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.3455281257629395  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345532417297363  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345532417297363  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345534324645996  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345602989196777  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345608234405518  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345608234405518  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.34561014175415  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345692157745361  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345705032348633  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345705032348633  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345708847045898  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.34589958190918  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345913410186768  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345913410186768  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.345917224884033  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.346134662628174  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.3461761474609375  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.3461761474609375  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.346185684204102  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.346796035766602  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.346810817718506  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.346810817718506  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.3468146324157715  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.347085475921631  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.347115516662598  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.347115516662598  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.347121238708496  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.347567558288574  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.34757661819458  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.34757661819458  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.347578525543213  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.347740650177002  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([6, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.347815036773682  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.347815036773682  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.3478264808654785  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.348879337310791  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.34891414642334  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.34891414642334  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.348919868469238  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.349486351013184  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.349526882171631  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.349526882171631  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.349532604217529  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.350139141082764  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.350197792053223  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.350197792053223  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.350205421447754  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.351067543029785  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.3511457443237305  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.3511457443237305  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.3511552810668945  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.352299690246582  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.352364540100098  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.352364540100098  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.352372169494629  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.353341102600098  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.353611469268799  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.353611469268799  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.353640079498291  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.357473850250244  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.3575944900512695  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.3575944900512695  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.357607841491699  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.359490394592285  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.359564781188965  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.359564781188965  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.359572410583496  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.360701560974121  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.360846042633057  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.360846042633057  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.360859394073486  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.362928867340088  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.363121509552002  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.363121509552002  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.363138675689697  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.365919589996338  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.366026401519775  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.366026401519775  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.3660359382629395  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.367647647857666  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9964, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.607474327087402  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.607474327087402  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 9964, 256]), torch.Size([1, 9964, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.627005577087402  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 9.98343563079834  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 9964, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 9.744274616241455  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 9.746545791625977  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 9.748816967010498  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 9.74647045135498  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

torch.Size([10059, 47])
input nodes number: 101328
output nodes number: 10059
edges number: 250644
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 9.747573375701904  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 9.747573852539062  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.13493919372558594  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

pseudo mini batch 18 input nodes size: 340436
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.10995864868164062  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.10995864868164062  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.23678112030029297  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.2368607521057129  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.1342611312866211  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.1441936492919922  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.1441936492919922  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

first layer input nodes number: 340436
first layer output nodes number: 107933
edges number: 1068421
----------------------------------------before model layer 0
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.14753484725952148  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

torch.Size([340436, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.14753484725952148  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

m.shape torch.Size([128, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5572032928466797  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5572032928466797  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 128, 100]), torch.Size([1, 128, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5572986602783203  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5580615997314453  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 128, 100])
m.shape torch.Size([189, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5581550598144531  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5581550598144531  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 189, 100]), torch.Size([1, 189, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5582962036132812  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5604104995727539  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 189, 100])
m.shape torch.Size([212, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5605769157409668  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5605769157409668  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 212, 100]), torch.Size([1, 212, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5607352256774902  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.564213752746582  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 212, 100])
m.shape torch.Size([224, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5644683837890625  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5644683837890625  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 224, 100]), torch.Size([1, 224, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5646352767944336  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5694751739501953  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 224, 100])
m.shape torch.Size([317, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5699825286865234  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5699825286865234  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 317, 100]), torch.Size([1, 317, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5702190399169922  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5787262916564941  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 317, 100])
m.shape torch.Size([312, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5793056488037109  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5793056488037109  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 312, 100]), torch.Size([1, 312, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5795383453369141  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5895357131958008  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 312, 100])
m.shape torch.Size([409, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5906782150268555  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5906782150268555  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 409, 100]), torch.Size([1, 409, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.5909833908081055  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.6062321662902832  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 409, 100])
m.shape torch.Size([424, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.6073431968688965  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.6073431968688965  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 424, 100]), torch.Size([1, 424, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.6076598167419434  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.6256728172302246  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 424, 100])
m.shape torch.Size([509, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.6272211074829102  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.6272211074829102  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 509, 100]), torch.Size([1, 509, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.6276006698608398  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.6518797874450684  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 509, 100])
m.shape torch.Size([105209, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 1.0442681312561035  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 1.0442681312561035  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 105209, 100]), torch.Size([1, 105209, 100])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 1.1226553916931152  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.688136577606201  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 105209, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.288697242736816  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.392212867736816  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.495728492736816  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.392212867736816  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

torch.Size([107933, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.495728492736816  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.5214619636535645  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.5214619636535645  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.7767653465271  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.7767653465271  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.776782512664795  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.777040004730225  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.777063369750977  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.777063369750977  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.7770843505859375  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.777545928955078  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.777559757232666  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.777559757232666  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.77756929397583  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.777912616729736  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([12, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.777977466583252  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.777977466583252  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.778000354766846  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.778984546661377  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.778980255126953  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.778980255126953  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.778982162475586  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.779077529907227  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.779115200042725  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.779115200042725  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.779124736785889  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.77966833114624  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.7797417640686035  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.7797417640686035  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.779758930206299  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.780857563018799  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.7808685302734375  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.7808685302734375  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.780872344970703  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.7811431884765625  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.781162738800049  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.781162738800049  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.7811665534973145  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.781464099884033  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([19, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.781681537628174  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.781681537628174  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.781717777252197  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.7847981452941895  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.784992694854736  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.784992694854736  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.785025119781494  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.788008213043213  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([3, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.788032531738281  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.788032531738281  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.78803825378418  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.788604736328125  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.788645267486572  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.788645267486572  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.788650989532471  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.789257526397705  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.789270401000977  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.789270401000977  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.789272308349609  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.789487838745117  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([6, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.789585113525391  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.789585113525391  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.7895965576171875  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.7909698486328125  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.791033744812012  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.791033744812012  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.791041374206543  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.792010307312012  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.792189121246338  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.792189121246338  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.792208194732666  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.794764041900635  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.794889450073242  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.794889450073242  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.794902801513672  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.796785354614258  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.79702091217041  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.79702091217041  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.797043800354004  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.800431251525879  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.800568103790283  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.800568103790283  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.800581455230713  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.8026509284973145  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.802931785583496  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.802931785583496  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.802956581115723  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.806973457336426  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.8072381019592285  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.8072381019592285  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.807260990142822  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 6.811129093170166  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10486, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 7.063076972961426  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 7.063076972961426  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

 h.shape torch.Size([1, 10486, 256]), torch.Size([1, 10486, 256])
----------------------------------------3
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 7.083077430725098  GigaBytes
Max Memory Allocated: 10.842984676361084  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 10.603767395019531  GigaBytes
Max Memory Allocated: 10.85377311706543  GigaBytes

rst.shape  torch.Size([1, 10486, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 10.351438999176025  GigaBytes
Max Memory Allocated: 10.85377311706543  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 10.353573322296143  GigaBytes
Max Memory Allocated: 10.85377311706543  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 10.35606575012207  GigaBytes
Max Memory Allocated: 10.85377311706543  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 10.353851795196533  GigaBytes
Max Memory Allocated: 10.85377311706543  GigaBytes

torch.Size([10656, 47])
input nodes number: 107933
output nodes number: 10656
edges number: 264517
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 10.354598999023438  GigaBytes
Max Memory Allocated: 10.85377311706543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 10.354599475860596  GigaBytes
Max Memory Allocated: 10.85377311706543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.16165542602539062  GigaBytes
Max Memory Allocated: 10.85377311706543  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.16674232482910156  GigaBytes
Max Memory Allocated: 10.85377311706543  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.3572998046875 GB
    Memory Allocated: 0.16674232482910156  GigaBytes
Max Memory Allocated: 10.85377311706543  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08294567308927837 |0.02352510000530042 |0.20175283833553917 |9.437611228541325e-05 |0.10077512891669023 |0.0052258968353271484 |
----------------------------------------------------------pseudo_mini_loss sum 5.385530471801758
Total (block generation + training)time/epoch 81.79190587997437
* Pure training time/epoch 7.7779951095581055
Training time/epoch 7.901417016983032
Training time without block to device /epoch 7.454440116882324
Training time without total dataloading part /epoch 5.755050420761108
load block tensor time/epoch 1.575967788696289
block to device time/epoch 0.446976900100708
input features size transfer per epoch 2.5480985641479492e-06
blocks size to device per epoch 1.6987323760986328e-06
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  7249542
Number of first layer input nodes during this epoch:  5473319
Number of first layer output nodes during this epoch:  1776223
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  682400
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([400, 100])
layers.0.lstm.weight_hh_l0, torch.Size([400, 100])
layers.0.lstm.bias_ih_l0, torch.Size([400])
layers.0.lstm.bias_hh_l0, torch.Size([400])
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([47, 256])
layers.1.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
