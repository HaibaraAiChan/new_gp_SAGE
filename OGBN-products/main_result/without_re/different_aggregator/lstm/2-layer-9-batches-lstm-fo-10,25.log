main start at this time 1655790497.8739226
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.2220323085784912
global_2_local spend time (sec) 0.38184380531311035
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.04908609390258789
A = g.adjacency_matrix() spent  0.07393836975097656
auxiliary_graph
Graph(num_nodes=1205586, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.5855154991149902
remove nodes length
1009015
auxiliary_graph.remove_nodes spent  2.7155604362487793
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.0582120418548584

the counter of shared neighbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
51547892
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 51547889, 51547890, 51547891])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
Convert a graph into a bidirected graph: 2.895 seconds
Metis partitioning: 11.870 seconds
Split the graph: 1.583 seconds
Construct subgraphs: 0.360 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  16.72954773902893
21520
21209
22412
21218
21525
22497
22411
21284
22495
total k batches seeds list generation spend  37.855433225631714
after graph partition
graph partition algorithm spend time 38.51474380493164
21520
21209
22412
21218
21525
22497
22411
21284
22495
partition_len_list
[158232, 153697, 170673, 174018, 180913, 195388, 200669, 169780, 191782]
shared_neighbor_graph_partition_s0 selection method  spend 39.152687549591064
time for parepare:  0.2574167251586914
local_output_nid generation:  0.00562286376953125
local_in_edges_tensor generation:  0.025173664093017578
mini_batch_src_global generation:  0.017696857452392578
r_  generation:  0.18621206283569336
local_output_nid generation:  0.007467031478881836
local_in_edges_tensor generation:  0.013297796249389648
mini_batch_src_global generation:  0.020734548568725586
r_  generation:  0.2058420181274414
local_output_nid generation:  0.008985280990600586
local_in_edges_tensor generation:  0.009000539779663086
mini_batch_src_global generation:  0.018888235092163086
r_  generation:  0.2166433334350586
local_output_nid generation:  0.006308078765869141
local_in_edges_tensor generation:  0.008625984191894531
mini_batch_src_global generation:  0.022186994552612305
r_  generation:  0.21034002304077148
local_output_nid generation:  0.006402492523193359
local_in_edges_tensor generation:  0.008270978927612305
mini_batch_src_global generation:  0.02284693717956543
r_  generation:  0.23206734657287598
local_output_nid generation:  0.006641864776611328
local_in_edges_tensor generation:  0.008841276168823242
mini_batch_src_global generation:  0.0270540714263916
r_  generation:  0.2626333236694336
local_output_nid generation:  0.0065724849700927734
local_in_edges_tensor generation:  0.007130861282348633
mini_batch_src_global generation:  0.026834726333618164
r_  generation:  0.26816320419311523
local_output_nid generation:  0.006456136703491211
local_in_edges_tensor generation:  0.006682634353637695
mini_batch_src_global generation:  0.02493739128112793
r_  generation:  0.2199256420135498
local_output_nid generation:  0.006669759750366211
local_in_edges_tensor generation:  0.007235050201416016
mini_batch_src_global generation:  0.024713754653930664
r_  generation:  0.28687262535095215
----------------------check_connections_block total spend ----------------------------- 3.1845695972442627
generate_one_block  1.7312774658203125
generate_one_block  0.30338215827941895
generate_one_block  0.3441770076751709
generate_one_block  0.39029574394226074
generate_one_block  0.34146857261657715
generate_one_block  0.34259462356567383
generate_one_block  0.3060128688812256
generate_one_block  0.2501559257507324
generate_one_block  0.2964780330657959
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.768202543258667
gen group dst list time:  0.04990983009338379
time for parepare:  0.4065511226654053
local_output_nid generation:  0.041487932205200195
local_in_edges_tensor generation:  0.1074209213256836
mini_batch_src_global generation:  0.048604726791381836
r_  generation:  0.6963241100311279
local_output_nid generation:  0.06678032875061035
local_in_edges_tensor generation:  0.06782722473144531
mini_batch_src_global generation:  0.05746793746948242
r_  generation:  0.6637849807739258
local_output_nid generation:  0.04659223556518555
local_in_edges_tensor generation:  0.055344581604003906
mini_batch_src_global generation:  0.059322357177734375
r_  generation:  0.7747159004211426
local_output_nid generation:  0.04967761039733887
local_in_edges_tensor generation:  0.05767321586608887
mini_batch_src_global generation:  0.07183456420898438
r_  generation:  0.8225977420806885
local_output_nid generation:  0.050594329833984375
local_in_edges_tensor generation:  0.06300902366638184
mini_batch_src_global generation:  0.0700838565826416
r_  generation:  0.8803572654724121
local_output_nid generation:  0.07731080055236816
local_in_edges_tensor generation:  0.09064269065856934
mini_batch_src_global generation:  0.07692408561706543
r_  generation:  0.9544851779937744
local_output_nid generation:  0.05555224418640137
local_in_edges_tensor generation:  0.06981110572814941
mini_batch_src_global generation:  0.0814824104309082
r_  generation:  0.9891140460968018
local_output_nid generation:  0.0499730110168457
local_in_edges_tensor generation:  0.052701711654663086
mini_batch_src_global generation:  0.07729530334472656
r_  generation:  0.8530750274658203
local_output_nid generation:  0.053130388259887695
local_in_edges_tensor generation:  0.08455896377563477
mini_batch_src_global generation:  0.08175873756408691
r_  generation:  0.9827456474304199
----------------------check_connections_block total spend ----------------------------- 11.312500476837158
generate_one_block  1.170825481414795
generate_one_block  0.8317868709564209
generate_one_block  0.9685018062591553
generate_one_block  1.3334085941314697
generate_one_block  1.1781423091888428
generate_one_block  1.1159188747406006
generate_one_block  1.1652753353118896
generate_one_block  1.2570748329162598
generate_one_block  1.0804247856140137
----------===============-------------===============-------------the number of batches *****---- 9

original number of batches:  9
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

connection checking time:  14.497070074081421
block generation total time  14.407201290130615
average batch blocks generation time:  0.800400071673923
block dataloader generation time/epoch 70.16601824760437
pseudo mini batch 0 input nodes size: 425726
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.16113901138305664  GigaBytes
Max Memory Allocated: 0.16113901138305664  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.1612997055053711  GigaBytes
Max Memory Allocated: 0.1612997055053711  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1795654296875 GB
    Memory Allocated: 0.1612997055053711  GigaBytes
Max Memory Allocated: 0.1612997055053711  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.17675399780273438  GigaBytes
Max Memory Allocated: 0.17675399780273438  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2635498046875 GB
    Memory Allocated: 0.17675399780273438  GigaBytes
Max Memory Allocated: 0.17675399780273438  GigaBytes

first layer input nodes number: 425726
first layer output nodes number: 158232
edges number: 1545197
----------------------------------------before model layer 0
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.18239164352416992  GigaBytes
Max Memory Allocated: 0.18814802169799805  GigaBytes

torch.Size([425726, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2830810546875 GB
    Memory Allocated: 0.18239164352416992  GigaBytes
Max Memory Allocated: 0.18814802169799805  GigaBytes

m.shape torch.Size([325, 1, 100])
----------------------------------------1
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.7749214172363281  GigaBytes
Max Memory Allocated: 0.7998600006103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.7749214172363281  GigaBytes
Max Memory Allocated: 0.7998600006103516  GigaBytes

 h.shape torch.Size([1, 325, 100]), torch.Size([1, 325, 100])
----------------------------------------3
 Nvidia-smi: 2.0037841796875 GB
    Memory Allocated: 0.7751636505126953  GigaBytes
Max Memory Allocated: 0.7998600006103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0057373046875 GB
    Memory Allocated: 0.7771015167236328  GigaBytes
Max Memory Allocated: 0.7998600006103516  GigaBytes

rst.shape  torch.Size([1, 325, 100])
m.shape torch.Size([496, 2, 100])
----------------------------------------1
 Nvidia-smi: 2.0076904296875 GB
    Memory Allocated: 0.7773499488830566  GigaBytes
Max Memory Allocated: 0.7998600006103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0076904296875 GB
    Memory Allocated: 0.7773499488830566  GigaBytes
Max Memory Allocated: 0.7998600006103516  GigaBytes

 h.shape torch.Size([1, 496, 100]), torch.Size([1, 496, 100])
----------------------------------------3
 Nvidia-smi: 2.0076904296875 GB
    Memory Allocated: 0.7777199745178223  GigaBytes
Max Memory Allocated: 0.7998600006103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.7832646369934082  GigaBytes
Max Memory Allocated: 0.7998600006103516  GigaBytes

rst.shape  torch.Size([1, 496, 100])
m.shape torch.Size([714, 3, 100])
----------------------------------------1
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.7838778495788574  GigaBytes
Max Memory Allocated: 0.7998600006103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.7838778495788574  GigaBytes
Max Memory Allocated: 0.7998600006103516  GigaBytes

 h.shape torch.Size([1, 714, 100]), torch.Size([1, 714, 100])
----------------------------------------3
 Nvidia-smi: 2.0135498046875 GB
    Memory Allocated: 0.7844099998474121  GigaBytes
Max Memory Allocated: 0.7998600006103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.7965922355651855  GigaBytes
Max Memory Allocated: 0.7998600006103516  GigaBytes

rst.shape  torch.Size([1, 714, 100])
m.shape torch.Size([988, 4, 100])
----------------------------------------1
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.7977986335754395  GigaBytes
Max Memory Allocated: 0.7998600006103516  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.7977986335754395  GigaBytes
Max Memory Allocated: 0.7998600006103516  GigaBytes

 h.shape torch.Size([1, 988, 100]), torch.Size([1, 988, 100])
----------------------------------------3
 Nvidia-smi: 2.0174560546875 GB
    Memory Allocated: 0.7985348701477051  GigaBytes
Max Memory Allocated: 0.7998600006103516  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.8199849128723145  GigaBytes
Max Memory Allocated: 0.8214573860168457  GigaBytes

rst.shape  torch.Size([1, 988, 100])
m.shape torch.Size([1172, 5, 100])
----------------------------------------1
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.8218002319335938  GigaBytes
Max Memory Allocated: 0.8218660354614258  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0408935546875 GB
    Memory Allocated: 0.8218002319335938  GigaBytes
Max Memory Allocated: 0.8218660354614258  GigaBytes

 h.shape torch.Size([1, 1172, 100]), torch.Size([1, 1172, 100])
----------------------------------------3
 Nvidia-smi: 2.0428466796875 GB
    Memory Allocated: 0.8226737976074219  GigaBytes
Max Memory Allocated: 0.8226737976074219  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0682373046875 GB
    Memory Allocated: 0.8542704582214355  GigaBytes
Max Memory Allocated: 0.8564538955688477  GigaBytes

rst.shape  torch.Size([1, 1172, 100])
m.shape torch.Size([1273, 6, 100])
----------------------------------------1
 Nvidia-smi: 2.0682373046875 GB
    Memory Allocated: 0.8566794395446777  GigaBytes
Max Memory Allocated: 0.8567652702331543  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.0682373046875 GB
    Memory Allocated: 0.8566794395446777  GigaBytes
Max Memory Allocated: 0.8567652702331543  GigaBytes

 h.shape torch.Size([1, 1273, 100]), torch.Size([1, 1273, 100])
----------------------------------------3
 Nvidia-smi: 2.0682373046875 GB
    Memory Allocated: 0.857628345489502  GigaBytes
Max Memory Allocated: 0.857628345489502  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1131591796875 GB
    Memory Allocated: 0.8994941711425781  GigaBytes
Max Memory Allocated: 0.9023399353027344  GigaBytes

rst.shape  torch.Size([1, 1273, 100])
m.shape torch.Size([1379, 7, 100])
----------------------------------------1
 Nvidia-smi: 2.1131591796875 GB
    Memory Allocated: 0.902616024017334  GigaBytes
Max Memory Allocated: 0.9027242660522461  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1131591796875 GB
    Memory Allocated: 0.902616024017334  GigaBytes
Max Memory Allocated: 0.9027242660522461  GigaBytes

 h.shape torch.Size([1, 1379, 100]), torch.Size([1, 1379, 100])
----------------------------------------3
 Nvidia-smi: 2.1151123046875 GB
    Memory Allocated: 0.9036440849304199  GigaBytes
Max Memory Allocated: 0.9036440849304199  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1834716796875 GB
    Memory Allocated: 0.9553098678588867  GigaBytes
Max Memory Allocated: 0.9589061737060547  GigaBytes

rst.shape  torch.Size([1, 1379, 100])
m.shape torch.Size([1398, 8, 100])
----------------------------------------1
 Nvidia-smi: 2.1834716796875 GB
    Memory Allocated: 0.9589624404907227  GigaBytes
Max Memory Allocated: 0.9590878486633301  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1834716796875 GB
    Memory Allocated: 0.9589624404907227  GigaBytes
Max Memory Allocated: 0.9590878486633301  GigaBytes

 h.shape torch.Size([1, 1398, 100]), torch.Size([1, 1398, 100])
----------------------------------------3
 Nvidia-smi: 2.1854248046875 GB
    Memory Allocated: 0.9600048065185547  GigaBytes
Max Memory Allocated: 0.9600048065185547  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2557373046875 GB
    Memory Allocated: 1.0209484100341797  GigaBytes
Max Memory Allocated: 1.0251150131225586  GigaBytes

rst.shape  torch.Size([1, 1398, 100])
m.shape torch.Size([1419, 9, 100])
----------------------------------------1
 Nvidia-smi: 2.2557373046875 GB
    Memory Allocated: 1.0251851081848145  GigaBytes
Max Memory Allocated: 1.0253281593322754  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2557373046875 GB
    Memory Allocated: 1.0251851081848145  GigaBytes
Max Memory Allocated: 1.0253281593322754  GigaBytes

 h.shape torch.Size([1, 1419, 100]), torch.Size([1, 1419, 100])
----------------------------------------3
 Nvidia-smi: 2.2576904296875 GB
    Memory Allocated: 1.026242733001709  GigaBytes
Max Memory Allocated: 1.026242733001709  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3280029296875 GB
    Memory Allocated: 1.0956645011901855  GigaBytes
Max Memory Allocated: 1.1004223823547363  GigaBytes

rst.shape  torch.Size([1, 1419, 100])
m.shape torch.Size([149068, 10, 100])
----------------------------------------1
 Nvidia-smi: 2.9061279296875 GB
    Memory Allocated: 1.6504573822021484  GigaBytes
Max Memory Allocated: 1.6671171188354492  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9061279296875 GB
    Memory Allocated: 1.6504573822021484  GigaBytes
Max Memory Allocated: 1.6671171188354492  GigaBytes

 h.shape torch.Size([1, 149068, 100]), torch.Size([1, 149068, 100])
----------------------------------------3
 Nvidia-smi: 3.0194091796875 GB
    Memory Allocated: 1.7615222930908203  GigaBytes
Max Memory Allocated: 1.7615222930908203  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.5018310546875 GB
    Memory Allocated: 9.662923812866211  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 149068, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.5018310546875 GB
    Memory Allocated: 9.087348461151123  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.5018310546875 GB
    Memory Allocated: 9.238250255584717  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.5018310546875 GB
    Memory Allocated: 9.38915205001831  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.5018310546875 GB
    Memory Allocated: 9.238250255584717  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

torch.Size([158232, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.5018310546875 GB
    Memory Allocated: 9.38915205001831  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.5018310546875 GB
    Memory Allocated: 9.426877498626709  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.5018310546875 GB
    Memory Allocated: 9.426877498626709  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

m.shape torch.Size([14, 1, 256])
----------------------------------------1
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.936219692230225  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.936219692230225  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.936246395111084  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.936460018157959  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.936464309692383  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.936464309692383  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.936481475830078  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.936738967895508  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([15, 3, 256])
----------------------------------------1
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.936773777008057  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.936773777008057  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.936802387237549  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.937431812286377  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([39, 4, 256])
----------------------------------------1
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.937567710876465  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.937567710876465  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.937642097473145  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.939799308776855  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([26, 5, 256])
----------------------------------------1
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.939887523651123  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.939887523651123  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.939937114715576  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.941722393035889  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([32, 6, 256])
----------------------------------------1
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.941882133483887  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.941882133483887  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.941943168640137  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.944567680358887  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([29, 7, 256])
----------------------------------------1
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.944732666015625  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.944732666015625  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.944787979125977  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.947553634643555  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([33, 8, 256])
----------------------------------------1
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.947780132293701  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.947780132293701  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.947843074798584  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.951430797576904  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([53, 9, 256])
----------------------------------------1
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.951858043670654  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.951858043670654  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 12.0076904296875 GB
    Memory Allocated: 9.951959133148193  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0135498046875 GB
    Memory Allocated: 9.958428859710693  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([26, 10, 256])
----------------------------------------1
 Nvidia-smi: 12.0135498046875 GB
    Memory Allocated: 9.95862865447998  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0135498046875 GB
    Memory Allocated: 9.95862865447998  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 12.0135498046875 GB
    Memory Allocated: 9.958678245544434  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0155029296875 GB
    Memory Allocated: 9.962199211120605  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([38, 11, 256])
----------------------------------------1
 Nvidia-smi: 12.0155029296875 GB
    Memory Allocated: 9.962576389312744  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0155029296875 GB
    Memory Allocated: 9.962576389312744  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 12.0155029296875 GB
    Memory Allocated: 9.962648868560791  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0233154296875 GB
    Memory Allocated: 9.968302249908447  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([30, 12, 256])
----------------------------------------1
 Nvidia-smi: 12.0233154296875 GB
    Memory Allocated: 9.96861219406128  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0233154296875 GB
    Memory Allocated: 9.96861219406128  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 12.0233154296875 GB
    Memory Allocated: 9.968669414520264  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0272216796875 GB
    Memory Allocated: 9.973533153533936  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 13, 256])
----------------------------------------1
 Nvidia-smi: 12.0272216796875 GB
    Memory Allocated: 9.973829746246338  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0272216796875 GB
    Memory Allocated: 9.973829746246338  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 12.0272216796875 GB
    Memory Allocated: 9.973879337310791  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0330810546875 GB
    Memory Allocated: 9.978441715240479  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([38, 14, 256])
----------------------------------------1
 Nvidia-smi: 12.0330810546875 GB
    Memory Allocated: 9.978928565979004  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0330810546875 GB
    Memory Allocated: 9.978928565979004  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 12.0330810546875 GB
    Memory Allocated: 9.97900104522705  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0408935546875 GB
    Memory Allocated: 9.986176490783691  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([54, 15, 256])
----------------------------------------1
 Nvidia-smi: 12.0408935546875 GB
    Memory Allocated: 9.986918926239014  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0408935546875 GB
    Memory Allocated: 9.986918926239014  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 12.0408935546875 GB
    Memory Allocated: 9.987021923065186  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0526123046875 GB
    Memory Allocated: 9.997939586639404  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([32, 16, 256])
----------------------------------------1
 Nvidia-smi: 12.0526123046875 GB
    Memory Allocated: 9.998380184173584  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0526123046875 GB
    Memory Allocated: 9.998380184173584  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 12.0526123046875 GB
    Memory Allocated: 9.998441219329834  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0604248046875 GB
    Memory Allocated: 10.005338191986084  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 12.0604248046875 GB
    Memory Allocated: 10.005879878997803  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0604248046875 GB
    Memory Allocated: 10.005879878997803  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 12.0604248046875 GB
    Memory Allocated: 10.005946636199951  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0682373046875 GB
    Memory Allocated: 10.013957500457764  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([42, 18, 256])
----------------------------------------1
 Nvidia-smi: 12.0682373046875 GB
    Memory Allocated: 10.014650821685791  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0682373046875 GB
    Memory Allocated: 10.014650821685791  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 12.0682373046875 GB
    Memory Allocated: 10.01473093032837  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 10.024904727935791  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([38, 19, 256])
----------------------------------------1
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 10.025558948516846  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 10.025558948516846  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 12.0799560546875 GB
    Memory Allocated: 10.025631427764893  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.0897216796875 GB
    Memory Allocated: 10.035343647003174  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([45, 20, 256])
----------------------------------------1
 Nvidia-smi: 12.0916748046875 GB
    Memory Allocated: 10.036172866821289  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.0916748046875 GB
    Memory Allocated: 10.036172866821289  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 12.0916748046875 GB
    Memory Allocated: 10.036258697509766  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.1033935546875 GB
    Memory Allocated: 10.048360824584961  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 12.1033935546875 GB
    Memory Allocated: 10.049065113067627  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.1033935546875 GB
    Memory Allocated: 10.049065113067627  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 12.1033935546875 GB
    Memory Allocated: 10.049135684967041  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.1151123046875 GB
    Memory Allocated: 10.059580326080322  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([44, 22, 256])
----------------------------------------1
 Nvidia-smi: 12.1151123046875 GB
    Memory Allocated: 10.060475826263428  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.1151123046875 GB
    Memory Allocated: 10.060475826263428  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 12.1151123046875 GB
    Memory Allocated: 10.060559749603271  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.1287841796875 GB
    Memory Allocated: 10.073567867279053  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 12.1287841796875 GB
    Memory Allocated: 10.074277877807617  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.1287841796875 GB
    Memory Allocated: 10.074277877807617  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 12.1287841796875 GB
    Memory Allocated: 10.074342727661133  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.1405029296875 GB
    Memory Allocated: 10.084848403930664  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([50, 24, 256])
----------------------------------------1
 Nvidia-smi: 12.1405029296875 GB
    Memory Allocated: 10.08623456954956  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.1405029296875 GB
    Memory Allocated: 10.08623456954956  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 12.1405029296875 GB
    Memory Allocated: 10.086329936981201  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.1561279296875 GB
    Memory Allocated: 10.102447032928467  GigaBytes
Max Memory Allocated: 10.218245506286621  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([20701, 25, 256])
----------------------------------------1
 Nvidia-smi: 12.6502685546875 GB
    Memory Allocated: 10.600396156311035  GigaBytes
Max Memory Allocated: 10.602324485778809  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6502685546875 GB
    Memory Allocated: 10.600396156311035  GigaBytes
Max Memory Allocated: 10.602324485778809  GigaBytes

 h.shape torch.Size([1, 20701, 256]), torch.Size([1, 20701, 256])
----------------------------------------3
 Nvidia-smi: 12.6502685546875 GB
    Memory Allocated: 10.639880180358887  GigaBytes
Max Memory Allocated: 10.639880180358887  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.5936279296875 GB
    Memory Allocated: 17.58906841278076  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 20701, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 19.5936279296875 GB
    Memory Allocated: 17.08593988418579  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 19.5936279296875 GB
    Memory Allocated: 17.089707851409912  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 19.5936279296875 GB
    Memory Allocated: 17.093475818634033  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 19.5936279296875 GB
    Memory Allocated: 17.089547157287598  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

torch.Size([21520, 47])
input nodes number: 158232
output nodes number: 21520
edges number: 528954
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5936279296875 GB
    Memory Allocated: 17.094887256622314  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5936279296875 GB
    Memory Allocated: 17.09488821029663  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.2110462188720703  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

pseudo mini batch 1 input nodes size: 388217
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.16761207580566406  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.16761207580566406  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.31223440170288086  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.3123927116394043  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.15363645553588867  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.16851186752319336  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.16851186752319336  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

first layer input nodes number: 388217
first layer output nodes number: 153697
edges number: 1491608
----------------------------------------before model layer 0
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.17276716232299805  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

torch.Size([388217, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.17276716232299805  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

m.shape torch.Size([344, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.7452383041381836  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.7452383041381836  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 344, 100]), torch.Size([1, 344, 100])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.7454948425292969  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.7475457191467285  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 344, 100])
m.shape torch.Size([627, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.7478847503662109  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.7478847503662109  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 627, 100]), torch.Size([1, 627, 100])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.74835205078125  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.7553615570068359  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 627, 100])
m.shape torch.Size([835, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.7560615539550781  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.7560615539550781  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 835, 100]), torch.Size([1, 835, 100])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.7566843032836914  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.7703762054443359  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 835, 100])
m.shape torch.Size([1098, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.7717013359069824  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.7717013359069824  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 1098, 100]), torch.Size([1, 1098, 100])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.772519588470459  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.7969937324523926  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 1098, 100])
m.shape torch.Size([1408, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.7992072105407715  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.7992072105407715  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 1408, 100]), torch.Size([1, 1408, 100])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.8002562522888184  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.8381457328796387  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 1408, 100])
m.shape torch.Size([1636, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.841278076171875  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.841278076171875  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 1636, 100]), torch.Size([1, 1636, 100])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.8424978256225586  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.8949747085571289  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 1636, 100])
m.shape torch.Size([1802, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.8990640640258789  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.8990640640258789  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 1802, 100]), torch.Size([1, 1802, 100])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.9004068374633789  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.9690103530883789  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 1802, 100])
m.shape torch.Size([1924, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.9740729331970215  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.9740729331970215  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 1924, 100]), torch.Size([1, 1924, 100])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 0.9755072593688965  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 1.057417392730713  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 1924, 100])
m.shape torch.Size([1979, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 1.0633354187011719  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 1.0633354187011719  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 1979, 100]), torch.Size([1, 1979, 100])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 1.0648107528686523  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 1.1608729362487793  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 1979, 100])
m.shape torch.Size([142044, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 1.6892905235290527  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 1.6892905235290527  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 142044, 100]), torch.Size([1, 142044, 100])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 1.795121669769287  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.309133052825928  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 142044, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 8.753968238830566  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 8.900545120239258  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.04712200164795  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 8.900545120239258  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

torch.Size([153697, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.04712200164795  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.083766460418701  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.083766460418701  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

m.shape torch.Size([36, 1, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.56995439529419  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.56995439529419  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.57002305984497  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.57057237625122  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([53, 2, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.570640087127686  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.570640087127686  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.570741176605225  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.57225751876831  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([63, 3, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.572388648986816  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.572388648986816  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.572508811950684  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.575152397155762  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([90, 4, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.575438499450684  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.575438499450684  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.575610160827637  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.580588340759277  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([86, 5, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.580915927886963  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.580915927886963  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.581079959869385  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.586985111236572  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([98, 6, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.58746862411499  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.58746862411499  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.587655544281006  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.595693111419678  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([107, 7, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.596319675445557  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.596319675445557  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.596523761749268  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.606728076934814  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([118, 8, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.60753345489502  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.60753345489502  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.607758522033691  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.620587348937988  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([94, 9, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.621288299560547  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.621288299560547  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.621467590332031  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.632942199707031  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([95, 10, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.633765697479248  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.633765697479248  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 95, 256]), torch.Size([1, 95, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.633946895599365  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.646811962127686  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 95, 256])
m.shape torch.Size([94, 11, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.647828578948975  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.647828578948975  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.648007869720459  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.66199254989624  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([83, 12, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.66286039352417  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.66286039352417  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.663018703460693  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.676475048065186  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([97, 13, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.677935123443604  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.677935123443604  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.678120136260986  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.695141315460205  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([96, 14, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.696894645690918  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.696894645690918  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.697077751159668  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.715205192565918  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([97, 15, 256])
----------------------------------------1
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.717370510101318  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.717370510101318  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 20.6170654296875 GB
    Memory Allocated: 9.717555522918701  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6287841796875 GB
    Memory Allocated: 9.73716688156128  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([92, 16, 256])
----------------------------------------1
 Nvidia-smi: 20.6287841796875 GB
    Memory Allocated: 9.739413261413574  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6287841796875 GB
    Memory Allocated: 9.739413261413574  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 20.6287841796875 GB
    Memory Allocated: 9.739588737487793  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6502685546875 GB
    Memory Allocated: 9.759417533874512  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([105, 17, 256])
----------------------------------------1
 Nvidia-smi: 20.6502685546875 GB
    Memory Allocated: 9.76167106628418  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6502685546875 GB
    Memory Allocated: 9.76167106628418  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 105, 256]), torch.Size([1, 105, 256])
----------------------------------------3
 Nvidia-smi: 20.6502685546875 GB
    Memory Allocated: 9.761871337890625  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6737060546875 GB
    Memory Allocated: 9.785903930664062  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 105, 256])
m.shape torch.Size([93, 18, 256])
----------------------------------------1
 Nvidia-smi: 20.6737060546875 GB
    Memory Allocated: 9.788144588470459  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6737060546875 GB
    Memory Allocated: 9.788144588470459  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 20.6737060546875 GB
    Memory Allocated: 9.78832197189331  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.6971435546875 GB
    Memory Allocated: 9.810849666595459  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([100, 19, 256])
----------------------------------------1
 Nvidia-smi: 20.6971435546875 GB
    Memory Allocated: 9.812587261199951  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.6971435546875 GB
    Memory Allocated: 9.812587261199951  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 100, 256]), torch.Size([1, 100, 256])
----------------------------------------3
 Nvidia-smi: 20.6971435546875 GB
    Memory Allocated: 9.812777996063232  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7225341796875 GB
    Memory Allocated: 9.83833646774292  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 100, 256])
m.shape torch.Size([71, 20, 256])
----------------------------------------1
 Nvidia-smi: 20.7225341796875 GB
    Memory Allocated: 9.840165138244629  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7225341796875 GB
    Memory Allocated: 9.840165138244629  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 20.7225341796875 GB
    Memory Allocated: 9.840300559997559  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7420654296875 GB
    Memory Allocated: 9.859395027160645  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([84, 21, 256])
----------------------------------------1
 Nvidia-smi: 20.7420654296875 GB
    Memory Allocated: 9.86102294921875  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7420654296875 GB
    Memory Allocated: 9.86102294921875  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 20.7420654296875 GB
    Memory Allocated: 9.861183166503906  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7655029296875 GB
    Memory Allocated: 9.884895324707031  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([87, 22, 256])
----------------------------------------1
 Nvidia-smi: 20.7655029296875 GB
    Memory Allocated: 9.886872291564941  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7655029296875 GB
    Memory Allocated: 9.886872291564941  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 20.7655029296875 GB
    Memory Allocated: 9.887038230895996  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.7928466796875 GB
    Memory Allocated: 9.912758827209473  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([81, 23, 256])
----------------------------------------1
 Nvidia-smi: 20.7928466796875 GB
    Memory Allocated: 9.914466857910156  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7928466796875 GB
    Memory Allocated: 9.914466857910156  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 20.7928466796875 GB
    Memory Allocated: 9.914621353149414  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.8182373046875 GB
    Memory Allocated: 9.93964958190918  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([94, 24, 256])
----------------------------------------1
 Nvidia-smi: 20.8182373046875 GB
    Memory Allocated: 9.941740989685059  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.8182373046875 GB
    Memory Allocated: 9.941740989685059  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 20.8182373046875 GB
    Memory Allocated: 9.941920280456543  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.8494873046875 GB
    Memory Allocated: 9.972220420837402  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([19095, 25, 256])
----------------------------------------1
 Nvidia-smi: 20.8494873046875 GB
    Memory Allocated: 10.431116104125977  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.8494873046875 GB
    Memory Allocated: 10.431116104125977  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 19095, 256]), torch.Size([1, 19095, 256])
----------------------------------------3
 Nvidia-smi: 20.8494873046875 GB
    Memory Allocated: 10.467536926269531  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.8494873046875 GB
    Memory Allocated: 16.877601623535156  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 19095, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.8494873046875 GB
    Memory Allocated: 16.397876739501953  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.8494873046875 GB
    Memory Allocated: 16.401601791381836  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.8494873046875 GB
    Memory Allocated: 16.40532684326172  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.8494873046875 GB
    Memory Allocated: 16.401443481445312  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

torch.Size([21209, 47])
input nodes number: 153697
output nodes number: 21209
edges number: 504711
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8494873046875 GB
    Memory Allocated: 16.402714729309082  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8494873046875 GB
    Memory Allocated: 16.40271520614624  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.8533935546875 GB
    Memory Allocated: 0.19496726989746094  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

pseudo mini batch 2 input nodes size: 416186
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.8533935546875 GB
    Memory Allocated: 0.1535935401916504  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.8533935546875 GB
    Memory Allocated: 0.1535935401916504  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.8533935546875 GB
    Memory Allocated: 0.30863523483276367  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 20.8533935546875 GB
    Memory Allocated: 0.30880260467529297  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.8533935546875 GB
    Memory Allocated: 0.16402196884155273  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.8533935546875 GB
    Memory Allocated: 0.18020296096801758  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8533935546875 GB
    Memory Allocated: 0.18020296096801758  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

first layer input nodes number: 416186
first layer output nodes number: 170673
edges number: 1630524
----------------------------------------before model layer 0
 Nvidia-smi: 20.8533935546875 GB
    Memory Allocated: 0.18457555770874023  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

torch.Size([416186, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 20.8533935546875 GB
    Memory Allocated: 0.18457555770874023  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

m.shape torch.Size([704, 1, 100])
----------------------------------------1
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.8095016479492188  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.8095016479492188  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 704, 100]), torch.Size([1, 704, 100])
----------------------------------------3
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.8100261688232422  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.8144783973693848  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 704, 100])
m.shape torch.Size([1145, 2, 100])
----------------------------------------1
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.8150696754455566  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.8150696754455566  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 1145, 100]), torch.Size([1, 1145, 100])
----------------------------------------3
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.8159232139587402  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.8298964500427246  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 1145, 100])
m.shape torch.Size([1599, 3, 100])
----------------------------------------1
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.8312568664550781  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.8312568664550781  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 1599, 100]), torch.Size([1, 1599, 100])
----------------------------------------3
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.8324489593505859  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.8586621284484863  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 1599, 100])
m.shape torch.Size([1994, 4, 100])
----------------------------------------1
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.8610377311706543  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.8610377311706543  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 1994, 100]), torch.Size([1, 1994, 100])
----------------------------------------3
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.8625235557556152  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.9061088562011719  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 1994, 100])
m.shape torch.Size([2302, 5, 100])
----------------------------------------1
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.9096541404724121  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.9096541404724121  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 2302, 100]), torch.Size([1, 2302, 100])
----------------------------------------3
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.911369800567627  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.9731192588806152  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 2302, 100])
m.shape torch.Size([2528, 6, 100])
----------------------------------------1
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.9780712127685547  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.9780712127685547  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 2528, 100]), torch.Size([1, 2528, 100])
----------------------------------------3
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 0.979954719543457  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 1.0630340576171875  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 2528, 100])
m.shape torch.Size([2629, 7, 100])
----------------------------------------1
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 1.0689482688903809  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 1.0689482688903809  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 2629, 100]), torch.Size([1, 2629, 100])
----------------------------------------3
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 1.072023868560791  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 1.1752686500549316  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 2629, 100])
m.shape torch.Size([2707, 8, 100])
----------------------------------------1
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 1.182356834411621  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 1.182356834411621  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 2707, 100]), torch.Size([1, 2707, 100])
----------------------------------------3
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 1.1852669715881348  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 1.3026008605957031  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 2707, 100])
m.shape torch.Size([2630, 9, 100])
----------------------------------------1
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 1.310410499572754  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 1.310410499572754  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 2630, 100]), torch.Size([1, 2630, 100])
----------------------------------------3
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 1.312398910522461  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 1.4437427520751953  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 2630, 100])
m.shape torch.Size([152435, 10, 100])
----------------------------------------1
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 2.0106277465820312  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 2.0106277465820312  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 152435, 100]), torch.Size([1, 152435, 100])
----------------------------------------3
 Nvidia-smi: 21.4627685546875 GB
    Memory Allocated: 2.1242008209228516  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.7850341796875 GB
    Memory Allocated: 10.187889099121094  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 152435, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 12.7850341796875 GB
    Memory Allocated: 9.584173202514648  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 12.7850341796875 GB
    Memory Allocated: 9.746939659118652  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 12.7850341796875 GB
    Memory Allocated: 9.909706115722656  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 12.7850341796875 GB
    Memory Allocated: 9.746939659118652  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

torch.Size([170673, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 12.7850341796875 GB
    Memory Allocated: 9.909706115722656  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 12.7850341796875 GB
    Memory Allocated: 9.950397968292236  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 12.7850341796875 GB
    Memory Allocated: 9.950397968292236  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

m.shape torch.Size([18, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.471657276153564  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.471657276153564  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.471691608428955  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.47196626663208  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([30, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.472006797790527  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.472006797790527  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.472064018249512  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.472922325134277  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([41, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.47301197052002  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.47301197052002  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.473090171813965  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.474810600280762  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([46, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.474948406219482  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.474948406219482  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.475036144256592  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.477580547332764  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([57, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.477810859680176  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.477810859680176  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.477919578552246  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.481833457946777  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([65, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.482154369354248  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.482154369354248  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 13.3026123046875 GB
    Memory Allocated: 10.48227834701538  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.3045654296875 GB
    Memory Allocated: 10.487609386444092  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([64, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.3045654296875 GB
    Memory Allocated: 10.487977981567383  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.3045654296875 GB
    Memory Allocated: 10.487977981567383  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 13.3045654296875 GB
    Memory Allocated: 10.488100051879883  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.3123779296875 GB
    Memory Allocated: 10.494203567504883  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([70, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.3123779296875 GB
    Memory Allocated: 10.494680881500244  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.3123779296875 GB
    Memory Allocated: 10.494680881500244  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 70, 256]), torch.Size([1, 70, 256])
----------------------------------------3
 Nvidia-smi: 13.3123779296875 GB
    Memory Allocated: 10.494814395904541  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.3201904296875 GB
    Memory Allocated: 10.502424716949463  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 70, 256])
m.shape torch.Size([72, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.3201904296875 GB
    Memory Allocated: 10.502981185913086  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.3201904296875 GB
    Memory Allocated: 10.502981185913086  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 13.3201904296875 GB
    Memory Allocated: 10.503118515014648  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.3299560546875 GB
    Memory Allocated: 10.511907577514648  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([90, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.3319091796875 GB
    Memory Allocated: 10.512704372406006  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.3319091796875 GB
    Memory Allocated: 10.512704372406006  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 13.3319091796875 GB
    Memory Allocated: 10.512876033782959  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.3436279296875 GB
    Memory Allocated: 10.52506399154663  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([77, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.3436279296875 GB
    Memory Allocated: 10.525792598724365  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.3436279296875 GB
    Memory Allocated: 10.525792598724365  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 77, 256]), torch.Size([1, 77, 256])
----------------------------------------3
 Nvidia-smi: 13.3436279296875 GB
    Memory Allocated: 10.525939464569092  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.3572998046875 GB
    Memory Allocated: 10.537395000457764  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 77, 256])
m.shape torch.Size([61, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.3572998046875 GB
    Memory Allocated: 10.538025379180908  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.3572998046875 GB
    Memory Allocated: 10.538025379180908  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 13.3572998046875 GB
    Memory Allocated: 10.53814172744751  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.3670654296875 GB
    Memory Allocated: 10.548031330108643  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([106, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.3670654296875 GB
    Memory Allocated: 10.549353122711182  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.3670654296875 GB
    Memory Allocated: 10.549353122711182  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 13.3670654296875 GB
    Memory Allocated: 10.54955530166626  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.3846435546875 GB
    Memory Allocated: 10.568155765533447  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([103, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.3846435546875 GB
    Memory Allocated: 10.569544792175293  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.3846435546875 GB
    Memory Allocated: 10.569544792175293  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 13.3846435546875 GB
    Memory Allocated: 10.569741249084473  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4061279296875 GB
    Memory Allocated: 10.589190483093262  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([73, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.4061279296875 GB
    Memory Allocated: 10.590470314025879  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4061279296875 GB
    Memory Allocated: 10.590470314025879  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 13.4061279296875 GB
    Memory Allocated: 10.590609550476074  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4197998046875 GB
    Memory Allocated: 10.605368614196777  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([93, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.4197998046875 GB
    Memory Allocated: 10.607117652893066  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4197998046875 GB
    Memory Allocated: 10.607117652893066  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 13.4197998046875 GB
    Memory Allocated: 10.607295036315918  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4393310546875 GB
    Memory Allocated: 10.627339363098145  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([94, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.4393310546875 GB
    Memory Allocated: 10.629069805145264  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4393310546875 GB
    Memory Allocated: 10.629069805145264  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 13.4393310546875 GB
    Memory Allocated: 10.629249095916748  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4627685546875 GB
    Memory Allocated: 10.650763988494873  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([76, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.4627685546875 GB
    Memory Allocated: 10.65205430984497  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4627685546875 GB
    Memory Allocated: 10.65205430984497  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 13.4627685546875 GB
    Memory Allocated: 10.652199268341064  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4822998046875 GB
    Memory Allocated: 10.67060899734497  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([86, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.4822998046875 GB
    Memory Allocated: 10.672356128692627  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4822998046875 GB
    Memory Allocated: 10.672356128692627  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 13.4822998046875 GB
    Memory Allocated: 10.672520160675049  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5037841796875 GB
    Memory Allocated: 10.69450044631958  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([78, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.5037841796875 GB
    Memory Allocated: 10.696237564086914  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5037841796875 GB
    Memory Allocated: 10.696237564086914  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 13.5037841796875 GB
    Memory Allocated: 10.696386337280273  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5252685546875 GB
    Memory Allocated: 10.717363357543945  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([85, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.5252685546875 GB
    Memory Allocated: 10.719261169433594  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5252685546875 GB
    Memory Allocated: 10.719261169433594  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 13.5252685546875 GB
    Memory Allocated: 10.719423294067383  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5506591796875 GB
    Memory Allocated: 10.743417739868164  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([86, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.5506591796875 GB
    Memory Allocated: 10.745155334472656  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5506591796875 GB
    Memory Allocated: 10.745155334472656  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 13.5506591796875 GB
    Memory Allocated: 10.745319366455078  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5760498046875 GB
    Memory Allocated: 10.770744323730469  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([103, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.5760498046875 GB
    Memory Allocated: 10.772939682006836  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.5760498046875 GB
    Memory Allocated: 10.772939682006836  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 13.5760498046875 GB
    Memory Allocated: 10.773136138916016  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6112060546875 GB
    Memory Allocated: 10.804962158203125  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([85, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.6112060546875 GB
    Memory Allocated: 10.806824684143066  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.6112060546875 GB
    Memory Allocated: 10.806824684143066  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 13.6112060546875 GB
    Memory Allocated: 10.806986808776855  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.6365966796875 GB
    Memory Allocated: 10.834385871887207  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([20653, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.1307373046875 GB
    Memory Allocated: 11.330557823181152  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1307373046875 GB
    Memory Allocated: 11.330557823181152  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

 h.shape torch.Size([1, 20653, 256]), torch.Size([1, 20653, 256])
----------------------------------------3
 Nvidia-smi: 14.1307373046875 GB
    Memory Allocated: 11.369950294494629  GigaBytes
Max Memory Allocated: 18.08320903778076  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.3494873046875 GB
    Memory Allocated: 18.30393695831299  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 20653, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.3494873046875 GB
    Memory Allocated: 17.78918981552124  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.3494873046875 GB
    Memory Allocated: 17.79329204559326  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.3494873046875 GB
    Memory Allocated: 17.797216415405273  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.3494873046875 GB
    Memory Allocated: 17.792946815490723  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

torch.Size([22412, 47])
input nodes number: 170673
output nodes number: 22412
edges number: 541169
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.3494873046875 GB
    Memory Allocated: 17.794763565063477  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.3494873046875 GB
    Memory Allocated: 17.794764041900635  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.20905494689941406  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

pseudo mini batch 3 input nodes size: 466542
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.1643991470336914  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.1643991470336914  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.3381996154785156  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.33835792541503906  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.18314886093139648  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.19946527481079102  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.19946527481079102  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

first layer input nodes number: 466542
first layer output nodes number: 174018
edges number: 1679926
----------------------------------------before model layer 0
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.20460224151611328  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

torch.Size([466542, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.3885498046875 GB
    Memory Allocated: 0.20460224151611328  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

m.shape torch.Size([596, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.848358154296875  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.848358154296875  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 596, 100]), torch.Size([1, 596, 100])
----------------------------------------3
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.8488025665283203  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.8523564338684082  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 596, 100])
m.shape torch.Size([905, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.852808952331543  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.852808952331543  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 905, 100]), torch.Size([1, 905, 100])
----------------------------------------3
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.8534841537475586  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.8648257255554199  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 905, 100])
m.shape torch.Size([1255, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.8658909797668457  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.8658909797668457  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 1255, 100]), torch.Size([1, 1255, 100])
----------------------------------------3
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.8668265342712402  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.8878693580627441  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 1255, 100])
m.shape torch.Size([1560, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.8897261619567871  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.8897261619567871  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 1560, 100]), torch.Size([1, 1560, 100])
----------------------------------------3
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.8908886909484863  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.9245963096618652  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 1560, 100])
m.shape torch.Size([1866, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.9274911880493164  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.9274911880493164  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 1866, 100]), torch.Size([1, 1866, 100])
----------------------------------------3
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.9288816452026367  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.9790678024291992  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 1866, 100])
m.shape torch.Size([1959, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.9827513694763184  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.9827513694763184  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 1959, 100]), torch.Size([1, 1959, 100])
----------------------------------------3
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 0.9842114448547363  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 1.0476722717285156  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 1959, 100])
m.shape torch.Size([2048, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 1.0522828102111816  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 1.0522828102111816  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 2048, 100]), torch.Size([1, 2048, 100])
----------------------------------------3
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 1.0538086891174316  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 1.1301026344299316  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 2048, 100])
m.shape torch.Size([2067, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 1.1354999542236328  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 1.1354999542236328  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 2067, 100]), torch.Size([1, 2067, 100])
----------------------------------------3
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 1.137040138244629  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 1.2248306274414062  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 2067, 100])
m.shape torch.Size([2061, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 1.230970859527588  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 1.230970859527588  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 2061, 100]), torch.Size([1, 2061, 100])
----------------------------------------3
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 1.2325072288513184  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 1.330796241760254  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 2061, 100])
m.shape torch.Size([159701, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 1.9249610900878906  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 1.9249610900878906  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 159701, 100]), torch.Size([1, 159701, 100])
----------------------------------------3
 Nvidia-smi: 22.0155029296875 GB
    Memory Allocated: 2.043948173522949  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.492618560791016  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 159701, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 9.86897087097168  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.034927368164062  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.200883865356445  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.034927368164062  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

torch.Size([174018, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.200883865356445  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.242515563964844  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.242515563964844  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

m.shape torch.Size([62, 1, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.733719825744629  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.733719825744629  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.733838081359863  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.734784126281738  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([56, 2, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.734832763671875  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.734832763671875  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.734939575195312  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.736541748046875  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([47, 3, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.736624240875244  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.736624240875244  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.736713886260986  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.738686084747314  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([64, 4, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.738887310028076  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.738887310028076  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.739009380340576  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.742549419403076  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([72, 5, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.742834568023682  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.742834568023682  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.742971897125244  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.747915744781494  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([78, 6, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.748297214508057  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.748297214508057  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.748445987701416  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.75484323501587  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([81, 7, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.755313873291016  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.755313873291016  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.755468368530273  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.763193130493164  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([64, 8, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.7636079788208  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.7636079788208  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.7637300491333  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.7706880569458  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([56, 9, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.771111488342285  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.771111488342285  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.771218299865723  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.778054237365723  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([72, 10, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.778693199157715  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.778693199157715  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.778830528259277  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.788580894470215  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([83, 11, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.789390087127686  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.789390087127686  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.789548397064209  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.801896572113037  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([82, 12, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.80276346206665  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.80276346206665  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.802919864654541  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.816214084625244  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([82, 13, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.817193031311035  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.817193031311035  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.817349433898926  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.831738471984863  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([72, 14, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.832629203796387  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.832629203796387  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 72, 256]), torch.Size([1, 72, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.83276653289795  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.846362113952637  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 72, 256])
m.shape torch.Size([71, 15, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.847350597381592  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.847350597381592  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.847486019134521  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.861840724945068  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([71, 16, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.863002300262451  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.863002300262451  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.86313772201538  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.878440380096436  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([69, 17, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.879602432250977  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.879602432250977  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.87973403930664  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.895526885986328  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.896690368652344  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.896690368652344  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.896812438964844  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.912315368652344  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([71, 19, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.914372444152832  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.914372444152832  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.914507865905762  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.93265438079834  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([73, 20, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.9348464012146  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.9348464012146  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.934985637664795  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.954617977142334  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([74, 21, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.956821918487549  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.956821918487549  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.956963062286377  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.97785234451294  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([83, 22, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.980175971984863  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.980175971984863  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 10.980334281921387  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 11.00487232208252  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([86, 23, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 11.006694316864014  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 11.006694316864014  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 86, 256]), torch.Size([1, 86, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 11.006858348846436  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 11.03343152999878  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 86, 256])
m.shape torch.Size([66, 24, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 11.034872055053711  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 11.034872055053711  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 11.034997940063477  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 11.056272506713867  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([19519, 25, 256])
----------------------------------------1
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 11.525214672088623  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 11.525214672088623  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 19519, 256]), torch.Size([1, 19519, 256])
----------------------------------------3
 Nvidia-smi: 23.0877685546875 GB
    Memory Allocated: 11.56244421005249  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5545654296875 GB
    Memory Allocated: 18.114842891693115  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 19519, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 23.5545654296875 GB
    Memory Allocated: 17.629746437072754  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 23.5545654296875 GB
    Memory Allocated: 17.634148597717285  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 23.5545654296875 GB
    Memory Allocated: 17.637863636016846  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 23.5545654296875 GB
    Memory Allocated: 17.63330316543579  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

torch.Size([21218, 47])
input nodes number: 174018
output nodes number: 21218
edges number: 509925
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5545654296875 GB
    Memory Allocated: 17.63518476486206  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5545654296875 GB
    Memory Allocated: 17.63518524169922  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.8358154296875 GB
    Memory Allocated: 0.22876548767089844  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

pseudo mini batch 4 input nodes size: 498407
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.8358154296875 GB
    Memory Allocated: 0.18344879150390625  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.8358154296875 GB
    Memory Allocated: 0.18344879150390625  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8358154296875 GB
    Memory Allocated: 0.36912012100219727  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8358154296875 GB
    Memory Allocated: 0.3692808151245117  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.8358154296875 GB
    Memory Allocated: 0.19532203674316406  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.8358154296875 GB
    Memory Allocated: 0.21225929260253906  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8358154296875 GB
    Memory Allocated: 0.21225929260253906  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

first layer input nodes number: 498407
first layer output nodes number: 180913
edges number: 1756381
----------------------------------------before model layer 0
 Nvidia-smi: 14.8358154296875 GB
    Memory Allocated: 0.21743488311767578  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

torch.Size([498407, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.8358154296875 GB
    Memory Allocated: 0.21743488311767578  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

m.shape torch.Size([261, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 0.8904070854187012  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 0.8904070854187012  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 261, 100]), torch.Size([1, 261, 100])
----------------------------------------3
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 0.890601634979248  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 0.892158031463623  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 261, 100])
m.shape torch.Size([456, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 0.8924007415771484  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 0.8924007415771484  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 456, 100]), torch.Size([1, 456, 100])
----------------------------------------3
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 0.8927412033081055  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 0.8978395462036133  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 456, 100])
m.shape torch.Size([795, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 0.8985581398010254  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 0.8985581398010254  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 795, 100]), torch.Size([1, 795, 100])
----------------------------------------3
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 0.8991513252258301  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 0.9134163856506348  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 795, 100])
m.shape torch.Size([1382, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 0.9151792526245117  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 0.9151792526245117  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 1382, 100]), torch.Size([1, 1382, 100])
----------------------------------------3
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 0.9162092208862305  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 0.9464478492736816  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 1382, 100])
m.shape torch.Size([1843, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 0.9493660926818848  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 0.9493660926818848  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 1843, 100]), torch.Size([1, 1843, 100])
----------------------------------------3
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 0.9507393836975098  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 1.0007882118225098  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 1843, 100])
m.shape torch.Size([2114, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 1.0048270225524902  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 1.0048270225524902  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 2114, 100]), torch.Size([1, 2114, 100])
----------------------------------------3
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 1.0064024925231934  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 1.0753960609436035  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 2114, 100])
m.shape torch.Size([2436, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 1.080960750579834  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 1.080960750579834  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 2436, 100]), torch.Size([1, 2436, 100])
----------------------------------------3
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 1.0827765464782715  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 1.1735363006591797  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 2436, 100])
m.shape torch.Size([2619, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 1.180433750152588  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 1.180433750152588  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 2619, 100]), torch.Size([1, 2619, 100])
----------------------------------------3
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 1.1823859214782715  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 1.2936758995056152  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 2619, 100])
m.shape torch.Size([2678, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 1.3016786575317383  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 1.3016786575317383  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 2678, 100]), torch.Size([1, 2678, 100])
----------------------------------------3
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 1.3044395446777344  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 1.4380698204040527  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 2678, 100])
m.shape torch.Size([166329, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 2.0566959381103516  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 2.0566959381103516  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 166329, 100]), torch.Size([1, 166329, 100])
----------------------------------------3
 Nvidia-smi: 15.4940185546875 GB
    Memory Allocated: 2.1806211471557617  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 10.979493618011475  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 166329, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 10.327157974243164  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 10.499690055847168  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 10.672222137451172  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 10.499690055847168  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

torch.Size([180913, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 10.672222137451172  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 10.715355396270752  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 10.715355396270752  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.212891578674316  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.212891578674316  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.212904930114746  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.213011741638184  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.213016986846924  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.213016986846924  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.21302843093872  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.213200092315674  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([31, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.213284015655518  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.213284015655518  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.213343143463135  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.214643955230713  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.214722156524658  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.214722156524658  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.214775562286377  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.21632432937622  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([33, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.216456413269043  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.216456413269043  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.216519355773926  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.218785285949707  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([57, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.219082832336426  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.219082832336426  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.219191551208496  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.22386646270752  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([74, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.224310398101807  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.224310398101807  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.224451541900635  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.231508731842041  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([63, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.231922626495361  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.231922626495361  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.232042789459229  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.238892078399658  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([88, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.239593505859375  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.239593505859375  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.239761352539062  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.250503540039062  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([121, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.251667976379395  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.251667976379395  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.251898765563965  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.268284797668457  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([125, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.26950454711914  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.26950454711914  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.269742965698242  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.288339614868164  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([122, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.289959907531738  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.289959907531738  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.290192604064941  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.309971809387207  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([112, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.311254978179932  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.311254978179932  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.311468601226807  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.331121921539307  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([115, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.332562923431396  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.332562923431396  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.33278226852417  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.35449743270874  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([121, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.356132507324219  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.356132507324219  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.356363296508789  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.380826950073242  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([123, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.383400440216064  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.383400440216064  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.3836350440979  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.410145282745361  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([101, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.411678314208984  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.411678314208984  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 101, 256]), torch.Size([1, 101, 256])
----------------------------------------3
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.411870956420898  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.434988021850586  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 101, 256])
m.shape torch.Size([130, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.437140941619873  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.437140941619873  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.437388896942139  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.468879222869873  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([112, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.470800876617432  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.470800876617432  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.471014499664307  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.499639987945557  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([106, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.50157117843628  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.50157117843628  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 16.3631591796875 GB
    Memory Allocated: 11.501773357391357  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3670654296875 GB
    Memory Allocated: 11.530280590057373  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([118, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.3670654296875 GB
    Memory Allocated: 11.532561302185059  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3670654296875 GB
    Memory Allocated: 11.532561302185059  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 16.3670654296875 GB
    Memory Allocated: 11.53278636932373  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 11.566096305847168  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([123, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 11.56858491897583  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 11.56858491897583  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 16.4002685546875 GB
    Memory Allocated: 11.568819522857666  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4393310546875 GB
    Memory Allocated: 11.605183124542236  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([131, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.4393310546875 GB
    Memory Allocated: 11.607962131500244  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4393310546875 GB
    Memory Allocated: 11.607962131500244  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 131, 256]), torch.Size([1, 131, 256])
----------------------------------------3
 Nvidia-smi: 16.4393310546875 GB
    Memory Allocated: 11.608211994171143  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4842529296875 GB
    Memory Allocated: 11.64868974685669  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 131, 256])
m.shape torch.Size([93, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.4842529296875 GB
    Memory Allocated: 11.6508207321167  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4842529296875 GB
    Memory Allocated: 11.6508207321167  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 16.4842529296875 GB
    Memory Allocated: 11.65099811553955  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.5096435546875 GB
    Memory Allocated: 11.680975914001465  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([19385, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.5096435546875 GB
    Memory Allocated: 12.14667272567749  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.5096435546875 GB
    Memory Allocated: 12.14667272567749  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

 h.shape torch.Size([1, 19385, 256]), torch.Size([1, 19385, 256])
----------------------------------------3
 Nvidia-smi: 16.5096435546875 GB
    Memory Allocated: 12.18364667892456  GigaBytes
Max Memory Allocated: 18.796342849731445  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.0233154296875 GB
    Memory Allocated: 18.70538568496704  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 19385, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.0233154296875 GB
    Memory Allocated: 18.214150428771973  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.0233154296875 GB
    Memory Allocated: 18.21791934967041  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 21.0233154296875 GB
    Memory Allocated: 18.221688270568848  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 21.0233154296875 GB
    Memory Allocated: 18.217758655548096  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

torch.Size([21525, 47])
input nodes number: 180913
output nodes number: 21525
edges number: 516802
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.0233154296875 GB
    Memory Allocated: 18.21947717666626  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.0233154296875 GB
    Memory Allocated: 18.219477653503418  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.5213623046875 GB
    Memory Allocated: 0.24137067794799805  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

pseudo mini batch 5 input nodes size: 488258
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.5213623046875 GB
    Memory Allocated: 0.1946887969970703  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.5213623046875 GB
    Memory Allocated: 0.1946887969970703  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.5213623046875 GB
    Memory Allocated: 0.37657928466796875  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.5213623046875 GB
    Memory Allocated: 0.37674713134765625  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.5213623046875 GB
    Memory Allocated: 0.19091510772705078  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.5213623046875 GB
    Memory Allocated: 0.20984697341918945  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.5213623046875 GB
    Memory Allocated: 0.20984697341918945  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

first layer input nodes number: 488258
first layer output nodes number: 195388
edges number: 1936178
----------------------------------------before model layer 0
 Nvidia-smi: 21.5213623046875 GB
    Memory Allocated: 0.2160634994506836  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

torch.Size([488258, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.5213623046875 GB
    Memory Allocated: 0.2160634994506836  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

m.shape torch.Size([199, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9584808349609375  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9584808349609375  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 199, 100]), torch.Size([1, 199, 100])
----------------------------------------3
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9586296081542969  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9598169326782227  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 199, 100])
m.shape torch.Size([274, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9599471092224121  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9599471092224121  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 274, 100]), torch.Size([1, 274, 100])
----------------------------------------3
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9601521492004395  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.963219165802002  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 274, 100])
m.shape torch.Size([357, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9635157585144043  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9635157585144043  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 357, 100]), torch.Size([1, 357, 100])
----------------------------------------3
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9637818336486816  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9696354866027832  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 357, 100])
m.shape torch.Size([419, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9701271057128906  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9701271057128906  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 419, 100]), torch.Size([1, 419, 100])
----------------------------------------3
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9704399108886719  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9794998168945312  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 419, 100])
m.shape torch.Size([491, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9802579879760742  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9802579879760742  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 491, 100]), torch.Size([1, 491, 100])
----------------------------------------3
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9806241989135742  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9938006401062012  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 491, 100])
m.shape torch.Size([543, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9949908256530762  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9949908256530762  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 543, 100]), torch.Size([1, 543, 100])
----------------------------------------3
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 0.9953961372375488  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 1.01279878616333  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 543, 100])
m.shape torch.Size([666, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 1.0143332481384277  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 1.0143332481384277  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 666, 100]), torch.Size([1, 666, 100])
----------------------------------------3
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 1.0148301124572754  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 1.0410332679748535  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 666, 100])
m.shape torch.Size([676, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 1.042799472808838  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 1.042799472808838  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 676, 100]), torch.Size([1, 676, 100])
----------------------------------------3
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 1.0433039665222168  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 1.072458267211914  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 676, 100])
m.shape torch.Size([729, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 1.0746502876281738  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 1.0746502876281738  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 729, 100]), torch.Size([1, 729, 100])
----------------------------------------3
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 1.0751938819885254  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.2459716796875 GB
    Memory Allocated: 1.1104621887207031  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 729, 100])
m.shape torch.Size([191034, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.9588623046875 GB
    Memory Allocated: 1.821847915649414  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.9588623046875 GB
    Memory Allocated: 1.821847915649414  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 191034, 100]), torch.Size([1, 191034, 100])
----------------------------------------3
 Nvidia-smi: 22.9588623046875 GB
    Memory Allocated: 1.9641799926757812  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8709716796875 GB
    Memory Allocated: 12.070714950561523  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 191034, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 11.346601009368896  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 11.53293752670288  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 11.719274044036865  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 11.53293752670288  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

torch.Size([195388, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 11.719274044036865  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 11.765899181365967  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 11.765899181365967  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.304799556732178  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.304799556732178  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.304803371429443  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.304833889007568  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.304834365844727  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.304834365844727  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.30483627319336  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.304864883422852  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([20, 3, 256])
----------------------------------------1
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.304921627044678  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.304921627044678  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.304959774017334  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.305799007415771  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([10, 4, 256])
----------------------------------------1
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.305818557739258  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.305818557739258  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.305837631225586  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.306390762329102  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.306405544281006  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.306405544281006  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.30641508102417  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.306758403778076  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([12, 6, 256])
----------------------------------------1
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.306823253631592  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.306823253631592  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.306846141815186  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.307830333709717  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([9, 7, 256])
----------------------------------------1
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.307879447937012  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.307879447937012  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.307896614074707  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.308754920959473  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 8, 256])
----------------------------------------1
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.30878496170044  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.30878496170044  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.308794498443604  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.309338092803955  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([30, 9, 256])
----------------------------------------1
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.309593200683594  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.309593200683594  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.309650421142578  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.313312530517578  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([12, 10, 256])
----------------------------------------1
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.313399314880371  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.313399314880371  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.313422203063965  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.315047264099121  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 11, 256])
----------------------------------------1
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.315141677856445  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.315141677856445  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 17.8729248046875 GB
    Memory Allocated: 12.315160751342773  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8748779296875 GB
    Memory Allocated: 12.316648483276367  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 12, 256])
----------------------------------------1
 Nvidia-smi: 17.8748779296875 GB
    Memory Allocated: 12.316754341125488  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8748779296875 GB
    Memory Allocated: 12.316754341125488  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 17.8748779296875 GB
    Memory Allocated: 12.316773414611816  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8768310546875 GB
    Memory Allocated: 12.318394660949707  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 13, 256])
----------------------------------------1
 Nvidia-smi: 17.8768310546875 GB
    Memory Allocated: 12.31854772567749  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8768310546875 GB
    Memory Allocated: 12.31854772567749  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 17.8768310546875 GB
    Memory Allocated: 12.318572521209717  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8787841796875 GB
    Memory Allocated: 12.32085371017456  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([10, 14, 256])
----------------------------------------1
 Nvidia-smi: 17.8787841796875 GB
    Memory Allocated: 12.320976257324219  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8787841796875 GB
    Memory Allocated: 12.320976257324219  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 17.8787841796875 GB
    Memory Allocated: 12.320995330810547  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8807373046875 GB
    Memory Allocated: 12.322883605957031  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 17.8807373046875 GB
    Memory Allocated: 12.323321342468262  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8807373046875 GB
    Memory Allocated: 12.323321342468262  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 17.8807373046875 GB
    Memory Allocated: 12.323380470275879  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8885498046875 GB
    Memory Allocated: 12.3296480178833  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 17.8885498046875 GB
    Memory Allocated: 12.329972267150879  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8885498046875 GB
    Memory Allocated: 12.329972267150879  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 17.8885498046875 GB
    Memory Allocated: 12.330016136169434  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8924560546875 GB
    Memory Allocated: 12.334973335266113  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 17.8924560546875 GB
    Memory Allocated: 12.335196495056152  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8924560546875 GB
    Memory Allocated: 12.335196495056152  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 17.8924560546875 GB
    Memory Allocated: 12.335225105285645  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8963623046875 GB
    Memory Allocated: 12.338658332824707  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([25, 18, 256])
----------------------------------------1
 Nvidia-smi: 17.8983154296875 GB
    Memory Allocated: 12.33907699584961  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8983154296875 GB
    Memory Allocated: 12.33907699584961  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 17.8983154296875 GB
    Memory Allocated: 12.33912467956543  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 12.34518051147461  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([28, 19, 256])
----------------------------------------1
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 12.345668315887451  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 12.345668315887451  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 17.9041748046875 GB
    Memory Allocated: 12.34572172164917  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9119873046875 GB
    Memory Allocated: 12.352878093719482  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 17.9119873046875 GB
    Memory Allocated: 12.353158950805664  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9119873046875 GB
    Memory Allocated: 12.353158950805664  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 17.9119873046875 GB
    Memory Allocated: 12.353189468383789  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9158935546875 GB
    Memory Allocated: 12.357492446899414  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([30, 21, 256])
----------------------------------------1
 Nvidia-smi: 17.9158935546875 GB
    Memory Allocated: 12.35808277130127  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9158935546875 GB
    Memory Allocated: 12.35808277130127  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 17.9158935546875 GB
    Memory Allocated: 12.358139991760254  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9256591796875 GB
    Memory Allocated: 12.366608619689941  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 17.9256591796875 GB
    Memory Allocated: 12.367087841033936  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9256591796875 GB
    Memory Allocated: 12.367087841033936  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 17.9256591796875 GB
    Memory Allocated: 12.367133617401123  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9334716796875 GB
    Memory Allocated: 12.374228954315186  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 17.9334716796875 GB
    Memory Allocated: 12.374471664428711  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9334716796875 GB
    Memory Allocated: 12.374471664428711  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 17.9334716796875 GB
    Memory Allocated: 12.374494552612305  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 12.378202438354492  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 12.378767967224121  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 12.378767967224121  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 17.9373779296875 GB
    Memory Allocated: 12.378815650939941  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.9451904296875 GB
    Memory Allocated: 12.386874198913574  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22119, 25, 256])
----------------------------------------1
 Nvidia-smi: 17.9451904296875 GB
    Memory Allocated: 12.918328762054443  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.9451904296875 GB
    Memory Allocated: 12.918328762054443  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

 h.shape torch.Size([1, 22119, 256]), torch.Size([1, 22119, 256])
----------------------------------------3
 Nvidia-smi: 17.9451904296875 GB
    Memory Allocated: 12.960517406463623  GigaBytes
Max Memory Allocated: 19.16827630996704  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 20.397712230682373  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 22119, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 19.86412239074707  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 19.86819839477539  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 19.872137546539307  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 19.8678936958313  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

torch.Size([22497, 47])
input nodes number: 195388
output nodes number: 22497
edges number: 558632
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 19.86992883682251  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5135498046875 GB
    Memory Allocated: 19.869929313659668  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 0.24544906616210938  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

pseudo mini batch 6 input nodes size: 512082
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 0.1912221908569336  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 0.1912221908569336  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 0.3819880485534668  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 0.3821554183959961  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 0.20009708404541016  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 0.21920013427734375  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 0.21920013427734375  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

first layer input nodes number: 512082
first layer output nodes number: 200669
edges number: 1982174
----------------------------------------before model layer 0
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 0.22502994537353516  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

torch.Size([512082, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 23.0506591796875 GB
    Memory Allocated: 0.22502994537353516  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

m.shape torch.Size([291, 1, 100])
----------------------------------------1
 Nvidia-smi: 3.0252685546875 GB
    Memory Allocated: 0.9846768379211426  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0252685546875 GB
    Memory Allocated: 0.9846768379211426  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 291, 100]), torch.Size([1, 291, 100])
----------------------------------------3
 Nvidia-smi: 3.0252685546875 GB
    Memory Allocated: 0.9848942756652832  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0252685546875 GB
    Memory Allocated: 0.986630916595459  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 291, 100])
m.shape torch.Size([398, 2, 100])
----------------------------------------1
 Nvidia-smi: 3.0252685546875 GB
    Memory Allocated: 0.986818790435791  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0252685546875 GB
    Memory Allocated: 0.986818790435791  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 398, 100]), torch.Size([1, 398, 100])
----------------------------------------3
 Nvidia-smi: 3.0252685546875 GB
    Memory Allocated: 0.9871153831481934  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0252685546875 GB
    Memory Allocated: 0.9915642738342285  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 398, 100])
m.shape torch.Size([455, 3, 100])
----------------------------------------1
 Nvidia-smi: 3.0252685546875 GB
    Memory Allocated: 0.9919247627258301  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0252685546875 GB
    Memory Allocated: 0.9919247627258301  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 455, 100]), torch.Size([1, 455, 100])
----------------------------------------3
 Nvidia-smi: 3.0252685546875 GB
    Memory Allocated: 0.9922642707824707  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 0.9997248649597168  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 455, 100])
m.shape torch.Size([571, 4, 100])
----------------------------------------1
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.000406265258789  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.000406265258789  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 571, 100]), torch.Size([1, 571, 100])
----------------------------------------3
 Nvidia-smi: 3.0311279296875 GB
    Memory Allocated: 1.0008325576782227  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0447998046875 GB
    Memory Allocated: 1.0131778717041016  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 571, 100])
m.shape torch.Size([725, 5, 100])
----------------------------------------1
 Nvidia-smi: 3.0447998046875 GB
    Memory Allocated: 1.0143380165100098  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0447998046875 GB
    Memory Allocated: 1.0143380165100098  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 725, 100]), torch.Size([1, 725, 100])
----------------------------------------3
 Nvidia-smi: 3.0447998046875 GB
    Memory Allocated: 1.014878749847412  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0467529296875 GB
    Memory Allocated: 1.035067081451416  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 725, 100])
m.shape torch.Size([814, 6, 100])
----------------------------------------1
 Nvidia-smi: 3.0467529296875 GB
    Memory Allocated: 1.036616325378418  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0467529296875 GB
    Memory Allocated: 1.036616325378418  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 814, 100]), torch.Size([1, 814, 100])
----------------------------------------3
 Nvidia-smi: 3.0487060546875 GB
    Memory Allocated: 1.0372228622436523  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0526123046875 GB
    Memory Allocated: 1.0633039474487305  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 814, 100])
m.shape torch.Size([831, 7, 100])
----------------------------------------1
 Nvidia-smi: 3.0526123046875 GB
    Memory Allocated: 1.0651679039001465  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0526123046875 GB
    Memory Allocated: 1.0651679039001465  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 831, 100]), torch.Size([1, 831, 100])
----------------------------------------3
 Nvidia-smi: 3.0526123046875 GB
    Memory Allocated: 1.0657877922058105  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 1.0967521667480469  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 831, 100])
m.shape torch.Size([895, 8, 100])
----------------------------------------1
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 1.0991096496582031  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 1.0991096496582031  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 895, 100]), torch.Size([1, 895, 100])
----------------------------------------3
 Nvidia-smi: 3.0584716796875 GB
    Memory Allocated: 1.0997772216796875  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0662841796875 GB
    Memory Allocated: 1.1385560035705566  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 895, 100])
m.shape torch.Size([938, 9, 100])
----------------------------------------1
 Nvidia-smi: 3.0662841796875 GB
    Memory Allocated: 1.1413674354553223  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0662841796875 GB
    Memory Allocated: 1.1413674354553223  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 938, 100]), torch.Size([1, 938, 100])
----------------------------------------3
 Nvidia-smi: 3.0662841796875 GB
    Memory Allocated: 1.142066478729248  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 3.0740966796875 GB
    Memory Allocated: 1.186805248260498  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 938, 100])
m.shape torch.Size([194751, 10, 100])
----------------------------------------1
 Nvidia-smi: 3.8026123046875 GB
    Memory Allocated: 1.9119601249694824  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.8026123046875 GB
    Memory Allocated: 1.9119601249694824  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 194751, 100]), torch.Size([1, 194751, 100])
----------------------------------------3
 Nvidia-smi: 3.8026123046875 GB
    Memory Allocated: 2.0570616722106934  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.382833480834961  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 194751, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 11.64268159866333  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 11.834054470062256  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.025427341461182  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 11.834054470062256  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

torch.Size([200669, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.025427341461182  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.073270797729492  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.073270797729492  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.609647750854492  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.609647750854492  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.609651565551758  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.609682083129883  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.609690189361572  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.609690189361572  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.609699726104736  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.609842777252197  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.609864234924316  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.609864234924316  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.609881401062012  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.610259056091309  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.610289096832275  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.610289096832275  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.610308170318604  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.61086130142212  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.610899925231934  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.610899925231934  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.610918998718262  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.611605644226074  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.611630916595459  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.611630916595459  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.611642360687256  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.612134456634521  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([12, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.612209796905518  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.612209796905518  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.612232685089111  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.613377094268799  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.613473415374756  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.613473415374756  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.613500118255615  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.6150221824646  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.615156173706055  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.615156173706055  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.615188598632812  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.617263793945312  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.617440223693848  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.617440223693848  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.617478370666504  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.620186805725098  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([21, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.620389938354492  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.620389938354492  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 14.3787841796875 GB
    Memory Allocated: 12.620429992675781  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3826904296875 GB
    Memory Allocated: 12.623554229736328  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([25, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.3826904296875 GB
    Memory Allocated: 12.623822689056396  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3826904296875 GB
    Memory Allocated: 12.623822689056396  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 14.3826904296875 GB
    Memory Allocated: 12.623870372772217  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3865966796875 GB
    Memory Allocated: 12.627923488616943  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([15, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.3865966796875 GB
    Memory Allocated: 12.628087520599365  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3865966796875 GB
    Memory Allocated: 12.628087520599365  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 14.3865966796875 GB
    Memory Allocated: 12.628116130828857  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3885498046875 GB
    Memory Allocated: 12.630748271942139  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.3885498046875 GB
    Memory Allocated: 12.6309494972229  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3885498046875 GB
    Memory Allocated: 12.6309494972229  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 14.3885498046875 GB
    Memory Allocated: 12.630980014801025  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3924560546875 GB
    Memory Allocated: 12.6340012550354  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.3924560546875 GB
    Memory Allocated: 12.634245872497559  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3924560546875 GB
    Memory Allocated: 12.634245872497559  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 14.3924560546875 GB
    Memory Allocated: 12.63428020477295  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3963623046875 GB
    Memory Allocated: 12.637919425964355  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.3963623046875 GB
    Memory Allocated: 12.638225555419922  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3963623046875 GB
    Memory Allocated: 12.638225555419922  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 14.3963623046875 GB
    Memory Allocated: 12.638265609741211  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.4022216796875 GB
    Memory Allocated: 12.642791748046875  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([13, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.4022216796875 GB
    Memory Allocated: 12.642984390258789  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.4022216796875 GB
    Memory Allocated: 12.642984390258789  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 14.4022216796875 GB
    Memory Allocated: 12.643009185791016  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.4041748046875 GB
    Memory Allocated: 12.645984649658203  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([22, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.4041748046875 GB
    Memory Allocated: 12.646353244781494  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.4041748046875 GB
    Memory Allocated: 12.646353244781494  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 14.4041748046875 GB
    Memory Allocated: 12.646395206451416  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.4100341796875 GB
    Memory Allocated: 12.651724338531494  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.4100341796875 GB
    Memory Allocated: 12.652087211608887  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.4100341796875 GB
    Memory Allocated: 12.652087211608887  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 14.4100341796875 GB
    Memory Allocated: 12.652127265930176  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.4158935546875 GB
    Memory Allocated: 12.65749454498291  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.4158935546875 GB
    Memory Allocated: 12.657897472381592  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.4158935546875 GB
    Memory Allocated: 12.657897472381592  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 14.4158935546875 GB
    Memory Allocated: 12.657939434051514  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 12.663856029510498  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([21, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 12.66425895690918  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 12.66425895690918  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 14.4217529296875 GB
    Memory Allocated: 12.664299011230469  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.4295654296875 GB
    Memory Allocated: 12.67022705078125  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.4295654296875 GB
    Memory Allocated: 12.670756816864014  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.4295654296875 GB
    Memory Allocated: 12.670756816864014  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 14.4295654296875 GB
    Memory Allocated: 12.670806407928467  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.4373779296875 GB
    Memory Allocated: 12.678493022918701  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.4373779296875 GB
    Memory Allocated: 12.678888320922852  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.4373779296875 GB
    Memory Allocated: 12.678888320922852  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 14.4373779296875 GB
    Memory Allocated: 12.678924560546875  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.4432373046875 GB
    Memory Allocated: 12.684795379638672  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([37, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.4451904296875 GB
    Memory Allocated: 12.685630798339844  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.4451904296875 GB
    Memory Allocated: 12.685630798339844  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 14.4451904296875 GB
    Memory Allocated: 12.685701370239258  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.4569091796875 GB
    Memory Allocated: 12.697628021240234  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([22009, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 13.227083206176758  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 13.227083206176758  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

 h.shape torch.Size([1, 22009, 256]), torch.Size([1, 22009, 256])
----------------------------------------3
 Nvidia-smi: 14.9822998046875 GB
    Memory Allocated: 13.269062042236328  GigaBytes
Max Memory Allocated: 20.92507028579712  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.5213623046875 GB
    Memory Allocated: 20.681532859802246  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 22009, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.5213623046875 GB
    Memory Allocated: 20.15007448196411  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.5213623046875 GB
    Memory Allocated: 20.153998851776123  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.5213623046875 GB
    Memory Allocated: 20.157923221588135  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.5213623046875 GB
    Memory Allocated: 20.153831481933594  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

torch.Size([22411, 47])
input nodes number: 200669
output nodes number: 22411
edges number: 556289
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5213623046875 GB
    Memory Allocated: 20.15551519393921  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5213623046875 GB
    Memory Allocated: 20.155515670776367  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.252199649810791  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

pseudo mini batch 7 input nodes size: 512130
----------------------------------------before load block subtensor 
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.19994544982910156  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.19994544982910156  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.3907289505004883  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.3908877372741699  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.19995450973510742  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.21601533889770508  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.21601533889770508  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

first layer input nodes number: 512130
first layer output nodes number: 169780
edges number: 1667416
----------------------------------------before model layer 0
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.22129297256469727  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

torch.Size([512130, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.22129297256469727  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

m.shape torch.Size([286, 1, 100])
----------------------------------------1
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.8605327606201172  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.8605327606201172  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 286, 100]), torch.Size([1, 286, 100])
----------------------------------------3
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.8607463836669922  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.862452507019043  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 286, 100])
m.shape torch.Size([423, 2, 100])
----------------------------------------1
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.8626608848571777  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.8626608848571777  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 423, 100]), torch.Size([1, 423, 100])
----------------------------------------3
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.8629765510559082  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.8677058219909668  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 423, 100])
m.shape torch.Size([681, 3, 100])
----------------------------------------1
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.868309497833252  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.868309497833252  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 681, 100]), torch.Size([1, 681, 100])
----------------------------------------3
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.8688178062438965  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.8816637992858887  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 681, 100])
m.shape torch.Size([799, 4, 100])
----------------------------------------1
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.8826003074645996  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.8826003074645996  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 799, 100]), torch.Size([1, 799, 100])
----------------------------------------3
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.8831963539123535  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.9004645347595215  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 799, 100])
m.shape torch.Size([845, 5, 100])
----------------------------------------1
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.901740550994873  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.901740550994873  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 845, 100]), torch.Size([1, 845, 100])
----------------------------------------3
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.9023709297180176  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.9251699447631836  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 845, 100])
m.shape torch.Size([963, 6, 100])
----------------------------------------1
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.9270076751708984  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.9270076751708984  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 963, 100]), torch.Size([1, 963, 100])
----------------------------------------3
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.9277257919311523  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.9588532447814941  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 963, 100])
m.shape torch.Size([1148, 7, 100])
----------------------------------------1
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.9614882469177246  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.9614882469177246  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 1148, 100]), torch.Size([1, 1148, 100])
----------------------------------------3
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 0.962343692779541  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 1.0065670013427734  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 1148, 100])
m.shape torch.Size([1110, 8, 100])
----------------------------------------1
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 1.0094475746154785  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 1.0094475746154785  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 1110, 100]), torch.Size([1, 1110, 100])
----------------------------------------3
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 1.0102753639221191  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 1.0574250221252441  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 1110, 100])
m.shape torch.Size([1124, 9, 100])
----------------------------------------1
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 1.0607800483703613  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 1.0607800483703613  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 1124, 100]), torch.Size([1, 1124, 100])
----------------------------------------3
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 1.0616183280944824  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 1.115229606628418  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 1124, 100])
m.shape torch.Size([162401, 10, 100])
----------------------------------------1
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 1.719801425933838  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 1.719801425933838  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 162401, 100]), torch.Size([1, 162401, 100])
----------------------------------------3
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 1.8407998085021973  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.431684970855713  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 162401, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 9.809737205505371  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 9.971652030944824  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.133566856384277  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 9.971652030944824  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

torch.Size([169780, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.133566856384277  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.17404556274414  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.17404556274414  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

m.shape torch.Size([31, 1, 256])
----------------------------------------1
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.644948482513428  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.644948482513428  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.645007610321045  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.645480632781982  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([51, 2, 256])
----------------------------------------1
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.645549297332764  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.645549297332764  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.645646572113037  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.647105693817139  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([134, 3, 256])
----------------------------------------1
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.647443771362305  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.647443771362305  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.647699356079102  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.653322219848633  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([150, 4, 256])
----------------------------------------1
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.65377140045166  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.65377140045166  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.654057502746582  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.662354469299316  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([150, 5, 256])
----------------------------------------1
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.662932395935059  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.662932395935059  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.66321849822998  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.673518180847168  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([194, 6, 256])
----------------------------------------1
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.674594402313232  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.674594402313232  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 194, 256]), torch.Size([1, 194, 256])
----------------------------------------3
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.674964427947998  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.69087553024292  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 194, 256])
m.shape torch.Size([267, 7, 256])
----------------------------------------1
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.692487239837646  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.692487239837646  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 267, 256]), torch.Size([1, 267, 256])
----------------------------------------3
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.692996501922607  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.722300052642822  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 267, 256])
m.shape torch.Size([137, 8, 256])
----------------------------------------1
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.72309923171997  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.72309923171997  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.723360538482666  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.738255023956299  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([154, 9, 256])
----------------------------------------1
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.73945665359497  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.73945665359497  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 154, 256]), torch.Size([1, 154, 256])
----------------------------------------3
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.739750385284424  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.758549213409424  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 154, 256])
m.shape torch.Size([201, 10, 256])
----------------------------------------1
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.760334491729736  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.760334491729736  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 201, 256]), torch.Size([1, 201, 256])
----------------------------------------3
 Nvidia-smi: 23.5877685546875 GB
    Memory Allocated: 10.760717868804932  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 10.787937641143799  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 201, 256])
m.shape torch.Size([172, 11, 256])
----------------------------------------1
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 10.789564609527588  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 10.789564609527588  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 172, 256]), torch.Size([1, 172, 256])
----------------------------------------3
 Nvidia-smi: 23.6014404296875 GB
    Memory Allocated: 10.789892673492432  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5350341796875 GB
    Memory Allocated: 10.815481662750244  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 172, 256])
m.shape torch.Size([152, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.5350341796875 GB
    Memory Allocated: 10.817870140075684  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5350341796875 GB
    Memory Allocated: 10.817870140075684  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 14.5350341796875 GB
    Memory Allocated: 10.818160057067871  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5526123046875 GB
    Memory Allocated: 10.842803001403809  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([145, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.5526123046875 GB
    Memory Allocated: 10.844470024108887  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5526123046875 GB
    Memory Allocated: 10.844470024108887  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 145, 256]), torch.Size([1, 145, 256])
----------------------------------------3
 Nvidia-smi: 14.5526123046875 GB
    Memory Allocated: 10.844746589660645  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5799560546875 GB
    Memory Allocated: 10.870190620422363  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 145, 256])
m.shape torch.Size([224, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.5799560546875 GB
    Memory Allocated: 10.873066425323486  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.5799560546875 GB
    Memory Allocated: 10.873066425323486  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 224, 256]), torch.Size([1, 224, 256])
----------------------------------------3
 Nvidia-smi: 14.5799560546875 GB
    Memory Allocated: 10.873493671417236  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6229248046875 GB
    Memory Allocated: 10.915791034698486  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 224, 256])
m.shape torch.Size([205, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.6229248046875 GB
    Memory Allocated: 10.918533325195312  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6229248046875 GB
    Memory Allocated: 10.918533325195312  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 14.6229248046875 GB
    Memory Allocated: 10.918924331665039  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6697998046875 GB
    Memory Allocated: 10.960371017456055  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([152, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.6697998046875 GB
    Memory Allocated: 10.962512969970703  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6697998046875 GB
    Memory Allocated: 10.962512969970703  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 152, 256]), torch.Size([1, 152, 256])
----------------------------------------3
 Nvidia-smi: 14.6697998046875 GB
    Memory Allocated: 10.96280288696289  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.6990966796875 GB
    Memory Allocated: 10.995563507080078  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 152, 256])
m.shape torch.Size([116, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.6990966796875 GB
    Memory Allocated: 10.997313976287842  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.6990966796875 GB
    Memory Allocated: 10.997313976287842  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 14.6990966796875 GB
    Memory Allocated: 10.997535228729248  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7244873046875 GB
    Memory Allocated: 11.024085521697998  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([143, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.7244873046875 GB
    Memory Allocated: 11.026449203491211  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7244873046875 GB
    Memory Allocated: 11.026449203491211  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 14.7264404296875 GB
    Memory Allocated: 11.026721954345703  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7615966796875 GB
    Memory Allocated: 11.061361312866211  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([102, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.7615966796875 GB
    Memory Allocated: 11.063087940216064  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7615966796875 GB
    Memory Allocated: 11.063087940216064  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 14.7615966796875 GB
    Memory Allocated: 11.063282489776611  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.7869873046875 GB
    Memory Allocated: 11.089352130889893  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([151, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.7869873046875 GB
    Memory Allocated: 11.09215784072876  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.7869873046875 GB
    Memory Allocated: 11.09215784072876  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 14.7869873046875 GB
    Memory Allocated: 11.092445850372314  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8299560546875 GB
    Memory Allocated: 11.133055210113525  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([123, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.8299560546875 GB
    Memory Allocated: 11.135394096374512  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8299560546875 GB
    Memory Allocated: 11.135394096374512  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 123, 256]), torch.Size([1, 123, 256])
----------------------------------------3
 Nvidia-smi: 14.8299560546875 GB
    Memory Allocated: 11.135628700256348  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8651123046875 GB
    Memory Allocated: 11.170350074768066  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 123, 256])
m.shape torch.Size([108, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.8651123046875 GB
    Memory Allocated: 11.172516822814941  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8651123046875 GB
    Memory Allocated: 11.172516822814941  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 14.8651123046875 GB
    Memory Allocated: 11.172722816467285  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.8983154296875 GB
    Memory Allocated: 11.204651832580566  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([162, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.8983154296875 GB
    Memory Allocated: 11.208130359649658  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8983154296875 GB
    Memory Allocated: 11.208130359649658  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 162, 256]), torch.Size([1, 162, 256])
----------------------------------------3
 Nvidia-smi: 14.8983154296875 GB
    Memory Allocated: 11.208439350128174  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.9510498046875 GB
    Memory Allocated: 11.258495807647705  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 162, 256])
m.shape torch.Size([170, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.9510498046875 GB
    Memory Allocated: 11.26226282119751  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.9510498046875 GB
    Memory Allocated: 11.26226282119751  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 170, 256]), torch.Size([1, 170, 256])
----------------------------------------3
 Nvidia-smi: 14.9530029296875 GB
    Memory Allocated: 11.262587070465088  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0076904296875 GB
    Memory Allocated: 11.317385196685791  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 170, 256])
m.shape torch.Size([17690, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.4295654296875 GB
    Memory Allocated: 11.742393493652344  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4295654296875 GB
    Memory Allocated: 11.742393493652344  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 17690, 256]), torch.Size([1, 17690, 256])
----------------------------------------3
 Nvidia-smi: 15.4295654296875 GB
    Memory Allocated: 11.776134490966797  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.4315185546875 GB
    Memory Allocated: 17.773334503173828  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 17690, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 20.4315185546875 GB
    Memory Allocated: 17.31078577041626  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 20.4315185546875 GB
    Memory Allocated: 17.314651489257812  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 20.4315185546875 GB
    Memory Allocated: 17.318378448486328  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 20.4315185546875 GB
    Memory Allocated: 17.314353942871094  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

torch.Size([21284, 47])
input nodes number: 169780
output nodes number: 21284
edges number: 488173
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.4315185546875 GB
    Memory Allocated: 17.31625270843506  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.4315185546875 GB
    Memory Allocated: 17.316253185272217  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.24509716033935547  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

pseudo mini batch 8 input nodes size: 447821
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.19989585876464844  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.19989585876464844  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.36672258377075195  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.36689043045043945  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.1759481430053711  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.1947345733642578  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.1947345733642578  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

first layer input nodes number: 447821
first layer output nodes number: 191782
edges number: 1897166
----------------------------------------before model layer 0
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.19950056076049805  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

torch.Size([447821, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.19950056076049805  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

m.shape torch.Size([244, 1, 100])
----------------------------------------1
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9261975288391113  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9261975288391113  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 244, 100]), torch.Size([1, 244, 100])
----------------------------------------3
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9263796806335449  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9278354644775391  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 244, 100])
m.shape torch.Size([356, 2, 100])
----------------------------------------1
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9280099868774414  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9280099868774414  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 356, 100]), torch.Size([1, 356, 100])
----------------------------------------3
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9282760620117188  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9322586059570312  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 356, 100])
m.shape torch.Size([380, 3, 100])
----------------------------------------1
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9325504302978516  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9325504302978516  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 380, 100]), torch.Size([1, 380, 100])
----------------------------------------3
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9328336715698242  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9390649795532227  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 380, 100])
m.shape torch.Size([467, 4, 100])
----------------------------------------1
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9396195411682129  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9396195411682129  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 467, 100]), torch.Size([1, 467, 100])
----------------------------------------3
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9399676322937012  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9500622749328613  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 467, 100])
m.shape torch.Size([563, 5, 100])
----------------------------------------1
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.951202392578125  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.951202392578125  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 563, 100]), torch.Size([1, 563, 100])
----------------------------------------3
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9516220092773438  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9667282104492188  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 563, 100])
m.shape torch.Size([617, 6, 100])
----------------------------------------1
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.967897891998291  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.967897891998291  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 617, 100]), torch.Size([1, 617, 100])
----------------------------------------3
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9683585166931152  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9881396293640137  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 617, 100])
m.shape torch.Size([767, 7, 100])
----------------------------------------1
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9899096488952637  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9899096488952637  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 767, 100]), torch.Size([1, 767, 100])
----------------------------------------3
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 0.9904818534851074  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 1.0195364952087402  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 767, 100])
m.shape torch.Size([798, 8, 100])
----------------------------------------1
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 1.0216288566589355  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 1.0216288566589355  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 798, 100]), torch.Size([1, 798, 100])
----------------------------------------3
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 1.022223949432373  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 1.0564770698547363  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 798, 100])
m.shape torch.Size([968, 9, 100])
----------------------------------------1
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 1.0594253540039062  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 1.0594253540039062  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 968, 100]), torch.Size([1, 968, 100])
----------------------------------------3
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 1.0601472854614258  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3690185546875 GB
    Memory Allocated: 1.106459140777588  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 968, 100])
m.shape torch.Size([186622, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.0643310546875 GB
    Memory Allocated: 1.8014106750488281  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.0643310546875 GB
    Memory Allocated: 1.8014106750488281  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 186622, 100]), torch.Size([1, 186622, 100])
----------------------------------------3
 Nvidia-smi: 22.0643310546875 GB
    Memory Allocated: 1.940455436706543  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 11.812604904174805  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 186622, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 11.104197978973389  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 11.287095546722412  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 11.469993114471436  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 11.287095546722412  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

torch.Size([191782, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 11.469993114471436  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 11.515717506408691  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 11.515717506408691  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.054733753204346  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.054733753204346  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.054735660552979  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.054750919342041  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([10, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.054769515991211  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.054769515991211  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.054788589477539  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.055074691772461  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([14, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.055105686187744  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.055105686187744  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.055132389068604  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.05571985244751  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.055779933929443  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.055779933929443  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.055816173553467  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.056867122650146  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.056878089904785  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.056878089904785  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.056889533996582  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.05730152130127  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.057342052459717  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.057342052459717  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.05735731124878  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.058013439178467  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([12, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.05808687210083  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.05808687210083  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.058109760284424  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.059254169464111  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.059304237365723  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.059304237365723  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.059319496154785  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.060189247131348  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([12, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.060285568237305  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.060285568237305  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.060308456420898  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.061773300170898  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.061790943145752  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.061790943145752  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.06179666519165  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.06220293045044  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.06224250793457  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.06224250793457  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.062250137329102  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.062845230102539  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([18, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.06304931640625  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.06304931640625  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.06308364868164  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.066001892089844  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.066222190856934  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.066222190856934  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.066258430480957  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.069592475891113  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([21, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.069857120513916  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.069857120513916  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.069897174835205  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.073862552642822  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([3, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.073885917663574  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.073885917663574  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.073891639709473  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.074498176574707  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.074603080749512  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.074603080749512  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.074616432189941  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.076125144958496  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.076249599456787  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.076249599456787  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.07626485824585  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.07809591293335  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.07824420928955  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.07824420928955  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.078261375427246  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.08044147491455  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([26, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.080907821655273  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.080907821655273  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.080957412719727  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.087602615356445  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.087770462036133  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.087770462036133  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.087789535522461  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.090478897094727  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.090752124786377  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.090752124786377  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.090778827667236  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.094730854034424  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.094950199127197  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.094950199127197  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.094971179962158  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.098223209381104  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.098655223846436  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.098655223846436  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.098693370819092  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.104873180389404  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.105431079864502  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.105431079864502  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.105478763580322  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.113537311553955  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22207, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.647665977478027  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.647665977478027  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

 h.shape torch.Size([1, 22207, 256]), torch.Size([1, 22207, 256])
----------------------------------------3
 Nvidia-smi: 22.7596435546875 GB
    Memory Allocated: 12.690634727478027  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.5877685546875 GB
    Memory Allocated: 20.152069091796875  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

rst.shape  torch.Size([1, 22207, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.5877685546875 GB
    Memory Allocated: 19.61799716949463  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.5877685546875 GB
    Memory Allocated: 19.62269353866577  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.5877685546875 GB
    Memory Allocated: 19.627389907836914  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.5877685546875 GB
    Memory Allocated: 19.622525691986084  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

torch.Size([22495, 47])
input nodes number: 191782
output nodes number: 22495
edges number: 559224
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5877685546875 GB
    Memory Allocated: 19.624980926513672  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5877685546875 GB
    Memory Allocated: 19.62498140335083  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.22713041305541992  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.23221731185913086  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 23.1268310546875 GB
    Memory Allocated: 0.23221731185913086  GigaBytes
Max Memory Allocated: 21.206923484802246  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.1444280677371555 |0.04763274722629123 |0.4303601053025987 |0.00011560651991102431 |0.21377367443508571 |0.005426168441772461 |
----------------------------------------------------------pseudo_mini_loss sum 5.388420104980469
Total (block generation + training)time/epoch 77.79802179336548
* Pure training time/epoch 7.532217979431152
Training time/epoch 7.631721258163452
Training time without block to device /epoch 7.203026533126831
Training time without total dataloading part /epoch 5.803670644760132
load block tensor time/epoch 1.2998526096343994
block to device time/epoch 0.4286947250366211
input features size transfer per epoch 1.2069940567016602e-06
blocks size to device per epoch 8.046627044677734e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  5750521
Number of first layer input nodes during this epoch:  4155369
Number of first layer output nodes during this epoch:  1595152
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  682400
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([400, 100])
layers.0.lstm.weight_hh_l0, torch.Size([400, 100])
layers.0.lstm.bias_ih_l0, torch.Size([400])
layers.0.lstm.bias_hh_l0, torch.Size([400])
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([47, 256])
layers.1.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
