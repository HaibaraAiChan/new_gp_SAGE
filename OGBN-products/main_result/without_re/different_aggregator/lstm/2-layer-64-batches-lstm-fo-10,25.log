main start at this time 1655788656.2067735
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.4228963851928711
global_2_local spend time (sec) 0.3969087600708008
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.049826860427856445
A = g.adjacency_matrix() spent  0.07698702812194824
auxiliary_graph
Graph(num_nodes=1205586, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.6040284633636475
remove nodes length
1009015
auxiliary_graph.remove_nodes spent  2.835005283355713
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.074172258377075

the counter of shared neighbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
51547892
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 51547889, 51547890, 51547891])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
Convert a graph into a bidirected graph: 2.960 seconds
Metis partitioning: 14.129 seconds
Split the graph: 0.681 seconds
Construct subgraphs: 0.357 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  18.149543285369873
3142
3093
3162
3131
3018
3156
3133
3055
3161
2984
3117
3111
2981
3131
3135
2993
2981
3014
2997
3106
2985
2991
2981
2981
2994
3163
2981
2981
3162
3088
3163
3116
2985
3138
3006
3089
3064
3144
3024
3109
3101
2981
2981
2983
2981
2985
3028
2982
3055
3158
3163
3141
3131
3092
3160
3142
2992
3163
3163
2982
3163
2982
3162
3154
total k batches seeds list generation spend  39.67922329902649
after graph partition
graph partition algorithm spend time 40.12853503227234
3142
3093
3162
3131
3018
3156
3133
3055
3161
2984
3117
3111
2981
3131
3135
2993
2981
3014
2997
3106
2985
2991
2981
2981
2994
3163
2981
2981
3162
3088
3163
3116
2985
3138
3006
3089
3064
3144
3024
3109
3101
2981
2981
2983
2981
2985
3028
2982
3055
3158
3163
3141
3131
3092
3160
3142
2992
3163
3163
2982
3163
2982
3162
3154
partition_len_list
[25205, 26080, 34695, 33336, 32645, 36635, 26220, 23893, 29752, 28455, 36427, 34049, 31056, 29865, 26088, 35820, 32160, 27907, 24086, 28677, 28109, 27577, 30715, 29697, 29762, 29779, 32437, 33077, 32745, 28041, 38855, 39249, 24966, 29094, 38359, 25764, 40809, 32803, 29953, 38176, 32568, 32591, 36946, 33636, 33349, 30219, 29334, 30663, 27039, 34066, 35524, 38038, 41308, 34728, 29927, 38281, 40361, 38002, 38261, 37174, 39068, 38704, 33800, 32582]
shared_neighbor_graph_partition_s0 selection method  spend 40.780566692352295
time for parepare:  0.2438352108001709
local_output_nid generation:  0.0011663436889648438
local_in_edges_tensor generation:  0.0015826225280761719
mini_batch_src_global generation:  0.003031015396118164
r_  generation:  0.026569843292236328
local_output_nid generation:  0.0012087821960449219
local_in_edges_tensor generation:  0.0014195442199707031
mini_batch_src_global generation:  0.003530263900756836
r_  generation:  0.024744749069213867
local_output_nid generation:  0.0013189315795898438
local_in_edges_tensor generation:  0.017518281936645508
mini_batch_src_global generation:  0.002937793731689453
r_  generation:  0.026613950729370117
local_output_nid generation:  0.001245737075805664
local_in_edges_tensor generation:  0.0014176368713378906
mini_batch_src_global generation:  0.0028014183044433594
r_  generation:  0.026826858520507812
local_output_nid generation:  0.0012695789337158203
local_in_edges_tensor generation:  0.0013506412506103516
mini_batch_src_global generation:  0.0024080276489257812
r_  generation:  0.02601313591003418
local_output_nid generation:  0.0013306140899658203
local_in_edges_tensor generation:  0.001390218734741211
mini_batch_src_global generation:  0.002698659896850586
r_  generation:  0.027605772018432617
local_output_nid generation:  0.0013124942779541016
local_in_edges_tensor generation:  0.0013394355773925781
mini_batch_src_global generation:  0.002628803253173828
r_  generation:  0.027425765991210938
local_output_nid generation:  0.001283884048461914
local_in_edges_tensor generation:  0.002034425735473633
mini_batch_src_global generation:  0.0029718875885009766
r_  generation:  0.024050235748291016
local_output_nid generation:  0.001325368881225586
local_in_edges_tensor generation:  0.0013480186462402344
mini_batch_src_global generation:  0.002220630645751953
r_  generation:  0.024719715118408203
local_output_nid generation:  0.0012693405151367188
local_in_edges_tensor generation:  0.0012733936309814453
mini_batch_src_global generation:  0.002091646194458008
r_  generation:  0.024945974349975586
local_output_nid generation:  0.0013852119445800781
local_in_edges_tensor generation:  0.006271839141845703
mini_batch_src_global generation:  0.002955913543701172
r_  generation:  0.026570558547973633
local_output_nid generation:  0.0013175010681152344
local_in_edges_tensor generation:  0.004765748977661133
mini_batch_src_global generation:  0.002275705337524414
r_  generation:  0.025686264038085938
local_output_nid generation:  0.0012574195861816406
local_in_edges_tensor generation:  0.0036039352416992188
mini_batch_src_global generation:  0.0021386146545410156
r_  generation:  0.024701833724975586
local_output_nid generation:  0.0024602413177490234
local_in_edges_tensor generation:  0.0030438899993896484
mini_batch_src_global generation:  0.002295970916748047
r_  generation:  0.025246381759643555
local_output_nid generation:  0.0013871192932128906
local_in_edges_tensor generation:  0.002493619918823242
mini_batch_src_global generation:  0.002173185348510742
r_  generation:  0.024376630783081055
local_output_nid generation:  0.001260519027709961
local_in_edges_tensor generation:  0.0021066665649414062
mini_batch_src_global generation:  0.0021300315856933594
r_  generation:  0.024042367935180664
local_output_nid generation:  0.0012426376342773438
local_in_edges_tensor generation:  0.0017883777618408203
mini_batch_src_global generation:  0.0020732879638671875
r_  generation:  0.025186538696289062
local_output_nid generation:  0.0012745857238769531
local_in_edges_tensor generation:  0.0017654895782470703
mini_batch_src_global generation:  0.0020618438720703125
r_  generation:  0.023273229598999023
local_output_nid generation:  0.0012485980987548828
local_in_edges_tensor generation:  0.0015208721160888672
mini_batch_src_global generation:  0.0020360946655273438
r_  generation:  0.02313685417175293
local_output_nid generation:  0.0012896060943603516
local_in_edges_tensor generation:  0.0014698505401611328
mini_batch_src_global generation:  0.0021038055419921875
r_  generation:  0.02368760108947754
local_output_nid generation:  0.0012483596801757812
local_in_edges_tensor generation:  0.001359701156616211
mini_batch_src_global generation:  0.0021386146545410156
r_  generation:  0.023511409759521484
local_output_nid generation:  0.0012712478637695312
local_in_edges_tensor generation:  0.001514434814453125
mini_batch_src_global generation:  0.002066373825073242
r_  generation:  0.02348160743713379
local_output_nid generation:  0.0012500286102294922
local_in_edges_tensor generation:  0.0012240409851074219
mini_batch_src_global generation:  0.00202178955078125
r_  generation:  0.02282571792602539
local_output_nid generation:  0.0012521743774414062
local_in_edges_tensor generation:  0.0012431144714355469
mini_batch_src_global generation:  0.0021164417266845703
r_  generation:  0.023556232452392578
local_output_nid generation:  0.0012590885162353516
local_in_edges_tensor generation:  0.0012884140014648438
mini_batch_src_global generation:  0.002091646194458008
r_  generation:  0.023763418197631836
local_output_nid generation:  0.0013277530670166016
local_in_edges_tensor generation:  0.001302480697631836
mini_batch_src_global generation:  0.0026237964630126953
r_  generation:  0.02498793601989746
local_output_nid generation:  0.0012733936309814453
local_in_edges_tensor generation:  0.0012362003326416016
mini_batch_src_global generation:  0.002125263214111328
r_  generation:  0.02457451820373535
local_output_nid generation:  0.0012655258178710938
local_in_edges_tensor generation:  0.0012824535369873047
mini_batch_src_global generation:  0.0020661354064941406
r_  generation:  0.023417234420776367
local_output_nid generation:  0.001332998275756836
local_in_edges_tensor generation:  0.0014796257019042969
mini_batch_src_global generation:  0.0021932125091552734
r_  generation:  0.0257108211517334
local_output_nid generation:  0.0012879371643066406
local_in_edges_tensor generation:  0.0013930797576904297
mini_batch_src_global generation:  0.002204418182373047
r_  generation:  0.024446725845336914
local_output_nid generation:  0.0013277530670166016
local_in_edges_tensor generation:  0.0014286041259765625
mini_batch_src_global generation:  0.0023272037506103516
r_  generation:  0.026152849197387695
local_output_nid generation:  0.0013179779052734375
local_in_edges_tensor generation:  0.0014107227325439453
mini_batch_src_global generation:  0.002315998077392578
r_  generation:  0.026040077209472656
local_output_nid generation:  0.0012650489807128906
local_in_edges_tensor generation:  0.0015954971313476562
mini_batch_src_global generation:  0.0021038055419921875
r_  generation:  0.023699522018432617
local_output_nid generation:  0.0013415813446044922
local_in_edges_tensor generation:  0.0013015270233154297
mini_batch_src_global generation:  0.00215911865234375
r_  generation:  0.02419590950012207
local_output_nid generation:  0.0012695789337158203
local_in_edges_tensor generation:  0.0012328624725341797
mini_batch_src_global generation:  0.002164602279663086
r_  generation:  0.02372288703918457
local_output_nid generation:  0.0012969970703125
local_in_edges_tensor generation:  0.0013065338134765625
mini_batch_src_global generation:  0.002085447311401367
r_  generation:  0.02421092987060547
local_output_nid generation:  0.0012936592102050781
local_in_edges_tensor generation:  0.0012900829315185547
mini_batch_src_global generation:  0.0021228790283203125
r_  generation:  0.02443981170654297
local_output_nid generation:  0.0013206005096435547
local_in_edges_tensor generation:  0.0013382434844970703
mini_batch_src_global generation:  0.0022530555725097656
r_  generation:  0.026230335235595703
local_output_nid generation:  0.0012636184692382812
local_in_edges_tensor generation:  0.0012700557708740234
mini_batch_src_global generation:  0.0021638870239257812
r_  generation:  0.023212432861328125
local_output_nid generation:  0.0034432411193847656
local_in_edges_tensor generation:  0.0014040470123291016
mini_batch_src_global generation:  0.0022783279418945312
r_  generation:  0.025601625442504883
local_output_nid generation:  0.0016188621520996094
local_in_edges_tensor generation:  0.001508474349975586
mini_batch_src_global generation:  0.002229928970336914
r_  generation:  0.024733304977416992
local_output_nid generation:  0.0012962818145751953
local_in_edges_tensor generation:  0.0014026165008544922
mini_batch_src_global generation:  0.0019588470458984375
r_  generation:  0.020909547805786133
local_output_nid generation:  0.002317190170288086
local_in_edges_tensor generation:  0.0012471675872802734
mini_batch_src_global generation:  0.0019965171813964844
r_  generation:  0.023630857467651367
local_output_nid generation:  0.0014367103576660156
local_in_edges_tensor generation:  0.0012025833129882812
mini_batch_src_global generation:  0.0018377304077148438
r_  generation:  0.020965099334716797
local_output_nid generation:  0.0012845993041992188
local_in_edges_tensor generation:  0.0013048648834228516
mini_batch_src_global generation:  0.0025453567504882812
r_  generation:  0.02316141128540039
local_output_nid generation:  0.001241922378540039
local_in_edges_tensor generation:  0.0012476444244384766
mini_batch_src_global generation:  0.002040863037109375
r_  generation:  0.022786617279052734
local_output_nid generation:  0.001272439956665039
local_in_edges_tensor generation:  0.0012936592102050781
mini_batch_src_global generation:  0.002903461456298828
r_  generation:  0.024074316024780273
local_output_nid generation:  0.0012443065643310547
local_in_edges_tensor generation:  0.0012314319610595703
mini_batch_src_global generation:  0.002031564712524414
r_  generation:  0.022060394287109375
local_output_nid generation:  0.001280069351196289
local_in_edges_tensor generation:  0.0013515949249267578
mini_batch_src_global generation:  0.002622365951538086
r_  generation:  0.025025606155395508
local_output_nid generation:  0.0013210773468017578
local_in_edges_tensor generation:  0.0014579296112060547
mini_batch_src_global generation:  0.002263307571411133
r_  generation:  0.025819063186645508
local_output_nid generation:  0.0013148784637451172
local_in_edges_tensor generation:  0.0014595985412597656
mini_batch_src_global generation:  0.002495288848876953
r_  generation:  0.0261838436126709
local_output_nid generation:  0.0013003349304199219
local_in_edges_tensor generation:  0.0014307498931884766
mini_batch_src_global generation:  0.0022776126861572266
r_  generation:  0.026297330856323242
local_output_nid generation:  0.0013175010681152344
local_in_edges_tensor generation:  0.0069043636322021484
mini_batch_src_global generation:  0.002466917037963867
r_  generation:  0.02676844596862793
local_output_nid generation:  0.0013179779052734375
local_in_edges_tensor generation:  0.0015599727630615234
mini_batch_src_global generation:  0.0023012161254882812
r_  generation:  0.026899099349975586
local_output_nid generation:  0.0013377666473388672
local_in_edges_tensor generation:  0.0013637542724609375
mini_batch_src_global generation:  0.0022535324096679688
r_  generation:  0.025421857833862305
local_output_nid generation:  0.0013158321380615234
local_in_edges_tensor generation:  0.001420736312866211
mini_batch_src_global generation:  0.002918720245361328
r_  generation:  0.02608036994934082
local_output_nid generation:  0.001264810562133789
local_in_edges_tensor generation:  0.0012896060943603516
mini_batch_src_global generation:  0.002264738082885742
r_  generation:  0.02543926239013672
local_output_nid generation:  0.0013432502746582031
local_in_edges_tensor generation:  0.0015668869018554688
mini_batch_src_global generation:  0.002245187759399414
r_  generation:  0.027029752731323242
local_output_nid generation:  0.0013341903686523438
local_in_edges_tensor generation:  0.0014979839324951172
mini_batch_src_global generation:  0.0023345947265625
r_  generation:  0.026982784271240234
local_output_nid generation:  0.0012688636779785156
local_in_edges_tensor generation:  0.0013492107391357422
mini_batch_src_global generation:  0.002246856689453125
r_  generation:  0.025150775909423828
local_output_nid generation:  0.0013287067413330078
local_in_edges_tensor generation:  0.0013592243194580078
mini_batch_src_global generation:  0.0022704601287841797
r_  generation:  0.026308298110961914
local_output_nid generation:  0.0012705326080322266
local_in_edges_tensor generation:  0.0012848377227783203
mini_batch_src_global generation:  0.002225160598754883
r_  generation:  0.024950504302978516
local_output_nid generation:  0.001329183578491211
local_in_edges_tensor generation:  0.0015461444854736328
mini_batch_src_global generation:  0.003112316131591797
r_  generation:  0.02629709243774414
local_output_nid generation:  0.0013315677642822266
local_in_edges_tensor generation:  0.0015017986297607422
mini_batch_src_global generation:  0.0023415088653564453
r_  generation:  0.02604222297668457
----------------------check_connections_block total spend ----------------------------- 2.61329984664917
generate_one_block  1.4591679573059082
generate_one_block  0.03515982627868652
generate_one_block  0.038408517837524414
generate_one_block  0.03814387321472168
generate_one_block  0.03653907775878906
generate_one_block  0.03995656967163086
generate_one_block  0.08601665496826172
generate_one_block  0.036127567291259766
generate_one_block  0.03796243667602539
generate_one_block  0.03472733497619629
generate_one_block  0.03966641426086426
generate_one_block  0.03864550590515137
generate_one_block  0.03612494468688965
generate_one_block  0.036956787109375
generate_one_block  0.035986900329589844
generate_one_block  0.037986040115356445
generate_one_block  0.03560042381286621
generate_one_block  0.034319162368774414
generate_one_block  0.033345699310302734
generate_one_block  0.03658699989318848
generate_one_block  0.034999847412109375
generate_one_block  0.033944129943847656
generate_one_block  0.034268856048583984
generate_one_block  0.035370826721191406
generate_one_block  0.036049604415893555
generate_one_block  0.03717517852783203
generate_one_block  0.035837411880493164
generate_one_block  0.035955190658569336
generate_one_block  0.03854823112487793
generate_one_block  0.03508162498474121
generate_one_block  0.038922786712646484
generate_one_block  0.039226531982421875
generate_one_block  0.03328514099121094
generate_one_block  0.03638291358947754
generate_one_block  0.036156415939331055
generate_one_block  0.03417396545410156
generate_one_block  0.038521766662597656
generate_one_block  0.03907585144042969
generate_one_block  0.03484964370727539
generate_one_block  0.038823843002319336
generate_one_block  0.037654876708984375
generate_one_block  0.03233742713928223
generate_one_block  0.03612375259399414
generate_one_block  0.03242182731628418
generate_one_block  0.035637855529785156
generate_one_block  0.035985708236694336
generate_one_block  0.0365605354309082
generate_one_block  0.03693747520446777
generate_one_block  0.03650069236755371
generate_one_block  0.03976941108703613
generate_one_block  0.03939461708068848
generate_one_block  0.039020538330078125
generate_one_block  0.040311336517333984
generate_one_block  0.03884553909301758
generate_one_block  0.037212371826171875
generate_one_block  0.03923916816711426
generate_one_block  0.038596153259277344
generate_one_block  0.040088653564453125
generate_one_block  0.04065728187561035
generate_one_block  0.03755021095275879
generate_one_block  0.04003787040710449
generate_one_block  0.03781771659851074
generate_one_block  0.03931379318237305
generate_one_block  0.04126477241516113
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6413888931274414
gen group dst list time:  0.06758451461791992
time for parepare:  0.41533732414245605
local_output_nid generation:  0.007078647613525391
local_in_edges_tensor generation:  0.05086040496826172
mini_batch_src_global generation:  0.008904695510864258
r_  generation:  0.08188867568969727
local_output_nid generation:  0.008056163787841797
local_in_edges_tensor generation:  0.006534099578857422
mini_batch_src_global generation:  0.00977635383605957
r_  generation:  0.08596181869506836
local_output_nid generation:  0.012173891067504883
local_in_edges_tensor generation:  0.011556625366210938
mini_batch_src_global generation:  0.012192964553833008
r_  generation:  0.13099145889282227
local_output_nid generation:  0.011600017547607422
local_in_edges_tensor generation:  0.011587381362915039
mini_batch_src_global generation:  0.013063907623291016
r_  generation:  0.15010976791381836
local_output_nid generation:  0.011356353759765625
local_in_edges_tensor generation:  0.012832880020141602
mini_batch_src_global generation:  0.015746593475341797
r_  generation:  0.13556838035583496
local_output_nid generation:  0.01238870620727539
local_in_edges_tensor generation:  0.013151168823242188
mini_batch_src_global generation:  0.014978885650634766
r_  generation:  0.16638708114624023
local_output_nid generation:  0.00934910774230957
local_in_edges_tensor generation:  0.00816488265991211
mini_batch_src_global generation:  0.012145042419433594
r_  generation:  0.10262441635131836
local_output_nid generation:  0.00831913948059082
local_in_edges_tensor generation:  0.007333993911743164
mini_batch_src_global generation:  0.010369062423706055
r_  generation:  0.09430313110351562
local_output_nid generation:  0.010950565338134766
local_in_edges_tensor generation:  0.009801864624023438
mini_batch_src_global generation:  0.012545108795166016
r_  generation:  0.12045478820800781
local_output_nid generation:  0.010332822799682617
local_in_edges_tensor generation:  0.01010441780090332
mini_batch_src_global generation:  0.012393712997436523
r_  generation:  0.11772727966308594
local_output_nid generation:  0.012603998184204102
local_in_edges_tensor generation:  0.012345552444458008
mini_batch_src_global generation:  0.016083955764770508
r_  generation:  0.15065383911132812
local_output_nid generation:  0.012012004852294922
local_in_edges_tensor generation:  0.011765718460083008
mini_batch_src_global generation:  0.015509366989135742
r_  generation:  0.14278459548950195
local_output_nid generation:  0.010539770126342773
local_in_edges_tensor generation:  0.009310722351074219
mini_batch_src_global generation:  0.014219522476196289
r_  generation:  0.13252830505371094
local_output_nid generation:  0.009909629821777344
local_in_edges_tensor generation:  0.008579015731811523
mini_batch_src_global generation:  0.013306856155395508
r_  generation:  0.12376523017883301
local_output_nid generation:  0.009682178497314453
local_in_edges_tensor generation:  0.008511543273925781
mini_batch_src_global generation:  0.011876344680786133
r_  generation:  0.10970425605773926
local_output_nid generation:  0.014635086059570312
local_in_edges_tensor generation:  0.016678810119628906
mini_batch_src_global generation:  0.016266822814941406
r_  generation:  0.1587657928466797
local_output_nid generation:  0.017065763473510742
local_in_edges_tensor generation:  0.020963668823242188
mini_batch_src_global generation:  0.014787912368774414
r_  generation:  0.14692378044128418
local_output_nid generation:  0.010569572448730469
local_in_edges_tensor generation:  0.01330256462097168
mini_batch_src_global generation:  0.012947320938110352
r_  generation:  0.11680912971496582
local_output_nid generation:  0.014887332916259766
local_in_edges_tensor generation:  0.009947061538696289
mini_batch_src_global generation:  0.01104283332824707
r_  generation:  0.0946807861328125
local_output_nid generation:  0.01548910140991211
local_in_edges_tensor generation:  0.010004043579101562
mini_batch_src_global generation:  0.012244462966918945
r_  generation:  0.11042022705078125
local_output_nid generation:  0.013099908828735352
local_in_edges_tensor generation:  0.013466358184814453
mini_batch_src_global generation:  0.01245737075805664
r_  generation:  0.11556434631347656
local_output_nid generation:  0.011093854904174805
local_in_edges_tensor generation:  0.010588645935058594
mini_batch_src_global generation:  0.012019634246826172
r_  generation:  0.11153125762939453
local_output_nid generation:  0.011043548583984375
local_in_edges_tensor generation:  0.011263370513916016
mini_batch_src_global generation:  0.012978792190551758
r_  generation:  0.1274566650390625
local_output_nid generation:  0.010810136795043945
local_in_edges_tensor generation:  0.009797096252441406
mini_batch_src_global generation:  0.012862205505371094
r_  generation:  0.12256312370300293
local_output_nid generation:  0.01027822494506836
local_in_edges_tensor generation:  0.009773969650268555
mini_batch_src_global generation:  0.012991189956665039
r_  generation:  0.12376642227172852
local_output_nid generation:  0.010905265808105469
local_in_edges_tensor generation:  0.010054826736450195
mini_batch_src_global generation:  0.012789011001586914
r_  generation:  0.1225275993347168
local_output_nid generation:  0.012054204940795898
local_in_edges_tensor generation:  0.010912418365478516
mini_batch_src_global generation:  0.014898061752319336
r_  generation:  0.1379849910736084
local_output_nid generation:  0.011847972869873047
local_in_edges_tensor generation:  0.011477947235107422
mini_batch_src_global generation:  0.015280961990356445
r_  generation:  0.14190673828125
local_output_nid generation:  0.012137413024902344
local_in_edges_tensor generation:  0.010697126388549805
mini_batch_src_global generation:  0.014624357223510742
r_  generation:  0.14064979553222656
local_output_nid generation:  0.010159969329833984
local_in_edges_tensor generation:  0.008821725845336914
mini_batch_src_global generation:  0.01295781135559082
r_  generation:  0.11715006828308105
local_output_nid generation:  0.01384282112121582
local_in_edges_tensor generation:  0.012766361236572266
mini_batch_src_global generation:  0.01717209815979004
r_  generation:  0.17169904708862305
local_output_nid generation:  0.014076471328735352
local_in_edges_tensor generation:  0.0138702392578125
mini_batch_src_global generation:  0.018308162689208984
r_  generation:  0.1894540786743164
local_output_nid generation:  0.008921623229980469
local_in_edges_tensor generation:  0.007645606994628906
mini_batch_src_global generation:  0.013080120086669922
r_  generation:  0.10316276550292969
local_output_nid generation:  0.009521007537841797
local_in_edges_tensor generation:  0.007795810699462891
mini_batch_src_global generation:  0.013550043106079102
r_  generation:  0.11164402961730957
local_output_nid generation:  0.01412653923034668
local_in_edges_tensor generation:  0.014400005340576172
mini_batch_src_global generation:  0.016125202178955078
r_  generation:  0.1825275421142578
local_output_nid generation:  0.008984088897705078
local_in_edges_tensor generation:  0.010702133178710938
mini_batch_src_global generation:  0.014124393463134766
r_  generation:  0.10737943649291992
local_output_nid generation:  0.013344287872314453
local_in_edges_tensor generation:  0.01188802719116211
mini_batch_src_global generation:  0.015954017639160156
r_  generation:  0.18973350524902344
local_output_nid generation:  0.010624170303344727
local_in_edges_tensor generation:  0.025562286376953125
mini_batch_src_global generation:  0.02010369300842285
r_  generation:  0.1351940631866455
local_output_nid generation:  0.017405986785888672
local_in_edges_tensor generation:  0.036710262298583984
mini_batch_src_global generation:  0.01390838623046875
r_  generation:  0.13015174865722656
local_output_nid generation:  0.01434183120727539
local_in_edges_tensor generation:  0.026175975799560547
mini_batch_src_global generation:  0.017701387405395508
r_  generation:  0.16537117958068848
local_output_nid generation:  0.01145625114440918
local_in_edges_tensor generation:  0.016927003860473633
mini_batch_src_global generation:  0.015264749526977539
r_  generation:  0.1433877944946289
local_output_nid generation:  0.011175870895385742
local_in_edges_tensor generation:  0.013554096221923828
mini_batch_src_global generation:  0.015450477600097656
r_  generation:  0.14510273933410645
local_output_nid generation:  0.013702154159545898
local_in_edges_tensor generation:  0.018564462661743164
mini_batch_src_global generation:  0.0165555477142334
r_  generation:  0.18890690803527832
local_output_nid generation:  0.012503862380981445
local_in_edges_tensor generation:  0.01322627067565918
mini_batch_src_global generation:  0.016561508178710938
r_  generation:  0.16176772117614746
local_output_nid generation:  0.03599381446838379
local_in_edges_tensor generation:  0.012680530548095703
mini_batch_src_global generation:  0.01693868637084961
r_  generation:  0.16025137901306152
local_output_nid generation:  0.014383316040039062
local_in_edges_tensor generation:  0.009932518005371094
mini_batch_src_global generation:  0.015893220901489258
r_  generation:  0.14117932319641113
local_output_nid generation:  0.01162266731262207
local_in_edges_tensor generation:  0.010045289993286133
mini_batch_src_global generation:  0.014804601669311523
r_  generation:  0.13390874862670898
local_output_nid generation:  0.011140823364257812
local_in_edges_tensor generation:  0.01025533676147461
mini_batch_src_global generation:  0.015013456344604492
r_  generation:  0.14120936393737793
local_output_nid generation:  0.009105682373046875
local_in_edges_tensor generation:  0.0078051090240478516
mini_batch_src_global generation:  0.013597965240478516
r_  generation:  0.11244344711303711
local_output_nid generation:  0.010803937911987305
local_in_edges_tensor generation:  0.009888887405395508
mini_batch_src_global generation:  0.014917373657226562
r_  generation:  0.15050125122070312
local_output_nid generation:  0.011556148529052734
local_in_edges_tensor generation:  0.01323843002319336
mini_batch_src_global generation:  0.01665496826171875
r_  generation:  0.1586756706237793
local_output_nid generation:  0.012369155883789062
local_in_edges_tensor generation:  0.010968685150146484
mini_batch_src_global generation:  0.01742243766784668
r_  generation:  0.17178964614868164
local_output_nid generation:  0.013463020324707031
local_in_edges_tensor generation:  0.014667034149169922
mini_batch_src_global generation:  0.020381450653076172
r_  generation:  0.18365001678466797
local_output_nid generation:  0.011236906051635742
local_in_edges_tensor generation:  0.009912967681884766
mini_batch_src_global generation:  0.016849517822265625
r_  generation:  0.15363192558288574
local_output_nid generation:  0.010118246078491211
local_in_edges_tensor generation:  0.009151935577392578
mini_batch_src_global generation:  0.015264272689819336
r_  generation:  0.13254475593566895
local_output_nid generation:  0.012226104736328125
local_in_edges_tensor generation:  0.01266622543334961
mini_batch_src_global generation:  0.018085002899169922
r_  generation:  0.17303180694580078
local_output_nid generation:  0.013490915298461914
local_in_edges_tensor generation:  0.014326095581054688
mini_batch_src_global generation:  0.019678115844726562
r_  generation:  0.20208477973937988
local_output_nid generation:  0.012797355651855469
local_in_edges_tensor generation:  0.01278233528137207
mini_batch_src_global generation:  0.018358230590820312
r_  generation:  0.17808008193969727
local_output_nid generation:  0.012902498245239258
local_in_edges_tensor generation:  0.011587381362915039
mini_batch_src_global generation:  0.01880645751953125
r_  generation:  0.17422723770141602
local_output_nid generation:  0.012293815612792969
local_in_edges_tensor generation:  0.010955572128295898
mini_batch_src_global generation:  0.018178701400756836
r_  generation:  0.17022180557250977
local_output_nid generation:  0.013053178787231445
local_in_edges_tensor generation:  0.011549949645996094
mini_batch_src_global generation:  0.022719144821166992
r_  generation:  0.17871999740600586
local_output_nid generation:  0.012863636016845703
local_in_edges_tensor generation:  0.012691259384155273
mini_batch_src_global generation:  0.01892399787902832
r_  generation:  0.1788032054901123
local_output_nid generation:  0.010492801666259766
local_in_edges_tensor generation:  0.010475635528564453
mini_batch_src_global generation:  0.016585826873779297
r_  generation:  0.15331220626831055
local_output_nid generation:  0.010521173477172852
local_in_edges_tensor generation:  0.012839794158935547
mini_batch_src_global generation:  0.020831584930419922
r_  generation:  0.14128518104553223
----------------------check_connections_block total spend ----------------------------- 14.300566673278809
generate_one_block  0.23752427101135254
generate_one_block  0.20778393745422363
generate_one_block  0.3854856491088867
generate_one_block  0.21797895431518555
generate_one_block  0.22475290298461914
generate_one_block  0.2189798355102539
generate_one_block  0.15480661392211914
generate_one_block  0.1335132122039795
generate_one_block  0.19183874130249023
generate_one_block  0.16500544548034668
generate_one_block  0.22855424880981445
generate_one_block  0.1916055679321289
generate_one_block  0.20063352584838867
generate_one_block  0.16583466529846191
generate_one_block  0.14688944816589355
generate_one_block  0.2193295955657959
generate_one_block  0.1868734359741211
generate_one_block  0.1406688690185547
generate_one_block  0.11912012100219727
generate_one_block  0.14566922187805176
generate_one_block  0.1427445411682129
generate_one_block  0.14232921600341797
generate_one_block  0.15697550773620605
generate_one_block  0.15214848518371582
generate_one_block  0.15415573120117188
generate_one_block  0.1507260799407959
generate_one_block  0.17725014686584473
generate_one_block  0.1771092414855957
generate_one_block  0.1728672981262207
generate_one_block  0.1382768154144287
generate_one_block  0.20551776885986328
generate_one_block  0.21298789978027344
generate_one_block  0.12383174896240234
generate_one_block  0.1400904655456543
generate_one_block  0.2124950885772705
generate_one_block  0.12795257568359375
generate_one_block  0.223052978515625
generate_one_block  0.16335725784301758
generate_one_block  0.16836762428283691
generate_one_block  0.20624971389770508
generate_one_block  0.1810600757598877
generate_one_block  0.18193888664245605
generate_one_block  0.20737314224243164
generate_one_block  0.18591928482055664
generate_one_block  0.18702459335327148
generate_one_block  0.19380974769592285
generate_one_block  0.1580204963684082
generate_one_block  0.16957664489746094
generate_one_block  0.13296055793762207
generate_one_block  0.20166993141174316
generate_one_block  0.1999657154083252
generate_one_block  0.24445462226867676
generate_one_block  0.300762414932251
generate_one_block  0.2655465602874756
generate_one_block  0.23754644393920898
generate_one_block  0.26557469367980957
generate_one_block  0.2633504867553711
generate_one_block  0.2225816249847412
generate_one_block  0.21485114097595215
generate_one_block  0.20473766326904297
generate_one_block  0.22131800651550293
generate_one_block  0.21560382843017578
generate_one_block  0.18364644050598145
generate_one_block  0.16785025596618652
----------===============-------------===============-------------the number of batches *****---- 64

original number of batches:  64
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

connection checking time:  16.91386651992798
block generation total time  16.081835746765137
average batch blocks generation time:  0.12563934177160263
block dataloader generation time/epoch 76.07365226745605
pseudo mini batch 0 input nodes size: 73426
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.029897212982177734  GigaBytes
Max Memory Allocated: 0.029897212982177734  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.02992105484008789  GigaBytes
Max Memory Allocated: 0.02992105484008789  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0487060546875 GB
    Memory Allocated: 0.02992105484008789  GigaBytes
Max Memory Allocated: 0.02992105484008789  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.032338619232177734  GigaBytes
Max Memory Allocated: 0.032338619232177734  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.032338619232177734  GigaBytes
Max Memory Allocated: 0.032338619232177734  GigaBytes

first layer input nodes number: 73426
first layer output nodes number: 25205
edges number: 247947
----------------------------------------before model layer 0
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03307390213012695  GigaBytes
Max Memory Allocated: 0.03399801254272461  GigaBytes

torch.Size([73426, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1170654296875 GB
    Memory Allocated: 0.03307390213012695  GigaBytes
Max Memory Allocated: 0.03399801254272461  GigaBytes

m.shape torch.Size([59, 1, 100])
----------------------------------------1
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.12806940078735352  GigaBytes
Max Memory Allocated: 0.13209867477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.12806940078735352  GigaBytes
Max Memory Allocated: 0.13209867477416992  GigaBytes

 h.shape torch.Size([1, 59, 100]), torch.Size([1, 59, 100])
----------------------------------------3
 Nvidia-smi: 1.3358154296875 GB
    Memory Allocated: 0.1281142234802246  GigaBytes
Max Memory Allocated: 0.13209867477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.12846851348876953  GigaBytes
Max Memory Allocated: 0.13209867477416992  GigaBytes

rst.shape  torch.Size([1, 59, 100])
m.shape torch.Size([62, 2, 100])
----------------------------------------1
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.1284923553466797  GigaBytes
Max Memory Allocated: 0.13209867477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.1284923553466797  GigaBytes
Max Memory Allocated: 0.13209867477416992  GigaBytes

 h.shape torch.Size([1, 62, 100]), torch.Size([1, 62, 100])
----------------------------------------3
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.1285390853881836  GigaBytes
Max Memory Allocated: 0.13209867477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.12923431396484375  GigaBytes
Max Memory Allocated: 0.13209867477416992  GigaBytes

rst.shape  torch.Size([1, 62, 100])
m.shape torch.Size([84, 3, 100])
----------------------------------------1
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.1293048858642578  GigaBytes
Max Memory Allocated: 0.13209867477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.1293048858642578  GigaBytes
Max Memory Allocated: 0.13209867477416992  GigaBytes

 h.shape torch.Size([1, 84, 100]), torch.Size([1, 84, 100])
----------------------------------------3
 Nvidia-smi: 1.3377685546875 GB
    Memory Allocated: 0.12936782836914062  GigaBytes
Max Memory Allocated: 0.13209867477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.13074827194213867  GigaBytes
Max Memory Allocated: 0.13209867477416992  GigaBytes

rst.shape  torch.Size([1, 84, 100])
m.shape torch.Size([83, 4, 100])
----------------------------------------1
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.13084077835083008  GigaBytes
Max Memory Allocated: 0.13209867477416992  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.13084077835083008  GigaBytes
Max Memory Allocated: 0.13209867477416992  GigaBytes

 h.shape torch.Size([1, 83, 100]), torch.Size([1, 83, 100])
----------------------------------------3
 Nvidia-smi: 1.3397216796875 GB
    Memory Allocated: 0.13090276718139648  GigaBytes
Max Memory Allocated: 0.13209867477416992  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.13270044326782227  GigaBytes
Max Memory Allocated: 0.13282442092895508  GigaBytes

rst.shape  torch.Size([1, 83, 100])
m.shape torch.Size([115, 5, 100])
----------------------------------------1
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.13288402557373047  GigaBytes
Max Memory Allocated: 0.1328907012939453  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.13288402557373047  GigaBytes
Max Memory Allocated: 0.1328907012939453  GigaBytes

 h.shape torch.Size([1, 115, 100]), torch.Size([1, 115, 100])
----------------------------------------3
 Nvidia-smi: 1.3416748046875 GB
    Memory Allocated: 0.13296985626220703  GigaBytes
Max Memory Allocated: 0.13296985626220703  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.13605976104736328  GigaBytes
Max Memory Allocated: 0.1362743377685547  GigaBytes

rst.shape  torch.Size([1, 115, 100])
m.shape torch.Size([102, 6, 100])
----------------------------------------1
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.1362452507019043  GigaBytes
Max Memory Allocated: 0.1362743377685547  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.1362452507019043  GigaBytes
Max Memory Allocated: 0.1362743377685547  GigaBytes

 h.shape torch.Size([1, 102, 100]), torch.Size([1, 102, 100])
----------------------------------------3
 Nvidia-smi: 1.3455810546875 GB
    Memory Allocated: 0.1363215446472168  GigaBytes
Max Memory Allocated: 0.1363215446472168  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.13959360122680664  GigaBytes
Max Memory Allocated: 0.13982200622558594  GigaBytes

rst.shape  torch.Size([1, 102, 100])
m.shape torch.Size([150, 7, 100])
----------------------------------------1
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.13994693756103516  GigaBytes
Max Memory Allocated: 0.13995933532714844  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.13994693756103516  GigaBytes
Max Memory Allocated: 0.13995933532714844  GigaBytes

 h.shape torch.Size([1, 150, 100]), torch.Size([1, 150, 100])
----------------------------------------3
 Nvidia-smi: 1.3494873046875 GB
    Memory Allocated: 0.1400594711303711  GigaBytes
Max Memory Allocated: 0.1400594711303711  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.14565610885620117  GigaBytes
Max Memory Allocated: 0.14604759216308594  GigaBytes

rst.shape  torch.Size([1, 150, 100])
m.shape torch.Size([174, 8, 100])
----------------------------------------1
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.1461186408996582  GigaBytes
Max Memory Allocated: 0.1461343765258789  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.1461186408996582  GigaBytes
Max Memory Allocated: 0.1461343765258789  GigaBytes

 h.shape torch.Size([1, 174, 100]), torch.Size([1, 174, 100])
----------------------------------------3
 Nvidia-smi: 1.3553466796875 GB
    Memory Allocated: 0.14624834060668945  GigaBytes
Max Memory Allocated: 0.14624834060668945  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3631591796875 GB
    Memory Allocated: 0.1536412239074707  GigaBytes
Max Memory Allocated: 0.1541600227355957  GigaBytes

rst.shape  torch.Size([1, 174, 100])
m.shape torch.Size([209, 9, 100])
----------------------------------------1
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.15427732467651367  GigaBytes
Max Memory Allocated: 0.1542987823486328  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.15427732467651367  GigaBytes
Max Memory Allocated: 0.1542987823486328  GigaBytes

 h.shape torch.Size([1, 209, 100]), torch.Size([1, 209, 100])
----------------------------------------3
 Nvidia-smi: 1.3651123046875 GB
    Memory Allocated: 0.1544337272644043  GigaBytes
Max Memory Allocated: 0.1544337272644043  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.3748779296875 GB
    Memory Allocated: 0.16441774368286133  GigaBytes
Max Memory Allocated: 0.16511869430541992  GigaBytes

rst.shape  torch.Size([1, 209, 100])
m.shape torch.Size([24167, 10, 100])
----------------------------------------1
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.25436878204345703  GigaBytes
Max Memory Allocated: 0.25721263885498047  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.25436878204345703  GigaBytes
Max Memory Allocated: 0.25721263885498047  GigaBytes

 h.shape torch.Size([1, 24167, 100]), torch.Size([1, 24167, 100])
----------------------------------------3
 Nvidia-smi: 1.4705810546875 GB
    Memory Allocated: 0.27237510681152344  GigaBytes
Max Memory Allocated: 0.27237510681152344  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.550795555114746  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 24167, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.4583373069763184  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.482374668121338  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.5064120292663574  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.482374668121338  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

torch.Size([25205, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.5064120292663574  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.5124216079711914  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 2.8905029296875 GB
    Memory Allocated: 1.5124216079711914  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

m.shape torch.Size([25, 1, 256])
----------------------------------------1
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5859894752502441  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5859894752502441  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5860371589660645  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.586418628692627  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 2, 256])
----------------------------------------1
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5864315032958984  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5864315032958984  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5864677429199219  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5870113372802734  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5870165824890137  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5870165824890137  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5870318412780762  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5873675346374512  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5873756408691406  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5873756408691406  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5873832702636719  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5876045227050781  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5876202583312988  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5876202583312988  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.58762788772583  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.587902545928955  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.587916374206543  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.587916374206543  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5879220962524414  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5881681442260742  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 7, 256])
----------------------------------------1
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.588212490081787  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.588212490081787  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5882258415222168  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5888934135437012  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 8, 256])
----------------------------------------1
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.588932991027832  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.588932991027832  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.588944435119629  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5895967483520508  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5896000862121582  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5896000862121582  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.589601993560791  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.589724063873291  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([6, 10, 256])
----------------------------------------1
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5897808074951172  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5897808074951172  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.589792251586914  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5906047821044922  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 11, 256])
----------------------------------------1
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.590662956237793  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.590662956237793  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5906744003295898  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.591567039489746  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 12, 256])
----------------------------------------1
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5916309356689453  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5916309356689453  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 2.9647216796875 GB
    Memory Allocated: 1.5916423797607422  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.5926151275634766  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 13, 256])
----------------------------------------1
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.592672348022461  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.592672348022461  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.592681884765625  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.5935592651367188  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 14, 256])
----------------------------------------1
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.593648910522461  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.593648910522461  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 2.9666748046875 GB
    Memory Allocated: 1.5936622619628906  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9686279296875 GB
    Memory Allocated: 1.5949840545654297  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 15, 256])
----------------------------------------1
 Nvidia-smi: 2.9686279296875 GB
    Memory Allocated: 1.5950207710266113  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9686279296875 GB
    Memory Allocated: 1.5950207710266113  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 2.9686279296875 GB
    Memory Allocated: 1.5950264930725098  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9686279296875 GB
    Memory Allocated: 1.5956330299377441  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 17, 256])
----------------------------------------1
 Nvidia-smi: 2.9686279296875 GB
    Memory Allocated: 1.595646858215332  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9686279296875 GB
    Memory Allocated: 1.595646858215332  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.9686279296875 GB
    Memory Allocated: 1.5956487655639648  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9686279296875 GB
    Memory Allocated: 1.5958776473999023  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 18, 256])
----------------------------------------1
 Nvidia-smi: 2.9686279296875 GB
    Memory Allocated: 1.5959463119506836  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9686279296875 GB
    Memory Allocated: 1.5959463119506836  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.9686279296875 GB
    Memory Allocated: 1.5959539413452148  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 1.5969228744506836  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 19, 256])
----------------------------------------1
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 1.5969557762145996  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 1.5969557762145996  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 1.5969595909118652  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 1.597470760345459  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 20, 256])
----------------------------------------1
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 1.5974884033203125  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 1.5974884033203125  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 1.5974903106689453  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 1.5977592468261719  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 21, 256])
----------------------------------------1
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 1.5978593826293945  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 1.5978593826293945  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 2.9705810546875 GB
    Memory Allocated: 1.5978689193725586  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9725341796875 GB
    Memory Allocated: 1.5992803573608398  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 2.9725341796875 GB
    Memory Allocated: 1.599360466003418  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9725341796875 GB
    Memory Allocated: 1.599360466003418  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 2.9725341796875 GB
    Memory Allocated: 1.5993680953979492  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9744873046875 GB
    Memory Allocated: 1.600550651550293  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 23, 256])
----------------------------------------1
 Nvidia-smi: 2.9744873046875 GB
    Memory Allocated: 1.6005911827087402  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9744873046875 GB
    Memory Allocated: 1.6005911827087402  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.9744873046875 GB
    Memory Allocated: 1.6005949974060059  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9744873046875 GB
    Memory Allocated: 1.601212978363037  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 24, 256])
----------------------------------------1
 Nvidia-smi: 2.9744873046875 GB
    Memory Allocated: 1.60125732421875  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.9744873046875 GB
    Memory Allocated: 1.60125732421875  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 2.9744873046875 GB
    Memory Allocated: 1.6012611389160156  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.9744873046875 GB
    Memory Allocated: 1.6019058227539062  GigaBytes
Max Memory Allocated: 1.640824794769287  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3011, 25, 256])
----------------------------------------1
 Nvidia-smi: 3.0487060546875 GB
    Memory Allocated: 1.6747307777404785  GigaBytes
Max Memory Allocated: 1.6750116348266602  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.0487060546875 GB
    Memory Allocated: 1.6747307777404785  GigaBytes
Max Memory Allocated: 1.6750116348266602  GigaBytes

 h.shape torch.Size([1, 3011, 256]), torch.Size([1, 3011, 256])
----------------------------------------3
 Nvidia-smi: 3.0487060546875 GB
    Memory Allocated: 1.6809825897216797  GigaBytes
Max Memory Allocated: 1.6809825897216797  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.7030229568481445  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 3011, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.6302332878112793  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.0780029296875 GB
    Memory Allocated: 2.6307835578918457  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.0799560546875 GB
    Memory Allocated: 2.631333827972412  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0799560546875 GB
    Memory Allocated: 2.6307597160339355  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

torch.Size([3142, 47])
input nodes number: 25205
output nodes number: 3142
edges number: 76362
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0799560546875 GB
    Memory Allocated: 2.631521701812744  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0799560546875 GB
    Memory Allocated: 2.6315226554870605  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.2303466796875 GB
    Memory Allocated: 0.039566993713378906  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

pseudo mini batch 1 input nodes size: 80662
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.2303466796875 GB
    Memory Allocated: 0.03301572799682617  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.2303466796875 GB
    Memory Allocated: 0.03301572799682617  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.2303466796875 GB
    Memory Allocated: 0.0630650520324707  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 4.2303466796875 GB
    Memory Allocated: 0.06308841705322266  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.2303466796875 GB
    Memory Allocated: 0.035710811614990234  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.2303466796875 GB
    Memory Allocated: 0.038144588470458984  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.2303466796875 GB
    Memory Allocated: 0.038144588470458984  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

first layer input nodes number: 80662
first layer output nodes number: 26080
edges number: 252052
----------------------------------------before model layer 0
 Nvidia-smi: 4.2303466796875 GB
    Memory Allocated: 0.0389404296875  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

torch.Size([80662, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.2303466796875 GB
    Memory Allocated: 0.0389404296875  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

m.shape torch.Size([59, 1, 100])
----------------------------------------1
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.13552045822143555  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.13552045822143555  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 59, 100]), torch.Size([1, 59, 100])
----------------------------------------3
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.13556528091430664  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.13591957092285156  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 59, 100])
m.shape torch.Size([121, 2, 100])
----------------------------------------1
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.1359877586364746  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.1359877586364746  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 121, 100]), torch.Size([1, 121, 100])
----------------------------------------3
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.1360783576965332  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.1374344825744629  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 121, 100])
m.shape torch.Size([126, 3, 100])
----------------------------------------1
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.13753032684326172  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.13753032684326172  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 126, 100]), torch.Size([1, 126, 100])
----------------------------------------3
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.13762474060058594  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.1396932601928711  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 126, 100])
m.shape torch.Size([236, 4, 100])
----------------------------------------1
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.1399979591369629  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.1399979591369629  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 236, 100]), torch.Size([1, 236, 100])
----------------------------------------3
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.14017438888549805  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.1452794075012207  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 236, 100])
m.shape torch.Size([269, 5, 100])
----------------------------------------1
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.1456923484802246  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.1456923484802246  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 269, 100]), torch.Size([1, 269, 100])
----------------------------------------3
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.14589357376098633  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.15311622619628906  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 269, 100])
m.shape torch.Size([300, 6, 100])
----------------------------------------1
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.1536865234375  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.1536865234375  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 300, 100]), torch.Size([1, 300, 100])
----------------------------------------3
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.15391063690185547  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.1635303497314453  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 300, 100])
m.shape torch.Size([381, 7, 100])
----------------------------------------1
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.16522455215454102  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.16522455215454102  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 381, 100]), torch.Size([1, 381, 100])
----------------------------------------3
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.16550874710083008  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.17970848083496094  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 381, 100])
m.shape torch.Size([416, 8, 100])
----------------------------------------1
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.18080615997314453  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.18080615997314453  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 416, 100]), torch.Size([1, 416, 100])
----------------------------------------3
 Nvidia-smi: 4.3260498046875 GB
    Memory Allocated: 0.18111610412597656  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3358154296875 GB
    Memory Allocated: 0.19878292083740234  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 416, 100])
m.shape torch.Size([431, 9, 100])
----------------------------------------1
 Nvidia-smi: 4.3358154296875 GB
    Memory Allocated: 0.2000732421875  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3358154296875 GB
    Memory Allocated: 0.2000732421875  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 431, 100]), torch.Size([1, 431, 100])
----------------------------------------3
 Nvidia-smi: 4.3358154296875 GB
    Memory Allocated: 0.2003946304321289  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3553466796875 GB
    Memory Allocated: 0.22095060348510742  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 431, 100])
m.shape torch.Size([23741, 10, 100])
----------------------------------------1
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 0.309232234954834  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 0.309232234954834  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 23741, 100]), torch.Size([1, 23741, 100])
----------------------------------------3
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 0.3269209861755371  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.582808017730713  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 23741, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.4892897605895996  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.5141615867614746  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.5390334129333496  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.5141615867614746  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

torch.Size([26080, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.5390334129333496  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.5452513694763184  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.5452513694763184  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

m.shape torch.Size([16, 1, 256])
----------------------------------------1
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6169514656066895  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6169514656066895  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6169819831848145  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6172261238098145  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.617232322692871  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.617232322692871  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.617253303527832  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.617568016052246  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6175780296325684  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6175780296325684  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.617591381072998  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6178851127624512  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([12, 4, 256])
----------------------------------------1
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.617924690246582  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.617924690246582  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6179475784301758  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6186113357543945  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.618628978729248  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.618628978729248  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.618640422821045  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6190524101257324  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 6, 256])
----------------------------------------1
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6191043853759766  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6191043853759766  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6191234588623047  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.619943618774414  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6199612617492676  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6199612617492676  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6199688911437988  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6203503608703613  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([10, 8, 256])
----------------------------------------1
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6204237937927246  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6204237937927246  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6204428672790527  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6215300559997559  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 9, 256])
----------------------------------------1
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.621598720550537  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.621598720550537  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6216158866882324  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6227145195007324  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 10, 256])
----------------------------------------1
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6228022575378418  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6228022575378418  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.62282133102417  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6241755485534668  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 11, 256])
----------------------------------------1
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6242823600769043  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6242823600769043  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.3592529296875 GB
    Memory Allocated: 1.6243033409118652  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3612060546875 GB
    Memory Allocated: 1.6259398460388184  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 12, 256])
----------------------------------------1
 Nvidia-smi: 4.3612060546875 GB
    Memory Allocated: 1.6260104179382324  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3612060546875 GB
    Memory Allocated: 1.6260104179382324  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.3612060546875 GB
    Memory Allocated: 1.626023769378662  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3631591796875 GB
    Memory Allocated: 1.6271586418151855  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([11, 13, 256])
----------------------------------------1
 Nvidia-smi: 4.3631591796875 GB
    Memory Allocated: 1.6272897720336914  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3631591796875 GB
    Memory Allocated: 1.6272897720336914  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.3631591796875 GB
    Memory Allocated: 1.6273107528686523  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3651123046875 GB
    Memory Allocated: 1.6292409896850586  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 14, 256])
----------------------------------------1
 Nvidia-smi: 4.3651123046875 GB
    Memory Allocated: 1.629392147064209  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3651123046875 GB
    Memory Allocated: 1.629392147064209  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.3651123046875 GB
    Memory Allocated: 1.6294150352478027  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3670654296875 GB
    Memory Allocated: 1.631680965423584  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([7, 15, 256])
----------------------------------------1
 Nvidia-smi: 4.3670654296875 GB
    Memory Allocated: 1.6317706108093262  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3670654296875 GB
    Memory Allocated: 1.6317706108093262  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 4.3670654296875 GB
    Memory Allocated: 1.6317839622497559  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.6331992149353027  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 16, 256])
----------------------------------------1
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.6332850456237793  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.6332850456237793  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.3690185546875 GB
    Memory Allocated: 1.6332964897155762  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3709716796875 GB
    Memory Allocated: 1.634589672088623  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([11, 17, 256])
----------------------------------------1
 Nvidia-smi: 4.3709716796875 GB
    Memory Allocated: 1.6347637176513672  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3709716796875 GB
    Memory Allocated: 1.6347637176513672  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.3709716796875 GB
    Memory Allocated: 1.6347846984863281  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3729248046875 GB
    Memory Allocated: 1.6373023986816406  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([6, 18, 256])
----------------------------------------1
 Nvidia-smi: 4.3729248046875 GB
    Memory Allocated: 1.6373958587646484  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3729248046875 GB
    Memory Allocated: 1.6373958587646484  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 4.3729248046875 GB
    Memory Allocated: 1.6374073028564453  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.6388607025146484  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.6391291618347168  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.6391291618347168  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 4.3748779296875 GB
    Memory Allocated: 1.639157772064209  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3787841796875 GB
    Memory Allocated: 1.642991542816162  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 4.3787841796875 GB
    Memory Allocated: 1.6431889533996582  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3787841796875 GB
    Memory Allocated: 1.6431889533996582  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 4.3787841796875 GB
    Memory Allocated: 1.6432099342346191  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3826904296875 GB
    Memory Allocated: 1.6461682319641113  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 4.3826904296875 GB
    Memory Allocated: 1.6463394165039062  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3826904296875 GB
    Memory Allocated: 1.6463394165039062  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 4.3826904296875 GB
    Memory Allocated: 1.6463565826416016  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 1.6488971710205078  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 1.6491003036499023  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 1.6491003036499023  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 4.3846435546875 GB
    Memory Allocated: 1.6491193771362305  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3885498046875 GB
    Memory Allocated: 1.6520757675170898  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 4.3885498046875 GB
    Memory Allocated: 1.652331829071045  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3885498046875 GB
    Memory Allocated: 1.652331829071045  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 4.3885498046875 GB
    Memory Allocated: 1.6523547172546387  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3924560546875 GB
    Memory Allocated: 1.6560626029968262  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 4.3924560546875 GB
    Memory Allocated: 1.656235694885254  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3924560546875 GB
    Memory Allocated: 1.656235694885254  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 4.3924560546875 GB
    Memory Allocated: 1.6562509536743164  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3944091796875 GB
    Memory Allocated: 1.658829689025879  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([2862, 25, 256])
----------------------------------------1
 Nvidia-smi: 4.3963623046875 GB
    Memory Allocated: 1.727590560913086  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.3963623046875 GB
    Memory Allocated: 1.727590560913086  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

 h.shape torch.Size([1, 2862, 256]), torch.Size([1, 2862, 256])
----------------------------------------3
 Nvidia-smi: 4.3963623046875 GB
    Memory Allocated: 1.7333393096923828  GigaBytes
Max Memory Allocated: 2.7752885818481445  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.3963623046875 GB
    Memory Allocated: 2.717690944671631  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 2862, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 4.3963623046875 GB
    Memory Allocated: 2.6464152336120605  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 4.3963623046875 GB
    Memory Allocated: 2.6469569206237793  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 4.3963623046875 GB
    Memory Allocated: 2.647498607635498  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.3963623046875 GB
    Memory Allocated: 2.6469335556030273  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

torch.Size([3093, 47])
input nodes number: 26080
output nodes number: 3093
edges number: 74430
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.3963623046875 GB
    Memory Allocated: 2.6471428871154785  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.3963623046875 GB
    Memory Allocated: 2.6471433639526367  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.4002685546875 GB
    Memory Allocated: 0.04234504699707031  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

pseudo mini batch 2 input nodes size: 130382
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.4002685546875 GB
    Memory Allocated: 0.03570222854614258  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.4002685546875 GB
    Memory Allocated: 0.03570222854614258  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 4.4002685546875 GB
    Memory Allocated: 0.0842733383178711  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 4.4002685546875 GB
    Memory Allocated: 0.08429718017578125  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 4.4002685546875 GB
    Memory Allocated: 0.054224491119384766  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 4.4002685546875 GB
    Memory Allocated: 0.05737924575805664  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.4002685546875 GB
    Memory Allocated: 0.05737924575805664  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

first layer input nodes number: 130382
first layer output nodes number: 34695
edges number: 344641
----------------------------------------before model layer 0
 Nvidia-smi: 4.4002685546875 GB
    Memory Allocated: 0.058609962463378906  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

torch.Size([130382, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 4.4002685546875 GB
    Memory Allocated: 0.058609962463378906  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

m.shape torch.Size([24, 1, 100])
----------------------------------------1
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19113588333129883  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19113588333129883  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 24, 100]), torch.Size([1, 24, 100])
----------------------------------------3
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19115400314331055  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.1912975311279297  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 24, 100])
m.shape torch.Size([29, 2, 100])
----------------------------------------1
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19131040573120117  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19131040573120117  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 29, 100]), torch.Size([1, 29, 100])
----------------------------------------3
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19133234024047852  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19165849685668945  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 29, 100])
m.shape torch.Size([33, 3, 100])
----------------------------------------1
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19168472290039062  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19168472290039062  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 33, 100]), torch.Size([1, 33, 100])
----------------------------------------3
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.1917095184326172  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19225502014160156  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 33, 100])
m.shape torch.Size([54, 4, 100])
----------------------------------------1
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.1923232078552246  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.1923232078552246  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 54, 100]), torch.Size([1, 54, 100])
----------------------------------------3
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19236421585083008  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19353628158569336  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 54, 100])
m.shape torch.Size([77, 5, 100])
----------------------------------------1
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19365930557250977  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19365930557250977  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 77, 100]), torch.Size([1, 77, 100])
----------------------------------------3
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19371747970581055  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19579029083251953  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 77, 100])
m.shape torch.Size([88, 6, 100])
----------------------------------------1
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19595813751220703  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19595813751220703  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 88, 100]), torch.Size([1, 88, 100])
----------------------------------------3
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19602394104003906  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19884490966796875  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 88, 100])
m.shape torch.Size([97, 7, 100])
----------------------------------------1
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.1990652084350586  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.1990652084350586  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 97, 100]), torch.Size([1, 97, 100])
----------------------------------------3
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.19913768768310547  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.20276165008544922  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 97, 100])
m.shape torch.Size([85, 8, 100])
----------------------------------------1
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.20297908782958984  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.20297908782958984  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 85, 100]), torch.Size([1, 85, 100])
----------------------------------------3
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.20304298400878906  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.20666217803955078  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 85, 100])
m.shape torch.Size([108, 9, 100])
----------------------------------------1
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.20699262619018555  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.20699262619018555  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 108, 100]), torch.Size([1, 108, 100])
----------------------------------------3
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.20707368850708008  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 4.5311279296875 GB
    Memory Allocated: 0.2122359275817871  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 108, 100])
m.shape torch.Size([34100, 10, 100])
----------------------------------------1
 Nvidia-smi: 4.6600341796875 GB
    Memory Allocated: 0.33922815322875977  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 4.6600341796875 GB
    Memory Allocated: 0.33922815322875977  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 34100, 100]), torch.Size([1, 34100, 100])
----------------------------------------3
 Nvidia-smi: 4.6600341796875 GB
    Memory Allocated: 0.36463499069213867  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.168506145477295  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 34100, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.03916597366333  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.072253704071045  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1053414344787598  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.072253704071045  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

torch.Size([34695, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1053414344787598  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1136136054992676  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1136136054992676  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1894149780273438  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1894149780273438  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1894168853759766  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1894588470458984  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1894631385803223  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1894631385803223  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.189465045928955  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1895337104797363  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1895618438720703  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1895618438720703  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1895713806152344  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.189981460571289  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1899847984313965  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1899847984313965  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1899867057800293  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1900954246520996  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1901159286499023  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1901159286499023  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.190119743347168  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1904172897338867  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.190438747406006  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.190438747406006  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1904425621032715  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1907668113708496  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1907901763916016  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1907901763916016  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.190793991088867  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1911449432373047  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1911702156066895  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1911702156066895  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.191174030303955  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.191551685333252  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1915788650512695  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1915788650512695  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.191582679748535  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1919870376586914  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1920008659362793  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1920008659362793  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.192002773284912  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.19221830368042  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.192234992980957  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.192234992980957  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.19223690032959  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.192479133605957  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1924967765808105  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1924967765808105  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1924986839294434  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1927542686462402  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1928110122680664  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1928110122680664  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.192816734313965  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1936235427856445  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.19370174407959  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.19370174407959  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.193709373474121  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.194838523864746  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1948790550231934  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1948790550231934  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.194882869720459  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1955008506774902  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.195545196533203  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.195545196533203  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1955490112304688  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.1961936950683594  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3130, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.271399974822998  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.271399974822998  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

 h.shape torch.Size([1, 3130, 256]), torch.Size([1, 3130, 256])
----------------------------------------3
 Nvidia-smi: 5.9490966796875 GB
    Memory Allocated: 2.277831554412842  GigaBytes
Max Memory Allocated: 2.785926342010498  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.349308490753174  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 3130, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.273329257965088  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.27388334274292  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.274437427520752  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.2738595008850098  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

torch.Size([3162, 47])
input nodes number: 34695
output nodes number: 3162
edges number: 78717
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.2741546630859375  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.2741551399230957  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.06291770935058594  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

pseudo mini batch 3 input nodes size: 121567
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.05423688888549805  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.05423688888549805  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.09952449798583984  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.0995478630065918  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.050952911376953125  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.05399799346923828  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.05399799346923828  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

first layer input nodes number: 121567
first layer output nodes number: 33336
edges number: 330506
----------------------------------------before model layer 0
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.05515241622924805  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

torch.Size([121567, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.05515241622924805  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

m.shape torch.Size([37, 1, 100])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18261098861694336  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18261098861694336  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 37, 100]), torch.Size([1, 37, 100])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18263864517211914  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.1828598976135254  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 37, 100])
m.shape torch.Size([53, 2, 100])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18288564682006836  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18288564682006836  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 53, 100]), torch.Size([1, 53, 100])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18292570114135742  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18352079391479492  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 53, 100])
m.shape torch.Size([60, 3, 100])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18356800079345703  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18356800079345703  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 60, 100]), torch.Size([1, 60, 100])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18361282348632812  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.1845989227294922  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 60, 100])
m.shape torch.Size([66, 4, 100])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.1846752166748047  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.1846752166748047  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 66, 100]), torch.Size([1, 66, 100])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.1847248077392578  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.1861572265625  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 66, 100])
m.shape torch.Size([76, 5, 100])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18627405166625977  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18627405166625977  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 76, 100]), torch.Size([1, 76, 100])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18633127212524414  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18837690353393555  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 76, 100])
m.shape torch.Size([73, 6, 100])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18851184844970703  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18851184844970703  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 73, 100]), torch.Size([1, 73, 100])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.1885671615600586  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.1909198760986328  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 73, 100])
m.shape torch.Size([106, 7, 100])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.19116878509521484  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.19116878509521484  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 106, 100]), torch.Size([1, 106, 100])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.19124794006347656  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.1952056884765625  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 106, 100])
m.shape torch.Size([95, 8, 100])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.1954493522644043  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.1954493522644043  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 95, 100]), torch.Size([1, 95, 100])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.19552087783813477  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.19956350326538086  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 95, 100])
m.shape torch.Size([101, 9, 100])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.19986677169799805  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.19986677169799805  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 101, 100]), torch.Size([1, 101, 100])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.19994211196899414  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.20476388931274414  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 101, 100])
m.shape torch.Size([32669, 10, 100])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.3264279365539551  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.3264279365539551  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 32669, 100]), torch.Size([1, 32669, 100])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.3507685661315918  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0789389610290527  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 32669, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 1.9554338455200195  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 1.9872255325317383  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.019017219543457  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 1.9872255325317383  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

torch.Size([33336, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.019017219543457  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0269651412963867  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0269651412963867  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1020584106445312  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1020584106445312  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1020641326904297  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1021900177001953  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1021924018859863  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1021924018859863  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.102194309234619  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1022629737854004  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1022701263427734  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1022701263427734  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1022720336914062  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1023807525634766  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.102388858795166  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.102388858795166  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.102390766143799  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.102512836456299  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1025218963623047  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1025218963623047  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1025238037109375  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.102659225463867  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.102670192718506  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.102670192718506  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1026721000671387  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1028342247009277  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.102858543395996  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.102858543395996  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1028623580932617  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.103213310241699  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.103238582611084  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.103238582611084  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1032423973083496  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1036200523376465  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.103632926940918  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.103632926940918  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.103634834289551  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.103837013244629  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1039133071899414  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1039133071899414  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1039228439331055  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1050004959106445  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([1, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1050124168395996  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1050124168395996  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1050143241882324  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.10524320602417  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.105259895324707  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.105259895324707  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.10526180267334  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.105504035949707  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.105557918548584  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.105557918548584  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1055636405944824  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.106330394744873  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.106368064880371  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.106368064880371  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1063718795776367  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.106936454772949  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1069984436035156  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1069984436035156  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.107004165649414  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.107891082763672  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1079578399658203  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1079578399658203  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1079635620117188  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1089305877685547  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3100, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.183414936065674  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.183414936065674  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 3100, 256]), torch.Size([1, 3100, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1909375190734863  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.2324705123901367  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 3100, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.1580562591552734  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.158604621887207  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.1591529846191406  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.158581256866455  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

torch.Size([3131, 47])
input nodes number: 33336
output nodes number: 3131
edges number: 77974
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.1588473320007324  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.1588478088378906  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.060163021087646484  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

pseudo mini batch 4 input nodes size: 125134
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.05094718933105469  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.05094718933105469  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.09756326675415039  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.09758615493774414  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.05227518081665039  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.05522775650024414  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.05522775650024414  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

first layer input nodes number: 125134
first layer output nodes number: 32645
edges number: 321696
----------------------------------------before model layer 0
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.05640411376953125  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

torch.Size([125134, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.05640411376953125  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

m.shape torch.Size([37, 1, 100])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.17963838577270508  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.17963838577270508  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 37, 100]), torch.Size([1, 37, 100])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.17966604232788086  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.1798872947692871  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 37, 100])
m.shape torch.Size([63, 2, 100])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.17992067337036133  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.17992067337036133  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 63, 100]), torch.Size([1, 63, 100])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.17996835708618164  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18067502975463867  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 63, 100])
m.shape torch.Size([87, 3, 100])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18074846267700195  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18074846267700195  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 87, 100]), torch.Size([1, 87, 100])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18081331253051758  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18224000930786133  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 87, 100])
m.shape torch.Size([135, 4, 100])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18240880966186523  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18240880966186523  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 135, 100]), torch.Size([1, 135, 100])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.1825098991394043  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18543004989624023  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 135, 100])
m.shape torch.Size([140, 5, 100])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.1856403350830078  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.1856403350830078  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 140, 100]), torch.Size([1, 140, 100])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.1857452392578125  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18950748443603516  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 140, 100])
m.shape torch.Size([170, 6, 100])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.1898350715637207  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.1898350715637207  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 170, 100]), torch.Size([1, 170, 100])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.18996191024780273  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.19541597366333008  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 170, 100])
m.shape torch.Size([186, 7, 100])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.19583797454833984  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.19583797454833984  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 186, 100]), torch.Size([1, 186, 100])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.19597721099853516  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.20291900634765625  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 186, 100])
m.shape torch.Size([181, 8, 100])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.20338916778564453  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.20338916778564453  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 181, 100]), torch.Size([1, 181, 100])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.20352458953857422  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.21122074127197266  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 181, 100])
m.shape torch.Size([198, 9, 100])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.21181726455688477  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.21181726455688477  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 198, 100]), torch.Size([1, 198, 100])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.21196508407592773  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.22141265869140625  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 198, 100])
m.shape torch.Size([31448, 10, 100])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.33849191665649414  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.33849191665649414  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 31448, 100]), torch.Size([1, 31448, 100])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.36192941665649414  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0255770683288574  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 31448, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 1.9055571556091309  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 1.936689853668213  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 1.967822551727295  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 1.936689853668213  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

torch.Size([32645, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 1.967822551727295  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 1.9756059646606445  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 1.9756059646606445  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0473403930664062  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0473403930664062  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0473461151123047  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0474720001220703  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 4, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0474772453308105  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0474772453308105  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.047481060028076  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0475916862487793  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0475997924804688  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0475997924804688  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0476036071777344  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.047740936279297  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.047773838043213  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.047773838043213  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0477852821350098  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0482773780822754  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.04827880859375  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.04827880859375  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.048280715942383  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0483760833740234  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.048398494720459  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.048398494720459  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0484042167663574  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0487303733825684  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.048762321472168  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.048762321472168  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.048769950866699  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.049258232116699  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 10, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0493221282958984  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0493221282958984  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.049335479736328  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.050283432006836  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 11, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0503087043762207  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0503087043762207  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.050314426422119  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0507607460021973  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 12, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.050792694091797  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.050792694091797  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0507984161376953  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0512847900390625  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 13, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.051307201385498  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.051307201385498  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0513110160827637  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.051661968231201  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 14, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0517005920410156  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0517005920410156  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.051706314086914  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0522727966308594  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([12, 15, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.052443027496338  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.052443027496338  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0524659156799316  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.054892063140869  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([4, 16, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0549421310424805  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0549421310424805  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0549497604370117  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.055811882019043  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 17, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0558900833129883  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0558900833129883  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0558996200561523  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.05704402923584  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 18, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.057091236114502  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.057091236114502  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0570969581604004  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.057823657989502  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 19, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0578575134277344  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0578575134277344  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.057861328125  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0583724975585938  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([8, 20, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0585246086120605  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0585246086120605  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.058539867401123  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0606913566589355  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0608253479003906  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0608253479003906  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0608386993408203  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.062814712524414  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0629773139953613  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0629773139953613  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.062992572784424  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0653576850891113  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.065438747406006  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.065438747406006  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.065446376800537  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.0666823387145996  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.066817283630371  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.066817283630371  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.066828727722168  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.06876277923584  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2920, 25, 256])
----------------------------------------1
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1389193534851074  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.1389193534851074  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 2920, 256]), torch.Size([1, 2920, 256])
----------------------------------------3
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 2.14448881149292  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.1468687057495117  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 2920, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.0757555961608887  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.076284408569336  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.076813220977783  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.076261520385742  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

torch.Size([3018, 47])
input nodes number: 32645
output nodes number: 3018
edges number: 74477
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.0765085220336914  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 3.0765089988708496  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.06041431427001953  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

pseudo mini batch 5 input nodes size: 129656
----------------------------------------before load block subtensor 
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.05225563049316406  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.05225563049316406  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.1005563735961914  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.10058021545410156  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.05394124984741211  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.057238101959228516  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.057238101959228516  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

first layer input nodes number: 129656
first layer output nodes number: 36635
edges number: 364040
----------------------------------------before model layer 0
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.05847740173339844  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

torch.Size([129656, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 6.0252685546875 GB
    Memory Allocated: 0.05847740173339844  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

m.shape torch.Size([33, 1, 100])
----------------------------------------1
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.19828224182128906  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.19828224182128906  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 33, 100]), torch.Size([1, 33, 100])
----------------------------------------3
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.19830703735351562  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.19850540161132812  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 33, 100])
m.shape torch.Size([31, 2, 100])
----------------------------------------1
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.1985163688659668  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.1985163688659668  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 31, 100]), torch.Size([1, 31, 100])
----------------------------------------3
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.19854021072387695  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.19888925552368164  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 31, 100])
m.shape torch.Size([46, 3, 100])
----------------------------------------1
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.1989288330078125  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.1989288330078125  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 46, 100]), torch.Size([1, 46, 100])
----------------------------------------3
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.19896316528320312  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.19971847534179688  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 46, 100])
m.shape torch.Size([54, 4, 100])
----------------------------------------1
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.1997818946838379  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.1997818946838379  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 54, 100]), torch.Size([1, 54, 100])
----------------------------------------3
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.19982290267944336  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.20099496841430664  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 54, 100])
m.shape torch.Size([52, 5, 100])
----------------------------------------1
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.20107173919677734  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.20107173919677734  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 52, 100]), torch.Size([1, 52, 100])
----------------------------------------3
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.20111083984375  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.20251131057739258  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 52, 100])
m.shape torch.Size([75, 6, 100])
----------------------------------------1
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.20265960693359375  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.20265960693359375  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 75, 100]), torch.Size([1, 75, 100])
----------------------------------------3
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.20271587371826172  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.20512676239013672  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 75, 100])
m.shape torch.Size([83, 7, 100])
----------------------------------------1
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.20531511306762695  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.20531511306762695  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 83, 100]), torch.Size([1, 83, 100])
----------------------------------------3
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.20537710189819336  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.20847654342651367  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 83, 100])
m.shape torch.Size([99, 8, 100])
----------------------------------------1
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.2087407112121582  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.2087407112121582  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 99, 100]), torch.Size([1, 99, 100])
----------------------------------------3
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.2088150978088379  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.21303224563598633  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 99, 100])
m.shape torch.Size([112, 9, 100])
----------------------------------------1
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.21337080001831055  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.21337080001831055  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 112, 100]), torch.Size([1, 112, 100])
----------------------------------------3
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.2134547233581543  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 6.1619873046875 GB
    Memory Allocated: 0.21880006790161133  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 112, 100])
m.shape torch.Size([36050, 10, 100])
----------------------------------------1
 Nvidia-smi: 6.2967529296875 GB
    Memory Allocated: 0.35352373123168945  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 6.2967529296875 GB
    Memory Allocated: 0.35352373123168945  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 36050, 100]), torch.Size([1, 36050, 100])
----------------------------------------3
 Nvidia-smi: 6.2967529296875 GB
    Memory Allocated: 0.3803839683532715  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.300976276397705  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 36050, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.164886951446533  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.199824810028076  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.234762668609619  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.199824810028076  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

torch.Size([36635, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.234762668609619  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.243497371673584  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.243497371673584  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3188629150390625  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3188629150390625  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.318866729736328  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.318897247314453  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3189034461975098  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3189034461975098  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3189072608947754  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3190178871154785  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.319021224975586  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.319021224975586  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3190231323242188  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.319091796875  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3190979957580566  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3190979957580566  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3190999031066895  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.31919527053833  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([18, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.319350242614746  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.319350242614746  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3193845748901367  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3215818405151367  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3215842247009277  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3215842247009277  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3215880393981934  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3218588829040527  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3218679428100586  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3218679428100586  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3218698501586914  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.322018623352051  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.322030544281006  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.322030544281006  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3220324516296387  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3222079277038574  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.322220802307129  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.322220802307129  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3222227096557617  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.32241153717041  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3224539756774902  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3224539756774902  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3224596977233887  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.323066234588623  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3231096267700195  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3231096267700195  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.323115348815918  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3237619400024414  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3238110542297363  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3238110542297363  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3238167762756348  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3245434761047363  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3245773315429688  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3245773315429688  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3245811462402344  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.325092315673828  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([8, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.325244426727295  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.325244426727295  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3252596855163574  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.32741117477417  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([2, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.327444076538086  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.327444076538086  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3274478912353516  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.328012466430664  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3280954360961914  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3280954360961914  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3281030654907227  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3292856216430664  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3293042182922363  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3293042182922363  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.329306125640869  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3296151161193848  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3297066688537598  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3297066688537598  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.329714298248291  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.3310036659240723  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3097, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.4054150581359863  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.4054150581359863  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

 h.shape torch.Size([1, 3097, 256]), torch.Size([1, 3097, 256])
----------------------------------------3
 Nvidia-smi: 7.1971435546875 GB
    Memory Allocated: 2.4113526344299316  GigaBytes
Max Memory Allocated: 3.423933506011963  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2713623046875 GB
    Memory Allocated: 3.45487642288208  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3097, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2713623046875 GB
    Memory Allocated: 3.3802127838134766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2713623046875 GB
    Memory Allocated: 3.380765438079834  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2713623046875 GB
    Memory Allocated: 3.3813180923461914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.2713623046875 GB
    Memory Allocated: 3.380741596221924  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([3156, 47])
input nodes number: 36635
output nodes number: 3156
edges number: 78261
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.2713623046875 GB
    Memory Allocated: 3.3810625076293945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.2713623046875 GB
    Memory Allocated: 3.3810629844665527  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.06332826614379883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 6 input nodes size: 90272
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.053965091705322266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.053965091705322266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.08759403228759766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.08761739730834961  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.03929281234741211  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04177236557006836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04177236557006836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 90272
first layer output nodes number: 26220
edges number: 256018
----------------------------------------before model layer 0
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04264068603515625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([90272, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04264068603515625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([57, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14106035232543945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14106035232543945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 57, 100]), torch.Size([1, 57, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14110326766967773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14144515991210938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 57, 100])
m.shape torch.Size([117, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1415109634399414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1415109634399414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 117, 100]), torch.Size([1, 117, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14159870147705078  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14290904998779297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 117, 100])
m.shape torch.Size([108, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14298629760742188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14298629760742188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 108, 100]), torch.Size([1, 108, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1430673599243164  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14484214782714844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 108, 100])
m.shape torch.Size([169, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14505386352539062  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14505386352539062  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 169, 100]), torch.Size([1, 169, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14518070220947266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14884185791015625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 169, 100])
m.shape torch.Size([192, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14913606643676758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14913606643676758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 192, 100]), torch.Size([1, 192, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14927911758422852  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15442895889282227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 192, 100])
m.shape torch.Size([180, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15475988388061523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15475988388061523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 180, 100]), torch.Size([1, 180, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15489435195922852  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16066789627075195  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 180, 100])
m.shape torch.Size([196, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16111183166503906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16111183166503906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 196, 100]), torch.Size([1, 196, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16125869750976562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16857194900512695  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 196, 100])
m.shape torch.Size([240, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16921377182006836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16921377182006836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 240, 100]), torch.Size([1, 240, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16939306259155273  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17958974838256836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 240, 100])
m.shape torch.Size([215, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1802210807800293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1802210807800293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 215, 100]), torch.Size([1, 215, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18038129806518555  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19063520431518555  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 215, 100])
m.shape torch.Size([24746, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2827415466308594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2827415466308594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 24746, 100]), torch.Size([1, 24746, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.3011789321899414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6170368194580078  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 24746, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5213875770568848  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5463929176330566  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5713982582092285  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5463929176330566  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([26220, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5713982582092285  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5776495933532715  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5776495933532715  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6514806747436523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6514806747436523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.651484489440918  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.651515007019043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6515250205993652  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6515250205993652  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.651536464691162  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6517081260681152  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6517143249511719  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6517143249511719  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6517219543457031  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6518898010253906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([18, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6519556045532227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6519556045532227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6519899368286133  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6529855728149414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6529927253723145  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6529927253723145  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6530022621154785  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6533455848693848  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6533584594726562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6533584594726562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6533641815185547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6536102294921875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6536211967468262  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6536211967468262  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6536250114440918  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.653815746307373  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([8, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6538753509521484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6538753509521484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.653890609741211  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6547603607177734  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6547789573669434  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6547789573669434  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6547846794128418  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6551508903503418  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.655186653137207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.655186653137207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6551942825317383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.655735969543457  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.655785083770752  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.655785083770752  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.655794620513916  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.656538486480713  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6565799713134766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6565799713134766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6565876007080078  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.657236099243164  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6573076248168945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6573076248168945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6573190689086914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.658371925354004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6584606170654297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6584606170654297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6584739685058594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6597957611083984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6598467826843262  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6598467826843262  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6598544120788574  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.66066312789917  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6607365608215332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6607365608215332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6607460975646973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6618237495422363  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6618847846984863  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6618847846984863  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6618924140930176  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6628079414367676  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6629600524902344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6629600524902344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6629772186279297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6651573181152344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.665295124053955  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.665295124053955  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6653103828430176  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6673550605773926  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.667501449584961  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.667501449584961  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6675167083740234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.669668197631836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6696810722351074  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6696810722351074  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6696829795837402  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6699652671813965  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6701126098632812  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6701126098632812  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.670125961303711  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6721954345703125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([2, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6722331047058105  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6722331047058105  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6722369194030762  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6728549003601074  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6730608940124512  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6730608940124512  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6730780601501465  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6759791374206543  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([2999, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7487950325012207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7487950325012207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2999, 256]), torch.Size([1, 2999, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7551355361938477  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.767449378967285  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2999, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.69437837600708  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.694927215576172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.6954760551452637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.69490385055542  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([3133, 47])
input nodes number: 26220
output nodes number: 3133
edges number: 76659
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.6951189041137695  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.6951193809509277  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04611396789550781  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 7 input nodes size: 80695
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.039288997650146484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.039288997650146484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.0693502426147461  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.06937313079833984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.0357208251953125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.03802680969238281  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.03802680969238281  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 80695
first layer output nodes number: 23893
edges number: 233866
----------------------------------------before model layer 0
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.03880643844604492  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([80695, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.03880643844604492  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([33, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1284036636352539  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1284036636352539  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 33, 100]), torch.Size([1, 33, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.12842845916748047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.12862682342529297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 33, 100])
m.shape torch.Size([74, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.12866973876953125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.12866973876953125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 74, 100]), torch.Size([1, 74, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1287250518798828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.12955474853515625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 74, 100])
m.shape torch.Size([106, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.12964582443237305  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.12964582443237305  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 106, 100]), torch.Size([1, 106, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.12972497940063477  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.13146638870239258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 106, 100])
m.shape torch.Size([137, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.13163137435913086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.13163137435913086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 137, 100]), torch.Size([1, 137, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.13173437118530273  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1347041130065918  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 137, 100])
m.shape torch.Size([160, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1349506378173828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1349506378173828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 160, 100]), torch.Size([1, 160, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1350698471069336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.13936138153076172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 160, 100])
m.shape torch.Size([175, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1396932601928711  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1396932601928711  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 175, 100]), torch.Size([1, 175, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.13982391357421875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1454334259033203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 175, 100])
m.shape torch.Size([172, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14581680297851562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14581680297851562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 172, 100]), torch.Size([1, 172, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14594554901123047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15236282348632812  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 172, 100])
m.shape torch.Size([202, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15290069580078125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15290069580078125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 202, 100]), torch.Size([1, 202, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15305137634277344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16164016723632812  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 202, 100])
m.shape torch.Size([191, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16220521926879883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16220521926879883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 191, 100]), torch.Size([1, 191, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16234827041625977  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1714649200439453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 191, 100])
m.shape torch.Size([22643, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.25574541091918945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.25574541091918945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 22643, 100]), torch.Size([1, 22643, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.272615909576416  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.471384048461914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 22643, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.3833117485046387  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.4060978889465332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.4288840293884277  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.4060978889465332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([23893, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.4288840293884277  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.4353947639465332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.4353947639465332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.508371353149414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.508371353149414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5083751678466797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5084590911865234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5084691047668457  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5084691047668457  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5084748268127441  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5086407661437988  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5086727142333984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5086727142333984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5086841583251953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.509176254272461  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5091910362243652  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5091910362243652  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5091967582702637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5094828605651855  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5095338821411133  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5095338821411133  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.509547233581543  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5103082656860352  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5103278160095215  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5103278160095215  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.51033353805542  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.51069974899292  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5107393264770508  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5107393264770508  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.510746955871582  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5113420486450195  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5113844871520996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5113844871520996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5113921165466309  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.512040615081787  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5120997428894043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5120997428894043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5121092796325684  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.512986660003662  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.513049602508545  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.513049602508545  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.513059139251709  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5140032768249512  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.514085292816162  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.514085292816162  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.514096736907959  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5153098106384277  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5153965950012207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5153965950012207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5154080390930176  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5167012214660645  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.516777515411377  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.516777515411377  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.516787052154541  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5179314613342285  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5179963111877441  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5179963111877441  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5180039405822754  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5189728736877441  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5190424919128418  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5190424919128418  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.519050121307373  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5200724601745605  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.520164966583252  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.520164966583252  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.520174503326416  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5215191841125488  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5216560363769531  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5216560363769531  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5216693878173828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5236454010009766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.523702621459961  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.523702621459961  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5237083435058594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5245952606201172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5246810913085938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5246810913085938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.524688720703125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5259246826171875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5261054039001465  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5261054039001465  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.526120662689209  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5286993980407715  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([2961, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.599839210510254  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.599839210510254  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2961, 256]), torch.Size([1, 2961, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6064062118530273  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.6352663040161133  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2961, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.562206268310547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.562741279602051  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.5632762908935547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.562718391418457  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([3055, 47])
input nodes number: 23893
output nodes number: 3055
edges number: 75426
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.562905788421631  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.562906265258789  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.042052268981933594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 8 input nodes size: 109143
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.03570699691772461  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.03570699691772461  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.07636594772338867  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.07638978958129883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04630565643310547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04904937744140625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04904937744140625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 109143
first layer output nodes number: 29752
edges number: 290551
----------------------------------------before model layer 0
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.050084590911865234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([109143, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.050084590911865234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([68, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1623058319091797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1623058319091797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 68, 100]), torch.Size([1, 68, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16235733032226562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1627650260925293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 68, 100])
m.shape torch.Size([67, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16278934478759766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16278934478759766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 67, 100]), torch.Size([1, 67, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1628398895263672  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16359233856201172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 67, 100])
m.shape torch.Size([135, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16371822357177734  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16371822357177734  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 135, 100]), torch.Size([1, 135, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1638193130493164  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16603469848632812  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 135, 100])
m.shape torch.Size([180, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16625261306762695  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16625261306762695  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 180, 100]), torch.Size([1, 180, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16638708114624023  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17028093338012695  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 180, 100])
m.shape torch.Size([218, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17061996459960938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17061996459960938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 218, 100]), torch.Size([1, 218, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17078304290771484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17663955688476562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 218, 100])
m.shape torch.Size([276, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17717504501342773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17717504501342773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 276, 100]), torch.Size([1, 276, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17738103866577148  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18623018264770508  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 276, 100])
m.shape torch.Size([274, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1868419647216797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1868419647216797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 274, 100]), torch.Size([1, 274, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18704700469970703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19726896286010742  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 274, 100])
m.shape torch.Size([260, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19794130325317383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19794130325317383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 260, 100]), torch.Size([1, 260, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1981358528137207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20919084548950195  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 260, 100])
m.shape torch.Size([260, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20996570587158203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20996570587158203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 260, 100]), torch.Size([1, 260, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2101602554321289  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.22257280349731445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 260, 100])
m.shape torch.Size([28014, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.32683610916137695  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.32683610916137695  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 28014, 100]), torch.Size([1, 28014, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.34770822525024414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.841264247894287  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 28014, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7338218688964844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7631187438964844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7914924621582031  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7621955871582031  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([29752, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7914924621582031  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7976627349853516  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7976627349853516  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8726143836975098  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8726143836975098  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.872622013092041  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.872683048248291  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.872685432434082  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.872685432434082  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8726892471313477  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8727731704711914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8727869987487793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8727869987487793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8727946281433105  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8730158805847168  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8730268478393555  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8730268478393555  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.873032569885254  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8732385635375977  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8732647895812988  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8732647895812988  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.873274326324463  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8736844062805176  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8737201690673828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8737201690673828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8737316131591797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8743038177490234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8743290901184082  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8743290901184082  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8743367195129395  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8747715950012207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8748459815979004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8748459815979004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8748631477355957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8759617805480957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8760013580322266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8760013580322266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8760108947753906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.876688003540039  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.876725673675537  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.876725673675537  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8767333030700684  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8773283958435059  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.877394199371338  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.877394199371338  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8774056434631348  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8783783912658691  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.878422737121582  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.878422737121582  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8784303665161133  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8791322708129883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8792228698730469  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8792228698730469  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8792362213134766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8805580139160156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8806815147399902  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8806815147399902  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8806986808776855  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8825182914733887  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8826327323913574  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8826327323913574  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.88264799118042  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8843722343444824  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.88447904586792  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.88447904586792  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8844923973083496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.886094570159912  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8862090110778809  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8862090110778809  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8862223625183105  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8879179954528809  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.888002872467041  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.888002872467041  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.888012409210205  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8892903327941895  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8893818855285645  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8893818855285645  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8893914222717285  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8907361030578613  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8908123970031738  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8908123970031738  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.890820026397705  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.89194917678833  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8920936584472656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8920936584472656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8921070098876953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8941764831542969  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8943910598754883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8943910598754883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8944101333618164  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8975000381469727  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8975830078125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8975830078125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8975906372070312  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8988800048828125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3032, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9717297554016113  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9717297554016113  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3032, 256]), torch.Size([1, 3032, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.978224277496338  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.002720355987549  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3032, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.928534507751465  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.9290881156921387  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.9296417236328125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.9290642738342285  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([3161, 47])
input nodes number: 29752
output nodes number: 3161
edges number: 77609
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.929328441619873  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.9293289184570312  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.05480003356933594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 9 input nodes size: 107686
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04632425308227539  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04632425308227539  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.0864405632019043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.08646297454833984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.045780181884765625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04839515686035156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04839515686035156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 107686
first layer output nodes number: 28455
edges number: 277505
----------------------------------------before model layer 0
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04940986633300781  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([107686, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04940986633300781  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([63, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1560807228088379  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1560807228088379  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 63, 100]), torch.Size([1, 63, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1561284065246582  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15650558471679688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 63, 100])
m.shape torch.Size([94, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15655183792114258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15655183792114258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 94, 100]), torch.Size([1, 94, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15662240982055664  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15767526626586914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 94, 100])
m.shape torch.Size([153, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15781116485595703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15781116485595703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 153, 100]), torch.Size([1, 153, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15792560577392578  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16043901443481445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 153, 100])
m.shape torch.Size([181, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16065168380737305  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16065168380737305  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 181, 100]), torch.Size([1, 181, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16078710556030273  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1647028923034668  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 181, 100])
m.shape torch.Size([193, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1649947166442871  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1649947166442871  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 193, 100]), torch.Size([1, 193, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16513872146606445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17032289505004883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 193, 100])
m.shape torch.Size([248, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1708054542541504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1708054542541504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 248, 100]), torch.Size([1, 248, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1709904670715332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17893743515014648  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 248, 100])
m.shape torch.Size([269, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17954683303833008  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17954683303833008  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 269, 100]), torch.Size([1, 269, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1797480583190918  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18977928161621094  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 269, 100])
m.shape torch.Size([263, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19046258926391602  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19046258926391602  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 263, 100]), torch.Size([1, 263, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1906590461730957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20183420181274414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 263, 100])
m.shape torch.Size([279, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20267152786254883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20267152786254883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 279, 100]), torch.Size([1, 279, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2028794288635254  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2161850929260254  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 279, 100])
m.shape torch.Size([26712, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.31559133529663086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.31559133529663086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 26712, 100]), torch.Size([1, 26712, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.3354935646057129  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.748537540435791  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 26712, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6452679634094238  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6724047660827637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6995415687561035  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6724047660827637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([28455, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6995415687561035  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7067804336547852  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7067804336547852  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.77730131149292  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.77730131149292  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7773032188415527  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7773184776306152  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7773218154907227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7773218154907227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7773256301879883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7773828506469727  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7773985862731934  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7773985862731934  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7774100303649902  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7776618003845215  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7776679992675781  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7776679992675781  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7776737213134766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7778396606445312  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7778563499450684  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7778563499450684  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7778639793395996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7781386375427246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7781524658203125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7781524658203125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.778158187866211  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7784042358398438  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7784218788146973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7784218788146973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7784276008605957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7787137031555176  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.778726577758789  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.778726577758789  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7787303924560547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7789478302001953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([8, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7790155410766602  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7790155410766602  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7790307998657227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7800073623657227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([12, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7801151275634766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7801151275634766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7801380157470703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7817630767822266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([5, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7818045616149902  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7818045616149902  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7818140983581543  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7825579643249512  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7825994491577148  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7825994491577148  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.782607078552246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7832555770874023  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7833271026611328  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7833271026611328  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7833385467529297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7843914031982422  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.784480094909668  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.784480094909668  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7844934463500977  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7858152389526367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7858810424804688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7858810424804688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7858905792236328  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7869014739990234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.786942958831787  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.786942958831787  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7869486808776855  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.787595272064209  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7877235412597656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7877235412597656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7877388000488281  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7895698547363281  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.789700984954834  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.789700984954834  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7897162437438965  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.791654109954834  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([4, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.791719913482666  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.791719913482666  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7917275428771973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7927498817443848  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7928037643432617  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7928037643432617  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7928094863891602  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7936162948608398  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7936944961547852  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7936944961547852  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7937021255493164  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7948312759399414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.795060157775879  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.795060157775879  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7950811386108398  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7983331680297852  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.798499584197998  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.798499584197998  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7985148429870605  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8009867668151855  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8012099266052246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8012099266052246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8012290000915527  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8044524192810059  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([2854, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8730192184448242  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8730192184448242  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2854, 256]), torch.Size([1, 2854, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.878462791442871  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.856287956237793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2854, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.7858715057373047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.7863941192626953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.786916732788086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.7863717079162598  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([2984, 47])
input nodes number: 28455
output nodes number: 2984
edges number: 73220
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.7865753173828125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.7865757942199707  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.05334186553955078  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 10 input nodes size: 121599
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04574918746948242  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04574918746948242  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.0910487174987793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.09107208251953125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.0509333610534668  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.0542149543762207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.0542149543762207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 121599
first layer output nodes number: 36427
edges number: 362611
----------------------------------------before model layer 0
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.05539274215698242  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([121599, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.05539274215698242  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([16, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19456052780151367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19456052780151367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 100]), torch.Size([1, 16, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19457292556762695  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19466924667358398  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 100])
m.shape torch.Size([32, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1946868896484375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1946868896484375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 32, 100]), torch.Size([1, 32, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19471073150634766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.195068359375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 32, 100])
m.shape torch.Size([33, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19509363174438477  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19509363174438477  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 33, 100]), torch.Size([1, 33, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19511842727661133  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1956639289855957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 33, 100])
m.shape torch.Size([38, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1957082748413086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1957082748413086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 38, 100]), torch.Size([1, 38, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19573688507080078  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19656085968017578  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 38, 100])
m.shape torch.Size([45, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19663047790527344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19663047790527344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 45, 100]), torch.Size([1, 45, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19666481018066406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19787931442260742  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 45, 100])
m.shape torch.Size([50, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19797420501708984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19797420501708984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 50, 100]), torch.Size([1, 50, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1980123519897461  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19962692260742188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 50, 100])
m.shape torch.Size([64, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19977474212646484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19977474212646484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 64, 100]), torch.Size([1, 64, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19982242584228516  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20220661163330078  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 64, 100])
m.shape torch.Size([62, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20236778259277344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20236778259277344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 62, 100]), torch.Size([1, 62, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20241451263427734  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20505523681640625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 62, 100])
m.shape torch.Size([59, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2052297592163086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2052297592163086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 59, 100]), torch.Size([1, 59, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2052745819091797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20810461044311523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 59, 100])
m.shape torch.Size([36028, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.3428478240966797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.3428478240966797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 36028, 100]), torch.Size([1, 36028, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.3696908950805664  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2755489349365234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 36028, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1399283409118652  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1746678352355957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.209407329559326  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1746678352355957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([36427, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.209407329559326  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.218092441558838  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.218092441558838  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2930169105529785  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2930169105529785  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2930188179016113  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2931008338928223  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2931089401245117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2931089401245117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2931108474731445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2932329177856445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.293242931365967  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.293242931365967  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2932448387145996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.293393611907959  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2934160232543945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2934160232543945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.29341983795166  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2937440872192383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2937569618225098  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2937569618225098  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2937588691711426  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2939610481262207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.293996810913086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.293996810913086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2940006256103516  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2945117950439453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.294548511505127  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.294548511505127  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2945523262023926  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2950901985168457  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2951087951660156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2951087951660156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2951107025146484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2953929901123047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3106, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.370023727416992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.370023727416992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3106, 256]), torch.Size([1, 3106, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.3764395713806152  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.422886371612549  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3106, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.3486170768737793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.349163055419922  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.3497090339660645  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.34913969039917  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([3117, 47])
input nodes number: 36427
output nodes number: 3117
edges number: 77814
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.3494582176208496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.349458694458008  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.06014108657836914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 11 input nodes size: 120003
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.05095672607421875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.05095672607421875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.09566164016723633  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.09568500518798828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.05036211013793945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.05342531204223633  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.05342531204223633  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 120003
first layer output nodes number: 34049
edges number: 334733
----------------------------------------before model layer 0
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.054574012756347656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([120003, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.054574012756347656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([51, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18280887603759766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18280887603759766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 51, 100]), torch.Size([1, 51, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1828470230102539  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1831521987915039  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 51, 100])
m.shape torch.Size([64, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1831808090209961  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1831808090209961  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 64, 100]), torch.Size([1, 64, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1832284927368164  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1839437484741211  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 64, 100])
m.shape torch.Size([109, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18404197692871094  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18404197692871094  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 109, 100]), torch.Size([1, 109, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18412399291992188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18591547012329102  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 109, 100])
m.shape torch.Size([155, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18610572814941406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18610572814941406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 155, 100]), torch.Size([1, 155, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18622207641601562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18957901000976562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 155, 100])
m.shape torch.Size([193, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18988037109375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18988037109375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 193, 100]), torch.Size([1, 193, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19002437591552734  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19520854949951172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 193, 100])
m.shape torch.Size([199, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19558143615722656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19558143615722656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 199, 100]), torch.Size([1, 199, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19573020935058594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20211029052734375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 199, 100])
m.shape torch.Size([222, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20261526107788086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20261526107788086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 222, 100]), torch.Size([1, 222, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20278120040893555  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2110581398010254  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 222, 100])
m.shape torch.Size([223, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2116398811340332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2116398811340332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 223, 100]), torch.Size([1, 223, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2118067741394043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.22128534317016602  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 223, 100])
m.shape torch.Size([220, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2219395637512207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2219395637512207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 220, 100]), torch.Size([1, 220, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.22210359573364258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.23260164260864258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 220, 100])
m.shape torch.Size([32613, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.35401296615600586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.35401296615600586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 32613, 100]), torch.Size([1, 32613, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.3783116340637207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1035170555114746  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 32613, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.978710651397705  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0111823081970215  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.043653964996338  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0111823081970215  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([34049, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.043653964996338  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.051772117614746  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.051772117614746  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1251273155212402  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1251273155212402  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1251330375671387  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.125178813934326  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1251840591430664  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1251840591430664  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1251916885375977  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1253061294555664  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1253085136413574  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1253085136413574  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.125312328338623  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.125396251678467  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1254100799560547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1254100799560547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.125417709350586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.125638961791992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.125669002532959  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.125669002532959  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1256823539733887  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1261630058288574  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.126173973083496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.126173973083496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1261796951293945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1264257431030273  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.126476764678955  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.126476764678955  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1264920234680176  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1272549629211426  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1273088455200195  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1273088455200195  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.127324104309082  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1281938552856445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1282644271850586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1282644271850586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.128281593322754  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.129380226135254  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.129439353942871  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.129439353942871  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.129452705383301  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1304006576538086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.130478858947754  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.130478858947754  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1304941177368164  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1316843032836914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.131746292114258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.131746292114258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1317577362060547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.132730484008789  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1328248977661133  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1328248977661133  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.132840156555176  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.134243965148926  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([3, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.134276866912842  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.134276866912842  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1342825889587402  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1348490715026855  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([10, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.134990692138672  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.134990692138672  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.135009765625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1370315551757812  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([2, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1370530128479004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1370530128479004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.137056827545166  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1374878883361816  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.137551784515381  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.137551784515381  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.137559413909912  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.138474941253662  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1385231018066406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1385231018066406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.138528823852539  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1392555236816406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1393260955810547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1393260955810547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.139333724975586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1403560638427734  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1404099464416504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1404099464416504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.140415668487549  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1412224769592285  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1414012908935547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1414012908935547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.14141845703125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1439590454101562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1440353393554688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1440353393554688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.14404296875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1452255249023438  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.145354747772217  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.145354747772217  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1453661918640137  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1472201347351074  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.147353172302246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.147353172302246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.147364616394043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.149298667907715  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2980, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2208971977233887  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2208971977233887  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2980, 256]), torch.Size([1, 2980, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.227339744567871  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.2486658096313477  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2980, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.1760659217834473  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.1766109466552734  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.1771559715270996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.1765875816345215  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([3111, 47])
input nodes number: 34049
output nodes number: 3111
edges number: 76162
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.1768641471862793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.1768646240234375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.058748722076416016  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 12 input nodes size: 117074
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.05036115646362305  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.05036115646362305  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.09397506713867188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.09399747848510742  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04926919937133789  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.052088260650634766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.052088260650634766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 117074
first layer output nodes number: 31056
edges number: 305397
----------------------------------------before model layer 0
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.0531926155090332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([117074, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.0531926155090332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([32, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17020130157470703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17020130157470703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 32, 100]), torch.Size([1, 32, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1702251434326172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17041587829589844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 32, 100])
m.shape torch.Size([72, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1704578399658203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1704578399658203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 72, 100]), torch.Size([1, 72, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17051219940185547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17131900787353516  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 72, 100])
m.shape torch.Size([96, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17139911651611328  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17139911651611328  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 96, 100]), torch.Size([1, 96, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17147064208984375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17304420471191406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 96, 100])
m.shape torch.Size([129, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1732010841369629  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1732010841369629  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 129, 100]), torch.Size([1, 129, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17329740524291992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17609071731567383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 129, 100])
m.shape torch.Size([164, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17634820938110352  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17634820938110352  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 164, 100]), torch.Size([1, 164, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17647123336791992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1808786392211914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 164, 100])
m.shape torch.Size([184, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1812286376953125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1812286376953125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 184, 100]), torch.Size([1, 184, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.181365966796875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18726253509521484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 184, 100])
m.shape torch.Size([223, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1877756118774414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1877756118774414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 223, 100]), torch.Size([1, 223, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1879425048828125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1962571144104004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 223, 100])
m.shape torch.Size([192, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1967458724975586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1967458724975586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 192, 100]), torch.Size([1, 192, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19688892364501953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20504283905029297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 192, 100])
m.shape torch.Size([244, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20578956604003906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20578956604003906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 244, 100]), torch.Size([1, 244, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20597171783447266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.21761655807495117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 244, 100])
m.shape torch.Size([29720, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.32824134826660156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.32824134826660156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 29720, 100]), torch.Size([1, 29720, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.35167884826660156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9380788803100586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 29720, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8232245445251465  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.852841854095459  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8824591636657715  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.852841854095459  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([31056, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8824591636657715  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.889951229095459  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.889951229095459  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.960184097290039  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.960184097290039  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9601879119873047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.960245132446289  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.960258960723877  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.960258960723877  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9602665901184082  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9604878425598145  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9605131149291992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9605131149291992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.960524559020996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9609365463256836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9609713554382324  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9609713554382324  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.960984706878662  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9615588188171387  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9616127014160156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9616127014160156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.961629867553711  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9624881744384766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9625182151794434  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9625182151794434  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9625277519226074  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.963071346282959  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9631271362304688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9631271362304688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9631404876708984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9639949798583984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9640560150146484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9640560150146484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9640693664550781  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.965017318725586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([11, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9651269912719727  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9651269912719727  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9651479721069336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9667844772338867  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([5, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9668316841125488  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9668316841125488  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.966841220855713  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9676518440246582  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([10, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9677724838256836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9677724838256836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9677915573120117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9695463180541992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([4, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.969590663909912  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.969590663909912  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9695982933044434  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.970353603363037  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9704651832580566  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9704651832580566  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9704804420471191  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9720978736877441  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9721980094909668  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9721980094909668  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9722113609313965  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9737200736999512  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9737792015075684  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9737792015075684  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9737868309020996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9747023582458496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9748024940490723  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9748024940490723  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9748139381408691  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9762673377990723  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9763712882995605  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9763712882995605  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9763827323913574  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9779162406921387  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9780259132385254  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9780259132385254  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9780373573303223  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9796509742736816  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9798474311828613  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9798474311828613  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9798665046691895  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.982689380645752  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.982954978942871  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.982954978942871  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9829797744750977  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9868230819702148  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.98687744140625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.98687744140625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9868831634521484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9878101348876953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9879460334777832  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9879460334777832  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.98795747756958  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.989891529083252  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2835, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0580058097839355  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0580058097839355  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2835, 256]), torch.Size([1, 2835, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.063432216644287  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.038154125213623  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2835, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.968327522277832  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.9688496589660645  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.969371795654297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.968827247619629  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([2981, 47])
input nodes number: 31056
output nodes number: 2981
edges number: 72921
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.9690585136413574  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.9690589904785156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.05704832077026367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 13 input nodes size: 103172
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04924631118774414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04924631118774414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.08768129348754883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.08770465850830078  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.044068336486816406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.046820640563964844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.046820640563964844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 103172
first layer output nodes number: 29865
edges number: 292886
----------------------------------------before model layer 0
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.047812461853027344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([103172, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.047812461853027344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([51, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1608266830444336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1608266830444336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 51, 100]), torch.Size([1, 51, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16086483001708984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16117000579833984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 51, 100])
m.shape torch.Size([73, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16120576858520508  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16120576858520508  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 73, 100]), torch.Size([1, 73, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16126108169555664  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16208219528198242  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 73, 100])
m.shape torch.Size([117, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1621856689453125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1621856689453125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 117, 100]), torch.Size([1, 117, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16227340698242188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16419506072998047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 117, 100])
m.shape torch.Size([144, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1643657684326172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1643657684326172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 144, 100]), torch.Size([1, 144, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1644735336303711  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1675872802734375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 144, 100])
m.shape torch.Size([188, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16788387298583984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16788387298583984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 188, 100]), torch.Size([1, 188, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16802406311035156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17307090759277344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 188, 100])
m.shape torch.Size([193, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1734323501586914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1734323501586914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 193, 100]), torch.Size([1, 193, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17357635498046875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17976856231689453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 193, 100])
m.shape torch.Size([231, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1802992820739746  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1802992820739746  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 231, 100]), torch.Size([1, 231, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18047189712524414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18908262252807617  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 231, 100])
m.shape torch.Size([207, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18961334228515625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18961334228515625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 207, 100]), torch.Size([1, 207, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18976783752441406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1985626220703125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 207, 100])
m.shape torch.Size([219, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1992197036743164  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1992197036743164  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 219, 100]), torch.Size([1, 219, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19938373565673828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20984315872192383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 219, 100])
m.shape torch.Size([28442, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.3157162666320801  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.3157162666320801  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 28442, 100]), torch.Size([1, 28442, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.33690786361694336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8414826393127441  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 28442, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7335233688354492  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7628202438354492  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7913017272949219  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7620048522949219  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([29865, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7913017272949219  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7976069450378418  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7976069450378418  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8711967468261719  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8711967468261719  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8711986541748047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8712139129638672  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8712172508239746  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8712172508239746  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8712210655212402  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8712782859802246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.871291160583496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.871291160583496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8713006973266602  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8715105056762695  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8715252876281738  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8715252876281738  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.871534824371338  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8718113899230957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([10, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8718547821044922  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8718547821044922  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8718738555908203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8725605010986328  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8725857734680176  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8725857734680176  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8725972175598145  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.87308931350708  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8731441497802734  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8731441497802734  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8731613159179688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8740196228027344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8740649223327637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8740649223327637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8740782737731934  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8748393058776855  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8749022483825684  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8749022483825684  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8749175071716309  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8758940696716309  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8759541511535645  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8759541511535645  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8759675025939941  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.876915454864502  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8769726753234863  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8769726753234863  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8769841194152832  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8778767585754395  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8779635429382324  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8779635429382324  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.877978801727295  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8792757987976074  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8793435096740723  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8793435096740723  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8793549537658691  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8804078102111816  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.880469799041748  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.880469799041748  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.880479335784912  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8814234733581543  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8815340995788574  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8815340995788574  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.88154935836792  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.883166790008545  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8832979202270508  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8832979202270508  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.883315086364746  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8852548599243164  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8853607177734375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8853607177734375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8853740692138672  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8869762420654297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.887108325958252  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.887108325958252  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8871235847473145  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.889061450958252  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8891634941101074  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8891634941101074  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8891749382019043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8907084465026855  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8909144401550293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8909144401550293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8909354209899902  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8938937187194824  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8940248489379883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8940248489379883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.894038200378418  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8960142135620117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.896155834197998  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.896155834197998  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8961691856384277  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8982386589050293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8984313011169434  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8984313011169434  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8984484672546387  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9012293815612793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9013824462890625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9013824462890625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9013957977294922  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9036521911621094  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([2967, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9749369621276855  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9749369621276855  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2967, 256]), torch.Size([1, 2967, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9814848899841309  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.9867539405822754  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2967, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.913949966430664  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.9144983291625977  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.9150466918945312  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.9144749641418457  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([3131, 47])
input nodes number: 29865
output nodes number: 3131
edges number: 76409
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.9147472381591797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.914747714996338  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.05244636535644531  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 14 input nodes size: 104999
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04409456253051758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04409456253051758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.08320999145507812  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.08323335647583008  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04477500915527344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04724597930908203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04724597930908203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 104999
first layer output nodes number: 26088
edges number: 254775
----------------------------------------before model layer 0
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.048223018646240234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([104999, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.048223018646240234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([48, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14662647247314453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14662647247314453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 48, 100]), torch.Size([1, 48, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14666271209716797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14694976806640625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 48, 100])
m.shape torch.Size([68, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14698266983032227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14698266983032227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 68, 100]), torch.Size([1, 68, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1470341682434082  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1477980613708496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 68, 100])
m.shape torch.Size([116, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1479020118713379  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1479020118713379  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 116, 100]), torch.Size([1, 116, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14798879623413086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14989376068115234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 116, 100])
m.shape torch.Size([170, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15010404586791992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15010404586791992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 170, 100]), torch.Size([1, 170, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15023088455200195  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15390920639038086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 170, 100])
m.shape torch.Size([200, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1542186737060547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1542186737060547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 200, 100]), torch.Size([1, 200, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15436840057373047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15973711013793945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 200, 100])
m.shape torch.Size([215, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1601428985595703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1601428985595703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 215, 100]), torch.Size([1, 215, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16030311584472656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1671924591064453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 215, 100])
m.shape torch.Size([249, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16776180267333984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16776180267333984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 249, 100]), torch.Size([1, 249, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16794776916503906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17723608016967773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 249, 100])
m.shape torch.Size([228, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17782258987426758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17782258987426758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 228, 100]), torch.Size([1, 228, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1779932975769043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18768930435180664  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 228, 100])
m.shape torch.Size([234, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18838882446289062  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18838882446289062  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 234, 100]), torch.Size([1, 234, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18856334686279297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19973278045654297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 234, 100])
m.shape torch.Size([24560, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2914423942565918  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2914423942565918  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 24560, 100]), torch.Size([1, 24560, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.3097414970397949  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6243128776550293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 24560, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5286855697631836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5535650253295898  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.578444480895996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5535650253295898  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([26088, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.578444480895996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5846643447875977  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.5846643447875977  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.658515453338623  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.658515453338623  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6585230827331543  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6585841178894043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6585826873779297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6585826873779297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6585845947265625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6586132049560547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6586213111877441  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6586213111877441  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6586270332336426  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6587529182434082  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6587657928466797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6587657928466797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.658773422241211  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6589946746826172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.65901517868042  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.65901517868042  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.659024715423584  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6593680381774902  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6593809127807617  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6593809127807617  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6593866348266602  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.659632682800293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6596837043762207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6596837043762207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6596989631652832  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6604619026184082  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6605005264282227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6605005264282227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6605119705200195  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6611642837524414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6612019538879395  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6612019538879395  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6612114906311035  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6618218421936035  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.661855697631836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.661855697631836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6618633270263672  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.662405014038086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([10, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6625070571899414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6625070571899414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6625261306762695  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6640138626098633  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6641082763671875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6641082763671875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6641254425048828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6655845642089844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([4, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.665626049041748  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.665626049041748  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6656336784362793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6663355827331543  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([10, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6664667129516602  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6664667129516602  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6664857864379883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6683740615844727  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6685376167297363  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6685376167297363  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.66856050491333  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6709866523742676  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([5, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6710524559020996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6710524559020996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6710619926452637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6721396446228027  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([12, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6723313331604004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6723313331604004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6723542213439941  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6751008033752441  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([5, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6751761436462402  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6751761436462402  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6751856803894043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6763968467712402  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([12, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6766114234924316  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6766114234924316  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6766343116760254  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.679701328277588  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([6, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6798052787780762  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6798052787780762  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.679816722869873  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6814303398132324  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6815862655639648  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6815862655639648  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6816015243530273  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6838598251342773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6840004920959473  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6840004920959473  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.684013843536377  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6860833168029785  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6862316131591797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6862316131591797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6862449645996094  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6884078979492188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.688539981842041  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.688539981842041  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.688551425933838  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6904854774475098  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2979, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7620596885681152  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7620596885681152  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2979, 256]), torch.Size([1, 2979, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.767876148223877  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.7750020027160645  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2979, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.701934814453125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.702484130859375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.703033447265625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.702460765838623  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([3135, 47])
input nodes number: 26088
output nodes number: 3135
edges number: 76677
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.7026796340942383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.7026801109313965  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.051691532135009766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 15 input nodes size: 147488
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.044775962829589844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.044775962829589844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.09971952438354492  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.09974193572998047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.06060314178466797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.06377410888671875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.06377410888671875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 147488
first layer output nodes number: 35820
edges number: 351944
----------------------------------------before model layer 0
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.0651402473449707  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([147488, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.0651402473449707  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([42, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20009279251098633  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20009279251098633  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 42, 100]), torch.Size([1, 42, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20012426376342773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20037603378295898  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 42, 100])
m.shape torch.Size([78, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20041847229003906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20041847229003906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 78, 100]), torch.Size([1, 78, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20047664642333984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20134925842285156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 78, 100])
m.shape torch.Size([120, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20145463943481445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20145463943481445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 120, 100]), torch.Size([1, 120, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20154428482055664  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20351219177246094  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 120, 100])
m.shape torch.Size([157, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20370149612426758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20370149612426758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 157, 100]), torch.Size([1, 157, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20381879806518555  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2072148323059082  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 157, 100])
m.shape torch.Size([227, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2075791358947754  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2075791358947754  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 227, 100]), torch.Size([1, 227, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2077488899230957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.21384572982788086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 227, 100])
m.shape torch.Size([207, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.21422386169433594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.21422386169433594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 207, 100]), torch.Size([1, 207, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.21437835693359375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.22101306915283203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 207, 100])
m.shape torch.Size([258, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.22160863876342773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.22160863876342773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 258, 100]), torch.Size([1, 258, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2218012809753418  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.23142337799072266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 258, 100])
m.shape torch.Size([237, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.23203372955322266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.23203372955322266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 237, 100]), torch.Size([1, 237, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.23221111297607422  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.24228763580322266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 237, 100])
m.shape torch.Size([261, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2430744171142578  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2430744171142578  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 261, 100]), torch.Size([1, 261, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2432689666748047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2557201385498047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 261, 100])
m.shape torch.Size([34233, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.3831510543823242  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.3831510543823242  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 34233, 100]), torch.Size([1, 34233, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.4086570739746094  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2195701599121094  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 34233, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0883755683898926  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1225361824035645  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1566967964172363  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1225361824035645  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([35820, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1566967964172363  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1652369499206543  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.1652369499206543  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.236032009124756  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.236032009124756  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2360358238220215  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2361197471618652  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.236151695251465  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.236151695251465  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2361650466918945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2366456985473633  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2366795539855957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2366795539855957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2366929054260254  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.237267017364502  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2372875213623047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2372875213623047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.237295150756836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2376766204833984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.237703800201416  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.237703800201416  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2377114295959473  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2381463050842285  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2381772994995117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2381772994995117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.238184928894043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.238673210144043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.238708019256592  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.238708019256592  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.238715648651123  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.239257335662842  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([10, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2393593788146973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2393593788146973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2393784523010254  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.240866184234619  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([7, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2409377098083496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2409377098083496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2409510612487793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2420859336853027  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.242116928100586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.242116928100586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2421226501464844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2426490783691406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([10, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.242781162261963  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.242781162261963  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.242800235748291  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2446885108947754  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([7, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2447800636291504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2447800636291504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.24479341506958  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.246208667755127  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.246248245239258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.246248245239258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2462539672851562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2469005584716797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2470288276672363  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2470288276672363  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.247044086456299  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.248875141143799  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2490234375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2490234375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2490406036376953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.251220703125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([2, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.251248836517334  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.251248836517334  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2512526512145996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2517638206481934  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([8, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.25191593170166  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.25191593170166  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2519311904907227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.254082679748535  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2542567253112793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2542567253112793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2542738914489746  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.256814479827881  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2570176124572754  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2570176124572754  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2570366859436035  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.259993076324463  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.260138511657715  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.260138511657715  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.2601518630981445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.262314796447754  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.262446880340576  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.262446880340576  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.262458324432373  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.264392375946045  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2862, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.3331551551818848  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.3331551551818848  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2862, 256]), torch.Size([1, 2862, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.339052677154541  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.3442559242248535  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2862, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.2745962142944336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.275120258331299  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.275644302368164  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.2750978469848633  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([2993, 47])
input nodes number: 35820
output nodes number: 2993
edges number: 73505
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.275362014770508  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.275362491607666  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.06953144073486328  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 16 input nodes size: 111629
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.0605778694152832  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.0605778694152832  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.10216331481933594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.10218572616577148  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04721975326538086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.0500941276550293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.0500941276550293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 111629
first layer output nodes number: 32160
edges number: 315020
----------------------------------------before model layer 0
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.05116605758666992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([111629, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.05116605758666992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([47, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17184972763061523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17184972763061523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 47, 100]), torch.Size([1, 47, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17188501358032227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1721658706665039  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 47, 100])
m.shape torch.Size([105, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1722269058227539  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1722269058227539  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 105, 100]), torch.Size([1, 105, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17230606079101562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17348480224609375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 105, 100])
m.shape torch.Size([116, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17357492446899414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17357492446899414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 116, 100]), torch.Size([1, 116, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1736617088317871  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1755666732788086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 116, 100])
m.shape torch.Size([184, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1757974624633789  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1757974624633789  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 184, 100]), torch.Size([1, 184, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1759347915649414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17991161346435547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 184, 100])
m.shape torch.Size([190, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18019723892211914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18019723892211914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 190, 100]), torch.Size([1, 190, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18033933639526367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1854405403137207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 190, 100])
m.shape torch.Size([233, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18589067459106445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18589067459106445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 233, 100]), torch.Size([1, 233, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1860651969909668  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1935439109802246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 233, 100])
m.shape torch.Size([254, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19411945343017578  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19411945343017578  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 254, 100]), torch.Size([1, 254, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19430923461914062  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20377826690673828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 254, 100])
m.shape torch.Size([242, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2044048309326172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2044048309326172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 242, 100]), torch.Size([1, 242, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.20458602905273438  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.21487998962402344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 242, 100])
m.shape torch.Size([273, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.21570491790771484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.21570491790771484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 273, 100]), torch.Size([1, 273, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.21590900421142578  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2289447784423828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 273, 100])
m.shape torch.Size([30516, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.34252405166625977  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.34252405166625977  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 30516, 100]), torch.Size([1, 30516, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.36579465866088867  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.987785816192627  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 30516, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8697361946105957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9004063606262207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9310765266418457  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9004063606262207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([32160, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.9310765266418457  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.938744068145752  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.938744068145752  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0067825317382812  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0067825317382812  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.006786346435547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.006816864013672  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0068306922912598  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0068306922912598  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0068459510803223  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0070748329162598  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([14, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.007107734680176  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.007107734680176  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.007134437561035  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0077219009399414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([25, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0078048706054688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0078048706054688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.007852554321289  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.009235382080078  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([14, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.009279251098633  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.009279251098633  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.009305953979492  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0102672576904297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.010317802429199  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.010317802429199  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.01033878326416  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0112409591674805  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0113449096679688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0113449096679688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0113773345947266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.012998580932617  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0130977630615234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0130977630615234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0131263732910156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0147571563720703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0148730278015137  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0148730278015137  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.014901638031006  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.016732692718506  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0168533325195312  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0168533325195312  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0168800354003906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0187759399414062  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0189003944396973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0189003944396973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.018925189971924  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0208592414855957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0209741592407227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0209741592407227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0209951400756836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0227785110473633  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0229058265686035  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0229058265686035  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0229268074035645  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0248570442199707  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.025008201599121  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.025008201599121  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.025031089782715  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.027297019958496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.027458667755127  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.027458667755127  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0274815559387207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.029907703399658  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([16, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.030142307281494  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.030142307281494  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.030172824859619  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.033621311187744  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.033834934234619  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.033834934234619  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0338616371154785  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0370659828186035  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([12, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0372605323791504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0372605323791504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.037283420562744  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0401902198791504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.040471076965332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.040471076965332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.040501594543457  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.044590950012207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.044826030731201  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.044826030731201  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0448508262634277  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.048346996307373  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0484962463378906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0484962463378906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.048511505126953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.050769805908203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.051037311553955  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.051037311553955  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0510621070861816  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.054905414581299  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.055180549621582  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.055180549621582  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0552053451538086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0592222213745117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0594868659973145  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.0594868659973145  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.059509754180908  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.063377857208252  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([2670, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.127521514892578  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.127521514892578  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2670, 256]), torch.Size([1, 2670, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.133312225341797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 3.029613494873047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2670, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.962456703186035  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.9629788398742676  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.9635009765625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.962956428527832  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([2981, 47])
input nodes number: 32160
output nodes number: 2981
edges number: 70641
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.963216781616211  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.963217258453369  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.055078983306884766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 17 input nodes size: 92267
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04721784591674805  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04721784591674805  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.08159017562866211  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.08161306381225586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04000520706176758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04327249526977539  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04327249526977539  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 92267
first layer output nodes number: 27907
edges number: 271606
----------------------------------------before model layer 0
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04416847229003906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([92267, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.04416847229003906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([58, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1482372283935547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1482372283935547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 58, 100]), torch.Size([1, 58, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14828109741210938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14862918853759766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 58, 100])
m.shape torch.Size([110, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14868927001953125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.14868927001953125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 110, 100]), torch.Size([1, 110, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1487712860107422  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15000152587890625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 110, 100])
m.shape torch.Size([138, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1501150131225586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1501150131225586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 138, 100]), torch.Size([1, 138, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15021800994873047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15248394012451172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 138, 100])
m.shape torch.Size([197, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1527261734008789  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1527261734008789  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 197, 100]), torch.Size([1, 197, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15287303924560547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15713214874267578  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 197, 100])
m.shape torch.Size([216, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15746116638183594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.15746116638183594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 216, 100]), torch.Size([1, 216, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1576223373413086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16341733932495117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 216, 100])
m.shape torch.Size([258, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16391372680664062  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.16391372680664062  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 258, 100]), torch.Size([1, 258, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1641063690185547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17238140106201172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 258, 100])
m.shape torch.Size([280, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17301559448242188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17301559448242188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 280, 100]), torch.Size([1, 280, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.17322444915771484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18365716934204102  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 280, 100])
m.shape torch.Size([330, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18453645706176758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.18453645706176758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 330, 100]), torch.Size([1, 330, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1847825050354004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1988072395324707  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 330, 100])
m.shape torch.Size([302, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19969701766967773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.19969701766967773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 302, 100]), torch.Size([1, 302, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.1999220848083496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.2143263816833496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 302, 100])
m.shape torch.Size([26018, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.3111386299133301  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.3111386299133301  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 26018, 100]), torch.Size([1, 26018, 100])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 0.3305239677429199  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7068686485290527  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 26018, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6058611869812012  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6324753761291504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6590895652770996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6324753761291504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([27907, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.6590895652770996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.665743350982666  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.665743350982666  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7342238426208496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7342238426208496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7342371940612793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7343440055847168  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7343549728393555  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7343549728393555  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7343721389770508  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7346296310424805  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7346558570861816  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7346558570861816  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7346787452697754  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.735182285308838  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.735213279724121  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.735213279724121  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.735234260559082  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7358427047729492  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7358999252319336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7358999252319336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.735926628112793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7368879318237305  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7369613647460938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7369613647460938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.736989974975586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.73822021484375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([23, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.73836088180542  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.73836088180542  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7384047508239746  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.740598201751709  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7407689094543457  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7407689094543457  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.740816593170166  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7435345649719238  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([14, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7436318397521973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7436318397521973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7436585426330566  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7453675270080566  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.745460033416748  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.745460033416748  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.745481014251709  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7469706535339355  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([20, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7471718788146973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7471718788146973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7472100257873535  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.750185489654541  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([11, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7502937316894531  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7502937316894531  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.750314712524414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7520980834960938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([16, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7522878646850586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7522878646850586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7523183822631836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7551259994506836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7553129196166992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7553129196166992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7553415298461914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.758173942565918  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.75836181640625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.75836181640625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7583885192871094  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7612190246582031  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7613749504089355  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7613749504089355  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7613959312438965  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7637667655944824  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7640833854675293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7640833854675293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7641215324401855  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7686991691589355  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7689051628112793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7689051628112793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7689299583435059  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7720789909362793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7723956108093262  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7723956108093262  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7724299430847168  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7770304679870605  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7773208618164062  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7773208618164062  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7773513793945312  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7816543579101562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7819018363952637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7819018363952637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7819266319274902  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7855963706970215  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7858800888061523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7858800888061523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7859067916870117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7900457382202148  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7902979850769043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7902979850769043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.790320873260498  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.7940287590026855  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.794386386871338  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.794386386871338  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.794416904449463  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.799574375152588  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([2664, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.863570213317871  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.863570213317871  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2664, 256]), torch.Size([1, 2664, 256])
----------------------------------------3
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 1.8686513900756836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.7689476013183594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2664, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.7013955116271973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.701923370361328  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.702451229095459  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.7019004821777344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([3014, 47])
input nodes number: 27907
output nodes number: 3014
edges number: 71095
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.7021374702453613  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3475341796875 GB
    Memory Allocated: 2.7021379470825195  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.04770994186401367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 18 input nodes size: 72389
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.040010929107666016  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.040010929107666016  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.06697797775268555  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.0670003890991211  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.03260517120361328  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.034874916076660156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.034874916076660156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 72389
first layer output nodes number: 24086
edges number: 233676
----------------------------------------before model layer 0
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.03559446334838867  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([72389, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.03559446334838867  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([34, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.12512588500976562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.12512588500976562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 34, 100]), torch.Size([1, 34, 100])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.1251516342163086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.12535619735717773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 34, 100])
m.shape torch.Size([73, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.1253981590270996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.1253981590270996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 73, 100]), torch.Size([1, 73, 100])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.12545347213745117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.12627458572387695  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 73, 100])
m.shape torch.Size([133, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.12639570236206055  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.12639570236206055  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 133, 100]), torch.Size([1, 133, 100])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.1264948844909668  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.1286768913269043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 133, 100])
m.shape torch.Size([143, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.12884044647216797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.12884044647216797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 143, 100]), torch.Size([1, 143, 100])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.12894725799560547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.13203907012939453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 143, 100])
m.shape torch.Size([256, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.1324625015258789  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.1324625015258789  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 256, 100]), torch.Size([1, 256, 100])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.13265323638916016  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.13951969146728516  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 256, 100])
m.shape torch.Size([298, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.1400904655456543  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.1400904655456543  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 298, 100]), torch.Size([1, 298, 100])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.14031267166137695  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.14986753463745117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 298, 100])
m.shape torch.Size([319, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.1505885124206543  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.1505885124206543  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 319, 100]), torch.Size([1, 319, 100])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.15082693099975586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.1627178192138672  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 319, 100])
m.shape torch.Size([364, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.16368341445922852  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.16368341445922852  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 364, 100]), torch.Size([1, 364, 100])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.1639552116394043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.17942476272583008  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 364, 100])
m.shape torch.Size([348, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.18053388595581055  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.18053388595581055  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 348, 100]), torch.Size([1, 348, 100])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.18079328536987305  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.19739484786987305  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 348, 100])
m.shape torch.Size([22118, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.2796611785888672  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.2796611785888672  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 22118, 100]), torch.Size([1, 22118, 100])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 0.2961406707763672  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.466170310974121  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 22118, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.3793950080871582  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.4023652076721191  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.42533540725708  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.4023652076721191  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([24086, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.42533540725708  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.4310779571533203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.4310779571533203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.4992904663085938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.4992904663085938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.4992923736572266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.4993209838867188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.499340534210205  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.499340534210205  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.4993538856506348  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.499647617340088  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.4996795654296875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.4996795654296875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.4996986389160156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5002517700195312  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([19, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5003337860107422  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5003337860107422  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5003700256347656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5016746520996094  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5017547607421875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5017547607421875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5017871856689453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5031814575195312  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5032596588134766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5032596588134766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.503286361694336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5046215057373047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5047392845153809  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5047392845153809  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5047717094421387  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.506619930267334  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([13, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.506716251373291  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.506716251373291  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5067410469055176  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5083279609680176  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([23, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5085368156433105  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5085368156433105  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5085806846618652  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.511695384979248  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([12, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.511800765991211  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.511800765991211  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5118236541748047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5136089324951172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5137362480163574  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5137362480163574  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5137591361999512  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.51570463180542  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([24, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5159931182861328  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5159931182861328  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5160388946533203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5202503204345703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5205373764038086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5205373764038086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5205812454223633  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5249242782592773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([24, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5252485275268555  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5252485275268555  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.525294303894043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.530146598815918  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([19, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5304160118103027  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5304160118103027  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5304522514343262  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5345473289489746  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([24, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.534921646118164  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.534921646118164  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5349674224853516  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5404605865478516  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([21, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5408010482788086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5408010482788086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5408411026000977  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5459280014038086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5461821556091309  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5461821556091309  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.546210765838623  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5500445365905762  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5502033233642578  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5502033233642578  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5502204895019531  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5526409149169922  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5530767440795898  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5530767440795898  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5531187057495117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5593290328979492  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5595831871032715  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.5595831871032715  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3514404296875 GB
    Memory Allocated: 1.559607982635498  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3533935546875 GB
    Memory Allocated: 1.5634512901306152  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3533935546875 GB
    Memory Allocated: 1.5637264251708984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3533935546875 GB
    Memory Allocated: 1.5637264251708984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3533935546875 GB
    Memory Allocated: 1.563751220703125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3572998046875 GB
    Memory Allocated: 1.5677680969238281  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3572998046875 GB
    Memory Allocated: 1.5681018829345703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3572998046875 GB
    Memory Allocated: 1.5681018829345703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3572998046875 GB
    Memory Allocated: 1.5681304931640625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3631591796875 GB
    Memory Allocated: 1.5729656219482422  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([2630, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3631591796875 GB
    Memory Allocated: 1.6361455917358398  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3631591796875 GB
    Memory Allocated: 1.6361455917358398  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2630, 256]), torch.Size([1, 2630, 256])
----------------------------------------3
 Nvidia-smi: 7.3631591796875 GB
    Memory Allocated: 1.641636848449707  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3631591796875 GB
    Memory Allocated: 2.5454835891723633  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2630, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3631591796875 GB
    Memory Allocated: 2.478208065032959  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3631591796875 GB
    Memory Allocated: 2.4787330627441406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3651123046875 GB
    Memory Allocated: 2.4792580604553223  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3651123046875 GB
    Memory Allocated: 2.478710651397705  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([2997, 47])
input nodes number: 24086
output nodes number: 2997
edges number: 70823
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3651123046875 GB
    Memory Allocated: 2.478909969329834  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3651123046875 GB
    Memory Allocated: 2.478910446166992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.03878355026245117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 19 input nodes size: 82190
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.03260231018066406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.03260231018066406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.06322050094604492  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.06324386596679688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.0362544059753418  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.03888750076293945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.03888750076293945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 82190
first layer output nodes number: 28677
edges number: 279426
----------------------------------------before model layer 0
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.03971433639526367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([82190, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.03971433639526367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([43, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.14677143096923828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.14677143096923828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 43, 100]), torch.Size([1, 43, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1468038558959961  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.14706182479858398  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 43, 100])
m.shape torch.Size([105, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1471242904663086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1471242904663086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 105, 100]), torch.Size([1, 105, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1472034454345703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.14838218688964844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 105, 100])
m.shape torch.Size([129, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.14848709106445312  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.14848709106445312  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 129, 100]), torch.Size([1, 129, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.14858341217041016  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15070247650146484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 129, 100])
m.shape torch.Size([177, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15091848373413086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15091848373413086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 177, 100]), torch.Size([1, 177, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15105104446411133  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15488386154174805  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 177, 100])
m.shape torch.Size([234, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15525388717651367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15525388717651367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 234, 100]), torch.Size([1, 234, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15542840957641602  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1617112159729004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 234, 100])
m.shape torch.Size([308, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.16231250762939453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.16231250762939453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 308, 100]), torch.Size([1, 308, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.16254234313964844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.17241668701171875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 308, 100])
m.shape torch.Size([275, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1730189323425293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1730189323425293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 275, 100]), torch.Size([1, 275, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.17322397232055664  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.18347597122192383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 275, 100])
m.shape torch.Size([292, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.18424367904663086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.18424367904663086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 292, 100]), torch.Size([1, 292, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1844620704650879  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.19687604904174805  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 292, 100])
m.shape torch.Size([341, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.19791030883789062  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.19791030883789062  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 341, 100]), torch.Size([1, 341, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1981649398803711  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.21443557739257812  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 341, 100])
m.shape torch.Size([26773, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.31404590606689453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.31404590606689453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 26773, 100]), torch.Size([1, 26773, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.33399391174316406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7502737045288086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 26773, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.64634370803833  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.673692226409912  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7010407447814941  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.673692226409912  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([28677, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7010407447814941  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7078781127929688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7078781127929688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7788958549499512  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7788958549499512  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7789053916931152  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7789816856384277  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7789983749389648  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7789983749389648  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7790193557739258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7793340682983398  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.779355525970459  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.779355525970459  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.77937650680542  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7798380851745605  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7798585891723633  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7798585891723633  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7798738479614258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7803163528442383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([12, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7803664207458496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7803664207458496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7803893089294434  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7812132835388184  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([20, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7813172340393066  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7813172340393066  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.781355381011963  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7829957008361816  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([12, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.783057689666748  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.783057689666748  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7830805778503418  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7842249870300293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([17, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7843446731567383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7843446731567383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.784377098083496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7862253189086914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.786330223083496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.786330223083496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7863569259643555  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7880659103393555  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7881970405578613  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7881970405578613  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7882256507873535  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7902569770812988  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7904224395751953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7904224395751953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7904548645019531  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7929840087890625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7931408882141113  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7931408882141113  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7931694984436035  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7956013679504395  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7957873344421387  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7957873344421387  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7958178520202637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7986254692077637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7988123893737793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7988123893737793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7988409996032715  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.801673412322998  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([12, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8018321990966797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8018321990966797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8018550872802734  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.804281234741211  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8044390678405762  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8044390678405762  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.804460048675537  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.806830883026123  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.807065486907959  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.807065486907959  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8070940971374512  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8105273246765137  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8107728958129883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8107728958129883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8108015060424805  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8144350051879883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8147859573364258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8147859573364258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.814824104309082  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8199357986450195  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8201284408569336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8201284408569336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8201494216918945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8231077194213867  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8234000205993652  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8234000205993652  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8234286308288574  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8276629447937012  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8279662132263184  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8279662132263184  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8279948234558105  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8324294090270996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.832746982574463  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.832746982574463  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.832775592803955  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8374104499816895  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8377885818481445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8377885818481445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8378210067749023  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8433008193969727  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([2772, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9098906517028809  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9098906517028809  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2772, 256]), torch.Size([1, 2772, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9154577255249023  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.846888542175293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2772, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.7775111198425293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.778055191040039  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.778599262237549  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.778031826019287  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([3106, 47])
input nodes number: 28677
output nodes number: 3106
edges number: 73732
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.7782883644104004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.7782888412475586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.0433807373046875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 20 input nodes size: 93661
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.03627347946166992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.03627347946166992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.07116508483886719  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.07118749618530273  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.04054594039916992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.043304443359375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.043304443359375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 93661
first layer output nodes number: 28109
edges number: 273703
----------------------------------------before model layer 0
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.04421234130859375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([93661, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.04421234130859375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([100, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.14909601211547852  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.14909601211547852  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 100, 100]), torch.Size([1, 100, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1491713523864746  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.14976978302001953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 100, 100])
m.shape torch.Size([117, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.14981937408447266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.14981937408447266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 117, 100]), torch.Size([1, 117, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.14990711212158203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15121746063232422  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 117, 100])
m.shape torch.Size([153, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15134477615356445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15134477615356445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 153, 100]), torch.Size([1, 153, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1514592170715332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15397262573242188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 153, 100])
m.shape torch.Size([159, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15415239334106445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15415239334106445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 159, 100]), torch.Size([1, 159, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15427160263061523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15771150588989258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 159, 100])
m.shape torch.Size([209, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15804147720336914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15804147720336914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 209, 100]), torch.Size([1, 209, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15819787979125977  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.16381406784057617  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 209, 100])
m.shape torch.Size([251, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.16429710388183594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.16429710388183594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 251, 100]), torch.Size([1, 251, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.16448497772216797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.17253780364990234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 251, 100])
m.shape torch.Size([241, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.17307233810424805  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.17307233810424805  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 241, 100]), torch.Size([1, 241, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.17325258255004883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.18224477767944336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 241, 100])
m.shape torch.Size([241, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.18287324905395508  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.18287324905395508  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 241, 100]), torch.Size([1, 241, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.18305349349975586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.19330453872680664  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 241, 100])
m.shape torch.Size([272, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.19412660598754883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.19412660598754883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 272, 100]), torch.Size([1, 272, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.19432973861694336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.2073044776916504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 272, 100])
m.shape torch.Size([26366, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.30542421340942383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.30542421340942383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 26366, 100]), torch.Size([1, 26366, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.32506895065307617  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7198166847229004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 26366, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.6179718971252441  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.6447787284851074  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.6715855598449707  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.6447787284851074  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([28109, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.6715855598449707  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.6782875061035156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.6782875061035156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7480764389038086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7480764389038086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7480840682983398  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7481451034545898  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7481474876403809  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7481474876403809  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7481532096862793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7482390403747559  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7482481002807617  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7482481002807617  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.748255729675293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7484235763549805  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7484431266784668  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7484431266784668  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7484545707702637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.748786449432373  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([11, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7488336563110352  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7488336563110352  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.748854637145996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7496099472045898  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.749657154083252  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.749657154083252  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.74967622756958  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7504963874816895  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([7, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7505340576171875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7505340576171875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7505474090576172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7512149810791016  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.751269817352295  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.751269817352295  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7512850761413574  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.75215482711792  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7521820068359375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7521820068359375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7521896362304688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7526779174804688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.752760887145996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.752760887145996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7527780532836914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7539968490600586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7541046142578125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7541046142578125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7541255950927734  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7557621002197266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7558326721191406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7558326721191406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7558460235595703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7569808959960938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7570619583129883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7570619583129883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.757075309753418  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7583036422729492  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([11, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7584452629089355  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7584452629089355  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7584662437438965  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7605433464050293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([9, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7606630325317383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7606630325317383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7606801986694336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7624998092651367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7626452445983887  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7626452445983887  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7626643180847168  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.764819622039795  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7649083137512207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7649083137512207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7649197578430176  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7662930488586426  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7664432525634766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7664432525634766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7664604187011719  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7686405181884766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7687602043151855  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7687602043151855  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7687735557556152  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7705626487731934  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7706713676452637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7706713676452637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7706828117370605  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.77229642868042  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7725129127502441  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7725129127502441  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.772533893585205  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7756390571594238  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7759037017822266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7759037017822266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7759284973144531  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7797718048095703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.779958724975586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.779958724975586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7799758911132812  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7827568054199219  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7828407287597656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7828407287597656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7828483581542969  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7841377258300781  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2799, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.851388931274414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.851388931274414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2799, 256]), torch.Size([1, 2799, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8575310707092285  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.801204204559326  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2799, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.7325077056884766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.7330307960510254  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.733553886413574  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.73300838470459  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([2985, 47])
input nodes number: 28109
output nodes number: 2985
edges number: 72457
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.733219623565674  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.733220100402832  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.04776620864868164  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 21 input nodes size: 103544
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.040524959564208984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.040524959564208984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.07909822463989258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.07912063598632812  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.04420661926269531  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.04672527313232422  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.04672527313232422  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 103544
first layer output nodes number: 27577
edges number: 266563
----------------------------------------before model layer 0
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.04770231246948242  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([103544, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.04770231246948242  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([76, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15064144134521484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15064144134521484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 76, 100]), torch.Size([1, 76, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15069866180419922  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.151153564453125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 76, 100])
m.shape torch.Size([116, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15121173858642578  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15121173858642578  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 116, 100]), torch.Size([1, 116, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15129852294921875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15259742736816406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 116, 100])
m.shape torch.Size([184, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15276002883911133  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15276002883911133  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 184, 100]), torch.Size([1, 184, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15289735794067383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.155914306640625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 184, 100])
m.shape torch.Size([256, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15622711181640625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.15622711181640625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 256, 100]), torch.Size([1, 256, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1564178466796875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.16194915771484375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 256, 100])
m.shape torch.Size([300, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1624126434326172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1624126434326172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 300, 100]), torch.Size([1, 300, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.16263675689697266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.17069053649902344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 300, 100])
m.shape torch.Size([322, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.17129850387573242  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.17129850387573242  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 322, 100]), torch.Size([1, 322, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1715388298034668  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.18186426162719727  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 322, 100])
m.shape torch.Size([320, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.18257856369018555  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.18257856369018555  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 320, 100]), torch.Size([1, 320, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1828169822692871  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.19473791122436523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 320, 100])
m.shape torch.Size([347, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.19565296173095703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.19565296173095703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 347, 100]), torch.Size([1, 347, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.19591236114501953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.2106637954711914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 347, 100])
m.shape torch.Size([329, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.2116374969482422  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.2116374969482422  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 329, 100]), torch.Size([1, 329, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.211883544921875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.22759199142456055  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 329, 100])
m.shape torch.Size([25327, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.3218197822570801  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.3218197822570801  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 25327, 100]), torch.Size([1, 25327, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.34069013595581055  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.6804709434509277  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 25327, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.5814847946166992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.6077842712402344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.6340837478637695  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.6077842712402344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([27577, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.6340837478637695  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.6406588554382324  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.6406588554382324  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.70933198928833  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.70933198928833  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7093396186828613  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7094006538391113  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7094125747680664  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7094125747680664  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.709427833557129  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7096567153930664  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.709672451019287  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.709672451019287  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7096877098083496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7100234031677246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([17, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7100815773010254  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7100815773010254  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7101140022277832  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7110543251037598  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7110910415649414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7110910415649414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7111120223999023  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.711867332458496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7119436264038086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7119436264038086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7119722366333008  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7132024765014648  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7132625579833984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7132625579833984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7132835388183594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7143325805664062  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7144145965576172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7144145965576172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.714437484741211  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7157421112060547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([6, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.715782642364502  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.715782642364502  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7157940864562988  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7165265083312988  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([13, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7166461944580078  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7166461944580078  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7166709899902344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7184314727783203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7185568809509277  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7185568809509277  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7185816764831543  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7205157279968262  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([17, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7206997871398926  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7206997871398926  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7207322120666504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7234883308410645  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7236847877502441  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7236847877502441  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.723717212677002  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7267003059387207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7268729209899902  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7268729209899902  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7268996238708496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7295432090759277  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([9, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7296600341796875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7296600341796875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7296772003173828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.731496810913086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.731672763824463  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.731672763824463  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7316956520080566  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7342820167541504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7344670295715332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7344670295715332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.734489917755127  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.737236499786377  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7374329566955566  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7374329566955566  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7374558448791504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7403626441955566  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([16, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7406435012817383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7406435012817383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7406740188598633  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7447633743286133  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7450752258300781  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7450752258300781  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.745107650756836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7496795654296875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.749946117401123  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.749946117401123  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7499728202819824  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.75392484664917  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7542924880981445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7542924880981445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7543268203735352  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.759648323059082  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7598967552185059  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7598967552185059  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7599196434020996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.763627529144287  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.763916015625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.763916015625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7639408111572266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7681312561035156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([2690, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8327546119689941  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8327546119689941  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2690, 256]), torch.Size([1, 2690, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8378853797912598  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.7418837547302246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2690, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.674802780151367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.6753268241882324  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.6758508682250977  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.675304412841797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([2991, 47])
input nodes number: 27577
output nodes number: 2991
edges number: 71297
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.6755332946777344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 2.6755337715148926  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.05199241638183594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 22 input nodes size: 114368
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.04420757293701172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.04420757293701172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.08681297302246094  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.08683538436889648  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.048239707946777344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.05096244812011719  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.05096244812011719  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 114368
first layer output nodes number: 30715
edges number: 296413
----------------------------------------before model layer 0
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.05204343795776367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([114368, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.05204343795776367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([95, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1656341552734375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1656341552734375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 95, 100]), torch.Size([1, 95, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.16570568084716797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1662735939025879  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 95, 100])
m.shape torch.Size([164, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.16636037826538086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.16636037826538086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 164, 100]), torch.Size([1, 164, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.16648340225219727  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1683201789855957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 164, 100])
m.shape torch.Size([215, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.16849899291992188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.16849899291992188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 215, 100]), torch.Size([1, 215, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.16865921020507812  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.17218399047851562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 215, 100])
m.shape torch.Size([258, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.17248868942260742  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.17248868942260742  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 258, 100]), torch.Size([1, 258, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.17268133163452148  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.17826223373413086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 258, 100])
m.shape torch.Size([361, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.17883872985839844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.17883872985839844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 361, 100]), torch.Size([1, 361, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1791086196899414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.18880319595336914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 361, 100])
m.shape torch.Size([323, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1893906593322754  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.1893906593322754  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 323, 100]), torch.Size([1, 323, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.18963193893432617  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.19998979568481445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 323, 100])
m.shape torch.Size([406, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.2009282112121582  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.2009282112121582  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 406, 100]), torch.Size([1, 406, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.2012314796447754  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.21636486053466797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 406, 100])
m.shape torch.Size([409, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.21743249893188477  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.21743249893188477  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 409, 100]), torch.Size([1, 409, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.21773767471313477  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.2351212501525879  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 409, 100])
m.shape torch.Size([384, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.23625612258911133  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.23625612258911133  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 384, 100]), torch.Size([1, 384, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.2365422248840332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.2548527717590332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 384, 100])
m.shape torch.Size([28100, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.3593907356262207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.3593907356262207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 28100, 100]), torch.Size([1, 28100, 100])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 0.3803277015686035  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.875070571899414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 28100, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7651982307434082  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7944951057434082  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8237872123718262  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.7944903373718262  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([30715, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8237872123718262  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8315997123718262  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8315997123718262  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([17, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8979687690734863  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8979687690734863  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8980011940002441  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8982605934143066  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8982658386230469  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8982658386230469  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8982868194580078  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8986015319824219  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8986258506774902  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8986258506774902  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.898648738861084  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8991522789001465  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([21, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8992218971252441  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8992218971252441  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.8992619514465332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.900423526763916  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([21, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9005045890808105  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9005045890808105  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9005446434020996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9019865989685059  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([22, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9020938873291016  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9020938873291016  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9021358489990234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.903940200805664  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([31, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.904128074645996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.904128074645996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9041872024536133  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9071435928344727  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([20, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9072680473327637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9072680473327637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.90730619430542  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9094805717468262  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([21, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9096431732177734  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9096431732177734  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9096832275390625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9122467041015625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9124479293823242  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9124479293823242  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.912491798400879  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9156064987182617  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.915785789489746  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.915785789489746  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9158220291137695  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9186487197875977  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9188499450683594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9188499450683594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9188861846923828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.921966552734375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9221611022949219  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9221611022949219  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9221935272216797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9251766204833984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9254026412963867  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9254026412963867  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9254369735717773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9288358688354492  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9290928840637207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9290928840637207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9291291236877441  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9329705238342285  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9331679344177246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9331679344177246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.933194637298584  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9362120628356934  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.936525821685791  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.936525821685791  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9365639686584473  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9411416053771973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9413824081420898  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9413824081420898  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.941411018371582  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9450445175170898  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9454140663146973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9454140663146973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9454541206359863  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9508213996887207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.951070785522461  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.951070785522461  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9510974884033203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9548625946044922  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9550714492797852  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9550714492797852  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.955092430114746  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9581975936889648  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9585680961608887  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9585680961608887  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9586024284362793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9639239311218262  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9643712043762207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9643712043762207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 7.3670654296875 GB
    Memory Allocated: 1.9644112586975098  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3748779296875 GB
    Memory Allocated: 1.970900058746338  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3748779296875 GB
    Memory Allocated: 1.9713187217712402  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3748779296875 GB
    Memory Allocated: 1.9713187217712402  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 7.3748779296875 GB
    Memory Allocated: 1.9713549613952637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3807373046875 GB
    Memory Allocated: 1.9774794578552246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([2537, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3826904296875 GB
    Memory Allocated: 2.038421154022217  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3826904296875 GB
    Memory Allocated: 2.038421154022217  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2537, 256]), torch.Size([1, 2537, 256])
----------------------------------------3
 Nvidia-smi: 7.3826904296875 GB
    Memory Allocated: 2.043260097503662  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3826904296875 GB
    Memory Allocated: 2.9047393798828125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2537, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3826904296875 GB
    Memory Allocated: 2.839745044708252  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3826904296875 GB
    Memory Allocated: 2.8402671813964844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3826904296875 GB
    Memory Allocated: 2.840789318084717  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3826904296875 GB
    Memory Allocated: 2.840244770050049  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([2981, 47])
input nodes number: 30715
output nodes number: 2981
edges number: 68891
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3826904296875 GB
    Memory Allocated: 2.840494155883789  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3826904296875 GB
    Memory Allocated: 2.8404946327209473  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.055769920349121094  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 23 input nodes size: 109921
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.04823780059814453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.04823780059814453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.0891866683959961  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.08920907974243164  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.046581268310546875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.04926872253417969  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.04926872253417969  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 109921
first layer output nodes number: 29697
edges number: 290120
----------------------------------------before model layer 0
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05030965805053711  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([109921, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05030965805053711  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([54, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16237354278564453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16237354278564453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 54, 100]), torch.Size([1, 54, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16241455078125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16273832321166992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 54, 100])
m.shape torch.Size([84, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16278076171875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16278076171875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 84, 100]), torch.Size([1, 84, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1628437042236328  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16378498077392578  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 84, 100])
m.shape torch.Size([121, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16388893127441406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16388893127441406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 121, 100]), torch.Size([1, 121, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16397953033447266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1659684181213379  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 121, 100])
m.shape torch.Size([171, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16617822647094727  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16617822647094727  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 171, 100]), torch.Size([1, 171, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1663060188293457  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17000627517700195  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 171, 100])
m.shape torch.Size([204, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17032241821289062  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17032241821289062  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 204, 100]), torch.Size([1, 204, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17047500610351562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17595386505126953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 204, 100])
m.shape torch.Size([272, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17648553848266602  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17648553848266602  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 272, 100]), torch.Size([1, 272, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17668867111206055  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18540620803833008  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 272, 100])
m.shape torch.Size([265, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18599605560302734  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18599605560302734  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 265, 100]), torch.Size([1, 265, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18619441986083984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.19608259201049805  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 265, 100])
m.shape torch.Size([301, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.19688081741333008  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.19688081741333008  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 301, 100]), torch.Size([1, 301, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.19710588455200195  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2099003791809082  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 301, 100])
m.shape torch.Size([314, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.21084070205688477  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.21084070205688477  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 314, 100]), torch.Size([1, 314, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2110753059387207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.22606420516967773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 314, 100])
m.shape torch.Size([27911, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.3299236297607422  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.3299236297607422  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 27911, 100]), torch.Size([1, 27911, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.3507194519042969  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.842855453491211  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 27911, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7348685264587402  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7641654014587402  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7924866676330566  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7631897926330566  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([29697, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7924866676330566  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7985916137695312  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7985916137695312  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8665242195129395  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8665242195129395  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8665375709533691  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8666443824768066  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([12, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8666610717773438  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8666610717773438  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8666839599609375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8670272827148438  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8670392036437988  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8670392036437988  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8670544624328613  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8673901557922363  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([19, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8674559593200684  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8674559593200684  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8674921989440918  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8685431480407715  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([11, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8685779571533203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8685779571533203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8685989379882812  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.869354248046875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([20, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8694591522216797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8694591522216797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.869497299194336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8711376190185547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.871206283569336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.871206283569336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8712310791015625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8724708557128906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([18, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8725972175598145  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8725972175598145  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.872631549835205  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8745884895324707  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([15, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8747014999389648  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8747014999389648  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.874730110168457  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.876561164855957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.876652717590332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.876652717590332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.876673698425293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8781633377075195  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([16, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8783221244812012  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8783221244812012  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8783526420593262  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8807330131530762  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8808679580688477  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8808679580688477  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8808927536010742  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.883000373840332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8831629753112793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8831629753112793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8831896781921387  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8856463432312012  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([7, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8857274055480957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8857274055480957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8857407569885254  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8870625495910645  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([19, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8873300552368164  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8873300552368164  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8873662948608398  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8912076950073242  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([15, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8914203643798828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8914203643798828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.891448974609375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8946819305419922  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8949456214904785  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8949456214904785  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8949780464172363  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8988690376281738  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.899095058441162  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.899095058441162  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8991217613220215  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.902513027191162  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9026641845703125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9026641845703125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9026813507080078  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9049816131591797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9052038192749023  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9052038192749023  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.905226707458496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9084539413452148  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9086647033691406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9086647033691406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9086856842041016  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9117908477783203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.912034511566162  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.912034511566162  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9120573997497559  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.915605068206787  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9159035682678223  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9159035682678223  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9159302711486816  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9202561378479004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.92061185836792  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.92061185836792  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.920642375946045  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.92579984664917  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([2658, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9896516799926758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9896516799926758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2658, 256]), torch.Size([1, 2658, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9947214126586914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.891160011291504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2658, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.824124336242676  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.824646472930908  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.8251686096191406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.8246240615844727  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([2981, 47])
input nodes number: 29697
output nodes number: 2981
edges number: 70526
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.8248682022094727  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.824868679046631  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05490922927856445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 24 input nodes size: 105912
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.046581268310546875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.046581268310546875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.08603668212890625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.0860590934753418  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.04508781433105469  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.047786712646484375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.047786712646484375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 105912
first layer output nodes number: 29762
edges number: 289054
----------------------------------------before model layer 0
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.0487980842590332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([105912, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.0487980842590332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([50, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16049432754516602  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16049432754516602  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 50, 100]), torch.Size([1, 50, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16053247451782227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16083335876464844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 50, 100])
m.shape torch.Size([115, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16090011596679688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16090011596679688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 115, 100]), torch.Size([1, 115, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16098594665527344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16227340698242188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 115, 100])
m.shape torch.Size([172, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16242313385009766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16242313385009766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 172, 100]), torch.Size([1, 172, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1625518798828125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1653757095336914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 172, 100])
m.shape torch.Size([216, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1656332015991211  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1656332015991211  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 216, 100]), torch.Size([1, 216, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16579437255859375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17046260833740234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 216, 100])
m.shape torch.Size([277, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1708984375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1708984375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 277, 100]), torch.Size([1, 277, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17110538482666016  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1785411834716797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 277, 100])
m.shape torch.Size([303, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17911529541015625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17911529541015625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 303, 100]), torch.Size([1, 303, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17934131622314453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18905162811279297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 303, 100])
m.shape torch.Size([330, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18979930877685547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18979930877685547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 330, 100]), torch.Size([1, 330, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.19004535675048828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2023477554321289  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 330, 100])
m.shape torch.Size([381, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.20336055755615234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.20336055755615234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 381, 100]), torch.Size([1, 381, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2036447525024414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2198324203491211  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 381, 100])
m.shape torch.Size([347, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2208538055419922  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2208538055419922  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 347, 100]), torch.Size([1, 347, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2211132049560547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.23767614364624023  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 347, 100])
m.shape torch.Size([27571, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.3402566909790039  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.3402566909790039  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 27571, 100]), torch.Size([1, 27571, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.36079883575439453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.819291114807129  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 27571, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7130579948425293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7423548698425293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.770738124847412  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.741441249847412  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([29762, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.770738124847412  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7769203186035156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7769203186035156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.847261905670166  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.847261905670166  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8472676277160645  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.847353458404541  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8473625183105469  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8473625183105469  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8473701477050781  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8475379943847656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8475422859191895  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8475422859191895  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.847546100616455  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8476567268371582  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8476886749267578  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8476886749267578  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8477020263671875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8481826782226562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8482050895690918  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8482050895690918  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8482146263122559  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8486247062683105  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8486604690551758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8486604690551758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8486719131469727  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8492441177368164  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8493080139160156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8493080139160156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.849325180053711  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8503036499023438  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.850329875946045  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.850329875946045  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8503375053405762  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8508257865905762  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8509087562561035  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8509087562561035  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8509259223937988  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.852144718170166  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.852210521697998  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.852210521697998  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8522238731384277  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8532652854919434  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8532934188842773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8532934188842773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8532991409301758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.853785514831543  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([11, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8539204597473145  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8539204597473145  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8539414405822754  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8558716773986816  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.856022834777832  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.856022834777832  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8560457229614258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.858311653137207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([7, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8584012985229492  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8584012985229492  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.858414649963379  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8598299026489258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8599309921264648  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8599309921264648  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8599443435668945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8614530563354492  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8616914749145508  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8616914749145508  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.861720085144043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8651533126831055  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.865312099456787  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.865312099456787  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8653311729431152  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.867753505706787  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8679084777832031  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8679084777832031  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8679256439208984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8702259063720703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8703904151916504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8703904151916504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8704075813293457  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8728280067443848  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8731021881103516  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8731021881103516  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.873128890991211  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8770809173583984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.877131462097168  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.877131462097168  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8771371841430664  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8780241012573242  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8782868385314941  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8782868385314941  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.878309726715088  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8820176124572754  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8822832107543945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8822832107543945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8823060989379883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.886174201965332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([2814, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9537782669067383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9537782669067383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2814, 256]), torch.Size([1, 2814, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9591455459594727  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.9106016159057617  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2814, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.840867042541504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.8413915634155273  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.841916084289551  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.841369152069092  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([2994, 47])
input nodes number: 29762
output nodes number: 2994
edges number: 73032
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.841616153717041  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.841616630554199  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05347013473510742  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 25 input nodes size: 109663
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.0450901985168457  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.0450901985168457  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.08594322204589844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.0859670639038086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.04648923873901367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.04917573928833008  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.04917573928833008  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 109663
first layer output nodes number: 29779
edges number: 285031
----------------------------------------before model layer 0
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05021524429321289  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([109663, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05021524429321289  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([126, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1595010757446289  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1595010757446289  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 126, 100]), torch.Size([1, 126, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.15959548950195312  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16034793853759766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 126, 100])
m.shape torch.Size([207, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16045522689819336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16045522689819336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 207, 100]), torch.Size([1, 207, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16060972213745117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16292428970336914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 207, 100])
m.shape torch.Size([257, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16313457489013672  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16313457489013672  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 257, 100]), torch.Size([1, 257, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16332626342773438  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1675434112548828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 257, 100])
m.shape torch.Size([337, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16795015335083008  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16795015335083008  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 337, 100]), torch.Size([1, 337, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16820192337036133  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1754918098449707  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 337, 100])
m.shape torch.Size([364, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17604398727416992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17604398727416992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 364, 100]), torch.Size([1, 364, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1763157844543457  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18608617782592773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 364, 100])
m.shape torch.Size([421, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1868915557861328  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1868915557861328  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 421, 100]), torch.Size([1, 421, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18720531463623047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2006969451904297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 421, 100])
m.shape torch.Size([430, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2016615867614746  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2016615867614746  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 430, 100]), torch.Size([1, 430, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2019820213317871  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2180037498474121  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 430, 100])
m.shape torch.Size([469, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.21924161911010742  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.21924161911010742  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 469, 100]), torch.Size([1, 469, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.21959161758422852  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2395186424255371  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 469, 100])
m.shape torch.Size([416, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2407383918762207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2407383918762207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 416, 100]), torch.Size([1, 416, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.24104833602905273  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.26088476181030273  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 416, 100])
m.shape torch.Size([26752, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.36038875579833984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.36038875579833984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 26752, 100]), torch.Size([1, 26752, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.38032054901123047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7954778671264648  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 26752, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.691110610961914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.720357894897461  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7487573623657227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7195100784301758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([29779, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7487573623657227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7559070587158203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7559070587158203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8288874626159668  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8288874626159668  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.828895092010498  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.828956127166748  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8289623260498047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8289623260498047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8289718627929688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8291149139404297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8291277885437012  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8291277885437012  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.829139232635498  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8293910026550293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8294200897216797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8294200897216797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.829437255859375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.829935073852539  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([14, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8299942016601562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8299942016601562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8300209045410156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8309822082519531  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8310327529907227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8310327529907227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8310537338256836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.831955909729004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8320598602294922  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8320598602294922  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.83209228515625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8337135314941406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8337745666503906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8337745666503906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8337936401367188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8348808288574219  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8349666595458984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8349666595458984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8349876403808594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8363304138183594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8364644050598145  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8364644050598145  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8364930152893066  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.838524341583252  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([7, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8385844230651855  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8385844230651855  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8385977745056152  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8396391868591309  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([16, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8398170471191406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8398170471191406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8398475646972656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8424415588378906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([21, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.842689037322998  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.842689037322998  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.842729091644287  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8464140892028809  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([21, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8466768264770508  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8466768264770508  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8467168807983398  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.850682258605957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8509221076965332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8509221076965332  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8509564399719238  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.85459566116333  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8549323081970215  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8549323081970215  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8549761772155762  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8599333763122559  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.860222339630127  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.860222339630127  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8602585792541504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.864607334136963  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8647971153259277  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8647971153259277  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8648200035095215  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8677268028259277  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8679895401000977  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8679895401000977  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8680181503295898  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.871851921081543  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([12, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8720684051513672  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8720684051513672  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.872091293334961  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8753185272216797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8756704330444336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8756704330444336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8757047653198242  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8807859420776367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8809804916381836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8809804916381836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8809995651245117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.883955955505371  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8843002319335938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8843002319335938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8843307495117188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8892745971679688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([16, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8896284103393555  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8896284103393555  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8896589279174805  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8948163986206055  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([2837, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9629693031311035  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9629693031311035  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2837, 256]), torch.Size([1, 2837, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.969193935394287  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.9430384635925293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2837, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.8706846237182617  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.8712387084960938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.871792793273926  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.8712148666381836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([3163, 47])
input nodes number: 29779
output nodes number: 3163
edges number: 75465
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.871490478515625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.871490955352783  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05401182174682617  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 26 input nodes size: 127651
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.046518802642822266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.046518802642822266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.09407281875610352  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.09409523010253906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05321836471557617  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05610227584838867  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05610227584838867  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 127651
first layer output nodes number: 32437
edges number: 314580
----------------------------------------before model layer 0
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05729532241821289  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([127651, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05729532241821289  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([88, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1783280372619629  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1783280372619629  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 88, 100]), torch.Size([1, 88, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17839384078979492  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17891883850097656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 88, 100])
m.shape torch.Size([143, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17899274826049805  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17899274826049805  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 143, 100]), torch.Size([1, 143, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17909955978393555  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18069887161254883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 143, 100])
m.shape torch.Size([221, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1808924674987793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1808924674987793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 221, 100]), torch.Size([1, 221, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18105745315551758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18468284606933594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 221, 100])
m.shape torch.Size([242, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18496131896972656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18496131896972656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 242, 100]), torch.Size([1, 242, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18514251708984375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.19038009643554688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 242, 100])
m.shape torch.Size([286, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.19082260131835938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.19082260131835938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 286, 100]), torch.Size([1, 286, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.19103622436523438  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.19871234893798828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 286, 100])
m.shape torch.Size([319, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.19931888580322266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.19931888580322266  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 319, 100]), torch.Size([1, 319, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.19955730438232422  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.20978355407714844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 319, 100])
m.shape torch.Size([355, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.21059036254882812  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.21059036254882812  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 355, 100]), torch.Size([1, 355, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.21085548400878906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2240915298461914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 355, 100])
m.shape torch.Size([364, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.22504377365112305  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.22504377365112305  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 364, 100]), torch.Size([1, 364, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.22531557083129883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2407851219177246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 364, 100])
m.shape torch.Size([356, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.24184322357177734  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.24184322357177734  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 356, 100]), torch.Size([1, 356, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2421092987060547  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.25909948348999023  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 356, 100])
m.shape torch.Size([30063, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.3709602355957031  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.3709602355957031  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 30063, 100]), torch.Size([1, 30063, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.3943977355957031  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9961328506469727  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 30063, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8781757354736328  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9091100692749023  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9400444030761719  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9091100692749023  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([32437, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9400444030761719  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.947981357574463  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.947981357574463  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0177578926086426  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0177578926086426  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0177693367004395  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0178608894348145  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0178613662719727  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0178613662719727  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.017867088317871  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0179529190063477  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0179591178894043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0179591178894043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0179648399353027  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0180907249450684  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.018111228942871  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.018111228942871  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.018122673034668  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0184545516967773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.018463611602783  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.018463611602783  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0184693336486816  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0186753273010254  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.018707275390625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.018707275390625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.018718719482422  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0192108154296875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([13, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0192928314208984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0192928314208984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.019317626953125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.020557403564453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([8, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.020606517791748  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.020606517791748  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0206217765808105  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.021491527557373  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.021535873413086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.021535873413086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.021547317504883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.022279739379883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.022322177886963  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.022322177886963  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.022331714630127  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0230088233947754  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.023099422454834  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.023099422454834  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0231165885925293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0244555473327637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.024562358856201  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.024562358856201  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0245814323425293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.02620267868042  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.026305675506592  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.026305675506592  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.026322841644287  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.027902126312256  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.028001308441162  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.028001308441162  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0280165672302246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.029527187347412  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0296497344970703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0296497344970703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0296669006347656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0314865112304688  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([14, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.031693458557129  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.031693458557129  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0317201614379883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0347375869750977  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([10, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0348877906799316  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0348877906799316  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0349068641662598  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0371956825256348  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([5, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0372729301452637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0372729301452637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0372824668884277  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0384936332702637  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0386171340942383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0386171340942383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.038630485534668  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.040419578552246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0406055450439453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0406055450439453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0406246185302734  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.043313980102539  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0434460639953613  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0434460639953613  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.043459415435791  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0454354286193848  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.045640468597412  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.045640468597412  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0456595420837402  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0486159324645996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0488057136535645  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0488057136535645  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0488228797912598  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0516037940979004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.051849365234375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.051849365234375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.051870346069336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0554161071777344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([2794, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.1225404739379883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.1225404739379883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2794, 256]), torch.Size([1, 2794, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.1283836364746094  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 3.0683250427246094  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2794, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.999329090118408  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.9998512268066406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 3.000373363494873  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.999828815460205  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([2981, 47])
input nodes number: 32437
output nodes number: 2981
edges number: 72443
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 3.00006103515625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 3.000061511993408  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.06169700622558594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 27 input nodes size: 134025
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05318641662597656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05318641662597656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.10311508178710938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.10313749313354492  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.055561065673828125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.058899879455566406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.058899879455566406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 134025
first layer output nodes number: 33077
edges number: 320394
----------------------------------------before model layer 0
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.06014537811279297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([134025, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.06014537811279297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([97, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18291854858398438  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18291854858398438  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 97, 100]), torch.Size([1, 97, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18299102783203125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18357086181640625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 97, 100])
m.shape torch.Size([166, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18365859985351562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18365859985351562  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 166, 100]), torch.Size([1, 166, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18378257751464844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1856393814086914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 166, 100])
m.shape torch.Size([191, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.185791015625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.185791015625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 191, 100]), torch.Size([1, 191, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18593406677246094  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18906831741333008  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 191, 100])
m.shape torch.Size([269, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18939781188964844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18939781188964844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 269, 100]), torch.Size([1, 269, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18959903717041016  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1954174041748047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 269, 100])
m.shape torch.Size([312, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.19589805603027344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.19589805603027344  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 312, 100]), torch.Size([1, 312, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.19613075256347656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.20450067520141602  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 312, 100])
m.shape torch.Size([346, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.20515775680541992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.20515775680541992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 346, 100]), torch.Size([1, 346, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.20541620254516602  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.21651220321655273  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 346, 100])
m.shape torch.Size([378, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.21736907958984375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.21736907958984375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 378, 100]), torch.Size([1, 378, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2176513671875  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.23174571990966797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 378, 100])
m.shape torch.Size([398, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.23279094696044922  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.23279094696044922  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 398, 100]), torch.Size([1, 398, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.23308753967285156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.24999332427978516  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 398, 100])
m.shape torch.Size([350, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2510185241699219  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2510185241699219  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 350, 100]), torch.Size([1, 350, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2512798309326172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2679777145385742  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 350, 100])
m.shape torch.Size([30570, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.3817296028137207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.3817296028137207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 30570, 100]), torch.Size([1, 30570, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.4051671028137207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.029575824737549  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 30570, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9098682403564453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9414129257202148  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9729576110839844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9414129257202148  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([33077, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9729576110839844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9808440208435059  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9808440208435059  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.049647808074951  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.049647808074951  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0496535301208496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.049699306488037  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0497140884399414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0497140884399414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0497312545776367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0499887466430664  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0500035285949707  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0500035285949707  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.050018787384033  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.050354480743408  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0503740310668945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0503740310668945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.050387382507324  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.050774574279785  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0508017539978027  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0508017539978027  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0508151054382324  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.051295757293701  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([13, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0513644218444824  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0513644218444824  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.051389217376709  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.052455425262451  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.052544116973877  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.052544116973877  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.052572727203369  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0540032386779785  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([12, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.054081439971924  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.054081439971924  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0541043281555176  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0554089546203613  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0554842948913574  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0554842948913574  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0555033683776855  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0567240715026855  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([16, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.056868553161621  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.056868553161621  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.056899070739746  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.059065818786621  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([12, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.059177875518799  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.059177875518799  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0592007637023926  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.060986042022705  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.061136245727539  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.061136245727539  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0611629486083984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0634326934814453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([10, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.063544750213623  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.063544750213623  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.063563823699951  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0653185844421387  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([14, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.065497875213623  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.065497875213623  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0655245780944824  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0681681632995605  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0683135986328125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0683135986328125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0683345794677734  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.070558547973633  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([9, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0706868171691895  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0706868171691895  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0707039833068848  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.072643756866455  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([14, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.072864055633545  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.072864055633545  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0728907585144043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0760951042175293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.076272487640381  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.076272487640381  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.076293468475342  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.078958034515381  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.079166889190674  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.079166889190674  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0791897773742676  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.08225679397583  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0824761390686035  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0824761390686035  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0824990272521973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.085726261138916  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0858359336853027  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0858359336853027  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0858473777770996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.087541103363037  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.087747097015381  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.087747097015381  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.087766170501709  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0907225608825684  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0910449028015137  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0910449028015137  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.091073513031006  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0957083702087402  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([8, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0958786010742188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0958786010742188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0958938598632812  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0984725952148438  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([2723, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.163893699645996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.163893699645996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2723, 256]), torch.Size([1, 2723, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.169191837310791  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 3.0881261825561523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2723, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 3.0199151039123535  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 3.020437240600586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 3.0209593772888184  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 3.0204148292541504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([2981, 47])
input nodes number: 33077
output nodes number: 2981
edges number: 71434
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 3.020683765411377  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 3.020684242248535  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.06412696838378906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 28 input nodes size: 117345
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.055561065673828125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.055561065673828125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.09927558898925781  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.09929943084716797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.04934835433959961  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05228567123413086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05228567123413086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 117345
first layer output nodes number: 32745
edges number: 317319
----------------------------------------before model layer 0
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05340433120727539  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([117345, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05340433120727539  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([90, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17499828338623047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17499828338623047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 90, 100]), torch.Size([1, 90, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1750659942626953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17560482025146484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 90, 100])
m.shape torch.Size([141, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1756763458251953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1756763458251953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 141, 100]), torch.Size([1, 141, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1757822036743164  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17736148834228516  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 141, 100])
m.shape torch.Size([215, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17754888534545898  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17754888534545898  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 215, 100]), torch.Size([1, 215, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17770910263061523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18123388290405273  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 215, 100])
m.shape torch.Size([259, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18154001235961914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18154001235961914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 259, 100]), torch.Size([1, 259, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1817336082458496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18733644485473633  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 259, 100])
m.shape torch.Size([330, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18785476684570312  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18785476684570312  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 330, 100]), torch.Size([1, 330, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18810081481933594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1969585418701172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 330, 100])
m.shape torch.Size([332, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.19757795333862305  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.19757795333862305  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 332, 100]), torch.Size([1, 332, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.19782590866088867  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.20847082138061523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 332, 100])
m.shape torch.Size([376, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.20932769775390625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.20932769775390625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 376, 100]), torch.Size([1, 376, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2096080780029297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2236170768737793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 376, 100])
m.shape torch.Size([335, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.22447538375854492  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.22447538375854492  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 335, 100]), torch.Size([1, 335, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.22472524642944336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.23895597457885742  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 335, 100])
m.shape torch.Size([358, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.24003171920776367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.24003171920776367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 358, 100]), torch.Size([1, 358, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.24029874801635742  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.25737571716308594  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 358, 100])
m.shape torch.Size([30309, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.37015247344970703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.37015247344970703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 30309, 100]), torch.Size([1, 30309, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.39358997344970703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0063257217407227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 30309, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8875479698181152  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.918776035308838  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9500041007995605  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.918776035308838  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([32745, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9500041007995605  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9578113555908203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.9578113555908203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.031686305999756  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.031686305999756  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.031693935394287  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.031754970550537  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0317554473876953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0317554473876953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.031759262084961  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0318164825439453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.031820774078369  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.031820774078369  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0318245887756348  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0319085121154785  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.031914710998535  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.031914710998535  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.031918525695801  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.032029151916504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0320563316345215  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0320563316345215  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0320677757263184  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.032479763031006  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.032503128051758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.032503128051758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.032512664794922  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0329227447509766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0329785346984863  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0329785346984863  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0329957008361816  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0338540077209473  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0338993072509766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0338993072509766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0339126586914062  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0346736907958984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([15, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.034797191619873  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.034797191619873  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0348258018493652  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0366568565368652  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([9, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.036729335784912  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.036729335784912  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0367465019226074  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0379652976989746  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0380311012268066  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0380311012268066  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0380444526672363  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.039085865020752  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([11, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0392065048217773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0392065048217773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0392274856567383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.041010856628418  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([16, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.041200637817383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.041200637817383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.041231155395508  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.044038772583008  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([10, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.044158458709717  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.044158458709717  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.044177532196045  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0460658073425293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0462441444396973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0462441444396973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.046268939971924  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0488972663879395  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.049100399017334  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.049100399017334  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0491271018981934  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0521445274353027  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([11, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0523109436035156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0523109436035156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0523319244384766  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.054849624633789  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0550122261047363  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0550122261047363  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0550312995910645  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0574536323547363  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0577731132507324  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0577731132507324  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.057807445526123  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.062407970428467  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0626983642578125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0626983642578125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0627288818359375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0670318603515625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([5, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.067117691040039  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.067117691040039  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.067127227783203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0685386657714844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0687880516052246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0687880516052246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0688109397888184  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0723586082458496  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0727453231811523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0727453231811523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.072779655456543  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.078341484069824  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.078578472137451  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.078578472137451  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.078599452972412  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.0821452140808105  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([2929, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.1525135040283203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.1525135040283203  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2929, 256]), torch.Size([1, 2929, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.158100128173828  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 3.158463478088379  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2929, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 3.085446834564209  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 3.086000919342041  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 3.086555004119873  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 3.085977077484131  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([3162, 47])
input nodes number: 32745
output nodes number: 3162
edges number: 76703
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 3.0862770080566406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 3.086277484893799  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.057469844818115234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 29 input nodes size: 100328
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.04938030242919922  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.04938030242919922  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.08675575256347656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.08677911758422852  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.04304075241088867  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.04560232162475586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.04560232162475586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 100328
first layer output nodes number: 28041
edges number: 269372
----------------------------------------before model layer 0
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.04655933380126953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([100328, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.04655933380126953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([103, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.15047788619995117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.15047788619995117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 103, 100]), torch.Size([1, 103, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.15055513381958008  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1511702537536621  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 103, 100])
m.shape torch.Size([165, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.15125465393066406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.15125465393066406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 165, 100]), torch.Size([1, 165, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.15137767791748047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.15322303771972656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 165, 100])
m.shape torch.Size([240, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.15342998504638672  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.15342998504638672  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 240, 100]), torch.Size([1, 240, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1536092758178711  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1575450897216797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 240, 100])
m.shape torch.Size([296, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1578965187072754  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1578965187072754  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 296, 100]), torch.Size([1, 296, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.15811777114868164  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16451692581176758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 296, 100])
m.shape torch.Size([337, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16503429412841797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16503429412841797  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 337, 100]), torch.Size([1, 337, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.16528606414794922  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17433547973632812  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 337, 100])
m.shape torch.Size([351, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17499446868896484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17499446868896484  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 351, 100]), torch.Size([1, 351, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.17525672912597656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1865081787109375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 351, 100])
m.shape torch.Size([362, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18732118606567383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.18732118606567383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 362, 100]), torch.Size([1, 362, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.1875910758972168  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.20108556747436523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 362, 100])
m.shape torch.Size([386, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2021012306213379  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2021012306213379  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 386, 100]), torch.Size([1, 386, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.20238924026489258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.2187943458557129  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 386, 100])
m.shape torch.Size([388, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.21995162963867188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.21995162963867188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 388, 100]), torch.Size([1, 388, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.22024154663085938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.23875761032104492  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 388, 100])
m.shape torch.Size([25413, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.3332839012145996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.3332839012145996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 25413, 100]), torch.Size([1, 25413, 100])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.3522181510925293  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.696549892425537  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 25413, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.5966477394104004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.623389720916748  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.6501317024230957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.623389720916748  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([28041, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.6501317024230957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.6568174362182617  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.6568174362182617  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7283782958984375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7283782958984375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7283821105957031  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7284126281738281  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7284226417541504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7284226417541504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7284340858459473  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7286057472229004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7286291122436523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7286291122436523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7286481857299805  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7290678024291992  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([16, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7291197776794434  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7291197776794434  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7291502952575684  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7300353050231934  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7300634384155273  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7300634384155273  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7300806045532227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.730698585510254  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7307476997375488  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7307476997375488  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.730766773223877  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7315869331359863  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.731597900390625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.731597900390625  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7316036224365234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7318897247314453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([9, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7319564819335938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7319564819335938  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.731973648071289  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7329521179199219  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([13, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7330560684204102  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7330560684204102  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7330808639526367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7346677780151367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7347807884216309  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7347807884216309  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7348055839538574  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7365660667419434  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([9, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7366490364074707  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7366490364074707  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.736666202545166  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7380051612854004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([4, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7380428314208984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7380428314208984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7380504608154297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.738698959350586  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([15, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7388830184936523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7388830184936523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7389116287231445  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7415437698364258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7417044639587402  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7417044639587402  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7417292594909668  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7441840171813965  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([9, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7443017959594727  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7443017959594727  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.744318962097168  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.746138572692871  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7462992668151855  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7462992668151855  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7463202476501465  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7486910820007324  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7489256858825684  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7489256858825684  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7489542961120605  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.752387523651123  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7525463104248047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7525463104248047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7525653839111328  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7549877166748047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7552156448364258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7552156448364258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7552404403686523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7585630416870117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7588391304016113  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7588391304016113  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7588677406311035  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.762901782989502  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7632107734680176  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7632107734680176  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7632412910461426  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7677578926086426  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7680602073669434  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7680602073669434  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7680888175964355  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7725234031677246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.772796630859375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.772796630859375  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7728214263916016  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7768383026123047  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7770800590515137  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7770800590515137  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.7771010398864746  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.780646800994873  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([2828, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.848587989807129  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.848587989807129  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2828, 256]), torch.Size([1, 2828, 256])
----------------------------------------3
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 1.8539819717407227  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.827672004699707  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 2828, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.7563371658325195  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.756877899169922  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.757418632507324  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.75685453414917  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([3088, 47])
input nodes number: 28041
output nodes number: 3088
edges number: 74299
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.7570738792419434  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 2.7570743560791016  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.05079460144042969  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

pseudo mini batch 30 input nodes size: 150431
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.043027400970458984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.043027400970458984  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.09906768798828125  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.0990915298461914  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.06169271469116211  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.0650477409362793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.0650477409362793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

first layer input nodes number: 150431
first layer output nodes number: 38855
edges number: 374573
----------------------------------------before model layer 0
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.06645870208740234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([150431, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.3865966796875 GB
    Memory Allocated: 0.06645870208740234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([162, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.21001577377319336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.21001577377319336  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 162, 100]), torch.Size([1, 162, 100])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.21013689041137695  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.2111043930053711  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 162, 100])
m.shape torch.Size([209, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.21119976043701172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.21119976043701172  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 209, 100]), torch.Size([1, 209, 100])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.21135616302490234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.21369647979736328  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 209, 100])
m.shape torch.Size([292, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.2139449119567871  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.2139449119567871  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 292, 100]), torch.Size([1, 292, 100])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.21416330337524414  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.21895503997802734  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 292, 100])
m.shape torch.Size([358, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.21937942504882812  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.21937942504882812  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 358, 100]), torch.Size([1, 358, 100])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.21964645385742188  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.2273845672607422  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 358, 100])
m.shape torch.Size([419, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.22803163528442383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.22803163528442383  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 419, 100]), torch.Size([1, 419, 100])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.22834444046020508  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.23959112167358398  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 419, 100])
m.shape torch.Size([451, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.24052000045776367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.24052000045776367  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 451, 100]), torch.Size([1, 451, 100])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.24085664749145508  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.25531530380249023  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 451, 100])
m.shape torch.Size([440, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.25629472732543945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.25629472732543945  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 440, 100]), torch.Size([1, 440, 100])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.2566227912902832  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.27301597595214844  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 440, 100])
m.shape torch.Size([471, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.27425575256347656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.27425575256347656  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 471, 100]), torch.Size([1, 471, 100])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.27460670471191406  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.29461097717285156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 471, 100])
m.shape torch.Size([494, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.29689884185791016  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.29689884185791016  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 494, 100]), torch.Size([1, 494, 100])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.29726696014404297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.32082653045654297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 494, 100])
m.shape torch.Size([35559, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.4531102180480957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.4531102180480957  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 35559, 100]), torch.Size([1, 35559, 100])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.47960424423217773  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3606514930725098  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 35559, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.221607208251953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.258716583251953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.295825958251953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.258716583251953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

torch.Size([38855, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.295825958251953  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3050899505615234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3050899505615234  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3778605461120605  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3778605461120605  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.377866268157959  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3779120445251465  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3779211044311523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3779211044311523  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.377932548522949  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3781042098999023  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3781161308288574  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3781161308288574  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3781275749206543  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3783793449401855  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3784046173095703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3784046173095703  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.378419876098633  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3788623809814453  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3788743019104004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3788743019104004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3788819313049316  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3791565895080566  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([18, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3792567253112793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3792567253112793  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.37929105758667  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.380767345428467  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3808579444885254  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3808579444885254  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3808884620666504  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3824143409729004  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.382506847381592  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.382506847381592  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.382533550262451  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3840556144714355  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([12, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.384146213531494  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.384146213531494  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.384169101715088  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.385633945465088  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([16, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3857765197753906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3857765197753906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3858070373535156  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3879737854003906  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([23, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3882017135620117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3882017135620117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3882455825805664  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.391667366027832  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([8, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.391737937927246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.391737937927246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3917531967163086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.393050193786621  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([24, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3933424949645996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3933424949645996  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.393388271331787  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.397599697113037  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([15, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3977789878845215  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3977789878845215  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.3978075981140137  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4006400108337402  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([10, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4007701873779297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4007701873779297  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.400789260864258  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.402811050415039  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([16, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.403047561645508  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.403047561645508  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.403078079223633  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.406526565551758  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([18, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4068055152893066  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4068055152893066  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4068398475646973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4109597206115723  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4112367630004883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4112367630004883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.411269187927246  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4153871536254883  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4155354499816895  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4155354499816895  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4155526161193848  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4178528785705566  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4179983139038086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4179983139038086  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.418013572692871  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4201650619506836  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4204602241516113  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4204602241516113  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4204888343811035  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4247231483459473  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4249415397644043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4249415397644043  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4249625205993652  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4282145500183105  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4286904335021973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4286904335021973  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.428732395172119  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.435530185699463  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.435786247253418  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.435786247253418  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4358091354370117  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.4396772384643555  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([2852, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.5081944465637207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.5081944465637207  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

 h.shape torch.Size([1, 2852, 256]), torch.Size([1, 2852, 256])
----------------------------------------3
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 2.513892650604248  GigaBytes
Max Memory Allocated: 3.52909517288208  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 3.525350570678711  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 2852, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 3.4532065391540527  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 3.4537606239318848  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 3.454314708709717  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 3.4537367820739746  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

torch.Size([3163, 47])
input nodes number: 38855
output nodes number: 3163
edges number: 75556
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 3.454063892364502  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 3.45406436920166  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.07100629806518555  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

pseudo mini batch 31 input nodes size: 148151
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.0617060661315918  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.0617060661315918  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.1168966293334961  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.11691999435424805  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.060855865478515625  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.06424331665039062  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.06424331665039062  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

first layer input nodes number: 148151
first layer output nodes number: 39249
edges number: 379763
----------------------------------------before model layer 0
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.06563997268676758  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

torch.Size([148151, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.5272216796875 GB
    Memory Allocated: 0.06563997268676758  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

m.shape torch.Size([86, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.21115398406982422  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.21115398406982422  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 86, 100]), torch.Size([1, 86, 100])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.21121883392333984  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.21173334121704102  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 86, 100])
m.shape torch.Size([172, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.21182918548583984  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.21182918548583984  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 172, 100]), torch.Size([1, 172, 100])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.2119579315185547  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.2138833999633789  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 172, 100])
m.shape torch.Size([267, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.21411752700805664  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.21411752700805664  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 267, 100]), torch.Size([1, 267, 100])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.21431684494018555  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.21869754791259766  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 267, 100])
m.shape torch.Size([332, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.21909284591674805  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.21909284591674805  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 332, 100]), torch.Size([1, 332, 100])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.21934080123901367  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.22652006149291992  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 332, 100])
m.shape torch.Size([416, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.2271709442138672  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.2271709442138672  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 416, 100]), torch.Size([1, 416, 100])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.22748088836669922  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.23863887786865234  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 416, 100])
m.shape torch.Size([461, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.23958921432495117  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.23958921432495117  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 461, 100]), torch.Size([1, 461, 100])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.23993349075317383  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.2547116279602051  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 461, 100])
m.shape torch.Size([452, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.2557182312011719  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.2557182312011719  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 452, 100]), torch.Size([1, 452, 100])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.2560558319091797  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.2729058265686035  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 452, 100])
m.shape torch.Size([487, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.2741885185241699  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.2741885185241699  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 487, 100]), torch.Size([1, 487, 100])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.2745518684387207  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.2952399253845215  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 487, 100])
m.shape torch.Size([462, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.29738378524780273  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.29738378524780273  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 462, 100]), torch.Size([1, 462, 100])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.2977280616760254  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.3197617530822754  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 462, 100])
m.shape torch.Size([36114, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.45435523986816406  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.45435523986816406  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 36114, 100]), torch.Size([1, 36114, 100])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.4812631607055664  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4039058685302734  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 36114, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.2628583908081055  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.3008408546447754  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.3382716178894043  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.3002891540527344  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

torch.Size([39249, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.3382716178894043  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.3476295471191406  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.3476295471191406  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.419724464416504  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.419724464416504  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4197282791137695  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4197587966918945  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.419768810272217  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.419768810272217  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4197802543640137  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.419951915740967  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4199695587158203  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4199695587158203  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.419984817504883  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.420320510864258  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4203438758850098  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4203438758850098  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4203591346740723  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4208016395568848  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.420832633972168  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.420832633972168  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4208478927612305  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4213972091674805  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.421447277069092  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.421447277069092  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.42146635055542  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4222865104675293  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.42234468460083  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.42234468460083  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.422363758087158  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4233174324035645  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.423408031463623  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.423408031463623  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4234328269958496  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4248461723327637  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.424929141998291  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.424929141998291  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.424950122833252  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.426292896270752  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4263882637023926  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4263882637023926  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4264092445373535  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.42789888381958  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([18, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.428079128265381  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.428079128265381  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4281134605407715  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4307913780212402  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([14, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.430935859680176  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.430935859680176  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.430962562561035  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.433232307434082  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4333815574645996  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4333815574645996  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.433406352996826  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.43568754196167  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([17, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.435904026031494  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.435904026031494  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.435936450958252  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4391465187072754  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([13, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4393181800842285  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4393181800842285  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.439342975616455  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4419713020324707  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4421281814575195  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4421281814575195  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4421491622924805  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4445199966430664  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([6, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.444607734680176  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.444607734680176  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4446191787719727  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4459924697875977  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([17, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4462809562683105  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4462809562683105  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4463133811950684  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4504313468933105  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4506711959838867  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4506711959838867  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.450697898864746  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4542760848999023  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([6, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.454378128051758  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.454378128051758  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4543895721435547  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.456003189086914  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.456239700317383  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.456239700317383  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4562625885009766  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4596500396728516  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.459913730621338  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.459913730621338  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4599385261535645  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4637818336486816  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4641456604003906  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4641456604003906  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4641780853271484  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.469430923461914  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4697608947753906  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4697608947753906  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.469789505004883  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.4746246337890625  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([2843, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.5429224967956543  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.5429224967956543  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

 h.shape torch.Size([1, 2843, 256]), torch.Size([1, 2843, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 2.549254894256592  GigaBytes
Max Memory Allocated: 3.5933475494384766  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 3.5561747550964355  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 2843, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 3.485250949859619  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 3.4857969284057617  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 3.4863429069519043  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 3.4857735633850098  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

torch.Size([3116, 47])
input nodes number: 39249
output nodes number: 3116
edges number: 74855
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 3.486081600189209  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 3.486082077026367  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.07019805908203125  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

pseudo mini batch 32 input nodes size: 83810
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.06084775924682617  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.06084775924682617  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.09206962585449219  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.09209203720092773  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.036878108978271484  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.03920412063598633  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.03920412063598633  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

first layer input nodes number: 83810
first layer output nodes number: 24966
edges number: 242139
----------------------------------------before model layer 0
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.040015220642089844  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

torch.Size([83810, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.040015220642089844  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

m.shape torch.Size([14, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.1327838897705078  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.1327838897705078  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 14, 100]), torch.Size([1, 14, 100])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.13279438018798828  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.13287830352783203  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 14, 100])
m.shape torch.Size([36, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.13290023803710938  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.13290023803710938  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 36, 100]), torch.Size([1, 36, 100])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.13292789459228516  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.13333415985107422  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 36, 100])
m.shape torch.Size([91, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.1334223747253418  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.1334223747253418  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 91, 100]), torch.Size([1, 91, 100])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.13349103927612305  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.13498878479003906  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 91, 100])
m.shape torch.Size([198, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.13524961471557617  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.13524961471557617  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 198, 100]), torch.Size([1, 198, 100])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.13539743423461914  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.1396784782409668  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 198, 100])
m.shape torch.Size([285, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.1401357650756836  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.1401357650756836  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 285, 100]), torch.Size([1, 285, 100])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.1403484344482422  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.14799737930297852  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 285, 100])
m.shape torch.Size([335, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.14864015579223633  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.14864015579223633  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 335, 100]), torch.Size([1, 335, 100])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.14889001846313477  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.15962553024291992  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 335, 100])
m.shape torch.Size([407, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.16109323501586914  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.16109323501586914  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 407, 100]), torch.Size([1, 407, 100])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.16139650344848633  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.1765599250793457  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 407, 100])
m.shape torch.Size([422, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.17766618728637695  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.17766618728637695  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 422, 100]), torch.Size([1, 422, 100])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.17798089981079102  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.1959080696105957  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 422, 100])
m.shape torch.Size([452, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.1972665786743164  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.1972665786743164  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 452, 100]), torch.Size([1, 452, 100])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.19760417938232422  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.21917200088500977  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 452, 100])
m.shape torch.Size([22726, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.3036642074584961  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.3036642074584961  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 22726, 100]), torch.Size([1, 22726, 100])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 0.32059669494628906  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.523411750793457  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 22726, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.4329423904418945  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.456751823425293  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.4805612564086914  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.456751823425293  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

torch.Size([24966, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.4805612564086914  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.486513614654541  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.486513614654541  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.553907871246338  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.553907871246338  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5539097785949707  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5539250373840332  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5539283752441406  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5539283752441406  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5539321899414062  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5539894104003906  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5539965629577637  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5539965629577637  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.554002285003662  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5541281700134277  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5541563034057617  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5541563034057617  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5541715621948242  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5546140670776367  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([11, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.554659366607666  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.554659366607666  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.554680347442627  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5554356575012207  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5555119514465332  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5555119514465332  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5555405616760254  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5567708015441895  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([18, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.556877613067627  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.556877613067627  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5569119453430176  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5586285591125488  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5587577819824219  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5587577819824219  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5587940216064453  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5608596801757812  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([28, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5610837936401367  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5610837936401367  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5611371994018555  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5645551681518555  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([30, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.564816951751709  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.564816951751709  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5648741722106934  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.568936824798584  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([24, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.569162368774414  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.569162368774414  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5692081451416016  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5727787017822266  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([16, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5729403495788574  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5729403495788574  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5729708671569824  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5755648612976074  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.57578706741333  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.57578706741333  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5758233070373535  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5791573524475098  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([27, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5795025825500488  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5795025825500488  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5795540809631348  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5846524238586426  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([19, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5849008560180664  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5849008560180664  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5849370956420898  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5887784957885742  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5891451835632324  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5891451835632324  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.5891928672790527  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.594581127166748  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.594998836517334  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.594998836517334  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.59505033493042  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6012301445007324  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6016716957092285  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6016716957092285  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6017231941223145  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6082634925842285  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6086578369140625  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6086578369140625  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6087017059326172  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6145801544189453  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6148467063903809  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6148467063903809  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.614875316619873  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6189093589782715  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6192383766174316  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6192383766174316  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6192708015441895  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6240696907043457  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.624582290649414  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.624582290649414  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6246299743652344  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6320209503173828  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6323509216308594  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6323509216308594  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6323814392089844  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6373252868652344  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6377716064453125  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6377716064453125  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 7.6697998046875 GB
    Memory Allocated: 1.6378097534179688  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6756591796875 GB
    Memory Allocated: 1.644256591796875  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([2550, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6756591796875 GB
    Memory Allocated: 1.7055096626281738  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6756591796875 GB
    Memory Allocated: 1.7055096626281738  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 2550, 256]), torch.Size([1, 2550, 256])
----------------------------------------3
 Nvidia-smi: 7.6756591796875 GB
    Memory Allocated: 1.7118682861328125  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6756591796875 GB
    Memory Allocated: 2.6109399795532227  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 2550, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6756591796875 GB
    Memory Allocated: 2.544288158416748  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6756591796875 GB
    Memory Allocated: 2.544811248779297  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6776123046875 GB
    Memory Allocated: 2.5453343391418457  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6776123046875 GB
    Memory Allocated: 2.5447888374328613  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

torch.Size([2985, 47])
input nodes number: 24966
output nodes number: 2985
edges number: 69974
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6776123046875 GB
    Memory Allocated: 2.5449748039245605  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6776123046875 GB
    Memory Allocated: 2.5449752807617188  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.043247222900390625  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

pseudo mini batch 33 input nodes size: 85993
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.036855220794677734  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.036855220794677734  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.06889057159423828  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.06891441345214844  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.037670135498046875  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.04030609130859375  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.04030609130859375  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

first layer input nodes number: 85993
first layer output nodes number: 29094
edges number: 278040
----------------------------------------before model layer 0
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.04116392135620117  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

torch.Size([85993, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.04116392135620117  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

m.shape torch.Size([50, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.1486372947692871  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.1486372947692871  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 50, 100]), torch.Size([1, 50, 100])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.14867544174194336  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.14897632598876953  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 50, 100])
m.shape torch.Size([77, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.14901494979858398  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.14901494979858398  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 77, 100]), torch.Size([1, 77, 100])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.14907312393188477  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.14993715286254883  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 77, 100])
m.shape torch.Size([192, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.15012264251708984  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.15012264251708984  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 192, 100]), torch.Size([1, 192, 100])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.15026569366455078  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.1534128189086914  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 192, 100])
m.shape torch.Size([382, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.15391063690185547  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.15391063690185547  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 382, 100]), torch.Size([1, 382, 100])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.15419578552246094  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.16245365142822266  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 382, 100])
m.shape torch.Size([518, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.16327619552612305  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.16327619552612305  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 518, 100]), torch.Size([1, 518, 100])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.16366243362426758  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.17755985260009766  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 518, 100])
m.shape torch.Size([549, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.17859411239624023  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.17859411239624023  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 549, 100]), torch.Size([1, 549, 100])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.17900323867797852  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.1965956687927246  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 549, 100])
m.shape torch.Size([541, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.19780206680297852  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.19780206680297852  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 541, 100]), torch.Size([1, 541, 100])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.19820547103881836  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.21836566925048828  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 541, 100])
m.shape torch.Size([588, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.21991634368896484  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.21991634368896484  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 588, 100]), torch.Size([1, 588, 100])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.22035503387451172  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.24533748626708984  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 588, 100])
m.shape torch.Size([613, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.24717378616333008  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.24717378616333008  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 613, 100]), torch.Size([1, 613, 100])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.24763059616088867  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.27686643600463867  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 613, 100])
m.shape torch.Size([25584, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.3723411560058594  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.3723411560058594  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 25584, 100]), torch.Size([1, 25584, 100])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 0.3914031982421875  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7447795867919922  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 25584, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.6437187194824219  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.6714649200439453  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.6992111206054688  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.6714649200439453  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

torch.Size([29094, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.6992111206054688  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7061476707458496  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7061476707458496  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7791366577148438  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7791366577148438  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7791461944580078  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7793560028076172  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7793631553649902  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7793631553649902  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7793688774108887  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7795348167419434  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7795562744140625  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7795562744140625  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7795658111572266  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7799091339111328  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.779956340789795  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.779956340789795  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7799735069274902  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7807116508483887  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([6, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7807435989379883  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7807435989379883  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7807550430297852  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.781327247619629  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7813987731933594  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7813987731933594  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7814178466796875  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7825050354003906  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([7, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7825560569763184  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7825560569763184  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.782569408416748  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.783423900604248  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([19, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.783599853515625  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.783599853515625  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7836360931396484  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7862091064453125  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.786402702331543  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.786402702331543  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7864408493041992  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7894163131713867  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7895703315734863  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7895703315734863  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7895989418029785  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7920308113098145  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([19, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7922539710998535  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7922539710998535  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.792290210723877  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7956242561340332  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7957677841186523  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7957677841186523  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.795790672302246  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7980566024780273  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([22, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7983627319335938  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7983627319335938  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.7984046936035156  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8028526306152344  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8031702041625977  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8031702041625977  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8032121658325195  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8079538345336914  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8081779479980469  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8081779479980469  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.808206558227539  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8116397857666016  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8118162155151367  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8118162155151367  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8118371963500977  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8145017623901367  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8147106170654297  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8147106170654297  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8147335052490234  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.817800521850586  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8180394172668457  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8180394172668457  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8180642127990723  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8215603828430176  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([20, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8219518661499023  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8219518661499023  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8219900131225586  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8276357650756836  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8279342651367188  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8279342651367188  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.827962875366211  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8323974609375  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8327593803405762  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8327593803405762  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.832791805267334  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8380446434020996  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.838259220123291  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.838259220123291  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.6795654296875 GB
    Memory Allocated: 1.8382782936096191  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6815185546875 GB
    Memory Allocated: 1.8415017127990723  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([2851, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6834716796875 GB
    Memory Allocated: 1.909996509552002  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6834716796875 GB
    Memory Allocated: 1.909996509552002  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 2851, 256]), torch.Size([1, 2851, 256])
----------------------------------------3
 Nvidia-smi: 7.6834716796875 GB
    Memory Allocated: 1.9154343605041504  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6834716796875 GB
    Memory Allocated: 2.891862392425537  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 2851, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6834716796875 GB
    Memory Allocated: 2.819286346435547  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6834716796875 GB
    Memory Allocated: 2.819836139678955  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6854248046875 GB
    Memory Allocated: 2.8203859329223633  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6854248046875 GB
    Memory Allocated: 2.819812297821045  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

torch.Size([3138, 47])
input nodes number: 29094
output nodes number: 3138
edges number: 75575
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6854248046875 GB
    Memory Allocated: 2.820079803466797  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6854248046875 GB
    Memory Allocated: 2.820080280303955  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.04578971862792969  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

pseudo mini batch 34 input nodes size: 182224
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.03769683837890625  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.03769683837890625  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.10558080673217773  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.10560321807861328  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.07354402542114258  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.07687234878540039  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.07687234878540039  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

first layer input nodes number: 182224
first layer output nodes number: 38359
edges number: 376018
----------------------------------------before model layer 0
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.07873821258544922  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

torch.Size([182224, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.07873821258544922  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

m.shape torch.Size([31, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.22384119033813477  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.22384119033813477  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 31, 100]), torch.Size([1, 31, 100])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.22386503219604492  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.22405147552490234  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 31, 100])
m.shape torch.Size([70, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.2240920066833496  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.2240920066833496  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 70, 100]), torch.Size([1, 70, 100])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.22414445877075195  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.2249283790588379  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 70, 100])
m.shape torch.Size([92, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.2250051498413086  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.2250051498413086  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 92, 100]), torch.Size([1, 92, 100])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.22507381439208984  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.22658443450927734  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 92, 100])
m.shape torch.Size([206, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.22685718536376953  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.22685718536376953  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 206, 100]), torch.Size([1, 206, 100])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.22701072692871094  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.23146343231201172  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 206, 100])
m.shape torch.Size([257, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.23186540603637695  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.23186540603637695  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 257, 100]), torch.Size([1, 257, 100])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.2320570945739746  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.23895788192749023  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 257, 100])
m.shape torch.Size([288, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.23950576782226562  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.23950576782226562  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 288, 100]), torch.Size([1, 288, 100])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.23972034454345703  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.2489471435546875  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 288, 100])
m.shape torch.Size([394, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.24986743927001953  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.24986743927001953  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 394, 100]), torch.Size([1, 394, 100])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.25016117095947266  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.2648477554321289  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 394, 100])
m.shape torch.Size([405, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.26590824127197266  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.26590824127197266  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 405, 100]), torch.Size([1, 405, 100])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.26621055603027344  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.2834196090698242  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 405, 100])
m.shape torch.Size([424, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.28469038009643555  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.28469038009643555  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 424, 100]), torch.Size([1, 424, 100])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.2850069999694824  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.30523204803466797  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 424, 100])
m.shape torch.Size([36192, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.4398994445800781  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.4398994445800781  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 36192, 100]), torch.Size([1, 36192, 100])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.46686458587646484  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.3919906616210938  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 36192, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.2514476776123047  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.2885570526123047  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.3256664276123047  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.2885570526123047  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

torch.Size([38359, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.3256664276123047  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.3348121643066406  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.3348121643066406  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.402820587158203  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.402820587158203  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4028282165527344  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4028892517089844  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4028897285461426  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4028897285461426  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.402893543243408  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4029507637023926  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.402952194213867  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.402952194213867  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4029541015625  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.402996063232422  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([7, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.403022289276123  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.403022289276123  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4030356407165527  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4034228324890137  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.403440475463867  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.403440475463867  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4034500122070312  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4037933349609375  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4038524627685547  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4038524627685547  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4038734436035156  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.404775619506836  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.404852867126465  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.404852867126465  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4048776626586914  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4061174392700195  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4061975479125977  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4061975479125977  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4062204360961914  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.407525062561035  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([15, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4076437950134277  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4076437950134277  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.40767240524292  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.40950345993042  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([41, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.409883499145508  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.409883499145508  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.409961700439453  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4155139923095703  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([29, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4157814979553223  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4157814979553223  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.415836811065674  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4201512336730957  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.420412063598633  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.420412063598633  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.420459747314453  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4245128631591797  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4247641563415527  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4247641563415527  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4248061180114746  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.428666591644287  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([26, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4289956092834473  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4289956092834473  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4290452003479004  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4339547157287598  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4343628883361816  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4343628883361816  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.434420108795166  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4404854774475098  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4407801628112793  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4407801628112793  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4408202171325684  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4453463554382324  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4456372261047363  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4456372261047363  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4456734657287598  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4500222206115723  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4504194259643555  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4504194259643555  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.450465202331543  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4562788009643555  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.456749439239502  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.456749439239502  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.456800937652588  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4637017250061035  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4640989303588867  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4640989303588867  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4641408920288086  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.470057487487793  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.470500946044922  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.470500946044922  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4705448150634766  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4770374298095703  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.477628707885742  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.477628707885742  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4776840209960938  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.486257553100586  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([34, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4869818687438965  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4869818687438965  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.487046718597412  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4975523948669434  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4979352951049805  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.4979352951049805  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.497969627380371  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.5037717819213867  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([2546, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.5649304389953613  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.5649304389953613  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 2546, 256]), torch.Size([1, 2546, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.5699315071105957  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 3.430361270904541  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 2546, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 3.3633785247802734  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 3.3639049530029297  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 3.364431381225586  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 3.363882541656494  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

torch.Size([3006, 47])
input nodes number: 38359
output nodes number: 3006
edges number: 70610
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 3.3641676902770996  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 3.364168167114258  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.08368682861328125  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

pseudo mini batch 35 input nodes size: 90417
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.07352066040039062  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.07352066040039062  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.10720396041870117  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.10722732543945312  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.039320945739746094  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.04172801971435547  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.04172801971435547  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

first layer input nodes number: 90417
first layer output nodes number: 25764
edges number: 249846
----------------------------------------before model layer 0
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.042593955993652344  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

torch.Size([90417, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.042593955993652344  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

m.shape torch.Size([22, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.1389923095703125  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.1389923095703125  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 22, 100]), torch.Size([1, 22, 100])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.1390094757080078  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.13914251327514648  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 22, 100])
m.shape torch.Size([44, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.13916683197021484  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.13916683197021484  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 44, 100]), torch.Size([1, 44, 100])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.13920021057128906  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.1396951675415039  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 44, 100])
m.shape torch.Size([116, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.13980817794799805  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.13980817794799805  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 116, 100]), torch.Size([1, 116, 100])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.13989496231079102  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.1417999267578125  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 116, 100])
m.shape torch.Size([214, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.1420755386352539  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.1420755386352539  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 214, 100]), torch.Size([1, 214, 100])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.14223575592041016  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.1468648910522461  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 214, 100])
m.shape torch.Size([297, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.1473383903503418  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.1473383903503418  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 297, 100]), torch.Size([1, 297, 100])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.14756059646606445  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.15553855895996094  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 297, 100])
m.shape torch.Size([328, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.15616083145141602  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.15616083145141602  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 328, 100]), torch.Size([1, 328, 100])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.15640592575073242  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.16691923141479492  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 328, 100])
m.shape torch.Size([394, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.16782426834106445  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.16782426834106445  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 394, 100]), torch.Size([1, 394, 100])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.16811800003051758  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.18280458450317383  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 394, 100])
m.shape torch.Size([392, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.18382596969604492  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.18382596969604492  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 392, 100]), torch.Size([1, 392, 100])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.18411874771118164  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.20077276229858398  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 392, 100])
m.shape torch.Size([385, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.2019176483154297  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.2019176483154297  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 385, 100]), torch.Size([1, 385, 100])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.20220470428466797  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.22057628631591797  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 385, 100])
m.shape torch.Size([23572, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.3082456588745117  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.3082456588745117  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 23572, 100]), torch.Size([1, 23572, 100])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.3258085250854492  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.5727577209472656  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 23572, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.479332447052002  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.5039029121398926  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.5284733772277832  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.5039029121398926  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

torch.Size([25764, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.5284733772277832  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.5346159934997559  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.5346159934997559  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6050610542297363  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6050610542297363  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.605064868927002  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.605095386505127  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6051054000854492  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6051054000854492  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6051130294799805  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.605280876159668  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6052851676940918  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6052851676940918  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6052889823913574  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6053996086120605  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([10, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6054458618164062  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6054458618164062  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6054649353027344  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6061515808105469  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.606194019317627  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.606194019317627  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6062111854553223  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6069493293762207  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([26, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6071157455444336  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6071157455444336  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6071653366088867  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.609644889831543  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([11, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6097049713134766  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6097049713134766  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6097259521484375  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.610921859741211  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([20, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6110844612121582  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6110844612121582  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6111226081848145  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6135640144348145  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.613718032836914  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.613718032836914  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6137523651123047  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.616189956665039  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([29, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6164793968200684  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6164793968200684  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.61653470993042  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6208491325378418  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([24, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.621098518371582  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.621098518371582  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6211442947387695  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.625035285949707  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([12, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6251626014709473  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6251626014709473  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.625185489654541  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.627291202545166  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([25, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6276164054870605  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6276164054870605  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6276640892028809  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6323847770690918  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6326208114624023  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6326208114624023  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.632655143737793  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6362943649291992  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([25, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6366620063781738  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6366620063781738  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6367096900939941  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6420979499816895  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6423192024230957  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6423192024230957  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.642347812652588  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6457810401916504  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6463379859924316  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6463379859924316  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6464009284973145  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6543946266174316  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.654710292816162  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.654710292816162  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6547465324401855  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6596026420593262  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6597771644592285  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6597771644592285  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6597962379455566  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6624855995178223  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6630010604858398  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6630010604858398  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.663050651550293  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6703901290893555  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.670851707458496  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.670851707458496  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6708955764770508  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6776952743530273  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6781821250915527  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6781821250915527  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6782259941101074  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6853327751159668  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6856107711791992  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6856107711791992  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6856355667114258  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.6898260116577148  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([2692, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.7544975280761719  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.7544975280761719  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 2692, 256]), torch.Size([1, 2692, 256])
----------------------------------------3
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 1.7603721618652344  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.67191219329834  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 2692, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.603255271911621  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.6037964820861816  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.604337692260742  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.6037731170654297  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

torch.Size([3089, 47])
input nodes number: 25764
output nodes number: 3089
edges number: 73142
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.604003429412842  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 2.60400390625  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.045981407165527344  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

pseudo mini batch 36 input nodes size: 168096
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.03933572769165039  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.03933572769165039  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.10195636749267578  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.10197925567626953  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.06827259063720703  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.07181453704833984  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.07181453704833984  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

first layer input nodes number: 168096
first layer output nodes number: 40809
edges number: 401886
----------------------------------------before model layer 0
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.07337141036987305  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

torch.Size([168096, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 0.07337141036987305  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

m.shape torch.Size([36, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.22799348831176758  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.22799348831176758  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 36, 100]), torch.Size([1, 36, 100])
----------------------------------------3
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.22802114486694336  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.22823810577392578  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 36, 100])
m.shape torch.Size([63, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.228271484375  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.228271484375  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 63, 100]), torch.Size([1, 63, 100])
----------------------------------------3
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.2283191680908203  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.22902584075927734  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 63, 100])
m.shape torch.Size([118, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.22913408279418945  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.22913408279418945  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 118, 100]), torch.Size([1, 118, 100])
----------------------------------------3
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.22922277450561523  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.23116111755371094  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 118, 100])
m.shape torch.Size([139, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.2313241958618164  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.2313241958618164  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 139, 100]), torch.Size([1, 139, 100])
----------------------------------------3
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.2314281463623047  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.2344369888305664  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 139, 100])
m.shape torch.Size([191, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.2347412109375  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.2347412109375  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 191, 100]), torch.Size([1, 191, 100])
----------------------------------------3
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.23488426208496094  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.24001264572143555  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 191, 100])
m.shape torch.Size([226, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.2404465675354004  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.2404465675354004  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 226, 100]), torch.Size([1, 226, 100])
----------------------------------------3
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.2406153678894043  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.2478652000427246  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 226, 100])
m.shape torch.Size([293, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.24854516983032227  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.24854516983032227  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 293, 100]), torch.Size([1, 293, 100])
----------------------------------------3
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.2487635612487793  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.25968313217163086  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 293, 100])
m.shape torch.Size([328, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.26055145263671875  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.26055145263671875  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 328, 100]), torch.Size([1, 328, 100])
----------------------------------------3
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.26079654693603516  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.2747325897216797  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 328, 100])
m.shape torch.Size([322, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.27603578567504883  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.27603578567504883  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 322, 100]), torch.Size([1, 322, 100])
----------------------------------------3
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.2762761116027832  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8377685546875 GB
    Memory Allocated: 0.2916440963745117  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 322, 100])
m.shape torch.Size([39093, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.9842529296875 GB
    Memory Allocated: 0.43800830841064453  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9842529296875 GB
    Memory Allocated: 0.43800830841064453  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 39093, 100]), torch.Size([1, 39093, 100])
----------------------------------------3
 Nvidia-smi: 7.9842529296875 GB
    Memory Allocated: 0.4671354293823242  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.536153793334961  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 39093, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3856334686279297  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4245519638061523  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.463470458984375  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4245519638061523  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

torch.Size([40809, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.463470458984375  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4732003211975098  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4732003211975098  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.543954849243164  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.543954849243164  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5439586639404297  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5439891815185547  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.543999195098877  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.543999195098877  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.544010639190674  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.544182300567627  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([12, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5442113876342773  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5442113876342773  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.544234275817871  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5447378158569336  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.544738292694092  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.544738292694092  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5447440147399902  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.544909954071045  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.544940948486328  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.544940948486328  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.544954299926758  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5454349517822266  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5454630851745605  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5454630851745605  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5454745292663574  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.545966625213623  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([19, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5460891723632812  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5460891723632812  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5461254119873047  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5479373931884766  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5480422973632812  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5480422973632812  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5480728149414062  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5498123168945312  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.549927234649658  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.549927234649658  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5499558448791504  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5517868995666504  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([6, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.551830291748047  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.551830291748047  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5518417358398438  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.552654266357422  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5527544021606445  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5527544021606445  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5527734756469727  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5542612075805664  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5543789863586426  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5543789863586426  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5543999671936035  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.556183338165283  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.55633544921875  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.55633544921875  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5563602447509766  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5586414337158203  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([20, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.558898448944092  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.558898448944092  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.558936595916748  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.562713146209717  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([13, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5628819465637207  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5628819465637207  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5629067420959473  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.565535068511963  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([23, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5658764839172363  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5658764839172363  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.565920352935791  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5708775520324707  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([10, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.571019172668457  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.571019172668457  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.571038246154785  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.57332706451416  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5735082626342773  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5735082626342773  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5735292434692383  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5761938095092773  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([5, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.576274871826172  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.576274871826172  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.576284408569336  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5775623321533203  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.577922821044922  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.577922821044922  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5779590606689453  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.58306884765625  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.583414077758789  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.583414077758789  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5834484100341797  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.588529586791992  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.588639736175537  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.588639736175537  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.588651180267334  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5904250144958496  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([18, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.590817451477051  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.590817451477051  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5908517837524414  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5964136123657227  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5968809127807617  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.5968809127807617  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.596920967102051  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.6036901473999023  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([2774, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.6703243255615234  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.6703243255615234  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

 h.shape torch.Size([1, 2774, 256]), torch.Size([1, 2774, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.677034378051758  GigaBytes
Max Memory Allocated: 3.6239571571350098  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.610714912414551  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2774, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.540830612182617  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.541367530822754  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.5419044494628906  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.54134464263916  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([3064, 47])
input nodes number: 40809
output nodes number: 3064
edges number: 73464
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.5416674613952637  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.541667938232422  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.07809925079345703  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

pseudo mini batch 37 input nodes size: 97914
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.0682682991027832  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.0682682991027832  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1053776741027832  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.10540151596069336  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.04275798797607422  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.04576873779296875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.04576873779296875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

first layer input nodes number: 97914
first layer output nodes number: 32803
edges number: 325624
----------------------------------------before model layer 0
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.046742916107177734  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([97914, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.046742916107177734  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([28, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17179250717163086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17179250717163086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 28, 100]), torch.Size([1, 28, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1718134880065918  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1719813346862793  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 28, 100])
m.shape torch.Size([32, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17199468612670898  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17199468612670898  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 32, 100]), torch.Size([1, 32, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17201852798461914  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17237615585327148  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 32, 100])
m.shape torch.Size([45, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17241477966308594  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17241477966308594  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 45, 100]), torch.Size([1, 45, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17244911193847656  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17319154739379883  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 45, 100])
m.shape torch.Size([50, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1732492446899414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1732492446899414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 50, 100]), torch.Size([1, 50, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17328739166259766  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1743764877319336  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 50, 100])
m.shape torch.Size([74, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17449569702148438  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17449569702148438  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 74, 100]), torch.Size([1, 74, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17455101013183594  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1765422821044922  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 74, 100])
m.shape torch.Size([79, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17669153213500977  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17669153213500977  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 79, 100]), torch.Size([1, 79, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17675065994262695  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17928457260131836  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 79, 100])
m.shape torch.Size([89, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1794872283935547  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1794872283935547  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 89, 100]), torch.Size([1, 89, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17955398559570312  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18288183212280273  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 89, 100])
m.shape torch.Size([102, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1831526756286621  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1831526756286621  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 102, 100]), torch.Size([1, 102, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1832289695739746  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18756628036499023  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 102, 100])
m.shape torch.Size([126, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18795061111450195  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18795061111450195  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 126, 100]), torch.Size([1, 126, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18804502487182617  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1940617561340332  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 126, 100])
m.shape torch.Size([32178, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.3138871192932129  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.3138871192932129  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 32178, 100]), torch.Size([1, 32178, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.337862491607666  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0400710105895996  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 32178, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.918379306793213  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.949662685394287  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9809460639953613  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.949662685394287  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([32803, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9809460639953613  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.988767147064209  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.988767147064209  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0642151832580566  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0642151832580566  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0642170906066895  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.064272403717041  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0642776489257812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0642776489257812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.064279556274414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.064361572265625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.064368724822998  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.064368724822998  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.064370632171631  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.064479351043701  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0644960403442383  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0644960403442383  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.064499855041504  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.064743995666504  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0647530555725098  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0647530555725098  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0647549629211426  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.064903736114502  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0649261474609375  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0649261474609375  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.064929962158203  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0652542114257812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0652899742126465  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0652899742126465  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.065295696258545  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.065822124481201  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0658464431762695  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0658464431762695  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.065850257873535  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.066227912902832  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.06624174118042  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.06624174118042  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0662436485290527  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0664591789245605  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.06649112701416  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.06649112701416  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.066494941711426  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.066952705383301  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0670056343078613  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0670056343078613  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0670113563537598  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0677781105041504  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0677947998046875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0677947998046875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0677967071533203  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.068065643310547  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0681071281433105  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0681071281433105  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.068110942840576  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.068702220916748  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.068789005279541  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.068789005279541  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0687966346740723  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0700325965881348  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.070075035095215  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.070075035095215  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0700788497924805  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.070723533630371  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3116, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1455936431884766  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1455936431884766  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3116, 256]), torch.Size([1, 3116, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1515369415283203  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.203916549682617  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3116, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.129143714904785  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.1296944618225098  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.1302452087402344  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.1296706199645996  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([3144, 47])
input nodes number: 32803
output nodes number: 3144
edges number: 78349
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.129952907562256  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.129953384399414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.05120086669921875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

pseudo mini batch 38 input nodes size: 137406
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.04277181625366211  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.04277181625366211  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.09395980834960938  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.09398269653320312  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.05684947967529297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.06003379821777344  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.06003379821777344  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

first layer input nodes number: 137406
first layer output nodes number: 29953
edges number: 294982
----------------------------------------before model layer 0
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.06128120422363281  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([137406, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.06128120422363281  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([41, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17508888244628906  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17508888244628906  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 41, 100]), torch.Size([1, 41, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17512035369873047  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1753678321838379  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 41, 100])
m.shape torch.Size([68, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17540311813354492  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17540311813354492  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 68, 100]), torch.Size([1, 68, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17545461654663086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17621850967407227  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 68, 100])
m.shape torch.Size([115, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17632150650024414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17632150650024414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 115, 100]), torch.Size([1, 115, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1764073371887207  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17829561233520508  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 115, 100])
m.shape torch.Size([101, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17840337753295898  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17840337753295898  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 101, 100]), torch.Size([1, 101, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.17847871780395508  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1806635856628418  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 101, 100])
m.shape torch.Size([111, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1808328628540039  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1808328628540039  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 111, 100]), torch.Size([1, 111, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18091583251953125  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18389558792114258  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 111, 100])
m.shape torch.Size([141, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18416929244995117  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18416929244995117  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 141, 100]), torch.Size([1, 141, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18427515029907227  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18880128860473633  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 141, 100])
m.shape torch.Size([178, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18921279907226562  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18921279907226562  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 178, 100]), torch.Size([1, 178, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1893463134765625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19599199295043945  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 178, 100])
m.shape torch.Size([180, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19646167755126953  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19646167755126953  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 180, 100]), torch.Size([1, 180, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1965961456298828  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.20424938201904297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 180, 100])
m.shape torch.Size([211, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.20488977432250977  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.20488977432250977  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 211, 100]), torch.Size([1, 211, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2050471305847168  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2151179313659668  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 211, 100])
m.shape torch.Size([28807, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.3223538398742676  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.3223538398742676  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 28807, 100]), torch.Size([1, 28807, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.34381723403930664  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.867689609527588  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 28807, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.758779525756836  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.788076400756836  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8166418075561523  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.7873449325561523  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([29953, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8166418075561523  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.823051929473877  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.823051929473877  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.892587661743164  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.892587661743164  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8925933837890625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.89263916015625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([25, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8927087783813477  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8927087783813477  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.892756462097168  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8938055038452148  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8937859535217285  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8937859535217285  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8937878608703613  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.893843173980713  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8938617706298828  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8938617706298828  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.893869400024414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.894144058227539  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8941693305969238  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8941693305969238  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.894178867340088  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8945889472961426  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([15, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8946852684020996  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8946852684020996  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8947138786315918  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8961443901062012  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8961458206176758  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8961458206176758  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8961496353149414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.896367073059082  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([21, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8965468406677246  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8965468406677246  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8965868949890137  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8991503715515137  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([6, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8991880416870117  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8991880416870117  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.8991994857788086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9000120162963867  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9000592231750488  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9000592231750488  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.900068759918213  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9008126258850098  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([32, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.901176929473877  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.901176929473877  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.901237964630127  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.906425952911377  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([19, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.906632900238037  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.906632900238037  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9066691398620605  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9100031852722168  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([8, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.910092830657959  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.910092830657959  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9101080894470215  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.911618709564209  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([19, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9118852615356445  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9118852615356445  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.911921501159668  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9157629013061523  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9160523414611816  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9160523414611816  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.916090488433838  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9204010963439941  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([10, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9205455780029297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9205455780029297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9205646514892578  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9228534698486328  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9232592582702637  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9232592582702637  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9233050346374512  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9291186332702637  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9295344352722168  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9295344352722168  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9295802116394043  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9357142448425293  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9359989166259766  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9359989166259766  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9360294342041016  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9403324127197266  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9408621788024902  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9408621788024902  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9409136772155762  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.948535442352295  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9488272666931152  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9488272666931152  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9488558769226074  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9532904624938965  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9535861015319824  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9535861015319824  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9536128044128418  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9579386711120605  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9585943222045898  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9585943222045898  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9586496353149414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9679975509643555  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([2680, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.032365322113037  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.032365322113037  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2680, 256]), torch.Size([1, 2680, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0383334159851074  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.9395699501037598  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2680, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.8718161582946777  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.8723459243774414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.872875690460205  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.8723230361938477  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([3024, 47])
input nodes number: 29953
output nodes number: 3024
edges number: 72198
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.8725485801696777  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.872549057006836  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.06582117080688477  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

pseudo mini batch 39 input nodes size: 145000
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.05682849884033203  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.05682849884033203  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.11151599884033203  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.11153936386108398  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.06032848358154297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.06373119354248047  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.06373119354248047  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

first layer input nodes number: 145000
first layer output nodes number: 38176
edges number: 379330
----------------------------------------before model layer 0
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.06509637832641602  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([145000, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.06509637832641602  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([32, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21039199829101562  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21039199829101562  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 32, 100]), torch.Size([1, 32, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21041584014892578  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21060657501220703  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 32, 100])
m.shape torch.Size([34, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21062040328979492  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21062040328979492  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 34, 100]), torch.Size([1, 34, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2106461524963379  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2110295295715332  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 34, 100])
m.shape torch.Size([49, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21107149124145508  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21107149124145508  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 49, 100]), torch.Size([1, 49, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21110868453979492  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21191835403442383  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 49, 100])
m.shape torch.Size([63, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21199369430541992  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21199369430541992  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 63, 100]), torch.Size([1, 63, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21204137802124023  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21340703964233398  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 63, 100])
m.shape torch.Size([62, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2134990692138672  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2134990692138672  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 62, 100]), torch.Size([1, 62, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2135457992553711  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21521377563476562  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 62, 100])
m.shape torch.Size([74, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21535587310791016  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21535587310791016  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 74, 100]), torch.Size([1, 74, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21541118621826172  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2177896499633789  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 74, 100])
m.shape torch.Size([90, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21799707412719727  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21799707412719727  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 90, 100]), torch.Size([1, 90, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2180647850036621  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22143030166625977  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 90, 100])
m.shape torch.Size([88, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22165870666503906  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22165870666503906  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 88, 100]), torch.Size([1, 88, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2217245101928711  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2254638671875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 88, 100])
m.shape torch.Size([97, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22575664520263672  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22575664520263672  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 97, 100]), torch.Size([1, 97, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2258291244506836  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2304677963256836  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 97, 100])
m.shape torch.Size([37587, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.37105655670166016  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.37105655670166016  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 37587, 100]), torch.Size([1, 37587, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.3990612030029297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3873910903930664  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 37587, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.2455787658691406  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.2826881408691406  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3197975158691406  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.2826881408691406  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([38176, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3197975158691406  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.328899383544922  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.328899383544922  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([9, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.403367042541504  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.403367042541504  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.403384208679199  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4038820266723633  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4038853645324707  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4038853645324707  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4038891792297363  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.404053211212158  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4040584564208984  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4040584564208984  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4040603637695312  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.404155731201172  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4041638374328613  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4041638374328613  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.404165744781494  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.404287815093994  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.404306411743164  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.404306411743164  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4043102264404297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.404581069946289  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4046168327331543  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4046168327331543  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4046225547790527  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.405148983001709  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4051599502563477  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4051599502563477  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4051618576049805  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.405350685119629  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.405364513397217  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.405364513397217  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4053664207458496  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4055685997009277  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.405583381652832  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.405583381652832  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.405585289001465  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4058008193969727  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4058165550231934  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4058165550231934  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.405818462371826  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4060473442077637  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.406081199645996  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.406081199645996  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4060850143432617  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.406569480895996  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.406604290008545  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.406604290008545  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4066081047058105  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4071192741394043  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.407175064086914  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.407175064086914  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4071807861328125  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.407987594604492  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4080052375793457  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4080052375793457  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4080071449279785  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4082894325256348  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4083523750305176  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4083523750305176  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.408358097076416  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.409245014190674  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.409308910369873  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.409308910369873  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4093146324157715  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4102416038513184  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.410308361053467  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.410308361053467  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4103140830993652  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.411281108856201  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3070, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4850449562072754  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4850449562072754  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3070, 256]), torch.Size([1, 3070, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.4909005165100098  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.5224804878234863  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3070, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.4487195014953613  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.4492640495300293  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.4498085975646973  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.4492406845092773  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([3109, 47])
input nodes number: 38176
output nodes number: 3109
edges number: 77297
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.449563503265381  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.449563980102539  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.06969499588012695  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

pseudo mini batch 40 input nodes size: 136890
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.060343265533447266  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.060343265533447266  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.11133909225463867  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.11136245727539062  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.05665159225463867  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.06015634536743164  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.06015634536743164  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

first layer input nodes number: 136890
first layer output nodes number: 32568
edges number: 323212
----------------------------------------before model layer 0
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.061419010162353516  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([136890, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.061419010162353516  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([21, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18522071838378906  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18522071838378906  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 21, 100]), torch.Size([1, 21, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18523693084716797  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18536376953125  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 21, 100])
m.shape torch.Size([38, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18538427352905273  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18538427352905273  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 38, 100]), torch.Size([1, 38, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18541288375854492  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18583917617797852  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 38, 100])
m.shape torch.Size([46, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18587636947631836  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18587636947631836  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 46, 100]), torch.Size([1, 46, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18591070175170898  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18666601181030273  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 46, 100])
m.shape torch.Size([65, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18674612045288086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18674612045288086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 65, 100]), torch.Size([1, 65, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18679475784301758  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18820524215698242  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 65, 100])
m.shape torch.Size([67, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18830585479736328  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18830585479736328  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 67, 100]), torch.Size([1, 67, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1883563995361328  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19016170501708984  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 67, 100])
m.shape torch.Size([69, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1902909278869629  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1902909278869629  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 69, 100]), torch.Size([1, 69, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19034242630004883  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19255685806274414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 69, 100])
m.shape torch.Size([111, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19282102584838867  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19282102584838867  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 111, 100]), torch.Size([1, 111, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19290399551391602  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19704246520996094  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 111, 100])
m.shape torch.Size([100, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19729900360107422  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19729900360107422  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 100, 100]), torch.Size([1, 100, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1973743438720703  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.20163440704345703  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 100, 100])
m.shape torch.Size([119, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.201995849609375  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.201995849609375  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 119, 100]), torch.Size([1, 119, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.20208454132080078  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.20776081085205078  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 119, 100])
m.shape torch.Size([31932, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.3266725540161133  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.3266725540161133  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 31932, 100]), torch.Size([1, 31932, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.3504638671875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.039647102355957  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 31932, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9188623428344727  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9499216079711914  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9809808731079102  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9499216079711914  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([32568, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9809808731079102  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9887456893920898  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9887456893920898  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.061722755432129  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.061722755432129  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0617246627807617  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.061739921569824  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.061741352081299  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.061741352081299  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0617432594299316  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.061771869659424  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0617971420288086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0617971420288086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.061814308166504  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.062191963195801  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.062229633331299  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.062229633331299  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0622525215148926  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0629162788391113  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.062924385070801  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.062924385070801  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.062932014465332  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.063206672668457  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.063209056854248  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.063209056854248  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.063210964202881  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.063292980194092  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([11, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.063366413116455  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.063366413116455  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.063387393951416  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.064436435699463  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0644493103027344  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0644493103027344  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.064455032348633  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0647811889648438  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.064847946166992  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.064847946166992  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0648632049560547  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0658397674560547  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0659093856811523  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0659093856811523  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.065924644470215  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0670080184936523  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.067074775695801  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.067074775695801  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0670881271362305  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.068129539489746  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.068192481994629  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.068192481994629  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.068203926086426  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.06917667388916  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([22, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.069446086883545  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.069446086883545  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.069488048553467  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0733485221862793  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([9, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.073448657989502  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.073448657989502  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0734658241271973  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.075165271759033  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0752291679382324  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0752291679382324  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0752387046813965  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.076249599456787  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([17, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0765066146850586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0765066146850586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0765390396118164  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.080203056335449  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0804977416992188  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0804977416992188  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.080533981323242  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0848827362060547  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0850725173950195  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0850725173950195  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0850954055786133  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0880022048950195  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0881733894348145  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0881733894348145  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0881924629211426  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0907483100891113  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([3, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.09079647064209  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.09079647064209  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0908021926879883  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.091609001159668  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.091787815093994  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.091787815093994  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0918049812316895  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0943455696105957  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.094485282897949  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.094485282897949  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.094498634338379  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0965681076049805  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([2, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0966057777404785  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0966057777404785  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.096609592437744  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0972275733947754  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.097825527191162  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.097825527191162  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0978751182556152  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1062560081481934  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([2889, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1756486892700195  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1756486892700195  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2889, 256]), torch.Size([1, 2889, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.181790351867676  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.1839847564697266  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2889, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.1118316650390625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.112374782562256  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.112917900085449  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.112351417541504  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([3101, 47])
input nodes number: 32568
output nodes number: 3101
edges number: 75292
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.1126160621643066  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.112616539001465  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.06547117233276367  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

pseudo mini batch 41 input nodes size: 142268
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.05665016174316406  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.05665016174316406  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1096491813659668  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.10967159271240234  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.058652400970458984  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.06200838088989258  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.06200838088989258  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

first layer input nodes number: 142268
first layer output nodes number: 32591
edges number: 321627
----------------------------------------before model layer 0
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.06331157684326172  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([142268, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.06331157684326172  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([49, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18652057647705078  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18652057647705078  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 49, 100]), torch.Size([1, 49, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18655776977539062  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18685245513916016  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 49, 100])
m.shape torch.Size([43, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18686628341674805  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18686628341674805  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 43, 100]), torch.Size([1, 43, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18689870834350586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18738222122192383  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 43, 100])
m.shape torch.Size([88, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18746471405029297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18746471405029297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 88, 100]), torch.Size([1, 88, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.187530517578125  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18897390365600586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 88, 100])
m.shape torch.Size([95, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18908262252807617  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18908262252807617  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 95, 100]), torch.Size([1, 95, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.18915414810180664  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19121122360229492  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 95, 100])
m.shape torch.Size([113, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19138622283935547  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19138622283935547  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 113, 100]), torch.Size([1, 113, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19147109985351562  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19451236724853516  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 113, 100])
m.shape torch.Size([163, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19483470916748047  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19483470916748047  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 163, 100]), torch.Size([1, 163, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19495677947998047  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.20018863677978516  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 163, 100])
m.shape torch.Size([187, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.20061540603637695  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.20061540603637695  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 187, 100]), torch.Size([1, 187, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.20075559616088867  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2077350616455078  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 187, 100])
m.shape torch.Size([172, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2081775665283203  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2081775665283203  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 172, 100]), torch.Size([1, 172, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.20830631256103516  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2156219482421875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 172, 100])
m.shape torch.Size([190, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21619462966918945  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21619462966918945  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 190, 100]), torch.Size([1, 190, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21633672714233398  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22540521621704102  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 190, 100])
m.shape torch.Size([31491, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.3426475524902344  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.3426475524902344  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 31491, 100]), torch.Size([1, 31491, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.36611080169677734  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.031972885131836  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 31491, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9119505882263184  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9430317878723145  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9741129875183105  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9430317878723145  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([32591, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9741129875183105  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.981912612915039  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.981912612915039  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.042539596557617  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.042539596557617  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.042552947998047  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0426597595214844  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0426573753356934  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0426573753356934  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.042661190032959  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0427184104919434  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([36, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.042820453643799  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.042820453643799  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.04288911819458  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0443997383117676  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([22, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.044450283050537  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.044450283050537  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.044492244720459  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0457091331481934  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([34, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.045851707458496  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.045851707458496  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0459165573120117  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.048251152038574  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([71, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.048628330230713  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.048628330230713  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0487637519836426  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.054586887359619  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([79, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.055050849914551  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.055050849914551  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.055201530456543  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0627355575561523  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([46, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.063014030456543  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.063014030456543  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0631017684936523  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0681028366088867  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([62, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0685954093933105  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0685954093933105  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.068713665008545  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.076282024383545  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([111, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0772900581359863  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0772900581359863  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0775017738342285  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.092533588409424  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([33, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0927767753601074  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0927767753601074  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0928397178649902  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0977492332458496  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([36, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.098133087158203  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.098133087158203  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0982017517089844  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1040382385253906  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([31, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.104391574859619  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.104391574859619  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1044507026672363  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1098904609680176  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([62, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1106953620910645  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1106953620910645  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.110813617706299  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.122520923614502  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([25, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1228222846984863  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1228222846984863  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1228699684143066  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1279244422912598  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1285157203674316  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1285157203674316  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.128592014312744  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1372132301330566  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([10, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.137338638305664  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.137338638305664  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.137357711791992  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.139646530151367  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([54, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1405715942382812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1405715942382812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.140674591064453  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1537551879882812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.154068946838379  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.154068946838379  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1541051864624023  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.159214973449707  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1593785285949707  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1593785285949707  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.159395694732666  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1619362831115723  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.161991596221924  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.161991596221924  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1619973182678223  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.16288423538208  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1632351875305176  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1632351875305176  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1632657051086426  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1682095527648926  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1684250831604004  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1684250831604004  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1684441566467285  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1716675758361816  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([2163, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.223630905151367  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.223630905151367  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2163, 256]), torch.Size([1, 2163, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.2277565002441406  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.964146614074707  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2163, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.9060816764831543  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.9066038131713867  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.907125949859619  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.906581401824951  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([2981, 47])
input nodes number: 32591
output nodes number: 2981
edges number: 62933
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.9068260192871094  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.9068264961242676  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.06714582443237305  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

pseudo mini batch 42 input nodes size: 190717
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.05863142013549805  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.05863142013549805  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.12967920303344727  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1297016143798828  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.07668018341064453  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.07992362976074219  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.07992362976074219  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

first layer input nodes number: 190717
first layer output nodes number: 36946
edges number: 364700
----------------------------------------before model layer 0
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.0816202163696289  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([190717, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.0816202163696289  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([62, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22218894958496094  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22218894958496094  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 62, 100]), torch.Size([1, 62, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22223567962646484  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22260665893554688  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 62, 100])
m.shape torch.Size([90, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22265052795410156  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22265052795410156  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 90, 100]), torch.Size([1, 90, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2227182388305664  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22372817993164062  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 90, 100])
m.shape torch.Size([121, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2238297462463379  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2238297462463379  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 121, 100]), torch.Size([1, 121, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22392034530639648  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22590923309326172  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 121, 100])
m.shape torch.Size([128, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22605466842651367  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22605466842651367  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 128, 100]), torch.Size([1, 128, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2261500358581543  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22891569137573242  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 128, 100])
m.shape torch.Size([102, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22905826568603516  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22905826568603516  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 102, 100]), torch.Size([1, 102, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22913455963134766  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2318739891052246  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 102, 100])
m.shape torch.Size([133, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2321333885192871  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2321333885192871  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 133, 100]), torch.Size([1, 133, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.23223257064819336  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2364974021911621  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 133, 100])
m.shape torch.Size([135, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2368001937866211  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2368001937866211  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 135, 100]), torch.Size([1, 135, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.23690128326416016  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.24193572998046875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 135, 100])
m.shape torch.Size([139, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.24229955673217773  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.24229955673217773  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 139, 100]), torch.Size([1, 139, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.24240350723266602  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.24831724166870117  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 139, 100])
m.shape torch.Size([142, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.24874162673950195  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.24874162673950195  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 142, 100]), torch.Size([1, 142, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.24884748458862305  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.25562238693237305  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 142, 100])
m.shape torch.Size([35894, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.3892850875854492  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.3892850875854492  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 35894, 100]), torch.Size([1, 35894, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.4160289764404297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3148021697998047  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 35894, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.177778720855713  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.213013172149658  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.2482476234436035  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.213013172149658  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([36946, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.2482476234436035  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.25705623626709  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.25705623626709  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3248744010925293  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3248744010925293  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3248820304870605  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3249430656433105  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([14, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3249664306640625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3249664306640625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.324993133544922  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3253936767578125  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3254237174987793  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3254237174987793  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3254523277282715  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3260817527770996  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([32, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.32619047164917  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.32619047164917  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.32625150680542  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.32802152633667  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3280248641967773  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3280248641967773  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.328038215637207  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.328518867492676  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([35, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.328714370727539  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.328714370727539  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3287811279296875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3316516876220703  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([19, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3317465782165527  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3317465782165527  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.331782817840576  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.333594799041748  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([13, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.333676815032959  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.333676815032959  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3337016105651855  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3351149559020996  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([7, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.335163116455078  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.335163116455078  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.335176467895508  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.336030960083008  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3360533714294434  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3360533714294434  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.336059093475342  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.336465358734131  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([12, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.336589813232422  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.336589813232422  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3366127014160156  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.338397979736328  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3385252952575684  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3385252952575684  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.338548183441162  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.340493679046631  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([7, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3405699729919434  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3405699729919434  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.340583324432373  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3418116569519043  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([23, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3421149253845215  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3421149253845215  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.342158794403076  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3465018272399902  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([7, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.346580982208252  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.346580982208252  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3465943336486816  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3480095863342285  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3480491638183594  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3480491638183594  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.348054885864258  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3487014770507812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.348829746246338  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.348829746246338  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3488450050354004  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3506760597229004  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([16, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.350945472717285  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.350945472717285  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.35097599029541  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.354851722717285  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([4, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.354909896850586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.354909896850586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.354917526245117  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3559398651123047  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3562822341918945  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3562822341918945  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.356316566467285  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3611574172973633  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3612613677978516  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3612613677978516  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3612728118896484  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.362966537475586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3632569313049316  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3632569313049316  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.363283634185791  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.367422580718994  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([22, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3678956031799316  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3678956031799316  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3679375648498535  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3747353553771973  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.375014305114746  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.375014305114746  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3750391006469727  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.3792295455932617  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([2667, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.443300247192383  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.443300247192383  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2667, 256]), torch.Size([1, 2667, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.448753833770752  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.347330093383789  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2667, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.280397415161133  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.2809195518493652  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.2814416885375977  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.2808971405029297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([2981, 47])
input nodes number: 36946
output nodes number: 2981
edges number: 70409
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.2811951637268066  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 3.281195640563965  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.08597421646118164  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

pseudo mini batch 43 input nodes size: 171955
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.07668018341064453  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.07668018341064453  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.14073848724365234  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.1407608985900879  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.06969070434570312  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.07258415222167969  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.07258415222167969  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

first layer input nodes number: 171955
first layer output nodes number: 33636
edges number: 325265
----------------------------------------before model layer 0
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.07411623001098633  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([171955, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.07411623001098633  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([81, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19875097274780273  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19875097274780273  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 81, 100]), torch.Size([1, 81, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19881200790405273  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19929742813110352  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 81, 100])
m.shape torch.Size([156, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19938325881958008  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19938325881958008  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 156, 100]), torch.Size([1, 156, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.19949960708618164  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.20124483108520508  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 156, 100])
m.shape torch.Size([246, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2014617919921875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2014617919921875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 246, 100]), torch.Size([1, 246, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2016458511352539  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.20568227767944336  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 246, 100])
m.shape torch.Size([309, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.20605087280273438  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.20605087280273438  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 309, 100]), torch.Size([1, 309, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2062816619873047  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21296310424804688  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 309, 100])
m.shape torch.Size([353, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21350526809692383  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21350526809692383  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 353, 100]), torch.Size([1, 353, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.21376848220825195  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22324419021606445  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 353, 100])
m.shape torch.Size([364, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22392654418945312  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.22392654418945312  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 364, 100]), torch.Size([1, 364, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2241983413696289  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2358684539794922  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 364, 100])
m.shape torch.Size([415, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2368149757385254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2368149757385254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 415, 100]), torch.Size([1, 415, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.23712491989135742  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2525920867919922  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 415, 100])
m.shape torch.Size([369, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2535371780395508  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2535371780395508  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 369, 100]), torch.Size([1, 369, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2538127899169922  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2694997787475586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 369, 100])
m.shape torch.Size([338, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2704954147338867  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2704954147338867  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 338, 100]), torch.Size([1, 338, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2707481384277344  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.2868838310241699  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 338, 100])
m.shape torch.Size([31005, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.40226030349731445  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.40226030349731445  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 31005, 100]), torch.Size([1, 31005, 100])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 0.42569780349731445  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.069547176361084  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 31005, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.9492573738098145  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.981335163116455  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0134129524230957  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 1.981335163116455  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([33636, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0134129524230957  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0218992233276367  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0218992233276367  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0824503898620605  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0824503898620605  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.082456111907959  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0825018882751465  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([15, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0825281143188477  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0825281143188477  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.08255672454834  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0829858779907227  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([48, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0831103324890137  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0831103324890137  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0832018852233887  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0852160453796387  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([60, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0854010581970215  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0854010581970215  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0855154991149902  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.088834285736084  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([68, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.089104175567627  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.089104175567627  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 68, 256]), torch.Size([1, 68, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.089233875274658  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.093903064727783  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 68, 256])
m.shape torch.Size([64, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.094207286834717  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.094207286834717  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.094329357147217  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.099578380584717  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([69, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0999817848205566  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.0999817848205566  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 69, 256]), torch.Size([1, 69, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1001133918762207  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.106693744659424  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 69, 256])
m.shape torch.Size([39, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1069278717041016  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1069278717041016  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1070022583007812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1112422943115234  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([19, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1113696098327637  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1113696098327637  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.111405849456787  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.113725185394287  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([38, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.114072322845459  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.114072322845459  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.114144802093506  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.119290828704834  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([56, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.119846820831299  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.119846820831299  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1199536323547363  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1282849311828613  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([24, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1285085678100586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1285085678100586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.128554344177246  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1324453353881836  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([27, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1327600479125977  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1327600479125977  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1328115463256836  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.13754940032959  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([80, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1386003494262695  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1386003494262695  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1387529373168945  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1538591384887695  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([24, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1541290283203125  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1541290283203125  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1541748046875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.159027099609375  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([40, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1596193313598633  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1596193313598633  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.159695625305176  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1683168411254883  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1685895919799805  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1685895919799805  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.168625831604004  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1729745864868164  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.173198699951172  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.173198699951172  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1732254028320312  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.176616668701172  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.176877498626709  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.176877498626709  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.176906108856201  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1807398796081543  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.181206226348877  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.181206226348877  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1812539100646973  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1879773139953613  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.18825626373291  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.18825626373291  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 8.3065185546875 GB
    Memory Allocated: 2.1882848739624023  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3104248046875 GB
    Memory Allocated: 2.192519187927246  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([35, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3123779296875 GB
    Memory Allocated: 2.1932454109191895  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3123779296875 GB
    Memory Allocated: 2.1932454109191895  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 8.3123779296875 GB
    Memory Allocated: 2.193312168121338  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3221435546875 GB
    Memory Allocated: 2.2036595344543457  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3221435546875 GB
    Memory Allocated: 2.2043118476867676  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3221435546875 GB
    Memory Allocated: 2.2043118476867676  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 8.3221435546875 GB
    Memory Allocated: 2.2043709754943848  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3338623046875 GB
    Memory Allocated: 2.213949680328369  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3338623046875 GB
    Memory Allocated: 2.21481990814209  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3338623046875 GB
    Memory Allocated: 2.21481990814209  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 8.3338623046875 GB
    Memory Allocated: 2.2148942947387695  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 2.2274656295776367  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([2116, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 2.2782721519470215  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 2.2782721519470215  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2116, 256]), torch.Size([1, 2116, 256])
----------------------------------------3
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 2.2823081016540527  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 2.9959402084350586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2116, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 2.9373860359191895  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3475341796875 GB
    Memory Allocated: 2.93790864944458  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3494873046875 GB
    Memory Allocated: 2.9384312629699707  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3494873046875 GB
    Memory Allocated: 2.9378862380981445  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([2983, 47])
input nodes number: 33636
output nodes number: 2983
edges number: 62856
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3494873046875 GB
    Memory Allocated: 2.938159942626953  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3494873046875 GB
    Memory Allocated: 2.9381604194641113  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.07801485061645508  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

pseudo mini batch 44 input nodes size: 160869
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06969118118286133  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06969118118286133  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.12961959838867188  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.12964200973510742  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06556129455566406  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06853103637695312  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06853103637695312  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

first layer input nodes number: 160869
first layer output nodes number: 33349
edges number: 328330
----------------------------------------before model layer 0
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06997871398925781  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([160869, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06997871398925781  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([48, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19575834274291992  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19575834274291992  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 48, 100]), torch.Size([1, 48, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19579458236694336  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19608163833618164  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 48, 100])
m.shape torch.Size([55, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1961045265197754  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1961045265197754  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 55, 100]), torch.Size([1, 55, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19614553451538086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1967606544494629  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 55, 100])
m.shape torch.Size([110, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19686317443847656  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19686317443847656  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 110, 100]), torch.Size([1, 110, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1969451904296875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19874954223632812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 110, 100])
m.shape torch.Size([134, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19890832901000977  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19890832901000977  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 134, 100]), torch.Size([1, 134, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19900846481323242  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.20190668106079102  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 134, 100])
m.shape torch.Size([146, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.20212888717651367  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.20212888717651367  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 146, 100]), torch.Size([1, 146, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2022385597229004  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.20616531372070312  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 146, 100])
m.shape torch.Size([180, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2065129280090332  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2065129280090332  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 180, 100]), torch.Size([1, 180, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.20664739608764648  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.21242094039916992  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 180, 100])
m.shape torch.Size([217, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2129197120666504  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2129197120666504  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 217, 100]), torch.Size([1, 217, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.21308183670043945  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2211780548095703  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 217, 100])
m.shape torch.Size([196, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2216811180114746  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2216811180114746  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 196, 100]), torch.Size([1, 196, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.22182798385620117  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2301650047302246  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 196, 100])
m.shape torch.Size([221, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.23083257675170898  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.23083257675170898  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 221, 100]), torch.Size([1, 221, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.23099756240844727  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.24154376983642578  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 221, 100])
m.shape torch.Size([32042, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.3608274459838867  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.3608274459838867  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 32042, 100]), torch.Size([1, 32042, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.385101318359375  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0801076889038086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 32042, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9576516151428223  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9894556999206543  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0212597846984863  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9894556999206543  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([33349, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0212597846984863  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0293326377868652  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0293326377868652  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0968751907348633  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0968751907348633  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.096879005432129  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.096909523010254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.096909999847412  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.096909999847412  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.096911907196045  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.096940517425537  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.096965789794922  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.096965789794922  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.096982955932617  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.097360610961914  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([14, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0974059104919434  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0974059104919434  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0974326133728027  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0982069969177246  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0982370376586914  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0982370376586914  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0982542037963867  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.098872184753418  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([13, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0989389419555664  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0989389419555664  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.098963737487793  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.100029945373535  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([39, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.100280284881592  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.100280284881592  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1003546714782715  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.104074001312256  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([10, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.104114055633545  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.104114055633545  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.104133129119873  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.105220317840576  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1052803993225098  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1052803993225098  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1052956581115723  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1062722206115723  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([19, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.106447219848633  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.106447219848633  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1064834594726562  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1090564727783203  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([38, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.109440326690674  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.109440326690674  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1095128059387207  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.115166187286377  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([18, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.11533784866333  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.11533784866333  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1153721809387207  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.118290424346924  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([12, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1184234619140625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1184234619140625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1184463500976562  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1205520629882812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([25, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.120877265930176  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.120877265930176  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.120924949645996  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.125645637512207  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.12614107131958  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.12614107131958  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1262097358703613  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.133488178253174  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([8, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1335768699645996  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1335768699645996  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.133592128753662  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1353163719177246  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([11, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.135488510131836  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.135488510131836  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.135509490966797  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1380271911621094  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([19, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.138345718383789  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.138345718383789  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1383819580078125  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.142984390258789  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([6, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.143075942993164  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.143075942993164  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.143087387084961  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.144620895385742  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([21, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.145019054412842  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.145019054412842  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.145059108734131  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1507067680358887  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([14, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1509695053100586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1509695053100586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.150996208190918  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1549482345581055  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.155104160308838  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.155104160308838  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1551194190979004  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.157484531402588  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([21, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1579413414001465  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1579413414001465  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1579813957214355  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1644701957702637  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.164980888366699  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.164980888366699  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.165024757385254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.172438621520996  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([2597, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2348179817199707  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2348179817199707  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2597, 256]), torch.Size([1, 2597, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2397713661193848  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.1134610176086426  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2597, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.046865940093994  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.0473880767822266  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.047910213470459  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.047365665435791  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([2981, 47])
input nodes number: 33349
output nodes number: 2981
edges number: 70126
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.0476365089416504  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.0476369857788086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.07400226593017578  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

pseudo mini batch 45 input nodes size: 143974
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06556081771850586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06556081771850586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.11919546127319336  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1192178726196289  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.05926704406738281  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06204414367675781  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06204414367675781  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

first layer input nodes number: 143974
first layer output nodes number: 30219
edges number: 299915
----------------------------------------before model layer 0
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06334257125854492  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([143974, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06334257125854492  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([13, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.17821931838989258  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.17821931838989258  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 13, 100]), torch.Size([1, 13, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.17822980880737305  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.17830944061279297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 13, 100])
m.shape torch.Size([32, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1783280372619629  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1783280372619629  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 32, 100]), torch.Size([1, 32, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.17835187911987305  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1787095069885254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 32, 100])
m.shape torch.Size([49, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.17875242233276367  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.17875242233276367  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 49, 100]), torch.Size([1, 49, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.17878961563110352  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.17959928512573242  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 49, 100])
m.shape torch.Size([53, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.17965984344482422  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.17965984344482422  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 53, 100]), torch.Size([1, 53, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.17969989776611328  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18085002899169922  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 53, 100])
m.shape torch.Size([67, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1809549331665039  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1809549331665039  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 67, 100]), torch.Size([1, 67, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18100547790527344  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18281078338623047  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 67, 100])
m.shape torch.Size([75, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1829533576965332  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1829533576965332  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 75, 100]), torch.Size([1, 75, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18300962448120117  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18542051315307617  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 75, 100])
m.shape torch.Size([101, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18565607070922852  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18565607070922852  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 101, 100]), torch.Size([1, 101, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1857314109802246  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1894984245300293  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 101, 100])
m.shape torch.Size([95, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1897439956665039  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1897439956665039  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 95, 100]), torch.Size([1, 95, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18981552124023438  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19385814666748047  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 95, 100])
m.shape torch.Size([113, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19420146942138672  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19420146942138672  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 113, 100]), torch.Size([1, 113, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19428634643554688  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1996927261352539  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 113, 100])
m.shape torch.Size([29621, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.30999755859375  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.30999755859375  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 29621, 100]), torch.Size([1, 29621, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.33343505859375  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.915414810180664  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 29621, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8028922080993652  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8321890830993652  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8610081672668457  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8317112922668457  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([30219, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8610081672668457  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8677353858947754  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8677353858947754  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9376373291015625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9376373291015625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9376411437988281  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9376983642578125  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9377140998840332  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9377140998840332  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.93772554397583  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9379773139953613  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9379949569702148  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9379949569702148  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9380064010620117  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.938338279724121  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.938347339630127  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.938347339630127  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9383530616760254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9385590553283691  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9385795593261719  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9385795593261719  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9385871887207031  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9389152526855469  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9389519691467285  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9389519691467285  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9389634132385254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9395356178283691  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9395456314086914  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9395456314086914  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.939549446105957  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9397668838500977  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9398083686828613  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9398083686828613  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9398179054260254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9404282569885254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9405102729797363  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9405102729797363  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9405274391174316  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9417462348937988  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9418120384216309  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9418120384216309  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9418253898620605  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9428668022155762  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9429411888122559  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9429411888122559  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9429545402526855  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.944089412689209  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9441704750061035  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9441704750061035  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9441838264465332  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9454121589660645  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.945540428161621  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.945540428161621  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9455595016479492  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9474477767944336  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([23, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.947770118713379  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.947770118713379  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9478139877319336  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9524641036987305  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([7, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.952549934387207  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.952549934387207  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9525632858276367  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9540719985961914  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9541964530944824  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9541964530944824  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.954211711883545  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.956042766571045  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9562082290649414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9562082290649414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9562273025512695  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9586496353149414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9588775634765625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9588775634765625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.958902359008789  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9622249603271484  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([36, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.962904930114746  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.962904930114746  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9629735946655273  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9726552963256836  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9730653762817383  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9730653762817383  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9731073379516602  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9793176651000977  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.979698657989502  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.979698657989502  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9797348976135254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9853520393371582  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9855995178222656  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9855995178222656  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9856224060058594  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9893302917480469  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9896421432495117  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9896421432495117  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.989668846130371  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9941816329956055  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([2747, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.060173988342285  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.060173988342285  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2747, 256]), torch.Size([1, 2747, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0658445358276367  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.0000157356262207  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2747, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.9309983253479004  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.931521415710449  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.932044506072998  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.9314990043640137  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([2985, 47])
input nodes number: 30219
output nodes number: 2985
edges number: 72577
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.9317479133605957  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.931748390197754  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06714773178100586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

pseudo mini batch 46 input nodes size: 118712
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.05926799774169922  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.05926799774169922  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.10349178314208984  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1035146713256836  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.04985761642456055  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.05257844924926758  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.05257844924926758  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

first layer input nodes number: 118712
first layer output nodes number: 29334
edges number: 290699
----------------------------------------before model layer 0
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.05368185043334961  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([118712, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.05368185043334961  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([31, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.16503524780273438  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.16503524780273438  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 31, 100]), torch.Size([1, 31, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.16505908966064453  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.16524553298950195  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 31, 100])
m.shape torch.Size([38, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.16526222229003906  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.16526222229003906  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 38, 100]), torch.Size([1, 38, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.16529083251953125  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.16571712493896484  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 38, 100])
m.shape torch.Size([49, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1657576560974121  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1657576560974121  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 49, 100]), torch.Size([1, 49, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.16579484939575195  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.16660451889038086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 49, 100])
m.shape torch.Size([56, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.16666936874389648  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.16666936874389648  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 56, 100]), torch.Size([1, 56, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.16671133041381836  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1679224967956543  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 56, 100])
m.shape torch.Size([73, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.16803789138793945  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.16803789138793945  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 73, 100]), torch.Size([1, 73, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.16809320449829102  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.17006301879882812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 73, 100])
m.shape torch.Size([78, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1702098846435547  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1702098846435547  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 78, 100]), torch.Size([1, 78, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.17026805877685547  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.17276954650878906  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 78, 100])
m.shape torch.Size([113, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1730351448059082  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1730351448059082  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 113, 100]), torch.Size([1, 113, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.17312002182006836  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.17734384536743164  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 113, 100])
m.shape torch.Size([122, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.17766523361206055  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.17766523361206055  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 122, 100]), torch.Size([1, 122, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.17775678634643555  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1829524040222168  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 122, 100])
m.shape torch.Size([119, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1833057403564453  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1833057403564453  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 119, 100]), torch.Size([1, 119, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1833944320678711  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1890707015991211  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 119, 100])
m.shape torch.Size([28655, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2957749366760254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2957749366760254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 28655, 100]), torch.Size([1, 28655, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.3171248435974121  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.832953929901123  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 28655, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.725940227508545  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7539153099060059  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7818903923034668  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7539153099060059  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([29334, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7818903923034668  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.788884162902832  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.788884162902832  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8604512214660645  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8604512214660645  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.860456943511963  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8605427742004395  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.860548973083496  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.860548973083496  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8605546951293945  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8606805801391602  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8606972694396973  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8606972694396973  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8607068061828613  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8609833717346191  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8610076904296875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8610076904296875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8610191345214844  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8614311218261719  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8614859580993652  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8614859580993652  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8615031242370605  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8623614311218262  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8623619079589844  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8623619079589844  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8623638153076172  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8624858856201172  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([6, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8625426292419434  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8625426292419434  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8625540733337402  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8633666038513184  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([12, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8634881973266602  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8634881973266602  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.863511085510254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8652963638305664  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([6, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8653545379638672  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8653545379638672  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.865365982055664  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8663387298583984  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([14, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8665080070495605  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8665080070495605  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.86653470993042  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8689913749694824  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([4, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8690319061279297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8690319061279297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.869039535522461  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8697948455810547  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8698344230651855  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8698344230651855  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.869840145111084  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8704466819763184  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8705363273620605  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8705363273620605  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8705477714538574  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8718409538269043  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8720803260803223  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8720803260803223  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8721089363098145  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.875542163848877  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([3, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.875579833984375  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.875579833984375  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8755855560302734  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.876312255859375  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.876382827758789  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.876382827758789  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8763904571533203  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8774127960205078  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8774476051330566  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8774476051330566  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8774514198303223  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8779892921447754  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8780279159545898  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8780279159545898  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8780317306518555  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.878596305847168  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8786582946777344  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8786582946777344  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8786640167236328  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8795509338378906  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.879835605621338  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.879835605621338  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8798604011535645  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8838772773742676  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8839802742004395  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8839802742004395  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8839898109436035  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.88560152053833  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([2903, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.955350399017334  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.955350399017334  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2903, 256]), torch.Size([1, 2903, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9611716270446777  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.959506034851074  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2903, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.8887081146240234  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.8892383575439453  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.889768600463867  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.8892154693603516  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([3028, 47])
input nodes number: 29334
output nodes number: 3028
edges number: 74307
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.8894643783569336  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.889464855194092  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.057436466217041016  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

pseudo mini batch 47 input nodes size: 144284
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.049864768981933594  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.049864768981933594  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1045522689819336  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.10457468032836914  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.060328006744384766  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06309270858764648  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06309270858764648  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

first layer input nodes number: 144284
first layer output nodes number: 30663
edges number: 302400
----------------------------------------before model layer 0
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06439685821533203  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([144284, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06439685821533203  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([54, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18024396896362305  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18024396896362305  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 54, 100]), torch.Size([1, 54, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18028497695922852  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18060874938964844  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 54, 100])
m.shape torch.Size([54, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18062877655029297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18062877655029297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 54, 100]), torch.Size([1, 54, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18066978454589844  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1812763214111328  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 54, 100])
m.shape torch.Size([82, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18134784698486328  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18134784698486328  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 82, 100]), torch.Size([1, 82, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1814098358154297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18276071548461914  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 82, 100])
m.shape torch.Size([108, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1828908920288086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1828908920288086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 108, 100]), torch.Size([1, 108, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18297195434570312  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18531131744384766  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 108, 100])
m.shape torch.Size([116, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1854872703552246  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1854872703552246  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 116, 100]), torch.Size([1, 116, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18557405471801758  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1886911392211914  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 116, 100])
m.shape torch.Size([124, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18892526626586914  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18892526626586914  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 124, 100]), torch.Size([1, 124, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18901777267456055  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19299554824829102  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 124, 100])
m.shape torch.Size([157, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1933588981628418  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1933588981628418  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 157, 100]), torch.Size([1, 157, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19347620010375977  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19933128356933594  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 157, 100])
m.shape torch.Size([168, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19977331161499023  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19977331161499023  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 168, 100]), torch.Size([1, 168, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19989919662475586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.20704030990600586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 168, 100])
m.shape torch.Size([207, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2076716423034668  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2076716423034668  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 207, 100]), torch.Size([1, 207, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2078261375427246  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.21770095825195312  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 207, 100])
m.shape torch.Size([29593, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.3278665542602539  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.3278665542602539  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 29593, 100]), torch.Size([1, 29593, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.3513040542602539  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9320392608642578  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 29593, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.818408489227295  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.847705364227295  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8769478797912598  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8476510047912598  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([30663, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8769478797912598  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8847603797912598  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.8847603797912598  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([12, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.950775146484375  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.950775146484375  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9507980346679688  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9509811401367188  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9509854316711426  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9509854316711426  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.951000690460205  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9512295722961426  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9512367248535156  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9512367248535156  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9512462615966797  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.951456069946289  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([15, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9515089988708496  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9515089988708496  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9515376091003418  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9523673057556152  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([12, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9524106979370117  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9524106979370117  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9524335861206055  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9532575607299805  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9532694816589355  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9532694816589355  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9532771110534668  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9536051750183105  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([21, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9537429809570312  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9537429809570312  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9537830352783203  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9557857513427734  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.955881118774414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.955881118774414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9559097290039062  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.957540512084961  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([45, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9579157829284668  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9579157829284668  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9580016136169434  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9634947776794434  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([6, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9635095596313477  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9635095596313477  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9635210037231445  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9643335342407227  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9644231796264648  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9644231796264648  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9644403457641602  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9657793045043945  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([41, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9662437438964844  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9662437438964844  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9663219451904297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9729690551757812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([23, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.973217487335205  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.973217487335205  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9732613563537598  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.977297306060791  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([15, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9774775505065918  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9774775505065918  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.977506160736084  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9803385734558105  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([91, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9816365242004395  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9816365242004395  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.9818100929260254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0002083778381348  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.000552177429199  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.000552177429199  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.000605583190918  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0066404342651367  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([22, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0069732666015625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0069732666015625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0070152282714844  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0120506286621094  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0123238563537598  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0123238563537598  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0123562812805176  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0164742469787598  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([57, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0174989700317383  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0174989700317383  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0176076889038086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0321760177612305  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.032583236694336  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.032583236694336  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0326290130615234  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.039083480834961  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0398683547973633  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0398683547973633  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.039944648742676  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.051236152648926  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([29, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0518112182617188  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0518112182617188  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0518665313720703  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0604400634765625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([35, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0611863136291504  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0611863136291504  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.061253070831299  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0720677375793457  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([29, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0727033615112305  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0727033615112305  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.072758674621582  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.082106590270996  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([2379, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.139242172241211  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.139242172241211  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2379, 256]), torch.Size([1, 2379, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.143779754638672  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.9505081176757812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2379, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.8857531547546387  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.886275291442871  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.8867974281311035  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.8862528800964355  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([2982, 47])
input nodes number: 30663
output nodes number: 2982
edges number: 68529
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.886496067047119  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.8864965438842773  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06815624237060547  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

pseudo mini batch 48 input nodes size: 85656
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06031990051269531  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06031990051269531  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.09222936630249023  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.09225225448608398  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.03754234313964844  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.040099143981933594  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.040099143981933594  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

first layer input nodes number: 85656
first layer output nodes number: 27039
edges number: 267083
----------------------------------------before model layer 0
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.0409393310546875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([85656, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.0409393310546875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([37, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.14325284957885742  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.14325284957885742  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 37, 100]), torch.Size([1, 37, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1432805061340332  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.14350175857543945  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 37, 100])
m.shape torch.Size([56, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.14352989196777344  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.14352989196777344  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 56, 100]), torch.Size([1, 56, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1435718536376953  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.14419841766357422  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 56, 100])
m.shape torch.Size([76, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.14426279067993164  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.14426279067993164  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 76, 100]), torch.Size([1, 76, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.14432001113891602  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1455702781677246  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 76, 100])
m.shape torch.Size([80, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1456608772277832  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1456608772277832  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 80, 100]), torch.Size([1, 80, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1457209587097168  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.14745187759399414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 80, 100])
m.shape torch.Size([96, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.14760065078735352  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.14760065078735352  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 96, 100]), torch.Size([1, 96, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.14767217636108398  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.15024709701538086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 96, 100])
m.shape torch.Size([103, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.15044164657592773  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.15044164657592773  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 103, 100]), torch.Size([1, 103, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.15051889419555664  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1538233757019043  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 103, 100])
m.shape torch.Size([90, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.15401983261108398  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.15401983261108398  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 90, 100]), torch.Size([1, 90, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.15408754348754883  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.15745306015014648  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 90, 100])
m.shape torch.Size([120, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1577768325805664  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1577768325805664  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 120, 100]), torch.Size([1, 120, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1578664779663086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1629648208618164  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 120, 100])
m.shape torch.Size([112, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.16329574584960938  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.16329574584960938  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 112, 100]), torch.Size([1, 112, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.16337966918945312  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.16872501373291016  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 112, 100])
m.shape torch.Size([26269, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.266542911529541  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.266542911529541  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 26269, 100]), torch.Size([1, 26269, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2861151695251465  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.6757311820983887  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 26269, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.5760102272033691  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.6017966270446777  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.6275830268859863  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.6017966270446777  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([27039, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.6275830268859863  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.6340298652648926  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.6340298652648926  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7072219848632812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7072219848632812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.707223892211914  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7072391510009766  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.707242488861084  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.707242488861084  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7072463035583496  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.707303524017334  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7073049545288086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7073049545288086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7073068618774414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7073488235473633  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7073521614074707  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7073521614074707  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7073540687561035  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.707409381866455  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.707413673400879  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.707413673400879  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7074155807495117  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.707484245300293  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.707526683807373  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.707526683807373  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.707536220550537  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.708146572113037  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([2, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7081632614135742  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7081632614135742  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7081670761108398  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7084646224975586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7084746360778809  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7084746360778809  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7084765434265137  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7086386680603027  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7086505889892578  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7086505889892578  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7086524963378906  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7088279724121094  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7088704109191895  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7088704109191895  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.708876132965088  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7094826698303223  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7095413208007812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7095413208007812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7095489501953125  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7104110717773438  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7104620933532715  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7104620933532715  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.71046781539917  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7112345695495605  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.711252212524414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.711252212524414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7112541198730469  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7115364074707031  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7115778923034668  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7115778923034668  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7115817070007324  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7121729850769043  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7122154235839844  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7122154235839844  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.71221923828125  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7128372192382812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.712904930114746  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.712904930114746  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7129106521606445  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7138776779174805  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3022, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7867035865783691  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7867035865783691  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3022, 256]), torch.Size([1, 3022, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 1.7924675941467285  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.8109383583068848  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3022, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.738402843475342  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.7389378547668457  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.7394728660583496  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.738914966583252  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([3055, 47])
input nodes number: 27039
output nodes number: 3055
edges number: 76008
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.739152431488037  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.7391529083251953  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.044513702392578125  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

pseudo mini batch 49 input nodes size: 121190
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.03755521774291992  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.03755521774291992  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.0827021598815918  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.08272600173950195  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.05079364776611328  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.053905487060546875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.053905487060546875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

first layer input nodes number: 121190
first layer output nodes number: 34066
edges number: 338713
----------------------------------------before model layer 0
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.05506277084350586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([121190, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.05506277084350586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([24, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1848154067993164  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1848154067993164  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 24, 100]), torch.Size([1, 24, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18483352661132812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18497705459594727  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 24, 100])
m.shape torch.Size([27, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18498849868774414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18498849868774414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 27, 100]), torch.Size([1, 27, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18500947952270508  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18531560897827148  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 27, 100])
m.shape torch.Size([41, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18535137176513672  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18535137176513672  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 41, 100]), torch.Size([1, 41, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18538284301757812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18606233596801758  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 41, 100])
m.shape torch.Size([50, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18612146377563477  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18612146377563477  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 50, 100]), torch.Size([1, 50, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18615961074829102  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18724870681762695  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 50, 100])
m.shape torch.Size([55, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1873321533203125  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1873321533203125  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 55, 100]), torch.Size([1, 55, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18737316131591797  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18884944915771484  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 55, 100])
m.shape torch.Size([59, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18896102905273438  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18896102905273438  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 59, 100]), torch.Size([1, 59, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.18900585174560547  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19090747833251953  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 59, 100])
m.shape torch.Size([67, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19106006622314453  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19106006622314453  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 67, 100]), torch.Size([1, 67, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19111061096191406  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1936178207397461  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 67, 100])
m.shape torch.Size([70, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1938014030456543  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1938014030456543  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 70, 100]), torch.Size([1, 70, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19385385513305664  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19683218002319336  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 70, 100])
m.shape torch.Size([76, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19706106185913086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19706106185913086  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 76, 100]), torch.Size([1, 76, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19711828231811523  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.20075464248657227  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 76, 100])
m.shape torch.Size([33597, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.3258848190307617  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.3258848190307617  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 33597, 100]), torch.Size([1, 33597, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.35091686248779297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1281776428222656  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 33597, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0015273094177246  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.03401517868042  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0665030479431152  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.03401517868042  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([34066, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0665030479431152  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.074625015258789  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.074625015258789  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([7, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1505656242370605  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1505656242370605  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1505789756774902  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1517138481140137  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([1, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1517200469970703  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1517200469970703  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.151721954345703  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.151897430419922  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1519103050231934  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1519103050231934  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.151912212371826  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1521010398864746  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1521148681640625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1521148681640625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1521167755126953  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1523189544677734  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1523356437683105  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1523356437683105  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1523375511169434  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1525797843933105  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.152615547180176  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.152615547180176  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1526193618774414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.153130531311035  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1531481742858887  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1531481742858887  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1531500816345215  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.153419017791748  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.153458595275879  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.153458595275879  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1534624099731445  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.154026985168457  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1541175842285156  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1541175842285156  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.154125213623047  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.155414581298828  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3138, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.23081111907959  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.23081111907959  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3138, 256]), torch.Size([1, 3138, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2381553649902344  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.293271064758301  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3138, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.2180776596069336  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.218630790710449  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.219183921813965  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.218606948852539  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([3158, 47])
input nodes number: 34066
output nodes number: 3158
edges number: 78790
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.218903064727783  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.2189035415649414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.05933952331542969  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

pseudo mini batch 50 input nodes size: 127415
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.050811767578125  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.050811767578125  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.09827756881713867  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.09830141067504883  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.0531306266784668  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.05635213851928711  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.05635213851928711  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

first layer input nodes number: 127415
first layer output nodes number: 35524
edges number: 353406
----------------------------------------before model layer 0
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.05756664276123047  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([127415, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.05756664276123047  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([36, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19293642044067383  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19293642044067383  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 36, 100]), torch.Size([1, 36, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1929640769958496  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19318103790283203  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 36, 100])
m.shape torch.Size([53, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.193206787109375  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.193206787109375  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 53, 100]), torch.Size([1, 53, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19324684143066406  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19384193420410156  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 53, 100])
m.shape torch.Size([24, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1938490867614746  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1938490867614746  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 24, 100]), torch.Size([1, 24, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19386720657348633  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1942615509033203  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 24, 100])
m.shape torch.Size([37, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19430780410766602  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19430780410766602  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 37, 100]), torch.Size([1, 37, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1943354606628418  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19513750076293945  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 37, 100])
m.shape torch.Size([38, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19519472122192383  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19519472122192383  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 38, 100]), torch.Size([1, 38, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19522333145141602  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19624614715576172  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 38, 100])
m.shape torch.Size([48, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19633913040161133  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19633913040161133  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 48, 100]), torch.Size([1, 48, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19637537002563477  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19791650772094727  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 48, 100])
m.shape torch.Size([44, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1980133056640625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1980133056640625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 44, 100]), torch.Size([1, 44, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19804668426513672  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19969558715820312  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 44, 100])
m.shape torch.Size([54, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19984006881713867  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19984006881713867  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 54, 100]), torch.Size([1, 54, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.19988107681274414  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.20218420028686523  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 54, 100])
m.shape torch.Size([74, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.20241212844848633  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.20241212844848633  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 74, 100]), torch.Size([1, 74, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2024674415588379  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2060074806213379  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 74, 100])
m.shape torch.Size([35116, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.33679723739624023  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.33679723739624023  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 35116, 100]), torch.Size([1, 35116, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.3629612922668457  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2291321754455566  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 35116, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.0969595909118652  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.130837917327881  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1647162437438965  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.130837917327881  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([35524, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1647162437438965  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1731858253479004  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.1731858253479004  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.250091075897217  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.250091075897217  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2500929832458496  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2502284049987793  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2502593994140625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2502593994140625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.250265121459961  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.250711441040039  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2507433891296387  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2507433891296387  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.250749111175537  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2512354850769043  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2512454986572266  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2512454986572266  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2512474060058594  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.251422882080078  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2514491081237793  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2514491081237793  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.251452922821045  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.251830577850342  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2518577575683594  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2518577575683594  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.251861572265625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2522659301757812  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.252333641052246  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.252333641052246  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2523412704467773  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.253310203552246  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2533249855041504  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2533249855041504  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.253326892852783  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.25358247756958  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.25360107421875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.25360107421875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.253602981567383  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2538719177246094  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.253913402557373  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.253913402557373  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2539172172546387  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2545084953308105  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2545528411865234  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2545528411865234  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.254556655883789  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2552013397216797  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3141, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.330671787261963  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.330671787261963  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3141, 256]), torch.Size([1, 3141, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.3371338844299316  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.403446674346924  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3141, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.3271994590759277  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.3277535438537598  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.328307628631592  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.3277297019958496  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([3163, 47])
input nodes number: 35524
output nodes number: 3163
edges number: 78878
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.328019618988037  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.3280200958251953  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06194591522216797  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

pseudo mini batch 51 input nodes size: 158065
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.0531315803527832  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.0531315803527832  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.1120157241821289  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.11203956604003906  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06454992294311523  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06794595718383789  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06794595718383789  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

first layer input nodes number: 158065
first layer output nodes number: 38038
edges number: 377670
----------------------------------------before model layer 0
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06940746307373047  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([158065, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.06940746307373047  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([47, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.21524286270141602  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.21524286270141602  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 47, 100]), torch.Size([1, 47, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.21527814865112305  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2155590057373047  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 47, 100])
m.shape torch.Size([47, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2155766487121582  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2155766487121582  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 47, 100]), torch.Size([1, 47, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.21561193466186523  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.21613836288452148  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 47, 100])
m.shape torch.Size([48, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.21617460250854492  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.21617460250854492  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 48, 100]), torch.Size([1, 48, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.21621084213256836  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.21699953079223633  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 48, 100])
m.shape torch.Size([59, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2170696258544922  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2170696258544922  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 59, 100]), torch.Size([1, 59, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.21711444854736328  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2183971405029297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 59, 100])
m.shape torch.Size([66, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.21849775314331055  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.21849775314331055  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 66, 100]), torch.Size([1, 66, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.21854734420776367  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.22032546997070312  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 66, 100])
m.shape torch.Size([97, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.22051763534545898  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.22051763534545898  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 97, 100]), torch.Size([1, 97, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.22059011459350586  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.22370672225952148  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 97, 100])
m.shape torch.Size([72, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.22385835647583008  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.22385835647583008  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 72, 100]), torch.Size([1, 72, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.22391271591186523  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.22660064697265625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 72, 100])
m.shape torch.Size([90, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.22684192657470703  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.22684192657470703  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 90, 100]), torch.Size([1, 90, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.22690963745117188  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.23074626922607422  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 90, 100])
m.shape torch.Size([107, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.23107147216796875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.23107147216796875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 107, 100]), torch.Size([1, 107, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.23115158081054688  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.2362656593322754  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 107, 100])
m.shape torch.Size([37405, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.37557029724121094  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.37557029724121094  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 37405, 100]), torch.Size([1, 37405, 100])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 0.4034395217895508  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.3821401596069336  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 37405, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2409653663635254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2780747413635254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.3151841163635254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.2780747413635254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([38038, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.3151841163635254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.3242530822753906  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.3242530822753906  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.3993735313415527  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.3993735313415527  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.3993868827819824  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.3996806144714355  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([1, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.399679183959961  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.399679183959961  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.3996810913085938  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.399749755859375  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.3997607231140137  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.3997607231140137  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.3997645378112793  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.399928569793701  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.399942398071289  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.399942398071289  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.3999462127685547  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4001636505126953  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.400179386138916  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.400179386138916  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4001832008361816  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4004273414611816  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.400454521179199  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.400454521179199  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4004602432250977  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4008665084838867  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4008755683898926  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4008755683898926  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4008774757385254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4010396003723145  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.401101589202881  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.401101589202881  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.401111125946045  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4019885063171387  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([1, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4019975662231445  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4019975662231445  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4019994735717773  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.402188301086426  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4022164344787598  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4022164344787598  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4022202491760254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4026246070861816  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.402653694152832  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.402653694152832  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4026575088500977  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4030885696411133  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4031214714050293  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4031214714050293  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.403125286102295  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4036097526550293  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.403644561767578  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.403644561767578  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4036483764648438  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4041595458984375  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4042153358459473  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4042153358459473  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4042210578918457  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4050278663635254  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.405186653137207  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.405186653137207  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4052019119262695  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4074602127075195  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([2, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4074950218200684  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4074950218200684  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.407498836517334  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.408090114593506  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.408198833465576  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.408198833465576  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4082083702087402  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4097533226013184  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4098410606384277  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4098410606384277  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.409848690032959  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.4111380577087402  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3087, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.48530912399292  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.48530912399292  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3087, 256]), torch.Size([1, 3087, 256])
----------------------------------------3
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 2.492300510406494  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.53084659576416  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3087, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.4561924934387207  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.456742763519287  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.4572930335998535  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.456718921661377  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([3141, 47])
input nodes number: 38038
output nodes number: 3141
edges number: 77987
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.4570226669311523  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3533935546875 GB
    Memory Allocated: 3.4570231437683105  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.4295654296875 GB
    Memory Allocated: 0.07515382766723633  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

pseudo mini batch 52 input nodes size: 142813
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.4295654296875 GB
    Memory Allocated: 0.06454610824584961  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.4295654296875 GB
    Memory Allocated: 0.06454610824584961  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.4295654296875 GB
    Memory Allocated: 0.11774826049804688  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.4295654296875 GB
    Memory Allocated: 0.11777162551879883  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.4295654296875 GB
    Memory Allocated: 0.05886363983154297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.4295654296875 GB
    Memory Allocated: 0.06250381469726562  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.4295654296875 GB
    Memory Allocated: 0.06250381469726562  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

first layer input nodes number: 142813
first layer output nodes number: 41308
edges number: 410411
----------------------------------------before model layer 0
 Nvidia-smi: 8.4295654296875 GB
    Memory Allocated: 0.06429719924926758  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([142813, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.4295654296875 GB
    Memory Allocated: 0.06429719924926758  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([30, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.2214951515197754  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.2214951515197754  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 30, 100]), torch.Size([1, 30, 100])
----------------------------------------3
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.22151803970336914  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.22169828414916992  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 30, 100])
m.shape torch.Size([48, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.22172260284423828  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.22172260284423828  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 48, 100]), torch.Size([1, 48, 100])
----------------------------------------3
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.22175884246826172  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.22229671478271484  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 48, 100])
m.shape torch.Size([46, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.22233009338378906  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.22233009338378906  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 46, 100]), torch.Size([1, 46, 100])
----------------------------------------3
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.2223644256591797  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.22311973571777344  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 46, 100])
m.shape torch.Size([71, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.22320842742919922  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.22320842742919922  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 71, 100]), torch.Size([1, 71, 100])
----------------------------------------3
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.22326183319091797  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.22479915618896484  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 71, 100])
m.shape torch.Size([60, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.2248845100402832  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.2248845100402832  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 60, 100]), torch.Size([1, 60, 100])
----------------------------------------3
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.2249293327331543  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.22654294967651367  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 60, 100])
m.shape torch.Size([94, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.2267308235168457  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.2267308235168457  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 94, 100]), torch.Size([1, 94, 100])
----------------------------------------3
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.22680139541625977  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.22981882095336914  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 94, 100])
m.shape torch.Size([84, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.23000288009643555  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.23000288009643555  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 84, 100]), torch.Size([1, 84, 100])
----------------------------------------3
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.23006582260131836  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.23320293426513672  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 84, 100])
m.shape torch.Size([107, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.2334904670715332  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.2334904670715332  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 107, 100]), torch.Size([1, 107, 100])
----------------------------------------3
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.23357057571411133  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.23812532424926758  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 107, 100])
m.shape torch.Size([125, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.23850440979003906  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.23850440979003906  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 125, 100]), torch.Size([1, 125, 100])
----------------------------------------3
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.23859786987304688  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5838623046875 GB
    Memory Allocated: 0.2445664405822754  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 125, 100])
m.shape torch.Size([40643, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.7362060546875 GB
    Memory Allocated: 0.3968634605407715  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.7362060546875 GB
    Memory Allocated: 0.3968634605407715  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 40643, 100]), torch.Size([1, 40643, 100])
----------------------------------------3
 Nvidia-smi: 8.7362060546875 GB
    Memory Allocated: 0.42714548110961914  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5789952278137207  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 40643, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.425574779510498  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4649691581726074  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.504363536834717  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4649691581726074  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

torch.Size([41308, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.504363536834717  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.514212131500244  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.514212131500244  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.589351177215576  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.589351177215576  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.589353084564209  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.589395046234131  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5893993377685547  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5893993377685547  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5894012451171875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5894699096679688  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5894789695739746  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5894789695739746  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5894808769226074  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.589616298675537  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([6, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.58967924118042  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.58967924118042  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.589690685272217  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.590583324432373  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.590618133544922  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.590618133544922  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5906238555908203  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5911903381347656  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5912022590637207  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5912022590637207  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5912041664123535  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5914063453674316  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.591421127319336  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.591421127319336  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5914230346679688  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5916385650634766  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5916552543640137  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5916552543640137  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5916571617126465  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5918993949890137  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.591917037963867  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.591917037963867  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5919189453125  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.592174530029297  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.592231273651123  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.592231273651123  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5922369956970215  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.593043804168701  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5930614471435547  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5930614471435547  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5930633544921875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5933456420898438  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5934295654296875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5934295654296875  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5934371948242188  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5946197509765625  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5946383476257324  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5946383476257324  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5946402549743652  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.594949245452881  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5950636863708496  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5950636863708496  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5950732231140137  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5966849327087402  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3101, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.671191692352295  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.671191692352295  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

 h.shape torch.Size([1, 3101, 256]), torch.Size([1, 3101, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.6771063804626465  GigaBytes
Max Memory Allocated: 3.676852226257324  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.7180914878845215  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3101, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.643624782562256  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.6441731452941895  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.644721508026123  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.6441497802734375  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([3131, 47])
input nodes number: 41308
output nodes number: 3131
edges number: 78031
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.644479274749756  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.644479751586914  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.0691685676574707  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

pseudo mini batch 53 input nodes size: 112661
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.058861732482910156  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.058861732482910156  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.10083150863647461  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.10085487365722656  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.047629356384277344  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.050774574279785156  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.050774574279785156  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

first layer input nodes number: 112661
first layer output nodes number: 34728
edges number: 344876
----------------------------------------before model layer 0
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.051873207092285156  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([112661, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.051873207092285156  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([28, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18488788604736328  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18488788604736328  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 28, 100]), torch.Size([1, 28, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18490886688232422  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18507671356201172  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 28, 100])
m.shape torch.Size([38, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18509483337402344  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18509483337402344  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 38, 100]), torch.Size([1, 38, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18512344360351562  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18554973602294922  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 38, 100])
m.shape torch.Size([44, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18558502197265625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18558502197265625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 44, 100]), torch.Size([1, 44, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18561840057373047  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18634414672851562  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 44, 100])
m.shape torch.Size([47, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18639755249023438  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18639755249023438  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 47, 100]), torch.Size([1, 47, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1864328384399414  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18745040893554688  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 47, 100])
m.shape torch.Size([79, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18758010864257812  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18758010864257812  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 79, 100]), torch.Size([1, 79, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1876392364501953  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18976068496704102  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 79, 100])
m.shape torch.Size([69, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18988561630249023  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18988561630249023  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 69, 100]), torch.Size([1, 69, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18993711471557617  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.19215154647827148  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 69, 100])
m.shape torch.Size([102, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.19239187240600586  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.19239187240600586  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 102, 100]), torch.Size([1, 102, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.19246816635131836  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1962728500366211  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 102, 100])
m.shape torch.Size([85, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1964883804321289  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1964883804321289  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 85, 100]), torch.Size([1, 85, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.19655227661132812  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20017147064208984  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 85, 100])
m.shape torch.Size([111, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20051193237304688  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20051193237304688  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 111, 100]), torch.Size([1, 111, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20059490203857422  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20589208602905273  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 111, 100])
m.shape torch.Size([34125, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.3329763412475586  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.3329763412475586  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 34125, 100]), torch.Size([1, 34125, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.3584022521972656  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1635990142822266  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 34125, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0342612266540527  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.067380428314209  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1004996299743652  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.067380428314209  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([34728, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1004996299743652  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1087794303894043  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1087794303894043  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.183703899383545  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.183703899383545  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1837058067321777  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1837210655212402  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.183730125427246  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.183730125427246  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1837339401245117  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.183871269226074  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.18388032913208  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.18388032913208  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.183882236480713  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1840310096740723  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1840438842773438  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1840438842773438  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1840457916259766  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.184234619140625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.184248447418213  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.184248447418213  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1842503547668457  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.184452533721924  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.184469223022461  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.184469223022461  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1844711303710938  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.184713363647461  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.184749126434326  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.184749126434326  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.184752941131592  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1852641105651855  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.185281753540039  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.185281753540039  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.185283660888672  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1855525970458984  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3082, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.2603445053100586  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.2603445053100586  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3082, 256]), torch.Size([1, 3082, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.26762056350708  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.327758312225342  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3082, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.2525386810302734  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.253080368041992  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.253622055053711  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.2530570030212402  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([3092, 47])
input nodes number: 34728
output nodes number: 3092
edges number: 77177
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.2533326148986816  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.25333309173584  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.0566248893737793  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

pseudo mini batch 54 input nodes size: 121067
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.0476226806640625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.0476226806640625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.09272384643554688  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.09274768829345703  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.050754547119140625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.05349922180175781  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.05349922180175781  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

first layer input nodes number: 121067
first layer output nodes number: 29927
edges number: 291323
----------------------------------------before model layer 0
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.05462455749511719  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([121067, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.05462455749511719  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([69, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.16624784469604492  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.16624784469604492  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 69, 100]), torch.Size([1, 69, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.16629934310913086  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.16671133041381836  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 69, 100])
m.shape torch.Size([102, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1667618751525879  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1667618751525879  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 102, 100]), torch.Size([1, 102, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1668381690979004  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.16797971725463867  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 102, 100])
m.shape torch.Size([147, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1681060791015625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1681060791015625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 147, 100]), torch.Size([1, 147, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.16821575164794922  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17062854766845703  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 147, 100])
m.shape torch.Size([191, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17085838317871094  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17085838317871094  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 191, 100]), torch.Size([1, 191, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17100143432617188  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17513275146484375  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 191, 100])
m.shape torch.Size([258, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17554187774658203  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17554187774658203  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 258, 100]), torch.Size([1, 258, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1757345199584961  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1826624870300293  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 258, 100])
m.shape torch.Size([303, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1832437515258789  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1832437515258789  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 303, 100]), torch.Size([1, 303, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1834697723388672  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.19318008422851562  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 303, 100])
m.shape torch.Size([298, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.19384431838989258  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.19384431838989258  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 298, 100]), torch.Size([1, 298, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.19406652450561523  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20517683029174805  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 298, 100])
m.shape torch.Size([325, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20603466033935547  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20603466033935547  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 325, 100]), torch.Size([1, 325, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20627689361572266  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22008419036865234  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 325, 100])
m.shape torch.Size([289, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2209324836730957  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2209324836730957  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 289, 100]), torch.Size([1, 289, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22114801406860352  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23494195938110352  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 289, 100])
m.shape torch.Size([27945, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.33893775939941406  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.33893775939941406  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 27945, 100]), torch.Size([1, 27945, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.3597593307495117  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8523674011230469  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 27945, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.7444696426391602  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.7737665176391602  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.80230712890625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.77301025390625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([29927, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.80230712890625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8086862564086914  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8086862564086914  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8836307525634766  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8836307525634766  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8836326599121094  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8836479187011719  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8836512565612793  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8836512565612793  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.883655071258545  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8837122917175293  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8837194442749023  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8837194442749023  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8837251663208008  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8838510513305664  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8838601112365723  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8838601112365723  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8838658332824707  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8840317726135254  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8840675354003906  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8840675354003906  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8840827941894531  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8846321105957031  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.884636402130127  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.884636402130127  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8846402168273926  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8848042488098145  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([8, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8848562240600586  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8848562240600586  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.884871482849121  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.885634422302246  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8856964111328125  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8856964111328125  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8857135772705078  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8866920471191406  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.886770248413086  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.886770248413086  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.886789321899414  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.888010025024414  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([14, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8881354331970215  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8881354331970215  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8881621360778809  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8900580406188965  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([6, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.890108585357666  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.890108585357666  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.890120029449463  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8910126686096191  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.891099452972412  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.891099452972412  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8911147117614746  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.892411708831787  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([5, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8924670219421387  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8924670219421387  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8924765586853027  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8933539390563965  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.893470287322998  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.893470287322998  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8934874534606934  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8951869010925293  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8952507972717285  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8952507972717285  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8952603340148926  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8962712287902832  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([11, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8964357376098633  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8964357376098633  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8964567184448242  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8988275527954102  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8989806175231934  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8989806175231934  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.8989996910095215  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9012885093688965  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([13, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9015040397644043  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9015040397644043  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9015288352966309  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9046778678894043  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9048848152160645  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9048848152160645  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9049077033996582  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9079747200012207  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9082326889038086  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9082326889038086  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.908259391784668  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9120244979858398  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9121928215026855  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9121928215026855  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9122099876403809  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.914750576019287  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9150381088256836  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9150381088256836  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.915064811706543  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.919203758239746  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9194560050964355  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9194560050964355  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9194788932800293  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9231867790222168  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9234752655029297  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9234752655029297  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9235000610351562  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9276905059814453  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([2959, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9987773895263672  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9987773895263672  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2959, 256]), torch.Size([1, 2959, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0048913955688477  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.015984535217285  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2959, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.941866874694824  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.942420482635498  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.942974090576172  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.942396640777588  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([3160, 47])
input nodes number: 29927
output nodes number: 3160
edges number: 77012
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.942655563354492  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.9426560401916504  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.058437347412109375  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

pseudo mini batch 55 input nodes size: 159043
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.0507664680480957  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.0507664680480957  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1100149154663086  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.11003875732421875  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06491374969482422  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06830024719238281  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06830024719238281  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

first layer input nodes number: 159043
first layer output nodes number: 38281
edges number: 376844
----------------------------------------before model layer 0
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06977128982543945  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([159043, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06977128982543945  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([47, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2143712043762207  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2143712043762207  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 47, 100]), torch.Size([1, 47, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21440649032592773  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21468734741210938  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 47, 100])
m.shape torch.Size([94, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21473979949951172  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21473979949951172  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 94, 100]), torch.Size([1, 94, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21481037139892578  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21586322784423828  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 94, 100])
m.shape torch.Size([103, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2159433364868164  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2159433364868164  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 103, 100]), torch.Size([1, 103, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2160205841064453  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2177114486694336  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 103, 100])
m.shape torch.Size([174, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21793222427368164  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21793222427368164  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 174, 100]), torch.Size([1, 174, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2180619239807129  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22182321548461914  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 174, 100])
m.shape torch.Size([188, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2221088409423828  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2221088409423828  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 188, 100]), torch.Size([1, 188, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22224903106689453  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2272958755493164  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 188, 100])
m.shape torch.Size([199, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22767066955566406  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22767066955566406  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 199, 100]), torch.Size([1, 199, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22781944274902344  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23419952392578125  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 199, 100])
m.shape torch.Size([211, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23467540740966797  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23467540740966797  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 211, 100]), torch.Size([1, 211, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.234832763671875  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.24270057678222656  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 211, 100])
m.shape torch.Size([226, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.24329566955566406  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.24329566955566406  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 226, 100]), torch.Size([1, 226, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.24346446990966797  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.25307464599609375  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 226, 100])
m.shape torch.Size([205, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2536778450012207  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2536778450012207  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 205, 100]), torch.Size([1, 205, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2538313865661621  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.26361942291259766  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 205, 100])
m.shape torch.Size([36834, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.4007601737976074  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.4007601737976074  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 36834, 100]), torch.Size([1, 36834, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.4282040596008301  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3767056465148926  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 36834, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.235898494720459  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.2726082801818848  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3095178604125977  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.272808074951172  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([38281, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3095178604125977  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.318844795227051  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.318844795227051  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3934412002563477  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3934412002563477  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3934431076049805  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.393458366394043  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3934597969055176  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3934597969055176  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3934617042541504  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3934903144836426  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.393495559692383  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.393495559692383  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3934993743896484  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.393583297729492  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.393585681915283  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.393585681915283  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.393587589263916  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3936429023742676  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3936614990234375  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3936614990234375  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3936691284179688  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3939437866210938  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3939576148986816  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3939576148986816  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.39396333694458  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.394209384918213  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.394247055053711  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.394247055053711  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.394258499145508  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3948307037353516  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.394871234893799  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.394871234893799  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3948826789855957  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3955349922180176  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3955469131469727  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3955469131469727  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3955507278442383  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3957948684692383  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([7, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3958606719970703  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3958606719970703  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3958740234375  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.396821975708008  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3968682289123535  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3968682289123535  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3968777656555176  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3976216316223145  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.397709369659424  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.397709369659424  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3977246284484863  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.399021625518799  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([2, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3990392684936523  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3990392684936523  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.399043083190918  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3993940353393555  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.39943265914917  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.39943265914917  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3994383811950684  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4000048637390137  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.400031089782715  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.400031089782715  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4000349044799805  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4004392623901367  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([9, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.400576114654541  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.400576114654541  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4005932807922363  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4025330543518066  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([2, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.402557373046875  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.402557373046875  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4025611877441406  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4030189514160156  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.403069019317627  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.403069019317627  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4030747413635254  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.403801441192627  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4039082527160645  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4039082527160645  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4039196968078613  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4054532051086426  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4055824279785156  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4055824279785156  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4055957794189453  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4074783325195312  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4075927734375  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4075927734375  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.407604217529297  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4092979431152344  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.409440517425537  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.409440517425537  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.409453868865967  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4115233421325684  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4116272926330566  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4116272926330566  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4116368293762207  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.413181781768799  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.413292407989502  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.413292407989502  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.413301944732666  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4149136543273926  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3039, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4879307746887207  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4879307746887207  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3039, 256]), torch.Size([1, 3039, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.495293617248535  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.5241923332214355  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3039, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.4503331184387207  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.450883388519287  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.4514336585998535  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.450859546661377  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([3142, 47])
input nodes number: 38281
output nodes number: 3142
edges number: 77454
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.4511656761169434  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.4511661529541016  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.0743398666381836  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

pseudo mini batch 56 input nodes size: 188778
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.0649104118347168  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.0649104118347168  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.13523578643798828  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.13525819778442383  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.07598590850830078  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.0799717903137207  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.0799717903137207  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

first layer input nodes number: 188778
first layer output nodes number: 40361
edges number: 400017
----------------------------------------before model layer 0
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.0816793441772461  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([188778, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.0816793441772461  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([40, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23490571975708008  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23490571975708008  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 40, 100]), torch.Size([1, 40, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23493623733520508  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23517608642578125  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 40, 100])
m.shape torch.Size([56, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23520278930664062  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23520278930664062  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 56, 100]), torch.Size([1, 56, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2352447509765625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2358713150024414  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 56, 100])
m.shape torch.Size([68, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23592662811279297  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23592662811279297  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 68, 100]), torch.Size([1, 68, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2359781265258789  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23709821701049805  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 68, 100])
m.shape torch.Size([69, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23717546463012695  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23717546463012695  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 69, 100]), torch.Size([1, 69, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2372269630432129  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23872041702270508  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 69, 100])
m.shape torch.Size([108, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23889589309692383  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23889589309692383  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 108, 100]), torch.Size([1, 108, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23897695541381836  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2418808937072754  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 108, 100])
m.shape torch.Size([112, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.24209070205688477  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.24209070205688477  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 112, 100]), torch.Size([1, 112, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.24217462539672852  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.24576616287231445  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 112, 100])
m.shape torch.Size([133, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.24607133865356445  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.24607133865356445  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 133, 100]), torch.Size([1, 133, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2461705207824707  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2511296272277832  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 133, 100])
m.shape torch.Size([161, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2515602111816406  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2515602111816406  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 161, 100]), torch.Size([1, 161, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2516803741455078  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2585296630859375  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 161, 100])
m.shape torch.Size([186, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2590932846069336  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2590932846069336  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 186, 100]), torch.Size([1, 186, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2592325210571289  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.26811790466308594  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 186, 100])
m.shape torch.Size([39428, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.4149293899536133  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.4149293899536133  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 39428, 100]), torch.Size([1, 39428, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.4443063735961914  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.533140182495117  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 39428, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3837075233459473  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.42219877243042  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4606900215148926  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.42219877243042  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([40361, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4606900215148926  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.47031307220459  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.47031307220459  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5419325828552246  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5419325828552246  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5419344902038574  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5419631004333496  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.541966438293457  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.541966438293457  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.54196834564209  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5420236587524414  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.542053699493408  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.542053699493408  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5420613288879395  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5424962043762207  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.542501449584961  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.542501449584961  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5425033569335938  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5426254272460938  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5426459312438965  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5426459312438965  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.542649745941162  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.542947292327881  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.542980194091797  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.542980194091797  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5429859161376953  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5434722900390625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5435194969177246  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5435194969177246  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.543527126312256  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.544229030609131  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.544252395629883  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.544252395629883  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5442562103271484  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5446338653564453  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.544661045074463  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.544661045074463  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5446648597717285  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5450692176818848  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.545098304748535  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.545098304748535  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.545102119445801  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5455331802368164  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5456295013427734  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5456295013427734  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5456409454345703  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5470142364501953  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5470433235168457  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5470433235168457  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5470471382141113  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5475316047668457  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5475664138793945  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5475664138793945  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.54757022857666  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.548081398010254  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5481181144714355  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5481181144714355  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.548121929168701  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5486598014831543  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.548678398132324  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.548678398132324  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.548680305480957  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5489625930786133  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([7, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.549109935760498  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.549109935760498  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5491232872009277  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5511927604675293  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.551319122314453  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.551319122314453  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.55133056640625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5531845092773438  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5533175468444824  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5533175468444824  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5533289909362793  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.555263042449951  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2938, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.625852108001709  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.625852108001709  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2938, 256]), torch.Size([1, 2938, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.631455898284912  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.642970561981201  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2938, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.5720162391662598  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.572540283203125  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.5730643272399902  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.5725178718566895  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([2992, 47])
input nodes number: 40361
output nodes number: 2992
edges number: 74370
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.57281494140625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.572815418243408  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.0863804817199707  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

pseudo mini batch 57 input nodes size: 146291
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.07595968246459961  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.07595968246459961  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1306471824645996  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.13067102432250977  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.060323238372802734  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06371831893920898  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06371831893920898  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

first layer input nodes number: 146291
first layer output nodes number: 38002
edges number: 376903
----------------------------------------before model layer 0
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06509160995483398  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([146291, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06509160995483398  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([39, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20967960357666016  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20967960357666016  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 39, 100]), torch.Size([1, 39, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20970916748046875  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20994281768798828  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 39, 100])
m.shape torch.Size([67, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2099781036376953  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2099781036376953  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 67, 100]), torch.Size([1, 67, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21002864837646484  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21078109741210938  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 67, 100])
m.shape torch.Size([55, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2108173370361328  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2108173370361328  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 55, 100]), torch.Size([1, 55, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21085834503173828  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2117605209350586  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 55, 100])
m.shape torch.Size([66, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2118387222290039  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2118387222290039  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 66, 100]), torch.Size([1, 66, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21188831329345703  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21332073211669922  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 66, 100])
m.shape torch.Size([77, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2134394645690918  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2134394645690918  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 77, 100]), torch.Size([1, 77, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21349763870239258  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21557044982910156  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 77, 100])
m.shape torch.Size([80, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21572017669677734  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21572017669677734  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 80, 100]), torch.Size([1, 80, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21578025817871094  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21834659576416016  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 80, 100])
m.shape torch.Size([119, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2186269760131836  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2186269760131836  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 119, 100]), torch.Size([1, 119, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21871566772460938  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22315025329589844  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 119, 100])
m.shape torch.Size([122, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22346973419189453  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22346973419189453  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 122, 100]), torch.Size([1, 122, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22356128692626953  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22875690460205078  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 122, 100])
m.shape torch.Size([143, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22919082641601562  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22919082641601562  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 143, 100]), torch.Size([1, 143, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22929763793945312  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23612070083618164  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 143, 100])
m.shape torch.Size([37234, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.3747749328613281  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.3747749328613281  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 37234, 100]), torch.Size([1, 37234, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.40251731872558594  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3721837997436523  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 37234, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.231128215789795  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.267441749572754  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.304551124572754  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.268237590789795  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([38002, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.304551124572754  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3136115074157715  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3136115074157715  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3893871307373047  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3893871307373047  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.389402389526367  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3896312713623047  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3896355628967285  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3896355628967285  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.389639377593994  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.389803409576416  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3898277282714844  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3898277282714844  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.389833450317383  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.390199661254883  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3902182579040527  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3902182579040527  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3902220726013184  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.390519618988037  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3905296325683594  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3905296325683594  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.390531539916992  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3906936645507812  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3907065391540527  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3907065391540527  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3907084465026855  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.390897274017334  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3909120559692383  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3909120559692383  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.390913963317871  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.391129493713379  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.391146183013916  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.391146183013916  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.391148090362549  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.391390323638916  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3914260864257812  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3914260864257812  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.391429901123047  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3919410705566406  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3919777870178223  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3919777870178223  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.391981601715088  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.392519474029541  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3926186561584473  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3926186561584473  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3926281929016113  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3940396308898926  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([2, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3940773010253906  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3940773010253906  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3940811157226562  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.394672393798828  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3947372436523438  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3947372436523438  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.394742965698242  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.395669937133789  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3957366943359375  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3957366943359375  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.395742416381836  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.396709442138672  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3127, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4718427658081055  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4718427658081055  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3127, 256]), torch.Size([1, 3127, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4780635833740234  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.5293211936950684  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3127, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.4542417526245117  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.4547958374023438  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.455349922180176  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.4547719955444336  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([3163, 47])
input nodes number: 38002
output nodes number: 3163
edges number: 78680
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.455109119415283  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.4551095962524414  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06970548629760742  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

pseudo mini batch 58 input nodes size: 155322
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06035327911376953  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06035327911376953  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.11894702911376953  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.11897087097167969  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06425952911376953  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06767749786376953  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06767749786376953  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

first layer input nodes number: 155322
first layer output nodes number: 38261
edges number: 379916
----------------------------------------before model layer 0
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06911993026733398  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([155322, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06911993026733398  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([34, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21464061737060547  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21464061737060547  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 34, 100]), torch.Size([1, 34, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21466636657714844  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21487092971801758  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 34, 100])
m.shape torch.Size([40, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2148880958557129  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2148880958557129  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 40, 100]), torch.Size([1, 40, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2149186134338379  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21536779403686523  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 40, 100])
m.shape torch.Size([63, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2154231071472168  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2154231071472168  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 63, 100]), torch.Size([1, 63, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2154707908630371  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2165069580078125  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 63, 100])
m.shape torch.Size([56, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2165665626525879  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2165665626525879  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 56, 100]), torch.Size([1, 56, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21660852432250977  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2178196907043457  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 56, 100])
m.shape torch.Size([73, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21793508529663086  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21793508529663086  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 73, 100]), torch.Size([1, 73, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21799039840698242  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21996021270751953  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 73, 100])
m.shape torch.Size([85, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2201228141784668  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2201228141784668  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 85, 100]), torch.Size([1, 85, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22018671035766602  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2229170799255371  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 85, 100])
m.shape torch.Size([97, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22313833236694336  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22313833236694336  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 97, 100]), torch.Size([1, 97, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22321081161499023  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22683477401733398  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 97, 100])
m.shape torch.Size([87, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22705793380737305  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22705793380737305  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 87, 100]), torch.Size([1, 87, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22712278366088867  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2308192253112793  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 87, 100])
m.shape torch.Size([121, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23119258880615234  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23119258880615234  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 121, 100]), torch.Size([1, 121, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23128318786621094  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23706865310668945  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 121, 100])
m.shape torch.Size([37605, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.37764835357666016  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.37764835357666016  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 37605, 100]), torch.Size([1, 37605, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.4056663513183594  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.394944190979004  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 37605, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.2529382705688477  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.2900476455688477  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3271570205688477  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.2900476455688477  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([38261, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3271570205688477  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3362793922424316  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3362793922424316  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4120631217956543  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4120631217956543  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4120707511901855  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.412292003631592  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4122934341430664  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4122934341430664  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.412295341491699  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4123640060424805  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.41237211227417  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.41237211227417  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4123740196228027  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4124960899353027  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([6, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.412564754486084  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.412564754486084  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.412576198577881  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4135489463806152  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([14, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4137182235717773  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4137182235717773  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4137449264526367  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.416201591491699  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4162087440490723  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4162087440490723  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.416210651397705  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4164929389953613  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4165587425231934  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4165587425231934  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.416564464569092  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4174914360046387  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3133, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4927687644958496  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4927687644958496  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3133, 256]), torch.Size([1, 3133, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.498744487762451  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.5516715049743652  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3133, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.4765782356262207  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.4771323204040527  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.4776864051818848  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.4771084785461426  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([3163, 47])
input nodes number: 38261
output nodes number: 3163
edges number: 78699
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.477417469024658  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.4774179458618164  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.07373046875  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

pseudo mini batch 59 input nodes size: 146821
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06425952911376953  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06425952911376953  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.11895465850830078  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.11897706985473633  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06035947799682617  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06365728378295898  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06365728378295898  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

first layer input nodes number: 146821
first layer output nodes number: 37174
edges number: 368419
----------------------------------------before model layer 0
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06508731842041016  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([146821, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06508731842041016  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([40, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20684242248535156  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20684242248535156  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 40, 100]), torch.Size([1, 40, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20687294006347656  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20711278915405273  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 40, 100])
m.shape torch.Size([60, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20714235305786133  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20714235305786133  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 60, 100]), torch.Size([1, 60, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20718717575073242  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20785951614379883  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 60, 100])
m.shape torch.Size([63, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20790767669677734  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20790767669677734  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 63, 100]), torch.Size([1, 63, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20795536041259766  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20899152755737305  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 63, 100])
m.shape torch.Size([73, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2090768814086914  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2090768814086914  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 73, 100]), torch.Size([1, 73, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20913219451904297  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21071910858154297  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 73, 100])
m.shape torch.Size([81, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21084260940551758  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21084260940551758  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 81, 100]), torch.Size([1, 81, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21090364456176758  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21308660507202148  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 81, 100])
m.shape torch.Size([91, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21325969696044922  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21325969696044922  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 91, 100]), torch.Size([1, 91, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21332836151123047  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21625518798828125  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 91, 100])
m.shape torch.Size([118, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21652889251708984  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21652889251708984  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 118, 100]), torch.Size([1, 118, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21661758422851562  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2210221290588379  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 118, 100])
m.shape torch.Size([153, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2214341163635254  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2214341163635254  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 153, 100]), torch.Size([1, 153, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22154855728149414  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22806024551391602  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 153, 100])
m.shape torch.Size([173, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22858333587646484  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22858333587646484  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 173, 100]), torch.Size([1, 173, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2287130355834961  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23697519302368164  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 173, 100])
m.shape torch.Size([36322, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.372220516204834  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.372220516204834  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 36322, 100]), torch.Size([1, 36322, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.39928293228149414  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3285841941833496  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 36322, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.190952777862549  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.2264046669006348  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.2618565559387207  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.2264046669006348  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([37174, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.2618565559387207  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.270719528198242  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.270719528198242  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3420701026916504  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3420701026916504  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.342072010040283  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3421006202697754  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.342111587524414  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.342111587524414  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3421192169189453  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.342287063598633  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.342306613922119  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.342306613922119  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3423123359680176  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3426384925842285  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3426618576049805  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3426618576049805  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.342667579650879  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.343033790588379  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.343040943145752  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.343040943145752  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3430428504943848  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3431782722473145  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3431901931762695  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3431901931762695  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3431921005249023  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.343367576599121  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3434205055236816  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3434205055236816  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.343428134918213  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3441834449768066  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.344210624694824  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.344210624694824  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.34421443939209  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3446455001831055  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3446764945983887  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3446764945983887  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3446803092956543  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3451380729675293  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3451881408691406  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3451881408691406  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.345193862915039  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3459205627441406  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([14, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3461737632751465  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3461737632751465  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.346200466156006  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.349778652191162  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([2, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.349803924560547  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.349803924560547  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3498077392578125  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3503456115722656  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.35038423538208  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.35038423538208  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3503880500793457  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.350952625274658  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3509721755981445  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3509721755981445  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3509740829467773  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3512697219848633  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3514018058776855  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3514018058776855  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3514132499694824  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.353267192840576  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3533310890197754  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3533310890197754  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.353336811065674  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3543038368225098  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2930, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.424703598022461  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.424703598022461  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2930, 256]), torch.Size([1, 2930, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4303536415100098  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.4485392570495605  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2930, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.3777995109558105  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.378321647644043  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.3788437843322754  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.3782992362976074  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([2982, 47])
input nodes number: 37174
output nodes number: 2982
edges number: 74094
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.3785667419433594  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.3785672187805176  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.07012605667114258  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

pseudo mini batch 60 input nodes size: 156280
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06032752990722656  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06032752990722656  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.11892127990722656  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.11894512176513672  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06422758102416992  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.0677037239074707  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.0677037239074707  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

first layer input nodes number: 156280
first layer output nodes number: 39068
edges number: 387796
----------------------------------------before model layer 0
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06915950775146484  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([156280, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06915950775146484  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([27, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21871137619018555  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21871137619018555  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 27, 100]), torch.Size([1, 27, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21873235702514648  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21889591217041016  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 27, 100])
m.shape torch.Size([45, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2189192771911621  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2189192771911621  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 45, 100]), torch.Size([1, 45, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21895360946655273  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21946001052856445  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 45, 100])
m.shape torch.Size([56, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21950578689575195  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21950578689575195  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 56, 100]), torch.Size([1, 56, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21954774856567383  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22046661376953125  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 56, 100])
m.shape torch.Size([72, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22055292129516602  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22055292129516602  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 72, 100]), torch.Size([1, 72, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22060728073120117  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2221665382385254  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 72, 100])
m.shape torch.Size([75, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22227907180786133  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22227907180786133  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 75, 100]), torch.Size([1, 75, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2223353385925293  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22435379028320312  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 75, 100])
m.shape torch.Size([102, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22455406188964844  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22455406188964844  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 102, 100]), torch.Size([1, 102, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22463035583496094  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22790241241455078  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 102, 100])
m.shape torch.Size([119, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22817468643188477  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22817468643188477  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 119, 100]), torch.Size([1, 119, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22826337814331055  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2326979637145996  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 119, 100])
m.shape torch.Size([108, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23297548294067383  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23297548294067383  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 108, 100]), torch.Size([1, 108, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23305654525756836  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2376542091369629  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 108, 100])
m.shape torch.Size([101, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23795270919799805  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23795270919799805  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 101, 100]), torch.Size([1, 101, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23802804946899414  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.24284982681274414  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 101, 100])
m.shape torch.Size([38363, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.3857254981994629  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.3857254981994629  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 38363, 100]), torch.Size([1, 38363, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.414309024810791  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.446162700653076  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 38363, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.301222801208496  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3384809494018555  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.375739097595215  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3384809494018555  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([39068, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.375739097595215  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3850536346435547  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.3850536346435547  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.460836410522461  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.460836410522461  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4608383178710938  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4608802795410156  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4608912467956543  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4608912467956543  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4608969688415527  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4610629081726074  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4610719680786133  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4610719680786133  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.461075782775879  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.461239814758301  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.461251735687256  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.461251735687256  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4612555503845215  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4614462852478027  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.461470603942871  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.461470603942871  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4614763259887695  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4618425369262695  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4618592262268066  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4618592262268066  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4618630409240723  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4621338844299316  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4621429443359375  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4621429443359375  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4621448516845703  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4622936248779297  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4623055458068848  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4623055458068848  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4623074531555176  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4624829292297363  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.462495803833008  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.462495803833008  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4624977111816406  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.462686538696289  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.462700366973877  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.462700366973877  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4627022743225098  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.462904453277588  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4629344940185547  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4629344940185547  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4629383087158203  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.463369369506836  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.463416576385498  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.463416576385498  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4634222984313965  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.464108943939209  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4641757011413574  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4641757011413574  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4641833305358887  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4651522636413574  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4651851654052734  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4651851654052734  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.465188980102539  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.465700149536133  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4657177925109863  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4657177925109863  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.465719699859619  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4659886360168457  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.466008186340332  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.466008186340332  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.466010093688965  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.466292381286621  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.466312885284424  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.466312885284424  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4663147926330566  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4666104316711426  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4666318893432617  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4666318893432617  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4666337966918945  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.46694278717041  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4669880867004395  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4669880867004395  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.466991901397705  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4676365852355957  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3129, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.542819023132324  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.542819023132324  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3129, 256]), torch.Size([1, 3129, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5493741035461426  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.6016464233398438  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3129, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.526545524597168  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.527099609375  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.527653694152832  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.52707576751709  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([3163, 47])
input nodes number: 39068
output nodes number: 3163
edges number: 78693
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.5274229049682617  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.52742338180542  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.07488775253295898  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

pseudo mini batch 61 input nodes size: 159541
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06425952911376953  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06425952911376953  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.12369346618652344  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.12371587753295898  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06509828567504883  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06849336624145508  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06849336624145508  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

first layer input nodes number: 159541
first layer output nodes number: 38704
edges number: 382145
----------------------------------------before model layer 0
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06997060775756836  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([159541, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06997060775756836  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([71, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21658563613891602  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21658563613891602  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 71, 100]), torch.Size([1, 71, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21663904190063477  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21706342697143555  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 71, 100])
m.shape torch.Size([82, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21709823608398438  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21709823608398438  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 82, 100]), torch.Size([1, 82, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21716022491455078  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21808147430419922  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 82, 100])
m.shape torch.Size([90, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21815109252929688  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21815109252929688  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 90, 100]), torch.Size([1, 90, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21821880340576172  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21969985961914062  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 90, 100])
m.shape torch.Size([96, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21980905532836914  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.21980905532836914  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 96, 100]), torch.Size([1, 96, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2198805809020996  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2219548225402832  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 96, 100])
m.shape torch.Size([145, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22218942642211914  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22218942642211914  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 145, 100]), torch.Size([1, 145, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22229814529418945  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2261977195739746  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 145, 100])
m.shape torch.Size([141, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22645854949951172  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.22645854949951172  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 141, 100]), torch.Size([1, 141, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2265644073486328  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23109054565429688  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 141, 100])
m.shape torch.Size([160, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23145484924316406  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23145484924316406  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 160, 100]), torch.Size([1, 160, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23157405853271484  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2375345230102539  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 160, 100])
m.shape torch.Size([206, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23808908462524414  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23808908462524414  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 206, 100]), torch.Size([1, 206, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.23824262619018555  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.2469944953918457  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 206, 100])
m.shape torch.Size([213, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.24763202667236328  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.24763202667236328  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 213, 100]), torch.Size([1, 213, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.24779129028320312  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.25795841217041016  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 213, 100])
m.shape torch.Size([37500, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.39850378036499023  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.39850378036499023  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 37500, 100]), torch.Size([1, 37500, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.42644357681274414  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4101691246032715  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 37500, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.267308235168457  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.304417610168457  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.341526985168457  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.304417610168457  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([38704, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.341526985168457  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.350754737854004  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.350754737854004  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4214601516723633  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4214601516723633  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.421463966369629  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4215478897094727  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4215502738952637  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4215502738952637  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4215521812438965  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.421607494354248  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.421640396118164  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.421640396118164  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4216537475585938  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4221343994140625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.422191619873047  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.422191619873047  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.422212600708008  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.423114776611328  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([4, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4231314659118652  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4231314659118652  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4231390953063965  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.423520565032959  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.423532485961914  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.423532485961914  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4235363006591797  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4237537384033203  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4237780570983887  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4237780570983887  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.423783779144287  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.424149990081787  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.424168586730957  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.424168586730957  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4241724014282227  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4244699478149414  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.424525737762451  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.424525737762451  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4245352745056152  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4253458976745605  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([1, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.42535400390625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.42535400390625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.425355911254883  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4255313873291016  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4255576133728027  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4255576133728027  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4255614280700684  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4259390830993652  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([8, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4260525703430176  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4260525703430176  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.42606782913208  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.427685260772705  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([11, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.427846908569336  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.427846908569336  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.427867889404297  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.430238723754883  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([6, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.430326461791992  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.430326461791992  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.430337905883789  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.431711196899414  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.431809425354004  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.431809425354004  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.431820869445801  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.433274269104004  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.433414936065674  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.433414936065674  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4334301948547363  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4354748725891113  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.435640335083008  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.435640335083008  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.435657501220703  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.438077926635742  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.438210964202881  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.438210964202881  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4382243156433105  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4402003288269043  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4403629302978516  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4403629302978516  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.440378189086914  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4427433013916016  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4429569244384766  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4429569244384766  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4429759979248047  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.446065902709961  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4462642669677734  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4462642669677734  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4462814331054688  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.4491825103759766  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([2860, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.517894744873047  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.517894744873047  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2860, 256]), torch.Size([1, 2860, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.5242490768432617  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.52321195602417  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2860, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.453864097595215  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.4543862342834473  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.4549083709716797  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.4543638229370117  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([2982, 47])
input nodes number: 38704
output nodes number: 2982
edges number: 73412
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.4546427726745605  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.4546432495117188  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.0744924545288086  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

pseudo mini batch 62 input nodes size: 102669
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06506633758544922  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.06506633758544922  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.10331392288208008  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.10333776473999023  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.04388141632080078  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.04696369171142578  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.04696369171142578  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

first layer input nodes number: 102669
first layer output nodes number: 33800
edges number: 335219
----------------------------------------before model layer 0
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.04798126220703125  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([102669, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.04798126220703125  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([31, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17638397216796875  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17638397216796875  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 31, 100]), torch.Size([1, 31, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1764078140258789  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17659425735473633  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 31, 100])
m.shape torch.Size([43, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17661476135253906  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17661476135253906  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 43, 100]), torch.Size([1, 43, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17664718627929688  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17713069915771484  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 43, 100])
m.shape torch.Size([55, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17717599868774414  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17717599868774414  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 55, 100]), torch.Size([1, 55, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1772170066833496  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17811918258666992  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 55, 100])
m.shape torch.Size([62, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1781911849975586  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1781911849975586  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 62, 100]), torch.Size([1, 62, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1782379150390625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1795816421508789  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 62, 100])
m.shape torch.Size([77, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1797018051147461  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1797018051147461  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 77, 100]), torch.Size([1, 77, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17975997924804688  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18183279037475586  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 77, 100])
m.shape torch.Size([79, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18198060989379883  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18198060989379883  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 79, 100]), torch.Size([1, 79, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18203973770141602  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18457365036010742  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 79, 100])
m.shape torch.Size([116, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1848468780517578  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1848468780517578  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 116, 100]), torch.Size([1, 116, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18493366241455078  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18926286697387695  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 116, 100])
m.shape torch.Size([112, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18955326080322266  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18955326080322266  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 112, 100]), torch.Size([1, 112, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1896371841430664  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1943979263305664  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 112, 100])
m.shape torch.Size([128, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.19478511810302734  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.19478511810302734  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 128, 100]), torch.Size([1, 128, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.19488048553466797  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.20098400115966797  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 128, 100])
m.shape torch.Size([33097, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.3242325782775879  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.3242325782775879  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 33097, 100]), torch.Size([1, 33097, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.3488926887512207  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.099717617034912  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 33097, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9744629859924316  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.006697177886963  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.038931369781494  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.006697177886963  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([33800, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.038931369781494  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.046989917755127  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.046989917755127  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1225032806396484  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1225032806396484  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1225051879882812  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.122547149658203  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.122554302215576  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.122554302215576  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.122558116912842  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.122668743133545  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1226768493652344  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1226768493652344  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1226806640625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1228179931640625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1228280067443848  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1228280067443848  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1228318214416504  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1229958534240723  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1230077743530273  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1230077743530273  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.123011589050293  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.123202323913574  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.123218059539795  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.123218059539795  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1232218742370605  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1234660148620605  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.123485565185547  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.123485565185547  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1234893798828125  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1237869262695312  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.123854637145996  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.123854637145996  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.123866081237793  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1248388290405273  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.124945640563965  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.124945640563965  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.12496280670166  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.126542091369629  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([3, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1265740394592285  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1265740394592285  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.126579761505127  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1271462440490723  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1271867752075195  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1271867752075195  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.127192497253418  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1277990341186523  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1278271675109863  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1278271675109863  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.127830982208252  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1282620429992676  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1283092498779297  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1283092498779297  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.128314971923828  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1290016174316406  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.129068374633789  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.129068374633789  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1290760040283203  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.130044937133789  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.130077838897705  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.130077838897705  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1300816535949707  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1305928230285645  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1306681632995605  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1306681632995605  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.130675792694092  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.131751537322998  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.131828784942627  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.131828784942627  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.131836414337158  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.132965564727783  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1330676078796387  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1330676078796387  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1330771446228027  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1345553398132324  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.134639263153076  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.134639263153076  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1346468925476074  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.13588285446167  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1361331939697266  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1361331939697266  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1361541748046875  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.139699935913086  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([3089, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.2144837379455566  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.2144837379455566  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3089, 256]), torch.Size([1, 3089, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.2213149070739746  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.267195701599121  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3089, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.192399501800537  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.192953586578369  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.193507671356201  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.192929744720459  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([3162, 47])
input nodes number: 33800
output nodes number: 3162
edges number: 78411
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.193237781524658  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.1932382583618164  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.052220821380615234  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

pseudo mini batch 63 input nodes size: 100346
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.04391336441040039  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.04391336441040039  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.08129549026489258  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.08131933212280273  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.04304790496826172  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.046039581298828125  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.046039581298828125  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

first layer input nodes number: 100346
first layer output nodes number: 32582
edges number: 322792
----------------------------------------before model layer 0
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.04703044891357422  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([100346, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.04703044891357422  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([23, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17067289352416992  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17067289352416992  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 23, 100]), torch.Size([1, 23, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17069005966186523  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17082738876342773  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 23, 100])
m.shape torch.Size([42, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17085027694702148  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17085027694702148  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 42, 100]), torch.Size([1, 42, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1708817481994629  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17135381698608398  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 42, 100])
m.shape torch.Size([42, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1713852882385254  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1713852882385254  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 42, 100]), torch.Size([1, 42, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1714167594909668  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17210912704467773  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 42, 100])
m.shape torch.Size([75, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17220544815063477  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17220544815063477  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 75, 100]), torch.Size([1, 75, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17226171493530273  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1738877296447754  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 75, 100])
m.shape torch.Size([106, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1740574836730957  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1740574836730957  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 106, 100]), torch.Size([1, 106, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17413663864135742  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1769862174987793  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 106, 100])
m.shape torch.Size([108, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17718839645385742  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17718839645385742  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 108, 100]), torch.Size([1, 108, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.17726945877075195  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18073797225952148  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 108, 100])
m.shape torch.Size([117, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18100261688232422  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18100261688232422  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 117, 100]), torch.Size([1, 117, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1810903549194336  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.1854572296142578  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 117, 100])
m.shape torch.Size([136, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18581867218017578  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18581867218017578  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 136, 100]), torch.Size([1, 136, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.18592071533203125  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.19170284271240234  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 136, 100])
m.shape torch.Size([156, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.19217491149902344  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.19217491149902344  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 156, 100]), torch.Size([1, 156, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.192291259765625  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.199737548828125  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 156, 100])
m.shape torch.Size([31777, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.3180580139160156  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.3180580139160156  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 31777, 100]), torch.Size([1, 31777, 100])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.3417339324951172  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.022724151611328  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 31777, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9021587371826172  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9332313537597656  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.964303970336914  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9332313537597656  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([32582, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.964303970336914  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9720721244812012  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 1.9720721244812012  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

m.shape torch.Size([1, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0478291511535645  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0478291511535645  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0478310585021973  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0479397773742676  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0479650497436523  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0479650497436523  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.047970771789551  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.048336982727051  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.048346996307373  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.048346996307373  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.048348903656006  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0485243797302246  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0485639572143555  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0485639572143555  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.048569679260254  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.049136161804199  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.049168109893799  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.049168109893799  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0491719245910645  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.049656391143799  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0497279167175293  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0497279167175293  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0497355461120605  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.050757884979248  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0507736206054688  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0507736206054688  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0507755279541016  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.051044464111328  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.051084041595459  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.051084041595459  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0510878562927246  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.051652431488037  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0517144203186035  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0517144203186035  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.051720142364502  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0526070594787598  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.052626609802246  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.052626609802246  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.052628517150879  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0529375076293945  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0530519485473633  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0530519485473633  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.0530614852905273  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.054673194885254  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3128, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.129828453063965  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.129828453063965  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

 h.shape torch.Size([1, 3128, 256]), torch.Size([1, 3128, 256])
----------------------------------------3
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 2.1363258361816406  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.186800956726074  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

rst.shape  torch.Size([1, 3128, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.111722946166992  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.1122756004333496  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.112828254699707  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.1122517585754395  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

torch.Size([3154, 47])
input nodes number: 32582
output nodes number: 3154
edges number: 78673
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.1125173568725586  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 3.112517833709717  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.05112934112548828  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.05621623992919922  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 8.8885498046875 GB
    Memory Allocated: 0.05621623992919922  GigaBytes
Max Memory Allocated: 3.792025089263916  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.025966167449951172 |0.008566729724407196 |0.12660274654626846 |9.196251630783081e-05 |0.07225439324975014 |0.005433082580566406 |
----------------------------------------------------------pseudo_mini_loss sum 5.387693881988525
Total (block generation + training)time/epoch 91.27165746688843
* Pure training time/epoch 14.948281049728394
Training time/epoch 15.197636127471924
Training time without block to device /epoch 14.649365425109863
Training time without total dataloading part /epoch 12.738175630569458
load block tensor time/epoch 1.661834716796875
block to device time/epoch 0.5482707023620605
input features size transfer per epoch 8.58306884765625e-06
blocks size to device per epoch 5.7220458984375e-06
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  10000107
Number of first layer input nodes during this epoch:  7920920
Number of first layer output nodes during this epoch:  2079187
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  682400
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([400, 100])
layers.0.lstm.weight_hh_l0, torch.Size([400, 100])
layers.0.lstm.bias_ih_l0, torch.Size([400])
layers.0.lstm.bias_hh_l0, torch.Size([400])
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([47, 256])
layers.1.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters

Partition a graph with 196571 nodes and 51547892 edges into 64 parts and get 10927543 edge cuts