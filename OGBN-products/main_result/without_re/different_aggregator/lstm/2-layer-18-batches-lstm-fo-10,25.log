main start at this time 1655789189.7724519
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.3140552043914795
global_2_local spend time (sec) 0.39896702766418457
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.05049729347229004
A = g.adjacency_matrix() spent  0.07776165008544922
auxiliary_graph
Graph(num_nodes=1205586, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.6016435623168945
remove nodes length
1009015
auxiliary_graph.remove_nodes spent  2.725834846496582
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.070160150527954

the counter of shared neighbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
51547892
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 51547889, 51547890, 51547891])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
Convert a graph into a bidirected graph: 3.164 seconds
Metis partitioning: 12.721 seconds
Split the graph: 0.889 seconds
Construct subgraphs: 0.450 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  17.246200561523438
11217
10683
10602
11111
10942
11215
11047
10724
10602
11241
10802
10673
10790
11247
11209
10673
10965
10828
total k batches seeds list generation spend  38.65087819099426
after graph partition
graph partition algorithm spend time 39.20369601249695
11217
10683
10602
11111
10942
11215
11047
10724
10602
11241
10802
10673
10790
11247
11209
10673
10965
10828
partition_len_list
[94533, 98770, 95126, 84157, 81270, 106284, 86003, 75516, 87007, 112698, 89247, 112333, 96842, 82485, 102165, 91443, 111045, 107376]
shared_neighbor_graph_partition_s0 selection method  spend 39.87372541427612
time for parepare:  0.25586605072021484
local_output_nid generation:  0.004122018814086914
local_in_edges_tensor generation:  0.004352092742919922
mini_batch_src_global generation:  0.014064788818359375
r_  generation:  0.09548163414001465
local_output_nid generation:  0.0045011043548583984
local_in_edges_tensor generation:  0.003981351852416992
mini_batch_src_global generation:  0.012522220611572266
r_  generation:  0.10228800773620605
local_output_nid generation:  0.004574775695800781
local_in_edges_tensor generation:  0.004219532012939453
mini_batch_src_global generation:  0.01057291030883789
r_  generation:  0.10029244422912598
local_output_nid generation:  0.0047719478607177734
local_in_edges_tensor generation:  0.004429340362548828
mini_batch_src_global generation:  0.011008739471435547
r_  generation:  0.10133910179138184
local_output_nid generation:  0.004676342010498047
local_in_edges_tensor generation:  0.005444049835205078
mini_batch_src_global generation:  0.012859582901000977
r_  generation:  0.0989837646484375
local_output_nid generation:  0.00570988655090332
local_in_edges_tensor generation:  0.023281574249267578
mini_batch_src_global generation:  0.013963699340820312
r_  generation:  0.115997314453125
local_output_nid generation:  0.004686594009399414
local_in_edges_tensor generation:  0.010480880737304688
mini_batch_src_global generation:  0.011419296264648438
r_  generation:  0.10365819931030273
local_output_nid generation:  0.004571676254272461
local_in_edges_tensor generation:  0.005259275436401367
mini_batch_src_global generation:  0.010307788848876953
r_  generation:  0.09640860557556152
local_output_nid generation:  0.005881547927856445
local_in_edges_tensor generation:  0.00427556037902832
mini_batch_src_global generation:  0.010475635528564453
r_  generation:  0.09606313705444336
local_output_nid generation:  0.0058596134185791016
local_in_edges_tensor generation:  0.005514621734619141
mini_batch_src_global generation:  0.011997461318969727
r_  generation:  0.1134955883026123
local_output_nid generation:  0.004734516143798828
local_in_edges_tensor generation:  0.004639148712158203
mini_batch_src_global generation:  0.015201807022094727
r_  generation:  0.10629725456237793
local_output_nid generation:  0.004622697830200195
local_in_edges_tensor generation:  0.003861665725708008
mini_batch_src_global generation:  0.01075434684753418
r_  generation:  0.11524391174316406
local_output_nid generation:  0.004080533981323242
local_in_edges_tensor generation:  0.0040242671966552734
mini_batch_src_global generation:  0.010901927947998047
r_  generation:  0.09678506851196289
local_output_nid generation:  0.004242658615112305
local_in_edges_tensor generation:  0.0043108463287353516
mini_batch_src_global generation:  0.010806560516357422
r_  generation:  0.1017906665802002
local_output_nid generation:  0.004209280014038086
local_in_edges_tensor generation:  0.003997325897216797
mini_batch_src_global generation:  0.012473583221435547
r_  generation:  0.16621947288513184
local_output_nid generation:  0.004058837890625
local_in_edges_tensor generation:  0.00413060188293457
mini_batch_src_global generation:  0.011993646621704102
r_  generation:  0.12122368812561035
local_output_nid generation:  0.0041866302490234375
local_in_edges_tensor generation:  0.004212141036987305
mini_batch_src_global generation:  0.01248311996459961
r_  generation:  0.11799907684326172
local_output_nid generation:  0.004154682159423828
local_in_edges_tensor generation:  0.004282951354980469
mini_batch_src_global generation:  0.012412548065185547
r_  generation:  0.11423826217651367
----------------------check_connections_block total spend ----------------------------- 3.0669989585876465
generate_one_block  1.7048585414886475
generate_one_block  0.18886232376098633
generate_one_block  0.1625518798828125
generate_one_block  0.1675705909729004
generate_one_block  0.15062499046325684
generate_one_block  0.16072821617126465
generate_one_block  0.14990019798278809
generate_one_block  0.13143277168273926
generate_one_block  0.13785195350646973
generate_one_block  0.15179705619812012
generate_one_block  0.14163804054260254
generate_one_block  0.14173221588134766
generate_one_block  0.12212252616882324
generate_one_block  0.13287997245788574
generate_one_block  0.14206171035766602
generate_one_block  0.13337969779968262
generate_one_block  0.14766645431518555
generate_one_block  0.1460878849029541
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.705787181854248
gen group dst list time:  0.04775595664978027
time for parepare:  0.4108271598815918
local_output_nid generation:  0.024145126342773438
local_in_edges_tensor generation:  0.0981147289276123
mini_batch_src_global generation:  0.03081965446472168
r_  generation:  0.366253137588501
local_output_nid generation:  0.028907299041748047
local_in_edges_tensor generation:  0.03580355644226074
mini_batch_src_global generation:  0.03700876235961914
r_  generation:  0.40834593772888184
local_output_nid generation:  0.028027057647705078
local_in_edges_tensor generation:  0.053877830505371094
mini_batch_src_global generation:  0.03486466407775879
r_  generation:  0.4139692783355713
local_output_nid generation:  0.03957056999206543
local_in_edges_tensor generation:  0.05014681816101074
mini_batch_src_global generation:  0.03331637382507324
r_  generation:  0.3716881275177002
local_output_nid generation:  0.031253814697265625
local_in_edges_tensor generation:  0.032871246337890625
mini_batch_src_global generation:  0.03391122817993164
r_  generation:  0.3583950996398926
local_output_nid generation:  0.030801773071289062
local_in_edges_tensor generation:  0.03739595413208008
mini_batch_src_global generation:  0.044957876205444336
r_  generation:  0.47748351097106934
local_output_nid generation:  0.023831605911254883
local_in_edges_tensor generation:  0.023810386657714844
mini_batch_src_global generation:  0.03894758224487305
r_  generation:  0.39075136184692383
local_output_nid generation:  0.02226090431213379
local_in_edges_tensor generation:  0.01848006248474121
mini_batch_src_global generation:  0.034058332443237305
r_  generation:  0.3124246597290039
local_output_nid generation:  0.025325536727905273
local_in_edges_tensor generation:  0.023328781127929688
mini_batch_src_global generation:  0.03850197792053223
r_  generation:  0.3946564197540283
local_output_nid generation:  0.03281736373901367
local_in_edges_tensor generation:  0.0384371280670166
mini_batch_src_global generation:  0.04577350616455078
r_  generation:  0.5208511352539062
local_output_nid generation:  0.02686142921447754
local_in_edges_tensor generation:  0.13203907012939453
mini_batch_src_global generation:  0.04280352592468262
r_  generation:  0.4167041778564453
local_output_nid generation:  0.03188347816467285
local_in_edges_tensor generation:  0.035631418228149414
mini_batch_src_global generation:  0.05211901664733887
r_  generation:  0.5644955635070801
local_output_nid generation:  0.027519941329956055
local_in_edges_tensor generation:  0.025307893753051758
mini_batch_src_global generation:  0.047159671783447266
r_  generation:  0.4876699447631836
local_output_nid generation:  0.02218317985534668
local_in_edges_tensor generation:  0.018540620803833008
mini_batch_src_global generation:  0.038202762603759766
r_  generation:  0.3930051326751709
local_output_nid generation:  0.027792930603027344
local_in_edges_tensor generation:  0.03076028823852539
mini_batch_src_global generation:  0.04806208610534668
r_  generation:  0.4837474822998047
local_output_nid generation:  0.026525259017944336
local_in_edges_tensor generation:  0.04046964645385742
mini_batch_src_global generation:  0.0435638427734375
r_  generation:  0.425961971282959
local_output_nid generation:  0.03867936134338379
local_in_edges_tensor generation:  0.05083608627319336
mini_batch_src_global generation:  0.04693865776062012
r_  generation:  0.5405340194702148
local_output_nid generation:  0.04719853401184082
local_in_edges_tensor generation:  0.037108421325683594
mini_batch_src_global generation:  0.047567129135131836
r_  generation:  0.5087764263153076
----------------------check_connections_block total spend ----------------------------- 12.00738263130188
generate_one_block  0.7489416599273682
generate_one_block  0.592083215713501
generate_one_block  0.5293943881988525
generate_one_block  0.43222951889038086
generate_one_block  0.42920756340026855
generate_one_block  0.5787279605865479
generate_one_block  0.4363975524902344
generate_one_block  0.3775444030761719
generate_one_block  0.46729469299316406
generate_one_block  0.6309325695037842
generate_one_block  0.48276853561401367
generate_one_block  0.6196677684783936
generate_one_block  0.5654308795928955
generate_one_block  0.4410061836242676
generate_one_block  0.5554068088531494
generate_one_block  0.5452721118927002
generate_one_block  0.6552391052246094
generate_one_block  0.5868194103240967
----------===============-------------===============-------------the number of batches *****---- 18

original number of batches:  18
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

connection checking time:  15.074381589889526
block generation total time  13.888111352920532
average batch blocks generation time:  0.38578087091445923
block dataloader generation time/epoch 71.00123405456543
pseudo mini batch 0 input nodes size: 252219
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.09650278091430664  GigaBytes
Max Memory Allocated: 0.09650278091430664  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.09658670425415039  GigaBytes
Max Memory Allocated: 0.09658670425415039  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1151123046875 GB
    Memory Allocated: 0.09658670425415039  GigaBytes
Max Memory Allocated: 0.09658670425415039  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10608148574829102  GigaBytes
Max Memory Allocated: 0.10608148574829102  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10608148574829102  GigaBytes
Max Memory Allocated: 0.10608148574829102  GigaBytes

first layer input nodes number: 252219
first layer output nodes number: 94533
edges number: 904977
----------------------------------------before model layer 0
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10866546630859375  GigaBytes
Max Memory Allocated: 0.11203718185424805  GigaBytes

torch.Size([252219, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1990966796875 GB
    Memory Allocated: 0.10866546630859375  GigaBytes
Max Memory Allocated: 0.11203718185424805  GigaBytes

m.shape torch.Size([390, 1, 100])
----------------------------------------1
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.4562721252441406  GigaBytes
Max Memory Allocated: 0.47050952911376953  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.4562721252441406  GigaBytes
Max Memory Allocated: 0.47050952911376953  GigaBytes

 h.shape torch.Size([1, 390, 100]), torch.Size([1, 390, 100])
----------------------------------------3
 Nvidia-smi: 1.6737060546875 GB
    Memory Allocated: 0.45656299591064453  GigaBytes
Max Memory Allocated: 0.47050952911376953  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6756591796875 GB
    Memory Allocated: 0.45888853073120117  GigaBytes
Max Memory Allocated: 0.47050952911376953  GigaBytes

rst.shape  torch.Size([1, 390, 100])
m.shape torch.Size([626, 2, 100])
----------------------------------------1
 Nvidia-smi: 1.6776123046875 GB
    Memory Allocated: 0.4592099189758301  GigaBytes
Max Memory Allocated: 0.47050952911376953  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6776123046875 GB
    Memory Allocated: 0.4592099189758301  GigaBytes
Max Memory Allocated: 0.47050952911376953  GigaBytes

 h.shape torch.Size([1, 626, 100]), torch.Size([1, 626, 100])
----------------------------------------3
 Nvidia-smi: 1.6776123046875 GB
    Memory Allocated: 0.45967721939086914  GigaBytes
Max Memory Allocated: 0.47050952911376953  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6854248046875 GB
    Memory Allocated: 0.4666781425476074  GigaBytes
Max Memory Allocated: 0.47050952911376953  GigaBytes

rst.shape  torch.Size([1, 626, 100])
m.shape torch.Size([836, 3, 100])
----------------------------------------1
 Nvidia-smi: 1.6854248046875 GB
    Memory Allocated: 0.467379093170166  GigaBytes
Max Memory Allocated: 0.47050952911376953  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6854248046875 GB
    Memory Allocated: 0.467379093170166  GigaBytes
Max Memory Allocated: 0.47050952911376953  GigaBytes

 h.shape torch.Size([1, 836, 100]), torch.Size([1, 836, 100])
----------------------------------------3
 Nvidia-smi: 1.6854248046875 GB
    Memory Allocated: 0.4680027961730957  GigaBytes
Max Memory Allocated: 0.47050952911376953  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.4823770523071289  GigaBytes
Max Memory Allocated: 0.48331165313720703  GigaBytes

rst.shape  torch.Size([1, 836, 100])
m.shape torch.Size([1072, 4, 100])
----------------------------------------1
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.48366260528564453  GigaBytes
Max Memory Allocated: 0.48371076583862305  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.48366260528564453  GigaBytes
Max Memory Allocated: 0.48371076583862305  GigaBytes

 h.shape torch.Size([1, 1072, 100]), torch.Size([1, 1072, 100])
----------------------------------------3
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.48446178436279297  GigaBytes
Max Memory Allocated: 0.48446178436279297  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.5076265335083008  GigaBytes
Max Memory Allocated: 0.5092239379882812  GigaBytes

rst.shape  torch.Size([1, 1072, 100])
m.shape torch.Size([1221, 5, 100])
----------------------------------------1
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.5095014572143555  GigaBytes
Max Memory Allocated: 0.5095701217651367  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.5095014572143555  GigaBytes
Max Memory Allocated: 0.5095701217651367  GigaBytes

 h.shape torch.Size([1, 1221, 100]), torch.Size([1, 1221, 100])
----------------------------------------3
 Nvidia-smi: 1.7147216796875 GB
    Memory Allocated: 0.510411262512207  GigaBytes
Max Memory Allocated: 0.510411262512207  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7596435546875 GB
    Memory Allocated: 0.5437803268432617  GigaBytes
Max Memory Allocated: 0.5460548400878906  GigaBytes

rst.shape  torch.Size([1, 1221, 100])
m.shape torch.Size([1297, 6, 100])
----------------------------------------1
 Nvidia-smi: 1.7596435546875 GB
    Memory Allocated: 0.5462245941162109  GigaBytes
Max Memory Allocated: 0.5463118553161621  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.7596435546875 GB
    Memory Allocated: 0.5462245941162109  GigaBytes
Max Memory Allocated: 0.5463118553161621  GigaBytes

 h.shape torch.Size([1, 1297, 100]), torch.Size([1, 1297, 100])
----------------------------------------3
 Nvidia-smi: 1.7596435546875 GB
    Memory Allocated: 0.5471916198730469  GigaBytes
Max Memory Allocated: 0.5471916198730469  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.5889568328857422  GigaBytes
Max Memory Allocated: 0.5918560028076172  GigaBytes

rst.shape  torch.Size([1, 1297, 100])
m.shape torch.Size([1347, 7, 100])
----------------------------------------1
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.5919861793518066  GigaBytes
Max Memory Allocated: 0.5920920372009277  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8065185546875 GB
    Memory Allocated: 0.5919861793518066  GigaBytes
Max Memory Allocated: 0.5920920372009277  GigaBytes

 h.shape torch.Size([1, 1347, 100]), torch.Size([1, 1347, 100])
----------------------------------------3
 Nvidia-smi: 1.8084716796875 GB
    Memory Allocated: 0.5929903984069824  GigaBytes
Max Memory Allocated: 0.5929903984069824  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.8572998046875 GB
    Memory Allocated: 0.6432886123657227  GigaBytes
Max Memory Allocated: 0.6468014717102051  GigaBytes

rst.shape  torch.Size([1, 1347, 100])
m.shape torch.Size([1402, 8, 100])
----------------------------------------1
 Nvidia-smi: 1.8572998046875 GB
    Memory Allocated: 0.6469650268554688  GigaBytes
Max Memory Allocated: 0.6470909118652344  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.8572998046875 GB
    Memory Allocated: 0.6469650268554688  GigaBytes
Max Memory Allocated: 0.6470909118652344  GigaBytes

 h.shape torch.Size([1, 1402, 100]), torch.Size([1, 1402, 100])
----------------------------------------3
 Nvidia-smi: 1.8592529296875 GB
    Memory Allocated: 0.64801025390625  GigaBytes
Max Memory Allocated: 0.64801025390625  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.7090167999267578  GigaBytes
Max Memory Allocated: 0.7131953239440918  GigaBytes

rst.shape  torch.Size([1, 1402, 100])
m.shape torch.Size([1413, 9, 100])
----------------------------------------1
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.7132320404052734  GigaBytes
Max Memory Allocated: 0.7133746147155762  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.7132320404052734  GigaBytes
Max Memory Allocated: 0.7133746147155762  GigaBytes

 h.shape torch.Size([1, 1413, 100]), torch.Size([1, 1413, 100])
----------------------------------------3
 Nvidia-smi: 1.9295654296875 GB
    Memory Allocated: 0.7142848968505859  GigaBytes
Max Memory Allocated: 0.7142848968505859  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.0018310546875 GB
    Memory Allocated: 0.7829618453979492  GigaBytes
Max Memory Allocated: 0.7877531051635742  GigaBytes

rst.shape  torch.Size([1, 1413, 100])
m.shape torch.Size([84929, 10, 100])
----------------------------------------1
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 1.098841667175293  GigaBytes
Max Memory Allocated: 1.1083340644836426  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3377685546875 GB
    Memory Allocated: 1.098841667175293  GigaBytes
Max Memory Allocated: 1.1083340644836426  GigaBytes

 h.shape torch.Size([1, 84929, 100]), torch.Size([1, 84929, 100])
----------------------------------------3
 Nvidia-smi: 2.4041748046875 GB
    Memory Allocated: 1.162118911743164  GigaBytes
Max Memory Allocated: 1.162118911743164  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.2596435546875 GB
    Memory Allocated: 5.666762351989746  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 84929, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.2596435546875 GB
    Memory Allocated: 5.330677032470703  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.2596435546875 GB
    Memory Allocated: 5.420830726623535  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.2596435546875 GB
    Memory Allocated: 5.510984420776367  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.2596435546875 GB
    Memory Allocated: 5.420830726623535  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

torch.Size([94533, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.2596435546875 GB
    Memory Allocated: 5.510984420776367  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.2596435546875 GB
    Memory Allocated: 5.533523082733154  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.2596435546875 GB
    Memory Allocated: 5.533523082733154  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

m.shape torch.Size([10, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.79428243637085  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.79428243637085  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.794301509857178  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.794454097747803  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([16, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.794475555419922  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.794475555419922  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.794506072998047  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.794963836669922  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([25, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.795021057128906  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.795021057128906  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.795068740844727  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.796117782592773  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.796197891235352  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.796197891235352  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.7962493896484375  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.79774284362793  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.797837257385254  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.797837257385254  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.797884941101074  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.7996015548706055  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([37, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.79979133605957  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.79979133605957  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.799861907958984  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.802896499633789  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([26, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.803036212921143  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.803036212921143  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.803085803985596  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.805565357208252  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([38, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.805832862854004  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.805832862854004  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.805905342102051  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.810036659240723  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([41, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.810355186462402  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.810355186462402  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 7.5194091796875 GB
    Memory Allocated: 5.810433387756348  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5233154296875 GB
    Memory Allocated: 5.815438270568848  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([45, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.5233154296875 GB
    Memory Allocated: 5.815832138061523  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5233154296875 GB
    Memory Allocated: 5.815832138061523  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 7.5233154296875 GB
    Memory Allocated: 5.81591796875  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5291748046875 GB
    Memory Allocated: 5.822011947631836  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([41, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.5291748046875 GB
    Memory Allocated: 5.8224029541015625  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5291748046875 GB
    Memory Allocated: 5.8224029541015625  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 7.5291748046875 GB
    Memory Allocated: 5.822481155395508  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5369873046875 GB
    Memory Allocated: 5.828580856323242  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([33, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.5369873046875 GB
    Memory Allocated: 5.828922748565674  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5369873046875 GB
    Memory Allocated: 5.828922748565674  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 7.5369873046875 GB
    Memory Allocated: 5.828985691070557  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5408935546875 GB
    Memory Allocated: 5.834335803985596  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([61, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.5428466796875 GB
    Memory Allocated: 5.835066795349121  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5428466796875 GB
    Memory Allocated: 5.835066795349121  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 7.5428466796875 GB
    Memory Allocated: 5.835183143615723  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5545654296875 GB
    Memory Allocated: 5.845887184143066  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([53, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.5545654296875 GB
    Memory Allocated: 5.8465423583984375  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5545654296875 GB
    Memory Allocated: 5.8465423583984375  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 7.5545654296875 GB
    Memory Allocated: 5.846643447875977  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5643310546875 GB
    Memory Allocated: 5.856651306152344  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.5643310546875 GB
    Memory Allocated: 5.857090950012207  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5643310546875 GB
    Memory Allocated: 5.857090950012207  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 7.5643310546875 GB
    Memory Allocated: 5.857155799865723  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5721435546875 GB
    Memory Allocated: 5.864029884338379  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.5721435546875 GB
    Memory Allocated: 5.864643573760986  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5721435546875 GB
    Memory Allocated: 5.864643573760986  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 7.5721435546875 GB
    Memory Allocated: 5.8647236824035645  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5819091796875 GB
    Memory Allocated: 5.873775959014893  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([52, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.5819091796875 GB
    Memory Allocated: 5.8745856285095215  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5819091796875 GB
    Memory Allocated: 5.8745856285095215  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 7.5819091796875 GB
    Memory Allocated: 5.874684810638428  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.5955810546875 GB
    Memory Allocated: 5.886586666107178  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([42, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.5955810546875 GB
    Memory Allocated: 5.887263774871826  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.5955810546875 GB
    Memory Allocated: 5.887263774871826  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 7.5955810546875 GB
    Memory Allocated: 5.887343883514404  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6053466796875 GB
    Memory Allocated: 5.897517681121826  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([47, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.6072998046875 GB
    Memory Allocated: 5.898335933685303  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6072998046875 GB
    Memory Allocated: 5.898335933685303  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 7.6072998046875 GB
    Memory Allocated: 5.898425579071045  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6190185546875 GB
    Memory Allocated: 5.910438060760498  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([40, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.6190185546875 GB
    Memory Allocated: 5.911162376403809  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6190185546875 GB
    Memory Allocated: 5.911162376403809  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 7.6190185546875 GB
    Memory Allocated: 5.911238670349121  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6307373046875 GB
    Memory Allocated: 5.921996116638184  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.6307373046875 GB
    Memory Allocated: 5.922725200653076  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6307373046875 GB
    Memory Allocated: 5.922725200653076  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 7.6307373046875 GB
    Memory Allocated: 5.922797679901123  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6424560546875 GB
    Memory Allocated: 5.9335246086120605  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([43, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.6424560546875 GB
    Memory Allocated: 5.9343976974487305  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6424560546875 GB
    Memory Allocated: 5.9343976974487305  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 7.6424560546875 GB
    Memory Allocated: 5.934479713439941  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6561279296875 GB
    Memory Allocated: 5.947192192077637  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([56, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.6561279296875 GB
    Memory Allocated: 5.948496341705322  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6561279296875 GB
    Memory Allocated: 5.948496341705322  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 7.6561279296875 GB
    Memory Allocated: 5.94860315322876  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6737060546875 GB
    Memory Allocated: 5.965906620025635  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([36, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.6737060546875 GB
    Memory Allocated: 5.966683864593506  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6737060546875 GB
    Memory Allocated: 5.966683864593506  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 7.6737060546875 GB
    Memory Allocated: 5.966752529144287  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.6873779296875 GB
    Memory Allocated: 5.978356838226318  GigaBytes
Max Memory Allocated: 5.983168601989746  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([10309, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.6893310546875 GB
    Memory Allocated: 6.2260284423828125  GigaBytes
Max Memory Allocated: 6.226988792419434  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.6893310546875 GB
    Memory Allocated: 6.2260284423828125  GigaBytes
Max Memory Allocated: 6.226988792419434  GigaBytes

 h.shape torch.Size([1, 10309, 256]), torch.Size([1, 10309, 256])
----------------------------------------3
 Nvidia-smi: 7.6893310546875 GB
    Memory Allocated: 6.245691299438477  GigaBytes
Max Memory Allocated: 6.245691299438477  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.4334716796875 GB
    Memory Allocated: 9.706354141235352  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 10309, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.4334716796875 GB
    Memory Allocated: 9.449123859405518  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.4334716796875 GB
    Memory Allocated: 9.451994895935059  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.4334716796875 GB
    Memory Allocated: 9.453958988189697  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.4334716796875 GB
    Memory Allocated: 9.451004028320312  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

torch.Size([11217, 47])
input nodes number: 94533
output nodes number: 11217
edges number: 270395
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.4334716796875 GB
    Memory Allocated: 9.454663753509521  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.4334716796875 GB
    Memory Allocated: 9.454664707183838  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.9588623046875 GB
    Memory Allocated: 0.1275324821472168  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

pseudo mini batch 1 input nodes size: 298324
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.9588623046875 GB
    Memory Allocated: 0.10200214385986328  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.9588623046875 GB
    Memory Allocated: 0.10200214385986328  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.9588623046875 GB
    Memory Allocated: 0.2131366729736328  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 11.9588623046875 GB
    Memory Allocated: 0.21321630477905273  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.9588623046875 GB
    Memory Allocated: 0.11917304992675781  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.9588623046875 GB
    Memory Allocated: 0.12826061248779297  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.9588623046875 GB
    Memory Allocated: 0.12826061248779297  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

first layer input nodes number: 298324
first layer output nodes number: 98770
edges number: 960006
----------------------------------------before model layer 0
 Nvidia-smi: 11.9588623046875 GB
    Memory Allocated: 0.13121986389160156  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

torch.Size([298324, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.9588623046875 GB
    Memory Allocated: 0.13121986389160156  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

m.shape torch.Size([227, 1, 100])
----------------------------------------1
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.4990372657775879  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.4990372657775879  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 227, 100]), torch.Size([1, 227, 100])
----------------------------------------3
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.4992070198059082  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5005621910095215  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 227, 100])
m.shape torch.Size([380, 2, 100])
----------------------------------------1
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.500760555267334  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.500760555267334  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 380, 100]), torch.Size([1, 380, 100])
----------------------------------------3
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5010437965393066  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5052924156188965  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 380, 100])
m.shape torch.Size([590, 3, 100])
----------------------------------------1
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5058102607727051  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5058102607727051  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 590, 100]), torch.Size([1, 590, 100])
----------------------------------------3
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5062499046325684  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5159220695495605  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 590, 100])
m.shape torch.Size([693, 4, 100])
----------------------------------------1
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5174469947814941  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5174469947814941  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 693, 100]), torch.Size([1, 693, 100])
----------------------------------------3
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5179638862609863  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5336527824401855  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 693, 100])
m.shape torch.Size([883, 5, 100])
----------------------------------------1
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5350394248962402  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5350394248962402  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 883, 100]), torch.Size([1, 883, 100])
----------------------------------------3
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5356974601745605  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5593867301940918  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 883, 100])
m.shape torch.Size([961, 6, 100])
----------------------------------------1
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5612058639526367  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5612058639526367  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 961, 100]), torch.Size([1, 961, 100])
----------------------------------------3
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5619220733642578  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5933632850646973  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 961, 100])
m.shape torch.Size([1008, 7, 100])
----------------------------------------1
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5956339836120605  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5956339836120605  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 1008, 100]), torch.Size([1, 1008, 100])
----------------------------------------3
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.5963854789733887  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.6340179443359375  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 1008, 100])
m.shape torch.Size([1017, 8, 100])
----------------------------------------1
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.6366734504699707  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.6366734504699707  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 1017, 100]), torch.Size([1, 1017, 100])
----------------------------------------3
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.6374316215515137  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.680635929107666  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 1017, 100])
m.shape torch.Size([1006, 9, 100])
----------------------------------------1
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.6836299896240234  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.6836299896240234  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 1006, 100]), torch.Size([1, 1006, 100])
----------------------------------------3
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.6843795776367188  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 12.3182373046875 GB
    Memory Allocated: 0.7332029342651367  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 1006, 100])
m.shape torch.Size([92005, 10, 100])
----------------------------------------1
 Nvidia-smi: 12.6619873046875 GB
    Memory Allocated: 1.0755739212036133  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 12.6619873046875 GB
    Memory Allocated: 1.0755739212036133  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 92005, 100]), torch.Size([1, 92005, 100])
----------------------------------------3
 Nvidia-smi: 12.6619873046875 GB
    Memory Allocated: 1.1441230773925781  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.011113166809082  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 92005, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 5.654158115386963  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 5.748352527618408  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 5.8425469398498535  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 5.748352527618408  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

torch.Size([98770, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 5.8425469398498535  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 5.866095542907715  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 5.866095542907715  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.115978717803955  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.115978717803955  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.115990161895752  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.116081714630127  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.116091728210449  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.116091728210449  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.116106986999512  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.116335868835449  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([15, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.1163716316223145  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.1163716316223145  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.116400241851807  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.117029666900635  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([23, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.1171040534973145  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.1171040534973145  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.117147922515869  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.118420124053955  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.118523597717285  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.118523597717285  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.118573188781738  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.120358467102051  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([30, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.120506763458252  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.120506763458252  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.120563983917236  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.1230244636535645  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([36, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.1232380867004395  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.1232380867004395  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.123306751251221  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.126739978790283  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([27, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.126913547515869  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.126913547515869  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.126965045928955  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.1299004554748535  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([30, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.130134582519531  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.130134582519531  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.130191802978516  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.133853912353516  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([26, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.13407564163208  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.13407564163208  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.134125232696533  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.137646198272705  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([37, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.138012886047363  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.138012886047363  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.138083457946777  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.143588066101074  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([34, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.143945217132568  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.143945217132568  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.144010066986084  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.149522304534912  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([36, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.149940013885498  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.149940013885498  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.150008678436279  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.156325817108154  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([25, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.156628131866455  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.156628131866455  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.156675815582275  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.161396503448486  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([36, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.161891937255859  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.161891937255859  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.161960601806641  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.169239044189453  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.169620037078857  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.169620037078857  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.169671535491943  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.175490856170654  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.175873756408691  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.175873756408691  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.175921440124512  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.181643486022949  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.182086944580078  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.182086944580078  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.182138442993164  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.188678741455078  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.189182758331299  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.189182758331299  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.18923807144165  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.19665002822876  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([28, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.197160720825195  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.197160720825195  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.197214126586914  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.204744338989258  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.205363750457764  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.205363750457764  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.205424785614014  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.214457988739014  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.215188980102539  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.215188980102539  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.21525764465332  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.225900650024414  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.2266845703125  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.2266845703125  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.226755142211914  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.238187789916992  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.2390522956848145  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.2390522956848145  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.239126682281494  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.251698017120361  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([10008, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.4921345710754395  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.4921345710754395  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

 h.shape torch.Size([1, 10008, 256]), torch.Size([1, 10008, 256])
----------------------------------------3
 Nvidia-smi: 15.7791748046875 GB
    Memory Allocated: 6.511223316192627  GigaBytes
Max Memory Allocated: 9.952447891235352  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 9.875526905059814  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 10008, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 9.627984523773193  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 9.6301589012146  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 9.632333278656006  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 9.63007926940918  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

torch.Size([10683, 47])
input nodes number: 98770
output nodes number: 10683
edges number: 259545
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 9.63019847869873  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.0194091796875 GB
    Memory Allocated: 9.630198955535889  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.14313697814941406  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

pseudo mini batch 2 input nodes size: 287609
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.11847639083862305  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.11847639083862305  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.22561931610107422  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.22569847106933594  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.11448431015014648  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.12323427200317383  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.12323427200317383  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

first layer input nodes number: 287609
first layer output nodes number: 95126
edges number: 919440
----------------------------------------before model layer 0
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.12663650512695312  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

torch.Size([287609, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.12663650512695312  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

m.shape torch.Size([322, 1, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4789724349975586  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4789724349975586  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 322, 100]), torch.Size([1, 322, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.47921276092529297  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.48113393783569336  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 322, 100])
m.shape torch.Size([471, 2, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.48136472702026367  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.48136472702026367  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 471, 100]), torch.Size([1, 471, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.48171567916870117  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.48697996139526367  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 471, 100])
m.shape torch.Size([645, 3, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.48752546310424805  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.48752546310424805  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 645, 100]), torch.Size([1, 645, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4880061149597168  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4985804557800293  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 645, 100])
m.shape torch.Size([812, 4, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4995718002319336  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4995718002319336  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 812, 100]), torch.Size([1, 812, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5001773834228516  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5177545547485352  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 812, 100])
m.shape torch.Size([967, 5, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5194888114929199  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5194888114929199  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 967, 100]), torch.Size([1, 967, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.520209789276123  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5463414192199707  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 967, 100])
m.shape torch.Size([1056, 6, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5483412742614746  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5483412742614746  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 1056, 100]), torch.Size([1, 1056, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5491280555725098  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5837216377258301  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 1056, 100])
m.shape torch.Size([1099, 7, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5861945152282715  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5861945152282715  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 1099, 100]), torch.Size([1, 1099, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5870137214660645  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.6287236213684082  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 1099, 100])
m.shape torch.Size([1155, 8, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.6317563056945801  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.6317563056945801  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 1155, 100]), torch.Size([1, 1155, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.6326174736022949  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.6816811561584473  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 1155, 100])
m.shape torch.Size([1101, 9, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.6849422454833984  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.6849422454833984  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 1101, 100]), torch.Size([1, 1101, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.6857633590698242  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.7389755249023438  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 1101, 100])
m.shape torch.Size([87498, 10, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 1.0645208358764648  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 1.0645208358764648  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 87498, 100]), torch.Size([1, 87498, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 1.1309270858764648  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.772871971130371  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 87498, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.430196762084961  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.520915985107422  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.611635208129883  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.520915985107422  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

torch.Size([95126, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.611635208129883  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.634315013885498  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.634315013885498  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

m.shape torch.Size([47, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.879666328430176  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.879666328430176  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.879755973815918  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.8804731369018555  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([35, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.880496025085449  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.880496025085449  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.880562782287598  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.881564140319824  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([27, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.881608963012695  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.881608963012695  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.881660461425781  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.882793426513672  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.882863998413086  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.882863998413086  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.882911682128906  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.884294509887695  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([33, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.884429454803467  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.884429454803467  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.88449239730835  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.886758327484131  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([34, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.886923313140869  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.886923313140869  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.886988162994385  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.889776706695557  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([38, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.890000343322754  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.890000343322754  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.890072822570801  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.8936967849731445  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([27, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.893868446350098  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.893868446350098  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.893919944763184  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.896855354309082  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.897028923034668  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.897028923034668  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.897072792053223  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.899880409240723  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([41, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.900252819061279  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.900252819061279  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.900331020355225  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.905883312225342  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([31, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.906172275543213  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.906172275543213  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.90623140335083  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.910843372344971  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([27, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.911125659942627  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.911125659942627  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.911177158355713  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.915554523468018  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.91602897644043  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.91602897644043  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.916105270385742  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.923124313354492  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([50, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.9237589836120605  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.9237589836120605  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.923854351043701  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.933295726776123  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.9337382316589355  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.9337382316589355  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.933803081512451  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.940677165985107  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([35, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.941183090209961  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.941183090209961  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.941249847412109  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.948793411254883  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([45, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.949495315551758  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.949495315551758  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.949581146240234  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.959880828857422  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([35, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.960443496704102  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.960443496704102  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.96051025390625  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.968988418579102  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.969521522521973  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.969521522521973  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.96958065032959  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.977503776550293  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.9779744148254395  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.9779744148254395  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.978024005889893  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.985016345977783  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([40, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.985799312591553  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.985799312591553  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.985875606536865  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.997167110443115  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.997805595397949  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.997805595397949  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.997866630554199  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 6.007327079772949  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([43, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 6.008247375488281  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 6.008247375488281  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 6.008329391479492  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 6.021615982055664  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([37, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 6.022428512573242  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 6.022428512573242  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 6.022499084472656  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 6.034425735473633  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([9766, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 6.269542217254639  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 6.269542217254639  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 9766, 256]), torch.Size([1, 9766, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 6.2881693840026855  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 9.578809261322021  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 9766, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 9.335493087768555  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 9.337898254394531  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 9.340303421020508  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 9.33781909942627  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

torch.Size([10602, 47])
input nodes number: 95126
output nodes number: 10602
edges number: 254796
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 9.33883810043335  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 9.338838577270508  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.1390533447265625  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

pseudo mini batch 3 input nodes size: 229504
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.1147150993347168  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.1147150993347168  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.2002120018005371  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.20029497146606445  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.09307289123535156  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.10109615325927734  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.10109615325927734  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

first layer input nodes number: 229504
first layer output nodes number: 84157
edges number: 808844
----------------------------------------before model layer 0
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.10343313217163086  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

torch.Size([229504, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.10343313217163086  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

m.shape torch.Size([335, 1, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.413419246673584  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.413419246673584  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 335, 100]), torch.Size([1, 335, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4136691093444824  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4156665802001953  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 335, 100])
m.shape torch.Size([478, 2, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.41589784622192383  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.41589784622192383  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 478, 100]), torch.Size([1, 478, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.41625452041625977  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4215989112854004  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 478, 100])
m.shape torch.Size([686, 3, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.42218732833862305  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.42218732833862305  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 686, 100]), torch.Size([1, 686, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4226984977722168  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.43463659286499023  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 686, 100])
m.shape torch.Size([836, 4, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4356269836425781  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4356269836425781  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 836, 100]), torch.Size([1, 836, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4362506866455078  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4554266929626465  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 836, 100])
m.shape torch.Size([993, 5, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.45696449279785156  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.45696449279785156  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 993, 100]), torch.Size([1, 993, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4577045440673828  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4843463897705078  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 993, 100])
m.shape torch.Size([1071, 6, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4863705635070801  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4863705635070801  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 1071, 100]), torch.Size([1, 1071, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4871687889099121  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5225777626037598  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 1071, 100])
m.shape torch.Size([1118, 7, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5250945091247559  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5250945091247559  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 1118, 100]), torch.Size([1, 1118, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5259280204772949  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5682387351989746  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 1118, 100])
m.shape torch.Size([1174, 8, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5713210105895996  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5713210105895996  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 1174, 100]), torch.Size([1, 1174, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5721964836120605  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.6220641136169434  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 1174, 100])
m.shape torch.Size([1118, 9, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.6253747940063477  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.6253747940063477  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 1118, 100]), torch.Size([1, 1118, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.6262083053588867  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.6796960830688477  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 1118, 100])
m.shape torch.Size([76348, 10, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.9636979103088379  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.9636979103088379  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 76348, 100]), torch.Size([1, 76348, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 1.0205817222595215  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.059332370758057  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 76348, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 4.7593464851379395  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 4.83960485458374  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 4.919863224029541  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 4.83960485458374  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

torch.Size([84157, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 4.919863224029541  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 4.93992805480957  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 4.93992805480957  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

m.shape torch.Size([13, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.198226451873779  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.198226451873779  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.198251247406006  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.198449611663818  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([23, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.198481559753418  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.198481559753418  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.198525428771973  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.199183464050293  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.1992106437683105  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.1992106437683105  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.199243068695068  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.19995641708374  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([30, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.2000555992126465  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.2000555992126465  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.200112819671631  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.201772212982178  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([41, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.201941013336182  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.201941013336182  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.202019214630127  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.204834461212158  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([40, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.205026149749756  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.205026149749756  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.205102443695068  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.208383083343506  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([39, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.2086076736450195  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.2086076736450195  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.208682060241699  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.212401390075684  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([36, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.21264123916626  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.21264123916626  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.212709903717041  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.216623783111572  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.216831684112549  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.216831684112549  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.216885089874268  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.220303058624268  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([36, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.220622539520264  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.220622539520264  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.220691204071045  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.225566387176514  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([46, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.22601842880249  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.22601842880249  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.2261061668396  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.232949733734131  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([46, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.233436584472656  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.233436584472656  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.233524322509766  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.2409820556640625  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([40, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.241438388824463  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.241438388824463  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.241514682769775  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.248533725738525  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.248993873596191  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.248993873596191  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.2490644454956055  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.256051063537598  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([35, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.256520748138428  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.256520748138428  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.256587505340576  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.2636637687683105  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.264276504516602  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.264276504516602  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.26435661315918  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.273408889770508  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.2739410400390625  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.2739410400390625  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.274007797241211  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.282018661499023  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.282521724700928  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.282521724700928  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.282580852508545  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.290090084075928  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([40, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.290791034698486  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.290791034698486  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.290867328643799  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.301090717315674  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([46, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.301937103271484  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.301937103271484  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.302024841308594  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.314395904541016  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([36, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.3150787353515625  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.3150787353515625  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.315147399902344  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.325309753417969  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([47, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.326272010803223  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.326272010803223  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.326361656188965  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.340256690979004  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([43, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.34116268157959  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.34116268157959  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.341244697570801  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.354531288146973  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([38, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.355367183685303  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.355367183685303  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.35543966293335  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.3676886558532715  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([10246, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.613844871520996  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.613844871520996  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 10246, 256]), torch.Size([1, 10246, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.633668899536133  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 9.073183059692383  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 10246, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 8.818373203277588  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 8.82032060623169  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 8.822268009185791  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 8.820237636566162  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

torch.Size([11111, 47])
input nodes number: 84157
output nodes number: 11111
edges number: 267815
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 8.820489883422852  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 8.82049036026001  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.11535167694091797  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

pseudo mini batch 4 input nodes size: 251077
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.09261512756347656  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.09261512756347656  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.18614864349365234  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.18623018264770508  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.10065031051635742  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.10853052139282227  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.10853052139282227  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

first layer input nodes number: 251077
first layer output nodes number: 81270
edges number: 789740
----------------------------------------before model layer 0
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.11102724075317383  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

torch.Size([251077, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.11102724075317383  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

m.shape torch.Size([197, 1, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4136176109313965  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4136176109313965  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 197, 100]), torch.Size([1, 197, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.41376447677612305  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.41493940353393555  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 197, 100])
m.shape torch.Size([264, 2, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.41506290435791016  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.41506290435791016  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 264, 100]), torch.Size([1, 264, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.41526031494140625  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.418212890625  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 264, 100])
m.shape torch.Size([454, 3, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4186220169067383  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4186220169067383  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 454, 100]), torch.Size([1, 454, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4189605712890625  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4264044761657715  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 454, 100])
m.shape torch.Size([603, 4, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.42713403701782227  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.42713403701782227  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 603, 100]), torch.Size([1, 603, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.427584171295166  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.44062089920043945  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 603, 100])
m.shape torch.Size([737, 5, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4417686462402344  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4417686462402344  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 737, 100]), torch.Size([1, 737, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4423179626464844  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.462893009185791  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 737, 100])
m.shape torch.Size([834, 6, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.46448278427124023  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.46448278427124023  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 834, 100]), torch.Size([1, 834, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4651045799255371  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4924178123474121  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 834, 100])
m.shape torch.Size([912, 7, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.49448537826538086  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.49448537826538086  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 912, 100]), torch.Size([1, 912, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.4951653480529785  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5308966636657715  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 912, 100])
m.shape torch.Size([835, 8, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5330452919006348  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5330452919006348  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 835, 100]), torch.Size([1, 835, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.533668041229248  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5701780319213867  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 835, 100])
m.shape torch.Size([852, 9, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.572723388671875  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.572723388671875  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 852, 100]), torch.Size([1, 852, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.5733585357666016  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.6150684356689453  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 852, 100])
m.shape torch.Size([75582, 10, 100])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.8963160514831543  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.8963160514831543  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 75582, 100]), torch.Size([1, 75582, 100])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.952629566192627  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 4.950860500335693  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 75582, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 4.657253265380859  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 4.734758377075195  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 4.812263488769531  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 4.734758377075195  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

torch.Size([81270, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 4.812263488769531  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 4.831794738769531  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 4.831794738769531  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

m.shape torch.Size([12, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.089871406555176  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.089871406555176  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.0898942947387695  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.0900774002075195  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.090072154998779  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.090072154998779  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.090077877044678  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.090163707733154  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.090184211730957  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.090184211730957  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.0901994705200195  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.0905351638793945  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([18, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.090597152709961  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.090597152709961  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.090631484985352  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.09162712097168  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([19, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.091701507568359  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.091701507568359  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.091737747192383  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.093042373657227  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([16, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.093116760253906  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.093116760253906  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.093147277832031  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.094459533691406  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([28, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.094633102416992  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.094633102416992  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.094686508178711  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.097356796264648  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([19, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.097476482391357  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.097476482391357  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.097512722015381  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.099578380584717  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([26, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.099785327911377  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.099785327911377  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.09983491897583  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.10300874710083  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.103195667266846  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.103195667266846  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.103237628936768  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.106216907501221  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([25, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.1064605712890625  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.1064605712890625  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.106508255004883  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.110227584838867  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([27, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.110515594482422  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.110515594482422  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.110567092895508  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.1149444580078125  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([17, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.115131378173828  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.115131378173828  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.115163803100586  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.118146896362305  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([27, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.118494033813477  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.118494033813477  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.1185455322265625  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.12364387512207  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([34, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.12410831451416  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.12410831451416  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.124173164367676  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.131047248840332  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([19, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.131307125091553  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.131307125091553  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.131343364715576  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.135438442230225  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([27, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.135861873626709  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.135861873626709  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.135913372039795  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.142093181610107  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.142482757568359  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.142482757568359  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.142528533935547  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.148342132568359  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.148721218109131  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.148721218109131  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.148763179779053  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.154386043548584  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.154730319976807  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.154730319976807  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.15476655960083  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.159876346588135  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([26, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.160383224487305  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.160383224487305  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.160432815551758  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.16777229309082  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.168276309967041  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.168276309967041  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.168323993682861  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.17571496963501  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([29, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.176332473754883  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.176332473754883  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.176387786865234  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.1853485107421875  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.1858978271484375  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.1858978271484375  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.185945510864258  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.194004058837891  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([10425, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.444473743438721  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.444473743438721  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 10425, 256]), torch.Size([1, 10425, 256])
----------------------------------------3
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 5.464357852935791  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 8.963961124420166  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 10425, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 8.708834648132324  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 8.710763931274414  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 8.712679862976074  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 8.710669040679932  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

torch.Size([10942, 47])
input nodes number: 81270
output nodes number: 10942
edges number: 267796
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 8.71133804321289  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 8.711338520050049  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.12379741668701172  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

pseudo mini batch 5 input nodes size: 295785
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.1006321907043457  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.1006321907043457  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.21082115173339844  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.2109050750732422  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.11729001998901367  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.12722253799438477  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.12722253799438477  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

first layer input nodes number: 295785
first layer output nodes number: 106284
edges number: 1054025
----------------------------------------before model layer 0
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.130218505859375  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

torch.Size([295785, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.2674560546875 GB
    Memory Allocated: 0.130218505859375  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

m.shape torch.Size([114, 1, 100])
----------------------------------------1
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5339460372924805  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5339460372924805  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 114, 100]), torch.Size([1, 114, 100])
----------------------------------------3
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.534031867980957  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5347142219543457  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 114, 100])
m.shape torch.Size([132, 2, 100])
----------------------------------------1
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5347700119018555  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5347700119018555  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 132, 100]), torch.Size([1, 132, 100])
----------------------------------------3
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5348691940307617  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5363483428955078  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 132, 100])
m.shape torch.Size([158, 3, 100])
----------------------------------------1
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.536475658416748  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.536475658416748  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 158, 100]), torch.Size([1, 158, 100])
----------------------------------------3
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5365939140319824  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.539186954498291  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 158, 100])
m.shape torch.Size([194, 4, 100])
----------------------------------------1
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5394172668457031  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5394172668457031  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 194, 100]), torch.Size([1, 194, 100])
----------------------------------------3
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5395622253417969  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5437602996826172  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 194, 100])
m.shape torch.Size([249, 5, 100])
----------------------------------------1
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.544151782989502  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.544151782989502  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 249, 100]), torch.Size([1, 249, 100])
----------------------------------------3
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5443377494812012  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.551025390625  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 249, 100])
m.shape torch.Size([298, 6, 100])
----------------------------------------1
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5515985488891602  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5515985488891602  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 298, 100]), torch.Size([1, 298, 100])
----------------------------------------3
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5518207550048828  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.561375617980957  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 298, 100])
m.shape torch.Size([341, 7, 100])
----------------------------------------1
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5621538162231445  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5621538162231445  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 341, 100]), torch.Size([1, 341, 100])
----------------------------------------3
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.562408447265625  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5751199722290039  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 341, 100])
m.shape torch.Size([324, 8, 100])
----------------------------------------1
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.575958251953125  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.575958251953125  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 324, 100]), torch.Size([1, 324, 100])
----------------------------------------3
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5762004852294922  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5899734497070312  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 324, 100])
m.shape torch.Size([355, 9, 100])
----------------------------------------1
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5915136337280273  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5915136337280273  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 355, 100]), torch.Size([1, 355, 100])
----------------------------------------3
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.5917787551879883  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.6639404296875 GB
    Memory Allocated: 0.6087207794189453  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 355, 100])
m.shape torch.Size([104119, 10, 100])
----------------------------------------1
 Nvidia-smi: 17.0526123046875 GB
    Memory Allocated: 0.9972600936889648  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0526123046875 GB
    Memory Allocated: 0.9972600936889648  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 104119, 100]), torch.Size([1, 104119, 100])
----------------------------------------3
 Nvidia-smi: 17.0526123046875 GB
    Memory Allocated: 1.0748348236083984  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.582640647888184  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 104119, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.188802242279053  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.290162563323975  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.3915228843688965  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.290162563323975  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

torch.Size([106284, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.3915228843688965  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.416862964630127  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.416862964630127  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.685577392578125  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.685577392578125  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.685579299926758  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.68559455871582  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.685608386993408  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.685608386993408  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.685617923736572  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.685827732086182  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.685832977294922  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.685832977294922  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.6858367919921875  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.68597412109375  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.6860127449035645  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.6860127449035645  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.686026096343994  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.686600208282471  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.686616897583008  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.686616897583008  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.686622619628906  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.686948776245117  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([22, 9, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.687136650085449  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.687136650085449  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.687178611755371  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.689864158630371  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.6898627281188965  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.6898627281188965  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.689866542816162  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.6901373863220215  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 11, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.690167427062988  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.690167427062988  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.690173149108887  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.690619468688965  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 12, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.690674304962158  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.690674304962158  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.690683841705322  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.691494464874268  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 13, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.691552639007568  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.691552639007568  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.691562175750732  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.692439556121826  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 14, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.692502498626709  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.692502498626709  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.692512035369873  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.693456172943115  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([13, 15, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.693639278411865  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.693639278411865  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.693664073944092  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.696292400360107  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([7, 16, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.696387767791748  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.696387767791748  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.696401119232178  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.697909832000732  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 17, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.6979522705078125  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.6979522705078125  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.697957992553711  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.698644638061523  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 18, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.698711395263672  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.698711395263672  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.698719024658203  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.699687957763672  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.699848651885986  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.699848651885986  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.699865818023682  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.7021660804748535  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.702330589294434  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.702330589294434  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.702347755432129  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.704768180847168  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.7050018310546875  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.7050018310546875  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.705024719238281  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.708412170410156  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.7085065841674805  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.7085065841674805  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.7085161209106445  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.709994316101074  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 23, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.710056304931641  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.710056304931641  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.710062026977539  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.710988998413086  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.711240291595459  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.711240291595459  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.71126127243042  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.714807033538818  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11079, 25, 256])
----------------------------------------1
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.981168746948242  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 6.981168746948242  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

 h.shape torch.Size([1, 11079, 256]), torch.Size([1, 11079, 256])
----------------------------------------3
 Nvidia-smi: 19.3162841796875 GB
    Memory Allocated: 7.002300262451172  GigaBytes
Max Memory Allocated: 10.114136219024658  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.5819091796875 GB
    Memory Allocated: 10.725897789001465  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 11079, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 19.5819091796875 GB
    Memory Allocated: 10.459725379943848  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 19.5819091796875 GB
    Memory Allocated: 10.46195363998413  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 19.5819091796875 GB
    Memory Allocated: 10.464181900024414  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 19.5819091796875 GB
    Memory Allocated: 10.461869716644287  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

torch.Size([11215, 47])
input nodes number: 106284
output nodes number: 11215
edges number: 278989
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.5819091796875 GB
    Memory Allocated: 10.4630446434021  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.5819091796875 GB
    Memory Allocated: 10.463045120239258  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.1444835662841797  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

pseudo mini batch 6 input nodes size: 222076
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.11758899688720703  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.11758899688720703  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.2003188133239746  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.20040130615234375  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.09012842178344727  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.09849214553833008  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.09849214553833008  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

first layer input nodes number: 222076
first layer output nodes number: 86003
edges number: 848360
----------------------------------------before model layer 0
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.10078763961791992  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

torch.Size([222076, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.10078763961791992  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

m.shape torch.Size([80, 1, 100])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.426114559173584  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.426114559173584  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 80, 100]), torch.Size([1, 80, 100])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4261746406555176  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4266524314880371  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 80, 100])
m.shape torch.Size([157, 2, 100])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4267396926879883  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4267396926879883  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 157, 100]), torch.Size([1, 157, 100])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.42685699462890625  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.42861366271972656  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 157, 100])
m.shape torch.Size([239, 3, 100])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.42882251739501953  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.42882251739501953  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 239, 100]), torch.Size([1, 239, 100])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4290008544921875  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.432919979095459  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 239, 100])
m.shape torch.Size([295, 4, 100])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4332704544067383  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4332704544067383  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 295, 100]), torch.Size([1, 295, 100])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4334907531738281  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4398679733276367  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 295, 100])
m.shape torch.Size([358, 5, 100])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.44042491912841797  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.44042491912841797  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 358, 100]), torch.Size([1, 358, 100])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4406919479370117  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.45029783248901367  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 358, 100])
m.shape torch.Size([379, 6, 100])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.45101165771484375  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.45101165771484375  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 379, 100]), torch.Size([1, 379, 100])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4512948989868164  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.46344852447509766  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 379, 100])
m.shape torch.Size([439, 7, 100])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.46500730514526367  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.46500730514526367  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 439, 100]), torch.Size([1, 439, 100])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.465334415435791  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4816899299621582  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 439, 100])
m.shape torch.Size([532, 8, 100])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4831118583679199  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4831118583679199  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 532, 100]), torch.Size([1, 532, 100])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4835085868835449  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.506110668182373  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 532, 100])
m.shape torch.Size([564, 9, 100])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.5078034400939941  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.5078034400939941  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 564, 100]), torch.Size([1, 564, 100])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.5082240104675293  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.5351276397705078  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 564, 100])
m.shape torch.Size([82960, 10, 100])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.8439674377441406  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.8439674377441406  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 82960, 100]), torch.Size([1, 82960, 100])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.9057779312133789  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.294294357299805  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 82960, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.977411270141602  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.059430122375488  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.141448974609375  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.059430122375488  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

torch.Size([86003, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.141448974609375  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.161953926086426  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.161953926086426  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.426279067993164  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.426279067993164  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.426280975341797  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.426309585571289  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.426320552825928  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.426320552825928  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.426328182220459  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.4264960289001465  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 4, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.42650032043457  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.42650032043457  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.426504135131836  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.426614761352539  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.4266228675842285  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.4266228675842285  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.426626682281494  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.426764011383057  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([9, 6, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.426814079284668  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.426814079284668  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.426831245422363  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.427569389343262  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([5, 7, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.4275946617126465  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.4275946617126465  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.4276041984558105  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.428081035614014  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([13, 8, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.428176403045654  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.428176403045654  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.428201198577881  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.429614543914795  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([7, 9, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.429662704467773  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.429662704467773  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.429676055908203  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.430530548095703  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 10, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.430620193481445  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.430620193481445  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.430639266967773  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.43199348449707  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10, 11, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.432089805603027  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.432089805603027  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.4321088790893555  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.433596611022949  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 12, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.433714389801025  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.433714389801025  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.433735370635986  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.435518741607666  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([6, 13, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.435583591461182  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.435583591461182  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.4355950355529785  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.436647891998291  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([11, 14, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.436790466308594  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.436790466308594  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.436811447143555  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.4388885498046875  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 15, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.439094543457031  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.439094543457031  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.439123153686523  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.442155838012695  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([8, 16, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.442264556884766  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.442264556884766  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.442279815673828  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.444004058837891  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 17, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.444094657897949  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.444094657897949  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.444106101989746  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.445479393005371  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([12, 18, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.445681571960449  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.445681571960449  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.445704460144043  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.448611259460449  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([8, 19, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.448746204376221  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.448746204376221  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.448761463165283  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.450806140899658  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.451144695281982  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.451144695281982  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.451179027557373  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.456019878387451  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.456326007843018  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.456326007843018  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.456356525421143  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.460873126983643  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([13, 22, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.461133003234863  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.461133003234863  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.46115779876709  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.465001106262207  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.465165615081787  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.465165615081787  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.46518087387085  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.467652797698975  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([12, 24, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.467922210693359  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.467922210693359  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.467945098876953  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.471813201904297  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10840, 25, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.732545375823975  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.732545375823975  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 10840, 256]), torch.Size([1, 10840, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 5.753221035003662  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 9.392137050628662  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 10840, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 9.130659103393555  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 9.132956981658936  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 9.135254859924316  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 9.132874488830566  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

torch.Size([11047, 47])
input nodes number: 86003
output nodes number: 11047
edges number: 274139
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 9.133667469024658  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 9.133667945861816  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.11332273483276367  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

pseudo mini batch 7 input nodes size: 177932
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.09019804000854492  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.09019804000854492  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.15648317337036133  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.15656328201293945  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.07375097274780273  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.0810847282409668  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.0810847282409668  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

first layer input nodes number: 177932
first layer output nodes number: 75516
edges number: 730654
----------------------------------------before model layer 0
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.08297348022460938  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

torch.Size([177932, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.08297348022460938  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

m.shape torch.Size([179, 1, 100])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.36376190185546875  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.36376190185546875  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 179, 100]), torch.Size([1, 179, 100])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.3638954162597656  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.3649635314941406  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 179, 100])
m.shape torch.Size([362, 2, 100])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.36516666412353516  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.36516666412353516  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 362, 100]), torch.Size([1, 362, 100])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.3654365539550781  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.36948490142822266  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 362, 100])
m.shape torch.Size([445, 3, 100])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.36984729766845703  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.36984729766845703  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 445, 100]), torch.Size([1, 445, 100])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.3701791763305664  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.37747621536254883  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 445, 100])
m.shape torch.Size([624, 4, 100])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.37824010848999023  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.37824010848999023  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 624, 100]), torch.Size([1, 624, 100])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.3787055015563965  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.39219045639038086  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 624, 100])
m.shape torch.Size([740, 5, 100])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.39333629608154297  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.39333629608154297  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 740, 100]), torch.Size([1, 740, 100])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.3938884735107422  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.41400623321533203  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 740, 100])
m.shape torch.Size([898, 6, 100])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4166254997253418  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4166254997253418  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 898, 100]), torch.Size([1, 898, 100])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.417294979095459  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4460740089416504  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 898, 100])
m.shape torch.Size([931, 7, 100])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4481673240661621  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4481673240661621  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 931, 100]), torch.Size([1, 931, 100])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.44886159896850586  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.48479127883911133  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 931, 100])
m.shape torch.Size([1007, 8, 100])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4874453544616699  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.4874453544616699  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 1007, 100]), torch.Size([1, 1007, 100])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.48819589614868164  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.5309653282165527  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 1007, 100])
m.shape torch.Size([1041, 9, 100])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.5340805053710938  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.5340805053710938  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 1041, 100]), torch.Size([1, 1041, 100])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.5348567962646484  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.5875558853149414  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 1041, 100])
m.shape torch.Size([69289, 10, 100])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.8452897071838379  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.8452897071838379  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 69289, 100]), torch.Size([1, 69289, 100])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 0.8969149589538574  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.562264919281006  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 69289, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.290978908538818  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.362996578216553  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.435014247894287  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.362996578216553  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

torch.Size([75516, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.435014247894287  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.453018665313721  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.453018665313721  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

m.shape torch.Size([18, 1, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.697119235992432  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.697119235992432  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.697153568267822  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.697428226470947  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([32, 2, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.69747257232666  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.69747257232666  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.69753360748291  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.69844913482666  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([40, 3, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.69853401184082  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.69853401184082  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.698610305786133  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.700288772583008  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([54, 4, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.700458526611328  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.700458526611328  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.7005615234375  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.703548431396484  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([47, 5, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.703722953796387  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.703722953796387  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.703812599182129  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.707039833068848  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([56, 6, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.707318305969238  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.707318305969238  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.707425117492676  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.712018013000488  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([57, 7, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.712348461151123  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.712348461151123  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.712457180023193  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.717893123626709  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([67, 8, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.718354225158691  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.718354225158691  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.71848201751709  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.725766181945801  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([56, 9, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.726186752319336  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.726186752319336  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.726293563842773  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.733129501342773  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([50, 10, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.733556747436523  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.733556747436523  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.733652114868164  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.740423202514648  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([60, 11, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.7410101890563965  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.7410101890563965  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.741124629974365  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.750051021575928  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([43, 12, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.750490188598633  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.750490188598633  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.750572204589844  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.757543563842773  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([56, 13, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.75820255279541  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.75820255279541  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.758309364318848  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.768136024475098  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([52, 14, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.768782615661621  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.768782615661621  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.768881797790527  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.778700828552246  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.779386520385742  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.779386520385742  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.779483795166016  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.789794921875  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([52, 16, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.79054594039917  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.79054594039917  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.790645122528076  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.801852703094482  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([65, 17, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.80287504196167  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.80287504196167  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.802999019622803  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.81787633895874  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([53, 18, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.818731307983398  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.818731307983398  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.8188323974609375  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.831670761108398  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([60, 19, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.832792282104492  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.832792282104492  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.832906723022461  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.848241806030273  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([47, 20, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.849088191986084  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.849088191986084  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.849177837371826  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.861817836761475  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([45, 21, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.8626813888549805  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.8626813888549805  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.862767219543457  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.875470161437988  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([49, 22, 256])
----------------------------------------1
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.876467704772949  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.876467704772949  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 19.8494873046875 GB
    Memory Allocated: 4.876561164855957  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8572998046875 GB
    Memory Allocated: 4.891047477722168  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([47, 23, 256])
----------------------------------------1
 Nvidia-smi: 19.8572998046875 GB
    Memory Allocated: 4.892223358154297  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8572998046875 GB
    Memory Allocated: 4.892223358154297  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 19.8572998046875 GB
    Memory Allocated: 4.892313003540039  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8709716796875 GB
    Memory Allocated: 4.906835556030273  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([51, 24, 256])
----------------------------------------1
 Nvidia-smi: 19.8709716796875 GB
    Memory Allocated: 4.90801477432251  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8709716796875 GB
    Memory Allocated: 4.90801477432251  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 19.8709716796875 GB
    Memory Allocated: 4.908112049102783  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8885498046875 GB
    Memory Allocated: 4.924551486968994  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([9516, 25, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.1531548500061035  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.1531548500061035  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 9516, 256]), torch.Size([1, 9516, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.171305179595947  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 8.365763187408447  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 9516, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 8.125150680541992  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 8.127692222595215  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 8.130335807800293  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 8.127714157104492  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

torch.Size([10724, 47])
input nodes number: 75516
output nodes number: 10724
edges number: 253524
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 8.128600597381592  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 8.12860107421875  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.09451580047607422  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

pseudo mini batch 8 input nodes size: 263423
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.07399463653564453  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.07399463653564453  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.17212772369384766  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.17220687866210938  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.10584163665771484  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.1140146255493164  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.1140146255493164  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

first layer input nodes number: 263423
first layer output nodes number: 87007
edges number: 844387
----------------------------------------before model layer 0
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.11662578582763672  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

torch.Size([263423, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.11662578582763672  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

m.shape torch.Size([205, 1, 100])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.4404726028442383  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.4404726028442383  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 205, 100]), torch.Size([1, 205, 100])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.4406261444091797  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.4418501853942871  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 205, 100])
m.shape torch.Size([375, 2, 100])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.44205284118652344  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.44205284118652344  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 375, 100]), torch.Size([1, 375, 100])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.44233226776123047  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.44652366638183594  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 375, 100])
m.shape torch.Size([469, 3, 100])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.44690847396850586  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.44690847396850586  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 469, 100]), torch.Size([1, 469, 100])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.44725847244262695  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.45494985580444336  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 469, 100])
m.shape torch.Size([619, 4, 100])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.45569753646850586  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.45569753646850586  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 619, 100]), torch.Size([1, 619, 100])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.4561591148376465  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.46953916549682617  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 619, 100])
m.shape torch.Size([836, 5, 100])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.47115564346313477  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.47115564346313477  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 836, 100]), torch.Size([1, 836, 100])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.47177934646606445  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.49471616744995117  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 836, 100])
m.shape torch.Size([883, 6, 100])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.49637842178344727  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.49637842178344727  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 883, 100]), torch.Size([1, 883, 100])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.4970364570617676  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.5258641242980957  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 883, 100])
m.shape torch.Size([993, 7, 100])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.5281248092651367  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.5281248092651367  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 993, 100]), torch.Size([1, 993, 100])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.528864860534668  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.5666079521179199  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 993, 100])
m.shape torch.Size([1058, 8, 100])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.5693912506103516  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.5693912506103516  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 1058, 100]), torch.Size([1, 1058, 100])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.5701799392700195  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.6171650886535645  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 1058, 100])
m.shape torch.Size([1034, 9, 100])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.6202378273010254  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.6202378273010254  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 1034, 100]), torch.Size([1, 1034, 100])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.6210083961486816  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.6735916137695312  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 1034, 100])
m.shape torch.Size([80535, 10, 100])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.9732227325439453  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.9732227325439453  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 80535, 100]), torch.Size([1, 80535, 100])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 1.0332260131835938  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.293458938598633  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 80535, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 4.980472087860107  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.063448429107666  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.146424770355225  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.063448429107666  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

torch.Size([87007, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.146424770355225  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.167169094085693  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.167169094085693  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

m.shape torch.Size([20, 1, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.410220146179199  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.410220146179199  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.4102582931518555  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.4105634689331055  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([28, 2, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.410598278045654  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.410598278045654  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.410651683807373  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.411452770233154  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([27, 3, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.41150426864624  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.41150426864624  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.411555767059326  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.412688732147217  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([56, 4, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.412878513336182  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.412878513336182  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.412985324859619  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.416082859039307  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([44, 5, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.41624116897583  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.41624116897583  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.416325092315674  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.419346332550049  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([51, 6, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.419598579406738  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.419598579406738  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.419695854187012  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.4238786697387695  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([50, 7, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.424166679382324  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.424166679382324  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.424262046813965  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.429030418395996  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([54, 8, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.429398059844971  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.429398059844971  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.429501056671143  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.4353718757629395  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([40, 9, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.435666561126709  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.435666561126709  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.4357428550720215  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.4406256675720215  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([53, 10, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.441097259521484  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.441097259521484  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.441198348999023  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.448375701904297  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([39, 11, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.448737621307373  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.448737621307373  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.448812007904053  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.454614162445068  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([38, 12, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.455015659332275  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.455015659332275  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.455088138580322  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.461248874664307  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([49, 13, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.461824893951416  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.461824893951416  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.461918354034424  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.470516681671143  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([47, 14, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.471102714538574  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.471102714538574  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.471192359924316  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.480067253112793  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([51, 15, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.480757713317871  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.480757713317871  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.4808549880981445  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.491166114807129  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([42, 16, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.491763591766357  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.491763591766357  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.4918437004089355  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.500895977020264  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([47, 17, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.50162410736084  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.50162410736084  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.501713752746582  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.5124711990356445  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([47, 18, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.513239860534668  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.513239860534668  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.51332950592041  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.524714469909668  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.525564670562744  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.525564670562744  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.525658130645752  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.538181781768799  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([35, 20, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.5388078689575195  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.5388078689575195  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.538874626159668  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.548287391662598  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.549021244049072  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.549021244049072  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.549093723297119  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.559820652008057  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([45, 22, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.560736179351807  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.560736179351807  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.560822010040283  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.57412576675415  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.574901103973389  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.574901103973389  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.574971675872803  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.586404323577881  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([53, 24, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.5877366065979  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.5877366065979  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.5878376960754395  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.604921817779541  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([9562, 25, 256])
----------------------------------------1
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.834628582000732  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.834628582000732  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 9562, 256]), torch.Size([1, 9562, 256])
----------------------------------------3
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 5.8528666496276855  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 9.063193798065186  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 9562, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 8.823233604431152  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 8.825833320617676  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 8.8284330368042  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 8.825754165649414  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

torch.Size([10602, 47])
input nodes number: 87007
output nodes number: 10602
edges number: 252433
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 8.826539993286133  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 8.826540470123291  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.12847328186035156  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

pseudo mini batch 9 input nodes size: 349971
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.10589981079101562  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.10589981079101562  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.23627424240112305  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.2363581657409668  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.13814592361450195  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.14853715896606445  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.14853715896606445  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

first layer input nodes number: 349971
first layer output nodes number: 112698
edges number: 1117016
----------------------------------------before model layer 0
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.15198469161987305  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

torch.Size([349971, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 19.8924560546875 GB
    Memory Allocated: 0.15198469161987305  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

m.shape torch.Size([100, 1, 100])
----------------------------------------1
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5798311233520508  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5798311233520508  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 100, 100]), torch.Size([1, 100, 100])
----------------------------------------3
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5799064636230469  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5805048942565918  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 100, 100])
m.shape torch.Size([161, 2, 100])
----------------------------------------1
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5805873870849609  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5805873870849609  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 161, 100]), torch.Size([1, 161, 100])
----------------------------------------3
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5807075500488281  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5825099945068359  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 161, 100])
m.shape torch.Size([210, 3, 100])
----------------------------------------1
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5826849937438965  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5826849937438965  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 210, 100]), torch.Size([1, 210, 100])
----------------------------------------3
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5828423500061035  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5862913131713867  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 210, 100])
m.shape torch.Size([239, 4, 100])
----------------------------------------1
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5865688323974609  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5865688323974609  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 239, 100]), torch.Size([1, 239, 100])
----------------------------------------3
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5867471694946289  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5919132232666016  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 239, 100])
m.shape torch.Size([253, 5, 100])
----------------------------------------1
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5922956466674805  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5922956466674805  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 253, 100]), torch.Size([1, 253, 100])
----------------------------------------3
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5924844741821289  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5992751121520996  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 253, 100])
m.shape torch.Size([307, 6, 100])
----------------------------------------1
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5998673439025879  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.5998673439025879  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 307, 100]), torch.Size([1, 307, 100])
----------------------------------------3
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.6000962257385254  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.6099381446838379  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 307, 100])
m.shape torch.Size([387, 7, 100])
----------------------------------------1
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.6116714477539062  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.6116714477539062  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 387, 100]), torch.Size([1, 387, 100])
----------------------------------------3
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.6119604110717773  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.6263885498046875  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 387, 100])
m.shape torch.Size([380, 8, 100])
----------------------------------------1
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.6283116340637207  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.6283116340637207  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 380, 100]), torch.Size([1, 380, 100])
----------------------------------------3
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.6285948753356934  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.6447396278381348  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 380, 100])
m.shape torch.Size([458, 9, 100])
----------------------------------------1
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.6469478607177734  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.6469478607177734  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 458, 100]), torch.Size([1, 458, 100])
----------------------------------------3
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.6472892761230469  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 20.3104248046875 GB
    Memory Allocated: 0.6691398620605469  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 458, 100])
m.shape torch.Size([110203, 10, 100])
----------------------------------------1
 Nvidia-smi: 20.7225341796875 GB
    Memory Allocated: 1.0795073509216309  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 20.7225341796875 GB
    Memory Allocated: 1.0795073509216309  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 110203, 100]), torch.Size([1, 110203, 100])
----------------------------------------3
 Nvidia-smi: 20.7225341796875 GB
    Memory Allocated: 1.1616158485412598  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 6.991276264190674  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 110203, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 6.573977470397949  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 6.681454658508301  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 6.788931846618652  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 6.681454658508301  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

torch.Size([112698, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 6.788931846618652  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 6.81580114364624  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 6.81580114364624  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.083802223205566  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.083802223205566  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.083806037902832  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.083836555480957  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.083837032318115  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.083837032318115  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.083838939666748  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.08386754989624  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([19, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.083921432495117  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.083921432495117  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.083957672119141  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.084754943847656  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.08478307723999  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.08478307723999  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.084805965423584  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.085469722747803  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([7, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.085492134094238  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.085492134094238  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.085505485534668  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.085986137390137  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.086014270782471  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.086014270782471  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.086025714874268  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.086517810821533  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([12, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.086593151092529  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.086593151092529  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.086616039276123  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.0877604484558105  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.087764739990234  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.087764739990234  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.0877685546875  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.087985992431641  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([23, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.088183403015137  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.088183403015137  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.088227272033691  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.091034889221191  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([7, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.091080665588379  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.091080665588379  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.091094017028809  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.092041969299316  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.092088222503662  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.092088222503662  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.092097759246826  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.092841625213623  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([22, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.093091011047363  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.093091011047363  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.093132972717285  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.0966997146606445  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([22, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.096953868865967  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.096953868865967  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.096995830535889  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.100856304168701  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([8, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.100943088531494  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.100943088531494  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.100958347320557  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.102468967437744  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([19, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.10273551940918  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.10273551940918  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.102771759033203  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.1066131591796875  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.106902599334717  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.106902599334717  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.106940746307373  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.111251354217529  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.111510276794434  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.111510276794434  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.111542701721191  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.115433692932129  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.115919589996338  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.115919589996338  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.1159749031066895  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.122999668121338  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.123355865478516  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.123355865478516  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.123395919799805  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.128763198852539  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.129031658172607  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.129031658172607  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.1290602684021  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.133094310760498  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.1334638595581055  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.1334638595581055  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.133500099182129  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.138863563537598  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([14, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.13914155960083  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.13914155960083  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.1391682624816895  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.143307209014893  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.14371395111084  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.14371395111084  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.143750190734863  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.14962100982666  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.150202751159668  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.150202751159668  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.150252342224121  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.158633232116699  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([10894, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.420409679412842  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.420409679412842  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

 h.shape torch.Size([1, 10894, 256]), torch.Size([1, 10894, 256])
----------------------------------------3
 Nvidia-smi: 22.1307373046875 GB
    Memory Allocated: 7.441188335418701  GigaBytes
Max Memory Allocated: 10.990041732788086  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3905029296875 GB
    Memory Allocated: 11.098658084869385  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 10894, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.3905029296875 GB
    Memory Allocated: 10.834099292755127  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.3905029296875 GB
    Memory Allocated: 10.83638048171997  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.3905029296875 GB
    Memory Allocated: 10.838661670684814  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.3905029296875 GB
    Memory Allocated: 10.836296558380127  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([11241, 47])
input nodes number: 112698
output nodes number: 11241
edges number: 277507
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3905029296875 GB
    Memory Allocated: 10.836901664733887  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.3905029296875 GB
    Memory Allocated: 10.836902141571045  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.16821670532226562  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

pseudo mini batch 10 input nodes size: 283706
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.13782739639282227  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.13782739639282227  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.2435164451599121  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.24359703063964844  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.11313867568969727  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.12160825729370117  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.12160825729370117  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

first layer input nodes number: 283706
first layer output nodes number: 89247
edges number: 876100
----------------------------------------before model layer 0
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.12438726425170898  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([283706, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.12438726425170898  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

m.shape torch.Size([140, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.46001100540161133  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.46001100540161133  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 140, 100]), torch.Size([1, 140, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.460115909576416  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.4609522819519043  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 140, 100])
m.shape torch.Size([216, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.4610610008239746  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.4610610008239746  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 216, 100]), torch.Size([1, 216, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.46122217178344727  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.4636368751525879  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 216, 100])
m.shape torch.Size([293, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.4638838768005371  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.4638838768005371  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 293, 100]), torch.Size([1, 293, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.46410226821899414  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.46890687942504883  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 293, 100])
m.shape torch.Size([405, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.46940135955810547  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.46940135955810547  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 405, 100]), torch.Size([1, 405, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.46970367431640625  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.47845935821533203  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 405, 100])
m.shape torch.Size([455, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.4791560173034668  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.4791560173034668  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 455, 100]), torch.Size([1, 455, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.4794955253601074  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.49170351028442383  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 455, 100])
m.shape torch.Size([548, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.49275875091552734  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.49275875091552734  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 548, 100]), torch.Size([1, 548, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.4931678771972656  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5107345581054688  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 548, 100])
m.shape torch.Size([699, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5123820304870605  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5123820304870605  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 699, 100]), torch.Size([1, 699, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5129036903381348  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.540036678314209  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 699, 100])
m.shape torch.Size([779, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5420975685119629  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5420975685119629  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 779, 100]), torch.Size([1, 779, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5426783561706543  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5768108367919922  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 779, 100])
m.shape torch.Size([779, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5791325569152832  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5791325569152832  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 779, 100]), torch.Size([1, 779, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5797133445739746  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6170864105224609  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 779, 100])
m.shape torch.Size([84933, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.9332022666931152  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.9332022666931152  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 84933, 100]), torch.Size([1, 84933, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.9964823722839355  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.5007643699646  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 84933, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.1743245124816895  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.259437084197998  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.344549655914307  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.259437084197998  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([89247, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.344549655914307  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.365828037261963  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.365828037261963  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

m.shape torch.Size([13, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.61669397354126  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.61669397354126  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.616718769073486  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.616917133331299  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.616931915283203  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.616931915283203  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.6169586181640625  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.617359161376953  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.617360591888428  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.617360591888428  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.617370128631592  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.617579936981201  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([25, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.617671489715576  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.617671489715576  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.6177191734313965  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.6191020011901855  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.619160175323486  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.619160175323486  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.619192600250244  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.620359897613525  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([9, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.620395660400391  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.620395660400391  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.620412826538086  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.621150970458984  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([32, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.6213579177856445  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.6213579177856445  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.6214189529418945  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.6244707107543945  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([25, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.624632835388184  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.624632835388184  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.624680519104004  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.627398490905762  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([49, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.627798557281494  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.627798557281494  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.627892017364502  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.633873462677002  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([23, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.634047985076904  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.634047985076904  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.634091854095459  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.637206554412842  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([40, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.637607574462891  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.637607574462891  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.637683868408203  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.643634796142578  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([59, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.644277572631836  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.644277572631836  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.644390106201172  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.653955459594727  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([53, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.654561519622803  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.654561519622803  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.654662609100342  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.6639628410339355  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([28, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.664289474487305  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.664289474487305  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.664342880249023  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.66963005065918  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([103, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.671178340911865  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.671178340911865  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.671374797821045  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.692199230194092  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([44, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.692777633666992  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.692777633666992  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.692861557006836  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.70234489440918  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([57, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.703234672546387  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.703234672546387  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.703343391418457  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.7163896560668945  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.716871738433838  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.716871738433838  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.716930866241455  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.724440097808838  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([79, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.725985050201416  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.725985050201416  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.726135730743408  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.746326923370361  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([42, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.747059345245361  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.747059345245361  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.7471394538879395  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.758434772491455  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([56, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.759966850280762  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.759966850280762  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.760073661804199  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.775881767272949  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([44, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.776759147644043  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.776759147644043  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.776843070983887  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.789851188659668  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([62, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.791383266448975  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.791383266448975  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.791501522064209  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.810658931732178  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([46, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.812171459197998  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.812171459197998  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.812259197235107  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.827086925506592  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([9846, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.063624382019043  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.063624382019043  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 9846, 256]), torch.Size([1, 9846, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.08241081237793  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 9.391608238220215  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 9846, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 9.143810272216797  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 9.146139144897461  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 9.148468017578125  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 9.146058559417725  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([10802, 47])
input nodes number: 89247
output nodes number: 10802
edges number: 260560
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 9.146852016448975  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 9.146852493286133  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.13629817962646484  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

pseudo mini batch 11 input nodes size: 407426
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.11318635940551758  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.11318635940551758  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.26496458053588867  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.2650442123413086  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.15927457809448242  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.16981029510498047  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.16981029510498047  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

first layer input nodes number: 407426
first layer output nodes number: 112333
edges number: 1110395
----------------------------------------before model layer 0
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.17368364334106445  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([407426, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.17368364334106445  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

m.shape torch.Size([131, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5991940498352051  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5991940498352051  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 131, 100]), torch.Size([1, 131, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5992922782897949  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6000752449035645  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 131, 100])
m.shape torch.Size([211, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6001834869384766  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6001834869384766  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 211, 100]), torch.Size([1, 211, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6003408432006836  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6027011871337891  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 211, 100])
m.shape torch.Size([260, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6029133796691895  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6029133796691895  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 260, 100]), torch.Size([1, 260, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6031079292297363  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6073751449584961  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 260, 100])
m.shape torch.Size([335, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6077771186828613  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6077771186828613  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 335, 100]), torch.Size([1, 335, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6080269813537598  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.615267276763916  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 335, 100])
m.shape torch.Size([381, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6158523559570312  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6158523559570312  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 381, 100]), torch.Size([1, 381, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6161365509033203  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6263604164123535  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 381, 100])
m.shape torch.Size([383, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6270747184753418  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6270747184753418  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 383, 100]), torch.Size([1, 383, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6273608207702637  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6396374702453613  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 383, 100])
m.shape torch.Size([450, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6406679153442383  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6406679153442383  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 450, 100]), torch.Size([1, 450, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6410036087036133  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.657778263092041  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 450, 100])
m.shape torch.Size([471, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6590142250061035  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6590142250061035  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 471, 100]), torch.Size([1, 471, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.659365177154541  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6793694496154785  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 471, 100])
m.shape torch.Size([509, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6809005737304688  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6809005737304688  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 509, 100]), torch.Size([1, 509, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6812801361083984  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.705559253692627  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 509, 100])
m.shape torch.Size([109202, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 1.1121788024902344  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 1.1121788024902344  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 109202, 100]), torch.Size([1, 109202, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 1.1942100524902344  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.978274345397949  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 109202, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.563015460968018  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.670144557952881  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.777273654937744  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.670144557952881  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([112333, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.777273654937744  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.804056167602539  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.804056167602539  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.053013801574707  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.053013801574707  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.0530195236206055  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.053065299987793  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.053076267242432  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.053076267242432  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.053089618682861  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.053289890289307  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([15, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.053326606750488  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.053326606750488  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.0533552169799805  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.053984642028809  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([45, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.05414342880249  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.05414342880249  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.054229259490967  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.056718349456787  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([12, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.056733131408691  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.056733131408691  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.056756019592285  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.05757999420166  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([15, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.057655334472656  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.057655334472656  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.057683944702148  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.0589141845703125  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([32, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.059115409851074  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.059115409851074  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.059176445007324  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.062228202819824  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.062382221221924  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.062382221221924  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.062427997589111  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.065037250518799  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([17, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.06516170501709  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.06516170501709  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.065194129943848  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.067269325256348  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([47, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.067705154418945  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.067705154418945  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.0677947998046875  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.074159622192383  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([50, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.074643611907959  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.074643611907959  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.0747389793396  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.082177639007568  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([41, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.0826029777526855  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.0826029777526855  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.082681179046631  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.089328289031982  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([23, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.089576721191406  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.089576721191406  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.089620590209961  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.093656539916992  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([64, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.09449577331543  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.09449577331543  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.09461784362793  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.10670280456543  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([58, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.107478141784668  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.107478141784668  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 58, 256]), torch.Size([1, 58, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.107588768005371  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.119315147399902  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 58, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.119598388671875  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.119598388671875  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.119640350341797  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.124382019042969  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.124688148498535  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.124688148498535  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.124726295471191  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.129303932189941  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.129821300506592  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.129821300506592  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.129880428314209  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.137389659881592  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.13778018951416  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.13778018951416  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.137824058532715  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.143702507019043  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([64, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.14491081237793  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.14491081237793  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.14503288269043  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.16224479675293  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.162971019744873  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.162971019744873  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.163045406341553  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.1740546226501465  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([45, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.17496919631958  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.17496919631958  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.175055027008057  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.188358783721924  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([35, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.189089775085449  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.189089775085449  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.189156532287598  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.1999711990356445  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([57, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.202019214630127  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.202019214630127  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.202127933502197  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.22050142288208  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([9884, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.457941055297852  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.457941055297852  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 9884, 256]), torch.Size([1, 9884, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 7.47679328918457  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 10.797990322113037  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 9884, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 10.551236152648926  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 10.553528785705566  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 10.555821418762207  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 10.553449153900146  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([10673, 47])
input nodes number: 112333
output nodes number: 10673
edges number: 258587
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 10.554329872131348  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 10.554330348968506  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.18774700164794922  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

pseudo mini batch 12 input nodes size: 341900
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.15923833847045898  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.15923833847045898  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.2866063117980957  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.28668689727783203  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.13482904434204102  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.14367246627807617  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.14367246627807617  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

first layer input nodes number: 341900
first layer output nodes number: 96842
edges number: 947675
----------------------------------------before model layer 0
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.146942138671875  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([341900, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.146942138671875  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

m.shape torch.Size([171, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5099978446960449  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5099978446960449  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 171, 100]), torch.Size([1, 171, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5101256370544434  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5111465454101562  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 171, 100])
m.shape torch.Size([287, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5112967491149902  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5112967491149902  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 287, 100]), torch.Size([1, 287, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5115113258361816  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5147213935852051  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 287, 100])
m.shape torch.Size([473, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5151429176330566  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5151429176330566  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 473, 100]), torch.Size([1, 473, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.515495777130127  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.52325439453125  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 473, 100])
m.shape torch.Size([539, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5238814353942871  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5238814353942871  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 539, 100]), torch.Size([1, 539, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5242838859558105  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5359377861022949  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 539, 100])
m.shape torch.Size([601, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5368638038635254  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5368638038635254  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 601, 100]), torch.Size([1, 601, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5373120307922363  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.553441047668457  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 601, 100])
m.shape torch.Size([692, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5555820465087891  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5555820465087891  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 692, 100]), torch.Size([1, 692, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5560979843139648  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5803971290588379  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 692, 100])
m.shape torch.Size([809, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5822491645812988  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.5822491645812988  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 809, 100]), torch.Size([1, 809, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.582852840423584  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6141824722290039  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 809, 100])
m.shape torch.Size([721, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6160297393798828  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6160297393798828  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 721, 100]), torch.Size([1, 721, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6165676116943359  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.649329662322998  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 721, 100])
m.shape torch.Size([723, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6514849662780762  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6514849662780762  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 723, 100]), torch.Size([1, 723, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6520237922668457  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 0.6890721321105957  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 723, 100])
m.shape torch.Size([91826, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 1.030881404876709  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 1.030881404876709  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 91826, 100]), torch.Size([1, 91826, 100])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 1.0992980003356934  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.956833362579346  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 91826, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.603850841522217  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.696206569671631  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.788562297821045  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.696206569671631  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([96842, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.788562297821045  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.811651229858398  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 5.811651229858398  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

m.shape torch.Size([17, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.041912078857422  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.041912078857422  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.04194450378418  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.042203903198242  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([34, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.042253494262695  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.042253494262695  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.042318344116211  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.043291091918945  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([126, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.043622016906738  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.043622016906738  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.043862342834473  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.049149513244629  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([103, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.0494256019592285  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.0494256019592285  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.049622058868408  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.055319309234619  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([125, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.055821895599365  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.055821895599365  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.056060314178467  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.064643383026123  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([167, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.065487384796143  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.065487384796143  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 167, 256]), torch.Size([1, 167, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.065805912017822  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.079502582550049  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 167, 256])
m.shape torch.Size([217, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.081026077270508  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.081026077270508  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 217, 256]), torch.Size([1, 217, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.081439971923828  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.102134704589844  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 217, 256])
m.shape torch.Size([102, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.102712154388428  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.102712154388428  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.102906703948975  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.1139960289001465  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([103, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.114789962768555  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.114789962768555  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.114986419677734  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.127559661865234  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([159, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.1293134689331055  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.1293134689331055  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.129616737365723  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.151148796081543  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([103, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.152845859527588  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.152845859527588  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.153042316436768  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.168365955352783  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([80, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.169190406799316  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.169190406799316  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.169342994689941  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.182312965393066  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([87, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.184085369110107  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.184085369110107  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 87, 256]), torch.Size([1, 87, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.184251308441162  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.199517726898193  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 87, 256])
m.shape torch.Size([164, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.20164155960083  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.20164155960083  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 164, 256]), torch.Size([1, 164, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.201954364776611  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.232922077178955  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 164, 256])
m.shape torch.Size([63, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.233674049377441  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.233674049377441  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.233794212341309  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.2465314865112305  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([115, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.248325347900391  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.248325347900391  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.248544692993164  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.2733306884765625  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([48, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.27400541305542  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.27400541305542  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 22.6561279296875 GB
    Memory Allocated: 6.274096965789795  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6678466796875 GB
    Memory Allocated: 6.285083293914795  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([96, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.6678466796875 GB
    Memory Allocated: 6.286890506744385  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6678466796875 GB
    Memory Allocated: 6.286890506744385  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 96, 256]), torch.Size([1, 96, 256])
----------------------------------------3
 Nvidia-smi: 22.6678466796875 GB
    Memory Allocated: 6.287073612213135  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6912841796875 GB
    Memory Allocated: 6.310328006744385  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 96, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.6912841796875 GB
    Memory Allocated: 6.31072998046875  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6912841796875 GB
    Memory Allocated: 6.31072998046875  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 22.6912841796875 GB
    Memory Allocated: 6.310781478881836  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6971435546875 GB
    Memory Allocated: 6.317682266235352  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([71, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.6971435546875 GB
    Memory Allocated: 6.319507598876953  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.6971435546875 GB
    Memory Allocated: 6.319507598876953  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 22.6971435546875 GB
    Memory Allocated: 6.319643020629883  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7166748046875 GB
    Memory Allocated: 6.338737487792969  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([54, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.7166748046875 GB
    Memory Allocated: 6.340518474578857  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7166748046875 GB
    Memory Allocated: 6.340518474578857  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 22.7166748046875 GB
    Memory Allocated: 6.340621471405029  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7322998046875 GB
    Memory Allocated: 6.355865001678467  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([50, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.7322998046875 GB
    Memory Allocated: 6.357662200927734  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7322998046875 GB
    Memory Allocated: 6.357662200927734  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 22.7322998046875 GB
    Memory Allocated: 6.357757568359375  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7459716796875 GB
    Memory Allocated: 6.372539520263672  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([71, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.7459716796875 GB
    Memory Allocated: 6.374344348907471  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7459716796875 GB
    Memory Allocated: 6.374344348907471  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 22.7459716796875 GB
    Memory Allocated: 6.3744797706604  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7694091796875 GB
    Memory Allocated: 6.39641809463501  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([83, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.7694091796875 GB
    Memory Allocated: 6.399115085601807  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.7694091796875 GB
    Memory Allocated: 6.399115085601807  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 83, 256]), torch.Size([1, 83, 256])
----------------------------------------3
 Nvidia-smi: 22.7694091796875 GB
    Memory Allocated: 6.39927339553833  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.7967529296875 GB
    Memory Allocated: 6.426027774810791  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 83, 256])
m.shape torch.Size([8525, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.8006591796875 GB
    Memory Allocated: 6.631040573120117  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8006591796875 GB
    Memory Allocated: 6.631040573120117  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 8525, 256]), torch.Size([1, 8525, 256])
----------------------------------------3
 Nvidia-smi: 22.8006591796875 GB
    Memory Allocated: 6.647300720214844  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8006591796875 GB
    Memory Allocated: 9.537940979003906  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 8525, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.8006591796875 GB
    Memory Allocated: 9.311141967773438  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.8006591796875 GB
    Memory Allocated: 9.31312608718872  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.8006591796875 GB
    Memory Allocated: 9.315203189849854  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.8006591796875 GB
    Memory Allocated: 9.313138484954834  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([10790, 47])
input nodes number: 96842
output nodes number: 10790
edges number: 239120
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8006591796875 GB
    Memory Allocated: 9.313632488250732  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.8006591796875 GB
    Memory Allocated: 9.31363296508789  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.15882444381713867  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

pseudo mini batch 13 input nodes size: 228189
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.1345205307006836  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.1345205307006836  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.2195277214050293  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.21961164474487305  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.0921630859375  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.10004615783691406  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.10004615783691406  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

first layer input nodes number: 228189
first layer output nodes number: 82485
edges number: 792427
----------------------------------------before model layer 0
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.10236120223999023  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([228189, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.10236120223999023  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

m.shape torch.Size([99, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4059720039367676  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4059720039367676  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 99, 100]), torch.Size([1, 99, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.40604639053344727  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.40663862228393555  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 99, 100])
m.shape torch.Size([199, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4067497253417969  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4067497253417969  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 199, 100]), torch.Size([1, 199, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.40689849853515625  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.40912437438964844  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 199, 100])
m.shape torch.Size([444, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4095463752746582  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4095463752746582  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 444, 100]), torch.Size([1, 444, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.40987730026245117  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4171576499938965  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 444, 100])
m.shape torch.Size([916, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.41835737228393555  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.41835737228393555  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 916, 100]), torch.Size([1, 916, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4190402030944824  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4399876594543457  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 916, 100])
m.shape torch.Size([1238, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4419522285461426  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4419522285461426  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 1238, 100]), torch.Size([1, 1238, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.44287538528442383  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4774050712585449  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 1238, 100])
m.shape torch.Size([1353, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4799680709838867  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4799680709838867  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 1353, 100]), torch.Size([1, 1353, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.48097705841064453  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5254435539245605  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 1353, 100])
m.shape torch.Size([1609, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5291352272033691  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5291352272033691  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 1609, 100]), torch.Size([1, 1609, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5303349494934082  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5902910232543945  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 1609, 100])
m.shape torch.Size([1612, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5944952964782715  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5944952964782715  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 1612, 100]), torch.Size([1, 1612, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5956969261169434  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6641669273376465  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 1612, 100])
m.shape torch.Size([1683, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6692090034484863  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6692090034484863  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 1683, 100]), torch.Size([1, 1683, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6704630851745605  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.7507243156433105  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 1683, 100])
m.shape torch.Size([73332, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 1.0232806205749512  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 1.0232806205749512  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 73332, 100]), torch.Size([1, 73332, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 1.0779175758361816  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 4.957127094268799  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 73332, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 4.663787364959717  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 4.742451190948486  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 4.821115016937256  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 4.742451190948486  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([82485, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 4.821115016937256  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 4.840781211853027  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 4.840781211853027  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.096616744995117  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.096616744995117  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.096622467041016  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.096668243408203  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.0966715812683105  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.0966715812683105  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.096677303314209  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.0967631340026855  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([13, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.096797943115234  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.096797943115234  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.096822738647461  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.097368240356445  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([22, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.097440719604492  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.097440719604492  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.097482681274414  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.098699569702148  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([29, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.098818302154541  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.098818302154541  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.098873615264893  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.100864887237549  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([44, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.101091384887695  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.101091384887695  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.101175308227539  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.10478401184082  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([64, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.105172634124756  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.105172634124756  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.105294704437256  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.111398220062256  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([51, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.111729621887207  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.111729621887207  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.1118268966674805  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.117371559143066  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([71, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.117937088012695  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.117937088012695  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 71, 256]), torch.Size([1, 71, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.118072509765625  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.126739501953125  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 71, 256])
m.shape torch.Size([94, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.127575397491455  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.127575397491455  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.1277546882629395  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.14048433303833  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([103, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.141876220703125  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.141876220703125  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 103, 256]), torch.Size([1, 103, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.142072677612305  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.15739631652832  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 103, 256])
m.shape torch.Size([79, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.158209323883057  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.158209323883057  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 79, 256]), torch.Size([1, 79, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.158360004425049  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.171167850494385  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 79, 256])
m.shape torch.Size([65, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.171905040740967  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.171905040740967  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.1720290184021  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.183434963226318  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([88, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.185018539428711  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.185018539428711  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.185186386108398  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.201803207397461  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([84, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.203364849090576  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.203364849090576  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 84, 256]), torch.Size([1, 84, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.203525066375732  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.220508098602295  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 84, 256])
m.shape torch.Size([91, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.222125053405762  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.222125053405762  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.222298622131348  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.241911888122559  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([74, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.243520736694336  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.243520736694336  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 74, 256]), torch.Size([1, 74, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.243661880493164  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.260599136352539  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 74, 256])
m.shape torch.Size([94, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.262227535247803  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.262227535247803  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.262406826019287  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.285176753997803  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([78, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.286784648895264  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.286784648895264  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.286933422088623  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.306869029998779  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([63, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.30849027633667  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.30849027633667  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.308610439300537  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.3255534172058105  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([89, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.327511310577393  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.327511310577393  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.327681064605713  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.352804660797119  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([94, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.35484504699707  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.35484504699707  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.355024337768555  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.382814407348633  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([88, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.384849548339844  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.384849548339844  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.385017395019531  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.412208557128906  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([60, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.413821697235107  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.413821697235107  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.413936138153076  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.433276653289795  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([9703, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.666666507720947  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.666666507720947  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 9703, 256]), torch.Size([1, 9703, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.685173511505127  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 8.942406177520752  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 9703, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 8.690428256988525  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 8.692537784576416  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 8.694652080535889  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 8.692458629608154  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([11247, 47])
input nodes number: 82485
output nodes number: 11247
edges number: 265522
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 8.69328260421753  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 8.693283081054688  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.11502742767333984  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

pseudo mini batch 14 input nodes size: 274762
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.09228849411010742  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.09228849411010742  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.19464540481567383  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.19472932815551758  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.10963821411132812  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.1192474365234375  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.1192474365234375  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

first layer input nodes number: 274762
first layer output nodes number: 102165
edges number: 1006651
----------------------------------------before model layer 0
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.12205648422241211  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([274762, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.12205648422241211  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

m.shape torch.Size([151, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5081405639648438  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5081405639648438  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 151, 100]), torch.Size([1, 151, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5082530975341797  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5091533660888672  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 151, 100])
m.shape torch.Size([189, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5092382431030273  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5092382431030273  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 189, 100]), torch.Size([1, 189, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5093793869018555  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5114936828613281  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 189, 100])
m.shape torch.Size([253, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5117058753967285  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5117058753967285  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 253, 100]), torch.Size([1, 253, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.511894702911377  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5160446166992188  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 253, 100])
m.shape torch.Size([364, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5164928436279297  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5164928436279297  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 364, 100]), torch.Size([1, 364, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5167646408081055  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5246353149414062  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 364, 100])
m.shape torch.Size([464, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5253639221191406  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5253639221191406  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 464, 100]), torch.Size([1, 464, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5257101058959961  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5381584167480469  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 464, 100])
m.shape torch.Size([525, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.539158821105957  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.539158821105957  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 525, 100]), torch.Size([1, 525, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.53955078125  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5563793182373047  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 525, 100])
m.shape torch.Size([569, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5576672554016113  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5576672554016113  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 569, 100]), torch.Size([1, 569, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5580916404724121  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5793008804321289  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 569, 100])
m.shape torch.Size([672, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5810914039611816  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5810914039611816  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 672, 100]), torch.Size([1, 672, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5815920829772949  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6125860214233398  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 672, 100])
m.shape torch.Size([702, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6146893501281738  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6146893501281738  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 702, 100]), torch.Size([1, 702, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6152129173278809  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6493353843688965  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 702, 100])
m.shape torch.Size([98276, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 1.0151805877685547  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 1.0151805877685547  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 98276, 100]), torch.Size([1, 98276, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 1.0884027481079102  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.28713321685791  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 98276, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.91166353225708  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.009095668792725  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.106527805328369  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.009095668792725  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([102165, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.106527805328369  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.131124019622803  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.131124019622803  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.39808464050293  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.39808464050293  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.398092269897461  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.398153305053711  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.398151874542236  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.398151874542236  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.398153781890869  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.398182392120361  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.398210525512695  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.398210525512695  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.398229598999023  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.398649215698242  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([3, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.398651599884033  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.398651599884033  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.398657321929932  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.398823261260986  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.398825645446777  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.398825645446777  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.39882755279541  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.398896217346191  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.398930072784424  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.398930072784424  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.398941516876221  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.399433612823486  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.399468421936035  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.399468421936035  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.399479866027832  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.400052070617676  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.400084972381592  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.400084972381592  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.400094509124756  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.400638103485107  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([11, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.400728702545166  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.400728702545166  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.400749683380127  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.402092456817627  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.402159214019775  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.402159214019775  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.402174472808838  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.403257846832275  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([12, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.403377532958984  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.403377532958984  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.403400421142578  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.405185699462891  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.405324459075928  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.405324459075928  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.405349254608154  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.407456874847412  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([19, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.407681941986084  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.407681941986084  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.407718181610107  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.411052227020264  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.411290168762207  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.411290168762207  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.4113264083862305  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.414914131164551  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([25, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.415256500244141  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.415256500244141  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.415304183959961  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.420358657836914  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([28, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.420765399932861  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.420765399932861  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.42081880569458  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.426853656768799  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([10, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.426990509033203  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.426990509033203  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.427009582519531  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.429298400878906  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.429635047912598  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.429635047912598  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.429673194885254  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.434517860412598  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([21, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.434882640838623  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.434882640838623  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.434922695159912  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.4402899742126465  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.440654754638672  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.440654754638672  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.440692901611328  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.446071624755859  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.446436405181885  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.446436405181885  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.446472644805908  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.451836109161377  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([19, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.4522199630737305  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.4522199630737305  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.452256202697754  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.457873344421387  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([33, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.458584785461426  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.458584785461426  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.458647727966309  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.468844413757324  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.469551086425781  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.469551086425781  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.469612121582031  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.479927062988281  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([10864, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.741870403289795  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.741870403289795  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 10864, 256]), torch.Size([1, 10864, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.76259183883667  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.410308837890625  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 10864, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.145997524261475  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.148454189300537  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.151078701019287  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.14853811264038  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([11209, 47])
input nodes number: 102165
output nodes number: 11209
edges number: 277247
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.149730682373047  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.149731159210205  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.1370840072631836  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

pseudo mini batch 15 input nodes size: 265083
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.1099853515625  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.1099853515625  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.20873689651489258  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.2088165283203125  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.10637569427490234  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.11504268646240234  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.11504268646240234  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

first layer input nodes number: 265083
first layer output nodes number: 91443
edges number: 899175
----------------------------------------before model layer 0
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.11769914627075195  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([265083, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.11769914627075195  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

m.shape torch.Size([144, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4621562957763672  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4621562957763672  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 144, 100]), torch.Size([1, 144, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4622640609741211  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4631233215332031  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 144, 100])
m.shape torch.Size([233, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4632434844970703  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4632434844970703  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 233, 100]), torch.Size([1, 233, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.46341800689697266  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.46602725982666016  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 233, 100])
m.shape torch.Size([289, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4662632942199707  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4662632942199707  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 289, 100]), torch.Size([1, 289, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4664788246154785  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4712204933166504  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 289, 100])
m.shape torch.Size([376, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.47167301177978516  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.47167301177978516  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 376, 100]), torch.Size([1, 376, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4719533920288086  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.48007869720458984  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 376, 100])
m.shape torch.Size([467, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.48080873489379883  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.48080873489379883  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 467, 100]), torch.Size([1, 467, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.4811568260192871  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.49368810653686523  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 467, 100])
m.shape torch.Size([535, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.49470996856689453  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.49470996856689453  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 535, 100]), torch.Size([1, 535, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.49510860443115234  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5122499465942383  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 535, 100])
m.shape torch.Size([529, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5137763023376465  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5137763023376465  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 529, 100]), torch.Size([1, 529, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5141711235046387  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5338921546936035  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 529, 100])
m.shape torch.Size([584, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5354351997375488  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5354351997375488  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 584, 100]), torch.Size([1, 584, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5358710289001465  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5606789588928223  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 584, 100])
m.shape torch.Size([586, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5624260902404785  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5624260902404785  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 586, 100]), torch.Size([1, 586, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5628628730773926  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5908169746398926  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 586, 100])
m.shape torch.Size([87700, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.9173069000244141  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.9173069000244141  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 87700, 100]), torch.Size([1, 87700, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.9837131500244141  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.6346845626831055  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 87700, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.298331260681152  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.385538101196289  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.472744941711426  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.385538101196289  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([91443, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.472744941711426  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.494546890258789  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.494546890258789  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.749195575714111  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.749195575714111  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.74920129776001  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.749247074127197  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.7492523193359375  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.7492523193359375  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.749259948730469  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.7493743896484375  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.749393939971924  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.749393939971924  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.749409198760986  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.749744892120361  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.749760627746582  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.749760627746582  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.749772071838379  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.750103950500488  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.750141620635986  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.750141620635986  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.750158786773682  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.750776767730713  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([3, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.750785827636719  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.750785827636719  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.750791549682617  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.75103759765625  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([11, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.7511091232299805  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.7511091232299805  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.751130104064941  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.752179145812988  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([9, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.7522382736206055  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.7522382736206055  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.752255439758301  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.753233909606934  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([17, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.753372669219971  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.753372669219971  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.7534050941467285  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.7554802894592285  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.755579471588135  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.755579471588135  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.7556023597717285  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.757227420806885  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([12, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.757343292236328  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.757343292236328  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.757366180419922  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.759151458740234  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([7, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.759221076965332  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.759221076965332  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.759234428405762  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.760369300842285  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.760475158691406  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.760475158691406  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.760492324829102  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.76207160949707  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.762170791625977  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.762170791625977  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.762186050415039  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.763696670532227  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.763833522796631  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.763833522796631  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.763852596282959  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.76587438583374  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([15, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.7660956382751465  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.7660956382751465  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.766124248504639  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.769357204437256  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([13, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.769555568695068  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.769555568695068  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.769580364227295  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.772555828094482  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.772855281829834  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.772855281829834  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.772889614105225  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.777249813079834  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.777543544769287  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.777543544769287  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.777575969696045  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.781920909881592  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.7822699546813965  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.7822699546813965  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.78230619430542  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.787415981292725  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.78764009475708  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.78764009475708  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.787662982940674  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.791050434112549  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.791398525238037  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.791398525238037  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.791430950164795  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.796456813812256  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.796706199645996  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.796706199645996  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.79672908782959  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.800436973571777  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.800887107849121  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.800887107849121  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.800925254821777  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 5.807372093200684  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([10402, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.057337760925293  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.057337760925293  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 10402, 256]), torch.Size([1, 10402, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.077178001403809  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 9.569191932678223  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 10402, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 9.317394733428955  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 9.319263458251953  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 9.321132183074951  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 9.319183826446533  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([10673, 47])
input nodes number: 91443
output nodes number: 10673
edges number: 264059
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 9.319356918334961  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 9.31935739517212  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.12975835800170898  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

pseudo mini batch 16 input nodes size: 334131
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.10578775405883789  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.10578775405883789  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.23026132583618164  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.23034334182739258  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.13151216506958008  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.14264965057373047  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.14264965057373047  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

first layer input nodes number: 334131
first layer output nodes number: 111045
edges number: 1101729
----------------------------------------before model layer 0
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.1459670066833496  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([334131, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.1459670066833496  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

m.shape torch.Size([133, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5679707527160645  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5679707527160645  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 133, 100]), torch.Size([1, 133, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5680699348449707  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5688633918762207  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 133, 100])
m.shape torch.Size([159, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5689325332641602  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5689325332641602  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 159, 100]), torch.Size([1, 159, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5690517425537109  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.570831298828125  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 159, 100])
m.shape torch.Size([157, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5709471702575684  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5709471702575684  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 157, 100]), torch.Size([1, 157, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5710644721984863  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5736408233642578  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 157, 100])
m.shape torch.Size([208, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5738921165466309  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5738921165466309  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 208, 100]), torch.Size([1, 208, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5740475654602051  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5785441398620605  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 208, 100])
m.shape torch.Size([207, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5788521766662598  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5788521766662598  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 207, 100]), torch.Size([1, 207, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5790066719055176  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5845613479614258  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 207, 100])
m.shape torch.Size([268, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5850834846496582  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5850834846496582  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 268, 100]), torch.Size([1, 268, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5852837562561035  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5938782691955566  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 268, 100])
m.shape torch.Size([289, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5945320129394531  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5945320129394531  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 289, 100]), torch.Size([1, 289, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5947475433349609  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6055240631103516  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 289, 100])
m.shape torch.Size([287, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6062717437744141  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6062717437744141  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 287, 100]), torch.Size([1, 287, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6064863204956055  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.618682861328125  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 287, 100])
m.shape torch.Size([357, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6202588081359863  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6202588081359863  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 357, 100]), torch.Size([1, 357, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6205248832702637  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6375536918640137  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 357, 100])
m.shape torch.Size([108980, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 1.043403148651123  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 1.043403148651123  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 108980, 100]), torch.Size([1, 108980, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 1.125434398651123  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.899570941925049  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 108980, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.487000465393066  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.592901229858398  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.6988019943237305  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.592901229858398  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([111045, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.6988019943237305  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.725277423858643  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.725277423858643  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.988239288330078  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.988239288330078  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.988245010375977  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.988370895385742  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.988372325897217  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.988372325897217  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.98837423324585  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.988429546356201  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.988433837890625  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.988433837890625  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.988435745239258  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.988504409790039  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([9, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.988555431365967  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.988555431365967  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.988572597503662  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.9893107414245605  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.989309310913086  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.989309310913086  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.989311218261719  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.989406585693359  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.989436626434326  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.989436626434326  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.989444255828857  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.989879131317139  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.989910125732422  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.989910125732422  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.989917755126953  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.990406036376953  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.990431308746338  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.990431308746338  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.990437030792236  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.990843296051025  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.990893363952637  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.990893363952637  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.990902900695801  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.991646766662598  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.9916768074035645  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.9916768074035645  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.991682529449463  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.99216890335083  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([10, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.992291450500488  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.992291450500488  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.992310523986816  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.994065284729004  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([2, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.994082927703857  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.994082927703857  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.994086742401123  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.99446439743042  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([7, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.994563579559326  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.994563579559326  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.994576930999756  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.995992183685303  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([1, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.996001243591309  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.996001243591309  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.996003150939941  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.996218681335449  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.996283531188965  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.996283531188965  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.996291160583496  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.997206687927246  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.997306823730469  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.997306823730469  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.997318267822266  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.998771667480469  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.998839378356934  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.998839378356934  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.998847007751465  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.999869346618652  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.999961853027344  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.999961853027344  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.999971389770508  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.001316070556641  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([5, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.001412391662598  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.001412391662598  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.001421928405762  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.002833366394043  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.002997875213623  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.002997875213623  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.0030131340026855  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.005378246307373  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.005547523498535  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.005547523498535  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.005562782287598  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.008034706115723  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.008257865905762  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.008257865905762  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.00827693939209  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.011500358581543  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([10861, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.272460460662842  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.272460460662842  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 10861, 256]), torch.Size([1, 10861, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.293176174163818  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.939979553222656  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 10861, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.679368495941162  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.681973457336426  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.684632301330566  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.681945323944092  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([10965, 47])
input nodes number: 111045
output nodes number: 10965
edges number: 273129
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.683591365814209  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.683591842651367  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.16076374053955078  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

pseudo mini batch 17 input nodes size: 331324
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.1322484016418457  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.1322484016418457  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.25567626953125  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.25575733184814453  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.13120174407958984  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.14112377166748047  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.14112377166748047  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

first layer input nodes number: 331324
first layer output nodes number: 107376
edges number: 1062804
----------------------------------------before model layer 0
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.1443924903869629  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([331324, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.1443924903869629  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

m.shape torch.Size([133, 1, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5514945983886719  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5514945983886719  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 133, 100]), torch.Size([1, 133, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5515937805175781  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5523872375488281  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 133, 100])
m.shape torch.Size([197, 2, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5524845123291016  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5524845123291016  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 197, 100]), torch.Size([1, 197, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5526313781738281  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5548343658447266  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 197, 100])
m.shape torch.Size([230, 3, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.555018424987793  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.555018424987793  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 230, 100]), torch.Size([1, 230, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5551900863647461  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.558962345123291  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 230, 100])
m.shape torch.Size([210, 4, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5591897964477539  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5591897964477539  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 210, 100]), torch.Size([1, 210, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5593471527099609  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5638933181762695  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 210, 100])
m.shape torch.Size([298, 5, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5643701553344727  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5643701553344727  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 298, 100]), torch.Size([1, 298, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5645923614501953  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5725917816162109  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 298, 100])
m.shape torch.Size([310, 6, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.573173999786377  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.573173999786377  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 310, 100]), torch.Size([1, 310, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5734057426452637  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5833449363708496  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 310, 100])
m.shape torch.Size([384, 7, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5845599174499512  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5845599174499512  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 384, 100]), torch.Size([1, 384, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.584846019744873  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.5991511344909668  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 384, 100])
m.shape torch.Size([451, 8, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6005306243896484  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6005306243896484  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 451, 100]), torch.Size([1, 451, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6008672714233398  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6200332641601562  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 451, 100])
m.shape torch.Size([529, 9, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6216387748718262  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6216387748718262  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 529, 100]), torch.Size([1, 529, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6220335960388184  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.6472764015197754  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 529, 100])
m.shape torch.Size([104634, 10, 100])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 1.0368714332580566  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 1.0368714332580566  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 104634, 100]), torch.Size([1, 104634, 100])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 1.114830493927002  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.653889179229736  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 104634, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.2569756507873535  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.359377384185791  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.4617791175842285  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.359377384185791  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([107376, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.4617791175842285  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.487379550933838  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.487379550933838  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.746114253997803  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.746114253997803  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.7461161613464355  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.746131420135498  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.746151924133301  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.746151924133301  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.746172904968262  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.746487617492676  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([7, 3, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.746497631072998  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.746497631072998  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.746510982513428  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.746804714202881  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.746813774108887  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.746813774108887  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.746821403503418  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.747042655944824  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.747063159942627  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.747063159942627  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.747072696685791  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.747416019439697  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([11, 6, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.7474751472473145  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.7474751472473145  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.747496128082275  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.748398303985596  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.748394966125488  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.748394966125488  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.748396873474121  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.748492240905762  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([6, 8, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.748537540435791  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.748537540435791  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.748548984527588  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.74920129776001  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 9, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.749265193939209  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.749265193939209  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.7492804527282715  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.7502570152282715  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.750268936157227  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.750268936157227  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.750272750854492  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.750543594360352  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 11, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.750563144683838  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.750563144683838  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.7505669593811035  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.750864505767822  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([15, 12, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.751035690307617  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.751035690307617  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.751064300537109  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.753496170043945  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 13, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.753694534301758  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.753694534301758  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.753726959228516  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.756710052490234  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([7, 14, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.75678825378418  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.75678825378418  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.756801605224609  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.758123397827148  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([1, 15, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.758131504058838  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.758131504058838  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.758133411407471  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.758335590362549  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 16, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.758396148681641  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.758396148681641  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.758403778076172  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.759265899658203  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 17, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.759393215179443  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.759393215179443  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.759408473968506  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.761239528656006  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([4, 18, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.761301517486572  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.761301517486572  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.7613091468811035  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.762278079986572  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.7626214027404785  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.7626214027404785  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.762657642364502  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.767513751983643  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.767591953277588  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.767591953277588  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.767601490020752  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.768946170806885  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([10, 21, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.769143581390381  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.769143581390381  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.769162654876709  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.7719855308532715  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6, 22, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.772103309631348  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.772103309631348  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.7721147537231445  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.77388858795166  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([17, 23, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.774259090423584  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.774259090423584  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.774291515350342  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.779544353485107  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([9, 24, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.779736042022705  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.779736042022705  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.7797532081604  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 6.782654285430908  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10648, 25, 256])
----------------------------------------1
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.038539409637451  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------2
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.038539409637451  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

 h.shape torch.Size([1, 10648, 256]), torch.Size([1, 10648, 256])
----------------------------------------3
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 7.058848857879639  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.653488636016846  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

rst.shape  torch.Size([1, 10648, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.397159099578857  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.399195194244385  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.401231288909912  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.39911413192749  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

torch.Size([10828, 47])
input nodes number: 107376
output nodes number: 10828
edges number: 268716
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.399426460266113  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 10.399426937103271  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.1579756736755371  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.16306257247924805  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.8026123046875 GB
    Memory Allocated: 0.16306257247924805  GigaBytes
Max Memory Allocated: 11.358423709869385  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.08702414565616184 |0.02481077777014838 |0.2087140745586819 |9.924835628933377e-05 |0.10460727744632298 |0.005321025848388672 |
----------------------------------------------------------pseudo_mini_loss sum 5.387596130371094
Total (block generation + training)time/epoch 78.77947425842285
* Pure training time/epoch 7.6599204540252686
Training time/epoch 7.777963161468506
Training time without block to device /epoch 7.331369161605835
Training time without total dataloading part /epoch 5.646891832351685
load block tensor time/epoch 1.566434621810913
block to device time/epoch 0.4465939998626709
input features size transfer per epoch 2.4139881134033203e-06
blocks size to device per epoch 1.6093254089355469e-06
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  6808741
Number of first layer input nodes during this epoch:  5094441
Number of first layer output nodes during this epoch:  1714300
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  682400
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([400, 100])
layers.0.lstm.weight_hh_l0, torch.Size([400, 100])
layers.0.lstm.bias_ih_l0, torch.Size([400])
layers.0.lstm.bias_hh_l0, torch.Size([400])
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([47, 256])
layers.1.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
