main start at this time 1655789915.1109395
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.3525726795196533
global_2_local spend time (sec) 0.40581321716308594
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.051017045974731445
A = g.adjacency_matrix() spent  0.07713127136230469
auxiliary_graph
Graph(num_nodes=1205586, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.6051783561706543
remove nodes length
1009015
auxiliary_graph.remove_nodes spent  2.9380087852478027
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.0638182163238525

the counter of shared neighbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
51547892
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 51547889, 51547890, 51547891])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
Convert a graph into a bidirected graph: 3.420 seconds
Metis partitioning: 12.812 seconds
Split the graph: 1.674 seconds
Construct subgraphs: 0.434 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  18.36120581626892
24918
25284
23879
25252
23963
23881
24296
25098
total k batches seeds list generation spend  40.07768726348877
after graph partition
graph partition algorithm spend time 40.777713775634766
24918
25284
23879
25252
23963
23881
24296
25098
partition_len_list
[189006, 185935, 171460, 185599, 203063, 215491, 219919, 206561]
shared_neighbor_graph_partition_s0 selection method  spend 41.42430329322815
time for parepare:  0.2682623863220215
local_output_nid generation:  0.006094455718994141
local_in_edges_tensor generation:  0.008128643035888672
mini_batch_src_global generation:  0.019473791122436523
r_  generation:  0.2267897129058838
local_output_nid generation:  0.007132053375244141
local_in_edges_tensor generation:  0.013062238693237305
mini_batch_src_global generation:  0.025080442428588867
r_  generation:  0.25791168212890625
local_output_nid generation:  0.0072176456451416016
local_in_edges_tensor generation:  0.007788658142089844
mini_batch_src_global generation:  0.03616952896118164
r_  generation:  0.22718429565429688
local_output_nid generation:  0.008404731750488281
local_in_edges_tensor generation:  0.03792548179626465
mini_batch_src_global generation:  0.0247499942779541
r_  generation:  0.2784566879272461
local_output_nid generation:  0.009848356246948242
local_in_edges_tensor generation:  0.012050628662109375
mini_batch_src_global generation:  0.024004697799682617
r_  generation:  0.2556891441345215
local_output_nid generation:  0.0070688724517822266
local_in_edges_tensor generation:  0.006991386413574219
mini_batch_src_global generation:  0.024445533752441406
r_  generation:  0.2548811435699463
local_output_nid generation:  0.007179975509643555
local_in_edges_tensor generation:  0.006978511810302734
mini_batch_src_global generation:  0.02559065818786621
r_  generation:  0.28408336639404297
local_output_nid generation:  0.007256507873535156
local_in_edges_tensor generation:  0.008354663848876953
mini_batch_src_global generation:  0.02739858627319336
r_  generation:  0.2979133129119873
----------------------check_connections_block total spend ----------------------------- 3.189875841140747
generate_one_block  1.744877576828003
generate_one_block  0.3076939582824707
generate_one_block  0.2798893451690674
generate_one_block  0.3060438632965088
generate_one_block  0.2903308868408203
generate_one_block  0.30203890800476074
generate_one_block  0.3092038631439209
generate_one_block  0.3207683563232422
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.7129926681518555
gen group dst list time:  0.04331493377685547
time for parepare:  0.40433526039123535
local_output_nid generation:  0.044467926025390625
local_in_edges_tensor generation:  0.1248636245727539
mini_batch_src_global generation:  0.05403757095336914
r_  generation:  0.8249032497406006
local_output_nid generation:  0.07201766967773438
local_in_edges_tensor generation:  0.129302978515625
mini_batch_src_global generation:  0.06872296333312988
r_  generation:  0.8123633861541748
local_output_nid generation:  0.0460057258605957
local_in_edges_tensor generation:  0.05876445770263672
mini_batch_src_global generation:  0.0617828369140625
r_  generation:  0.7828938961029053
local_output_nid generation:  0.05156302452087402
local_in_edges_tensor generation:  0.045842885971069336
mini_batch_src_global generation:  0.07221841812133789
r_  generation:  0.8535988330841064
local_output_nid generation:  0.05472421646118164
local_in_edges_tensor generation:  0.06945419311523438
mini_batch_src_global generation:  0.07970070838928223
r_  generation:  1.007420539855957
local_output_nid generation:  0.08259105682373047
local_in_edges_tensor generation:  0.09350204467773438
mini_batch_src_global generation:  0.09110140800476074
r_  generation:  1.0578434467315674
local_output_nid generation:  0.05852341651916504
local_in_edges_tensor generation:  0.06384682655334473
mini_batch_src_global generation:  0.08812785148620605
r_  generation:  1.1101229190826416
local_output_nid generation:  0.05420517921447754
local_in_edges_tensor generation:  0.046263933181762695
mini_batch_src_global generation:  0.08909153938293457
r_  generation:  1.024806022644043
----------------------check_connections_block total spend ----------------------------- 11.080368518829346
generate_one_block  1.4167194366455078
generate_one_block  1.0506947040557861
generate_one_block  0.8904666900634766
generate_one_block  0.948293924331665
generate_one_block  1.339141607284546
generate_one_block  1.2733972072601318
generate_one_block  1.2512290477752686
generate_one_block  1.1283042430877686
----------===============-------------===============-------------the number of batches *****---- 8

original number of batches:  8
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

connection checking time:  14.270244359970093
block generation total time  13.159093618392944
average batch blocks generation time:  0.822443351149559
block dataloader generation time/epoch 71.03737282752991
pseudo mini batch 0 input nodes size: 469868
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1951904296875 GB
    Memory Allocated: 0.17832469940185547  GigaBytes
Max Memory Allocated: 0.17832469940185547  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1951904296875 GB
    Memory Allocated: 0.1785106658935547  GigaBytes
Max Memory Allocated: 0.1785106658935547  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1951904296875 GB
    Memory Allocated: 0.1785106658935547  GigaBytes
Max Memory Allocated: 0.1785106658935547  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.19683361053466797  GigaBytes
Max Memory Allocated: 0.19683361053466797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2791748046875 GB
    Memory Allocated: 0.19683361053466797  GigaBytes
Max Memory Allocated: 0.19683361053466797  GigaBytes

first layer input nodes number: 469868
first layer output nodes number: 189006
edges number: 1848735
----------------------------------------before model layer 0
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.20174312591552734  GigaBytes
Max Memory Allocated: 0.20863056182861328  GigaBytes

torch.Size([469868, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.2987060546875 GB
    Memory Allocated: 0.20174312591552734  GigaBytes
Max Memory Allocated: 0.20863056182861328  GigaBytes

m.shape torch.Size([345, 1, 100])
----------------------------------------1
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.911588191986084  GigaBytes
Max Memory Allocated: 0.9409584999084473  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.911588191986084  GigaBytes
Max Memory Allocated: 0.9409584999084473  GigaBytes

 h.shape torch.Size([1, 345, 100]), torch.Size([1, 345, 100])
----------------------------------------3
 Nvidia-smi: 2.1639404296875 GB
    Memory Allocated: 0.9118456840515137  GigaBytes
Max Memory Allocated: 0.9409584999084473  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1678466796875 GB
    Memory Allocated: 0.9139041900634766  GigaBytes
Max Memory Allocated: 0.9409584999084473  GigaBytes

rst.shape  torch.Size([1, 345, 100])
m.shape torch.Size([610, 2, 100])
----------------------------------------1
 Nvidia-smi: 2.1678466796875 GB
    Memory Allocated: 0.9142303466796875  GigaBytes
Max Memory Allocated: 0.9409584999084473  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1678466796875 GB
    Memory Allocated: 0.9142303466796875  GigaBytes
Max Memory Allocated: 0.9409584999084473  GigaBytes

 h.shape torch.Size([1, 610, 100]), torch.Size([1, 610, 100])
----------------------------------------3
 Nvidia-smi: 2.1678466796875 GB
    Memory Allocated: 0.9146852493286133  GigaBytes
Max Memory Allocated: 0.9409584999084473  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1756591796875 GB
    Memory Allocated: 0.9215059280395508  GigaBytes
Max Memory Allocated: 0.9409584999084473  GigaBytes

rst.shape  torch.Size([1, 610, 100])
m.shape torch.Size([772, 3, 100])
----------------------------------------1
 Nvidia-smi: 2.1776123046875 GB
    Memory Allocated: 0.9221415519714355  GigaBytes
Max Memory Allocated: 0.9409584999084473  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1776123046875 GB
    Memory Allocated: 0.9221415519714355  GigaBytes
Max Memory Allocated: 0.9409584999084473  GigaBytes

 h.shape torch.Size([1, 772, 100]), torch.Size([1, 772, 100])
----------------------------------------3
 Nvidia-smi: 2.1776123046875 GB
    Memory Allocated: 0.9227175712585449  GigaBytes
Max Memory Allocated: 0.9409584999084473  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.9356927871704102  GigaBytes
Max Memory Allocated: 0.9409584999084473  GigaBytes

rst.shape  torch.Size([1, 772, 100])
m.shape torch.Size([1066, 4, 100])
----------------------------------------1
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.9369935989379883  GigaBytes
Max Memory Allocated: 0.9409584999084473  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.9369935989379883  GigaBytes
Max Memory Allocated: 0.9409584999084473  GigaBytes

 h.shape torch.Size([1, 1066, 100]), torch.Size([1, 1066, 100])
----------------------------------------3
 Nvidia-smi: 2.1795654296875 GB
    Memory Allocated: 0.9377880096435547  GigaBytes
Max Memory Allocated: 0.9409584999084473  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.1854248046875 GB
    Memory Allocated: 0.9611477851867676  GigaBytes
Max Memory Allocated: 0.9627366065979004  GigaBytes

rst.shape  torch.Size([1, 1066, 100])
m.shape torch.Size([1284, 5, 100])
----------------------------------------1
 Nvidia-smi: 2.1854248046875 GB
    Memory Allocated: 0.9631423950195312  GigaBytes
Max Memory Allocated: 0.9632148742675781  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.1854248046875 GB
    Memory Allocated: 0.9631423950195312  GigaBytes
Max Memory Allocated: 0.9632148742675781  GigaBytes

 h.shape torch.Size([1, 1284, 100]), torch.Size([1, 1284, 100])
----------------------------------------3
 Nvidia-smi: 2.1854248046875 GB
    Memory Allocated: 0.9640998840332031  GigaBytes
Max Memory Allocated: 0.9640998840332031  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2108154296875 GB
    Memory Allocated: 0.999114990234375  GigaBytes
Max Memory Allocated: 1.0015068054199219  GigaBytes

rst.shape  torch.Size([1, 1284, 100])
m.shape torch.Size([1345, 6, 100])
----------------------------------------1
 Nvidia-smi: 2.2108154296875 GB
    Memory Allocated: 1.0016427040100098  GigaBytes
Max Memory Allocated: 1.0017337799072266  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2108154296875 GB
    Memory Allocated: 1.0016427040100098  GigaBytes
Max Memory Allocated: 1.0017337799072266  GigaBytes

 h.shape torch.Size([1, 1345, 100]), torch.Size([1, 1345, 100])
----------------------------------------3
 Nvidia-smi: 2.2127685546875 GB
    Memory Allocated: 1.0026450157165527  GigaBytes
Max Memory Allocated: 1.0026450157165527  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 1.0457444190979004  GigaBytes
Max Memory Allocated: 1.048750877380371  GigaBytes

rst.shape  torch.Size([1, 1345, 100])
m.shape torch.Size([1581, 7, 100])
----------------------------------------1
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 1.0493664741516113  GigaBytes
Max Memory Allocated: 1.0494904518127441  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 1.0493664741516113  GigaBytes
Max Memory Allocated: 1.0494904518127441  GigaBytes

 h.shape torch.Size([1, 1581, 100]), torch.Size([1, 1581, 100])
----------------------------------------3
 Nvidia-smi: 2.2811279296875 GB
    Memory Allocated: 1.0505452156066895  GigaBytes
Max Memory Allocated: 1.0505452156066895  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 1.1101350784301758  GigaBytes
Max Memory Allocated: 1.1142582893371582  GigaBytes

rst.shape  torch.Size([1, 1581, 100])
m.shape torch.Size([1648, 8, 100])
----------------------------------------1
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 1.114457130432129  GigaBytes
Max Memory Allocated: 1.1146044731140137  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.3494873046875 GB
    Memory Allocated: 1.114457130432129  GigaBytes
Max Memory Allocated: 1.1146044731140137  GigaBytes

 h.shape torch.Size([1, 1648, 100]), torch.Size([1, 1648, 100])
----------------------------------------3
 Nvidia-smi: 2.3514404296875 GB
    Memory Allocated: 1.1156854629516602  GigaBytes
Max Memory Allocated: 1.1156854629516602  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.4217529296875 GB
    Memory Allocated: 1.18626070022583  GigaBytes
Max Memory Allocated: 1.1911721229553223  GigaBytes

rst.shape  torch.Size([1, 1648, 100])
m.shape torch.Size([1701, 9, 100])
----------------------------------------1
 Nvidia-smi: 2.4217529296875 GB
    Memory Allocated: 1.191349983215332  GigaBytes
Max Memory Allocated: 1.1915216445922852  GigaBytes

----------------------------------------2
 Nvidia-smi: 2.4217529296875 GB
    Memory Allocated: 1.191349983215332  GigaBytes
Max Memory Allocated: 1.1915216445922852  GigaBytes

 h.shape torch.Size([1, 1701, 100]), torch.Size([1, 1701, 100])
----------------------------------------3
 Nvidia-smi: 2.4237060546875 GB
    Memory Allocated: 1.192617416381836  GigaBytes
Max Memory Allocated: 1.192617416381836  GigaBytes

----------------------------------------4
 Nvidia-smi: 2.5135498046875 GB
    Memory Allocated: 1.273733139038086  GigaBytes
Max Memory Allocated: 1.2794365882873535  GigaBytes

rst.shape  torch.Size([1, 1701, 100])
m.shape torch.Size([178654, 10, 100])
----------------------------------------1
 Nvidia-smi: 3.2205810546875 GB
    Memory Allocated: 1.939115047454834  GigaBytes
Max Memory Allocated: 1.9592828750610352  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.2205810546875 GB
    Memory Allocated: 1.939115047454834  GigaBytes
Max Memory Allocated: 1.9592828750610352  GigaBytes

 h.shape torch.Size([1, 178654, 100]), torch.Size([1, 178654, 100])
----------------------------------------3
 Nvidia-smi: 3.3572998046875 GB
    Memory Allocated: 2.07222318649292  GigaBytes
Max Memory Allocated: 2.07222318649292  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5545654296875 GB
    Memory Allocated: 11.52287244796753  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 178654, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.5545654296875 GB
    Memory Allocated: 10.833806037902832  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.5545654296875 GB
    Memory Allocated: 11.014056205749512  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.5545654296875 GB
    Memory Allocated: 11.194306373596191  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.5545654296875 GB
    Memory Allocated: 11.014056205749512  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

torch.Size([189006, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.5545654296875 GB
    Memory Allocated: 11.194306373596191  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.5545654296875 GB
    Memory Allocated: 11.239368915557861  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.5545654296875 GB
    Memory Allocated: 11.239368915557861  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

m.shape torch.Size([46, 1, 256])
----------------------------------------1
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.827110290527344  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.827110290527344  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.827198028564453  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.827899932861328  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([40, 2, 256])
----------------------------------------1
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.827933311462402  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.827933311462402  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.828009605407715  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.829154014587402  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([27, 3, 256])
----------------------------------------1
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.829194068908691  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.829194068908691  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.829245567321777  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.830378532409668  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([51, 4, 256])
----------------------------------------1
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.830549240112305  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.830549240112305  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.830646514892578  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.833467483520508  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([35, 5, 256])
----------------------------------------1
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.833587169647217  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.833587169647217  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.833653926849365  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.836057186126709  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([41, 6, 256])
----------------------------------------1
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.836260318756104  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.836260318756104  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.836338520050049  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.839701175689697  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([40, 7, 256])
----------------------------------------1
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.83993148803711  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.83993148803711  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 14.1385498046875 GB
    Memory Allocated: 11.840007781982422  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1405029296875 GB
    Memory Allocated: 11.843822479248047  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([45, 8, 256])
----------------------------------------1
 Nvidia-smi: 14.1405029296875 GB
    Memory Allocated: 11.844130516052246  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1405029296875 GB
    Memory Allocated: 11.844130516052246  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 14.1405029296875 GB
    Memory Allocated: 11.844216346740723  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1444091796875 GB
    Memory Allocated: 11.849108695983887  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([39, 9, 256])
----------------------------------------1
 Nvidia-smi: 14.1444091796875 GB
    Memory Allocated: 11.849403381347656  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1444091796875 GB
    Memory Allocated: 11.849403381347656  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 14.1463623046875 GB
    Memory Allocated: 11.849477767944336  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 11.854238510131836  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([43, 10, 256])
----------------------------------------1
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 11.854614734649658  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 11.854614734649658  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 14.1502685546875 GB
    Memory Allocated: 11.85469675064087  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1561279296875 GB
    Memory Allocated: 11.860519886016846  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([44, 11, 256])
----------------------------------------1
 Nvidia-smi: 14.1580810546875 GB
    Memory Allocated: 11.860944271087646  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1580810546875 GB
    Memory Allocated: 11.860944271087646  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 14.1580810546875 GB
    Memory Allocated: 11.86102819442749  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1639404296875 GB
    Memory Allocated: 11.867574214935303  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([41, 12, 256])
----------------------------------------1
 Nvidia-smi: 14.1639404296875 GB
    Memory Allocated: 11.868005275726318  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1639404296875 GB
    Memory Allocated: 11.868005275726318  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 14.1639404296875 GB
    Memory Allocated: 11.868083477020264  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1717529296875 GB
    Memory Allocated: 11.874730587005615  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([46, 13, 256])
----------------------------------------1
 Nvidia-smi: 14.1717529296875 GB
    Memory Allocated: 11.875266551971436  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1717529296875 GB
    Memory Allocated: 11.875266551971436  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 14.1717529296875 GB
    Memory Allocated: 11.875354290008545  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1795654296875 GB
    Memory Allocated: 11.883426189422607  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([44, 14, 256])
----------------------------------------1
 Nvidia-smi: 14.1795654296875 GB
    Memory Allocated: 11.883974552154541  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1795654296875 GB
    Memory Allocated: 11.883974552154541  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 14.1815185546875 GB
    Memory Allocated: 11.884058475494385  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.1893310546875 GB
    Memory Allocated: 11.892366886138916  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([49, 15, 256])
----------------------------------------1
 Nvidia-smi: 14.1893310546875 GB
    Memory Allocated: 11.893031597137451  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.1893310546875 GB
    Memory Allocated: 11.893031597137451  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 14.1893310546875 GB
    Memory Allocated: 11.893125057220459  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2010498046875 GB
    Memory Allocated: 11.903031826019287  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([36, 16, 256])
----------------------------------------1
 Nvidia-smi: 14.2010498046875 GB
    Memory Allocated: 11.903538703918457  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2010498046875 GB
    Memory Allocated: 11.903538703918457  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 14.2010498046875 GB
    Memory Allocated: 11.903607368469238  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2088623046875 GB
    Memory Allocated: 11.91136646270752  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([41, 17, 256])
----------------------------------------1
 Nvidia-smi: 14.2088623046875 GB
    Memory Allocated: 11.912002086639404  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2088623046875 GB
    Memory Allocated: 11.912002086639404  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 14.2088623046875 GB
    Memory Allocated: 11.91208028793335  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2186279296875 GB
    Memory Allocated: 11.921464443206787  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([43, 18, 256])
----------------------------------------1
 Nvidia-smi: 14.2205810546875 GB
    Memory Allocated: 11.92216968536377  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2205810546875 GB
    Memory Allocated: 11.92216968536377  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 14.2205810546875 GB
    Memory Allocated: 11.92225170135498  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2303466796875 GB
    Memory Allocated: 11.93266773223877  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([49, 19, 256])
----------------------------------------1
 Nvidia-smi: 14.2303466796875 GB
    Memory Allocated: 11.933521747589111  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2303466796875 GB
    Memory Allocated: 11.933521747589111  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 14.2303466796875 GB
    Memory Allocated: 11.93361520767212  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2440185546875 GB
    Memory Allocated: 11.946138858795166  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([56, 20, 256])
----------------------------------------1
 Nvidia-smi: 14.2440185546875 GB
    Memory Allocated: 11.947317123413086  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2440185546875 GB
    Memory Allocated: 11.947317123413086  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 56, 256]), torch.Size([1, 56, 256])
----------------------------------------3
 Nvidia-smi: 14.2440185546875 GB
    Memory Allocated: 11.947423934936523  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2596435546875 GB
    Memory Allocated: 11.962484359741211  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 56, 256])
m.shape torch.Size([46, 21, 256])
----------------------------------------1
 Nvidia-smi: 14.2596435546875 GB
    Memory Allocated: 11.963359832763672  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2596435546875 GB
    Memory Allocated: 11.963359832763672  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 14.2596435546875 GB
    Memory Allocated: 11.963447570800781  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2733154296875 GB
    Memory Allocated: 11.976432800292969  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([54, 22, 256])
----------------------------------------1
 Nvidia-smi: 14.2733154296875 GB
    Memory Allocated: 11.977669715881348  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2733154296875 GB
    Memory Allocated: 11.977669715881348  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 14.2733154296875 GB
    Memory Allocated: 11.97777271270752  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.2889404296875 GB
    Memory Allocated: 11.99373722076416  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([41, 23, 256])
----------------------------------------1
 Nvidia-smi: 14.2908935546875 GB
    Memory Allocated: 11.994592189788818  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.2908935546875 GB
    Memory Allocated: 11.994592189788818  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 14.2908935546875 GB
    Memory Allocated: 11.994670391082764  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3045654296875 GB
    Memory Allocated: 12.007339000701904  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([53, 24, 256])
----------------------------------------1
 Nvidia-smi: 14.3045654296875 GB
    Memory Allocated: 12.0086350440979  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.3045654296875 GB
    Memory Allocated: 12.0086350440979  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 14.3045654296875 GB
    Memory Allocated: 12.00873613357544  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.3201904296875 GB
    Memory Allocated: 12.025820255279541  GigaBytes
Max Memory Allocated: 12.18888807296753  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([23868, 25, 256])
----------------------------------------1
 Nvidia-smi: 14.8905029296875 GB
    Memory Allocated: 12.599273204803467  GigaBytes
Max Memory Allocated: 12.601614475250244  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.8905029296875 GB
    Memory Allocated: 12.599273204803467  GigaBytes
Max Memory Allocated: 12.601614475250244  GigaBytes

 h.shape torch.Size([1, 23868, 256]), torch.Size([1, 23868, 256])
----------------------------------------3
 Nvidia-smi: 14.8905029296875 GB
    Memory Allocated: 12.645332336425781  GigaBytes
Max Memory Allocated: 12.645332336425781  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.6873779296875 GB
    Memory Allocated: 20.736934661865234  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 23868, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.6873779296875 GB
    Memory Allocated: 20.154036045074463  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.6873779296875 GB
    Memory Allocated: 20.15839910507202  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.6873779296875 GB
    Memory Allocated: 20.16276216506958  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.6873779296875 GB
    Memory Allocated: 20.158213138580322  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

torch.Size([24918, 47])
input nodes number: 189006
output nodes number: 24918
edges number: 610345
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.6873779296875 GB
    Memory Allocated: 20.164251804351807  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.6873779296875 GB
    Memory Allocated: 20.164252758026123  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.2357473373413086  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

pseudo mini batch 1 input nodes size: 452071
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.18541812896728516  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.18541812896728516  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.35382795333862305  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.3540167808532715  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.17804956436157227  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.1962895393371582  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.1962895393371582  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

first layer input nodes number: 452071
first layer output nodes number: 185935
edges number: 1823552
----------------------------------------before model layer 0
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.20123910903930664  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

torch.Size([452071, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.20123910903930664  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

m.shape torch.Size([352, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.900641918182373  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.900641918182373  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 352, 100]), torch.Size([1, 352, 100])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.9009041786193848  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.9030022621154785  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 352, 100])
m.shape torch.Size([471, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.9032220840454102  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.9032220840454102  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 471, 100]), torch.Size([1, 471, 100])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.9035730361938477  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.9088373184204102  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 471, 100])
m.shape torch.Size([701, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.9094452857971191  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.9094452857971191  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 701, 100]), torch.Size([1, 701, 100])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.9099678993225098  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.9224300384521484  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 701, 100])
m.shape torch.Size([924, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.9235458374023438  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.9235458374023438  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 924, 100]), torch.Size([1, 924, 100])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.9242343902587891  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.94464111328125  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 924, 100])
m.shape torch.Size([1072, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.946293830871582  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.946293830871582  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 1072, 100]), torch.Size([1, 1072, 100])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.9470930099487305  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.9765596389770508  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 1072, 100])
m.shape torch.Size([1227, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.9789028167724609  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.9789028167724609  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 1227, 100]), torch.Size([1, 1227, 100])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 0.9798173904418945  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 1.0194659233093262  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 1227, 100])
m.shape torch.Size([1366, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 1.022571086883545  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 1.022571086883545  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 1366, 100]), torch.Size([1, 1366, 100])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 1.0235896110534668  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 1.0744857788085938  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 1366, 100])
m.shape torch.Size([1357, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 1.0780210494995117  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 1.0780210494995117  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 1357, 100]), torch.Size([1, 1357, 100])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 1.0790328979492188  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 1.136673927307129  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 1357, 100])
m.shape torch.Size([1331, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 1.1406307220458984  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 1.1406307220458984  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 1331, 100]), torch.Size([1, 1331, 100])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 1.141622543334961  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 1.205099105834961  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 1331, 100])
m.shape torch.Size([177134, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 1.8644790649414062  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 1.8644790649414062  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 177134, 100]), torch.Size([1, 177134, 100])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 1.9964542388916016  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.366691589355469  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 177134, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 10.68746566772461  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 10.864787101745605  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.042108535766602  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 10.864787101745605  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

torch.Size([185935, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.042108535766602  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.08643913269043  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.08643913269043  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

m.shape torch.Size([14, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.687637329101562  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.687637329101562  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.687664031982422  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.687877655029297  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.68787431716919  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.68787431716919  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.687883853912354  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.688026905059814  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([18, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.688074111938477  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.688074111938477  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.688108444213867  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.688863754272461  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.688908100128174  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.688908100128174  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.688938617706299  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.689823627471924  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([25, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.689928531646729  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.689928531646729  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.689976215362549  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.69169282913208  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([26, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.691819190979004  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.691819190979004  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.691868782043457  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.694001197814941  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([22, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.694124698638916  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.694124698638916  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.694166660308838  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.696264743804932  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([21, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.696405410766602  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.696405410766602  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.69644546508789  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.698728561401367  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([50, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.699141502380371  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.699141502380371  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 50, 256]), torch.Size([1, 50, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.699236869812012  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.705340385437012  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 50, 256])
m.shape torch.Size([28, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.705562114715576  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.705562114715576  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.705615520477295  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.709407329559326  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([31, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.70970869064331  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.70970869064331  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.709767818450928  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.714379787445068  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([32, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.714719295501709  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.714719295501709  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.714780330657959  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.719968318939209  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.72031307220459  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.72031307220459  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.720370292663574  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.725634574890137  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([39, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.726130962371826  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.726130962371826  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.726205348968506  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.733569622039795  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([48, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.734224796295166  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.734224796295166  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.734316349029541  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.744020938873291  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.744390487670898  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.744390487670898  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.744441986083984  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.750261306762695  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([34, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.750791549682617  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.750791549682617  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.750856399536133  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.758638381958008  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([31, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.759142398834229  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.759142398834229  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.759201526641846  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.766710758209229  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.767302513122559  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.767302513122559  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.767367362976074  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.776057243347168  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.776525020599365  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.776525020599365  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.776574611663818  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.783566951751709  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([33, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.784208297729492  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.784208297729492  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.784271240234375  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.793586730957031  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([40, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.794401168823242  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.794401168823242  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.794477462768555  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.806303024291992  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([37, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.807083129882812  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.807083129882812  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.807153701782227  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.818586349487305  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([38, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.819427967071533  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.819427967071533  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.81950044631958  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 11.831749439239502  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([24579, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 12.422300815582275  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 12.422300815582275  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

 h.shape torch.Size([1, 24579, 256]), torch.Size([1, 24579, 256])
----------------------------------------3
 Nvidia-smi: 15.9666748046875 GB
    Memory Allocated: 12.469181537628174  GigaBytes
Max Memory Allocated: 21.305992126464844  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1463623046875 GB
    Memory Allocated: 20.720407962799072  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 24579, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 23.1463623046875 GB
    Memory Allocated: 20.12511157989502  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 23.1463623046875 GB
    Memory Allocated: 20.129538536071777  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 23.1463623046875 GB
    Memory Allocated: 20.133965492248535  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 23.1463623046875 GB
    Memory Allocated: 20.12934970855713  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

torch.Size([25284, 47])
input nodes number: 185935
output nodes number: 25284
edges number: 624401
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.1463623046875 GB
    Memory Allocated: 20.131922721862793  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.1463623046875 GB
    Memory Allocated: 20.13192319869995  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.22917652130126953  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

pseudo mini batch 2 input nodes size: 437570
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.17887258529663086  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.17887258529663086  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.34188032150268555  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.3420586585998535  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.1734600067138672  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.1904458999633789  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.1904458999633789  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

first layer input nodes number: 437570
first layer output nodes number: 171460
edges number: 1654204
----------------------------------------before model layer 0
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.19498443603515625  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

torch.Size([437570, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.19498443603515625  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

m.shape torch.Size([499, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.828850269317627  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.828850269317627  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 499, 100]), torch.Size([1, 499, 100])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.8292222023010254  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.8321976661682129  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 499, 100])
m.shape torch.Size([867, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.8326578140258789  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.8326578140258789  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 867, 100]), torch.Size([1, 867, 100])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.8333044052124023  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.8443918228149414  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 867, 100])
m.shape torch.Size([1152, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.8453559875488281  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.8453559875488281  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 1152, 100]), torch.Size([1, 1152, 100])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.8462142944335938  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.8650970458984375  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 1152, 100])
m.shape torch.Size([1484, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.8668794631958008  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.8668794631958008  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 1484, 100]), torch.Size([1, 1484, 100])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.867985725402832  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.9000558853149414  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 1484, 100])
m.shape torch.Size([1907, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.9035530090332031  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.9035530090332031  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 1907, 100]), torch.Size([1, 1907, 100])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.9049739837646484  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.9561290740966797  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 1907, 100])
m.shape torch.Size([2135, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.9601907730102539  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.9601907730102539  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 2135, 100]), torch.Size([1, 2135, 100])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 0.9617815017700195  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 1.0310678482055664  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 2135, 100])
m.shape torch.Size([2250, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 1.036139965057373  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 1.036139965057373  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 2250, 100]), torch.Size([1, 2250, 100])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 1.0378165245056152  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 1.122166633605957  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 2250, 100])
m.shape torch.Size([2409, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 1.1285080909729004  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 1.1285080909729004  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 2409, 100]), torch.Size([1, 2409, 100])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 1.1303038597106934  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 1.232628345489502  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 2409, 100])
m.shape torch.Size([2358, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 1.2396364212036133  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 1.2396364212036133  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 2358, 100]), torch.Size([1, 2358, 100])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 1.24139404296875  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 1.3538751602172852  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 2358, 100])
m.shape torch.Size([156399, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 1.9356284141540527  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 1.9356284141540527  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 156399, 100]), torch.Size([1, 156399, 100])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 2.052155017852783  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.3255295753479  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 156399, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 9.711775779724121  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 9.875292778015137  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.038809776306152  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 9.875292778015137  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

torch.Size([171460, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.038809776306152  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.079689025878906  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.079689025878906  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

m.shape torch.Size([48, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.62470006942749  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.62470006942749  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.624791622161865  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.625524044036865  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([67, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.62560749053955  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.62560749053955  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 67, 256]), torch.Size([1, 67, 256])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.62573528289795  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.627652168273926  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 67, 256])
m.shape torch.Size([76, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.6278076171875  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.6278076171875  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 76, 256]), torch.Size([1, 76, 256])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.627952575683594  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.631141662597656  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 76, 256])
m.shape torch.Size([114, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.631507873535156  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.631507873535156  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.631725311279297  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.638031005859375  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([114, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.63847017288208  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.63847017288208  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 114, 256]), torch.Size([1, 114, 256])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.63868761062622  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.646515369415283  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 114, 256])
m.shape torch.Size([126, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.647133350372314  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.647133350372314  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.647373676300049  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.657707691192627  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([126, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.658435344696045  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.658435344696045  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.65867567062378  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.670691967010498  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([135, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.67169189453125  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.67169189453125  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 135, 256]), torch.Size([1, 135, 256])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.67194938659668  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.686626434326172  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 135, 256])
m.shape torch.Size([102, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.687380313873291  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.687380313873291  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.687574863433838  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.700026035308838  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([126, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.701391696929932  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.701391696929932  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.701632022857666  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.718695163726807  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([121, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.720181941986084  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.720181941986084  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 15.7772216796875 GB
    Memory Allocated: 10.720412731170654  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7850341796875 GB
    Memory Allocated: 10.738414287567139  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([107, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.7850341796875 GB
    Memory Allocated: 10.740127086639404  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7850341796875 GB
    Memory Allocated: 10.740127086639404  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 15.7850341796875 GB
    Memory Allocated: 10.740331172943115  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8026123046875 GB
    Memory Allocated: 10.757678508758545  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([126, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.8026123046875 GB
    Memory Allocated: 10.759150981903076  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8026123046875 GB
    Memory Allocated: 10.759150981903076  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 126, 256]), torch.Size([1, 126, 256])
----------------------------------------3
 Nvidia-smi: 15.8026123046875 GB
    Memory Allocated: 10.75939130783081  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 10.781501293182373  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 126, 256])
m.shape torch.Size([111, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 10.782875061035156  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 10.782875061035156  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 15.8240966796875 GB
    Memory Allocated: 10.783086776733398  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8455810546875 GB
    Memory Allocated: 10.804046630859375  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([115, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.8455810546875 GB
    Memory Allocated: 10.805598735809326  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8455810546875 GB
    Memory Allocated: 10.805598735809326  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 15.8455810546875 GB
    Memory Allocated: 10.8058180809021  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8709716796875 GB
    Memory Allocated: 10.829068660736084  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([111, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.8709716796875 GB
    Memory Allocated: 10.830666065216064  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8709716796875 GB
    Memory Allocated: 10.830666065216064  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 15.8709716796875 GB
    Memory Allocated: 10.830877780914307  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8944091796875 GB
    Memory Allocated: 10.854801654815674  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([127, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.8944091796875 GB
    Memory Allocated: 10.856770992279053  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8944091796875 GB
    Memory Allocated: 10.856770992279053  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 15.8963623046875 GB
    Memory Allocated: 10.85701322555542  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9256591796875 GB
    Memory Allocated: 10.886081218719482  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([113, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.9256591796875 GB
    Memory Allocated: 10.887915134429932  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9256591796875 GB
    Memory Allocated: 10.887915134429932  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 113, 256]), torch.Size([1, 113, 256])
----------------------------------------3
 Nvidia-smi: 15.9256591796875 GB
    Memory Allocated: 10.88813066482544  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9530029296875 GB
    Memory Allocated: 10.915503025054932  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 113, 256])
m.shape torch.Size([125, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.9530029296875 GB
    Memory Allocated: 10.917678356170654  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9530029296875 GB
    Memory Allocated: 10.917678356170654  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 125, 256]), torch.Size([1, 125, 256])
----------------------------------------3
 Nvidia-smi: 15.9530029296875 GB
    Memory Allocated: 10.917916774749756  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9862060546875 GB
    Memory Allocated: 10.949864864349365  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 125, 256])
m.shape torch.Size([102, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.9862060546875 GB
    Memory Allocated: 10.951706409454346  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9862060546875 GB
    Memory Allocated: 10.951706409454346  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 102, 256]), torch.Size([1, 102, 256])
----------------------------------------3
 Nvidia-smi: 15.9862060546875 GB
    Memory Allocated: 10.951900959014893  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0135498046875 GB
    Memory Allocated: 10.979332447052002  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 102, 256])
m.shape torch.Size([112, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.0135498046875 GB
    Memory Allocated: 10.98149585723877  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0135498046875 GB
    Memory Allocated: 10.98149585723877  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 112, 256]), torch.Size([1, 112, 256])
----------------------------------------3
 Nvidia-smi: 16.0135498046875 GB
    Memory Allocated: 10.981709480285645  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0447998046875 GB
    Memory Allocated: 11.013325691223145  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 112, 256])
m.shape torch.Size([118, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.0447998046875 GB
    Memory Allocated: 11.015714168548584  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0447998046875 GB
    Memory Allocated: 11.015714168548584  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 118, 256]), torch.Size([1, 118, 256])
----------------------------------------3
 Nvidia-smi: 16.0447998046875 GB
    Memory Allocated: 11.015939235687256  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 11.050824642181396  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 118, 256])
m.shape torch.Size([108, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 11.053099632263184  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 11.053099632263184  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 108, 256]), torch.Size([1, 108, 256])
----------------------------------------3
 Nvidia-smi: 16.0799560546875 GB
    Memory Allocated: 11.053305625915527  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.1151123046875 GB
    Memory Allocated: 11.086676597595215  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 108, 256])
m.shape torch.Size([111, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.1151123046875 GB
    Memory Allocated: 11.089134216308594  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.1151123046875 GB
    Memory Allocated: 11.089134216308594  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 111, 256]), torch.Size([1, 111, 256])
----------------------------------------3
 Nvidia-smi: 16.1151123046875 GB
    Memory Allocated: 11.089345932006836  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.1522216796875 GB
    Memory Allocated: 11.125125885009766  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 111, 256])
m.shape torch.Size([21238, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.1522216796875 GB
    Memory Allocated: 11.635329723358154  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.1522216796875 GB
    Memory Allocated: 11.635329723358154  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 21238, 256]), torch.Size([1, 21238, 256])
----------------------------------------3
 Nvidia-smi: 16.1522216796875 GB
    Memory Allocated: 11.675837993621826  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3084716796875 GB
    Memory Allocated: 18.806106090545654  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 21238, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.3084716796875 GB
    Memory Allocated: 18.269064903259277  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.3084716796875 GB
    Memory Allocated: 18.27324628829956  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 21.3084716796875 GB
    Memory Allocated: 18.277679920196533  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 21.3084716796875 GB
    Memory Allocated: 18.273320198059082  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

torch.Size([23879, 47])
input nodes number: 171460
output nodes number: 23879
edges number: 565294
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3084716796875 GB
    Memory Allocated: 18.2737774848938  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.3084716796875 GB
    Memory Allocated: 18.273777961730957  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.21962451934814453  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

pseudo mini batch 3 input nodes size: 428591
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.1724553108215332  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.1724553108215332  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.33211803436279297  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.3323063850402832  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.16912031173706055  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.18701171875  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.18701171875  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

first layer input nodes number: 428591
first layer output nodes number: 185599
edges number: 1766354
----------------------------------------before model layer 0
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.1915879249572754  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

torch.Size([428591, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.1915879249572754  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

m.shape torch.Size([848, 1, 100])
----------------------------------------1
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.8688135147094727  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.8688135147094727  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 848, 100]), torch.Size([1, 848, 100])
----------------------------------------3
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.86944580078125  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.8754396438598633  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 848, 100])
m.shape torch.Size([1334, 2, 100])
----------------------------------------1
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.8761177062988281  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.8761177062988281  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 1334, 100]), torch.Size([1, 1334, 100])
----------------------------------------3
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.8771123886108398  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.892024040222168  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 1334, 100])
m.shape torch.Size([1895, 3, 100])
----------------------------------------1
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.8943848609924316  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.8943848609924316  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 1895, 100]), torch.Size([1, 1895, 100])
----------------------------------------3
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.8957972526550293  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.9268612861633301  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 1895, 100])
m.shape torch.Size([2351, 4, 100])
----------------------------------------1
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.9296584129333496  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.9296584129333496  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 2351, 100]), torch.Size([1, 2351, 100])
----------------------------------------3
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.9314103126525879  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.9827594757080078  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 2351, 100])
m.shape torch.Size([2736, 5, 100])
----------------------------------------1
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.9869799613952637  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.9869799613952637  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 2736, 100]), torch.Size([1, 2736, 100])
----------------------------------------3
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 0.9890189170837402  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 1.0634512901306152  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 2736, 100])
m.shape torch.Size([2968, 6, 100])
----------------------------------------1
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 1.069066047668457  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 1.069066047668457  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 2968, 100]), torch.Size([1, 2968, 100])
----------------------------------------3
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 1.0713562965393066  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 1.1701183319091797  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 2968, 100])
m.shape torch.Size([3041, 7, 100])
----------------------------------------1
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 1.1769428253173828  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 1.1769428253173828  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 3041, 100]), torch.Size([1, 3041, 100])
----------------------------------------3
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 1.179208755493164  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 1.2937870025634766  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 3041, 100])
m.shape torch.Size([3117, 8, 100])
----------------------------------------1
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 1.3019437789916992  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 1.3019437789916992  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 3117, 100]), torch.Size([1, 3117, 100])
----------------------------------------3
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 1.305074691772461  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 1.4409489631652832  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 3117, 100])
m.shape torch.Size([3052, 9, 100])
----------------------------------------1
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 1.4502387046813965  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 1.4502387046813965  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 3052, 100]), torch.Size([1, 3052, 100])
----------------------------------------3
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 1.4525132179260254  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 1.5996389389038086  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 3052, 100])
m.shape torch.Size([164257, 10, 100])
----------------------------------------1
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 2.21040678024292  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 2.21040678024292  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 164257, 100]), torch.Size([1, 164257, 100])
----------------------------------------3
 Nvidia-smi: 21.3123779296875 GB
    Memory Allocated: 2.3327879905700684  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.021853923797607  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 164257, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 10.368128299713135  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 10.545129299163818  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 10.722130298614502  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 10.545129299163818  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

torch.Size([185599, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 10.722130298614502  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 10.766380786895752  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 10.766380786895752  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

m.shape torch.Size([20, 1, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.35245418548584  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.35245418548584  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.352492332458496  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.352797508239746  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([36, 2, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.352848052978516  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.352848052978516  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.352916717529297  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.353946685791016  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([49, 3, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.354053974151611  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.354053974151611  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.35414743423462  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.356203556060791  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([55, 4, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.35636854171753  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.35636854171753  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.356473445892334  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.35951566696167  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([64, 5, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.359770774841309  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.359770774841309  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.359892845153809  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.364287376403809  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([85, 6, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.364716529846191  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.364716529846191  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.36487865447998  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.37185001373291  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([92, 7, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.372388362884521  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.372388362884521  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 92, 256]), torch.Size([1, 92, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.37256383895874  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.381337642669678  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 92, 256])
m.shape torch.Size([82, 8, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.381880760192871  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.381880760192871  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 82, 256]), torch.Size([1, 82, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.382037162780762  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.390952110290527  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 82, 256])
m.shape torch.Size([85, 9, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.391609191894531  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.391609191894531  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.39177131652832  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.40214729309082  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([94, 10, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.40296983718872  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.40296983718872  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.403149127960205  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.415878772735596  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([99, 11, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.41688871383667  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.41688871383667  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.417077541351318  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.431806087493896  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([85, 12, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.432692050933838  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.432692050933838  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 85, 256]), torch.Size([1, 85, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.432854175567627  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.446634769439697  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 85, 256])
m.shape torch.Size([116, 13, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.448604106903076  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.448604106903076  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.448825359344482  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.469180583953857  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([122, 14, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.470711708068848  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.470711708068848  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.47094440460205  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.49398136138916  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([93, 15, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.49529218673706  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.49529218673706  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.495469570159912  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.514272212982178  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([110, 16, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.516357898712158  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.516357898712158  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 110, 256]), torch.Size([1, 110, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.516567707061768  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.540276050567627  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 110, 256])
m.shape torch.Size([106, 17, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.541903495788574  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.541903495788574  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 106, 256]), torch.Size([1, 106, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.542105674743652  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.566367149353027  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 106, 256])
m.shape torch.Size([89, 18, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.567806243896484  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.567806243896484  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 89, 256]), torch.Size([1, 89, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.567975997924805  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.589534759521484  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 89, 256])
m.shape torch.Size([97, 19, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.591221332550049  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.591221332550049  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.591406345367432  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.616198062896729  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([94, 20, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.617912769317627  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.617912769317627  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.618092060089111  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.643372058868408  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([94, 21, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.645179748535156  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.645179748535156  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 94, 256]), torch.Size([1, 94, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.64535903930664  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.671894073486328  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 94, 256])
m.shape torch.Size([93, 22, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.673770904541016  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.673770904541016  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 93, 256]), torch.Size([1, 93, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.673948287963867  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.70144271850586  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 93, 256])
m.shape torch.Size([122, 23, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.70405101776123  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.70405101776123  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 122, 256]), torch.Size([1, 122, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.704283714294434  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.74198055267334  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 122, 256])
m.shape torch.Size([99, 24, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.744148254394531  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.744148254394531  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 99, 256]), torch.Size([1, 99, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.74433708190918  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 11.776248931884766  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 99, 256])
m.shape torch.Size([23171, 25, 256])
----------------------------------------1
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 12.332910537719727  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 12.332910537719727  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 23171, 256]), torch.Size([1, 23171, 256])
----------------------------------------3
 Nvidia-smi: 21.9256591796875 GB
    Memory Allocated: 12.378541946411133  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.3807373046875 GB
    Memory Allocated: 20.176502227783203  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 23171, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.3807373046875 GB
    Memory Allocated: 19.597806453704834  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.3807373046875 GB
    Memory Allocated: 19.60222816467285  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.3807373046875 GB
    Memory Allocated: 19.60664987564087  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.3807373046875 GB
    Memory Allocated: 19.60203981399536  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

torch.Size([25252, 47])
input nodes number: 185599
output nodes number: 25252
edges number: 608378
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3807373046875 GB
    Memory Allocated: 19.60392189025879  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.3807373046875 GB
    Memory Allocated: 19.603922367095947  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.3826904296875 GB
    Memory Allocated: 0.21802377700805664  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

pseudo mini batch 4 input nodes size: 601254
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.3826904296875 GB
    Memory Allocated: 0.16936063766479492  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.3826904296875 GB
    Memory Allocated: 0.16936063766479492  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.3826904296875 GB
    Memory Allocated: 0.39334535598754883  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 22.3826904296875 GB
    Memory Allocated: 0.393524169921875  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.3826904296875 GB
    Memory Allocated: 0.233673095703125  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.3826904296875 GB
    Memory Allocated: 0.2541775703430176  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.3826904296875 GB
    Memory Allocated: 0.2541775703430176  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

first layer input nodes number: 601254
first layer output nodes number: 203063
edges number: 1979571
----------------------------------------before model layer 0
 Nvidia-smi: 22.3826904296875 GB
    Memory Allocated: 0.26017045974731445  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

torch.Size([601254, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 22.3826904296875 GB
    Memory Allocated: 0.26017045974731445  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

m.shape torch.Size([265, 1, 100])
----------------------------------------1
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.019486904144287  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.019486904144287  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 265, 100]), torch.Size([1, 265, 100])
----------------------------------------3
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.0196852684020996  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.0212678909301758  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 265, 100])
m.shape torch.Size([413, 2, 100])
----------------------------------------1
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.0214767456054688  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.0214767456054688  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 413, 100]), torch.Size([1, 413, 100])
----------------------------------------3
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.021784782409668  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.026402473449707  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 413, 100])
m.shape torch.Size([816, 3, 100])
----------------------------------------1
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.02716064453125  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.02716064453125  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 816, 100]), torch.Size([1, 816, 100])
----------------------------------------3
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.0277690887451172  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.0419731140136719  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 816, 100])
m.shape torch.Size([1364, 4, 100])
----------------------------------------1
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.0437016487121582  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.0437016487121582  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 1364, 100]), torch.Size([1, 1364, 100])
----------------------------------------3
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.0447182655334473  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.0750317573547363  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 1364, 100])
m.shape torch.Size([1806, 5, 100])
----------------------------------------1
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.0778875350952148  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.0778875350952148  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 1806, 100]), torch.Size([1, 1806, 100])
----------------------------------------3
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.079233169555664  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.1289892196655273  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 1806, 100])
m.shape torch.Size([2008, 6, 100])
----------------------------------------1
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.1328048706054688  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.1328048706054688  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 2008, 100]), torch.Size([1, 2008, 100])
----------------------------------------3
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.1343011856079102  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.1991076469421387  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 2008, 100])
m.shape torch.Size([2334, 7, 100])
----------------------------------------1
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.2044463157653809  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.2044463157653809  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 2334, 100]), torch.Size([1, 2334, 100])
----------------------------------------3
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.2061858177185059  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.2931408882141113  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 2334, 100])
m.shape torch.Size([2441, 8, 100])
----------------------------------------1
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.299546241760254  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.299546241760254  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 2441, 100]), torch.Size([1, 2441, 100])
----------------------------------------3
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.301365852355957  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.4050493240356445  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 2441, 100])
m.shape torch.Size([2528, 9, 100])
----------------------------------------1
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.4126152992248535  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.4126152992248535  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 2528, 100]), torch.Size([1, 2528, 100])
----------------------------------------3
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.4144988059997559  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.1229248046875 GB
    Memory Allocated: 1.5350432395935059  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 2528, 100])
m.shape torch.Size([189088, 10, 100])
----------------------------------------1
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 2.2391796112060547  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 3.6463623046875 GB
    Memory Allocated: 2.2391796112060547  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 189088, 100]), torch.Size([1, 189088, 100])
----------------------------------------3
 Nvidia-smi: 3.7908935546875 GB
    Memory Allocated: 2.380061149597168  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.5819091796875 GB
    Memory Allocated: 12.382650375366211  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 189088, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 14.5819091796875 GB
    Memory Allocated: 11.645846843719482  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 14.5819091796875 GB
    Memory Allocated: 11.839502811431885  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 14.5819091796875 GB
    Memory Allocated: 12.033158779144287  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 14.5819091796875 GB
    Memory Allocated: 11.839502811431885  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

torch.Size([203063, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 14.5819091796875 GB
    Memory Allocated: 12.033158779144287  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 14.5819091796875 GB
    Memory Allocated: 12.081573009490967  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 14.5819091796875 GB
    Memory Allocated: 12.081573009490967  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

m.shape torch.Size([20, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.63266134262085  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.63266134262085  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.632699489593506  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.633004665374756  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([16, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.633016586303711  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.633016586303711  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.633047103881836  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.633504867553711  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([21, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.63355016708374  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.63355016708374  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.63359022140503  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.634471416473389  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([52, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.63465166091919  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.63465166091919  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.634750843048096  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.637627124786377  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([55, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.637842178344727  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.637842178344727  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.637947082519531  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.6417236328125  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([55, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.641988754272461  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.641988754272461  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.642093658447266  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.646604537963867  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([97, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.647204875946045  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.647204875946045  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 97, 256]), torch.Size([1, 97, 256])
----------------------------------------3
 Nvidia-smi: 15.1287841796875 GB
    Memory Allocated: 12.647389888763428  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1326904296875 GB
    Memory Allocated: 12.656640529632568  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 97, 256])
m.shape torch.Size([81, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.1326904296875 GB
    Memory Allocated: 12.657171249389648  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1326904296875 GB
    Memory Allocated: 12.657171249389648  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 81, 256]), torch.Size([1, 81, 256])
----------------------------------------3
 Nvidia-smi: 15.1326904296875 GB
    Memory Allocated: 12.657325744628906  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1424560546875 GB
    Memory Allocated: 12.666131973266602  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 81, 256])
m.shape torch.Size([130, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.1424560546875 GB
    Memory Allocated: 12.66740608215332  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1424560546875 GB
    Memory Allocated: 12.66740608215332  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 130, 256]), torch.Size([1, 130, 256])
----------------------------------------3
 Nvidia-smi: 15.1424560546875 GB
    Memory Allocated: 12.667654037475586  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 12.683523178100586  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 130, 256])
m.shape torch.Size([119, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 12.68481731414795  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 12.68481731414795  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 119, 256]), torch.Size([1, 119, 256])
----------------------------------------3
 Nvidia-smi: 15.1580810546875 GB
    Memory Allocated: 12.685044288635254  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1737060546875 GB
    Memory Allocated: 12.701159477233887  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 119, 256])
m.shape torch.Size([134, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.1737060546875 GB
    Memory Allocated: 12.702466487884521  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1737060546875 GB
    Memory Allocated: 12.702466487884521  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 15.1737060546875 GB
    Memory Allocated: 12.702722072601318  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.1951904296875 GB
    Memory Allocated: 12.722657680511475  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([143, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.1951904296875 GB
    Memory Allocated: 12.724250316619873  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.1951904296875 GB
    Memory Allocated: 12.724250316619873  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 15.1951904296875 GB
    Memory Allocated: 12.724523067474365  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2186279296875 GB
    Memory Allocated: 12.747706890106201  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([128, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.2186279296875 GB
    Memory Allocated: 12.749404907226562  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2186279296875 GB
    Memory Allocated: 12.749404907226562  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 128, 256]), torch.Size([1, 128, 256])
----------------------------------------3
 Nvidia-smi: 15.2186279296875 GB
    Memory Allocated: 12.749649047851562  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2420654296875 GB
    Memory Allocated: 12.772109985351562  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 128, 256])
m.shape torch.Size([127, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.2420654296875 GB
    Memory Allocated: 12.773826122283936  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2420654296875 GB
    Memory Allocated: 12.773826122283936  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 15.2420654296875 GB
    Memory Allocated: 12.774068355560303  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 12.798049449920654  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([205, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 12.800961971282959  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 12.800961971282959  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 205, 256]), torch.Size([1, 205, 256])
----------------------------------------3
 Nvidia-smi: 15.2655029296875 GB
    Memory Allocated: 12.801352977752686  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.3123779296875 GB
    Memory Allocated: 12.842799663543701  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 205, 256])
m.shape torch.Size([151, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.3123779296875 GB
    Memory Allocated: 12.845271587371826  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.3123779296875 GB
    Memory Allocated: 12.845271587371826  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 151, 256]), torch.Size([1, 151, 256])
----------------------------------------3
 Nvidia-smi: 15.3123779296875 GB
    Memory Allocated: 12.84555959701538  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 12.87810468673706  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 151, 256])
m.shape torch.Size([138, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 12.880627632141113  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 12.880627632141113  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 12.880890846252441  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.3768310546875 GB
    Memory Allocated: 12.912476539611816  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([146, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.3768310546875 GB
    Memory Allocated: 12.915014266967773  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.3768310546875 GB
    Memory Allocated: 12.915014266967773  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 15.3768310546875 GB
    Memory Allocated: 12.915292739868164  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4119873046875 GB
    Memory Allocated: 12.950658798217773  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([158, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.4119873046875 GB
    Memory Allocated: 12.953708171844482  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4119873046875 GB
    Memory Allocated: 12.953708171844482  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 158, 256]), torch.Size([1, 158, 256])
----------------------------------------3
 Nvidia-smi: 15.4119873046875 GB
    Memory Allocated: 12.954009532928467  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4549560546875 GB
    Memory Allocated: 12.994391918182373  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 158, 256])
m.shape torch.Size([115, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.4549560546875 GB
    Memory Allocated: 12.996907711029053  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4549560546875 GB
    Memory Allocated: 12.996907711029053  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 15.4549560546875 GB
    Memory Allocated: 12.997127056121826  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.4842529296875 GB
    Memory Allocated: 13.02805471420288  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([142, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.4842529296875 GB
    Memory Allocated: 13.031262874603271  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.4842529296875 GB
    Memory Allocated: 13.031262874603271  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 142, 256]), torch.Size([1, 142, 256])
----------------------------------------3
 Nvidia-smi: 15.4842529296875 GB
    Memory Allocated: 13.03153371810913  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 13.071618556976318  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 142, 256])
m.shape torch.Size([139, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 13.074801445007324  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 13.074801445007324  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 139, 256]), torch.Size([1, 139, 256])
----------------------------------------3
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 13.075066566467285  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.5682373046875 GB
    Memory Allocated: 13.11616039276123  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 139, 256])
m.shape torch.Size([159, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.5682373046875 GB
    Memory Allocated: 13.119543075561523  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.5682373046875 GB
    Memory Allocated: 13.119543075561523  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 159, 256]), torch.Size([1, 159, 256])
----------------------------------------3
 Nvidia-smi: 15.5682373046875 GB
    Memory Allocated: 13.11984634399414  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 13.168975830078125  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 159, 256])
m.shape torch.Size([121, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 13.172141551971436  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 13.172141551971436  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 121, 256]), torch.Size([1, 121, 256])
----------------------------------------3
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 13.172372341156006  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.6580810546875 GB
    Memory Allocated: 13.211375713348389  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

rst.shape  torch.Size([1, 121, 256])
m.shape torch.Size([21311, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.6580810546875 GB
    Memory Allocated: 13.723323822021484  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.6580810546875 GB
    Memory Allocated: 13.723323822021484  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

 h.shape torch.Size([1, 21311, 256]), torch.Size([1, 21311, 256])
----------------------------------------3
 Nvidia-smi: 15.6580810546875 GB
    Memory Allocated: 13.763971328735352  GigaBytes
Max Memory Allocated: 21.306416988372803  GigaBytes

----------------------------------------4
 Nvidia-smi: 22.9334716796875 GB
    Memory Allocated: 20.9709415435791  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 21311, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 22.9334716796875 GB
    Memory Allocated: 20.427131175994873  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 22.9334716796875 GB
    Memory Allocated: 20.431326866149902  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 22.9334716796875 GB
    Memory Allocated: 20.43552255630493  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 22.9334716796875 GB
    Memory Allocated: 20.431148052215576  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

torch.Size([23963, 47])
input nodes number: 203063
output nodes number: 23963
edges number: 572390
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.9334716796875 GB
    Memory Allocated: 20.432679176330566  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.9334716796875 GB
    Memory Allocated: 20.432679653167725  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 0.28725147247314453  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

pseudo mini batch 5 input nodes size: 646955
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 0.23344707489013672  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 0.23344707489013672  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 0.474456787109375  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 0.47463512420654297  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 0.2504715919494629  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 0.27039289474487305  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 0.27039289474487305  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

first layer input nodes number: 646955
first layer output nodes number: 215491
edges number: 2118227
----------------------------------------before model layer 0
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 0.27681922912597656  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

torch.Size([646955, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 17.0623779296875 GB
    Memory Allocated: 0.27681922912597656  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

m.shape torch.Size([335, 1, 100])
----------------------------------------1
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.0887742042541504  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.0887742042541504  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 335, 100]), torch.Size([1, 335, 100])
----------------------------------------3
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.0890240669250488  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.0910215377807617  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 335, 100])
m.shape torch.Size([526, 2, 100])
----------------------------------------1
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.0912885665893555  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.0912885665893555  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 526, 100]), torch.Size([1, 526, 100])
----------------------------------------3
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.0916805267333984  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.097559928894043  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 526, 100])
m.shape torch.Size([816, 3, 100])
----------------------------------------1
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.098276138305664  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.098276138305664  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 816, 100]), torch.Size([1, 816, 100])
----------------------------------------3
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.0988845825195312  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.1131529808044434  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 816, 100])
m.shape torch.Size([933, 4, 100])
----------------------------------------1
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.11423921585083  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.11423921585083  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 933, 100]), torch.Size([1, 933, 100])
----------------------------------------3
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.1149344444274902  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.1358590126037598  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 933, 100])
m.shape torch.Size([1031, 5, 100])
----------------------------------------1
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.1374320983886719  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.1374320983886719  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 1031, 100]), torch.Size([1, 1031, 100])
----------------------------------------3
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.1382007598876953  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.165858268737793  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 1031, 100])
m.shape torch.Size([1187, 6, 100])
----------------------------------------1
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.1681275367736816  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.1681275367736816  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 1187, 100]), torch.Size([1, 1187, 100])
----------------------------------------3
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.1690125465393066  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.2079381942749023  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 1187, 100])
m.shape torch.Size([1391, 7, 100])
----------------------------------------1
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.2111234664916992  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.2111234664916992  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 1391, 100]), torch.Size([1, 1391, 100])
----------------------------------------3
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.2121601104736328  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.2653942108154297  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 1391, 100])
m.shape torch.Size([1336, 8, 100])
----------------------------------------1
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.268857479095459  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.268857479095459  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 1336, 100]), torch.Size([1, 1336, 100])
----------------------------------------3
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.269853115081787  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.3275508880615234  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 1336, 100])
m.shape torch.Size([1402, 9, 100])
----------------------------------------1
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.332648754119873  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.332648754119873  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 1402, 100]), torch.Size([1, 1402, 100])
----------------------------------------3
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.3336939811706543  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 17.8553466796875 GB
    Memory Allocated: 1.4027400016784668  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 1402, 100])
m.shape torch.Size([206534, 10, 100])
----------------------------------------1
 Nvidia-smi: 18.6248779296875 GB
    Memory Allocated: 2.171748638153076  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.6248779296875 GB
    Memory Allocated: 2.171748638153076  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 206534, 100]), torch.Size([1, 206534, 100])
----------------------------------------3
 Nvidia-smi: 18.6248779296875 GB
    Memory Allocated: 2.3256287574768066  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 13.268616676330566  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 206534, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 12.478321552276611  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 12.68382978439331  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 12.88933801651001  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 12.68382978439331  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

torch.Size([215491, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 12.88933801651001  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 12.940715312957764  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 12.940715312957764  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

m.shape torch.Size([22, 1, 256])
----------------------------------------1
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 13.4754958152771  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 13.4754958152771  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 13.475537776947021  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 13.475873470306396  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([44, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 13.475937366485596  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 13.475937366485596  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 13.47602128982544  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 13.477280139923096  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([160, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 13.477699756622314  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 13.477699756622314  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 160, 256]), torch.Size([1, 160, 256])
----------------------------------------3
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 13.478004932403564  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 13.484718799591064  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 160, 256])
m.shape torch.Size([150, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 13.485143184661865  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 13.485143184661865  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 150, 256]), torch.Size([1, 150, 256])
----------------------------------------3
 Nvidia-smi: 15.6209716796875 GB
    Memory Allocated: 13.485429286956787  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.6287841796875 GB
    Memory Allocated: 13.493726253509521  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 150, 256])
m.shape torch.Size([133, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.6287841796875 GB
    Memory Allocated: 13.494222640991211  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.6287841796875 GB
    Memory Allocated: 13.494222640991211  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 133, 256]), torch.Size([1, 133, 256])
----------------------------------------3
 Nvidia-smi: 15.6287841796875 GB
    Memory Allocated: 13.494476318359375  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.6385498046875 GB
    Memory Allocated: 13.503608703613281  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 133, 256])
m.shape torch.Size([202, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.6385498046875 GB
    Memory Allocated: 13.505105018615723  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.6385498046875 GB
    Memory Allocated: 13.505105018615723  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 202, 256]), torch.Size([1, 202, 256])
----------------------------------------3
 Nvidia-smi: 15.6385498046875 GB
    Memory Allocated: 13.50549030303955  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.6561279296875 GB
    Memory Allocated: 13.52205753326416  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 202, 256])
m.shape torch.Size([255, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.6561279296875 GB
    Memory Allocated: 13.523580551147461  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.6561279296875 GB
    Memory Allocated: 13.523580551147461  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 255, 256]), torch.Size([1, 255, 256])
----------------------------------------3
 Nvidia-smi: 15.6561279296875 GB
    Memory Allocated: 13.524066925048828  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.6776123046875 GB
    Memory Allocated: 13.548385620117188  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 255, 256])
m.shape torch.Size([127, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.6776123046875 GB
    Memory Allocated: 13.549118995666504  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.6776123046875 GB
    Memory Allocated: 13.549118995666504  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 127, 256]), torch.Size([1, 127, 256])
----------------------------------------3
 Nvidia-smi: 15.6776123046875 GB
    Memory Allocated: 13.549361228942871  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.6912841796875 GB
    Memory Allocated: 13.5631685256958  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 127, 256])
m.shape torch.Size([137, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.6912841796875 GB
    Memory Allocated: 13.56494951248169  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.6912841796875 GB
    Memory Allocated: 13.56494951248169  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 15.6912841796875 GB
    Memory Allocated: 13.565210819244385  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7088623046875 GB
    Memory Allocated: 13.581934452056885  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([209, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.7088623046875 GB
    Memory Allocated: 13.583812713623047  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7088623046875 GB
    Memory Allocated: 13.583812713623047  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 209, 256]), torch.Size([1, 209, 256])
----------------------------------------3
 Nvidia-smi: 15.7088623046875 GB
    Memory Allocated: 13.584211349487305  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7401123046875 GB
    Memory Allocated: 13.61251449584961  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 209, 256])
m.shape torch.Size([173, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.7401123046875 GB
    Memory Allocated: 13.614474773406982  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7401123046875 GB
    Memory Allocated: 13.614474773406982  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 173, 256]), torch.Size([1, 173, 256])
----------------------------------------3
 Nvidia-smi: 15.7401123046875 GB
    Memory Allocated: 13.614804744720459  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7713623046875 GB
    Memory Allocated: 13.64054250717163  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 173, 256])
m.shape torch.Size([138, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.7713623046875 GB
    Memory Allocated: 13.641969203948975  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7713623046875 GB
    Memory Allocated: 13.641969203948975  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 138, 256]), torch.Size([1, 138, 256])
----------------------------------------3
 Nvidia-smi: 15.7713623046875 GB
    Memory Allocated: 13.642232418060303  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 13.664605617523193  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 138, 256])
m.shape torch.Size([134, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 13.666148662567139  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 13.666148662567139  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 134, 256]), torch.Size([1, 134, 256])
----------------------------------------3
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 13.666404247283936  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8143310546875 GB
    Memory Allocated: 13.689918041229248  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 134, 256])
m.shape torch.Size([221, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.8143310546875 GB
    Memory Allocated: 13.692764282226562  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8143310546875 GB
    Memory Allocated: 13.692764282226562  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 221, 256]), torch.Size([1, 221, 256])
----------------------------------------3
 Nvidia-smi: 15.8143310546875 GB
    Memory Allocated: 13.693185806274414  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8572998046875 GB
    Memory Allocated: 13.734916687011719  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 221, 256])
m.shape torch.Size([137, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.8572998046875 GB
    Memory Allocated: 13.736825466156006  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8572998046875 GB
    Memory Allocated: 13.736825466156006  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 137, 256]), torch.Size([1, 137, 256])
----------------------------------------3
 Nvidia-smi: 15.8572998046875 GB
    Memory Allocated: 13.737086772918701  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.8846435546875 GB
    Memory Allocated: 13.764785289764404  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 137, 256])
m.shape torch.Size([146, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.8846435546875 GB
    Memory Allocated: 13.766900062561035  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.8846435546875 GB
    Memory Allocated: 13.766900062561035  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 146, 256]), torch.Size([1, 146, 256])
----------------------------------------3
 Nvidia-smi: 15.8846435546875 GB
    Memory Allocated: 13.767178535461426  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 13.798645973205566  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 146, 256])
m.shape torch.Size([78, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 13.799781322479248  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 13.799781322479248  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 78, 256]), torch.Size([1, 78, 256])
----------------------------------------3
 Nvidia-smi: 15.9158935546875 GB
    Memory Allocated: 13.799930095672607  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9334716796875 GB
    Memory Allocated: 13.817782878875732  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 78, 256])
m.shape torch.Size([143, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.9334716796875 GB
    Memory Allocated: 13.820182800292969  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9334716796875 GB
    Memory Allocated: 13.820182800292969  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 143, 256]), torch.Size([1, 143, 256])
----------------------------------------3
 Nvidia-smi: 15.9334716796875 GB
    Memory Allocated: 13.820455551147461  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9686279296875 GB
    Memory Allocated: 13.855094909667969  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 143, 256])
m.shape torch.Size([65, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.9686279296875 GB
    Memory Allocated: 13.856145858764648  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9686279296875 GB
    Memory Allocated: 13.856145858764648  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 65, 256]), torch.Size([1, 65, 256])
----------------------------------------3
 Nvidia-smi: 15.9686279296875 GB
    Memory Allocated: 13.856269836425781  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.9842529296875 GB
    Memory Allocated: 13.872882843017578  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 65, 256])
m.shape torch.Size([136, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.9842529296875 GB
    Memory Allocated: 13.87543535232544  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.9842529296875 GB
    Memory Allocated: 13.87543535232544  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 136, 256]), torch.Size([1, 136, 256])
----------------------------------------3
 Nvidia-smi: 15.9842529296875 GB
    Memory Allocated: 13.875694751739502  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0213623046875 GB
    Memory Allocated: 13.912270069122314  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 136, 256])
m.shape torch.Size([116, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.0213623046875 GB
    Memory Allocated: 13.914482116699219  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0213623046875 GB
    Memory Allocated: 13.914482116699219  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 116, 256]), torch.Size([1, 116, 256])
----------------------------------------3
 Nvidia-smi: 16.0213623046875 GB
    Memory Allocated: 13.914703369140625  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0526123046875 GB
    Memory Allocated: 13.94744873046875  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 116, 256])
m.shape torch.Size([107, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.0526123046875 GB
    Memory Allocated: 13.94960069656372  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0526123046875 GB
    Memory Allocated: 13.94960069656372  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 107, 256]), torch.Size([1, 107, 256])
----------------------------------------3
 Nvidia-smi: 16.0526123046875 GB
    Memory Allocated: 13.949804782867432  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.0858154296875 GB
    Memory Allocated: 13.981438159942627  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 107, 256])
m.shape torch.Size([124, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.0858154296875 GB
    Memory Allocated: 13.984077453613281  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.0858154296875 GB
    Memory Allocated: 13.984077453613281  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 124, 256]), torch.Size([1, 124, 256])
----------------------------------------3
 Nvidia-smi: 16.0858154296875 GB
    Memory Allocated: 13.98431396484375  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.1248779296875 GB
    Memory Allocated: 14.022628784179688  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 124, 256])
m.shape torch.Size([153, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.1248779296875 GB
    Memory Allocated: 14.026040077209473  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.1248779296875 GB
    Memory Allocated: 14.026040077209473  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 153, 256]), torch.Size([1, 153, 256])
----------------------------------------3
 Nvidia-smi: 16.1248779296875 GB
    Memory Allocated: 14.026331901550293  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.1756591796875 GB
    Memory Allocated: 14.075650215148926  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

rst.shape  torch.Size([1, 153, 256])
m.shape torch.Size([20571, 25, 256])
----------------------------------------1
 Nvidia-smi: 16.6678466796875 GB
    Memory Allocated: 14.56978702545166  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.6678466796875 GB
    Memory Allocated: 14.56978702545166  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

 h.shape torch.Size([1, 20571, 256]), torch.Size([1, 20571, 256])
----------------------------------------3
 Nvidia-smi: 16.6678466796875 GB
    Memory Allocated: 14.609023094177246  GigaBytes
Max Memory Allocated: 21.47903537750244  GigaBytes

----------------------------------------4
 Nvidia-smi: 23.5233154296875 GB
    Memory Allocated: 21.515385627746582  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 20571, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 23.5233154296875 GB
    Memory Allocated: 20.988385677337646  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 23.5233154296875 GB
    Memory Allocated: 20.99256706237793  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 23.5233154296875 GB
    Memory Allocated: 20.997275352478027  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 23.5233154296875 GB
    Memory Allocated: 20.992915630340576  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

torch.Size([23881, 47])
input nodes number: 215491
output nodes number: 23881
edges number: 555421
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 23.5233154296875 GB
    Memory Allocated: 20.994685649871826  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 23.5233154296875 GB
    Memory Allocated: 20.994686126708984  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7362060546875 GB
    Memory Allocated: 0.304379940032959  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

pseudo mini batch 6 input nodes size: 559500
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7362060546875 GB
    Memory Allocated: 0.2504572868347168  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7362060546875 GB
    Memory Allocated: 0.2504572868347168  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7362060546875 GB
    Memory Allocated: 0.45888757705688477  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7362060546875 GB
    Memory Allocated: 0.45906877517700195  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7362060546875 GB
    Memory Allocated: 0.2178807258605957  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7362060546875 GB
    Memory Allocated: 0.23877573013305664  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7362060546875 GB
    Memory Allocated: 0.23877573013305664  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

first layer input nodes number: 559500
first layer output nodes number: 219919
edges number: 2172458
----------------------------------------before model layer 0
 Nvidia-smi: 17.7362060546875 GB
    Memory Allocated: 0.2445836067199707  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

torch.Size([559500, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 17.7362060546875 GB
    Memory Allocated: 0.2445836067199707  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

m.shape torch.Size([339, 1, 100])
----------------------------------------1
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.076925277709961  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.076925277709961  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 339, 100]), torch.Size([1, 339, 100])
----------------------------------------3
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.0771780014038086  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.0791997909545898  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 339, 100])
m.shape torch.Size([436, 2, 100])
----------------------------------------1
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.0793986320495605  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.0793986320495605  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 436, 100]), torch.Size([1, 436, 100])
----------------------------------------3
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.079723834991455  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.0845990180969238  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 436, 100])
m.shape torch.Size([498, 3, 100])
----------------------------------------1
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.0849933624267578  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.0849933624267578  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 498, 100]), torch.Size([1, 498, 100])
----------------------------------------3
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.0853652954101562  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.0935349464416504  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 498, 100])
m.shape torch.Size([611, 4, 100])
----------------------------------------1
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.0942597389221191  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.0942597389221191  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 611, 100]), torch.Size([1, 611, 100])
----------------------------------------3
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.0947155952453613  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.107923984527588  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 611, 100])
m.shape torch.Size([756, 5, 100])
----------------------------------------1
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.109419822692871  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.109419822692871  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 756, 100]), torch.Size([1, 756, 100])
----------------------------------------3
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.1099834442138672  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.1311540603637695  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 756, 100])
m.shape torch.Size([866, 6, 100])
----------------------------------------1
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.1328082084655762  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.1328082084655762  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 866, 100]), torch.Size([1, 866, 100])
----------------------------------------3
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.1334538459777832  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.1620440483093262  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 866, 100])
m.shape torch.Size([913, 7, 100])
----------------------------------------1
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.1641020774841309  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.1641020774841309  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 913, 100]), torch.Size([1, 913, 100])
----------------------------------------3
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.164783000946045  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.1995878219604492  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 913, 100])
m.shape torch.Size([994, 8, 100])
----------------------------------------1
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.2022099494934082  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.2022099494934082  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 994, 100]), torch.Size([1, 994, 100])
----------------------------------------3
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.2029509544372559  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.245448112487793  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 994, 100])
m.shape torch.Size([1070, 9, 100])
----------------------------------------1
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.2486653327941895  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.2486653327941895  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 1070, 100]), torch.Size([1, 1070, 100])
----------------------------------------3
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.249462604522705  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 18.5467529296875 GB
    Memory Allocated: 1.301560878753662  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 1070, 100])
m.shape torch.Size([213436, 10, 100])
----------------------------------------1
 Nvidia-smi: 19.3436279296875 GB
    Memory Allocated: 2.096273422241211  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 19.3436279296875 GB
    Memory Allocated: 2.096273422241211  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 213436, 100]), torch.Size([1, 213436, 100])
----------------------------------------3
 Nvidia-smi: 19.3436279296875 GB
    Memory Allocated: 2.2558627128601074  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3807373046875 GB
    Memory Allocated: 13.55104398727417  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 213436, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 12.73887825012207  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 12.948609352111816  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.158340454101562  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 12.948609352111816  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

torch.Size([219919, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.158340454101562  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.210773468017578  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.210773468017578  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.79117488861084  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.79117488861084  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.791178703308105  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.79120922088623  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 2, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.791215419769287  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.791215419769287  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.791223049163818  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.791337490081787  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.791357040405273  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.791357040405273  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.791372299194336  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.791707992553711  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([16, 4, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.791761875152588  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.791761875152588  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.791792392730713  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.792677402496338  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 5, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.79272985458374  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.79272985458374  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.7927565574646  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.793717861175537  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([7, 6, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.793745040893555  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.793745040893555  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.793758392333984  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.794332504272461  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([15, 7, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.794426918029785  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.794426918029785  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.794455528259277  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.795886039733887  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 8, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.795979499816895  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.795979499816895  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.796006202697754  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.797528266906738  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([19, 9, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.797679424285889  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.797679424285889  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.797715663909912  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.800034999847412  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([17, 10, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.800180435180664  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.800180435180664  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.800212860107422  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.802515029907227  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 11, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.802689552307129  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.802689552307129  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.80272388458252  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.805401802062988  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 12, 256])
----------------------------------------1
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.805615425109863  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.805615425109863  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 16.3826904296875 GB
    Memory Allocated: 13.80565357208252  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3865966796875 GB
    Memory Allocated: 13.8088960647583  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([15, 13, 256])
----------------------------------------1
 Nvidia-smi: 16.3865966796875 GB
    Memory Allocated: 13.809064865112305  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3865966796875 GB
    Memory Allocated: 13.809064865112305  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 16.3865966796875 GB
    Memory Allocated: 13.809093475341797  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.811725616455078  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 14, 256])
----------------------------------------1
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.81194019317627  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.81194019317627  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 16.3905029296875 GB
    Memory Allocated: 13.811972618103027  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3924560546875 GB
    Memory Allocated: 13.81518268585205  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([22, 15, 256])
----------------------------------------1
 Nvidia-smi: 16.3944091796875 GB
    Memory Allocated: 13.815484046936035  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3944091796875 GB
    Memory Allocated: 13.815484046936035  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 16.3944091796875 GB
    Memory Allocated: 13.815526008605957  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.3983154296875 GB
    Memory Allocated: 13.819973945617676  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([27, 16, 256])
----------------------------------------1
 Nvidia-smi: 16.3983154296875 GB
    Memory Allocated: 13.82036828994751  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.3983154296875 GB
    Memory Allocated: 13.82036828994751  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 16.3983154296875 GB
    Memory Allocated: 13.820419788360596  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4041748046875 GB
    Memory Allocated: 13.826239109039307  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([21, 17, 256])
----------------------------------------1
 Nvidia-smi: 16.4041748046875 GB
    Memory Allocated: 13.82655668258667  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4041748046875 GB
    Memory Allocated: 13.82655668258667  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 16.4041748046875 GB
    Memory Allocated: 13.826596736907959  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4100341796875 GB
    Memory Allocated: 13.831403255462646  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 16.4100341796875 GB
    Memory Allocated: 13.831902503967285  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4100341796875 GB
    Memory Allocated: 13.831902503967285  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 16.4100341796875 GB
    Memory Allocated: 13.83195972442627  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4178466796875 GB
    Memory Allocated: 13.839226722717285  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 16.4178466796875 GB
    Memory Allocated: 13.839727878570557  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4178466796875 GB
    Memory Allocated: 13.839727878570557  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 16.4178466796875 GB
    Memory Allocated: 13.839783191680908  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4256591796875 GB
    Memory Allocated: 13.847195148468018  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([32, 20, 256])
----------------------------------------1
 Nvidia-smi: 16.4256591796875 GB
    Memory Allocated: 13.847782611846924  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4256591796875 GB
    Memory Allocated: 13.847782611846924  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 16.4256591796875 GB
    Memory Allocated: 13.847843647003174  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4354248046875 GB
    Memory Allocated: 13.856449604034424  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 16.4354248046875 GB
    Memory Allocated: 13.856964111328125  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4354248046875 GB
    Memory Allocated: 13.856964111328125  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 16.4354248046875 GB
    Memory Allocated: 13.857015609741211  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4432373046875 GB
    Memory Allocated: 13.86463737487793  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 16.4432373046875 GB
    Memory Allocated: 13.865288257598877  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4432373046875 GB
    Memory Allocated: 13.865288257598877  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 16.4432373046875 GB
    Memory Allocated: 13.865349292755127  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4530029296875 GB
    Memory Allocated: 13.874809741973877  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([32, 23, 256])
----------------------------------------1
 Nvidia-smi: 16.4530029296875 GB
    Memory Allocated: 13.875486850738525  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4530029296875 GB
    Memory Allocated: 13.875486850738525  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 16.4530029296875 GB
    Memory Allocated: 13.875547885894775  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4647216796875 GB
    Memory Allocated: 13.885435581207275  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([42, 24, 256])
----------------------------------------1
 Nvidia-smi: 16.4647216796875 GB
    Memory Allocated: 13.88637399673462  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 16.4647216796875 GB
    Memory Allocated: 13.88637399673462  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 16.4647216796875 GB
    Memory Allocated: 13.886454105377197  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------4
 Nvidia-smi: 16.4803466796875 GB
    Memory Allocated: 13.8999924659729  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([23816, 25, 256])
----------------------------------------1
 Nvidia-smi: 17.0487060546875 GB
    Memory Allocated: 14.472748279571533  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

----------------------------------------2
 Nvidia-smi: 17.0487060546875 GB
    Memory Allocated: 14.472748279571533  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

 h.shape torch.Size([1, 23816, 256]), torch.Size([1, 23816, 256])
----------------------------------------3
 Nvidia-smi: 17.0487060546875 GB
    Memory Allocated: 14.518173694610596  GigaBytes
Max Memory Allocated: 22.005836486816406  GigaBytes

