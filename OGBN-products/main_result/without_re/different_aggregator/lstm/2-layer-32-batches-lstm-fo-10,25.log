main start at this time 1655788951.125512
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

The real block id is  1
get_global_graph_edges_ids_block function  spend 0.22708940505981445
global_2_local spend time (sec) 0.3947420120239258
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.049240827560424805
A = g.adjacency_matrix() spent  0.07451391220092773
auxiliary_graph
Graph(num_nodes=1205586, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.6130259037017822
remove nodes length
1009015
auxiliary_graph.remove_nodes spent  2.7222049236297607
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=51744463,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  2.0708789825439453

the counter of shared neighbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
51547892
--------------------------------------- new test ---------------------
--------------------------------------- new test ---------------------

before step function auxiliary_graph_no_diag.edata[w]

tensor([       0,        1,        2,  ..., 51547889, 51547890, 51547891])
drop no edges

after step function v.2.0 all zero auxiliary_graph_no_diag.edata[w]
the counter of shared neigbor distribution
Counter({1.0: 42565268, 2.0: 5784668, 3.0: 1687528, 4.0: 688038, 5.0: 337564, 6.0: 180988, 7.0: 106156, 8.0: 62284, 9.0: 39504, 10.0: 24936, 11.0: 16152, 12.0: 10442, 13.0: 7436, 14.0: 6488, 15.0: 6116, 18.0: 3980, 16.0: 3882, 17.0: 2908, 20.0: 2870, 19.0: 2726, 22.0: 1912, 23.0: 1838, 21.0: 1636, 24.0: 1624, 25.0: 948})
Convert a graph into a bidirected graph: 2.894 seconds
Metis partitioning: 12.883 seconds
Split the graph: 0.648 seconds
Construct subgraphs: 0.251 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  16.695951223373413
6229
6310
5994
6327
6067
5977
5992
5966
5963
6311
5963
5981
5971
5971
6322
6324
6142
6285
6309
6210
5998
5965
5963
6103
6319
5991
6295
6312
6327
6048
6309
6327
total k batches seeds list generation spend  37.58078384399414
after graph partition
graph partition algorithm spend time 38.01875567436218
6229
6310
5994
6327
6067
5977
5992
5966
5963
6311
5963
5981
5971
5971
6322
6324
6142
6285
6309
6210
5998
5965
5963
6103
6319
5991
6295
6312
6327
6048
6309
6327
partition_len_list
[66174, 57447, 58773, 57185, 52383, 65562, 46566, 51840, 60895, 45258, 44148, 52419, 51535, 61560, 61858, 55367, 56230, 47874, 73405, 61844, 64939, 49312, 62853, 58038, 67058, 59575, 65559, 57141, 73822, 63339, 57265, 72953]
shared_neighbor_graph_partition_s0 selection method  spend 38.66590452194214
time for parepare:  0.24637889862060547
local_output_nid generation:  0.0021810531616210938
local_in_edges_tensor generation:  0.0026731491088867188
mini_batch_src_global generation:  0.004957675933837891
r_  generation:  0.048806190490722656
local_output_nid generation:  0.002477884292602539
local_in_edges_tensor generation:  0.002542734146118164
mini_batch_src_global generation:  0.006064653396606445
r_  generation:  0.05001258850097656
local_output_nid generation:  0.0024247169494628906
local_in_edges_tensor generation:  0.002489328384399414
mini_batch_src_global generation:  0.004466533660888672
r_  generation:  0.048537492752075195
local_output_nid generation:  0.002569913864135742
local_in_edges_tensor generation:  0.0025968551635742188
mini_batch_src_global generation:  0.004871845245361328
r_  generation:  0.05268383026123047
local_output_nid generation:  0.002454996109008789
local_in_edges_tensor generation:  0.002547740936279297
mini_batch_src_global generation:  0.0046198368072509766
r_  generation:  0.050440311431884766
local_output_nid generation:  0.0024695396423339844
local_in_edges_tensor generation:  0.0024938583374023438
mini_batch_src_global generation:  0.00486302375793457
r_  generation:  0.05130505561828613
local_output_nid generation:  0.0024461746215820312
local_in_edges_tensor generation:  0.002479076385498047
mini_batch_src_global generation:  0.004891872406005859
r_  generation:  0.05019879341125488
local_output_nid generation:  0.0024340152740478516
local_in_edges_tensor generation:  0.002456188201904297
mini_batch_src_global generation:  0.004660129547119141
r_  generation:  0.04930877685546875
local_output_nid generation:  0.002462148666381836
local_in_edges_tensor generation:  0.002473592758178711
mini_batch_src_global generation:  0.00468134880065918
r_  generation:  0.049550533294677734
local_output_nid generation:  0.002579212188720703
local_in_edges_tensor generation:  0.0025777816772460938
mini_batch_src_global generation:  0.005190372467041016
r_  generation:  0.05346202850341797
local_output_nid generation:  0.0024437904357910156
local_in_edges_tensor generation:  0.002469778060913086
mini_batch_src_global generation:  0.004754066467285156
r_  generation:  0.04647636413574219
local_output_nid generation:  0.0024323463439941406
local_in_edges_tensor generation:  0.002436399459838867
mini_batch_src_global generation:  0.0047152042388916016
r_  generation:  0.048825740814208984
local_output_nid generation:  0.0024416446685791016
local_in_edges_tensor generation:  0.002454996109008789
mini_batch_src_global generation:  0.005052804946899414
r_  generation:  0.05111193656921387
local_output_nid generation:  0.0024552345275878906
local_in_edges_tensor generation:  0.0024423599243164062
mini_batch_src_global generation:  0.005023002624511719
r_  generation:  0.05287885665893555
local_output_nid generation:  0.0025942325592041016
local_in_edges_tensor generation:  0.002579927444458008
mini_batch_src_global generation:  0.0055887699127197266
r_  generation:  0.05630040168762207
local_output_nid generation:  0.002566814422607422
local_in_edges_tensor generation:  0.0026252269744873047
mini_batch_src_global generation:  0.005413055419921875
r_  generation:  0.0564420223236084
local_output_nid generation:  0.0025179386138916016
local_in_edges_tensor generation:  0.002523183822631836
mini_batch_src_global generation:  0.005120277404785156
r_  generation:  0.050809621810913086
local_output_nid generation:  0.0025730133056640625
local_in_edges_tensor generation:  0.0025682449340820312
mini_batch_src_global generation:  0.0049991607666015625
r_  generation:  0.05215597152709961
local_output_nid generation:  0.0025811195373535156
local_in_edges_tensor generation:  0.0026154518127441406
mini_batch_src_global generation:  0.0052297115325927734
r_  generation:  0.05696988105773926
local_output_nid generation:  0.0025453567504882812
local_in_edges_tensor generation:  0.0025963783264160156
mini_batch_src_global generation:  0.005387783050537109
r_  generation:  0.05388689041137695
local_output_nid generation:  0.002497434616088867
local_in_edges_tensor generation:  0.0025682449340820312
mini_batch_src_global generation:  0.005029201507568359
r_  generation:  0.05014824867248535
local_output_nid generation:  0.00244903564453125
local_in_edges_tensor generation:  0.002431154251098633
mini_batch_src_global generation:  0.004853725433349609
r_  generation:  0.05157113075256348
local_output_nid generation:  0.0024514198303222656
local_in_edges_tensor generation:  0.002408742904663086
mini_batch_src_global generation:  0.0046710968017578125
r_  generation:  0.04774045944213867
local_output_nid generation:  0.0025136470794677734
local_in_edges_tensor generation:  0.0024101734161376953
mini_batch_src_global generation:  0.004731893539428711
r_  generation:  0.04860043525695801
local_output_nid generation:  0.0025870800018310547
local_in_edges_tensor generation:  0.0025718212127685547
mini_batch_src_global generation:  0.0052950382232666016
r_  generation:  0.05757737159729004
local_output_nid generation:  0.0024628639221191406
local_in_edges_tensor generation:  0.02758479118347168
mini_batch_src_global generation:  0.005736351013183594
r_  generation:  0.054232120513916016
local_output_nid generation:  0.002561807632446289
local_in_edges_tensor generation:  0.0025708675384521484
mini_batch_src_global generation:  0.00544285774230957
r_  generation:  0.057404279708862305
local_output_nid generation:  0.0026068687438964844
local_in_edges_tensor generation:  0.0026068687438964844
mini_batch_src_global generation:  0.005748748779296875
r_  generation:  0.057503700256347656
local_output_nid generation:  0.0025899410247802734
local_in_edges_tensor generation:  0.002628803253173828
mini_batch_src_global generation:  0.00545048713684082
r_  generation:  0.05701184272766113
local_output_nid generation:  0.002496004104614258
local_in_edges_tensor generation:  0.002572774887084961
mini_batch_src_global generation:  0.005560636520385742
r_  generation:  0.05563163757324219
local_output_nid generation:  0.0025832653045654297
local_in_edges_tensor generation:  0.003324747085571289
mini_batch_src_global generation:  0.0057048797607421875
r_  generation:  0.05797243118286133
local_output_nid generation:  0.002590656280517578
local_in_edges_tensor generation:  0.0026535987854003906
mini_batch_src_global generation:  0.005714893341064453
r_  generation:  0.05693364143371582
----------------------check_connections_block total spend ----------------------------- 2.6634461879730225
generate_one_block  1.4785549640655518
generate_one_block  0.07659339904785156
generate_one_block  0.07407069206237793
generate_one_block  0.07528018951416016
generate_one_block  0.07088494300842285
generate_one_block  0.07702445983886719
generate_one_block  0.06852221488952637
generate_one_block  0.07073307037353516
generate_one_block  0.07243680953979492
generate_one_block  0.07355451583862305
generate_one_block  0.06668806076049805
generate_one_block  0.06862974166870117
generate_one_block  0.07123279571533203
generate_one_block  0.07705140113830566
generate_one_block  0.08199667930603027
generate_one_block  0.08723163604736328
generate_one_block  0.07819437980651855
generate_one_block  0.07449841499328613
generate_one_block  0.0890803337097168
generate_one_block  0.08123421669006348
generate_one_block  0.07676959037780762
generate_one_block  0.06992030143737793
generate_one_block  0.07317590713500977
generate_one_block  0.0702219009399414
generate_one_block  0.08512187004089355
generate_one_block  0.07644200325012207
generate_one_block  0.08188724517822266
generate_one_block  0.07822966575622559
generate_one_block  0.08300948143005371
generate_one_block  0.07784223556518555
generate_one_block  0.07650041580200195
generate_one_block  0.0835123062133789
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.6913866996765137
gen group dst list time:  0.05048322677612305
time for parepare:  0.3953671455383301
local_output_nid generation:  0.017292261123657227
local_in_edges_tensor generation:  0.07604384422302246
mini_batch_src_global generation:  0.01959085464477539
r_  generation:  0.2511765956878662
local_output_nid generation:  0.018030405044555664
local_in_edges_tensor generation:  0.09886455535888672
mini_batch_src_global generation:  0.0235137939453125
r_  generation:  0.22093987464904785
local_output_nid generation:  0.01901865005493164
local_in_edges_tensor generation:  0.020859718322753906
mini_batch_src_global generation:  0.02293992042541504
r_  generation:  0.2551729679107666
local_output_nid generation:  0.023357152938842773
local_in_edges_tensor generation:  0.034702301025390625
mini_batch_src_global generation:  0.022979021072387695
r_  generation:  0.23272323608398438
local_output_nid generation:  0.01616525650024414
local_in_edges_tensor generation:  0.020653963088989258
mini_batch_src_global generation:  0.02100658416748047
r_  generation:  0.2162342071533203
local_output_nid generation:  0.019889116287231445
local_in_edges_tensor generation:  0.024359703063964844
mini_batch_src_global generation:  0.028029441833496094
r_  generation:  0.29389309883117676
local_output_nid generation:  0.01385354995727539
local_in_edges_tensor generation:  0.017917633056640625
mini_batch_src_global generation:  0.02236485481262207
r_  generation:  0.19806647300720215
local_output_nid generation:  0.01576089859008789
local_in_edges_tensor generation:  0.017183780670166016
mini_batch_src_global generation:  0.02252340316772461
r_  generation:  0.21724891662597656
local_output_nid generation:  0.018213510513305664
local_in_edges_tensor generation:  0.028296232223510742
mini_batch_src_global generation:  0.027031421661376953
r_  generation:  0.275571346282959
local_output_nid generation:  0.013421773910522461
local_in_edges_tensor generation:  0.016716718673706055
mini_batch_src_global generation:  0.022084951400756836
r_  generation:  0.19278860092163086
local_output_nid generation:  0.013079643249511719
local_in_edges_tensor generation:  0.01483011245727539
mini_batch_src_global generation:  0.02020549774169922
r_  generation:  0.17847609519958496
local_output_nid generation:  0.015551328659057617
local_in_edges_tensor generation:  0.017244338989257812
mini_batch_src_global generation:  0.02425694465637207
r_  generation:  0.21761608123779297
local_output_nid generation:  0.015810489654541016
local_in_edges_tensor generation:  0.019907236099243164
mini_batch_src_global generation:  0.023517847061157227
r_  generation:  0.2281200885772705
local_output_nid generation:  0.025118112564086914
local_in_edges_tensor generation:  0.023863554000854492
mini_batch_src_global generation:  0.02672100067138672
r_  generation:  0.2830181121826172
local_output_nid generation:  0.018959760665893555
local_in_edges_tensor generation:  0.020505905151367188
mini_batch_src_global generation:  0.02802133560180664
r_  generation:  0.27570271492004395
local_output_nid generation:  0.015987873077392578
local_in_edges_tensor generation:  0.0175015926361084
mini_batch_src_global generation:  0.025995254516601562
r_  generation:  0.2360525131225586
local_output_nid generation:  0.016797542572021484
local_in_edges_tensor generation:  0.01749253273010254
mini_batch_src_global generation:  0.025523662567138672
r_  generation:  0.2506873607635498
local_output_nid generation:  0.01868891716003418
local_in_edges_tensor generation:  0.016432523727416992
mini_batch_src_global generation:  0.022839069366455078
r_  generation:  0.1930396556854248
local_output_nid generation:  0.022958040237426758
local_in_edges_tensor generation:  0.021349668502807617
mini_batch_src_global generation:  0.031545400619506836
r_  generation:  0.3243257999420166
local_output_nid generation:  0.018921613693237305
local_in_edges_tensor generation:  0.02472376823425293
mini_batch_src_global generation:  0.030137062072753906
r_  generation:  0.28336334228515625
local_output_nid generation:  0.020503759384155273
local_in_edges_tensor generation:  0.02237868309020996
mini_batch_src_global generation:  0.03047633171081543
r_  generation:  0.31443119049072266
local_output_nid generation:  0.015569448471069336
local_in_edges_tensor generation:  0.016785621643066406
mini_batch_src_global generation:  0.026012659072875977
r_  generation:  0.22372150421142578
local_output_nid generation:  0.018846988677978516
local_in_edges_tensor generation:  0.01947188377380371
mini_batch_src_global generation:  0.026976823806762695
r_  generation:  0.2985501289367676
local_output_nid generation:  0.017733335494995117
local_in_edges_tensor generation:  0.021413326263427734
mini_batch_src_global generation:  0.029581308364868164
r_  generation:  0.27936840057373047
local_output_nid generation:  0.020154953002929688
local_in_edges_tensor generation:  0.020804166793823242
mini_batch_src_global generation:  0.03165483474731445
r_  generation:  0.32694530487060547
local_output_nid generation:  0.0184786319732666
local_in_edges_tensor generation:  0.019706010818481445
mini_batch_src_global generation:  0.03036665916442871
r_  generation:  0.2818789482116699
local_output_nid generation:  0.0195465087890625
local_in_edges_tensor generation:  0.020057201385498047
mini_batch_src_global generation:  0.030004501342773438
r_  generation:  0.3202366828918457
local_output_nid generation:  0.016727685928344727
local_in_edges_tensor generation:  0.016306638717651367
mini_batch_src_global generation:  0.028706073760986328
r_  generation:  0.2547605037689209
local_output_nid generation:  0.022968053817749023
local_in_edges_tensor generation:  0.02478504180908203
mini_batch_src_global generation:  0.031896352767944336
r_  generation:  0.3540918827056885
local_output_nid generation:  0.019231557846069336
local_in_edges_tensor generation:  0.023514509201049805
mini_batch_src_global generation:  0.03200221061706543
r_  generation:  0.29895734786987305
local_output_nid generation:  0.016753673553466797
local_in_edges_tensor generation:  0.01642012596130371
mini_batch_src_global generation:  0.027088642120361328
r_  generation:  0.25408148765563965
local_output_nid generation:  0.022769451141357422
local_in_edges_tensor generation:  0.02463388442993164
mini_batch_src_global generation:  0.0334932804107666
r_  generation:  0.3454740047454834
----------------------check_connections_block total spend ----------------------------- 12.929348468780518
generate_one_block  0.561875581741333
generate_one_block  0.31592416763305664
generate_one_block  0.35663366317749023
generate_one_block  0.2946133613586426
generate_one_block  0.266265869140625
generate_one_block  0.36144590377807617
generate_one_block  0.22846364974975586
generate_one_block  0.2588324546813965
generate_one_block  0.31122326850891113
generate_one_block  0.22385382652282715
generate_one_block  0.2528684139251709
generate_one_block  0.26389002799987793
generate_one_block  0.2609546184539795
generate_one_block  0.31345272064208984
generate_one_block  0.31419944763183594
generate_one_block  0.28441715240478516
generate_one_block  0.30391621589660645
generate_one_block  0.23022699356079102
generate_one_block  0.403317928314209
generate_one_block  0.32732391357421875
generate_one_block  0.36529541015625
generate_one_block  0.2503368854522705
generate_one_block  0.33971118927001953
generate_one_block  0.315366268157959
generate_one_block  0.34104490280151367
generate_one_block  0.307086706161499
generate_one_block  0.3361365795135498
generate_one_block  0.28722095489501953
generate_one_block  0.40828609466552734
generate_one_block  0.3245208263397217
generate_one_block  0.28258538246154785
generate_one_block  0.4071962833404541
----------===============-------------===============-------------the number of batches *****---- 32

original number of batches:  32
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

connection checking time:  15.59279465675354
block generation total time  13.944612503051758
average batch blocks generation time:  0.21788457036018372
block dataloader generation time/epoch 70.26899075508118
pseudo mini batch 0 input nodes size: 235826
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0194091796875 GB
    Memory Allocated: 0.0025434494018554688  GigaBytes
Max Memory Allocated: 0.0025434494018554688  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.09043407440185547  GigaBytes
Max Memory Allocated: 0.09043407440185547  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.09048080444335938  GigaBytes
Max Memory Allocated: 0.09048080444335938  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.1072998046875 GB
    Memory Allocated: 0.09048080444335938  GigaBytes
Max Memory Allocated: 0.09048080444335938  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.1932373046875 GB
    Memory Allocated: 0.09636974334716797  GigaBytes
Max Memory Allocated: 0.09636974334716797  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.1932373046875 GB
    Memory Allocated: 0.09636974334716797  GigaBytes
Max Memory Allocated: 0.09636974334716797  GigaBytes

first layer input nodes number: 235826
first layer output nodes number: 66174
edges number: 639480
----------------------------------------before model layer 0
 Nvidia-smi: 1.1932373046875 GB
    Memory Allocated: 0.09861993789672852  GigaBytes
Max Memory Allocated: 0.10100221633911133  GigaBytes

torch.Size([235826, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 1.1932373046875 GB
    Memory Allocated: 0.09861993789672852  GigaBytes
Max Memory Allocated: 0.10100221633911133  GigaBytes

m.shape torch.Size([195, 1, 100])
----------------------------------------1
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.3437180519104004  GigaBytes
Max Memory Allocated: 0.3538236618041992  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.3437180519104004  GigaBytes
Max Memory Allocated: 0.3538236618041992  GigaBytes

 h.shape torch.Size([1, 195, 100]), torch.Size([1, 195, 100])
----------------------------------------3
 Nvidia-smi: 1.5604248046875 GB
    Memory Allocated: 0.34386396408081055  GigaBytes
Max Memory Allocated: 0.3538236618041992  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5643310546875 GB
    Memory Allocated: 0.3450284004211426  GigaBytes
Max Memory Allocated: 0.3538236618041992  GigaBytes

rst.shape  torch.Size([1, 195, 100])
m.shape torch.Size([321, 2, 100])
----------------------------------------1
 Nvidia-smi: 1.5643310546875 GB
    Memory Allocated: 0.34519481658935547  GigaBytes
Max Memory Allocated: 0.3538236618041992  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5643310546875 GB
    Memory Allocated: 0.34519481658935547  GigaBytes
Max Memory Allocated: 0.3538236618041992  GigaBytes

 h.shape torch.Size([1, 321, 100]), torch.Size([1, 321, 100])
----------------------------------------3
 Nvidia-smi: 1.5643310546875 GB
    Memory Allocated: 0.34543418884277344  GigaBytes
Max Memory Allocated: 0.3538236618041992  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.34902477264404297  GigaBytes
Max Memory Allocated: 0.3538236618041992  GigaBytes

rst.shape  torch.Size([1, 321, 100])
m.shape torch.Size([431, 3, 100])
----------------------------------------1
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.34938716888427734  GigaBytes
Max Memory Allocated: 0.3538236618041992  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.34938716888427734  GigaBytes
Max Memory Allocated: 0.3538236618041992  GigaBytes

 h.shape torch.Size([1, 431, 100]), torch.Size([1, 431, 100])
----------------------------------------3
 Nvidia-smi: 1.5682373046875 GB
    Memory Allocated: 0.34970855712890625  GigaBytes
Max Memory Allocated: 0.3538236618041992  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.35677480697631836  GigaBytes
Max Memory Allocated: 0.3572568893432617  GigaBytes

rst.shape  torch.Size([1, 431, 100])
m.shape torch.Size([573, 4, 100])
----------------------------------------1
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3574681282043457  GigaBytes
Max Memory Allocated: 0.35749387741088867  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3574681282043457  GigaBytes
Max Memory Allocated: 0.35749387741088867  GigaBytes

 h.shape torch.Size([1, 573, 100]), torch.Size([1, 573, 100])
----------------------------------------3
 Nvidia-smi: 1.5760498046875 GB
    Memory Allocated: 0.3578953742980957  GigaBytes
Max Memory Allocated: 0.3578953742980957  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.37027978897094727  GigaBytes
Max Memory Allocated: 0.37113380432128906  GigaBytes

rst.shape  torch.Size([1, 573, 100])
m.shape torch.Size([658, 5, 100])
----------------------------------------1
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.3712921142578125  GigaBytes
Max Memory Allocated: 0.37132930755615234  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.3712921142578125  GigaBytes
Max Memory Allocated: 0.37132930755615234  GigaBytes

 h.shape torch.Size([1, 658, 100]), torch.Size([1, 658, 100])
----------------------------------------3
 Nvidia-smi: 1.5897216796875 GB
    Memory Allocated: 0.3717832565307617  GigaBytes
Max Memory Allocated: 0.3717832565307617  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.38959598541259766  GigaBytes
Max Memory Allocated: 0.3908219337463379  GigaBytes

rst.shape  torch.Size([1, 658, 100])
m.shape torch.Size([746, 6, 100])
----------------------------------------1
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.3910179138183594  GigaBytes
Max Memory Allocated: 0.3910679817199707  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.3910179138183594  GigaBytes
Max Memory Allocated: 0.3910679817199707  GigaBytes

 h.shape torch.Size([1, 746, 100]), torch.Size([1, 746, 100])
----------------------------------------3
 Nvidia-smi: 1.5936279296875 GB
    Memory Allocated: 0.3915739059448242  GigaBytes
Max Memory Allocated: 0.3915739059448242  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6170654296875 GB
    Memory Allocated: 0.41549062728881836  GigaBytes
Max Memory Allocated: 0.4171581268310547  GigaBytes

rst.shape  torch.Size([1, 746, 100])
m.shape torch.Size([824, 7, 100])
----------------------------------------1
 Nvidia-smi: 1.6170654296875 GB
    Memory Allocated: 0.4173617362976074  GigaBytes
Max Memory Allocated: 0.41742706298828125  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6170654296875 GB
    Memory Allocated: 0.4173617362976074  GigaBytes
Max Memory Allocated: 0.41742706298828125  GigaBytes

 h.shape torch.Size([1, 824, 100]), torch.Size([1, 824, 100])
----------------------------------------3
 Nvidia-smi: 1.6170654296875 GB
    Memory Allocated: 0.41797590255737305  GigaBytes
Max Memory Allocated: 0.41797590255737305  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.4486813545227051  GigaBytes
Max Memory Allocated: 0.45083045959472656  GigaBytes

rst.shape  torch.Size([1, 824, 100])
m.shape torch.Size([925, 8, 100])
----------------------------------------1
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.45113134384155273  GigaBytes
Max Memory Allocated: 0.4512143135070801  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.45113134384155273  GigaBytes
Max Memory Allocated: 0.4512143135070801  GigaBytes

 h.shape torch.Size([1, 925, 100]), torch.Size([1, 925, 100])
----------------------------------------3
 Nvidia-smi: 1.6619873046875 GB
    Memory Allocated: 0.45182085037231445  GigaBytes
Max Memory Allocated: 0.45182085037231445  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.49134302139282227  GigaBytes
Max Memory Allocated: 0.49433183670043945  GigaBytes

rst.shape  torch.Size([1, 925, 100])
m.shape torch.Size([886, 9, 100])
----------------------------------------1
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.4939870834350586  GigaBytes
Max Memory Allocated: 0.49433183670043945  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.4939870834350586  GigaBytes
Max Memory Allocated: 0.49433183670043945  GigaBytes

 h.shape torch.Size([1, 886, 100]), torch.Size([1, 886, 100])
----------------------------------------3
 Nvidia-smi: 1.6893310546875 GB
    Memory Allocated: 0.4946479797363281  GigaBytes
Max Memory Allocated: 0.4946479797363281  GigaBytes

----------------------------------------4
 Nvidia-smi: 1.7557373046875 GB
    Memory Allocated: 0.5369067192077637  GigaBytes
Max Memory Allocated: 0.5398774147033691  GigaBytes

rst.shape  torch.Size([1, 886, 100])
m.shape torch.Size([60615, 10, 100])
----------------------------------------1
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.7631387710571289  GigaBytes
Max Memory Allocated: 0.770021915435791  GigaBytes

----------------------------------------2
 Nvidia-smi: 1.9822998046875 GB
    Memory Allocated: 0.7631387710571289  GigaBytes
Max Memory Allocated: 0.770021915435791  GigaBytes

 h.shape torch.Size([1, 60615, 100]), torch.Size([1, 60615, 100])
----------------------------------------3
 Nvidia-smi: 2.0291748046875 GB
    Memory Allocated: 0.8100137710571289  GigaBytes
Max Memory Allocated: 0.8100137710571289  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.035342216491699  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 60615, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 3.796177387237549  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 3.859285831451416  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 3.922394275665283  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 3.859285831451416  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

torch.Size([66174, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 3.922394275665283  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 3.93817138671875  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 3.93817138671875  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.083379745483398  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.083379745483398  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.083385467529297  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.083431243896484  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.083444118499756  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.083444118499756  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.083459377288818  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.083688259124756  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.083706855773926  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.083706855773926  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.083724021911621  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.084101676940918  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([17, 4, 256])
----------------------------------------1
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.084158897399902  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.084158897399902  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.08419132232666  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.085131645202637  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([5, 5, 256])
----------------------------------------1
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.085139751434326  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.085139751434326  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.08514928817749  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.0854926109313965  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([17, 6, 256])
----------------------------------------1
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.085586071014404  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.085586071014404  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.085618495941162  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.087012767791748  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 7, 256])
----------------------------------------1
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.087097644805908  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.087097644805908  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.0871262550354  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.08855676651001  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([22, 8, 256])
----------------------------------------1
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.088711738586426  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.088711738586426  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.5252685546875 GB
    Memory Allocated: 4.088753700256348  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5272216796875 GB
    Memory Allocated: 4.0911455154418945  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 9, 256])
----------------------------------------1
 Nvidia-smi: 5.5272216796875 GB
    Memory Allocated: 4.091271877288818  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5272216796875 GB
    Memory Allocated: 4.091271877288818  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.5272216796875 GB
    Memory Allocated: 4.091304302215576  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 4.093379497528076  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([23, 10, 256])
----------------------------------------1
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 4.0935845375061035  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 4.0935845375061035  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.5291748046875 GB
    Memory Allocated: 4.093628406524658  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5330810546875 GB
    Memory Allocated: 4.096743106842041  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([28, 11, 256])
----------------------------------------1
 Nvidia-smi: 5.5330810546875 GB
    Memory Allocated: 4.097017288208008  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5330810546875 GB
    Memory Allocated: 4.097017288208008  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.5330810546875 GB
    Memory Allocated: 4.097070693969727  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5369873046875 GB
    Memory Allocated: 4.101236343383789  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([19, 12, 256])
----------------------------------------1
 Nvidia-smi: 5.5369873046875 GB
    Memory Allocated: 4.101428985595703  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5369873046875 GB
    Memory Allocated: 4.101428985595703  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 5.5369873046875 GB
    Memory Allocated: 4.101465225219727  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5408935546875 GB
    Memory Allocated: 4.104545593261719  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([30, 13, 256])
----------------------------------------1
 Nvidia-smi: 5.5408935546875 GB
    Memory Allocated: 4.104902744293213  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5408935546875 GB
    Memory Allocated: 4.104902744293213  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.5408935546875 GB
    Memory Allocated: 4.104959964752197  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 4.11022424697876  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 14, 256])
----------------------------------------1
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 4.110491752624512  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 4.110491752624512  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.5467529296875 GB
    Memory Allocated: 4.110533714294434  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5506591796875 GB
    Memory Allocated: 4.114687919616699  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 15, 256])
----------------------------------------1
 Nvidia-smi: 5.5506591796875 GB
    Memory Allocated: 4.114912033081055  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5506591796875 GB
    Memory Allocated: 4.114912033081055  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 5.5506591796875 GB
    Memory Allocated: 4.1149444580078125  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 4.118381500244141  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 4.118703842163086  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 4.118703842163086  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.5545654296875 GB
    Memory Allocated: 4.118745803833008  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5584716796875 GB
    Memory Allocated: 4.12348747253418  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 5.5604248046875 GB
    Memory Allocated: 4.123924255371094  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5604248046875 GB
    Memory Allocated: 4.123924255371094  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 5.5604248046875 GB
    Memory Allocated: 4.1239776611328125  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5662841796875 GB
    Memory Allocated: 4.1303863525390625  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 5.5662841796875 GB
    Memory Allocated: 4.130671501159668  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5662841796875 GB
    Memory Allocated: 4.130671501159668  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 5.5662841796875 GB
    Memory Allocated: 4.130705833435059  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5701904296875 GB
    Memory Allocated: 4.135066032409668  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([24, 19, 256])
----------------------------------------1
 Nvidia-smi: 5.5721435546875 GB
    Memory Allocated: 4.1354875564575195  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5721435546875 GB
    Memory Allocated: 4.1354875564575195  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.5721435546875 GB
    Memory Allocated: 4.135533332824707  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5780029296875 GB
    Memory Allocated: 4.141667366027832  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 5.5780029296875 GB
    Memory Allocated: 4.141932964324951  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5780029296875 GB
    Memory Allocated: 4.141932964324951  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 5.5780029296875 GB
    Memory Allocated: 4.141961574554443  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 4.145995616912842  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([24, 21, 256])
----------------------------------------1
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 4.14646577835083  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 4.14646577835083  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 5.5819091796875 GB
    Memory Allocated: 4.146511554718018  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 4.153286457061768  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 4.15372896194458  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 4.15372896194458  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 5.5897216796875 GB
    Memory Allocated: 4.153770923614502  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.5955810546875 GB
    Memory Allocated: 4.160274982452393  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 5.5975341796875 GB
    Memory Allocated: 4.160917282104492  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.5975341796875 GB
    Memory Allocated: 4.160917282104492  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 5.5975341796875 GB
    Memory Allocated: 4.160974502563477  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6072998046875 GB
    Memory Allocated: 4.170244216918945  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 24, 256])
----------------------------------------1
 Nvidia-smi: 5.6072998046875 GB
    Memory Allocated: 4.170746326446533  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.6072998046875 GB
    Memory Allocated: 4.170746326446533  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 5.6072998046875 GB
    Memory Allocated: 4.170790195465088  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

----------------------------------------4
 Nvidia-smi: 5.6151123046875 GB
    Memory Allocated: 4.17820405960083  GigaBytes
Max Memory Allocated: 4.261904716491699  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([5771, 25, 256])
----------------------------------------1
 Nvidia-smi: 5.7557373046875 GB
    Memory Allocated: 4.316886901855469  GigaBytes
Max Memory Allocated: 4.317424774169922  GigaBytes

----------------------------------------2
 Nvidia-smi: 5.7557373046875 GB
    Memory Allocated: 4.316886901855469  GigaBytes
Max Memory Allocated: 4.317424774169922  GigaBytes

 h.shape torch.Size([1, 5771, 256]), torch.Size([1, 5771, 256])
----------------------------------------3
 Nvidia-smi: 5.7557373046875 GB
    Memory Allocated: 4.32789421081543  GigaBytes
Max Memory Allocated: 4.32789421081543  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.8240966796875 GB
    Memory Allocated: 6.265180587768555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5771, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.8240966796875 GB
    Memory Allocated: 6.1216535568237305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.8240966796875 GB
    Memory Allocated: 6.123076438903809  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.8240966796875 GB
    Memory Allocated: 6.124499320983887  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.8240966796875 GB
    Memory Allocated: 6.123029708862305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([6229, 47])
input nodes number: 66174
output nodes number: 6229
edges number: 150807
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.8240966796875 GB
    Memory Allocated: 6.124992370605469  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.8240966796875 GB
    Memory Allocated: 6.124993324279785  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.11065673828125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

pseudo mini batch 1 input nodes size: 172596
----------------------------------------before load block subtensor 
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.09444808959960938  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.09444808959960938  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.15874528884887695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.15879249572753906  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.07085514068603516  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.07611751556396484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.07611751556396484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

first layer input nodes number: 172596
first layer output nodes number: 57447
edges number: 553648
----------------------------------------before model layer 0
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.07783174514770508  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([172596, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.07783174514770508  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([175, 1, 100])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.2899909019470215  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.2899909019470215  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 175, 100]), torch.Size([1, 175, 100])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.29012155532836914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.2911653518676758  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 175, 100])
m.shape torch.Size([298, 2, 100])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.2913222312927246  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.2913222312927246  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 298, 100]), torch.Size([1, 298, 100])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.29154443740844727  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.2948775291442871  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 298, 100])
m.shape torch.Size([443, 3, 100])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.29526185989379883  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.29526185989379883  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 443, 100]), torch.Size([1, 443, 100])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.2955927848815918  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.3028602600097656  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 443, 100])
m.shape torch.Size([546, 4, 100])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.3035087585449219  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.3035087585449219  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 546, 100]), torch.Size([1, 546, 100])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.30391597747802734  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.3157196044921875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 546, 100])
m.shape torch.Size([647, 5, 100])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.3172593116760254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.3172593116760254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 647, 100]), torch.Size([1, 647, 100])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.31774187088012695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.3350996971130371  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 647, 100])
m.shape torch.Size([700, 6, 100])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.336423397064209  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.336423397064209  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 700, 100]), torch.Size([1, 700, 100])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.3369450569152832  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.35980224609375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 700, 100])
m.shape torch.Size([740, 7, 100])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.36147117614746094  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.36147117614746094  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 740, 100]), torch.Size([1, 740, 100])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.36202335357666016  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.3910536766052246  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 740, 100])
m.shape torch.Size([733, 8, 100])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.3929624557495117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.3929624557495117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 733, 100]), torch.Size([1, 733, 100])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.3935089111328125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.42560529708862305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 733, 100])
m.shape torch.Size([765, 9, 100])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.42789697647094727  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.42789697647094727  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 765, 100]), torch.Size([1, 765, 100])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.4284672737121582  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.4653964042663574  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 765, 100])
m.shape torch.Size([52400, 10, 100])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.6603164672851562  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.6603164672851562  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 52400, 100]), torch.Size([1, 52400, 100])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 0.6993789672851562  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.472257614135742  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 52400, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.2668099403381348  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.3215956687927246  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.3763813972473145  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.3215956687927246  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([57447, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.3763813972473145  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.3900961875915527  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.3900961875915527  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.53690767288208  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.53690767288208  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5369210243225098  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5370278358459473  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 2, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.537036895751953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.537036895751953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5370521545410156  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.537281036376953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([13, 3, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.53731107711792  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.53731107711792  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5373358726501465  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.537881374359131  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([8, 4, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.537899971008301  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.537899971008301  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5379152297973633  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.538357734680176  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([12, 5, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.538407802581787  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.538407802581787  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.538430690765381  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.539254665374756  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 6, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.539318561553955  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.539318561553955  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5393433570861816  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.540409564971924  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([17, 7, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5405116081237793  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5405116081237793  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.540544033050537  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5421652793884277  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([14, 8, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5422568321228027  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5422568321228027  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.542283535003662  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5438055992126465  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([27, 9, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5440258979797363  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5440258979797363  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5440773963928223  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5473732948303223  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([26, 10, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.547597885131836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.547597885131836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.547647476196289  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.551168441772461  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([25, 11, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.551408290863037  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.551408290863037  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5514559745788574  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.555175304412842  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([19, 12, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.555370807647705  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.555370807647705  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5554070472717285  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5584874153137207  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5589070320129395  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5589070320129395  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.558973789215088  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.565115451812744  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([31, 14, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5654993057250977  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5654993057250977  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.565558433532715  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5714120864868164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([23, 15, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.571714401245117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.571714401245117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.571758270263672  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5764083862304688  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 16, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.576786518096924  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.576786518096924  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.576836109161377  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.58243989944458  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([23, 17, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.582791328430176  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.582791328430176  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5828351974487305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.588099479675293  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 18, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5883893966674805  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5883893966674805  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.588423728942871  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5927839279174805  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([27, 19, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5932602882385254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5932602882385254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.5933117866516113  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.600212574005127  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.6006293296813965  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.6006293296813965  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.600673198699951  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.606858730316162  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([18, 21, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.6072001457214355  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.6072001457214355  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.607234477996826  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.6123156547546387  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([20, 22, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.6127214431762695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.6127214431762695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.612759590148926  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.6186723709106445  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([30, 23, 256])
----------------------------------------1
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.619316577911377  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.619316577911377  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 7.9725341796875 GB
    Memory Allocated: 3.6193737983703613  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9783935546875 GB
    Memory Allocated: 3.62864351272583  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 24, 256])
----------------------------------------1
 Nvidia-smi: 7.9783935546875 GB
    Memory Allocated: 3.629122734069824  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9783935546875 GB
    Memory Allocated: 3.629122734069824  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 7.9783935546875 GB
    Memory Allocated: 3.629164695739746  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9862060546875 GB
    Memory Allocated: 3.636256217956543  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([5825, 25, 256])
----------------------------------------1
 Nvidia-smi: 7.9881591796875 GB
    Memory Allocated: 3.7771506309509277  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 7.9881591796875 GB
    Memory Allocated: 3.7771506309509277  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5825, 256]), torch.Size([1, 5825, 256])
----------------------------------------3
 Nvidia-smi: 7.9881591796875 GB
    Memory Allocated: 3.788358211517334  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 7.9881591796875 GB
    Memory Allocated: 5.743772029876709  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5825, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 7.9881591796875 GB
    Memory Allocated: 5.598685264587402  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 7.9881591796875 GB
    Memory Allocated: 5.599902153015137  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 7.9881591796875 GB
    Memory Allocated: 5.601119041442871  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 7.9881591796875 GB
    Memory Allocated: 5.599854946136475  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([6310, 47])
input nodes number: 57447
output nodes number: 6310
edges number: 152468
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 7.9881591796875 GB
    Memory Allocated: 5.600124359130859  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 7.9881591796875 GB
    Memory Allocated: 5.600124835968018  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.08495235443115234  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

pseudo mini batch 2 input nodes size: 235810
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.0706491470336914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.0706491470336914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.1585397720336914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.1585845947265625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.09424018859863281  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.09959983825683594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.09959983825683594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

first layer input nodes number: 235810
first layer output nodes number: 58773
edges number: 573203
----------------------------------------before model layer 0
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.10179519653320312  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([235810, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.10179519653320312  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([115, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.32161617279052734  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.32161617279052734  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 115, 100]), torch.Size([1, 115, 100])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.3217020034790039  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.3223886489868164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 115, 100])
m.shape torch.Size([189, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.32248687744140625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.32248687744140625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 189, 100]), torch.Size([1, 189, 100])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.3226280212402344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.32474231719970703  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 189, 100])
m.shape torch.Size([283, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.32498836517333984  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.32498836517333984  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 283, 100]), torch.Size([1, 283, 100])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.32520008087158203  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.32984495162963867  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 283, 100])
m.shape torch.Size([369, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.330289363861084  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.330289363861084  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 369, 100]), torch.Size([1, 369, 100])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.3305649757385254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.3385462760925293  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 369, 100])
m.shape torch.Size([474, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.3392915725708008  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.3392915725708008  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 474, 100]), torch.Size([1, 474, 100])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.3396453857421875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.3523683547973633  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 474, 100])
m.shape torch.Size([502, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.3533139228820801  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.3533139228820801  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 502, 100]), torch.Size([1, 502, 100])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.35368871688842773  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.369779109954834  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 502, 100])
m.shape torch.Size([587, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.3711228370666504  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.3711228370666504  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 587, 100]), torch.Size([1, 587, 100])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.37156057357788086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.39343738555908203  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 587, 100])
m.shape torch.Size([551, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.39486074447631836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.39486074447631836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 551, 100]), torch.Size([1, 551, 100])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.39527177810668945  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.41867780685424805  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 551, 100])
m.shape torch.Size([544, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.42029619216918945  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.42029619216918945  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 544, 100]), torch.Size([1, 544, 100])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.4207015037536621  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.4466414451599121  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 544, 100])
m.shape torch.Size([55159, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.6519222259521484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.6519222259521484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 55159, 100]), torch.Size([1, 55159, 100])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 0.693549633026123  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6114144325256348  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 55159, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.3981237411499023  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.454174041748047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.5102243423461914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.454174041748047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([58773, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.5102243423461914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.5242371559143066  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.5242371559143066  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6647863388061523  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6647863388061523  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6647958755493164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.664872169494629  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.664879322052002  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.664879322052002  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.664890766143799  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.665062427520752  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6650800704956055  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6650800704956055  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.665095329284668  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.665431022644043  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([12, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6654696464538574  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6654696464538574  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.665492534637451  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.66615629196167  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.666212558746338  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.666212558746338  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6662392616271973  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6672005653381348  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6672682762145996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6672682762145996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.667294979095459  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.668443202972412  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([18, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.668550968170166  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.668550968170166  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6685853004455566  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.670301914215088  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([7, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6703386306762695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6703386306762695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.670351982116699  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6711130142211914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.671184539794922  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.671184539794922  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.671201705932617  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.672300338745117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6723594665527344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6723594665527344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.672372817993164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.673320770263672  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([29, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6736207008361816  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6736207008361816  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.673676013946533  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.677990436553955  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([19, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6781821250915527  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6781821250915527  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.678218364715576  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6812987327575684  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([10, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.681406021118164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.681406021118164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.681425094604492  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6831798553466797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([17, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.683399200439453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.683399200439453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.683431625366211  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6866416931152344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([23, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.686957359313965  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.686957359313965  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6870012283325195  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6916513442993164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([13, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6918296813964844  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6918296813964844  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.691854476928711  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6946563720703125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6948728561401367  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6948728561401367  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.694899559020996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.698103904724121  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6983847618103027  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6983847618103027  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.6984171867370605  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.7025351524353027  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.702939033508301  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.702939033508301  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.7029829025268555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.7088613510131836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.70920467376709  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.70920467376709  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 8.1365966796875 GB
    Memory Allocated: 3.7092409133911133  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1385498046875 GB
    Memory Allocated: 3.714350700378418  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([23, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.1385498046875 GB
    Memory Allocated: 3.714797019958496  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1385498046875 GB
    Memory Allocated: 3.714797019958496  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 8.1385498046875 GB
    Memory Allocated: 3.714840888977051  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1444091796875 GB
    Memory Allocated: 3.7213335037231445  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.1444091796875 GB
    Memory Allocated: 3.7216711044311523  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1444091796875 GB
    Memory Allocated: 3.7216711044311523  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 8.1444091796875 GB
    Memory Allocated: 3.72170352935791  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1502685546875 GB
    Memory Allocated: 3.726729393005371  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([16, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.1502685546875 GB
    Memory Allocated: 3.727066993713379  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1502685546875 GB
    Memory Allocated: 3.727066993713379  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 8.1502685546875 GB
    Memory Allocated: 3.727097511291504  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1561279296875 GB
    Memory Allocated: 3.732041358947754  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([15, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.1561279296875 GB
    Memory Allocated: 3.732372283935547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1561279296875 GB
    Memory Allocated: 3.732372283935547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 8.1561279296875 GB
    Memory Allocated: 3.732400894165039  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1600341796875 GB
    Memory Allocated: 3.7372360229492188  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([5639, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.1639404296875 GB
    Memory Allocated: 3.873208522796631  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1639404296875 GB
    Memory Allocated: 3.873208522796631  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5639, 256]), torch.Size([1, 5639, 256])
----------------------------------------3
 Nvidia-smi: 8.1639404296875 GB
    Memory Allocated: 3.8841047286987305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1639404296875 GB
    Memory Allocated: 5.7770795822143555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5639, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.1639404296875 GB
    Memory Allocated: 5.6380743980407715  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.1639404296875 GB
    Memory Allocated: 5.639358997344971  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.1639404296875 GB
    Memory Allocated: 5.640975475311279  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1639404296875 GB
    Memory Allocated: 5.639646053314209  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([5994, 47])
input nodes number: 58773
output nodes number: 5994
edges number: 145965
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1639404296875 GB
    Memory Allocated: 5.640196800231934  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1639404296875 GB
    Memory Allocated: 5.640197277069092  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.10946846008300781  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

pseudo mini batch 3 input nodes size: 175107
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.09430789947509766  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.09430789947509766  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.15954065322875977  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.15958786010742188  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.07165241241455078  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.07695198059082031  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.07695198059082031  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

first layer input nodes number: 175107
first layer output nodes number: 57185
edges number: 557372
----------------------------------------before model layer 0
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.07868337631225586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([175107, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.07868337631225586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([107, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.2922248840332031  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.2922248840332031  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 107, 100]), torch.Size([1, 107, 100])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.29230499267578125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.29294443130493164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 107, 100])
m.shape torch.Size([198, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.29305219650268555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.29305219650268555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 198, 100]), torch.Size([1, 198, 100])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.2932000160217285  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.29541444778442383  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 198, 100])
m.shape torch.Size([293, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.2956681251525879  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.2956681251525879  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 293, 100]), torch.Size([1, 293, 100])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.2958865165710449  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.3006911277770996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 293, 100])
m.shape torch.Size([366, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.30112743377685547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.30112743377685547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 366, 100]), torch.Size([1, 366, 100])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.30140018463134766  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.3093099594116211  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 366, 100])
m.shape torch.Size([480, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.31006765365600586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.31006765365600586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 480, 100]), torch.Size([1, 480, 100])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.3104252815246582  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.3232998847961426  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 480, 100])
m.shape torch.Size([509, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.3247346878051758  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.3247346878051758  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 509, 100]), torch.Size([1, 509, 100])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.32511425018310547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.3414268493652344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 509, 100])
m.shape torch.Size([551, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.34267425537109375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.34267425537109375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 551, 100]), torch.Size([1, 551, 100])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.34308528900146484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.363616943359375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 551, 100])
m.shape torch.Size([527, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.36498212814331055  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.36498212814331055  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 527, 100]), torch.Size([1, 527, 100])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.3653750419616699  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.3877596855163574  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 527, 100])
m.shape torch.Size([541, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.3893771171569824  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.3893771171569824  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 541, 100]), torch.Size([1, 541, 100])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.38978052139282227  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.4155855178833008  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 541, 100])
m.shape torch.Size([53613, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.6151080131530762  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.6151080131530762  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 53613, 100]), torch.Size([1, 53613, 100])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 0.6550536155700684  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.4911484718322754  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 53613, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.283768653869629  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.3383045196533203  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.3928403854370117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.3383045196533203  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([57185, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.3928403854370117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.4064745903015137  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.4064745903015137  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([2, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5546083450317383  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5546083450317383  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.554612159729004  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.554642677307129  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5546507835388184  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5546507835388184  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5546603202819824  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5548033714294434  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5548248291015625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5548248291015625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.554841995239258  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5552196502685547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([15, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5552687644958496  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5552687644958496  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.555297374725342  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5561270713806152  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([17, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.55619478225708  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.55619478225708  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.556227207183838  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.557394504547119  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([16, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5574707984924316  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5574707984924316  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5575013160705566  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5588135719299316  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([19, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.558926582336426  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.558926582336426  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.558962821960449  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.560774803161621  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([18, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5608954429626465  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5608954429626465  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.560929775238037  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5628867149353027  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5630083084106445  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5630083084106445  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5630388259887695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5649919509887695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([14, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5651116371154785  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5651116371154785  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.565138339996338  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5670342445373535  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([17, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5672006607055664  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5672006607055664  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.567233085632324  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5697622299194336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([15, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5699191093444824  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5699191093444824  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5699477195739746  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5723795890808105  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([21, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5726280212402344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5726280212402344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5726680755615234  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.576353073120117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([17, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.57656192779541  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.57656192779541  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.576594352722168  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5798044204711914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([22, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.580105781555176  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.580105781555176  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5801477432250977  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5845956802368164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5848517417907715  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5848517417907715  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.584886074066162  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5887656211853027  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.589010238647461  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.589010238647461  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.589040756225586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.592702865600586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([17, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5929818153381348  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5929818153381348  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5930142402648926  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5971322059631348  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.597445011138916  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.597445011138916  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.5974793434143066  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.6020798683166504  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([18, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.6024088859558105  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.6024088859558105  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.602443218231201  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.6072840690612793  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.6075901985168457  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.6075901985168457  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.6076207160949707  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.6121373176574707  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([24, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.6126298904418945  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.6126298904418945  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.612675666809082  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.6197710037231445  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.6201906204223633  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.6201906204223633  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.6202287673950195  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.626408576965332  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.626804828643799  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.626804828643799  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.6268391609191895  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1658935546875 GB
    Memory Allocated: 3.632641315460205  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([5939, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.1678466796875 GB
    Memory Allocated: 3.775327205657959  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.1678466796875 GB
    Memory Allocated: 3.775327205657959  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5939, 256]), torch.Size([1, 5939, 256])
----------------------------------------3
 Nvidia-smi: 8.1678466796875 GB
    Memory Allocated: 3.7868881225585938  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.1678466796875 GB
    Memory Allocated: 5.8495612144470215  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5939, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.1678466796875 GB
    Memory Allocated: 5.702485084533691  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.1678466796875 GB
    Memory Allocated: 5.7035932540893555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.1678466796875 GB
    Memory Allocated: 5.704822063446045  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.1678466796875 GB
    Memory Allocated: 5.703666687011719  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([6327, 47])
input nodes number: 57185
output nodes number: 6327
edges number: 153848
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.1678466796875 GB
    Memory Allocated: 5.703963756561279  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.1678466796875 GB
    Memory Allocated: 5.7039642333984375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08587646484375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

pseudo mini batch 4 input nodes size: 169552
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07147598266601562  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07147598266601562  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13463926315307617  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.13468456268310547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06940460205078125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07423114776611328  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07423114776611328  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

first layer input nodes number: 169552
first layer output nodes number: 52383
edges number: 501728
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07588529586791992  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([169552, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.07588529586791992  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([193, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.2681741714477539  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.2681741714477539  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 193, 100]), torch.Size([1, 193, 100])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.26831817626953125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.26947021484375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 193, 100])
m.shape torch.Size([333, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.26964664459228516  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.26964664459228516  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 333, 100]), torch.Size([1, 333, 100])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.2698955535888672  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.27362060546875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 333, 100])
m.shape torch.Size([451, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.2740006446838379  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.2740006446838379  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 451, 100]), torch.Size([1, 451, 100])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.2743372917175293  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.2817349433898926  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 451, 100])
m.shape torch.Size([577, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.2824268341064453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.2824268341064453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 577, 100]), torch.Size([1, 577, 100])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.28285694122314453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.2953300476074219  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 577, 100])
m.shape torch.Size([672, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.29636669158935547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.29636669158935547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 672, 100]), torch.Size([1, 672, 100])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.29686737060546875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.3156461715698242  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 672, 100])
m.shape torch.Size([750, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.31707239151000977  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.31707239151000977  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 750, 100]), torch.Size([1, 750, 100])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.31763124465942383  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.34221506118774414  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 750, 100])
m.shape torch.Size([759, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.3439149856567383  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.3439149856567383  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 759, 100]), torch.Size([1, 759, 100])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.3444805145263672  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.37343645095825195  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 759, 100])
m.shape torch.Size([855, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.375701904296875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.375701904296875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 855, 100]), torch.Size([1, 855, 100])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.3763389587402344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.4130706787109375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 855, 100])
m.shape torch.Size([735, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.41521644592285156  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.41521644592285156  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 735, 100]), torch.Size([1, 735, 100])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.41576480865478516  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.45203495025634766  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 735, 100])
m.shape torch.Size([47058, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.6270656585693359  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.6270656585693359  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 47058, 100]), torch.Size([1, 47058, 100])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.6621274948120117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.151474952697754  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 47058, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 2.965564727783203  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.0155210494995117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.0654773712158203  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.0155210494995117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([52383, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.0654773712158203  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.0779666900634766  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.0779666900634766  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([4, 1, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.218538284301758  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.218538284301758  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.218545913696289  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.218606948852539  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.218620777130127  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.218620777130127  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2186379432678223  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.218895435333252  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2189159393310547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2189159393310547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.218935012817383  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2193546295166016  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2193875312805176  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2193875312805176  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2194085121154785  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2200169563293457  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([21, 5, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2201075553894043  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2201075553894043  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2201476097106934  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2215895652770996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([18, 6, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2216734886169434  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2216734886169434  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.221707820892334  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.223184108734131  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([22, 7, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2233152389526367  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2233152389526367  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2233572006225586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2254552841186523  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 8, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.225588321685791  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.225588321685791  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2256264686584473  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2278008460998535  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([20, 9, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.227954864501953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.227954864501953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2279930114746094  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2304344177246094  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([25, 10, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2306556701660156  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2306556701660156  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.230703353881836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.234088897705078  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 11, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2342448234558105  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2342448234558105  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2342772483825684  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2368063926696777  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([17, 12, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2369866371154785  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2369866371154785  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2370190620422363  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2397751808166504  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.240196704864502  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.240196704864502  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2402634620666504  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2464051246643066  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([37, 14, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2468700408935547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2468700408935547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2469406127929688  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.253927230834961  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([25, 15, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2542524337768555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2542524337768555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.254300117492676  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.259354591369629  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2597923278808594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2597923278808594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2598495483398438  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.266315460205078  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([32, 17, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2668099403381348  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2668099403381348  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2668709754943848  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2741951942443848  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([24, 18, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2745800018310547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2745800018310547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.274625778198242  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2804393768310547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.280818462371826  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.280818462371826  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.280860424041748  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2864832878112793  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([26, 20, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2869625091552734  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2869625091552734  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.2870121002197266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.294004440307617  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.294625759124756  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.294625759124756  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.294686794281006  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.303719997406006  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([12, 22, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.303943634033203  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.303943634033203  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.303966522216797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.307514190673828  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.308077812194824  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.308077812194824  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.3081274032592773  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.3161611557006836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([30, 24, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.316828727722168  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.316828727722168  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.3168859481811523  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.3265562057495117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([5542, 25, 256])
----------------------------------------1
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.459960460662842  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.459960460662842  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5542, 256]), torch.Size([1, 5542, 256])
----------------------------------------3
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 3.470550060272217  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 5.343235015869141  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5542, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 5.204370021820068  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 5.2056193351745605  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 5.207619667053223  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 5.206325054168701  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([6067, 47])
input nodes number: 52383
output nodes number: 6067
edges number: 145990
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 5.206902027130127  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 5.206902503967285  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.08279085159301758  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

pseudo mini batch 5 input nodes size: 241998
----------------------------------------before load block subtensor 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06954574584960938  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.06954574584960938  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.1596970558166504  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.15974187850952148  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.09653329849243164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10239553451538086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10239553451538086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

first layer input nodes number: 241998
first layer output nodes number: 65562
edges number: 640576
----------------------------------------before model layer 0
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10522127151489258  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([241998, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 8.3182373046875 GB
    Memory Allocated: 0.10522127151489258  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([129, 1, 100])
----------------------------------------1
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.351076602935791  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.351076602935791  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 129, 100]), torch.Size([1, 129, 100])
----------------------------------------3
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.35117292404174805  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.3519434928894043  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 129, 100])
m.shape torch.Size([202, 2, 100])
----------------------------------------1
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.35204601287841797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.35204601287841797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 202, 100]), torch.Size([1, 202, 100])
----------------------------------------3
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.35219669342041016  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.35445690155029297  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 202, 100])
m.shape torch.Size([334, 3, 100])
----------------------------------------1
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.3547549247741699  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.3547549247741699  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 334, 100]), torch.Size([1, 334, 100])
----------------------------------------3
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.35500383377075195  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.36047983169555664  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 334, 100])
m.shape torch.Size([379, 4, 100])
----------------------------------------1
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.36092042922973633  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.36092042922973633  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 379, 100]), torch.Size([1, 379, 100])
----------------------------------------3
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.361203670501709  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.3694005012512207  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 379, 100])
m.shape torch.Size([457, 5, 100])
----------------------------------------1
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.37011051177978516  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.37011051177978516  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 457, 100]), torch.Size([1, 457, 100])
----------------------------------------3
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.3704519271850586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.3827214241027832  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 457, 100])
m.shape torch.Size([506, 6, 100])
----------------------------------------1
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.3841519355773926  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.3841519355773926  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 506, 100]), torch.Size([1, 506, 100])
----------------------------------------3
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.38452959060668945  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.40075159072875977  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 506, 100])
m.shape torch.Size([558, 7, 100])
----------------------------------------1
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.4022083282470703  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.4022083282470703  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 558, 100]), torch.Size([1, 558, 100])
----------------------------------------3
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.40262413024902344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.4234142303466797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 558, 100])
m.shape torch.Size([550, 8, 100])
----------------------------------------1
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.42484569549560547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.42484569549560547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 550, 100]), torch.Size([1, 550, 100])
----------------------------------------3
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.42525577545166016  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.44861888885498047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 550, 100])
m.shape torch.Size([572, 9, 100])
----------------------------------------1
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.4503316879272461  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.4503316879272461  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 572, 100]), torch.Size([1, 572, 100])
----------------------------------------3
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.4507579803466797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.4780406951904297  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 572, 100])
m.shape torch.Size([61875, 10, 100])
----------------------------------------1
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.7083301544189453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.7083301544189453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 61875, 100]), torch.Size([1, 61875, 100])
----------------------------------------3
 Nvidia-smi: 8.5584716796875 GB
    Memory Allocated: 0.7552051544189453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.036867141723633  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 61875, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 3.7976036071777344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 3.860128402709961  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 3.9226531982421875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 3.860128402709961  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([65562, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 3.9226531982421875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 3.938284397125244  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 3.938284397125244  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.078951835632324  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.078951835632324  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.078957557678223  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.07900333404541  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.079002857208252  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.079002857208252  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.079004764556885  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.079033374786377  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([13, 3, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.079070091247559  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.079070091247559  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.079094886779785  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.0796403884887695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 4, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.079681873321533  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.079681873321533  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.079708576202393  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.0804829597473145  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 5, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.080532550811768  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.080532550811768  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.080557346343994  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.08144998550415  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([10, 6, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.08149528503418  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.08149528503418  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.081514358520508  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.082334518432617  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 7, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.082385540008545  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.082385540008545  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.08240270614624  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.083261013031006  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([13, 8, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.083352565765381  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.083352565765381  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.083377361297607  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.0847907066345215  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([6, 9, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.084830284118652  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.084830284118652  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.084841728210449  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.085574150085449  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([19, 10, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.085751056671143  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.085751056671143  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.085787296295166  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.08836030960083  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([9, 11, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.088437557220459  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.088437557220459  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.088454723358154  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.089793682098389  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([15, 12, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.089958190917969  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.089958190917969  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.089986801147461  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.092418670654297  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([11, 13, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.0925421714782715  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.0925421714782715  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.092563152313232  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.094493389129639  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 14, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.094711780548096  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.094711780548096  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.0947442054748535  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.097954273223877  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([12, 15, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.098111152648926  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.098111152648926  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.0981340408325195  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.100560188293457  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([13, 16, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.1007490158081055  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.1007490158081055  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.100773811340332  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.103575706481934  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([17, 17, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.103841304779053  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.103841304779053  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.1038737297058105  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.107764720916748  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 18, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.107921600341797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.107921600341797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.107940673828125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.110363006591797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.110664367675781  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.110664367675781  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.110696792602539  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.115041732788086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([10, 20, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.115218162536621  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.115218162536621  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.115237236022949  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.117926597595215  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([16, 21, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.1182403564453125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.1182403564453125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.1182708740234375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.1227874755859375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([32, 22, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.123448848724365  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.123448848724365  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.123509883880615  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.132970333099365  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.133382320404053  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.133382320404053  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.133420467376709  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.1396002769470215  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([11, 24, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.139835357666016  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.139835357666016  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.139856338500977  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.143402099609375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([5666, 25, 256])
----------------------------------------1
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.280028343200684  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.280028343200684  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5666, 256]), torch.Size([1, 5666, 256])
----------------------------------------3
 Nvidia-smi: 10.7596435546875 GB
    Memory Allocated: 4.2914204597473145  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 10.8963623046875 GB
    Memory Allocated: 6.193891525268555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5666, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 10.8963623046875 GB
    Memory Allocated: 6.054725170135498  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 10.8963623046875 GB
    Memory Allocated: 6.056273937225342  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 10.8963623046875 GB
    Memory Allocated: 6.0578227043151855  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 10.8963623046875 GB
    Memory Allocated: 6.056229114532471  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([5977, 47])
input nodes number: 65562
output nodes number: 5977
edges number: 146090
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.8963623046875 GB
    Memory Allocated: 6.057062149047852  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.8963623046875 GB
    Memory Allocated: 6.05706262588501  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.11395645141601562  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

pseudo mini batch 6 input nodes size: 140352
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.0968327522277832  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.0968327522277832  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.14911794662475586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.14916276931762695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.058966636657714844  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.06339263916015625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.06339263916015625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

first layer input nodes number: 140352
first layer output nodes number: 46566
edges number: 449542
----------------------------------------before model layer 0
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.06478548049926758  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([140352, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.06478548049926758  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([175, 1, 100])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.23712491989135742  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.23712491989135742  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 175, 100]), torch.Size([1, 175, 100])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.23725557327270508  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.23829936981201172  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 175, 100])
m.shape torch.Size([241, 2, 100])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.23841381072998047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.23841381072998047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 241, 100]), torch.Size([1, 241, 100])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.23859405517578125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.24129199981689453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 241, 100])
m.shape torch.Size([340, 3, 100])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.24158191680908203  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.24158191680908203  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 340, 100]), torch.Size([1, 340, 100])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.2418355941772461  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.24741220474243164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 340, 100])
m.shape torch.Size([394, 4, 100])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.24787282943725586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.24787282943725586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 394, 100]), torch.Size([1, 394, 100])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.24816656112670898  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.2566847801208496  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 394, 100])
m.shape torch.Size([499, 5, 100])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.25746774673461914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.25746774673461914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 499, 100]), torch.Size([1, 499, 100])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.2578396797180176  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.27122926712036133  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 499, 100])
m.shape torch.Size([538, 6, 100])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.2722458839416504  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.2722458839416504  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 538, 100]), torch.Size([1, 538, 100])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.2726473808288574  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.28989458084106445  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 538, 100])
m.shape torch.Size([526, 7, 100])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.29106569290161133  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.29106569290161133  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 526, 100]), torch.Size([1, 526, 100])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.2914576530456543  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.31105566024780273  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 526, 100])
m.shape torch.Size([554, 8, 100])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.31251096725463867  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.31251096725463867  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 554, 100]), torch.Size([1, 554, 100])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.3129239082336426  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.33646154403686523  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 554, 100])
m.shape torch.Size([538, 9, 100])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.3380589485168457  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.3380589485168457  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 538, 100]), torch.Size([1, 538, 100])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.33846044540405273  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.36413049697875977  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 538, 100])
m.shape torch.Size([42761, 10, 100])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.5232272148132324  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.5232272148132324  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 42761, 100]), torch.Size([1, 42761, 100])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 0.5550875663757324  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.817129611968994  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 42761, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.6502017974853516  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.694610595703125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.7390193939208984  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.694610595703125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([46566, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.7390193939208984  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.750121593475342  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.750121593475342  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([8, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.8890814781188965  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.8890814781188965  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.889096736907959  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.889218807220459  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.889230728149414  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.889230728149414  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.889249801635742  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.889535903930664  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.8895583152770996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.8895583152770996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.8895792961120605  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.890040874481201  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([18, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.8901000022888184  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.8901000022888184  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.890134334564209  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.891129970550537  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([24, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.891228199005127  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.891228199005127  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.8912739753723145  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.8929219245910645  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([23, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.8930320739746094  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.8930320739746094  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.893075942993164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.8949623107910156  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.895054817199707  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.895054817199707  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.895087242126465  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.8967084884643555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.896846294403076  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.896846294403076  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.8968844413757324  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.8990588188171387  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([10, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.8991265296936035  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.8991265296936035  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.8991456031799316  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9003663063049316  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([24, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.900587558746338  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.900587558746338  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9006333351135254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.903883457183838  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.904125213623047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.904125213623047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.904172897338867  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9078922271728516  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([28, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.908191680908203  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.908191680908203  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.908245086669922  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9127845764160156  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([25, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9130706787109375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9130706787109375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.913118362426758  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9175052642822266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([18, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9177236557006836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9177236557006836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.917757987976074  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.921156883239746  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.921384811401367  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.921384811401367  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.921417236328125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.924854278564453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9251456260681152  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9251456260681152  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9251837730407715  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9294943809509277  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.929786205291748  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.929786205291748  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9298224449157715  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.934171199798584  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9344992637634277  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9344992637634277  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.934537410736084  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9393820762634277  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([23, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9397830963134766  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9397830963134766  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9398269653320312  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9457054138183594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9461259841918945  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9461259841918945  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.946169853210449  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.95235538482666  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9528989791870117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9528989791870117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9529523849487305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9608564376831055  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([28, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9614219665527344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.9614219665527344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 11.0369873046875 GB
    Memory Allocated: 2.961475372314453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 2.9697532653808594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 2.97025728225708  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 2.97025728225708  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 11.0389404296875 GB
    Memory Allocated: 2.9703030586242676  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0467529296875 GB
    Memory Allocated: 2.9777188301086426  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([13, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0467529296875 GB
    Memory Allocated: 2.9779958724975586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0467529296875 GB
    Memory Allocated: 2.9779958724975586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 11.0467529296875 GB
    Memory Allocated: 2.978020668029785  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0506591796875 GB
    Memory Allocated: 2.982211112976074  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([5516, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0526123046875 GB
    Memory Allocated: 3.1147565841674805  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0526123046875 GB
    Memory Allocated: 3.1147565841674805  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5516, 256]), torch.Size([1, 5516, 256])
----------------------------------------3
 Nvidia-smi: 11.0526123046875 GB
    Memory Allocated: 3.126542091369629  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0526123046875 GB
    Memory Allocated: 4.978226661682129  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5516, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0526123046875 GB
    Memory Allocated: 4.840916633605957  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0526123046875 GB
    Memory Allocated: 4.841966152191162  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0526123046875 GB
    Memory Allocated: 4.843015670776367  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0526123046875 GB
    Memory Allocated: 4.841921329498291  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([5992, 47])
input nodes number: 46566
output nodes number: 5992
edges number: 144311
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0526123046875 GB
    Memory Allocated: 4.842110633850098  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0526123046875 GB
    Memory Allocated: 4.842111110687256  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.07090616226196289  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

pseudo mini batch 7 input nodes size: 175998
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.058763980865478516  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.058763980865478516  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.12432861328125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.1243734359741211  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.07204341888427734  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.07682037353515625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.07682037353515625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

first layer input nodes number: 175998
first layer output nodes number: 51840
edges number: 498323
----------------------------------------before model layer 0
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.07851791381835938  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([175998, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.07851791381835938  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([218, 1, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.26950550079345703  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.26950550079345703  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 218, 100]), torch.Size([1, 218, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2696685791015625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.27097034454345703  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 218, 100])
m.shape torch.Size([295, 2, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.27110862731933594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.27110862731933594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 295, 100]), torch.Size([1, 295, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2713289260864258  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.274627685546875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 295, 100])
m.shape torch.Size([432, 3, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.27500057220458984  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.27500057220458984  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 432, 100]), torch.Size([1, 432, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.27532291412353516  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2824058532714844  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 432, 100])
m.shape torch.Size([517, 4, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.28301525115966797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.28301525115966797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 517, 100]), torch.Size([1, 517, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2834005355834961  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2945737838745117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 517, 100])
m.shape torch.Size([579, 5, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2954597473144531  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2954597473144531  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 579, 100]), torch.Size([1, 579, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.29589176177978516  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3114299774169922  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 579, 100])
m.shape torch.Size([628, 6, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.31261777877807617  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.31261777877807617  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 628, 100]), torch.Size([1, 628, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.31308603286743164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.33321237564086914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 628, 100])
m.shape torch.Size([697, 7, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3347959518432617  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3347959518432617  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 697, 100]), torch.Size([1, 697, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3353157043457031  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.36155176162719727  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 697, 100])
m.shape torch.Size([723, 8, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3634467124938965  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3634467124938965  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 723, 100]), torch.Size([1, 723, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.363985538482666  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.39554548263549805  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 723, 100])
m.shape torch.Size([685, 9, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.39757299423217773  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.39757299423217773  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 685, 100]), torch.Size([1, 685, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3980841636657715  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.43137645721435547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 685, 100])
m.shape torch.Size([47066, 10, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.6064558029174805  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.6064558029174805  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 47066, 100]), torch.Size([1, 47066, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.6415233612060547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.131514072418213  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 47066, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.9466772079467773  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.9961156845092773  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.0455541610717773  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.9961156845092773  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([51840, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.0455541610717773  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.0579137802124023  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.0579137802124023  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([32, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.1959757804870605  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.1959757804870605  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.1960368156433105  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.1965250968933105  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([28, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.1965484619140625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.1965484619140625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.1966018676757812  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.1974029541015625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([14, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.1974167823791504  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.1974167823791504  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.1974434852600098  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.198030948638916  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([12, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.198063850402832  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.198063850402832  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.198086738586426  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.1987504959106445  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([20, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.1988353729248047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.1988353729248047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.198873519897461  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.200246810913086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([20, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.200343132019043  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.200343132019043  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.200381278991699  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.202021598815918  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([37, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.20225191116333  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.20225191116333  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.202322483062744  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2058510780334473  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([22, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2059850692749023  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2059850692749023  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.206027030944824  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.208418846130371  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2085537910461426  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2085537910461426  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.208588123321533  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.210785388946533  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([17, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2109317779541016  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2109317779541016  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2109642028808594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.213266372680664  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([18, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2134408950805664  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2134408950805664  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.213475227355957  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.216153144836426  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([21, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2163782119750977  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2163782119750977  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2164182662963867  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.219822883605957  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([20, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.220053195953369  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.220053195953369  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2200913429260254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2236008644104004  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([22, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2238779067993164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2238779067993164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2239198684692383  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.228074073791504  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([20, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.228341579437256  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.228341579437256  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.228379726409912  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2324233055114746  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([22, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2327427864074707  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2327427864074707  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2327847480773926  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2375264167785645  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([19, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.237816333770752  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.237816333770752  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2378525733947754  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.242201328277588  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([20, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2425293922424316  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2425293922424316  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.242567539215088  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2474122047424316  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([17, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.247704029083252  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.247704029083252  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2477364540100098  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2520813941955566  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([24, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2525267601013184  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2525267601013184  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.252572536468506  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2590270042419434  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([15, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2593069076538086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2593069076538086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.259335517883301  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2635698318481445  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([22, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2640209197998047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2640209197998047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2640628814697266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.270566940307617  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([24, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2710766792297363  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2710766792297363  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.271122455596924  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.278538227081299  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([26, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2791152000427246  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2791152000427246  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.2791647911071777  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.287545680999756  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([5456, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.418618679046631  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.418618679046631  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5456, 256]), torch.Size([1, 5456, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.429025173187256  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 5.281811237335205  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5456, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 5.145442008972168  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 5.1467204093933105  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 5.148717880249023  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 5.14739465713501  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([5966, 47])
input nodes number: 51840
output nodes number: 5966
edges number: 142696
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 5.1477580070495605  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 5.147758483886719  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.08513116836547852  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

pseudo mini batch 8 input nodes size: 210444
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.0719757080078125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.0719757080078125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.15037250518798828  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.15041732788085938  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.0848078727722168  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.0902562141418457  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.0902562141418457  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

first layer input nodes number: 210444
first layer output nodes number: 60895
edges number: 591554
----------------------------------------before model layer 0
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.09227848052978516  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([210444, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.09227848052978516  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([153, 1, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.318936824798584  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.318936824798584  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 153, 100]), torch.Size([1, 153, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.31905126571655273  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3199653625488281  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 153, 100])
m.shape torch.Size([255, 2, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3200984001159668  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3200984001159668  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 255, 100]), torch.Size([1, 255, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.32028913497924805  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.32314157485961914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 255, 100])
m.shape torch.Size([319, 3, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.32340288162231445  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.32340288162231445  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 319, 100]), torch.Size([1, 319, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.323641300201416  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3288736343383789  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 319, 100])
m.shape torch.Size([407, 4, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3293609619140625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3293609619140625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 407, 100]), torch.Size([1, 407, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3296642303466797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3384590148925781  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 407, 100])
m.shape torch.Size([556, 5, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.33962106704711914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.33962106704711914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 556, 100]), torch.Size([1, 556, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.34003591537475586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.35495615005493164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 556, 100])
m.shape torch.Size([581, 6, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3560948371887207  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3560948371887207  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 581, 100]), torch.Size([1, 581, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.35652780532836914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.37514543533325195  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 581, 100])
m.shape torch.Size([685, 7, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.37671566009521484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.37671566009521484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 685, 100]), torch.Size([1, 685, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3772268295288086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.403048038482666  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 685, 100])
m.shape torch.Size([715, 8, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.4049234390258789  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.4049234390258789  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 715, 100]), torch.Size([1, 715, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.40545654296875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.43618059158325195  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 715, 100])
m.shape torch.Size([715, 9, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.4383115768432617  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.4383115768432617  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 715, 100]), torch.Size([1, 715, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.4388446807861328  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.47338056564331055  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 715, 100])
m.shape torch.Size([56509, 10, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.683626651763916  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.683626651763916  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 56509, 100]), torch.Size([1, 56509, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.7257294654846191  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7158727645874023  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 56509, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.496638774871826  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.5547127723693848  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.6127867698669434  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.5547127723693848  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([60895, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.6127867698669434  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.627305507659912  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.627305507659912  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([22, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7617435455322266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7617435455322266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7617855072021484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7621212005615234  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([23, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7621445655822754  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7621445655822754  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.76218843460083  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7628464698791504  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([21, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.762885093688965  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.762885093688965  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.762925148010254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7638063430786133  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([29, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7638978958129883  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7638978958129883  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.76395320892334  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.765557289123535  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([28, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.765664577484131  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.765664577484131  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7657179832458496  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7676405906677246  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([46, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7678794860839844  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7678794860839844  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7679672241210938  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.771739959716797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([38, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7719521522521973  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7719521522521973  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.772024631500244  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.775648593902588  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([40, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7759199142456055  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7759199142456055  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.775996208190918  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7803449630737305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([35, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.780609607696533  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.780609607696533  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7806763648986816  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7849488258361816  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([35, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.785252094268799  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.785252094268799  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7853188514709473  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7900586128234863  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([34, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7903847694396973  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7903847694396973  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.790449619293213  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.7955079078674316  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([32, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.795844554901123  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.795844554901123  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.795905590057373  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.801093578338623  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([36, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.801513195037842  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.801513195037842  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.801581859588623  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.807898998260498  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([32, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.808295249938965  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.808295249938965  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.808356285095215  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.814398765563965  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([30, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8148012161254883  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8148012161254883  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8148584365844727  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8209238052368164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([41, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.821526050567627  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.821526050567627  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8216042518615723  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8304409980773926  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([35, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8309741020202637  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8309741020202637  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.831040859222412  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8390517234802246  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.839571952819824  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.839571952819824  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.839632987976074  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.847384452819824  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([35, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8479933738708496  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8479933738708496  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.848060131072998  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8570055961608887  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8573951721191406  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8573951721191406  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8574371337890625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.863353729248047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([28, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.863898277282715  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.863898277282715  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8639516830444336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8718557357788086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([31, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8724846839904785  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8724846839904785  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8725438117980957  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8817086219787598  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.882298469543457  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.882298469543457  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.882351875305176  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8910036087036133  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.89178466796875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.89178466796875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.8918514251708984  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.9031333923339844  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([5195, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 4.027926445007324  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 4.027926445007324  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5195, 256]), torch.Size([1, 5195, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 4.037835121154785  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 5.78176212310791  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5195, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 5.649230480194092  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 5.650761604309082  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 5.652103424072266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 5.650527477264404  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([5963, 47])
input nodes number: 60895
output nodes number: 5963
edges number: 139599
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 5.650792121887207  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 5.650792598724365  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.09950828552246094  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

pseudo mini batch 9 input nodes size: 135142
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.08457374572753906  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.08457374572753906  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.134918212890625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.1349654197692871  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.056523799896240234  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.060968875885009766  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.060968875885009766  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

first layer input nodes number: 135142
first layer output nodes number: 45258
edges number: 441350
----------------------------------------before model layer 0
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.06264829635620117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([135142, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.06264829635620117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([93, 1, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.23174333572387695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.23174333572387695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 93, 100]), torch.Size([1, 93, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2318129539489746  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.23236846923828125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 93, 100])
m.shape torch.Size([184, 2, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.23247098922729492  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.23247098922729492  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 184, 100]), torch.Size([1, 184, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.23260831832885742  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2346653938293457  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 184, 100])
m.shape torch.Size([210, 3, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2348318099975586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2348318099975586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 210, 100]), torch.Size([1, 210, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.23498916625976562  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.23843812942504883  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 210, 100])
m.shape torch.Size([317, 4, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2388319969177246  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2388319969177246  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 317, 100]), torch.Size([1, 317, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.23906850814819336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.24592161178588867  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 317, 100])
m.shape torch.Size([358, 5, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.24647045135498047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.24647045135498047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 358, 100]), torch.Size([1, 358, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.24673748016357422  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.25634336471557617  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 358, 100])
m.shape torch.Size([349, 6, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2569899559020996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2569899559020996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 349, 100]), torch.Size([1, 349, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2572503089904785  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.26843690872192383  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 349, 100])
m.shape torch.Size([369, 7, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2692689895629883  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2692689895629883  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 369, 100]), torch.Size([1, 369, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2695446014404297  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.28330516815185547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 369, 100])
m.shape torch.Size([425, 8, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2846088409423828  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2846088409423828  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 425, 100]), torch.Size([1, 425, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2849264144897461  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3029937744140625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 425, 100])
m.shape torch.Size([406, 9, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3041963577270508  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3041963577270508  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 406, 100]), torch.Size([1, 406, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.30449962615966797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3238701820373535  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 406, 100])
m.shape torch.Size([42547, 10, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.48221874237060547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.48221874237060547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 42547, 100]), torch.Size([1, 42547, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.5139188766479492  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7646284103393555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 42547, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.6003713607788086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.6435327529907227  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.6866941452026367  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.6435327529907227  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([45258, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.6866941452026367  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.6974844932556152  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.6974844932556152  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8473458290100098  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8473458290100098  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8473477363586426  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.847362995147705  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([7, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8473758697509766  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8473758697509766  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8473892211914062  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8475894927978516  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8476004600524902  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8476004600524902  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.847611904144287  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8478636741638184  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([24, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8479504585266113  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8479504585266113  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.847996234893799  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8493237495422363  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([4, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.849320411682129  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.849320411682129  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.84932804107666  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.849602699279785  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([10, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.849656581878662  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.849656581878662  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8496756553649902  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8504958152770996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8505401611328125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8505401611328125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.850555419921875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.851318359375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([13, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8514108657836914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8514108657836914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.851435661315918  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.852849006652832  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([9, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.852914810180664  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.852914810180664  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8529319763183594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8540306091308594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([4, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.854060649871826  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.854060649871826  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8540682792663574  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.854609966278076  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.854701519012451  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.854701519012451  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8547186851501465  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.856057643890381  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8561301231384277  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8561301231384277  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8561434745788574  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.857278347015381  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([9, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.857384204864502  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.857384204864502  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8574013710021973  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.858980655670166  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.85910701751709  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.85910701751709  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.859126091003418  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8610143661499023  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.86116361618042  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.86116361618042  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.861184597015381  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8634085655212402  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.863598346710205  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.863598346710205  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8636231422424316  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.866425037384033  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([10, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8665761947631836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8665761947631836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8665952682495117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8688840866088867  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([12, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.869082450866699  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.869082450866699  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.869105339050293  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.872012138366699  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8722567558288574  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8722567558288574  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.872283458709717  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.875861644744873  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([16, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8761558532714844  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8761558532714844  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8761863708496094  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8804893493652344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([8, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8806357383728027  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8806357383728027  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8806509971618652  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8829092979431152  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8830924034118652  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8830924034118652  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8831095695495605  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.885770320892334  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8859167098999023  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8859167098999023  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.885930061340332  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8880929946899414  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([18, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8885016441345215  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8885016441345215  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.888535976409912  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8943381309509277  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([6072, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.040219783782959  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.040219783782959  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 6072, 256]), torch.Size([1, 6072, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 3.0525879859924316  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 5.114813327789307  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 6072, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 4.966180801391602  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 4.967720985412598  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 4.9688262939453125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 4.967238903045654  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([6311, 47])
input nodes number: 45258
output nodes number: 6311
edges number: 155034
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 4.9681196212768555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 4.968120098114014  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.06949138641357422  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

pseudo mini batch 10 input nodes size: 112367
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.057019710540771484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.057019710540771484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.09887981414794922  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.09892463684082031  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.048532962799072266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.05276823043823242  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.05276823043823242  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

first layer input nodes number: 112367
first layer output nodes number: 44148
edges number: 427473
----------------------------------------before model layer 0
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.053934574127197266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([112367, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.053934574127197266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([79, 1, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.21818971633911133  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.21818971633911133  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 79, 100]), torch.Size([1, 79, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.21824884414672852  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2187204360961914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 79, 100])
m.shape torch.Size([175, 2, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.21882152557373047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.21882152557373047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 175, 100]), torch.Size([1, 175, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.21895217895507812  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.22090911865234375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 175, 100])
m.shape torch.Size([249, 3, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.22112226486206055  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.22112226486206055  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 249, 100]), torch.Size([1, 249, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.22130823135375977  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.22539520263671875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 249, 100])
m.shape torch.Size([318, 4, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.22577619552612305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.22577619552612305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 318, 100]), torch.Size([1, 318, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2260136604309082  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.23288869857788086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 318, 100])
m.shape torch.Size([473, 5, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.23365116119384766  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.23365116119384766  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 473, 100]), torch.Size([1, 473, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.23400402069091797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.24669981002807617  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 473, 100])
m.shape torch.Size([557, 6, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.24776840209960938  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.24776840209960938  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 557, 100]), torch.Size([1, 557, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2481842041015625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2660379409790039  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 557, 100])
m.shape torch.Size([582, 7, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2673478126525879  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2673478126525879  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 582, 100]), torch.Size([1, 582, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.26778173446655273  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.28946781158447266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 582, 100])
m.shape torch.Size([623, 8, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2911076545715332  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.2911076545715332  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 623, 100]), torch.Size([1, 623, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.29157209396362305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.31803369522094727  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 623, 100])
m.shape torch.Size([660, 9, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.32001447677612305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.32001447677612305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 660, 100]), torch.Size([1, 660, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.32050657272338867  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.3532094955444336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 660, 100])
m.shape torch.Size([40432, 10, 100])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.5035843849182129  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.5035843849182129  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 40432, 100]), torch.Size([1, 40432, 100])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 0.534243106842041  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.673696517944336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 40432, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.5150041580200195  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.5571069717407227  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.599209785461426  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.5571069717407227  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([44148, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.599209785461426  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.6097354888916016  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.6097354888916016  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7453904151916504  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7453904151916504  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7454018592834473  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7454934120178223  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([13, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7455129623413086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7455129623413086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.745537757873535  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7459096908569336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([21, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.745957851409912  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.745957851409912  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.745997905731201  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7468791007995605  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([19, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7469325065612793  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7469325065612793  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7469687461853027  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7480196952819824  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([30, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7481460571289062  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7481460571289062  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7482032775878906  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.750263214111328  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([31, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.750413417816162  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.750413417816162  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7504725456237793  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7530150413513184  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([28, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.753174304962158  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.753174304962158  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.753227710723877  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7558979988098145  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([37, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7561559677124023  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7561559677124023  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7562265396118164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.760249137878418  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([29, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.760465145111084  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.760465145111084  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7605204582214355  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7640604972839355  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([39, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7644081115722656  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7644081115722656  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7644824981689453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.769763946533203  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([30, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7700443267822266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7700443267822266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.770101547241211  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.774564743041992  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([23, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.774801731109619  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.774801731109619  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.774845600128174  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7785744667053223  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([42, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7790775299072266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7790775299072266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7791576385498047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.786527633666992  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([35, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.786958694458008  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.786958694458008  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7870254516601562  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7936344146728516  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([41, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.794192314147949  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.794192314147949  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.7942705154418945  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8025598526000977  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([30, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8029823303222656  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8029823303222656  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.80303955078125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8095054626464844  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8101634979248047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8101634979248047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.810243606567383  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.819856643676758  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([33, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.820387840270996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.820387840270996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.820450782775879  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.828444480895996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([37, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8290886878967285  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8290886878967285  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8291592597961426  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.838615894317627  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([19, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8389458656311035  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8389458656311035  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.838982105255127  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8440918922424316  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.844820976257324  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.844820976257324  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8448915481567383  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.8553361892700195  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([36, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.856062412261963  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.856062412261963  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 11.0545654296875 GB
    Memory Allocated: 2.856131076812744  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0604248046875 GB
    Memory Allocated: 2.866774082183838  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([28, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0604248046875 GB
    Memory Allocated: 2.867359161376953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0604248046875 GB
    Memory Allocated: 2.867359161376953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 11.0604248046875 GB
    Memory Allocated: 2.867412567138672  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0682373046875 GB
    Memory Allocated: 2.8760643005371094  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([35, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 2.876845359802246  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 2.876845359802246  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 11.0701904296875 GB
    Memory Allocated: 2.8769121170043945  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0819091796875 GB
    Memory Allocated: 2.8881940841674805  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([5242, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0819091796875 GB
    Memory Allocated: 3.0141162872314453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0819091796875 GB
    Memory Allocated: 3.0141162872314453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5242, 256]), torch.Size([1, 5242, 256])
----------------------------------------3
 Nvidia-smi: 11.0819091796875 GB
    Memory Allocated: 3.0241146087646484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0819091796875 GB
    Memory Allocated: 4.783819198608398  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5242, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0819091796875 GB
    Memory Allocated: 4.650020122528076  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0819091796875 GB
    Memory Allocated: 4.652011871337891  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0819091796875 GB
    Memory Allocated: 4.6530561447143555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0819091796875 GB
    Memory Allocated: 4.65101957321167  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([5963, 47])
input nodes number: 44148
output nodes number: 5963
edges number: 140881
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0838623046875 GB
    Memory Allocated: 4.651401042938232  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0838623046875 GB
    Memory Allocated: 4.651401519775391  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.0604248046875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

pseudo mini batch 11 input nodes size: 156694
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.048540592193603516  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.048540592193603516  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.10691404342651367  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.10695886611938477  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.06505393981933594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.0699148178100586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.0699148178100586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

first layer input nodes number: 156694
first layer output nodes number: 52419
edges number: 510660
----------------------------------------before model layer 0
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.07147359848022461  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([156694, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.07147359848022461  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([106, 1, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2671213150024414  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2671213150024414  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 106, 100]), torch.Size([1, 106, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2672004699707031  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2678337097167969  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 106, 100])
m.shape torch.Size([210, 2, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.26795101165771484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.26795101165771484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 210, 100]), torch.Size([1, 210, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2681083679199219  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2704601287841797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 210, 100])
m.shape torch.Size([242, 3, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.27065229415893555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.27065229415893555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 242, 100]), torch.Size([1, 242, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.27083349227905273  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2748069763183594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 242, 100])
m.shape torch.Size([359, 4, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2752513885498047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2752513885498047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 359, 100]), torch.Size([1, 359, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.27551937103271484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2832794189453125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 359, 100])
m.shape torch.Size([383, 5, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2838592529296875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2838592529296875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 383, 100]), torch.Size([1, 383, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2841453552246094  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.29442358016967773  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 383, 100])
m.shape torch.Size([498, 6, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2953939437866211  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2953939437866211  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 498, 100]), torch.Size([1, 498, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.29576587677001953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3117332458496094  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 498, 100])
m.shape torch.Size([502, 7, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.31285667419433594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.31285667419433594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 502, 100]), torch.Size([1, 502, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3132314682006836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3319411277770996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 502, 100])
m.shape torch.Size([539, 8, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3333601951599121  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3333601951599121  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 539, 100]), torch.Size([1, 539, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.33376264572143555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.35666799545288086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 539, 100])
m.shape torch.Size([557, 9, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3583345413208008  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3583345413208008  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 557, 100]), torch.Size([1, 557, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3587503433227539  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.38532304763793945  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 557, 100])
m.shape torch.Size([49023, 10, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.5677404403686523  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.5677404403686523  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 49023, 100]), torch.Size([1, 49023, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.6042661666870117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.208197593688965  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 49023, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.0172815322875977  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.067272186279297  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.117262840270996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.067272186279297  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([52419, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.117262840270996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.1297607421875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.1297607421875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([12, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.266201972961426  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.266201972961426  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2662248611450195  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2664079666137695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([19, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2664332389831543  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2664332389831543  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2664694786071777  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2670130729675293  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.267058849334717  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.267058849334717  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2671008110046387  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.26802396774292  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([37, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2681455612182617  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2681455612182617  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.268216133117676  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2702627182006836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([31, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.270376682281494  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.270376682281494  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2704358100891113  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.27256441116333  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([29, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.272702217102051  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.272702217102051  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2727575302124023  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2751359939575195  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([38, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.275364398956299  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.275364398956299  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2754368782043457  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2790608406066895  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([36, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.279301643371582  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.279301643371582  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2793703079223633  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2832841873168945  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([27, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2834835052490234  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2834835052490234  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2835350036621094  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2868309020996094  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([23, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2870264053344727  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2870264053344727  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2870702743530273  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.29018497467041  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([27, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2904486656188965  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2904486656188965  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2905001640319824  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2945170402526855  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([25, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2947797775268555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2947797775268555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.294827461242676  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2988805770874023  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([23, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2991442680358887  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2991442680358887  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2991881370544434  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3032240867614746  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([23, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3035120964050293  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3035120964050293  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.303555965423584  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.307898998260498  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([26, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3082523345947266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3082523345947266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3083019256591797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.313558578491211  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([21, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.313857078552246  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.313857078552246  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.313897132873535  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.318423271179199  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([28, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3188610076904297  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3188610076904297  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3189144134521484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3253231048583984  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([26, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.325746536254883  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.325746536254883  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.325796127319336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.332094192504883  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([29, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.33259916305542  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.33259916305542  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3326544761657715  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.340066432952881  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([25, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.340519428253174  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.340519428253174  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.340567111968994  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.347290515899658  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3477110862731934  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3477110862731934  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3477530479431152  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3539633750915527  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([18, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.354323387145996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.354323387145996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3543577194213867  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3596792221069336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([26, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3602371215820312  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3602371215820312  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3602867126464844  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3683204650878906  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([24, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.368849277496338  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.368849277496338  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.3688950538635254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.376631259918213  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([5364, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.5057644844055176  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.5057644844055176  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5364, 256]), torch.Size([1, 5364, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.5165486335754395  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.3172078132629395  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5364, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.182534694671631  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.183803081512451  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.185098171234131  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.1837849617004395  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([5981, 47])
input nodes number: 52419
output nodes number: 5981
edges number: 141691
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.183720588684082  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.18372106552124  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.07773923873901367  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

pseudo mini batch 12 input nodes size: 170471
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.06455373764038086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.06455373764038086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.12805938720703125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.12810420989990234  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.0696859359741211  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.07452201843261719  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.07452201843261719  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

first layer input nodes number: 170471
first layer output nodes number: 51535
edges number: 502701
----------------------------------------before model layer 0
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.0762014389038086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([170471, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.0762014389038086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([125, 1, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2696113586425781  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2696113586425781  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 125, 100]), torch.Size([1, 125, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.26970481872558594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.27045106887817383  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 125, 100])
m.shape torch.Size([136, 2, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2705059051513672  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2705059051513672  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 136, 100]), torch.Size([1, 136, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.27060794830322266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.27213001251220703  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 136, 100])
m.shape torch.Size([239, 3, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.27234649658203125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.27234649658203125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 239, 100]), torch.Size([1, 239, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2725248336791992  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2764439582824707  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 239, 100])
m.shape torch.Size([338, 4, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2768588066101074  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2768588066101074  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 338, 100]), torch.Size([1, 338, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2771115303039551  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2844233512878418  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 338, 100])
m.shape torch.Size([395, 5, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2850327491760254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2850327491760254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 395, 100]), torch.Size([1, 395, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.2853274345397949  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.295928955078125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 395, 100])
m.shape torch.Size([486, 6, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.29686832427978516  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.29686832427978516  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 486, 100]), torch.Size([1, 486, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.29723072052001953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.31280517578125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 486, 100])
m.shape torch.Size([484, 7, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3138861656188965  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3138861656188965  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 484, 100]), torch.Size([1, 484, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.31424760818481445  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3322896957397461  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 484, 100])
m.shape torch.Size([449, 8, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3334474563598633  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3334474563598633  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 449, 100]), torch.Size([1, 449, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3337821960449219  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3528623580932617  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 449, 100])
m.shape torch.Size([466, 9, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.35425758361816406  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.35425758361816406  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 466, 100]), torch.Size([1, 466, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.35460567474365234  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3768448829650879  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 466, 100])
m.shape torch.Size([48417, 10, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.5570383071899414  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.5570383071899414  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 48417, 100]), torch.Size([1, 48417, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.5931119918823242  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.154343605041504  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 48417, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 2.968048095703125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.017195701599121  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.066343307495117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.017195701599121  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([51535, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.066343307495117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.0786304473876953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.0786304473876953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([6, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.219452381134033  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.219452381134033  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.21946382522583  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.219555377960205  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2195539474487305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2195539474487305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.219557762145996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2196149826049805  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2196192741394043  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2196192741394043  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.21962308883667  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2197070121765137  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.219747543334961  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.219747543334961  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.219768524169922  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.220376968383789  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.220419406890869  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.220419406890869  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.22044038772583  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.221195697784424  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([9, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2212371826171875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2212371826171875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.221254348754883  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2219924926757812  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2220582962036133  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2220582962036133  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.222079277038574  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.223128318786621  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2231950759887695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2231950759887695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2232141494750977  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.224301338195801  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([17, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2244391441345215  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2244391441345215  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2244715690612793  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2265467643737793  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([13, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.226655960083008  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.226655960083008  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2266807556152344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2284412384033203  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2285666465759277  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2285666465759277  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2285914421081543  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.230525493621826  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([12, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.23065185546875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.23065185546875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2306747436523438  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2326202392578125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2327466011047363  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2327466011047363  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2327675819396973  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2346978187561035  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2348623275756836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2348623275756836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.23488712310791  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.23734188079834  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([19, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2376036643981934  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2376036643981934  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.237639904022217  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.241481304168701  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([12, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.241647720336914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.241647720336914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.241670608520508  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2442569732666016  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.244474411010742  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.244474411010742  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2445011138916016  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2477054595947266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([14, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.247934341430664  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.247934341430664  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2479610443115234  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.251352310180664  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.251521587371826  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.251521587371826  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2515406608581543  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.254096508026123  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2542219161987305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2542219161987305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.25423526763916  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.256117820739746  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.256333351135254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.256333351135254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.256354331970215  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2594594955444336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2596817016601562  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2596817016601562  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.259702682495117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2629547119140625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2632761001586914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2632761001586914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2633047103881836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.267939567565918  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2682485580444336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2682485580444336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.268275260925293  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.2727880477905273  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([5703, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.410646438598633  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.410646438598633  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5703, 256]), torch.Size([1, 5703, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.422072410583496  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.336818695068359  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5703, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.197460651397705  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.198955059051514  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.200449466705322  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.198910236358643  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([5971, 47])
input nodes number: 51535
output nodes number: 5971
edges number: 146247
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.199786186218262  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.19978666305542  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.0842123031616211  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

pseudo mini batch 13 input nodes size: 189605
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.07013273239135742  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.07013273239135742  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.14076614379882812  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.14081096649169922  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.07726049423217773  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.08289575576782227  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.08289575576782227  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

first layer input nodes number: 189605
first layer output nodes number: 61560
edges number: 609282
----------------------------------------before model layer 0
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.08476734161376953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([189605, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.08476734161376953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([84, 1, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.319061279296875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.319061279296875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 84, 100]), torch.Size([1, 84, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3191242218017578  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3196263313293457  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 84, 100])
m.shape torch.Size([104, 2, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3196725845336914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3196725845336914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 104, 100]), torch.Size([1, 104, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3197507858276367  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.32091522216796875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 104, 100])
m.shape torch.Size([122, 3, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3210124969482422  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3210124969482422  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 122, 100]), torch.Size([1, 122, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3211040496826172  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.32310962677001953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 122, 100])
m.shape torch.Size([158, 4, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3232994079589844  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3232994079589844  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 158, 100]), torch.Size([1, 158, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.32341766357421875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.32683563232421875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 158, 100])
m.shape torch.Size([176, 5, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3271045684814453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3271045684814453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 176, 100]), torch.Size([1, 176, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3272361755371094  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.33195972442626953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 176, 100])
m.shape torch.Size([203, 6, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3323478698730469  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3323478698730469  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 203, 100]), torch.Size([1, 203, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.33249950408935547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.33901119232177734  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 203, 100])
m.shape torch.Size([191, 7, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3394336700439453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3394336700439453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 191, 100]), torch.Size([1, 191, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.33957672119140625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.34669923782348633  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 191, 100])
m.shape torch.Size([210, 8, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.34725379943847656  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.34725379943847656  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 210, 100]), torch.Size([1, 210, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3474111557006836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.35634613037109375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 210, 100])
m.shape torch.Size([243, 9, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3570823669433594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3570823669433594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 243, 100]), torch.Size([1, 243, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.35726356506347656  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.36886024475097656  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 243, 100])
m.shape torch.Size([60069, 10, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.5925445556640625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.5925445556640625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 60069, 100]), torch.Size([1, 60069, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.6372995376586914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8149032592773438  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 60069, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.5883374214172363  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.647045612335205  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.705753803253174  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.647045612335205  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([61560, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.705753803253174  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.720430850982666  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.720430850982666  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([18, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8624234199523926  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8624234199523926  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 18, 256]), torch.Size([1, 18, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.862457752227783  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.862732410430908  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 18, 256])
m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8627328872680664  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8627328872680664  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8627500534057617  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8630075454711914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8630223274230957  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8630223274230957  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.863037586212158  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.863373279571533  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8634042739868164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8634042739868164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8634233474731445  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.86397647857666  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8639960289001465  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8639960289001465  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8640074729919434  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.864419460296631  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8644657135009766  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8644657135009766  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.864482879638672  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8652210235595703  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8652329444885254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8652329444885254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.865238666534424  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8655247688293457  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8655452728271484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8655452728271484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.865550994873047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.865877151489258  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([22, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.86606502532959  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.86606502532959  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8661069869995117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8687925338745117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([7, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8688392639160156  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8688392639160156  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8688526153564453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.869800567626953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8698577880859375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8698577880859375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8698692321777344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8707618713378906  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.870802402496338  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.870802402496338  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.870810031890869  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8714585304260254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.871504783630371  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.871504783630371  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8715124130249023  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8722143173217773  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.872304916381836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.872304916381836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8723182678222656  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8736400604248047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.873734474182129  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.873734474182129  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8737478256225586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8751630783081055  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8752026557922363  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8752026557922363  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8752083778381348  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.875854969024658  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.87593412399292  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.87593412399292  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.875943660736084  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8770880699157715  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8771352767944336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8771352767944336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.877140998840332  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8778676986694336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.877993106842041  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.877993106842041  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8780064582824707  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.879795551300049  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([7, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8799238204956055  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8799238204956055  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.879937171936035  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.881819725036621  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([4, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.881894111633301  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.881894111633301  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.881901741027832  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.883030891418457  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8830485343933105  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8830485343933105  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8830504417419434  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8833460807800293  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.883455753326416  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.883455753326416  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.88346529006958  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.885010242462158  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8851442337036133  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.8851442337036133  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.88515567779541  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.887089729309082  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5807, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 4.0268378257751465  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 4.0268378257751465  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5807, 256]), torch.Size([1, 5807, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 4.037913799285889  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.987285137176514  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5807, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.846673488616943  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.847733497619629  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.8487935066223145  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.847688674926758  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([5971, 47])
input nodes number: 61560
output nodes number: 5971
edges number: 146866
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.847757816314697  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 5.8477582931518555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.09295368194580078  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

pseudo mini batch 14 input nodes size: 196333
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.07682609558105469  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.07682609558105469  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.14996623992919922  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.15001344680786133  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.07933521270751953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.08507537841796875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.08507537841796875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

first layer input nodes number: 196333
first layer output nodes number: 61858
edges number: 613019
----------------------------------------before model layer 0
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.08699941635131836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([196333, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.08699941635131836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([64, 1, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3218111991882324  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3218111991882324  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 64, 100]), torch.Size([1, 64, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.32185888290405273  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.32224035263061523  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 64, 100])
m.shape torch.Size([96, 2, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.32228803634643555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.32228803634643555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 96, 100]), torch.Size([1, 96, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.322359561920166  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.32343244552612305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 96, 100])
m.shape torch.Size([99, 3, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.32350778579711914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.32350778579711914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 99, 100]), torch.Size([1, 99, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.32358217239379883  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3252100944519043  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 99, 100])
m.shape torch.Size([130, 4, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3253669738769531  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3253669738769531  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 130, 100]), torch.Size([1, 130, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.32546424865722656  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3282794952392578  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 130, 100])
m.shape torch.Size([158, 5, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3285255432128906  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3285255432128906  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 158, 100]), torch.Size([1, 158, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.328643798828125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3328866958618164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 158, 100])
m.shape torch.Size([179, 6, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.33322811126708984  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.33322811126708984  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 179, 100]), torch.Size([1, 179, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3333616256713867  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.33910274505615234  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 179, 100])
m.shape torch.Size([205, 7, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3395709991455078  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3395709991455078  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 205, 100]), torch.Size([1, 205, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3397245407104492  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.34737157821655273  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 205, 100])
m.shape torch.Size([203, 8, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3478999137878418  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3478999137878418  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 203, 100]), torch.Size([1, 203, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3480515480041504  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.35668325424194336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 203, 100])
m.shape torch.Size([217, 9, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.35733509063720703  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.35733509063720703  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 217, 100]), torch.Size([1, 217, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3574972152709961  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.3678603172302246  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 217, 100])
m.shape torch.Size([60507, 10, 100])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.5931854248046875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.5931854248046875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 60507, 100]), torch.Size([1, 60507, 100])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 0.6400604248046875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.860568046569824  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 60507, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.630535125732422  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.6895275115966797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.7485198974609375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.6895275115966797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([61858, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.7485198974609375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.763267993927002  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.763267993927002  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.914721965789795  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.914721965789795  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9147238731384277  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.91475248336792  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9147605895996094  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9147605895996094  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.914766311645508  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9148921966552734  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9148945808410645  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9148945808410645  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9148964881896973  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9149651527404785  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9149932861328125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9149932861328125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9150028228759766  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9154129028320312  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.915431499481201  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.915431499481201  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9154372215270996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9157633781433105  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.915769577026367  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.915769577026367  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.915771484375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9158935546875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.91591215133667  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.91591215133667  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9159159660339355  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.916186809539795  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.916195869445801  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.916195869445801  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9161977767944336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.916346549987793  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9163804054260254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9163804054260254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.916386127471924  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.916872501373291  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.916919708251953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.916919708251953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9169273376464844  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9176292419433594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9177064895629883  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9177064895629883  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.917717933654785  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.918850898742676  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9189462661743164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9189462661743164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.918959617614746  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.920374870300293  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9204607009887695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9204607009887695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9204721450805664  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9217653274536133  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.921825408935547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.921825408935547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.921833038330078  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.922748565673828  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9227967262268066  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9227967262268066  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.922802448272705  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9235291481018066  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.923635959625244  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.923635959625244  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.923647403717041  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9251809120178223  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([4, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9252524375915527  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9252524375915527  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.925260066986084  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9263358116149902  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.926453113555908  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.926453113555908  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.926464557647705  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9281582832336426  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9282584190368652  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9282584190368652  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9282679557800293  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.929746150970459  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([2, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.92978572845459  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.92978572845459  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9297895431518555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9304075241088867  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.930521011352539  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.930521011352539  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.930530548095703  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 3.9321422576904297  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6244, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 4.082640171051025  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 4.082640171051025  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 6244, 256]), torch.Size([1, 6244, 256])
----------------------------------------3
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 4.095030307769775  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 6.191099643707275  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 6244, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 6.041012763977051  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 6.042169094085693  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 6.0438032150268555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 6.042599678039551  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([6322, 47])
input nodes number: 61858
output nodes number: 6322
edges number: 157301
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 6.043204307556152  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0858154296875 GB
    Memory Allocated: 6.0432047843933105  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.0950016975402832  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

pseudo mini batch 15 input nodes size: 162648
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.07943153381347656  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.07943153381347656  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.14002275466918945  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.14006996154785156  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.06688261032104492  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.07213163375854492  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.07213163375854492  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

first layer input nodes number: 162648
first layer output nodes number: 55367
edges number: 547577
----------------------------------------before model layer 0
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.07375669479370117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([162648, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.07375669479370117  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([40, 1, 100])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.28349781036376953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.28349781036376953  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 40, 100]), torch.Size([1, 40, 100])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.28352832794189453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.2837681770324707  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 40, 100])
m.shape torch.Size([69, 2, 100])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.28380441665649414  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.28380441665649414  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 69, 100]), torch.Size([1, 69, 100])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.2838559150695801  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.28462839126586914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 69, 100])
m.shape torch.Size([119, 3, 100])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.28473567962646484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.28473567962646484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 119, 100]), torch.Size([1, 119, 100])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.2848243713378906  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.2867755889892578  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 119, 100])
m.shape torch.Size([152, 4, 100])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.2869577407836914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.2869577407836914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 152, 100]), torch.Size([1, 152, 100])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.28707122802734375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.2903566360473633  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 152, 100])
m.shape torch.Size([183, 5, 100])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.29064083099365234  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.29064083099365234  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 183, 100]), torch.Size([1, 183, 100])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.29077720642089844  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.2956867218017578  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 183, 100])
m.shape torch.Size([210, 6, 100])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.29608821868896484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.29608821868896484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 210, 100]), torch.Size([1, 210, 100])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.2962455749511719  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.30298614501953125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 210, 100])
m.shape torch.Size([256, 7, 100])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.3035750389099121  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.3035750389099121  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 256, 100]), torch.Size([1, 256, 100])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.30376577377319336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.31330251693725586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 256, 100])
m.shape torch.Size([280, 8, 100])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.3140416145324707  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.3140416145324707  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 280, 100]), torch.Size([1, 280, 100])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.31425046920776367  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.326143741607666  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 280, 100])
m.shape torch.Size([353, 9, 100])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.32803916931152344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.32803916931152344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 353, 100]), torch.Size([1, 353, 100])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.32830238342285156  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.34514808654785156  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 353, 100])
m.shape torch.Size([53705, 10, 100])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.5450835227966309  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.5450835227966309  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 53705, 100]), torch.Size([1, 53705, 100])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.5850977897644043  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.42606782913208  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 53705, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.221658706665039  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.274460792541504  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.3272628784179688  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.274460792541504  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([55367, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.3272628784179688  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.340463638305664  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.340463638305664  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4915566444396973  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4915566444396973  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.491560459136963  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4916443824768066  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4916467666625977  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4916467666625977  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4916486740112305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.491703987121582  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.491713047027588  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.491713047027588  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4917168617248535  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.491854190826416  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.491887092590332  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.491887092590332  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.491898536682129  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4923906326293945  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.492398738861084  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.492398738861084  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4924025535583496  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.492593288421631  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4926300048828125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4926300048828125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4926395416259766  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.493183135986328  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.493213176727295  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.493213176727295  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.493220806121826  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.493709087371826  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4937825202941895  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4937825202941895  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.493797779083252  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4948811531066895  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([8, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4949584007263184  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4949584007263184  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.494973659515381  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.496163845062256  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([7, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.496237277984619  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.496237277984619  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.496250629425049  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4973855018615723  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([3, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4974164962768555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4974164962768555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.497422218322754  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.49794864654541  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([8, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.498053550720215  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.498053550720215  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4980688095092773  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.499579429626465  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([9, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.499701976776123  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.499701976776123  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4997191429138184  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5015387535095215  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([1, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5015459060668945  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5015459060668945  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5015478134155273  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.501763343811035  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.501828193664551  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.501828193664551  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.501835823059082  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.502751350402832  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([8, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5028862953186035  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5028862953186035  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.502901554107666  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5048394203186035  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([3, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5048866271972656  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5048866271972656  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.504892349243164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5056591033935547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([11, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5058679580688477  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5058679580688477  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5058889389038086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.508847236633301  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([5, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5089378356933594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5089378356933594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5089473724365234  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5103588104248047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([11, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.510586738586426  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.510586738586426  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5106077194213867  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.513859748840332  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([6, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5139822959899902  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5139822959899902  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.513993740081787  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.515847682952881  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.51591157913208  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.51591157913208  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5159173011779785  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5168843269348145  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6207, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.66672945022583  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.66672945022583  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 6207, 256]), torch.Size([1, 6207, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.6789793968200684  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 5.763199329376221  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 6207, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 5.613511562347412  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 5.615061283111572  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 5.616722583770752  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 5.61512565612793  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([6324, 47])
input nodes number: 55367
output nodes number: 6324
edges number: 156921
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 5.615979194641113  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 5.6159796714782715  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.08146524429321289  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

pseudo mini batch 16 input nodes size: 209555
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.0672760009765625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.0672760009765625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.1453413963317871  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.1453871726989746  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.08474874496459961  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.08989858627319336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.08989858627319336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

first layer input nodes number: 209555
first layer output nodes number: 56230
edges number: 546569
----------------------------------------before model layer 0
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.09187936782836914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([209555, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.09187936782836914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([60, 1, 100])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.30138683319091797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.30138683319091797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 60, 100]), torch.Size([1, 60, 100])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.30143165588378906  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.3017902374267578  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 60, 100])
m.shape torch.Size([116, 2, 100])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.30185461044311523  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.30185461044311523  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 116, 100]), torch.Size([1, 116, 100])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.3019413948059082  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.3032402992248535  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 116, 100])
m.shape torch.Size([216, 3, 100])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.303438663482666  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.303438663482666  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 216, 100]), torch.Size([1, 216, 100])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.30359983444213867  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.3071413040161133  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 216, 100])
m.shape torch.Size([419, 4, 100])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.30768537521362305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.30768537521362305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 419, 100]), torch.Size([1, 419, 100])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.3079981803894043  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.31705808639526367  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 419, 100])
m.shape torch.Size([574, 5, 100])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.31797122955322266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.31797122955322266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 574, 100]), torch.Size([1, 574, 100])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.31839942932128906  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.3338003158569336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 574, 100])
m.shape torch.Size([631, 6, 100])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.33499670028686523  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.33499670028686523  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 631, 100]), torch.Size([1, 631, 100])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.3354668617248535  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.3556838035583496  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 631, 100])
m.shape torch.Size([793, 7, 100])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.3575167655944824  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.3575167655944824  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 793, 100]), torch.Size([1, 793, 100])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.3581080436706543  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.3880925178527832  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 793, 100])
m.shape torch.Size([816, 8, 100])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.3902287483215332  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.3902287483215332  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 816, 100]), torch.Size([1, 816, 100])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.3908371925354004  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.42598676681518555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 816, 100])
m.shape torch.Size([832, 9, 100])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.42847204208374023  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.42847204208374023  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 832, 100]), torch.Size([1, 832, 100])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.4290919303894043  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.47041940689086914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 832, 100])
m.shape torch.Size([51773, 10, 100])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.6629791259765625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.6629791259765625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 51773, 100]), torch.Size([1, 51773, 100])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 0.7020416259765625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.4449472427368164  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 51773, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.241940498352051  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.295565605163574  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.3491907119750977  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.295565605163574  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([56230, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.3491907119750977  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.3625969886779785  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.3625969886779785  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([7, 1, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5025992393493652  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5025992393493652  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.502612590789795  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5027194023132324  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5027170181274414  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5027170181274414  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.502720832824707  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5027780532836914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.502790927886963  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.502790927886963  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.502800464630127  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5030102729797363  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([13, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5030555725097656  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5030555725097656  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.503080368041992  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5037994384765625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([14, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.503854751586914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.503854751586914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5038814544677734  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.504842758178711  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([21, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.504950523376465  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.504950523376465  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.504990577697754  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5067129135131836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([41, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5069689750671387  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5069689750671387  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 41, 256]), torch.Size([1, 41, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.507047176361084  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5109572410583496  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 41, 256])
m.shape torch.Size([23, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5110950469970703  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5110950469970703  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.511138916015625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.513639450073242  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([40, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5139636993408203  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5139636993408203  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.514039993286133  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.518922805786133  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([57, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.519432544708252  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.519432544708252  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5195412635803223  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5272603034973145  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([62, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5278615951538086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5278615951538086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.527979850769043  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.537203788757324  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([46, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.537675380706787  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.537675380706787  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5377631187438965  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5452208518981934  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.545614719390869  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.545614719390869  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5456814765930176  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.551823139190674  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([54, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.552516460418701  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.552516460418701  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 54, 256]), torch.Size([1, 54, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.552619457244873  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5628161430358887  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 54, 256])
m.shape torch.Size([53, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5635290145874023  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5635290145874023  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 53, 256]), torch.Size([1, 53, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5636301040649414  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.574345588684082  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 53, 256])
m.shape torch.Size([52, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.575094699859619  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.575094699859619  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5751938819885254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5864014625549316  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([36, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.586940288543701  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.586940288543701  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5870089530944824  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5952486991882324  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([61, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.596465587615967  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.596465587615967  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.5965819358825684  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.611358165740967  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([47, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.6121582984924316  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.6121582984924316  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.612247943878174  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.624260425567627  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([39, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.6249656677246094  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.6249656677246094  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.625040054321289  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.635528564453125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([51, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.6365208625793457  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.6365208625793457  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.636618137359619  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.651014804840088  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([57, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.652444362640381  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.652444362640381  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 57, 256]), torch.Size([1, 57, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.652553081512451  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.6694045066833496  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 57, 256])
m.shape torch.Size([48, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.6704115867614746  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.6704115867614746  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.6705031394958496  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.6853346824645996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.6860270500183105  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.6860270500183105  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 11.0877685546875 GB
    Memory Allocated: 3.6860880851745605  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0975341796875 GB
    Memory Allocated: 3.6964030265808105  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([5246, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.0994873046875 GB
    Memory Allocated: 3.8228840827941895  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.0994873046875 GB
    Memory Allocated: 3.8228840827941895  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5246, 256]), torch.Size([1, 5246, 256])
----------------------------------------3
 Nvidia-smi: 11.0994873046875 GB
    Memory Allocated: 3.832890033721924  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.0994873046875 GB
    Memory Allocated: 5.593937397003174  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5246, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.0994873046875 GB
    Memory Allocated: 5.455987930297852  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.0994873046875 GB
    Memory Allocated: 5.4576263427734375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.0994873046875 GB
    Memory Allocated: 5.458702087402344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.0994873046875 GB
    Memory Allocated: 5.45701789855957  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([6142, 47])
input nodes number: 56230
output nodes number: 6142
edges number: 144477
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.0994873046875 GB
    Memory Allocated: 5.4570088386535645  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.0994873046875 GB
    Memory Allocated: 5.457009315490723  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.09865665435791016  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

pseudo mini batch 17 input nodes size: 133657
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.0842747688293457  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.0842747688293457  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.13406610488891602  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.13411331176757812  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.056002140045166016  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.0611720085144043  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.0611720085144043  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

first layer input nodes number: 133657
first layer output nodes number: 47874
edges number: 457949
----------------------------------------before model layer 0
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.06252527236938477  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([133657, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.06252527236938477  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([65, 1, 100])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.23799610137939453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.23799610137939453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 65, 100]), torch.Size([1, 65, 100])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.23804473876953125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.238433837890625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 65, 100])
m.shape torch.Size([122, 2, 100])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.23850059509277344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.23850059509277344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 122, 100]), torch.Size([1, 122, 100])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.23859214782714844  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.239959716796875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 122, 100])
m.shape torch.Size([295, 3, 100])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.24024391174316406  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.24024391174316406  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 295, 100]), torch.Size([1, 295, 100])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.2404642105102539  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.2453022003173828  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 295, 100])
m.shape torch.Size([600, 4, 100])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.24608612060546875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.24608612060546875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 600, 100]), torch.Size([1, 600, 100])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.24653339385986328  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.25949859619140625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 600, 100])
m.shape torch.Size([804, 5, 100])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.260772705078125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.260772705078125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 804, 100]), torch.Size([1, 804, 100])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.26137256622314453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.28408050537109375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 804, 100])
m.shape torch.Size([891, 6, 100])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.28577232360839844  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.28577232360839844  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 891, 100]), torch.Size([1, 891, 100])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.2864370346069336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.31499385833740234  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 891, 100])
m.shape torch.Size([973, 7, 100])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.3171992301940918  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.3171992301940918  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 973, 100]), torch.Size([1, 973, 100])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.31792497634887695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.35579824447631836  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 973, 100])
m.shape torch.Size([1007, 8, 100])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.35843658447265625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.35843658447265625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 1007, 100]), torch.Size([1, 1007, 100])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.35918712615966797  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.4023571014404297  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 1007, 100])
m.shape torch.Size([1048, 9, 100])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.40549564361572266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.40549564361572266  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 1048, 100]), torch.Size([1, 1048, 100])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.4062767028808594  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.4586629867553711  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 1048, 100])
m.shape torch.Size([42069, 10, 100])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.6149921417236328  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.6149921417236328  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 42069, 100]), torch.Size([1, 42069, 100])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.646336555480957  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.8717613220214844  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 42069, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.702423095703125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.748079299926758  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.7937355041503906  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.748079299926758  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([47874, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.7937355041503906  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.805149555206299  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.805149555206299  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9490089416503906  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9490089416503906  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.949014663696289  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9491004943847656  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.949126720428467  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.949126720428467  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.949145793914795  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9495654106140137  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([11, 4, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9495983123779297  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9495983123779297  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9496192932128906  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.950227737426758  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([14, 5, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.950284957885742  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.950284957885742  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9503116607666016  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.951272964477539  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([25, 6, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.951404094696045  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.951404094696045  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9514517784118652  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9535021781921387  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([21, 7, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.953619956970215  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.953619956970215  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.953660011291504  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.955662727355957  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([31, 8, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.955881118774414  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.955881118774414  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9559402465820312  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.959310531616211  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([34, 9, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9595751762390137  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9595751762390137  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9596400260925293  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9637904167175293  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([49, 10, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.964229106903076  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.964229106903076  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.964322566986084  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9709582328796387  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([46, 11, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.971397876739502  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.971397876739502  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 46, 256]), torch.Size([1, 46, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9714856147766113  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9783291816711426  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 46, 256])
m.shape torch.Size([34, 12, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.978677749633789  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.978677749633789  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9787425994873047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.984254837036133  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([39, 13, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9847097396850586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9847097396850586  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9847841262817383  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9916276931762695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([43, 14, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9921693801879883  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.9921693801879883  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 43, 256]), torch.Size([1, 43, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 2.992251396179199  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.000370979309082  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 43, 256])
m.shape torch.Size([45, 15, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.000978946685791  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.000978946685791  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0010647773742676  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.010162830352783  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([48, 16, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0108580589294434  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0108580589294434  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0109496116638184  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0212950706481934  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([42, 17, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0219359397888184  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0219359397888184  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0220160484313965  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0316290855407715  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([39, 18, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.03226375579834  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.03226375579834  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0323381423950195  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.04178524017334  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([34, 19, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0423693656921387  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0423693656921387  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0424342155456543  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.051124095916748  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.051668643951416  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.051668643951416  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0517258644104004  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0597939491271973  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([38, 21, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.060532569885254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.060532569885254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.060605049133301  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0713319778442383  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([42, 22, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0721840858459473  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0721840858459473  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0722641944885254  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0846810340881348  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([40, 23, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0855255126953125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0855255126953125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 40, 256]), torch.Size([1, 40, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.085601806640625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.09796142578125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 40, 256])
m.shape torch.Size([31, 24, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0986385345458984  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0986385345458984  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.0986976623535156  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.1086902618408203  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([5536, 25, 256])
----------------------------------------1
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.2417030334472656  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.2417030334472656  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5536, 256]), torch.Size([1, 5536, 256])
----------------------------------------3
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 3.252908706665039  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 5.111307144165039  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5536, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 4.969400405883789  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 4.970864772796631  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 4.971965312957764  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 4.97045373916626  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([6285, 47])
input nodes number: 47874
output nodes number: 6285
edges number: 149405
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 4.971001148223877  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 4.971001625061035  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.06909418106079102  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

pseudo mini batch 18 input nodes size: 257757
----------------------------------------before load block subtensor 
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.05614519119262695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.05614519119262695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.15216732025146484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.15221452713012695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.10237598419189453  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.10893917083740234  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.10893917083740234  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

first layer input nodes number: 257757
first layer output nodes number: 73405
edges number: 725325
----------------------------------------before model layer 0
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.11140680313110352  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([257757, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 11.1014404296875 GB
    Memory Allocated: 0.11140680313110352  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([81, 1, 100])
----------------------------------------1
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.38924360275268555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.38924360275268555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 81, 100]), torch.Size([1, 81, 100])
----------------------------------------3
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.38930463790893555  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.38979005813598633  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 81, 100])
m.shape torch.Size([113, 2, 100])
----------------------------------------1
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.3898439407348633  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.3898439407348633  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 113, 100]), torch.Size([1, 113, 100])
----------------------------------------3
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.38992881774902344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.39119625091552734  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 113, 100])
m.shape torch.Size([153, 3, 100])
----------------------------------------1
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.3913249969482422  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.3913249969482422  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 153, 100]), torch.Size([1, 153, 100])
----------------------------------------3
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.39143943786621094  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.3939528465270996  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 153, 100])
m.shape torch.Size([205, 4, 100])
----------------------------------------1
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.39420127868652344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.39420127868652344  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 205, 100]), torch.Size([1, 205, 100])
----------------------------------------3
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.39435482025146484  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.3987903594970703  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 205, 100])
m.shape torch.Size([277, 5, 100])
----------------------------------------1
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.3992300033569336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.3992300033569336  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 277, 100]), torch.Size([1, 277, 100])
----------------------------------------3
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.39943695068359375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.4068727493286133  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 277, 100])
m.shape torch.Size([297, 6, 100])
----------------------------------------1
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.40743350982666016  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.40743350982666016  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 297, 100]), torch.Size([1, 297, 100])
----------------------------------------3
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.4076557159423828  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.41718482971191406  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 297, 100])
m.shape torch.Size([340, 7, 100])
----------------------------------------1
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.41796064376831055  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.41796064376831055  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 340, 100]), torch.Size([1, 340, 100])
----------------------------------------3
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.4182143211364746  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.43088817596435547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 340, 100])
m.shape torch.Size([385, 8, 100])
----------------------------------------1
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.4320406913757324  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.4320406913757324  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 385, 100]), torch.Size([1, 385, 100])
----------------------------------------3
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.4323277473449707  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.44868993759155273  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 385, 100])
m.shape torch.Size([428, 9, 100])
----------------------------------------1
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.449981689453125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.449981689453125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 428, 100]), torch.Size([1, 428, 100])
----------------------------------------3
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.4503011703491211  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 11.3748779296875 GB
    Memory Allocated: 0.4707221984863281  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 428, 100])
m.shape torch.Size([71126, 10, 100])
----------------------------------------1
 Nvidia-smi: 11.6405029296875 GB
    Memory Allocated: 0.7361874580383301  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 11.6405029296875 GB
    Memory Allocated: 0.7361874580383301  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 71126, 100]), torch.Size([1, 71126, 100])
----------------------------------------3
 Nvidia-smi: 11.6405029296875 GB
    Memory Allocated: 0.7891812324523926  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.551696300506592  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 71126, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.280961036682129  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.35096549987793  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.4209699630737305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.35096549987793  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

torch.Size([73405, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.4209699630737305  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.43847131729126  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.43847131729126  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.588186264038086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.588186264038086  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.588188171386719  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.588203430175781  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.588211536407471  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.588211536407471  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.588217258453369  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.588343143463135  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.5883636474609375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.5883636474609375  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.588375091552734  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.588706970214844  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([11, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.588754177093506  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.588754177093506  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.588775157928467  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.5895304679870605  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([10, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.589577674865723  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.589577674865723  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.589596748352051  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.59041690826416  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([3, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.590427875518799  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.590427875518799  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.590433597564697  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.590719699859619  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.590763092041016  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.590763092041016  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.5907745361328125  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.591426849365234  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([15, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.591551303863525  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.591551303863525  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.591579914093018  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.593410968780518  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([5, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.59344482421875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.59344482421875  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.593454360961914  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.5941314697265625  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([9, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.594222068786621  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.594222068786621  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.594239234924316  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.595578193664551  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([14, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.595731258392334  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.595731258392334  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.595757961273193  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.59802770614624  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([13, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.598176956176758  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.598176956176758  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.598201751708984  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.600482940673828  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.600618839263916  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.600618839263916  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.600639820098877  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.60271692276001  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([2, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.60273551940918  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.60273551940918  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.602739334106445  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.603143692016602  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([12, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.603326320648193  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.603326320648193  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.603349208831787  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.605935573577881  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([10, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.606087684631348  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.606087684631348  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.606106758117676  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.608395576477051  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.608541965484619  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.608541965484619  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.6085591316223145  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.610739231109619  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([9, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.610895156860352  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.610895156860352  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.610912322998047  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.613212585449219  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.613646507263184  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.613646507263184  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.613690376281738  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.619875907897949  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.620035648345947  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.620035648345947  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.620052814483643  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.622593402862549  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.622754096984863  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.622754096984863  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.622769355773926  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.625134468078613  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([15, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.625458717346191  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.625458717346191  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.625487327575684  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.630122184753418  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([21, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.630592346191406  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.630592346191406  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.630632400512695  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.637401580810547  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([6084, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.783871173858643  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.783871173858643  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

 h.shape torch.Size([1, 6084, 256]), torch.Size([1, 6084, 256])
----------------------------------------3
 Nvidia-smi: 13.4100341796875 GB
    Memory Allocated: 4.796248912811279  GigaBytes
Max Memory Allocated: 6.402771949768066  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.5565185546875 GB
    Memory Allocated: 6.858323097229004  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 6084, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.5565185546875 GB
    Memory Allocated: 6.710101127624512  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.5565185546875 GB
    Memory Allocated: 6.711536884307861  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.5565185546875 GB
    Memory Allocated: 6.712972640991211  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.5565185546875 GB
    Memory Allocated: 6.711489677429199  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([6309, 47])
input nodes number: 73405
output nodes number: 6309
edges number: 155492
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.5565185546875 GB
    Memory Allocated: 6.712300777435303  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.5565185546875 GB
    Memory Allocated: 6.712301254272461  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.12051105499267578  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

pseudo mini batch 19 input nodes size: 235360
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.10259294509887695  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.10259294509887695  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.19048357009887695  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.19053030014038086  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.09446096420288086  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.10013723373413086  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.10013723373413086  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

first layer input nodes number: 235360
first layer output nodes number: 61844
edges number: 611256
----------------------------------------before model layer 0
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.10235214233398438  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([235360, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.10235214233398438  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

m.shape torch.Size([75, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3366522789001465  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3366522789001465  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 75, 100]), torch.Size([1, 75, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.33670854568481445  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3371572494506836  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 75, 100])
m.shape torch.Size([111, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.33721208572387695  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.33721208572387695  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 111, 100]), torch.Size([1, 111, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3372950553894043  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.33853673934936523  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 111, 100])
m.shape torch.Size([169, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3386845588684082  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3386845588684082  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 169, 100]), torch.Size([1, 169, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.33881139755249023  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.34158897399902344  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 169, 100])
m.shape torch.Size([179, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.34179258346557617  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.34179258346557617  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 179, 100]), torch.Size([1, 179, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.34192609786987305  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3457980155944824  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 179, 100])
m.shape torch.Size([184, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.34607410430908203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.34607410430908203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 184, 100]), torch.Size([1, 184, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.34621143341064453  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3511481285095215  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 184, 100])
m.shape torch.Size([209, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3515467643737793  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3515467643737793  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 209, 100]), torch.Size([1, 209, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3517031669616699  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3584113121032715  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 209, 100])
m.shape torch.Size([252, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3589906692504883  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3589906692504883  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 252, 100]), torch.Size([1, 252, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3591785430908203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3685722351074219  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 252, 100])
m.shape torch.Size([281, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.36931610107421875  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.36931610107421875  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 281, 100]), torch.Size([1, 281, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3695259094238281  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3814735412597656  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 281, 100])
m.shape torch.Size([290, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3823413848876953  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3823413848876953  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 290, 100]), torch.Size([1, 290, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.38255786895751953  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.39639997482299805  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 290, 100])
m.shape torch.Size([60094, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.6201596260070801  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.6201596260070801  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 60094, 100]), torch.Size([1, 60094, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.6649336814880371  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.843863010406494  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 60094, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.616441249847412  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6754202842712402  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7343993186950684  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6754202842712402  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([61844, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7343993186950684  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7491440773010254  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7491440773010254  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

m.shape torch.Size([3, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.894031524658203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.894031524658203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.8940372467041016  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.894083023071289  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.8940844535827637  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.8940844535827637  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.8940882682800293  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.8941454887390137  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([24, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.8942131996154785  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.8942131996154785  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.894258975982666  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.895266056060791  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([25, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.8953394889831543  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.8953394889831543  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.8953871726989746  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.8967700004577637  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.896775245666504  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.896775245666504  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.896786689758301  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.8971986770629883  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([15, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.897279739379883  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.897279739379883  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.897308349609375  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.898538589477539  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([22, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.898672580718994  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.898672580718994  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.898714542388916  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9008126258850098  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([10, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9008688926696777  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9008688926696777  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.900887966156006  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.901975154876709  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([21, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9021472930908203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9021472930908203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9021873474121094  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9047508239746094  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([6, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9047884941101074  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9047884941101074  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9047999382019043  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9056124687194824  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.905712604522705  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.905712604522705  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.905731678009033  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.907219409942627  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([28, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9075331687927246  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9075331687927246  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 28, 256]), torch.Size([1, 28, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9075865745544434  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.912126064300537  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 28, 256])
m.shape torch.Size([23, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.912386894226074  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.912386894226074  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.912430763244629  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.91646671295166  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([25, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.916781425476074  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.916781425476074  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9168291091918945  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9215497970581055  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([22, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9218435287475586  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9218435287475586  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9218854904174805  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.926333427429199  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([17, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.926574230194092  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.926574230194092  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9266066551208496  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9302706718444824  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([11, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.930434226989746  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.930434226989746  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.930455207824707  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9329729080200195  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([30, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9334816932678223  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9334816932678223  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9335389137268066  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9408059120178223  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([22, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9411792755126953  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9411792755126953  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.941221237182617  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9468441009521484  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([15, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9471116065979004  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9471116065979004  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9471402168273926  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.951174259185791  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([27, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.951704978942871  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.951704978942871  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.951756477355957  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.959378242492676  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([27, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.95992374420166  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.95992374420166  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 27, 256]), torch.Size([1, 27, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.959975242614746  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9679574966430664  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 27, 256])
m.shape torch.Size([20, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.968374252319336  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.968374252319336  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.968412399291992  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9745922088623047  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([45, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9756317138671875  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9756317138671875  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.975717544555664  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.990222930908203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([5754, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.1284379959106445  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.1284379959106445  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 5754, 256]), torch.Size([1, 5754, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.139412879943848  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 6.071455955505371  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 5754, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 5.9282450675964355  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 5.929422855377197  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 5.930908679962158  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 5.929684162139893  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([6210, 47])
input nodes number: 61844
output nodes number: 6210
edges number: 150475
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 5.929934024810791  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 5.929934501647949  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.11004114151000977  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

pseudo mini batch 20 input nodes size: 291078
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.09420299530029297  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.09420299530029297  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.2026381492614746  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.2026829719543457  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.1147456169128418  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.12059736251831055  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.12059736251831055  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

first layer input nodes number: 291078
first layer output nodes number: 64939
edges number: 642835
----------------------------------------before model layer 0
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.12325048446655273  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([291078, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.12325048446655273  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

m.shape torch.Size([53, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3702383041381836  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3702383041381836  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 53, 100]), torch.Size([1, 53, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.37027835845947266  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.37059593200683594  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 53, 100])
m.shape torch.Size([75, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3706321716308594  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3706321716308594  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 75, 100]), torch.Size([1, 75, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.37068843841552734  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.37152957916259766  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 75, 100])
m.shape torch.Size([140, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3716583251953125  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3716583251953125  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 140, 100]), torch.Size([1, 140, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3717632293701172  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.37406253814697266  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 140, 100])
m.shape torch.Size([176, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.37427234649658203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.37427234649658203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 176, 100]), torch.Size([1, 176, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3744039535522461  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.37820911407470703  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 176, 100])
m.shape torch.Size([185, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.37848806381225586  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.37848806381225586  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 185, 100]), torch.Size([1, 185, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.37862634658813477  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.38359737396240234  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 185, 100])
m.shape torch.Size([192, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3839573860168457  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3839573860168457  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 192, 100]), torch.Size([1, 192, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.38410043716430664  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.39025163650512695  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 192, 100])
m.shape torch.Size([296, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.39095211029052734  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.39095211029052734  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 296, 100]), torch.Size([1, 296, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3911733627319336  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.4022059440612793  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 296, 100])
m.shape torch.Size([268, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.4028940200805664  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.4028940200805664  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 268, 100]), torch.Size([1, 268, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.4030942916870117  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.4144868850708008  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 268, 100])
m.shape torch.Size([325, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.41547679901123047  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.41547679901123047  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 325, 100]), torch.Size([1, 325, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.41571903228759766  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.43122196197509766  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 325, 100])
m.shape torch.Size([63229, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.6666474342346191  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.6666474342346191  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 63229, 100]), torch.Size([1, 63229, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.7137570381164551  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.0585246086120605  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 63229, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.8177084922790527  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.879639148712158  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9415698051452637  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.879639148712158  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([64939, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9415698051452637  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.957052707672119  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.957052707672119  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.094181537628174  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.094181537628174  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.094183444976807  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.094198703765869  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.094203948974609  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.094203948974609  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.094209671020508  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.094295501708984  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([15, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.094336032867432  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.094336032867432  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.094364643096924  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.094994068145752  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([26, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.0950798988342285  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.0950798988342285  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.095129489898682  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.096567630767822  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([11, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.096595764160156  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.096595764160156  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.096616744995117  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.097372055053711  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([19, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.097471237182617  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.097471237182617  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.097507476806641  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.099065780639648  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([62, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.0994648933410645  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.0994648933410645  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.099583148956299  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.105495929718018  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([15, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.1055521965026855  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.1055521965026855  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.105580806732178  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.107211589813232  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([37, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.107517719268799  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.107517719268799  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.107588291168213  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.112104892730713  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([33, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.112387180328369  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.112387180328369  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.112450122833252  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.116919040679932  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([51, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.117426872253418  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.117426872253418  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.117524147033691  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.1251115798950195  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([29, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.125397682189941  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.125397682189941  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.125452995300293  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.130154609680176  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([23, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.1304144859313965  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.1304144859313965  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.130458354949951  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.134494304656982  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([33, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.13491678237915  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.13491678237915  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 33, 256]), torch.Size([1, 33, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.134979724884033  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.141211032867432  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 33, 256])
m.shape torch.Size([62, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.142073631286621  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.142073631286621  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 62, 256]), torch.Size([1, 62, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.1421918869018555  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.154726982116699  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 62, 256])
m.shape torch.Size([12, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.154852390289307  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.154852390289307  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.1548752784729  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.157461643218994  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([15, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.157695293426514  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.157695293426514  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.157723903656006  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.161157131195068  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([32, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.161696434020996  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.161696434020996  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.161757469177246  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.169508934020996  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([20, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.169843673706055  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.169843673706055  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.169881820678711  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.174993515014648  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([51, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.175954818725586  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.175954818725586  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.176052093505859  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.189767837524414  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([32, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.190365314483643  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.190365314483643  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.190426349639893  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.199459552764893  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([34, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.200148105621338  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.200148105621338  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.2002129554748535  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.210264682769775  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([39, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.211094856262207  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.211094856262207  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.211169242858887  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.223219871520996  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([39, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.2240824699401855  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.2240824699401855  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.224156856536865  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.236728191375732  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([5304, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.364891529083252  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.364891529083252  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 5304, 256]), torch.Size([1, 5304, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.375882625579834  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 6.158908367156982  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 5304, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 6.023616313934326  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 6.025249481201172  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 6.026299953460693  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 6.024621963500977  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([5998, 47])
input nodes number: 64939
output nodes number: 5998
edges number: 142418
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 6.025540828704834  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 6.025541305541992  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.13158941268920898  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

pseudo mini batch 21 input nodes size: 183005
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.11513566970825195  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.11513566970825195  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.18331050872802734  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.18335533142089844  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.0748753547668457  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.07955408096313477  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.07955408096313477  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

first layer input nodes number: 183005
first layer output nodes number: 49312
edges number: 485796
----------------------------------------before model layer 0
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.08128547668457031  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([183005, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.08128547668457031  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

m.shape torch.Size([70, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.26745128631591797  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.26745128631591797  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 70, 100]), torch.Size([1, 70, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.2675037384033203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.26792192459106445  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 70, 100])
m.shape torch.Size([102, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.2679719924926758  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.2679719924926758  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 102, 100]), torch.Size([1, 102, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.2680482864379883  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.26918983459472656  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 102, 100])
m.shape torch.Size([145, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.2693138122558594  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.2693138122558594  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 145, 100]), torch.Size([1, 145, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.2694225311279297  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.2718057632446289  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 145, 100])
m.shape torch.Size([178, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.2720170021057129  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.2720170021057129  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 178, 100]), torch.Size([1, 178, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.27215051651000977  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.27600526809692383  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 178, 100])
m.shape torch.Size([194, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.27629995346069336  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.27629995346069336  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 194, 100]), torch.Size([1, 194, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.2764449119567871  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.28165626525878906  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 194, 100])
m.shape torch.Size([237, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.28211355209350586  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.28211355209350586  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 237, 100]), torch.Size([1, 237, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.2822909355163574  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.28989267349243164  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 237, 100])
m.shape torch.Size([306, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.2906022071838379  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.2906022071838379  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 306, 100]), torch.Size([1, 306, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.2908310890197754  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3022451400756836  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 306, 100])
m.shape torch.Size([319, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3030815124511719  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3030815124511719  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 319, 100]), torch.Size([1, 319, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.30331993103027344  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3168754577636719  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 319, 100])
m.shape torch.Size([321, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.31783294677734375  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.31783294677734375  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 321, 100]), torch.Size([1, 321, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3180723190307617  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3333921432495117  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 321, 100])
m.shape torch.Size([47440, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.5100002288818359  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.5100002288818359  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 47440, 100]), torch.Size([1, 47440, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.5453462600708008  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.0548858642578125  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 47440, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 2.8736801147460938  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 2.9207077026367188  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 2.9677352905273438  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 2.9207077026367188  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([49312, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 2.9677352905273438  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 2.9794921875  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 2.9794921875  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

m.shape torch.Size([13, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.116283416748047  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.116283416748047  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1163082122802734  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.116506576538086  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([11, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.116515636444092  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.116515636444092  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1165366172790527  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.116851329803467  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([5, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1168556213378906  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1168556213378906  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1168651580810547  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.117074966430664  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([21, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1171512603759766  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1171512603759766  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 21, 256]), torch.Size([1, 21, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1171913146972656  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1183528900146484  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 21, 256])
m.shape torch.Size([16, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.118410110473633  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.118410110473633  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 16, 256]), torch.Size([1, 16, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.118440628051758  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.119539260864258  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 16, 256])
m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.119558811187744  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.119558811187744  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.119570255279541  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1200623512268066  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([23, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.120211601257324  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.120211601257324  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.120255470275879  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1224489212036133  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([17, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.122558116912842  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.122558116912842  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1225905418395996  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.124438762664795  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([25, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1246390342712402  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1246390342712402  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 25, 256]), torch.Size([1, 25, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1246867179870605  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1277384757995605  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 25, 256])
m.shape torch.Size([17, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.127878189086914  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.127878189086914  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.127910614013672  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1302127838134766  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([20, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.13040828704834  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.13040828704834  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.130446434020996  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1334218978881836  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([47, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1339449882507324  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1339449882507324  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 47, 256]), torch.Size([1, 47, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1340346336364746  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1416544914245605  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 47, 256])
m.shape torch.Size([38, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1420845985412598  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1420845985412598  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1421570777893066  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.148825168609619  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([17, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.149017810821533  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.149017810821533  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.149050235748291  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1522603034973145  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([90, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1541128158569336  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1541128158569336  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1542844772338867  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.172480583190918  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([38, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1729793548583984  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1729793548583984  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1730518341064453  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.181241989135742  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([45, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.181941032409668  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.181941032409668  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1820268630981445  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.192326545715332  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([23, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1926817893981934  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1926817893981934  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.192725658416748  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1982970237731934  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([61, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1994452476501465  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.1994452476501465  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 61, 256]), torch.Size([1, 61, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.199561595916748  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.2151522636413574  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 61, 256])
m.shape torch.Size([30, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.2156710624694824  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.2156710624694824  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 30, 256]), torch.Size([1, 30, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.215728282928467  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.2237963676452637  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 30, 256])
m.shape torch.Size([39, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.224555015563965  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.224555015563965  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.2246294021606445  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.2356386184692383  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([26, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.2361512184143066  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.2361512184143066  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 26, 256]), torch.Size([1, 26, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.2362008094787598  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.243887424468994  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 26, 256])
m.shape torch.Size([42, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.2447915077209473  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.2447915077209473  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 42, 256]), torch.Size([1, 42, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.2448716163635254  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.2578492164611816  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 42, 256])
m.shape torch.Size([32, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.258547306060791  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.258547306060791  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.258608341217041  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.268923282623291  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([5263, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.395617961883545  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.395617961883545  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 5263, 256]), torch.Size([1, 5263, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.405656337738037  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 5.172410488128662  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 5263, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 5.037472248077393  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 5.038824558258057  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 5.040682792663574  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 5.039285659790039  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([5965, 47])
input nodes number: 49312
output nodes number: 5965
edges number: 142054
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 5.039482593536377  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 5.039483070373535  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.0876779556274414  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

pseudo mini batch 22 input nodes size: 244585
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.07465982437133789  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.07465982437133789  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.1664566993713379  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.16650152206420898  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.0982818603515625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.10389232635498047  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.10389232635498047  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

first layer input nodes number: 244585
first layer output nodes number: 62853
edges number: 618005
----------------------------------------before model layer 0
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.10618352890014648  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([244585, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.10618352890014648  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

m.shape torch.Size([119, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3429384231567383  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3429384231567383  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 119, 100]), torch.Size([1, 119, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.34302711486816406  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3437366485595703  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 119, 100])
m.shape torch.Size([153, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.34380674362182617  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.34380674362182617  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 153, 100]), torch.Size([1, 153, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3439211845397949  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.34563493728637695  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 153, 100])
m.shape torch.Size([230, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.34583520889282227  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.34583520889282227  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 230, 100]), torch.Size([1, 230, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3460068702697754  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3497791290283203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 230, 100])
m.shape torch.Size([254, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.35007190704345703  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.35007190704345703  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 254, 100]), torch.Size([1, 254, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3502616882324219  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.35575389862060547  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 254, 100])
m.shape torch.Size([270, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.35616207122802734  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.35616207122802734  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 270, 100]), torch.Size([1, 270, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.35636329650878906  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.36360740661621094  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 270, 100])
m.shape torch.Size([367, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.36432743072509766  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.36432743072509766  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 367, 100]), torch.Size([1, 367, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.36460113525390625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3763618469238281  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 367, 100])
m.shape torch.Size([378, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3772110939025879  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3772110939025879  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 378, 100]), torch.Size([1, 378, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.37749338150024414  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3915877342224121  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 378, 100])
m.shape torch.Size([385, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3926572799682617  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3926572799682617  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 385, 100]), torch.Size([1, 385, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3929443359375  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.40930652618408203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 385, 100])
m.shape torch.Size([374, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.4104170799255371  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.4104170799255371  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 374, 100]), torch.Size([1, 374, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.41069650650024414  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.4285411834716797  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 374, 100])
m.shape torch.Size([60323, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.6531224250793457  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.6531224250793457  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 60323, 100]), torch.Size([1, 60323, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.6999974250793457  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9122796058654785  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 60323, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.679933547973633  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.739874839782715  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.799816131591797  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.739874839782715  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([62853, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.799816131591797  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.8148016929626465  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.8148016929626465  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

m.shape torch.Size([11, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9446611404418945  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9446611404418945  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9446821212768555  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.944849967956543  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([13, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9448647499084473  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9448647499084473  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.944889545440674  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9452614784240723  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([52, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.945399284362793  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.945399284362793  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 52, 256]), torch.Size([1, 52, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.945498466491699  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9476804733276367  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 52, 256])
m.shape torch.Size([32, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.94775390625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.94775390625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 32, 256]), torch.Size([1, 32, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.94781494140625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9495849609375  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 32, 256])
m.shape torch.Size([34, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9497179985046387  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9497179985046387  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 34, 256]), torch.Size([1, 34, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9497828483581543  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.952117443084717  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 34, 256])
m.shape torch.Size([90, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.952604293823242  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.952604293823242  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 90, 256]), torch.Size([1, 90, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9527759552001953  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9601573944091797  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 90, 256])
m.shape torch.Size([88, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9606637954711914  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9606637954711914  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 88, 256]), torch.Size([1, 88, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.960831642150879  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.969223976135254  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 88, 256])
m.shape torch.Size([55, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9695630073547363  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9695630073547363  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 55, 256]), torch.Size([1, 55, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.969667911529541  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.975647449493408  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 55, 256])
m.shape torch.Size([73, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.976226806640625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.976226806640625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9763660430908203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.9852771759033203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([115, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.987057685852051  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.987057685852051  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 115, 256]), torch.Size([1, 115, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.987277030944824  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.002850532531738  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 115, 256])
m.shape torch.Size([45, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.003216743469238  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.003216743469238  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.003302574157715  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.009997367858887  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([39, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.010404586791992  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.010404586791992  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 39, 256]), torch.Size([1, 39, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.010478973388672  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.016801834106445  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 39, 256])
m.shape torch.Size([35, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.017202377319336  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.017202377319336  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 35, 256]), torch.Size([1, 35, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.017269134521484  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.023410797119141  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 35, 256])
m.shape torch.Size([75, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.025293827056885  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.025293827056885  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 75, 256]), torch.Size([1, 75, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.025436878204346  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.0395989418029785  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 75, 256])
m.shape torch.Size([24, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.0398736000061035  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.0398736000061035  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 24, 256]), torch.Size([1, 24, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.039919376373291  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.044771671295166  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 24, 256])
m.shape torch.Size([49, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.045502662658691  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.045502662658691  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.045596122741699  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.056157112121582  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([12, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.056306838989258  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.056306838989258  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.056329727172852  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.059076309204102  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([64, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.060981750488281  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.060981750488281  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.061103820800781  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.076606750488281  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([5, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.076637268066406  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.076637268066406  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.07664680480957  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.077924728393555  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([44, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.078765869140625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.078765869140625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 44, 256]), torch.Size([1, 44, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.078849792480469  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.0906829833984375  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 44, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.090863227844238  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.090863227844238  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.090884208679199  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.093989372253418  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([17, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.094338417053223  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.094338417053223  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 17, 256]), torch.Size([1, 17, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.0943708419799805  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.099396705627441  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 17, 256])
m.shape torch.Size([38, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.100220680236816  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.100220680236816  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.100293159484863  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.112034797668457  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([19, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.1124372482299805  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.1124372482299805  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.112473487854004  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.118597984313965  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([4923, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.236870765686035  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.236870765686035  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 4923, 256]), torch.Size([1, 4923, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 4.246260643005371  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 5.916163444519043  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 4923, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 5.788424015045166  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 5.790332317352295  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 5.792240619659424  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 5.790287494659424  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([5963, 47])
input nodes number: 62853
output nodes number: 5963
edges number: 134847
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 5.791357040405273  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 5.791357517242432  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.11436033248901367  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

pseudo mini batch 23 input nodes size: 233235
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.09883785247802734  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.09883785247802734  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.18572473526000977  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.18577051162719727  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.09392881393432617  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.09918832778930664  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.09918832778930664  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

first layer input nodes number: 233235
first layer output nodes number: 58038
edges number: 568124
----------------------------------------before model layer 0
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.10135889053344727  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([233235, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.10135889053344727  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

m.shape torch.Size([86, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.31986570358276367  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.31986570358276367  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 86, 100]), torch.Size([1, 86, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3199305534362793  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.32044506072998047  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 86, 100])
m.shape torch.Size([174, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3205423355102539  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3205423355102539  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 174, 100]), torch.Size([1, 174, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.32067203521728516  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3226175308227539  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 174, 100])
m.shape torch.Size([262, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3228459358215332  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3228459358215332  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 262, 100]), torch.Size([1, 262, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3230414390563965  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.32733821868896484  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 262, 100])
m.shape torch.Size([331, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.32773399353027344  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.32773399353027344  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 331, 100]), torch.Size([1, 331, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.32798099517822266  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.33513832092285156  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 331, 100])
m.shape torch.Size([381, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3357248306274414  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3357248306274414  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 381, 100]), torch.Size([1, 381, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.33600902557373047  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.34623289108276367  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 381, 100])
m.shape torch.Size([407, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3470005989074707  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3470005989074707  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 407, 100]), torch.Size([1, 407, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3473038673400879  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.36034440994262695  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 407, 100])
m.shape torch.Size([491, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.36147356033325195  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.36147356033325195  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 491, 100]), torch.Size([1, 491, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.36183977127075195  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3801403045654297  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 491, 100])
m.shape torch.Size([426, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3812270164489746  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3812270164489746  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 426, 100]), torch.Size([1, 426, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3815445899963379  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.3996462821960449  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 426, 100])
m.shape torch.Size([412, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.40086889266967773  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.40086889266967773  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 412, 100]), torch.Size([1, 412, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.40117597579956055  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.42082929611206055  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 412, 100])
m.shape torch.Size([55068, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.6258201599121094  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.6258201599121094  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 55068, 100]), torch.Size([1, 55068, 100])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 0.667752742767334  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.580810070037842  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 55068, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.3691840171813965  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.4245333671569824  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.4798827171325684  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.4245333671569824  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([58038, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.4798827171325684  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.493720054626465  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.493720054626465  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

m.shape torch.Size([5, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.626272201538086  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.626272201538086  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.62628173828125  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6263580322265625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([22, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6263957023620605  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6263957023620605  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6264376640319824  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6270670890808105  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([64, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.627230644226074  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.627230644226074  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 64, 256]), torch.Size([1, 64, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.627352714538574  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.630038261413574  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 64, 256])
m.shape torch.Size([63, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6302194595336914  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6302194595336914  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 63, 256]), torch.Size([1, 63, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6303396224975586  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.633824348449707  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 63, 256])
m.shape torch.Size([80, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6341490745544434  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6341490745544434  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 80, 256]), torch.Size([1, 80, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6343016624450684  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6397948265075684  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 80, 256])
m.shape torch.Size([73, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.640139579772949  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.640139579772949  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 73, 256]), torch.Size([1, 73, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6402788162231445  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.646265983581543  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 73, 256])
m.shape torch.Size([91, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.646808624267578  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.646808624267578  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 91, 256]), torch.Size([1, 91, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.646982192993164  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.655660629272461  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 91, 256])
m.shape torch.Size([48, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.655942916870117  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.655942916870117  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 48, 256]), torch.Size([1, 48, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.656034469604492  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.661252975463867  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 48, 256])
m.shape torch.Size([22, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.661397933959961  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.661397933959961  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.661439895629883  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.664125442504883  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([49, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6645755767822266  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6645755767822266  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 49, 256]), torch.Size([1, 49, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6646690368652344  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.671304702758789  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 49, 256])
m.shape torch.Size([59, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.671882152557373  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.671882152557373  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 59, 256]), torch.Size([1, 59, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.671994686126709  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.680772304534912  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 59, 256])
m.shape torch.Size([36, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.681131362915039  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.681131362915039  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 36, 256]), torch.Size([1, 36, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6812000274658203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6870365142822266  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 36, 256])
m.shape torch.Size([51, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6876397132873535  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6876397132873535  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 51, 256]), torch.Size([1, 51, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.687736988067627  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.696686267852783  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 51, 256])
m.shape torch.Size([98, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6984643936157227  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6984643936157227  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 98, 256]), torch.Size([1, 98, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.6986513137817383  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.717156410217285  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 98, 256])
m.shape torch.Size([31, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.717510223388672  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.717510223388672  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 31, 256]), torch.Size([1, 31, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.717569351196289  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.723836898803711  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 31, 256])
m.shape torch.Size([60, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7247300148010254  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7247300148010254  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 60, 256]), torch.Size([1, 60, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.724844455718994  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.737776279449463  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 60, 256])
m.shape torch.Size([45, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7384543418884277  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7384543418884277  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7385401725769043  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.748839855194092  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([29, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7492990493774414  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7492990493774414  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 29, 256]), torch.Size([1, 29, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.749354362487793  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7563791275024414  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 29, 256])
m.shape torch.Size([19, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7566986083984375  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7566986083984375  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 19, 256]), torch.Size([1, 19, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.756734848022461  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7615909576416016  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 19, 256])
m.shape torch.Size([22, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.761995792388916  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.761995792388916  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 22, 256]), torch.Size([1, 22, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.762037754058838  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7679543495178223  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 22, 256])
m.shape torch.Size([37, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7686805725097656  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7686805725097656  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 37, 256]), torch.Size([1, 37, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7687511444091797  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.779195785522461  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 37, 256])
m.shape torch.Size([38, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7799644470214844  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7799644470214844  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 38, 256]), torch.Size([1, 38, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7800369262695312  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.791271209716797  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 38, 256])
m.shape torch.Size([45, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7922468185424805  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.7922468185424805  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 45, 256]), torch.Size([1, 45, 256])
----------------------------------------3
 Nvidia-smi: 13.7049560546875 GB
    Memory Allocated: 3.792332649230957  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7166748046875 GB
    Memory Allocated: 3.80623722076416  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 45, 256])
m.shape torch.Size([66, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.7166748046875 GB
    Memory Allocated: 3.8080224990844727  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7166748046875 GB
    Memory Allocated: 3.8080224990844727  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 66, 256]), torch.Size([1, 66, 256])
----------------------------------------3
 Nvidia-smi: 13.7166748046875 GB
    Memory Allocated: 3.8081483840942383  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7381591796875 GB
    Memory Allocated: 3.829422950744629  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 66, 256])
m.shape torch.Size([4950, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.7401123046875 GB
    Memory Allocated: 3.9482994079589844  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7401123046875 GB
    Memory Allocated: 3.9482994079589844  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 4950, 256]), torch.Size([1, 4950, 256])
----------------------------------------3
 Nvidia-smi: 13.7401123046875 GB
    Memory Allocated: 3.959437847137451  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7401123046875 GB
    Memory Allocated: 5.643474102020264  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 4950, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7401123046875 GB
    Memory Allocated: 5.512869834899902  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7401123046875 GB
    Memory Allocated: 5.514641761779785  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7401123046875 GB
    Memory Allocated: 5.516496181488037  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7401123046875 GB
    Memory Allocated: 5.514678478240967  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([6103, 47])
input nodes number: 58038
output nodes number: 6103
edges number: 137651
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7401123046875 GB
    Memory Allocated: 5.514317035675049  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.7401123046875 GB
    Memory Allocated: 5.514317512512207  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.10859918594360352  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

pseudo mini batch 24 input nodes size: 196254
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.09308910369873047  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.09308910369873047  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.1661996841430664  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.16624689102172852  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.0793142318725586  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.08545112609863281  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.08545112609863281  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

first layer input nodes number: 196254
first layer output nodes number: 67058
edges number: 665851
----------------------------------------before model layer 0
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.08780527114868164  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([196254, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.08780527114868164  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

m.shape torch.Size([52, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34284114837646484  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34284114837646484  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 52, 100]), torch.Size([1, 52, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3428802490234375  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34319162368774414  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 52, 100])
m.shape torch.Size([86, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34323644638061523  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34323644638061523  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 86, 100]), torch.Size([1, 86, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34330129623413086  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3442654609680176  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 86, 100])
m.shape torch.Size([75, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3443169593811035  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3443169593811035  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 75, 100]), torch.Size([1, 75, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3443732261657715  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34560680389404297  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 75, 100])
m.shape torch.Size([105, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3457355499267578  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3457355499267578  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 105, 100]), torch.Size([1, 105, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34581470489501953  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34809303283691406  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 105, 100])
m.shape torch.Size([135, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34830522537231445  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34830522537231445  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 135, 100]), torch.Size([1, 135, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3484063148498535  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.35203123092651367  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 135, 100])
m.shape torch.Size([147, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3523097038269043  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3523097038269043  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 147, 100]), torch.Size([1, 147, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.352419376373291  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3571352958679199  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 147, 100])
m.shape torch.Size([192, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.35758113861083984  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.35758113861083984  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 192, 100]), torch.Size([1, 192, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3577241897583008  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.36487674713134766  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 192, 100])
m.shape torch.Size([180, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3653416633605957  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3653416633605957  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 180, 100]), torch.Size([1, 180, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.365476131439209  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.37312936782836914  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 180, 100])
m.shape torch.Size([219, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3737964630126953  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3737964630126953  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 219, 100]), torch.Size([1, 219, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3739604949951172  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.38441991806030273  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 219, 100])
m.shape torch.Size([65867, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.6297116279602051  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.6297116279602051  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 65867, 100]), torch.Size([1, 65867, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.6787867546081543  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.163106441497803  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 65867, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.9153361320495605  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.979287624359131  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.043239116668701  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.979287624359131  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([67058, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.043239116668701  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.059226989746094  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.059226989746094  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.2111124992370605  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.2111124992370605  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.211114406585693  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.211129665374756  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.2111358642578125  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.2111358642578125  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.211137771606445  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.211233139038086  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.211249828338623  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.211249828338623  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.211253643035889  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.211497783660889  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.211517333984375  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.211517333984375  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.211521148681641  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.211818695068359  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.211828708648682  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.211828708648682  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.2118306159973145  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.2119927406311035  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.212032318115234  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.212032318115234  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.212038040161133  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.212604522705078  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.212630748748779  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.212630748748779  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.212634563446045  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.213038921356201  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.213054656982422  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.213054656982422  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.213056564331055  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.213298797607422  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.213352680206299  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.213352680206299  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.213358402252197  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.214125156402588  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.214160919189453  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.214160919189453  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.214164733886719  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.214702606201172  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.214721202850342  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.214721202850342  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.214723110198975  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.215005397796631  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.2150468826293945  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.2150468826293945  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.21505069732666  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.215641975402832  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.215663433074951  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.215663433074951  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.215665340423584  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.215987682342529  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([6297, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.368068695068359  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.368068695068359  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 6297, 256]), torch.Size([1, 6297, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.38007926940918  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 6.495922088623047  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 6297, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 6.345353126525879  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 6.346826553344727  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 6.348341941833496  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 6.346821308135986  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([6319, 47])
input nodes number: 67058
output nodes number: 6319
edges number: 157761
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 6.34777307510376  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 6.347773551940918  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.09659337997436523  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

pseudo mini batch 25 input nodes size: 218034
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.07971906661987305  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.07971906661987305  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.16094350814819336  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.16098833084106445  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.0878305435180664  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.09328842163085938  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.09328842163085938  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

first layer input nodes number: 218034
first layer output nodes number: 59575
edges number: 585164
----------------------------------------before model layer 0
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.0960383415222168  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([218034, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.0960383415222168  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

m.shape torch.Size([89, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3202080726623535  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3202080726623535  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 89, 100]), torch.Size([1, 89, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.32027482986450195  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.32080745697021484  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 89, 100])
m.shape torch.Size([142, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3208799362182617  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3208799362182617  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 142, 100]), torch.Size([1, 142, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3209857940673828  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3225736618041992  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 142, 100])
m.shape torch.Size([192, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3227353096008301  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3227353096008301  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 192, 100]), torch.Size([1, 192, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.322878360748291  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.32602548599243164  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 192, 100])
m.shape torch.Size([269, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.32635498046875  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.32635498046875  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 269, 100]), torch.Size([1, 269, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3265562057495117  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.33237457275390625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 269, 100])
m.shape torch.Size([329, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3328871726989746  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3328871726989746  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 329, 100]), torch.Size([1, 329, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3331332206726074  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34196949005126953  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 329, 100])
m.shape torch.Size([399, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34273862838745117  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34273862838745117  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 399, 100]), torch.Size([1, 399, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3430361747741699  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3558220863342285  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 399, 100])
m.shape torch.Size([392, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.35669565200805664  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.35669565200805664  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 392, 100]), torch.Size([1, 392, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.35698843002319336  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3715972900390625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 392, 100])
m.shape torch.Size([424, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3727145195007324  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3727145195007324  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 424, 100]), torch.Size([1, 424, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3730311393737793  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.39104413986206055  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 424, 100])
m.shape torch.Size([426, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.39281129837036133  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.39281129837036133  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 426, 100]), torch.Size([1, 426, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3931288719177246  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.4134535789489746  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 426, 100])
m.shape torch.Size([56913, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.625312328338623  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.625312328338623  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 56913, 100]), torch.Size([1, 56913, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.6677165031433105  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.678384304046631  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 56913, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.460263252258301  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.517078399658203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.5738935470581055  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.517078399658203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([59575, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.5738935470581055  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.5884385108947754  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.5884385108947754  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7304162979125977  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7304162979125977  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7304182052612305  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.730433464050293  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.730438709259033  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.730438709259033  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7304444313049316  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.730530261993408  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7305450439453125  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7305450439453125  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7305564880371094  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7308082580566406  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.730825901031494  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.730825901031494  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.730837345123291  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7311692237854004  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([9, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7312068939208984  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7312068939208984  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7312240600585938  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.731842041015625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([4, 6, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7318568229675293  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7318568229675293  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7318644523620605  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7321925163269043  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([12, 7, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.732269763946533  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.732269763946533  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.732292652130127  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7334370613098145  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([11, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7335104942321777  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7335104942321777  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7335314750671387  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.734727382659912  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([12, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.73482084274292  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.73482084274292  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7348437309265137  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7363085746765137  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7364320755004883  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7364320755004883  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7364587783813477  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7383546829223633  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([7, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7384157180786133  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7384157180786133  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.738429069519043  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7394704818725586  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([8, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.739556312561035  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.739556312561035  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7395715713500977  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.74086856842041  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([6, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.740936279296875  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.740936279296875  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.740947723388672  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7420005798339844  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([10, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7421298027038574  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7421298027038574  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7421488761901855  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.74403715133667  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([8, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.744143009185791  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.744143009185791  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7441582679748535  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7457756996154785  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([13, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7459683418273926  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7459683418273926  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.745993137359619  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7487950325012207  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([13, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.748995304107666  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.748995304107666  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7490200996398926  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.75199556350708  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([15, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7522430419921875  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7522430419921875  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7522716522216797  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7559051513671875  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([12, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.756110191345215  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.756110191345215  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7561330795288086  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.759200096130371  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([23, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7596311569213867  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7596311569213867  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 23, 256]), torch.Size([1, 23, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7596750259399414  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7658605575561523  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 23, 256])
m.shape torch.Size([12, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.766080856323242  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.766080856323242  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.766103744506836  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.769491195678711  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([15, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7697973251342773  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7697973251342773  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7698259353637695  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7742605209350586  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7745118141174316  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7745118141174316  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7745347023010254  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.778242588043213  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([20, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7786927223205566  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.7786927223205566  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 20, 256]), torch.Size([1, 20, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.778730869293213  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.785177707672119  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 20, 256])
m.shape torch.Size([5739, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.9232311248779297  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.9232311248779297  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 5739, 256]), torch.Size([1, 5739, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.9341773986816406  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 5.861428260803223  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 5739, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 5.720901966094971  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 5.722146034240723  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 5.723662376403809  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 5.7223734855651855  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([5991, 47])
input nodes number: 59575
output nodes number: 5991
edges number: 147249
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 5.722632884979248  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 5.722633361816406  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.10332012176513672  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

pseudo mini batch 26 input nodes size: 217901
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.0876011848449707  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.0876011848449707  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.1687760353088379  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.1688232421875  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.0875539779663086  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.09357261657714844  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.09357261657714844  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

first layer input nodes number: 217901
first layer output nodes number: 65559
edges number: 650905
----------------------------------------before model layer 0
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.09568500518798828  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([217901, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.09568500518798828  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

m.shape torch.Size([85, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34514284133911133  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34514284133911133  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 85, 100]), torch.Size([1, 85, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34520673751831055  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3457150459289551  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 85, 100])
m.shape torch.Size([98, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34575653076171875  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34575653076171875  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 98, 100]), torch.Size([1, 98, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34582996368408203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34692859649658203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 98, 100])
m.shape torch.Size([67, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3469672203063965  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3469672203063965  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 67, 100]), torch.Size([1, 67, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.347017765045166  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34812116622924805  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 67, 100])
m.shape torch.Size([99, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34824371337890625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34824371337890625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 99, 100]), torch.Size([1, 99, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.34831809997558594  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3504638671875  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 99, 100])
m.shape torch.Size([124, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.35065793991088867  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.35065793991088867  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 124, 100]), torch.Size([1, 124, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3507504463195801  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3540806770324707  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 124, 100])
m.shape torch.Size([134, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.35433435440063477  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.35433435440063477  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 134, 100]), torch.Size([1, 134, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3544344902038574  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.358731746673584  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 134, 100])
m.shape torch.Size([133, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.35902881622314453  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.35902881622314453  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 133, 100]), torch.Size([1, 133, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3591279983520508  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3640871047973633  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 133, 100])
m.shape torch.Size([158, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.36450862884521484  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.36450862884521484  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 158, 100]), torch.Size([1, 158, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3646268844604492  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.37134456634521484  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 158, 100])
m.shape torch.Size([202, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3719630241394043  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3719630241394043  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 202, 100]), torch.Size([1, 202, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3721137046813965  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3817572593688965  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 202, 100])
m.shape torch.Size([64459, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.6219162940979004  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.6219162940979004  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 64459, 100]), torch.Size([1, 64459, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.6699423789978027  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.080233573913574  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 64459, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.8369297981262207  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.899451732635498  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.9619736671447754  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.899451732635498  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([65559, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.9619736671447754  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.977825164794922  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.977825164794922  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.128724098205566  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.128724098205566  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.128726005554199  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.128781318664551  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 5, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.128785610198975  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.128785610198975  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.128787517547607  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.128856182098389  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 8, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.1288862228393555  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.1288862228393555  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.128893852233887  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.129328727722168  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.129342555999756  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.129342555999756  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.1293463706970215  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.1295905113220215  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 10, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.129617691040039  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.129617691040039  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.1296234130859375  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.130029678344727  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.130069255828857  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.130069255828857  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.130076885223389  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.130671977996826  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.130714416503906  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.130714416503906  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.1307220458984375  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.131370544433594  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.1314167976379395  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.1314167976379395  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.131424427032471  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.132126331329346  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 14, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.132163047790527  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.132163047790527  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.132168769836426  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.132735252380371  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.132833480834961  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.132833480834961  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.132846832275391  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.1342620849609375  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([2, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.134286403656006  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.134286403656006  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.1342902183532715  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.134721279144287  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 17, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.13475227355957  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.13475227355957  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.134756088256836  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.135213851928711  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([7, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.135333061218262  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.135333061218262  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.135346412658691  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.137042045593262  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([5, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.137126922607422  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.137126922607422  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.137136459350586  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.13841438293457  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([4, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.138486862182617  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.138486862182617  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.138494491577148  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.139570236206055  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.1397480964660645  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.1397480964660645  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.13976526260376  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.142305850982666  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.1424665451049805  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.1424665451049805  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.142481803894043  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.1448469161987305  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.144927978515625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.144927978515625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.144935607910156  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.146171569824219  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.146283149719238  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.146283149719238  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.146292686462402  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.147904396057129  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([6216, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.2972588539123535  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.2972588539123535  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 6216, 256]), torch.Size([1, 6216, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 4.309114933013916  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 6.397430896759033  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 6216, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 6.247898101806641  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 6.249569892883301  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 6.251317024230957  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 6.249598026275635  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([6295, 47])
input nodes number: 65559
output nodes number: 6295
edges number: 156724
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 6.250561714172363  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 6.2505621910095215  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.10447931289672852  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

pseudo mini batch 27 input nodes size: 173568
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.0879817008972168  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.0879817008972168  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.15264081954956055  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.15268802642822266  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.07146596908569336  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.0768580436706543  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.0768580436706543  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

first layer input nodes number: 173568
first layer output nodes number: 57141
edges number: 566332
----------------------------------------before model layer 0
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.07857704162597656  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([173568, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.07857704162597656  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

m.shape torch.Size([59, 1, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.2955045700073242  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.2955045700073242  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 59, 100]), torch.Size([1, 59, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.2955493927001953  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.29590368270874023  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 59, 100])
m.shape torch.Size([82, 2, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.2959427833557129  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.2959427833557129  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 82, 100]), torch.Size([1, 82, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.2960047721862793  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.29692602157592773  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 82, 100])
m.shape torch.Size([107, 3, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.2970147132873535  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.2970147132873535  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 107, 100]), torch.Size([1, 107, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.29709482192993164  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.29885292053222656  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 107, 100])
m.shape torch.Size([119, 4, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.29899024963378906  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.29899024963378906  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 119, 100]), torch.Size([1, 119, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.29907894134521484  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3016510009765625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 119, 100])
m.shape torch.Size([149, 5, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.30188465118408203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.30188465118408203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 149, 100]), torch.Size([1, 149, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.30199623107910156  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3059988021850586  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 149, 100])
m.shape torch.Size([153, 6, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.30628538131713867  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.30628538131713867  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 153, 100]), torch.Size([1, 153, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3063998222351074  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.311312198638916  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 153, 100])
m.shape torch.Size([165, 7, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.31168556213378906  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.31168556213378906  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 165, 100]), torch.Size([1, 165, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.31180858612060547  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3179597854614258  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 165, 100])
m.shape torch.Size([188, 8, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.31845855712890625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.31845855712890625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 188, 100]), torch.Size([1, 188, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.31859874725341797  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.32658958435058594  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 188, 100])
m.shape torch.Size([200, 9, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3271903991699219  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3271903991699219  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 200, 100]), torch.Size([1, 200, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.32734012603759766  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.3368840217590332  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 200, 100])
m.shape torch.Size([55919, 10, 100])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.5451240539550781  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.5451240539550781  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 55919, 100]), torch.Size([1, 55919, 100])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.586787223815918  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.544857978820801  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 55919, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.3332653045654297  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.387759208679199  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.4422531127929688  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.387759208679199  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([57141, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.4422531127929688  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.4558768272399902  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.4558768272399902  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

m.shape torch.Size([1, 1, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6073269844055176  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6073269844055176  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6073288917541504  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.607344150543213  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 2, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6073474884033203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6073474884033203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.607351303100586  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6074085235595703  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.607409954071045  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.607409954071045  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6074118614196777  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6074538230895996  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.607457160949707  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.607457160949707  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.60745906829834  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6075143814086914  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([6, 9, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.607565402984619  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.607565402984619  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.607576847076416  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.608309268951416  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 11, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.608335494995117  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.608335494995117  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6083412170410156  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6087875366210938  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([9, 12, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.608888626098633  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.608888626098633  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.608905792236328  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6103649139404297  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([1, 13, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6103692054748535  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6103692054748535  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6103711128234863  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.610546588897705  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 15, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.610574722290039  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.610574722290039  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6105785369873047  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.610982894897461  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.611027240753174  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.611027240753174  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6110329627990723  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6116795539855957  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 18, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6116943359375  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6116943359375  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.611696243286133  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6119384765625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([5, 19, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6120290756225586  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6120290756225586  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6120386123657227  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.613316535949707  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([1, 20, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6133313179016113  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6133313179016113  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.613333225250244  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6136021614074707  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 21, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6136417388916016  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6136417388916016  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.613645553588867  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6142101287841797  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 22, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.614272117614746  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.614272117614746  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6142778396606445  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6151647567749023  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 23, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.615206241607666  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.615206241607666  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.6152100563049316  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.615828037261963  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.615964889526367  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.615964889526367  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.615976333618164  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.617910385131836  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6263, 25, 256])
----------------------------------------1
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.768393039703369  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.768393039703369  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 6263, 256]), torch.Size([1, 6263, 256])
----------------------------------------3
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 3.780338764190674  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 5.882786273956299  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 6263, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 5.732674598693848  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 5.734193801879883  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 5.735806465148926  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 5.7342400550842285  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([6312, 47])
input nodes number: 57141
output nodes number: 6312
edges number: 157304
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 5.734560489654541  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 5.734560966491699  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.08591175079345703  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

pseudo mini batch 28 input nodes size: 260897
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.07131338119506836  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.07131338119506836  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.16850519180297852  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.16855239868164062  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.10384607315063477  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.11046838760375977  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.11046838760375977  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

first layer input nodes number: 260897
first layer output nodes number: 73822
edges number: 731545
----------------------------------------before model layer 0
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.11296272277832031  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([260897, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 13.7440185546875 GB
    Memory Allocated: 0.11296272277832031  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

m.shape torch.Size([82, 1, 100])
----------------------------------------1
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.3941988945007324  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.3941988945007324  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 82, 100]), torch.Size([1, 82, 100])
----------------------------------------3
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.39426088333129883  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.39475250244140625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 82, 100])
m.shape torch.Size([121, 2, 100])
----------------------------------------1
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.39481210708618164  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.39481210708618164  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 121, 100]), torch.Size([1, 121, 100])
----------------------------------------3
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.39490270614624023  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.3962588310241699  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 121, 100])
m.shape torch.Size([137, 3, 100])
----------------------------------------1
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.39636707305908203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.39636707305908203  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 137, 100]), torch.Size([1, 137, 100])
----------------------------------------3
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.3964700698852539  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.39872312545776367  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 137, 100])
m.shape torch.Size([131, 4, 100])
----------------------------------------1
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.398867130279541  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.398867130279541  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 131, 100]), torch.Size([1, 131, 100])
----------------------------------------3
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.39896535873413086  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.40180253982543945  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 131, 100])
m.shape torch.Size([183, 5, 100])
----------------------------------------1
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.40209436416625977  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.40209436416625977  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 183, 100]), torch.Size([1, 183, 100])
----------------------------------------3
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.40223073959350586  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.40714025497436523  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 183, 100])
m.shape torch.Size([185, 6, 100])
----------------------------------------1
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.4074859619140625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.4074859619140625  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 185, 100]), torch.Size([1, 185, 100])
----------------------------------------3
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.4076242446899414  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.4135618209838867  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 185, 100])
m.shape torch.Size([231, 7, 100])
----------------------------------------1
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.414095401763916  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.414095401763916  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 231, 100]), torch.Size([1, 231, 100])
----------------------------------------3
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.41426801681518555  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.4228787422180176  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 231, 100])
m.shape torch.Size([283, 8, 100])
----------------------------------------1
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.42363595962524414  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.42363595962524414  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 283, 100]), torch.Size([1, 283, 100])
----------------------------------------3
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.42384767532348633  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.4358811378479004  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 283, 100])
m.shape torch.Size([310, 9, 100])
----------------------------------------1
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.4368147850036621  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.4368147850036621  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 310, 100]), torch.Size([1, 310, 100])
----------------------------------------3
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.43704652786254883  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.4518394470214844  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 310, 100])
m.shape torch.Size([72159, 10, 100])
----------------------------------------1
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.7205371856689453  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.7205371856689453  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 72159, 100]), torch.Size([1, 72159, 100])
----------------------------------------3
 Nvidia-smi: 14.0174560546875 GB
    Memory Allocated: 0.7743005752563477  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.591458320617676  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 72159, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.31725549697876  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.387657642364502  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.458059787750244  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.387657642364502  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

torch.Size([73822, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.458059787750244  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.47566032409668  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.47566032409668  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

m.shape torch.Size([9, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.626994609832764  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.626994609832764  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.627011775970459  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.627269268035889  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([10, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.627289772033691  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.627289772033691  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.6273088455200195  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.627728462219238  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([1, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.627723217010498  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.627723217010498  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.627725124359131  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.627780437469482  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.62779426574707  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.62779426574707  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.627799987792969  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.6280059814453125  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([6, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.628037929534912  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.628037929534912  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.628049373626709  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.628541469573975  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.628559112548828  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.628559112548828  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.628564834594727  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.6288909912109375  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.6289143562316895  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.6289143562316895  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.628920078277588  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.629286289215088  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.629294395446777  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.629294395446777  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.62929630279541  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.6294450759887695  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.629478931427002  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.629478931427002  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.6294846534729  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.629971027374268  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.63001823425293  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.63001823425293  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.630025863647461  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.630727767944336  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([2, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.630753040313721  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.630753040313721  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.630756855010986  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.631161212921143  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.631190299987793  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.631190299987793  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.631194114685059  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.631625175476074  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.631689071655273  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.631689071655273  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.631696701049805  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.632612228393555  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([3, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.632660388946533  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.632660388946533  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.632666110992432  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.633392810821533  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([3, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.633444786071777  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.633444786071777  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.633450508117676  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.634217262268066  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([4, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.634291648864746  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.634291648864746  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.634299278259277  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.635375022888184  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([9, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.635552883148193  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.635552883148193  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.635570049285889  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.638110637664795  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.638186931610107  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.638186931610107  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.638194561004639  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.639377117156982  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.639461994171143  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.639461994171143  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.639469623565674  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.640705585479736  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.640840530395508  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.640840530395508  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.640851974487305  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.642786026000977  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6243, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.7934746742248535  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.7934746742248535  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

 h.shape torch.Size([1, 6243, 256]), torch.Size([1, 6243, 256])
----------------------------------------3
 Nvidia-smi: 15.0526123046875 GB
    Memory Allocated: 4.8056464195251465  GigaBytes
Max Memory Allocated: 7.0033769607543945  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.902518272399902  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 6243, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.752571105957031  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.7538628578186035  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.755452632904053  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.754113674163818  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

torch.Size([6327, 47])
input nodes number: 73822
output nodes number: 6327
edges number: 157162
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.754483699798584  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.754484176635742  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.12180948257446289  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

pseudo mini batch 29 input nodes size: 206090
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.10361862182617188  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.10361862182617188  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.18039321899414062  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.18043851852416992  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.08319950103759766  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.08899593353271484  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.08899593353271484  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

first layer input nodes number: 206090
first layer output nodes number: 63339
edges number: 627505
----------------------------------------before model layer 0
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.0910038948059082  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

torch.Size([206090, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.0910038948059082  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

m.shape torch.Size([76, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.33136892318725586  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.33136892318725586  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 76, 100]), torch.Size([1, 76, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.33142614364624023  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.331881046295166  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 76, 100])
m.shape torch.Size([96, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3319239616394043  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3319239616394043  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 96, 100]), torch.Size([1, 96, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.33199548721313477  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3330683708190918  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 96, 100])
m.shape torch.Size([118, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.33316469192504883  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.33316469192504883  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 118, 100]), torch.Size([1, 118, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3332533836364746  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3351917266845703  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 118, 100])
m.shape torch.Size([137, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.33535194396972656  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.33535194396972656  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 137, 100]), torch.Size([1, 137, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.33545494079589844  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3384246826171875  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 137, 100])
m.shape torch.Size([152, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3386564254760742  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3386564254760742  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 152, 100]), torch.Size([1, 152, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.33876991271972656  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3428483009338379  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 152, 100])
m.shape torch.Size([174, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.34318065643310547  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.34318065643310547  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 174, 100]), torch.Size([1, 174, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3433103561401367  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.34888744354248047  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 174, 100])
m.shape torch.Size([209, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.349367618560791  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.349367618560791  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 209, 100]), torch.Size([1, 209, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.34952402114868164  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.35732412338256836  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 209, 100])
m.shape torch.Size([220, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.35790157318115234  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.35790157318115234  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 220, 100]), torch.Size([1, 220, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3580656051635742  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3674154281616211  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 220, 100])
m.shape torch.Size([262, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3682122230529785  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3682122230529785  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 262, 100]), torch.Size([1, 262, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3684077262878418  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3809070587158203  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 262, 100])
m.shape torch.Size([61895, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.6113862991333008  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.6113862991333008  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 61895, 100]), torch.Size([1, 61895, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.6582612991333008  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.940810203552246  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 61895, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.705634593963623  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.7660393714904785  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.826444149017334  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.7660393714904785  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

torch.Size([63339, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.826444149017334  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.841635227203369  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.841635227203369  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9864253997802734  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9864253997802734  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9864273071289062  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9864559173583984  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([4, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.986466884613037  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.986466884613037  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9864745140075684  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.986642360687256  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([4, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.986654281616211  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.986654281616211  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.986661911010742  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9868831634521484  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.986884593963623  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.986884593963623  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.986886501312256  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.986955165863037  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9869699478149414  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9869699478149414  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.986973762512207  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9871912002563477  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.987215518951416  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.987215518951416  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9872212409973145  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9875874519348145  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9875946044921875  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9875946044921875  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9875965118408203  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.98773193359375  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([10, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9878463745117188  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9878463745117188  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.987865447998047  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9894866943359375  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([15, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9896650314331055  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9896650314331055  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9896936416625977  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.992325782775879  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([1, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9923253059387207  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9923253059387207  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9923272132873535  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.992516040802002  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9925460815429688  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9925460815429688  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9925498962402344  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.99298095703125  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.993011951446533  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.993011951446533  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.993015766143799  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.993473529815674  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.99350643157959  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.99350643157959  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9935102462768555  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.99399471282959  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([15, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.994266986846924  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.994266986846924  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 15, 256]), torch.Size([1, 15, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.994295597076416  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.998129367828369  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 15, 256])
m.shape torch.Size([1, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9981346130371094  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9981346130371094  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.998136520385742  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9984054565429688  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.998465061187744  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.998465061187744  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9984707832336426  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9993176460266113  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([13, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9996023178100586  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.9996023178100586  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 13, 256]), torch.Size([1, 13, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.999627113342285  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.003643989562988  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 13, 256])
m.shape torch.Size([4, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.003724098205566  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.003724098205566  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.003731727600098  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.005021095275879  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([5964, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.1483259201049805  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.1483259201049805  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 5964, 256]), torch.Size([1, 5964, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.159701347351074  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.211373329162598  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 5964, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.067899703979492  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.069174289703369  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.070693492889404  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.069373607635498  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

torch.Size([6048, 47])
input nodes number: 63339
output nodes number: 6048
edges number: 150382
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.069873809814453  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.069874286651611  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.09891605377197266  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

pseudo mini batch 30 input nodes size: 151568
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.08318233489990234  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.08318233489990234  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.13964605331420898  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.1396932601928711  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.06287336349487305  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.06825780868530273  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.06825780868530273  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

first layer input nodes number: 151568
first layer output nodes number: 57265
edges number: 565660
----------------------------------------before model layer 0
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.0699763298034668  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

torch.Size([151568, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.0699763298034668  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

m.shape torch.Size([89, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.2866630554199219  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.2866630554199219  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 89, 100]), torch.Size([1, 89, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.2867298126220703  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.2872624397277832  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 89, 100])
m.shape torch.Size([108, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.2873096466064453  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.2873096466064453  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 108, 100]), torch.Size([1, 108, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.28739070892333984  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.2886009216308594  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 108, 100])
m.shape torch.Size([116, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.28869009017944336  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.28869009017944336  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 116, 100]), torch.Size([1, 116, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.28877687454223633  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.2906818389892578  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 116, 100])
m.shape torch.Size([156, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.29087114334106445  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.29087114334106445  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 156, 100]), torch.Size([1, 156, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.290987491607666  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.29436159133911133  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 156, 100])
m.shape torch.Size([205, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.29468536376953125  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.29468536376953125  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 205, 100]), torch.Size([1, 205, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.29483890533447266  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.30034494400024414  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 205, 100])
m.shape torch.Size([212, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.30074214935302734  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.30074214935302734  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 212, 100]), torch.Size([1, 212, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3009004592895508  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.30769920349121094  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 212, 100])
m.shape torch.Size([255, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3082852363586426  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3082852363586426  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 255, 100]), torch.Size([1, 255, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.30847597122192383  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.31798267364501953  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 255, 100])
m.shape torch.Size([301, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3187847137451172  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3187847137451172  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 301, 100]), torch.Size([1, 301, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.31900978088378906  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3318042755126953  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 301, 100])
m.shape torch.Size([337, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3328218460083008  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3328218460083008  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 337, 100]), torch.Size([1, 337, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.33307361602783203  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.34916114807128906  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 337, 100])
m.shape torch.Size([55486, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.5557370185852051  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.5557370185852051  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 55486, 100]), torch.Size([1, 55486, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.5970778465270996  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.532248020172119  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 55486, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.321110725402832  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.375722885131836  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.43033504486084  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.375722885131836  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

torch.Size([57265, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.43033504486084  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.44398832321167  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.44398832321167  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

m.shape torch.Size([1, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5958147048950195  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5958147048950195  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5958166122436523  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.595858573913574  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5958657264709473  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5958657264709473  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.595869541168213  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.595980167388916  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.595992088317871  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.595992088317871  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5959959030151367  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.596186637878418  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.596200466156006  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.596200466156006  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5962042808532715  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.596421718597412  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.596454620361328  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.596454620361328  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5964622497558594  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5969505310058594  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([1, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.596956729888916  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.596956729888916  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.596958637237549  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5970940589904785  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([3, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5971250534057617  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5971250534057617  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.59713077545166  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5975770950317383  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([2, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.597597599029541  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.597597599029541  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5976014137268066  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5979256629943848  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([3, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.59796142578125  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.59796142578125  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5979671478271484  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5984935760498047  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([5, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5985584259033203  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5985584259033203  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5985679626464844  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5995121002197266  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([8, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5996227264404297  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.5996227264404297  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.599637985229492  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.601255416870117  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([10, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.6014018058776855  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.6014018058776855  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.6014208793640137  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.603576183319092  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([2, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.6035995483398438  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.6035995483398438  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.6036033630371094  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.6040611267089844  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([7, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.604180335998535  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.604180335998535  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.604193687438965  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.605889320373535  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([10, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.606065273284912  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.606065273284912  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.6060843467712402  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.608640193939209  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([9, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.6088037490844727  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.6088037490844727  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 9, 256]), torch.Size([1, 9, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.608820915222168  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.611241340637207  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 9, 256])
m.shape torch.Size([11, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.611454963684082  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.611454963684082  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 11, 256]), torch.Size([1, 11, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.611475944519043  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.6145811080932617  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 11, 256])
m.shape torch.Size([8, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.6147398948669434  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.6147398948669434  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 8, 256]), torch.Size([1, 8, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.614755153656006  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.6171202659606934  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 8, 256])
m.shape torch.Size([12, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.6173782348632812  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.6173782348632812  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 12, 256]), torch.Size([1, 12, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.617401123046875  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.6211090087890625  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 12, 256])
m.shape torch.Size([14, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.6214208602905273  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.6214208602905273  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 14, 256]), torch.Size([1, 14, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.6214475631713867  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.625960350036621  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 14, 256])
m.shape torch.Size([6193, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.776488780975342  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.776488780975342  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 6193, 256]), torch.Size([1, 6193, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 3.7883009910583496  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 5.867249965667725  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 6193, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 5.716825008392334  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 5.717936992645264  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 5.719048976898193  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 5.717889785766602  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

torch.Size([6309, 47])
input nodes number: 57265
output nodes number: 6309
edges number: 156907
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 5.718201160430908  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 5.718201637268066  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.07729244232177734  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

pseudo mini batch 31 input nodes size: 268527
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.06271076202392578  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.06271076202392578  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.16274499893188477  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

<class 'torch.Tensor'>
----------------------------------------after  batch labels to device
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.16279220581054688  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.10628128051757812  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.11372613906860352  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.11372613906860352  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

first layer input nodes number: 268527
first layer output nodes number: 72953
edges number: 723501
----------------------------------------before model layer 0
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.11627054214477539  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

torch.Size([268527, 100])
----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.11627054214477539  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

m.shape torch.Size([59, 1, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.39339447021484375  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.39339447021484375  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 59, 100]), torch.Size([1, 59, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.39343929290771484  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.39379358291625977  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 59, 100])
m.shape torch.Size([99, 2, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3938450813293457  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3938450813293457  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 99, 100]), torch.Size([1, 99, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3939194679260254  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.39502954483032227  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 99, 100])
m.shape torch.Size([115, 3, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.39512109756469727  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.39512109756469727  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 115, 100]), torch.Size([1, 115, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.39520692825317383  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3970952033996582  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 115, 100])
m.shape torch.Size([151, 4, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3972773551940918  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.3972773551940918  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 151, 100]), torch.Size([1, 151, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.39738988876342773  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.4006533622741699  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 151, 100])
m.shape torch.Size([163, 5, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.40090084075927734  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.40090084075927734  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 163, 100]), torch.Size([1, 163, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.40102291107177734  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.40540313720703125  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 163, 100])
m.shape torch.Size([181, 6, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.4057469367980957  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.4057469367980957  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 181, 100]), torch.Size([1, 181, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.4058823585510254  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.41168832778930664  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 181, 100])
m.shape torch.Size([240, 7, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.4122467041015625  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.4122467041015625  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 240, 100]), torch.Size([1, 240, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.4124259948730469  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.4213705062866211  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 240, 100])
m.shape torch.Size([243, 8, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.42200517654418945  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.42200517654418945  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 243, 100]), torch.Size([1, 243, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.42218637466430664  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.43251466751098633  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 243, 100])
m.shape torch.Size([250, 9, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.43326234817504883  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.43326234817504883  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 250, 100]), torch.Size([1, 250, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.43344926834106445  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.4453864097595215  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 250, 100])
m.shape torch.Size([71452, 10, 100])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.7114725112915039  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.7114725112915039  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 71452, 100]), torch.Size([1, 71452, 100])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.7647085189819336  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.5568132400512695  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 71452, 100])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.286475658416748  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.356049060821533  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.425622463226318  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.356049060821533  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

torch.Size([72953, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.425622463226318  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.443016052246094  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------before graph.update_all(msg_fn, self._lstm_reducer)
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.443016052246094  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

m.shape torch.Size([1, 2, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.594045639038086  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.594045639038086  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 1, 256]), torch.Size([1, 1, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.594047546386719  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.594076156616211  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 1, 256])
m.shape torch.Size([2, 3, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.594081401824951  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.594081401824951  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.594085216522217  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.5941691398620605  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 4, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.59419059753418  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.59419059753418  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.594202041625977  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.594533920288086  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6, 5, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.594557285308838  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.594557285308838  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.594568729400635  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.594980716705322  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([5, 6, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.595004081726074  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.595004081726074  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.595013618469238  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.595423698425293  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([7, 7, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.595466136932373  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.595466136932373  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.595479488372803  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.596147060394287  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([2, 8, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.596156120300293  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.596156120300293  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.596159934997559  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.596377372741699  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([10, 9, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.596462249755859  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.596462249755859  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 10, 256]), torch.Size([1, 10, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.5964813232421875  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.5977020263671875  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 10, 256])
m.shape torch.Size([4, 10, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.597731113433838  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.597731113433838  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.597738742828369  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.598280429840088  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([6, 11, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.5983405113220215  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.5983405113220215  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.598351955413818  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.599244594573975  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([7, 12, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.599319934844971  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.599319934844971  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.5993332862854  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.600468158721924  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 13, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.600536823272705  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.600536823272705  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.600548267364502  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.6016011238098145  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 14, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.601622581481934  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.601622581481934  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.601626396179199  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.602004051208496  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([6, 15, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.602088928222656  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.602088928222656  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.602100372314453  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.603313446044922  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([3, 16, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.603353977203369  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.603353977203369  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 3, 256]), torch.Size([1, 3, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.603359699249268  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.604006290435791  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 3, 256])
m.shape torch.Size([7, 17, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.6041178703308105  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.6041178703308105  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.60413122177124  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.605733394622803  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 18, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.605830669403076  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.605830669403076  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.605842113494873  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.607295513153076  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([2, 19, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.607326507568359  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.607326507568359  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.607330322265625  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.607841491699219  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([5, 20, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.607935905456543  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.607935905456543  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 5, 256]), torch.Size([1, 5, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.607945442199707  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.60929012298584  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 5, 256])
m.shape torch.Size([2, 21, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.609325885772705  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.609325885772705  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 2, 256]), torch.Size([1, 2, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.609329700469971  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.609894275665283  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 2, 256])
m.shape torch.Size([4, 22, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.6099772453308105  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.6099772453308105  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 4, 256]), torch.Size([1, 4, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.609984874725342  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.6111674308776855  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 4, 256])
m.shape torch.Size([7, 23, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.611318588256836  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.611318588256836  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 7, 256]), torch.Size([1, 7, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.611331939697266  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.613494873046875  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 7, 256])
m.shape torch.Size([6, 24, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.613626956939697  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.613626956939697  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 6, 256]), torch.Size([1, 6, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.613638401031494  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.615572452545166  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 6, 256])
m.shape torch.Size([6215, 25, 256])
----------------------------------------1
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.765101432800293  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------2
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.765101432800293  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

 h.shape torch.Size([1, 6215, 256]), torch.Size([1, 6215, 256])
----------------------------------------3
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 4.776955604553223  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------4
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.8641204833984375  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

rst.shape  torch.Size([1, 6215, 256])
----------------------------------------after graph.update_all
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.714487552642822  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after h_neigh = self.fc_neigh
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.715820789337158  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------after rst
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.717360973358154  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.715980529785156  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

torch.Size([6327, 47])
input nodes number: 72953
output nodes number: 6327
edges number: 156856
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.716792583465576  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 6.716793060302734  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.1253795623779297  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.13046646118164062  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.2030029296875 GB
    Memory Allocated: 0.13046646118164062  GigaBytes
Max Memory Allocated: 7.051362991333008  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04783666133880615 |0.01590004563331604 |0.16143883764743805 |9.359419345855713e-05 |0.07925793528556824 |0.005306720733642578 |
----------------------------------------------------------pseudo_mini_loss sum 5.388237476348877
Total (block generation + training)time/epoch 80.17998576164246
* Pure training time/epoch 9.750173091888428
Training time/epoch 9.910694599151611
Training time without block to device /epoch 9.401893138885498
Training time without total dataloading part /epoch 7.710598468780518
load block tensor time/epoch 1.5307731628417969
block to device time/epoch 0.5088014602661133
input features size transfer per epoch 4.291534423828125e-06
blocks size to device per epoch 2.86102294921875e-06
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8242191
Number of first layer input nodes during this epoch:  6362014
Number of first layer output nodes during this epoch:  1880177
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (lstm): LSTM(256, 256, batch_first=True)
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  682400
trainable parameters
layers.0.lstm.weight_ih_l0, torch.Size([400, 100])
layers.0.lstm.weight_hh_l0, torch.Size([400, 100])
layers.0.lstm.bias_ih_l0, torch.Size([400])
layers.0.lstm.bias_hh_l0, torch.Size([400])
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.lstm.weight_ih_l0, torch.Size([1024, 256])
layers.1.lstm.weight_hh_l0, torch.Size([1024, 256])
layers.1.lstm.bias_ih_l0, torch.Size([1024])
layers.1.lstm.bias_hh_l0, torch.Size([1024])
layers.1.fc_self.weight, torch.Size([47, 256])
layers.1.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters

Partition a graph with 196571 nodes and 51547892 edges into 32 parts and get 8362215 edge cuts