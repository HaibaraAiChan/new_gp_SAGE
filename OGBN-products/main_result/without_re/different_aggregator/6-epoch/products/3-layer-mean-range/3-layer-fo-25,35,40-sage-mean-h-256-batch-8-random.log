main start at this time 1656645352.0716324
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.4591178894042969
number of batches is  8
batch size is  24572
range selection method spend 0.0305633544921875
time for parepare:  0.28535938262939453
local_output_nid generation:  0.006039857864379883
local_in_edges_tensor generation:  0.028074264526367188
mini_batch_src_global generation:  0.029168128967285156
r_  generation:  0.411909818649292
local_output_nid generation:  0.007084846496582031
local_in_edges_tensor generation:  0.0158846378326416
mini_batch_src_global generation:  0.04149007797241211
r_  generation:  0.4730570316314697
local_output_nid generation:  0.006989240646362305
local_in_edges_tensor generation:  0.01084280014038086
mini_batch_src_global generation:  0.0327153205871582
r_  generation:  0.48476719856262207
local_output_nid generation:  0.007169961929321289
local_in_edges_tensor generation:  0.0068209171295166016
mini_batch_src_global generation:  0.03036355972290039
r_  generation:  0.5232539176940918
local_output_nid generation:  0.006988525390625
local_in_edges_tensor generation:  0.006834506988525391
mini_batch_src_global generation:  0.03402376174926758
r_  generation:  0.5490455627441406
local_output_nid generation:  0.007026195526123047
local_in_edges_tensor generation:  0.006864786148071289
mini_batch_src_global generation:  0.037303924560546875
r_  generation:  0.5672333240509033
local_output_nid generation:  0.007016181945800781
local_in_edges_tensor generation:  0.006604671478271484
mini_batch_src_global generation:  0.038646697998046875
r_  generation:  0.5804460048675537
local_output_nid generation:  0.007214069366455078
local_in_edges_tensor generation:  0.0067865848541259766
mini_batch_src_global generation:  0.03957247734069824
r_  generation:  0.5934853553771973
----------------------check_connections_block total spend ----------------------------- 5.6030213832855225
generate_one_block  2.0347793102264404
generate_one_block  0.5926973819732666
generate_one_block  0.5937473773956299
generate_one_block  0.5881588459014893
generate_one_block  0.5952332019805908
generate_one_block  0.5957977771759033
generate_one_block  0.5914549827575684
generate_one_block  0.596416711807251
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.111370086669922
gen group dst list time:  0.12195324897766113
time for parepare:  0.4557688236236572
local_output_nid generation:  0.10423135757446289
local_in_edges_tensor generation:  0.42877650260925293
mini_batch_src_global generation:  0.5391292572021484
r_  generation:  7.419247627258301
local_output_nid generation:  0.16325974464416504
local_in_edges_tensor generation:  0.4804060459136963
mini_batch_src_global generation:  0.7162346839904785
r_  generation:  7.4599268436431885
local_output_nid generation:  0.18210673332214355
local_in_edges_tensor generation:  0.614945650100708
mini_batch_src_global generation:  0.6621241569519043
r_  generation:  7.568187713623047
local_output_nid generation:  0.1665661334991455
local_in_edges_tensor generation:  0.9066839218139648
mini_batch_src_global generation:  0.6810343265533447
r_  generation:  7.603241443634033
local_output_nid generation:  0.19296646118164062
local_in_edges_tensor generation:  0.5132629871368408
mini_batch_src_global generation:  0.6958787441253662
r_  generation:  7.7610085010528564
local_output_nid generation:  0.17398810386657715
local_in_edges_tensor generation:  0.4469566345214844
mini_batch_src_global generation:  0.7327251434326172
r_  generation:  7.743861675262451
local_output_nid generation:  0.20177364349365234
local_in_edges_tensor generation:  0.5816240310668945
mini_batch_src_global generation:  0.7090730667114258
r_  generation:  7.642451763153076
local_output_nid generation:  0.17817378044128418
local_in_edges_tensor generation:  0.45923471450805664
mini_batch_src_global generation:  0.7624289989471436
r_  generation:  7.793172836303711
----------------------check_connections_block total spend ----------------------------- 82.66572880744934
generate_one_block  10.001686096191406
generate_one_block  9.616591215133667
generate_one_block  9.723325967788696
generate_one_block  9.807380199432373
generate_one_block  9.61547589302063
generate_one_block  9.889008045196533
generate_one_block  9.683290481567383
generate_one_block  9.926451206207275
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1526002883911133
gen group dst list time:  0.4793534278869629
time for parepare:  0.4706265926361084
local_output_nid generation:  0.43906402587890625
local_in_edges_tensor generation:  1.1008694171905518
mini_batch_src_global generation:  1.1023187637329102
r_  generation:  15.375606060028076
local_output_nid generation:  0.5250072479248047
local_in_edges_tensor generation:  1.0815672874450684
mini_batch_src_global generation:  1.4909789562225342
r_  generation:  15.689212560653687
local_output_nid generation:  0.5986006259918213
local_in_edges_tensor generation:  1.2505183219909668
mini_batch_src_global generation:  1.4145245552062988
r_  generation:  16.012068510055542
local_output_nid generation:  0.5700314044952393
local_in_edges_tensor generation:  1.1292288303375244
mini_batch_src_global generation:  1.5220322608947754
r_  generation:  15.993053913116455
local_output_nid generation:  0.6224894523620605
local_in_edges_tensor generation:  1.397475242614746
mini_batch_src_global generation:  1.542327880859375
r_  generation:  16.108269453048706
local_output_nid generation:  0.6244828701019287
local_in_edges_tensor generation:  1.231386423110962
mini_batch_src_global generation:  1.4969749450683594
r_  generation:  16.248356342315674
local_output_nid generation:  0.6379120349884033
local_in_edges_tensor generation:  1.2281086444854736
mini_batch_src_global generation:  1.4426333904266357
r_  generation:  16.329455375671387
local_output_nid generation:  0.5863156318664551
local_in_edges_tensor generation:  1.1747534275054932
mini_batch_src_global generation:  1.5166840553283691
r_  generation:  16.046324014663696
----------------------check_connections_block total spend ----------------------------- 176.149005651474
generate_one_block  21.086954832077026
generate_one_block  20.80004382133484
generate_one_block  20.7705557346344
generate_one_block  21.007769346237183
generate_one_block  20.97484040260315
generate_one_block  20.5722177028656
generate_one_block  21.748584747314453
generate_one_block  20.864206075668335
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

connection checking time:  258.81473445892334
block generation total time  246.08838176727295
average batch blocks generation time:  30.76104772090912
block dataloader generation time/epoch 534.5979261398315
pseudo mini batch 0 input nodes size: 2184321
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8319091796875 GB
    Memory Allocated: 0.8152217864990234  GigaBytes
Max Memory Allocated: 0.8152217864990234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8319091796875 GB
    Memory Allocated: 0.8154048919677734  GigaBytes
Max Memory Allocated: 0.8154048919677734  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8319091796875 GB
    Memory Allocated: 0.8154048919677734  GigaBytes
Max Memory Allocated: 0.8154048919677734  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 1.2219772338867188  GigaBytes
Max Memory Allocated: 1.2219772338867188  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 1.2219772338867188  GigaBytes
Max Memory Allocated: 1.2219772338867188  GigaBytes

first layer input nodes number: 2184321
first layer output nodes number: 1757516
edges number: 36323722
torch.Size([2184321, 100])
torch.Size([1757516, 256])
input nodes number: 1757516
output nodes number: 543239
edges number: 17316826
torch.Size([1757516, 256])
torch.Size([543239, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.3944091796875 GB
    Memory Allocated: 7.82873010635376  GigaBytes
Max Memory Allocated: 8.307074069976807  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.3944091796875 GB
    Memory Allocated: 7.833033561706543  GigaBytes
Max Memory Allocated: 8.307074069976807  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.8344740867614746  GigaBytes
Max Memory Allocated: 9.612425327301025  GigaBytes

pseudo mini batch 1 input nodes size: 2187967
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.8204770088195801  GigaBytes
Max Memory Allocated: 9.612425327301025  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 0.8204770088195801  GigaBytes
Max Memory Allocated: 9.612425327301025  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 1.6355586051940918  GigaBytes
Max Memory Allocated: 9.612425327301025  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.7908935546875 GB
    Memory Allocated: 1.6357417106628418  GigaBytes
Max Memory Allocated: 9.612425327301025  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.7908935546875 GB
    Memory Allocated: 0.8211054801940918  GigaBytes
Max Memory Allocated: 9.612425327301025  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.7908935546875 GB
    Memory Allocated: 1.22859525680542  GigaBytes
Max Memory Allocated: 9.612425327301025  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7908935546875 GB
    Memory Allocated: 1.22859525680542  GigaBytes
Max Memory Allocated: 9.612425327301025  GigaBytes

first layer input nodes number: 2187967
first layer output nodes number: 1763924
edges number: 36437797
torch.Size([2187967, 100])
torch.Size([1763924, 256])
input nodes number: 1763924
output nodes number: 543725
edges number: 17325594
torch.Size([1763924, 256])
torch.Size([543725, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8436279296875 GB
    Memory Allocated: 7.850519180297852  GigaBytes
Max Memory Allocated: 9.612425327301025  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8436279296875 GB
    Memory Allocated: 7.855138778686523  GigaBytes
Max Memory Allocated: 9.612425327301025  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.8385658264160156  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

pseudo mini batch 2 input nodes size: 2184923
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8211054801940918  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8211054801940918  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.6355586051940918  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.6357417106628418  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8204770088195801  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.22758150100708  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.22758150100708  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

first layer input nodes number: 2184923
first layer output nodes number: 1760383
edges number: 36372623
torch.Size([2184923, 100])
torch.Size([1760383, 256])
input nodes number: 1760383
output nodes number: 543718
edges number: 17339453
torch.Size([1760383, 256])
torch.Size([543718, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.840014934539795  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.84431791305542  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.8364429473876953  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

pseudo mini batch 3 input nodes size: 2187552
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8204770088195801  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8204770088195801  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.6354036331176758  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.6355867385864258  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8209505081176758  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.228494644165039  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.228494644165039  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

first layer input nodes number: 2187552
first layer output nodes number: 1760896
edges number: 36383449
torch.Size([2187552, 100])
torch.Size([1760896, 256])
input nodes number: 1760896
output nodes number: 545513
edges number: 17388829
torch.Size([1760896, 256])
torch.Size([545513, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.84788179397583  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.852184772491455  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.8380746841430664  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

pseudo mini batch 4 input nodes size: 2183944
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8217267990112305  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8217267990112305  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.6361799240112305  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.6363630294799805  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8212532997131348  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.2280001640319824  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.2280001640319824  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

first layer input nodes number: 2183944
first layer output nodes number: 1757126
edges number: 36326478
torch.Size([2183944, 100])
torch.Size([1757126, 256])
input nodes number: 1757126
output nodes number: 543946
edges number: 17335796
torch.Size([1757126, 256])
torch.Size([543946, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.831816673278809  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.836119651794434  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.8355770111083984  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

pseudo mini batch 5 input nodes size: 2185826
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8204770088195801  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8204770088195801  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.634760856628418  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.634943962097168  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.820307731628418  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.2281131744384766  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.2281131744384766  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

first layer input nodes number: 2185826
first layer output nodes number: 1762324
edges number: 36418536
torch.Size([2185826, 100])
torch.Size([1762324, 256])
input nodes number: 1762324
output nodes number: 545506
edges number: 17386727
torch.Size([1762324, 256])
torch.Size([545506, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.850383281707764  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.854686260223389  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.8372306823730469  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

pseudo mini batch 6 input nodes size: 2183857
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.820307731628418  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.820307731628418  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.634760856628418  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.634943962097168  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8204770088195801  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.227149486541748  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.227149486541748  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

first layer input nodes number: 2183857
first layer output nodes number: 1758941
edges number: 36326077
torch.Size([2183857, 100])
torch.Size([1758941, 256])
input nodes number: 1758941
output nodes number: 543941
edges number: 17328148
torch.Size([1758941, 256])
torch.Size([543941, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.836240768432617  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.840543746948242  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.835202693939209  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

pseudo mini batch 7 input nodes size: 2184266
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8204770088195801  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8204770088195801  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.6341795921325684  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.6343626976013184  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8197264671325684  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.227271556854248  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.227271556854248  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

first layer input nodes number: 2184266
first layer output nodes number: 1760640
edges number: 36383825
torch.Size([2184266, 100])
torch.Size([1760640, 256])
input nodes number: 1760640
output nodes number: 545320
edges number: 17385690
torch.Size([1760640, 256])
torch.Size([545320, 256])
torch.Size([24567, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.845325469970703  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.849627494812012  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.8377394676208496  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8392767906188965  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8392767906188965  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.40959039330482483 |0.5934525430202484 |0.202314555644989 |0.00017186999320983887 |0.037205904722213745 |0.002409696578979492 |
----------------------------------------------------------pseudo_mini_loss sum 7.1712822914123535
Total (block generation + training)time/epoch 544.7859885692596
Training time/epoch 10.187670707702637
Training time without block to device /epoch 5.440050363540649
Training time without total dataloading part /epoch 1.9199483394622803
load block tensor time/epoch 3.2767231464385986
block to device time/epoch 4.747620344161987
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  35919314
Number of first layer input nodes during this epoch:  17482656
Number of first layer output nodes during this epoch:  14081750
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8392763137817383  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.43187999725341797
number of batches is  8
batch size is  24572
range selection method spend 0.030190229415893555
time for parepare:  0.2839996814727783
local_output_nid generation:  0.00625300407409668
local_in_edges_tensor generation:  0.032911062240600586
mini_batch_src_global generation:  0.028404951095581055
r_  generation:  0.4110276699066162
local_output_nid generation:  0.00829172134399414
local_in_edges_tensor generation:  0.010373592376708984
mini_batch_src_global generation:  0.03898978233337402
r_  generation:  0.46739649772644043
local_output_nid generation:  0.0073451995849609375
local_in_edges_tensor generation:  0.0064547061920166016
mini_batch_src_global generation:  0.02615833282470703
r_  generation:  0.4877893924713135
local_output_nid generation:  0.007597208023071289
local_in_edges_tensor generation:  0.010731220245361328
mini_batch_src_global generation:  0.02969050407409668
r_  generation:  0.5241408348083496
local_output_nid generation:  0.007375240325927734
local_in_edges_tensor generation:  0.006691932678222656
mini_batch_src_global generation:  0.03327655792236328
r_  generation:  0.543022632598877
local_output_nid generation:  0.007434368133544922
local_in_edges_tensor generation:  0.006623983383178711
mini_batch_src_global generation:  0.036681413650512695
r_  generation:  0.5668675899505615
local_output_nid generation:  0.007539272308349609
local_in_edges_tensor generation:  0.006571769714355469
mini_batch_src_global generation:  0.03947591781616211
r_  generation:  0.5768606662750244
local_output_nid generation:  0.007482767105102539
local_in_edges_tensor generation:  0.009385108947753906
mini_batch_src_global generation:  0.03986835479736328
r_  generation:  0.6022348403930664
----------------------check_connections_block total spend ----------------------------- 5.597758769989014
generate_one_block  0.9877755641937256
generate_one_block  0.6394875049591064
generate_one_block  0.6105172634124756
generate_one_block  0.6529159545898438
generate_one_block  0.7277572154998779
generate_one_block  0.6067609786987305
generate_one_block  0.791823148727417
generate_one_block  0.6087467670440674
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.081268072128296
gen group dst list time:  0.1418285369873047
time for parepare:  0.4515388011932373
local_output_nid generation:  0.11218476295471191
local_in_edges_tensor generation:  0.48229312896728516
mini_batch_src_global generation:  0.5492737293243408
r_  generation:  7.523745059967041
local_output_nid generation:  0.18844866752624512
local_in_edges_tensor generation:  0.6960349082946777
mini_batch_src_global generation:  0.7424087524414062
r_  generation:  7.95995306968689
local_output_nid generation:  0.19569110870361328
local_in_edges_tensor generation:  0.537473201751709
mini_batch_src_global generation:  0.690821647644043
r_  generation:  7.734805107116699
local_output_nid generation:  0.17435002326965332
local_in_edges_tensor generation:  0.5194251537322998
mini_batch_src_global generation:  0.7303416728973389
r_  generation:  7.637822866439819
local_output_nid generation:  0.1896822452545166
local_in_edges_tensor generation:  0.5501630306243896
mini_batch_src_global generation:  0.812934398651123
r_  generation:  8.5891695022583
local_output_nid generation:  0.20360946655273438
local_in_edges_tensor generation:  0.6045160293579102
mini_batch_src_global generation:  0.7494103908538818
r_  generation:  7.985813856124878
local_output_nid generation:  0.1796424388885498
local_in_edges_tensor generation:  0.6040046215057373
mini_batch_src_global generation:  0.739281177520752
r_  generation:  7.656224012374878
local_output_nid generation:  0.19729375839233398
local_in_edges_tensor generation:  0.46835994720458984
mini_batch_src_global generation:  0.7494983673095703
r_  generation:  7.892169237136841
----------------------check_connections_block total spend ----------------------------- 85.42830848693848
generate_one_block  10.222878456115723
generate_one_block  9.834823846817017
generate_one_block  10.02351427078247
generate_one_block  9.806390285491943
generate_one_block  9.984039306640625
generate_one_block  9.679922342300415
generate_one_block  9.965188980102539
generate_one_block  9.69327998161316
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.191458225250244
gen group dst list time:  0.4972362518310547
time for parepare:  0.4695262908935547
local_output_nid generation:  0.4564957618713379
local_in_edges_tensor generation:  1.134739875793457
mini_batch_src_global generation:  1.1406223773956299
r_  generation:  16.119621515274048
local_output_nid generation:  0.5855004787445068
local_in_edges_tensor generation:  1.342341423034668
mini_batch_src_global generation:  1.6223783493041992
r_  generation:  15.962680578231812
local_output_nid generation:  0.5937271118164062
local_in_edges_tensor generation:  1.1787137985229492
mini_batch_src_global generation:  1.5472300052642822
r_  generation:  16.11387825012207
local_output_nid generation:  0.6089808940887451
local_in_edges_tensor generation:  1.2128674983978271
mini_batch_src_global generation:  1.5774948596954346
r_  generation:  15.857668399810791
local_output_nid generation:  0.6152694225311279
local_in_edges_tensor generation:  1.2177965641021729
mini_batch_src_global generation:  1.558969497680664
r_  generation:  16.167538166046143
local_output_nid generation:  0.6209404468536377
local_in_edges_tensor generation:  1.2457365989685059
mini_batch_src_global generation:  1.4853286743164062
r_  generation:  16.113253593444824
local_output_nid generation:  0.6310186386108398
local_in_edges_tensor generation:  1.221811056137085
mini_batch_src_global generation:  1.5440683364868164
r_  generation:  16.397599697113037
local_output_nid generation:  0.6318240165710449
local_in_edges_tensor generation:  1.2464849948883057
mini_batch_src_global generation:  1.5004730224609375
r_  generation:  16.121347665786743
----------------------check_connections_block total spend ----------------------------- 178.65824365615845
generate_one_block  21.031185626983643
generate_one_block  21.023083925247192
generate_one_block  21.027947187423706
generate_one_block  21.64703106880188
generate_one_block  21.00966739654541
generate_one_block  20.912853717803955
generate_one_block  20.97960662841797
generate_one_block  21.0118625164032
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8392763137817383  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

connection checking time:  264.0865521430969
block generation total time  247.85327553749084
average batch blocks generation time:  30.981659442186356
block dataloader generation time/epoch 538.117506980896
pseudo mini batch 0 input nodes size: 2184934
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8212618827819824  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8212618827819824  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6357150077819824  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6358981132507324  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8220124244689941  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2286372184753418  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2286372184753418  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

first layer input nodes number: 2184934
first layer output nodes number: 1758205
edges number: 36338635
torch.Size([2184934, 100])
torch.Size([1758205, 256])
input nodes number: 1758205
output nodes number: 543085
edges number: 17310368
torch.Size([1758205, 256])
torch.Size([543085, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.833512306213379  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.837815761566162  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.837784767150879  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

pseudo mini batch 1 input nodes size: 2186633
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.636599063873291  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.636782169342041  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822145938873291  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2303557395935059  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2303557395935059  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

first layer input nodes number: 2186633
first layer output nodes number: 1763992
edges number: 36434827
torch.Size([2186633, 100])
torch.Size([1763992, 256])
input nodes number: 1763992
output nodes number: 546586
edges number: 17422774
torch.Size([1763992, 256])
torch.Size([546586, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.8605875968933105  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.8648905754089355  GigaBytes
Max Memory Allocated: 9.645067691802979  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8402199745178223  GigaBytes
Max Memory Allocated: 9.647022724151611  GigaBytes

pseudo mini batch 2 input nodes size: 2187018
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822145938873291  GigaBytes
Max Memory Allocated: 9.647022724151611  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822145938873291  GigaBytes
Max Memory Allocated: 9.647022724151611  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.636873722076416  GigaBytes
Max Memory Allocated: 9.647022724151611  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.637056827545166  GigaBytes
Max Memory Allocated: 9.647022724151611  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822288990020752  GigaBytes
Max Memory Allocated: 9.647022724151611  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2320103645324707  GigaBytes
Max Memory Allocated: 9.647022724151611  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2320103645324707  GigaBytes
Max Memory Allocated: 9.647022724151611  GigaBytes

first layer input nodes number: 2187018
first layer output nodes number: 1765917
edges number: 36475992
torch.Size([2187018, 100])
torch.Size([1765917, 256])
input nodes number: 1765917
output nodes number: 545108
edges number: 17361924
torch.Size([1765917, 256])
torch.Size([545108, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.864835739135742  GigaBytes
Max Memory Allocated: 9.647022724151611  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.1346435546875 GB
    Memory Allocated: 7.869138717651367  GigaBytes
Max Memory Allocated: 9.647022724151611  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 1.8440771102905273  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 3 input nodes size: 2185574
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 0.822288990020752  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 0.822288990020752  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 1.636873722076416  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 1.637056827545166  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 0.822145938873291  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 1.2321839332580566  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 1.2321839332580566  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2185574
first layer output nodes number: 1763537
edges number: 36441224
torch.Size([2185574, 100])
torch.Size([1763537, 256])
input nodes number: 1763537
output nodes number: 545492
edges number: 17405409
torch.Size([1763537, 256])
torch.Size([545492, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 7.858945369720459  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.3436279296875 GB
    Memory Allocated: 7.863248348236084  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.8440017700195312  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 4 input nodes size: 2185377
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 0.822145938873291  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 0.822145938873291  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.6362624168395996  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.6364455223083496  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 0.8216776847839355  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.2288155555725098  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.2288155555725098  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2185377
first layer output nodes number: 1759830
edges number: 36368339
torch.Size([2185377, 100])
torch.Size([1759830, 256])
input nodes number: 1759830
output nodes number: 544195
edges number: 17346399
torch.Size([1759830, 256])
torch.Size([544195, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 7.840065956115723  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 7.844368934631348  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.8373289108276367  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 5 input nodes size: 2182369
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 0.8216776847839355  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 0.8216776847839355  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.6346735954284668  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.6348567008972168  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 0.8205571174621582  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.2267184257507324  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.2267184257507324  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2182369
first layer output nodes number: 1754481
edges number: 36274891
torch.Size([2182369, 100])
torch.Size([1754481, 256])
input nodes number: 1754481
output nodes number: 542869
edges number: 17311626
torch.Size([1754481, 256])
torch.Size([542869, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 7.820122241973877  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 7.824708938598633  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.8337841033935547  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 6 input nodes size: 2183488
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 0.8205571174621582  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 0.8205571174621582  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.633969783782959  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.634152889251709  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 0.8209738731384277  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.2278733253479004  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.2278733253479004  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2183488
first layer output nodes number: 1758880
edges number: 36351282
torch.Size([2183488, 100])
torch.Size([1758880, 256])
input nodes number: 1758880
output nodes number: 543853
edges number: 17333859
torch.Size([1758880, 256])
torch.Size([543853, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 7.836455345153809  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 7.840758323669434  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.8365201950073242  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 7 input nodes size: 2185017
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 0.821141242980957  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 0.821141242980957  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.6351237297058105  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.6353068351745605  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 0.8217110633850098  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.2292304039001465  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.2292304039001465  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2185017
first layer output nodes number: 1760877
edges number: 36393321
torch.Size([2185017, 100])
torch.Size([1760877, 256])
input nodes number: 1760877
output nodes number: 545322
edges number: 17374334
torch.Size([1760877, 256])
torch.Size([545322, 256])
torch.Size([24567, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 7.847612380981445  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 7.851914405822754  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0272216796875 GB
    Memory Allocated: 1.8382182121276855  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8382182121276855  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8382182121276855  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4071655571460724 |0.4632008671760559 |0.1540769338607788 |0.00014066696166992188 |0.03705039620399475 |0.0017948150634765625 |
----------------------------------------------------------pseudo_mini_loss sum 12.464323043823242
Total (block generation + training)time/epoch 547.5922993421555
Training time/epoch 8.761289596557617
Training time without block to device /epoch 5.05568265914917
Training time without total dataloading part /epoch 1.5319387912750244
load block tensor time/epoch 3.257324457168579
block to device time/epoch 3.7056069374084473
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  35922639
Number of first layer input nodes during this epoch:  17480410
Number of first layer output nodes during this epoch:  14085719
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8382177352905273  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.30210089683532715
number of batches is  8
batch size is  24572
range selection method spend 0.03549385070800781
time for parepare:  0.2853062152862549
local_output_nid generation:  0.006399393081665039
local_in_edges_tensor generation:  0.02945566177368164
mini_batch_src_global generation:  0.029114961624145508
r_  generation:  0.40350914001464844
local_output_nid generation:  0.0074040889739990234
local_in_edges_tensor generation:  0.011090517044067383
mini_batch_src_global generation:  0.03803133964538574
r_  generation:  0.45809006690979004
local_output_nid generation:  0.0074269771575927734
local_in_edges_tensor generation:  0.00651860237121582
mini_batch_src_global generation:  0.02599954605102539
r_  generation:  0.47853589057922363
local_output_nid generation:  0.007332563400268555
local_in_edges_tensor generation:  0.007727622985839844
mini_batch_src_global generation:  0.02949070930480957
r_  generation:  0.5126855373382568
local_output_nid generation:  0.007275581359863281
local_in_edges_tensor generation:  0.007837533950805664
mini_batch_src_global generation:  0.032202959060668945
r_  generation:  0.5373566150665283
local_output_nid generation:  0.0075261592864990234
local_in_edges_tensor generation:  0.0064241886138916016
mini_batch_src_global generation:  0.036548614501953125
r_  generation:  0.5608658790588379
local_output_nid generation:  0.007470846176147461
local_in_edges_tensor generation:  0.007673501968383789
mini_batch_src_global generation:  0.03721809387207031
r_  generation:  0.5626802444458008
local_output_nid generation:  0.0074808597564697266
local_in_edges_tensor generation:  0.007685661315917969
mini_batch_src_global generation:  0.03888058662414551
r_  generation:  0.5738768577575684
----------------------check_connections_block total spend ----------------------------- 5.499452352523804
generate_one_block  0.9563343524932861
generate_one_block  0.6058521270751953
generate_one_block  0.5834834575653076
generate_one_block  0.5857293605804443
generate_one_block  0.5883219242095947
generate_one_block  0.5844581127166748
generate_one_block  0.583512544631958
generate_one_block  0.587923526763916
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.9752607345581055
gen group dst list time:  0.12686800956726074
time for parepare:  0.4214334487915039
local_output_nid generation:  0.1134040355682373
local_in_edges_tensor generation:  0.41489315032958984
mini_batch_src_global generation:  0.5511462688446045
r_  generation:  7.312744379043579
local_output_nid generation:  0.16791200637817383
local_in_edges_tensor generation:  0.6104192733764648
mini_batch_src_global generation:  0.6843149662017822
r_  generation:  7.732966423034668
local_output_nid generation:  0.17960190773010254
local_in_edges_tensor generation:  0.5277454853057861
mini_batch_src_global generation:  0.6897337436676025
r_  generation:  7.556017637252808
local_output_nid generation:  0.1803438663482666
local_in_edges_tensor generation:  0.44730424880981445
mini_batch_src_global generation:  0.7923624515533447
r_  generation:  7.584475994110107
local_output_nid generation:  0.20052552223205566
local_in_edges_tensor generation:  0.584641695022583
mini_batch_src_global generation:  0.7131125926971436
r_  generation:  7.683336973190308
local_output_nid generation:  0.18816447257995605
local_in_edges_tensor generation:  0.45317721366882324
mini_batch_src_global generation:  0.75119948387146
r_  generation:  7.859326362609863
local_output_nid generation:  0.2087993621826172
local_in_edges_tensor generation:  0.5819473266601562
mini_batch_src_global generation:  0.7193412780761719
r_  generation:  7.64237117767334
local_output_nid generation:  0.19173359870910645
local_in_edges_tensor generation:  0.4580552577972412
mini_batch_src_global generation:  0.727576732635498
r_  generation:  7.90869140625
----------------------check_connections_block total spend ----------------------------- 82.77997422218323
generate_one_block  10.039698839187622
generate_one_block  9.682461738586426
generate_one_block  10.277819156646729
generate_one_block  9.92979621887207
generate_one_block  9.70781135559082
generate_one_block  10.07947587966919
generate_one_block  9.692868947982788
generate_one_block  9.860694646835327
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1795654296875
gen group dst list time:  0.49876928329467773
time for parepare:  0.4695284366607666
local_output_nid generation:  0.47040796279907227
local_in_edges_tensor generation:  1.1256682872772217
mini_batch_src_global generation:  1.232208490371704
r_  generation:  15.96359133720398
local_output_nid generation:  0.5932068824768066
local_in_edges_tensor generation:  1.3396282196044922
mini_batch_src_global generation:  1.4803507328033447
r_  generation:  16.167167901992798
local_output_nid generation:  0.5938379764556885
local_in_edges_tensor generation:  1.2119815349578857
mini_batch_src_global generation:  1.442119836807251
r_  generation:  16.74422025680542
local_output_nid generation:  0.6219658851623535
local_in_edges_tensor generation:  1.2314281463623047
mini_batch_src_global generation:  1.5057563781738281
r_  generation:  16.37396478652954
local_output_nid generation:  0.629927396774292
local_in_edges_tensor generation:  1.2475481033325195
mini_batch_src_global generation:  1.4633269309997559
r_  generation:  16.273407220840454
local_output_nid generation:  0.6180486679077148
local_in_edges_tensor generation:  1.1843352317810059
mini_batch_src_global generation:  1.6180472373962402
r_  generation:  16.011415004730225
local_output_nid generation:  0.6384978294372559
local_in_edges_tensor generation:  1.186248540878296
mini_batch_src_global generation:  1.5211191177368164
r_  generation:  16.291870594024658
local_output_nid generation:  0.6519820690155029
local_in_edges_tensor generation:  1.2546262741088867
mini_batch_src_global generation:  1.5018689632415771
r_  generation:  16.45562744140625
----------------------check_connections_block total spend ----------------------------- 179.6017186641693
generate_one_block  21.298974990844727
generate_one_block  21.19507336616516
generate_one_block  21.16962170600891
generate_one_block  21.2661190032959
generate_one_block  21.042712688446045
generate_one_block  21.036580324172974
generate_one_block  20.977596282958984
generate_one_block  22.188157558441162
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8382177352905273  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

connection checking time:  262.38169288635254
block generation total time  249.44546270370483
average batch blocks generation time:  31.180682837963104
block dataloader generation time/epoch 538.6861299673716
pseudo mini batch 0 input nodes size: 2188183
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8215417861938477  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8215417861938477  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6367034912109375  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6368865966796875  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.822721004486084  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2302823066711426  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2302823066711426  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2188183
first layer output nodes number: 1762685
edges number: 36416401
torch.Size([2188183, 100])
torch.Size([1762685, 256])
input nodes number: 1762685
output nodes number: 544964
edges number: 17355432
torch.Size([1762685, 256])
torch.Size([544964, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.8522467613220215  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.856767177581787  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8391761779785156  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 1 input nodes size: 2186346
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8227229118347168  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8227229118347168  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6372003555297852  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6373834609985352  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8220386505126953  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2298831939697266  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2298831939697266  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2186346
first layer output nodes number: 1763690
edges number: 36408934
torch.Size([2186346, 100])
torch.Size([1763690, 256])
input nodes number: 1763690
output nodes number: 545970
edges number: 17401498
torch.Size([1763690, 256])
torch.Size([545970, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.85689640045166  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.861199378967285  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.83851957321167  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 2 input nodes size: 2182580
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8220386505126953  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8220386505126953  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.63511323928833  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.63529634475708  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8206357955932617  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2277107238769531  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2277107238769531  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2182580
first layer output nodes number: 1758839
edges number: 36323796
torch.Size([2182580, 100])
torch.Size([1758839, 256])
input nodes number: 1758839
output nodes number: 545434
edges number: 17383682
torch.Size([1758839, 256])
torch.Size([545434, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.840851783752441  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.845154762268066  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.836747646331787  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 3 input nodes size: 2185972
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8206357955932617  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8206357955932617  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.63511323928833  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.63529634475708  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8220386505126953  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2294845581054688  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2294845581054688  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2185972
first layer output nodes number: 1760599
edges number: 36379201
torch.Size([2185972, 100])
torch.Size([1760599, 256])
input nodes number: 1760599
output nodes number: 545177
edges number: 17377801
torch.Size([1760599, 256])
torch.Size([545177, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.846193313598633  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.850496292114258  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8378691673278809  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 4 input nodes size: 2185482
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8220386505126953  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8220386505126953  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6361942291259766  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6363773345947266  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8217167854309082  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2325005531311035  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2325005531311035  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2185482
first layer output nodes number: 1764582
edges number: 36451896
torch.Size([2185482, 100])
torch.Size([1764582, 256])
input nodes number: 1764582
output nodes number: 545910
edges number: 17401687
torch.Size([1764582, 256])
torch.Size([545910, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.863738536834717  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.868732452392578  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.843818187713623  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 5 input nodes size: 2183306
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8217167854309082  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8217167854309082  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6350617408752441  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6352448463439941  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8209061622619629  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2276034355163574  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2276034355163574  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2183306
first layer output nodes number: 1758575
edges number: 36345739
torch.Size([2183306, 100])
torch.Size([1758575, 256])
input nodes number: 1758575
output nodes number: 543174
edges number: 17312178
torch.Size([1758575, 256])
torch.Size([543174, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.832845211029053  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.837828159332275  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8355321884155273  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 6 input nodes size: 2185353
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8209061622619629  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8209061622619629  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6350140571594238  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6351971626281738  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8216691017150879  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2297606468200684  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2297606468200684  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2185353
first layer output nodes number: 1759459
edges number: 36379562
torch.Size([2185353, 100])
torch.Size([1759459, 256])
input nodes number: 1759459
output nodes number: 543464
edges number: 17333943
torch.Size([1759459, 256])
torch.Size([543464, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.837510585784912  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.841813564300537  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.837118148803711  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 7 input nodes size: 2184132
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8216691017150879  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8216691017150879  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.635322093963623  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.635505199432373  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8212141990661621  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.228196620941162  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.228196620941162  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2184132
first layer output nodes number: 1758660
edges number: 36322267
torch.Size([2184132, 100])
torch.Size([1758660, 256])
input nodes number: 1758660
output nodes number: 545378
edges number: 17372271
torch.Size([1758660, 256])
torch.Size([545378, 256])
torch.Size([24567, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.8415727615356445  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.845874786376953  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.838331699371338  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.838331699371338  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.838331699371338  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4402317404747009 |0.44506075978279114 |0.11360552906990051 |0.00014927983283996582 |0.004202902317047119 |0.0012917518615722656 |
----------------------------------------------------------pseudo_mini_loss sum 3.605725049972534
Total (block generation + training)time/epoch 547.7672046820322
Training time/epoch 8.29337477684021
Training time without block to device /epoch 4.732888698577881
Training time without total dataloading part /epoch 0.944953441619873
load block tensor time/epoch 3.5218539237976074
block to device time/epoch 3.560486078262329
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  35927914
Number of first layer input nodes during this epoch:  17481354
Number of first layer output nodes during this epoch:  14087089
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8383312225341797  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3535268306732178
number of batches is  8
batch size is  24572
range selection method spend 0.03442025184631348
time for parepare:  0.2918832302093506
local_output_nid generation:  0.006452083587646484
local_in_edges_tensor generation:  0.03445887565612793
mini_batch_src_global generation:  0.04666781425476074
r_  generation:  0.4095029830932617
local_output_nid generation:  0.0074427127838134766
local_in_edges_tensor generation:  0.010147333145141602
mini_batch_src_global generation:  0.04067683219909668
r_  generation:  0.4621279239654541
local_output_nid generation:  0.007437229156494141
local_in_edges_tensor generation:  0.007711172103881836
mini_batch_src_global generation:  0.026398658752441406
r_  generation:  0.47914600372314453
local_output_nid generation:  0.00739598274230957
local_in_edges_tensor generation:  0.009273767471313477
mini_batch_src_global generation:  0.029491662979125977
r_  generation:  0.5172512531280518
local_output_nid generation:  0.007398128509521484
local_in_edges_tensor generation:  0.009044647216796875
mini_batch_src_global generation:  0.03236675262451172
r_  generation:  0.5431640148162842
local_output_nid generation:  0.007376194000244141
local_in_edges_tensor generation:  0.00895380973815918
mini_batch_src_global generation:  0.037143707275390625
r_  generation:  0.5637733936309814
local_output_nid generation:  0.0074536800384521484
local_in_edges_tensor generation:  0.008968114852905273
mini_batch_src_global generation:  0.037683963775634766
r_  generation:  0.5704190731048584
local_output_nid generation:  0.007452964782714844
local_in_edges_tensor generation:  0.00888824462890625
mini_batch_src_global generation:  0.04204678535461426
r_  generation:  0.5870099067687988
----------------------check_connections_block total spend ----------------------------- 5.590431213378906
generate_one_block  1.0047276020050049
generate_one_block  0.6192264556884766
generate_one_block  0.605339765548706
generate_one_block  0.599308967590332
generate_one_block  0.5956816673278809
generate_one_block  0.6483349800109863
generate_one_block  0.732813835144043
generate_one_block  0.6173732280731201
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1838762760162354
gen group dst list time:  0.13635778427124023
time for parepare:  0.42696142196655273
local_output_nid generation:  0.11359381675720215
local_in_edges_tensor generation:  0.41773009300231934
mini_batch_src_global generation:  0.5554802417755127
r_  generation:  7.3596155643463135
local_output_nid generation:  0.16586923599243164
local_in_edges_tensor generation:  0.49072718620300293
mini_batch_src_global generation:  0.6968262195587158
r_  generation:  7.730278491973877
local_output_nid generation:  0.1764230728149414
local_in_edges_tensor generation:  0.5620732307434082
mini_batch_src_global generation:  0.6933040618896484
r_  generation:  7.5491943359375
local_output_nid generation:  0.1781015396118164
local_in_edges_tensor generation:  0.49379968643188477
mini_batch_src_global generation:  0.7832033634185791
r_  generation:  7.623872995376587
local_output_nid generation:  0.1946582794189453
local_in_edges_tensor generation:  0.5234260559082031
mini_batch_src_global generation:  0.7198500633239746
r_  generation:  7.623883008956909
local_output_nid generation:  0.18828749656677246
local_in_edges_tensor generation:  0.5100390911102295
mini_batch_src_global generation:  0.7536888122558594
r_  generation:  7.9112396240234375
local_output_nid generation:  0.199967622756958
local_in_edges_tensor generation:  0.5340590476989746
mini_batch_src_global generation:  0.7384438514709473
r_  generation:  7.598572731018066
local_output_nid generation:  0.19205236434936523
local_in_edges_tensor generation:  0.45665693283081055
mini_batch_src_global generation:  0.723259449005127
r_  generation:  7.871583461761475
----------------------check_connections_block total spend ----------------------------- 82.83466815948486
generate_one_block  10.03316330909729
generate_one_block  9.745672464370728
generate_one_block  10.08735203742981
generate_one_block  10.061429500579834
generate_one_block  9.719769477844238
generate_one_block  9.754743337631226
generate_one_block  10.044930696487427
generate_one_block  9.796275615692139
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.221369981765747
gen group dst list time:  0.49701476097106934
time for parepare:  0.46736669540405273
local_output_nid generation:  0.487778902053833
local_in_edges_tensor generation:  1.116490125656128
mini_batch_src_global generation:  1.119225263595581
r_  generation:  15.653650760650635
local_output_nid generation:  0.5910911560058594
local_in_edges_tensor generation:  1.2916898727416992
mini_batch_src_global generation:  1.4399347305297852
r_  generation:  16.01309871673584
local_output_nid generation:  0.6066467761993408
local_in_edges_tensor generation:  1.1909070014953613
mini_batch_src_global generation:  1.4252679347991943
r_  generation:  15.882294178009033
local_output_nid generation:  0.5907077789306641
local_in_edges_tensor generation:  1.2051219940185547
mini_batch_src_global generation:  1.6410648822784424
r_  generation:  15.960242509841919
local_output_nid generation:  0.6061291694641113
local_in_edges_tensor generation:  1.2253952026367188
mini_batch_src_global generation:  1.59348464012146
r_  generation:  16.09653067588806
local_output_nid generation:  0.6356556415557861
local_in_edges_tensor generation:  1.0999751091003418
mini_batch_src_global generation:  1.5061495304107666
r_  generation:  16.184223651885986
local_output_nid generation:  0.6236989498138428
local_in_edges_tensor generation:  1.2359256744384766
mini_batch_src_global generation:  1.4521281719207764
r_  generation:  16.32985496520996
local_output_nid generation:  0.6411957740783691
local_in_edges_tensor generation:  1.239842414855957
mini_batch_src_global generation:  1.484764575958252
r_  generation:  16.023234605789185
----------------------check_connections_block total spend ----------------------------- 176.62350463867188
generate_one_block  21.131105184555054
generate_one_block  20.773966789245605
generate_one_block  20.617398977279663
generate_one_block  21.116989612579346
generate_one_block  21.127882957458496
generate_one_block  21.08265781402588
generate_one_block  20.921359300613403
generate_one_block  21.70585346221924
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8383312225341797  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

connection checking time:  259.45817279815674
block generation total time  247.72055053710938
average batch blocks generation time:  30.965068817138672
block dataloader generation time/epoch 538.1219109892845
pseudo mini batch 0 input nodes size: 2186031
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8212122917175293  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8212122917175293  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6355724334716797  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6357555389404297  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8219194412231445  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2287683486938477  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2287683486938477  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2186031
first layer output nodes number: 1759891
edges number: 36354092
torch.Size([2186031, 100])
torch.Size([1759891, 256])
input nodes number: 1759891
output nodes number: 543726
edges number: 17324453
torch.Size([1759891, 256])
torch.Size([543726, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.840041637420654  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.8443450927734375  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8384332656860352  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 1 input nodes size: 2184156
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8219213485717773  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8219213485717773  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6355829238891602  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6357660293579102  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8212227821350098  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2298474311828613  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2298474311828613  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2184156
first layer output nodes number: 1761642
edges number: 36398467
torch.Size([2184156, 100])
torch.Size([1761642, 256])
input nodes number: 1761642
output nodes number: 545767
edges number: 17389913
torch.Size([1761642, 256])
torch.Size([545767, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.8505682945251465  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.8548712730407715  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8392982482910156  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 2 input nodes size: 2184202
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8212227821350098  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8212227821350098  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.634901523590088  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.635084629058838  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8212399482727051  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.228081226348877  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.228081226348877  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2184202
first layer output nodes number: 1759697
edges number: 36342159
torch.Size([2184202, 100])
torch.Size([1759697, 256])
input nodes number: 1759697
output nodes number: 544123
edges number: 17334003
torch.Size([1759697, 256])
torch.Size([544123, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.8391828536987305  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.8434858322143555  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8361501693725586  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 3 input nodes size: 2187360
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8212399482727051  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8212399482727051  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6360950469970703  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6362781524658203  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224163055419922  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.230097770690918  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.230097770690918  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2187360
first layer output nodes number: 1760895
edges number: 36386390
torch.Size([2187360, 100])
torch.Size([1760895, 256])
input nodes number: 1760895
output nodes number: 545697
edges number: 17402625
torch.Size([1760895, 256])
torch.Size([545697, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.849791049957275  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.8540940284729  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.839400291442871  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 4 input nodes size: 2184338
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224163055419922  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224163055419922  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.636146068572998  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.636329174041748  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8212909698486328  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2283945083618164  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2283945083618164  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2184338
first layer output nodes number: 1759737
edges number: 36350275
torch.Size([2184338, 100])
torch.Size([1759737, 256])
input nodes number: 1759737
output nodes number: 544626
edges number: 17358131
torch.Size([1759737, 256])
torch.Size([544626, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.840394020080566  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.845621585845947  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8358798027038574  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 5 input nodes size: 2184083
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8212909698486328  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8212909698486328  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.634925365447998  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.635108470916748  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8211956024169922  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.228621482849121  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.228621482849121  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2184083
first layer output nodes number: 1760835
edges number: 36389001
torch.Size([2184083, 100])
torch.Size([1760835, 256])
input nodes number: 1760835
output nodes number: 544828
edges number: 17366752
torch.Size([1760835, 256])
torch.Size([544828, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.844871997833252  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.849174976348877  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8369426727294922  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 6 input nodes size: 2185583
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8211956024169922  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8211956024169922  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6353888511657715  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6355719566345215  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8217544555664062  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2296504974365234  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2296504974365234  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2185583
first layer output nodes number: 1761937
edges number: 36433200
torch.Size([2185583, 100])
torch.Size([1761937, 256])
input nodes number: 1761937
output nodes number: 545064
edges number: 17383737
torch.Size([1761937, 256])
torch.Size([545064, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.84934663772583  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.853649616241455  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8380560874938965  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 7 input nodes size: 2187272
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8217544555664062  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8217544555664062  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6365771293640137  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6367602348327637  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8223838806152344  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.231949806213379  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.231949806213379  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2187272
first layer output nodes number: 1763698
edges number: 36449928
torch.Size([2187272, 100])
torch.Size([1763698, 256])
input nodes number: 1763698
output nodes number: 543935
edges number: 17343146
torch.Size([1763698, 256])
torch.Size([543935, 256])
torch.Size([24567, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.855198860168457  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.859500885009766  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8431591987609863  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8431591987609863  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8431591987609863  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4250513017177582 |0.42845919728279114 |0.11373788118362427 |0.0001475214958190918 |0.004174649715423584 |0.002727508544921875 |
----------------------------------------------------------pseudo_mini_loss sum 4.480325698852539
Total (block generation + training)time/epoch 546.9428885579109
Training time/epoch 8.040424823760986
Training time without block to device /epoch 4.612751245498657
Training time without total dataloading part /epoch 0.9472079277038574
load block tensor time/epoch 3.4004104137420654
block to device time/epoch 3.427673578262329
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  35929123
Number of first layer input nodes during this epoch:  17483025
Number of first layer output nodes during this epoch:  14088332
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8431587219238281  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.32252931594848633
number of batches is  8
batch size is  24572
range selection method spend 0.04230308532714844
time for parepare:  0.2923696041107178
local_output_nid generation:  0.006608486175537109
local_in_edges_tensor generation:  0.02424931526184082
mini_batch_src_global generation:  0.030663251876831055
r_  generation:  0.4287550449371338
local_output_nid generation:  0.007598876953125
local_in_edges_tensor generation:  0.011150598526000977
mini_batch_src_global generation:  0.04560279846191406
r_  generation:  0.47196364402770996
local_output_nid generation:  0.007498741149902344
local_in_edges_tensor generation:  0.007798433303833008
mini_batch_src_global generation:  0.02606797218322754
r_  generation:  0.5032558441162109
local_output_nid generation:  0.0076868534088134766
local_in_edges_tensor generation:  0.006691455841064453
mini_batch_src_global generation:  0.03504157066345215
r_  generation:  0.5500342845916748
local_output_nid generation:  0.01296544075012207
local_in_edges_tensor generation:  0.009160280227661133
mini_batch_src_global generation:  0.03242969512939453
r_  generation:  0.569939374923706
local_output_nid generation:  0.007922172546386719
local_in_edges_tensor generation:  0.006986856460571289
mini_batch_src_global generation:  0.03676152229309082
r_  generation:  0.5635995864868164
local_output_nid generation:  0.007976055145263672
local_in_edges_tensor generation:  0.00649714469909668
mini_batch_src_global generation:  0.03778648376464844
r_  generation:  0.5757355690002441
local_output_nid generation:  0.007850170135498047
local_in_edges_tensor generation:  0.007830381393432617
mini_batch_src_global generation:  0.03906512260437012
r_  generation:  0.5866289138793945
----------------------check_connections_block total spend ----------------------------- 5.7178802490234375
generate_one_block  0.9773738384246826
generate_one_block  0.6231234073638916
generate_one_block  0.6107456684112549
generate_one_block  0.6021249294281006
generate_one_block  0.5985860824584961
generate_one_block  0.6049234867095947
generate_one_block  0.5977592468261719
generate_one_block  0.6036357879638672
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0528621673583984
gen group dst list time:  0.13905692100524902
time for parepare:  0.45179128646850586
local_output_nid generation:  0.11704802513122559
local_in_edges_tensor generation:  0.45476508140563965
mini_batch_src_global generation:  0.5720479488372803
r_  generation:  7.3453264236450195
local_output_nid generation:  0.17181658744812012
local_in_edges_tensor generation:  0.4925997257232666
mini_batch_src_global generation:  0.6945199966430664
r_  generation:  7.621086359024048
local_output_nid generation:  0.17952513694763184
local_in_edges_tensor generation:  0.5350284576416016
mini_batch_src_global generation:  0.6883070468902588
r_  generation:  7.644834756851196
local_output_nid generation:  0.18013644218444824
local_in_edges_tensor generation:  0.4950990676879883
mini_batch_src_global generation:  0.8059921264648438
r_  generation:  7.7059760093688965
local_output_nid generation:  0.1925795078277588
local_in_edges_tensor generation:  0.511310338973999
mini_batch_src_global generation:  0.7222905158996582
r_  generation:  7.722586393356323
local_output_nid generation:  0.18897056579589844
local_in_edges_tensor generation:  0.5102043151855469
mini_batch_src_global generation:  0.7536723613739014
r_  generation:  7.989250421524048
local_output_nid generation:  0.20129847526550293
local_in_edges_tensor generation:  0.5446722507476807
mini_batch_src_global generation:  0.7327461242675781
r_  generation:  7.6863648891448975
local_output_nid generation:  0.19144487380981445
local_in_edges_tensor generation:  0.5188994407653809
mini_batch_src_global generation:  0.7313611507415771
r_  generation:  7.820958852767944
----------------------check_connections_block total spend ----------------------------- 83.36135625839233
generate_one_block  10.119439125061035
generate_one_block  9.740697860717773
generate_one_block  10.158525228500366
generate_one_block  10.115962028503418
generate_one_block  9.76258373260498
generate_one_block  9.92948293685913
generate_one_block  9.954339742660522
generate_one_block  9.82185435295105
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1938068866729736
gen group dst list time:  0.5078227519989014
time for parepare:  0.46683359146118164
local_output_nid generation:  0.4532902240753174
local_in_edges_tensor generation:  1.1363770961761475
mini_batch_src_global generation:  1.1439039707183838
r_  generation:  16.023929119110107
local_output_nid generation:  0.5685958862304688
local_in_edges_tensor generation:  1.222564697265625
mini_batch_src_global generation:  1.4897894859313965
r_  generation:  16.147023677825928
local_output_nid generation:  0.6034801006317139
local_in_edges_tensor generation:  1.364879846572876
mini_batch_src_global generation:  1.446512222290039
r_  generation:  16.007872104644775
local_output_nid generation:  0.5924999713897705
local_in_edges_tensor generation:  1.2177667617797852
mini_batch_src_global generation:  1.6561965942382812
r_  generation:  15.97910451889038
local_output_nid generation:  0.6005322933197021
local_in_edges_tensor generation:  1.2360916137695312
mini_batch_src_global generation:  1.5750796794891357
r_  generation:  16.28625178337097
local_output_nid generation:  0.6460146903991699
local_in_edges_tensor generation:  1.11232590675354
mini_batch_src_global generation:  1.5125067234039307
r_  generation:  16.31460976600647
local_output_nid generation:  0.6159677505493164
local_in_edges_tensor generation:  1.2450718879699707
mini_batch_src_global generation:  1.4602024555206299
r_  generation:  16.219383239746094
local_output_nid generation:  0.6003377437591553
local_in_edges_tensor generation:  1.266366958618164
mini_batch_src_global generation:  1.6000783443450928
r_  generation:  16.12601399421692
----------------------check_connections_block total spend ----------------------------- 178.48759174346924
generate_one_block  21.23028874397278
generate_one_block  20.99372148513794
generate_one_block  20.753577709197998
generate_one_block  21.01658272743225
generate_one_block  21.301507472991943
generate_one_block  21.287171363830566
generate_one_block  21.184128522872925
generate_one_block  22.105090618133545
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8431587219238281  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

connection checking time:  261.8489480018616
block generation total time  249.47495365142822
average batch blocks generation time:  31.184369206428528
block dataloader generation time/epoch 538.6187780380249
pseudo mini batch 0 input nodes size: 2183857
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8223819732666016  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8223819732666016  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.635932445526123  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.636115550994873  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8211097717285156  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.227457046508789  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.227457046508789  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2183857
first layer output nodes number: 1757138
edges number: 36317774
torch.Size([2183857, 100])
torch.Size([1757138, 256])
input nodes number: 1757138
output nodes number: 542164
edges number: 17292803
torch.Size([1757138, 256])
torch.Size([542164, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.82441520690918  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.828718662261963  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8334927558898926  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 1 input nodes size: 2184471
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8211116790771484  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8211116790771484  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6348905563354492  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6350736618041992  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8213400840759277  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.228487491607666  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.228487491607666  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2184471
first layer output nodes number: 1760207
edges number: 36366088
torch.Size([2184471, 100])
torch.Size([1760207, 256])
input nodes number: 1760207
output nodes number: 544168
edges number: 17350438
torch.Size([1760207, 256])
torch.Size([544168, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.840213775634766  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.844516754150391  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8372058868408203  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 2 input nodes size: 2186375
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8213400840759277  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8213400840759277  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6358284950256348  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6360116004943848  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.822049617767334  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2295756340026855  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2295756340026855  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2186375
first layer output nodes number: 1762744
edges number: 36424875
torch.Size([2186375, 100])
torch.Size([1762744, 256])
input nodes number: 1762744
output nodes number: 544205
edges number: 17343013
torch.Size([1762744, 256])
torch.Size([544205, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.8494157791137695  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.8537187576293945  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8397669792175293  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 3 input nodes size: 2187414
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.822049617767334  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.822049617767334  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.636925220489502  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.637108325958252  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224368095397949  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2307562828063965  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2307562828063965  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2187414
first layer output nodes number: 1763520
edges number: 36423018
torch.Size([2187414, 100])
torch.Size([1763520, 256])
input nodes number: 1763520
output nodes number: 547301
edges number: 17449738
torch.Size([1763520, 256])
torch.Size([547301, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.862478733062744  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.867744445800781  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8407740592956543  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 4 input nodes size: 2186258
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224368095397949  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224368095397949  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6368818283081055  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6370649337768555  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8220062255859375  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2293510437011719  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2293510437011719  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2186258
first layer output nodes number: 1761762
edges number: 36399701
torch.Size([2186258, 100])
torch.Size([1761762, 256])
input nodes number: 1761762
output nodes number: 543734
edges number: 17345558
torch.Size([1761762, 256])
torch.Size([543734, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.844845294952393  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.849148273468018  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8381586074829102  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 5 input nodes size: 2184948
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8220062255859375  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8220062255859375  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6368818283081055  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6370649337768555  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224368095397949  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2294659614562988  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2294659614562988  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2184948
first layer output nodes number: 1758796
edges number: 36345112
torch.Size([2184948, 100])
torch.Size([1758796, 256])
input nodes number: 1758796
output nodes number: 544715
edges number: 17355691
torch.Size([1758796, 256])
torch.Size([544715, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.8399553298950195  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.8442583084106445  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8374338150024414  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 6 input nodes size: 2184454
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224368095397949  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224368095397949  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.636209487915039  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.636392593383789  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8213338851928711  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2279777526855469  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2279777526855469  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2184454
first layer output nodes number: 1757428
edges number: 36294789
torch.Size([2184454, 100])
torch.Size([1757428, 256])
input nodes number: 1757428
output nodes number: 544702
edges number: 17355578
torch.Size([1757428, 256])
torch.Size([544702, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.835061073303223  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.839364051818848  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8368539810180664  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 7 input nodes size: 2185387
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8213338851928711  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8213338851928711  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.636209487915039  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.636392593383789  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224368095397949  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2329039573669434  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2329039573669434  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2185387
first layer output nodes number: 1764598
edges number: 36454366
torch.Size([2185387, 100])
torch.Size([1764598, 256])
input nodes number: 1764598
output nodes number: 545343
edges number: 17375905
torch.Size([1764598, 256])
torch.Size([545343, 256])
torch.Size([24567, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.863133907318115  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.867435932159424  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8442201614379883  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8442201614379883  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8442201614379883  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4216941297054291 |0.49773868918418884 |0.11324554681777954 |0.00014218688011169434 |0.004191070795059204 |0.001363992691040039 |
----------------------------------------------------------pseudo_mini_loss sum 3.368175506591797
Total (block generation + training)time/epoch 547.3886862277984
Training time/epoch 8.565355777740479
Training time without block to device /epoch 4.583446264266968
Training time without total dataloading part /epoch 0.9419944286346436
load block tensor time/epoch 3.3735530376434326
block to device time/epoch 3.9819095134735107
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  35925689
Number of first layer input nodes during this epoch:  17483164
Number of first layer output nodes during this epoch:  14086193
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.84421968460083  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.33731532096862793
number of batches is  8
batch size is  24572
range selection method spend 0.03440237045288086
time for parepare:  0.28376126289367676
local_output_nid generation:  0.006514787673950195
local_in_edges_tensor generation:  0.028415441513061523
mini_batch_src_global generation:  0.03052997589111328
r_  generation:  0.4054701328277588
local_output_nid generation:  0.009195566177368164
local_in_edges_tensor generation:  0.01120901107788086
mini_batch_src_global generation:  0.038657426834106445
r_  generation:  0.461209774017334
local_output_nid generation:  0.007436037063598633
local_in_edges_tensor generation:  0.0076541900634765625
mini_batch_src_global generation:  0.026114702224731445
r_  generation:  0.47759103775024414
local_output_nid generation:  0.007536888122558594
local_in_edges_tensor generation:  0.00666499137878418
mini_batch_src_global generation:  0.029575109481811523
r_  generation:  0.5151481628417969
local_output_nid generation:  0.0074462890625
local_in_edges_tensor generation:  0.007868289947509766
mini_batch_src_global generation:  0.03227853775024414
r_  generation:  0.5452563762664795
local_output_nid generation:  0.009836912155151367
local_in_edges_tensor generation:  0.008877754211425781
mini_batch_src_global generation:  0.03813433647155762
r_  generation:  0.5661625862121582
local_output_nid generation:  0.007480144500732422
local_in_edges_tensor generation:  0.00938272476196289
mini_batch_src_global generation:  0.03895068168640137
r_  generation:  0.5692758560180664
local_output_nid generation:  0.007395267486572266
local_in_edges_tensor generation:  0.007648944854736328
mini_batch_src_global generation:  0.04036569595336914
r_  generation:  0.5783641338348389
----------------------check_connections_block total spend ----------------------------- 5.545393466949463
generate_one_block  0.9744374752044678
generate_one_block  0.618293285369873
generate_one_block  0.605440616607666
generate_one_block  0.6223304271697998
generate_one_block  0.6265740394592285
generate_one_block  0.6030504703521729
generate_one_block  0.6039035320281982
generate_one_block  0.6447803974151611
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.092162847518921
gen group dst list time:  0.13645148277282715
time for parepare:  0.43660902976989746
local_output_nid generation:  0.1264479160308838
local_in_edges_tensor generation:  0.4474341869354248
mini_batch_src_global generation:  0.5575175285339355
r_  generation:  7.134552717208862
local_output_nid generation:  0.16272258758544922
local_in_edges_tensor generation:  0.4508492946624756
mini_batch_src_global generation:  0.8289439678192139
r_  generation:  7.339071273803711
local_output_nid generation:  0.1770641803741455
local_in_edges_tensor generation:  0.4943857192993164
mini_batch_src_global generation:  0.6943378448486328
r_  generation:  7.750439167022705
local_output_nid generation:  0.1709153652191162
local_in_edges_tensor generation:  0.5992810726165771
mini_batch_src_global generation:  0.7273070812225342
r_  generation:  7.576935529708862
local_output_nid generation:  0.18550634384155273
local_in_edges_tensor generation:  0.45889925956726074
mini_batch_src_global generation:  0.7246026992797852
r_  generation:  7.694540500640869
local_output_nid generation:  0.18620634078979492
local_in_edges_tensor generation:  0.5205307006835938
mini_batch_src_global generation:  0.8277623653411865
r_  generation:  8.460529327392578
local_output_nid generation:  0.20971155166625977
local_in_edges_tensor generation:  0.6201274394989014
mini_batch_src_global generation:  0.8155267238616943
r_  generation:  7.665959358215332
local_output_nid generation:  0.20091938972473145
local_in_edges_tensor generation:  0.5192573070526123
mini_batch_src_global generation:  0.7393069267272949
r_  generation:  7.992153644561768
----------------------check_connections_block total spend ----------------------------- 83.9680666923523
generate_one_block  10.083389282226562
generate_one_block  9.788771629333496
generate_one_block  10.426461935043335
generate_one_block  9.818825006484985
generate_one_block  9.745957136154175
generate_one_block  10.14719295501709
generate_one_block  9.797505855560303
generate_one_block  9.900043964385986
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2831084728240967
gen group dst list time:  0.49675989151000977
time for parepare:  0.45682382583618164
local_output_nid generation:  0.46308112144470215
local_in_edges_tensor generation:  1.1502189636230469
mini_batch_src_global generation:  1.1849548816680908
r_  generation:  15.840006589889526
local_output_nid generation:  0.5864303112030029
local_in_edges_tensor generation:  1.2855570316314697
mini_batch_src_global generation:  1.4767827987670898
r_  generation:  15.971215009689331
local_output_nid generation:  0.6092684268951416
local_in_edges_tensor generation:  1.2054288387298584
mini_batch_src_global generation:  1.4543654918670654
r_  generation:  15.934900999069214
local_output_nid generation:  0.6007790565490723
local_in_edges_tensor generation:  1.2184505462646484
mini_batch_src_global generation:  1.6197905540466309
r_  generation:  15.810603141784668
local_output_nid generation:  0.6140186786651611
local_in_edges_tensor generation:  1.2410755157470703
mini_batch_src_global generation:  1.5358662605285645
r_  generation:  16.234741687774658
local_output_nid generation:  0.6326024532318115
local_in_edges_tensor generation:  1.1048855781555176
mini_batch_src_global generation:  1.5592095851898193
r_  generation:  16.32691502571106
local_output_nid generation:  0.6258251667022705
local_in_edges_tensor generation:  1.2388951778411865
mini_batch_src_global generation:  1.4594156742095947
r_  generation:  16.384249210357666
local_output_nid generation:  0.6439311504364014
local_in_edges_tensor generation:  1.2308976650238037
mini_batch_src_global generation:  1.4796884059906006
r_  generation:  16.185221433639526
----------------------check_connections_block total spend ----------------------------- 177.923100233078
generate_one_block  20.91640877723694
generate_one_block  20.930524587631226
generate_one_block  20.693877696990967
generate_one_block  20.677501440048218
generate_one_block  21.17927622795105
generate_one_block  21.196723461151123
generate_one_block  21.00097942352295
generate_one_block  22.0315523147583
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.84421968460083  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

connection checking time:  261.8911669254303
block generation total time  248.3349916934967
average batch blocks generation time:  31.041873961687088
block dataloader generation time/epoch 538.7837145328522
pseudo mini batch 0 input nodes size: 2184762
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224349021911621  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224349021911621  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6363224983215332  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6365056037902832  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8214468955993652  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2283778190612793  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2283778190612793  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2184762
first layer output nodes number: 1758491
edges number: 36350232
torch.Size([2184762, 100])
torch.Size([1758491, 256])
input nodes number: 1758491
output nodes number: 543640
edges number: 17338184
torch.Size([1758491, 256])
torch.Size([543640, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.83394718170166  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.838250637054443  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8353891372680664  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 1 input nodes size: 2185718
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.821448802947998  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.821448802947998  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.636324405670166  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.636507511138916  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224368095397949  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2294316291809082  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2294316291809082  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2185718
first layer output nodes number: 1759919
edges number: 36371333
torch.Size([2185718, 100])
torch.Size([1759919, 256])
input nodes number: 1759919
output nodes number: 543905
edges number: 17326344
torch.Size([1759919, 256])
torch.Size([543905, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.839519023895264  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.843822002410889  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.837404727935791  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 2 input nodes size: 2185346
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224368095397949  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224368095397949  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6365418434143066  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6367249488830566  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8216662406921387  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2293791770935059  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2293791770935059  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2185346
first layer output nodes number: 1764372
edges number: 36429245
torch.Size([2185346, 100])
torch.Size([1764372, 256])
input nodes number: 1764372
output nodes number: 544776
edges number: 17362995
torch.Size([1764372, 256])
torch.Size([544776, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.854851722717285  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.85915470123291  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8398966789245605  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 3 input nodes size: 2185582
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8216662406921387  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8216662406921387  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6365418434143066  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6367249488830566  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224368095397949  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2298493385314941  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2298493385314941  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2185582
first layer output nodes number: 1761140
edges number: 36386815
torch.Size([2185582, 100])
torch.Size([1761140, 256])
input nodes number: 1761140
output nodes number: 544495
edges number: 17366288
torch.Size([1761140, 256])
torch.Size([544495, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.845462322235107  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.850053310394287  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.838547706604004  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 4 input nodes size: 2184707
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224368095397949  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224368095397949  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6363039016723633  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6364870071411133  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8214282989501953  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2287511825561523  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2287511825561523  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2184707
first layer output nodes number: 1760305
edges number: 36374731
torch.Size([2184707, 100])
torch.Size([1760305, 256])
input nodes number: 1760305
output nodes number: 544578
edges number: 17365468
torch.Size([1760305, 256])
torch.Size([544578, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.8423261642456055  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.8466291427612305  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8373465538024902  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 5 input nodes size: 2185372
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8214282989501953  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8214282989501953  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6363039016723633  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6364870071411133  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224368095397949  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2297587394714355  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2297587394714355  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2185372
first layer output nodes number: 1760925
edges number: 36384585
torch.Size([2185372, 100])
torch.Size([1760925, 256])
input nodes number: 1760925
output nodes number: 545226
edges number: 17357738
torch.Size([1760925, 256])
torch.Size([545226, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.847653865814209  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.851956844329834  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8388943672180176  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 6 input nodes size: 2183968
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224368095397949  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224368095397949  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6360282897949219  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6362113952636719  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8211526870727539  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2282295227050781  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.2282295227050781  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2183968
first layer output nodes number: 1759470
edges number: 36356109
torch.Size([2183968, 100])
torch.Size([1759470, 256])
input nodes number: 1759470
output nodes number: 544104
edges number: 17350426
torch.Size([1759470, 256])
torch.Size([544104, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.838289737701416  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.842592716217041  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8365883827209473  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

pseudo mini batch 7 input nodes size: 2186712
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8211526870727539  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8211526870727539  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6360282897949219  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.6362113952636719  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 0.8224368095397949  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.232642650604248  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.232642650604248  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

first layer input nodes number: 2186712
first layer output nodes number: 1763579
edges number: 36444358
torch.Size([2186712, 100])
torch.Size([1763579, 256])
input nodes number: 1763579
output nodes number: 546264
edges number: 17428327
torch.Size([1763579, 256])
torch.Size([546264, 256])
torch.Size([24567, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.862765312194824  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 7.867067337036133  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8439531326293945  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8439531326293945  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.0291748046875 GB
    Memory Allocated: 1.8439531326293945  GigaBytes
Max Memory Allocated: 9.659399509429932  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4323978126049042 |0.474244087934494 |0.11327597498893738 |0.00014716386795043945 |0.0041810572147369385 |0.0012977123260498047 |
----------------------------------------------------------pseudo_mini_loss sum 2.2287392616271973
Total (block generation + training)time/epoch 547.5024815400442
Training time/epoch 8.462752342224121
Training time without block to device /epoch 4.668799638748169
Training time without total dataloading part /epoch 0.9421312808990479
load block tensor time/epoch 3.4591825008392334
block to device time/epoch 3.793952703475952
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  35927356
Number of first layer input nodes during this epoch:  17482167
Number of first layer output nodes during this epoch:  14088201
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  206336
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([47, 256])
layers.2.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
