main start at this time 1656643321.8644383
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.37186169624328613
number of batches is  4
batch size is  49143
range selection method spend 0.028498411178588867
time for parepare:  0.27332329750061035
local_output_nid generation:  0.012003183364868164
local_in_edges_tensor generation:  0.04051518440246582
mini_batch_src_global generation:  0.057039499282836914
r_  generation:  0.9546060562133789
local_output_nid generation:  0.013532161712646484
local_in_edges_tensor generation:  0.031752824783325195
mini_batch_src_global generation:  0.07410359382629395
r_  generation:  0.9666910171508789
local_output_nid generation:  0.013296127319335938
local_in_edges_tensor generation:  0.023213624954223633
mini_batch_src_global generation:  0.055322885513305664
r_  generation:  1.0755829811096191
local_output_nid generation:  0.013502836227416992
local_in_edges_tensor generation:  0.018128156661987305
mini_batch_src_global generation:  0.0654594898223877
r_  generation:  1.1017491817474365
----------------------check_connections_block total spend ----------------------------- 5.391033411026001
generate_one_block  2.1069600582122803
generate_one_block  1.1185262203216553
generate_one_block  1.114929437637329
generate_one_block  1.1343724727630615
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.22983455657959
gen group dst list time:  0.09713435173034668
time for parepare:  0.4522411823272705
local_output_nid generation:  0.1414790153503418
local_in_edges_tensor generation:  0.6059513092041016
mini_batch_src_global generation:  0.771045446395874
r_  generation:  10.398693561553955
local_output_nid generation:  0.21847987174987793
local_in_edges_tensor generation:  0.7423057556152344
mini_batch_src_global generation:  0.9597017765045166
r_  generation:  10.71908974647522
local_output_nid generation:  0.2515852451324463
local_in_edges_tensor generation:  0.8013205528259277
mini_batch_src_global generation:  0.9588053226470947
r_  generation:  10.963016986846924
local_output_nid generation:  0.28417325019836426
local_in_edges_tensor generation:  0.6756815910339355
mini_batch_src_global generation:  0.9758198261260986
r_  generation:  11.150403499603271
----------------------check_connections_block total spend ----------------------------- 58.123780965805054
generate_one_block  14.433486938476562
generate_one_block  14.37242078781128
generate_one_block  14.147839546203613
generate_one_block  14.946821689605713
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3713502883911133
gen group dst list time:  0.3106229305267334
time for parepare:  0.5094225406646729
local_output_nid generation:  0.47690367698669434
local_in_edges_tensor generation:  1.078808307647705
mini_batch_src_global generation:  1.171510934829712
r_  generation:  17.559940576553345
local_output_nid generation:  0.6274700164794922
local_in_edges_tensor generation:  1.313079595565796
mini_batch_src_global generation:  1.534118890762329
r_  generation:  17.46639347076416
local_output_nid generation:  0.6292228698730469
local_in_edges_tensor generation:  1.2835769653320312
mini_batch_src_global generation:  1.5180439949035645
r_  generation:  17.531376123428345
local_output_nid generation:  0.6373035907745361
local_in_edges_tensor generation:  1.9673917293548584
mini_batch_src_global generation:  1.5143136978149414
r_  generation:  17.649774312973022
----------------------check_connections_block total spend ----------------------------- 96.39886403083801
generate_one_block  22.7023184299469
generate_one_block  22.29051399230957
generate_one_block  22.247017860412598
generate_one_block  22.446836948394775
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

connection checking time:  154.52264499664307
block generation total time  147.587256193161
average batch blocks generation time:  36.89681404829025
block dataloader generation time/epoch 327.4492211341858
pseudo mini batch 0 input nodes size: 2224495
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8475341796875 GB
    Memory Allocated: 0.8294577598571777  GigaBytes
Max Memory Allocated: 0.8294577598571777  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8475341796875 GB
    Memory Allocated: 0.8298239707946777  GigaBytes
Max Memory Allocated: 0.8298239707946777  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8475341796875 GB
    Memory Allocated: 0.8298239707946777  GigaBytes
Max Memory Allocated: 0.8298239707946777  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 1.317563533782959  GigaBytes
Max Memory Allocated: 1.317563533782959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 1.317563533782959  GigaBytes
Max Memory Allocated: 1.317563533782959  GigaBytes

first layer input nodes number: 2224495
first layer output nodes number: 1923143
edges number: 38440195
torch.Size([2224495, 100])
torch.Size([1923143, 256])
input nodes number: 1923143
output nodes number: 807448
edges number: 25130929
torch.Size([1923143, 256])
torch.Size([807448, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2967529296875 GB
    Memory Allocated: 9.280884265899658  GigaBytes
Max Memory Allocated: 9.971730709075928  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.2967529296875 GB
    Memory Allocated: 9.28948974609375  GigaBytes
Max Memory Allocated: 9.971730709075928  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.5135498046875 GB
    Memory Allocated: 2.0872721672058105  GigaBytes
Max Memory Allocated: 10.781333446502686  GigaBytes

pseudo mini batch 1 input nodes size: 2224850
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.5135498046875 GB
    Memory Allocated: 0.839198112487793  GigaBytes
Max Memory Allocated: 10.781333446502686  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.5135498046875 GB
    Memory Allocated: 0.839198112487793  GigaBytes
Max Memory Allocated: 10.781333446502686  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.5135498046875 GB
    Memory Allocated: 1.6680197715759277  GigaBytes
Max Memory Allocated: 10.781333446502686  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.5135498046875 GB
    Memory Allocated: 1.6683859825134277  GigaBytes
Max Memory Allocated: 10.781333446502686  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.5135498046875 GB
    Memory Allocated: 0.8393306732177734  GigaBytes
Max Memory Allocated: 10.781333446502686  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.5135498046875 GB
    Memory Allocated: 1.327275276184082  GigaBytes
Max Memory Allocated: 10.781333446502686  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5135498046875 GB
    Memory Allocated: 1.327275276184082  GigaBytes
Max Memory Allocated: 10.781333446502686  GigaBytes

first layer input nodes number: 2224850
first layer output nodes number: 1923306
edges number: 38434187
torch.Size([2224850, 100])
torch.Size([1923306, 256])
input nodes number: 1923306
output nodes number: 809258
edges number: 25200976
torch.Size([1923306, 256])
torch.Size([809258, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.5155029296875 GB
    Memory Allocated: 9.28831148147583  GigaBytes
Max Memory Allocated: 10.781333446502686  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.5155029296875 GB
    Memory Allocated: 9.296916484832764  GigaBytes
Max Memory Allocated: 10.781333446502686  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 2.0910983085632324  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

pseudo mini batch 2 input nodes size: 2223513
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 0.8393306732177734  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 0.8393306732177734  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 1.667654037475586  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 1.668020248413086  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 0.8388323783874512  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 1.3268446922302246  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 1.3268446922302246  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

first layer input nodes number: 2223513
first layer output nodes number: 1923097
edges number: 38439755
torch.Size([2223513, 100])
torch.Size([1923097, 256])
input nodes number: 1923097
output nodes number: 809690
edges number: 25200390
torch.Size([1923097, 256])
torch.Size([809690, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 9.288235664367676  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 9.29684066772461  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 2.0882720947265625  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

pseudo mini batch 3 input nodes size: 2221742
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 0.8388323783874512  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 0.8388323783874512  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 1.6664958000183105  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 1.6668620109558105  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 0.838172435760498  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 1.3259434700012207  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 1.3259434700012207  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

first layer input nodes number: 2221742
first layer output nodes number: 1922139
edges number: 38405940
torch.Size([2221742, 100])
torch.Size([1922139, 256])
input nodes number: 1922139
output nodes number: 809829
edges number: 25202953
torch.Size([1922139, 256])
torch.Size([809829, 256])
torch.Size([49142, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 9.28539514541626  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 9.294000148773193  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.1248779296875 GB
    Memory Allocated: 2.0876007080078125  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 2.0891380310058594  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 2.0891380310058594  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4232213497161865 |0.7493559718132019 |0.32099199295043945 |0.0001888871192932129 |0.09210222959518433 |0.002340078353881836 |
----------------------------------------------------------pseudo_mini_loss sum 7.18077278137207
Total (block generation + training)time/epoch 334.0993592739105
Training time/epoch 6.649884462356567
Training time without block to device /epoch 3.6524605751037598
Training time without total dataloading part /epoch 1.6554725170135498
load block tensor time/epoch 1.692885398864746
block to device time/epoch 2.9974238872528076
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  19822510
Number of first layer input nodes during this epoch:  8894600
Number of first layer output nodes during this epoch:  7691685
----------------------------------------before generate dataloader block 
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 2.089137554168701  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.4559614658355713
number of batches is  4
batch size is  49143
range selection method spend 0.03187227249145508
time for parepare:  0.3252110481262207
local_output_nid generation:  0.012886285781860352
local_in_edges_tensor generation:  0.05197429656982422
mini_batch_src_global generation:  0.06501960754394531
r_  generation:  0.9907476902008057
local_output_nid generation:  0.01454019546508789
local_in_edges_tensor generation:  0.03334307670593262
mini_batch_src_global generation:  0.07554364204406738
r_  generation:  1.0491912364959717
local_output_nid generation:  0.014293670654296875
local_in_edges_tensor generation:  0.02036428451538086
mini_batch_src_global generation:  0.057946205139160156
r_  generation:  1.1167891025543213
local_output_nid generation:  0.016798973083496094
local_in_edges_tensor generation:  0.028888463973999023
mini_batch_src_global generation:  0.06736183166503906
r_  generation:  1.120142936706543
----------------------check_connections_block total spend ----------------------------- 5.743456125259399
generate_one_block  1.5746965408325195
generate_one_block  1.197617530822754
generate_one_block  1.1729326248168945
generate_one_block  1.3718693256378174
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0337328910827637
gen group dst list time:  0.10296773910522461
time for parepare:  0.48737359046936035
local_output_nid generation:  0.2094557285308838
local_in_edges_tensor generation:  0.603278636932373
mini_batch_src_global generation:  0.7864410877227783
r_  generation:  11.041868209838867
local_output_nid generation:  0.34328460693359375
local_in_edges_tensor generation:  0.783355712890625
mini_batch_src_global generation:  1.0506575107574463
r_  generation:  10.919506311416626
local_output_nid generation:  0.3061378002166748
local_in_edges_tensor generation:  0.7187771797180176
mini_batch_src_global generation:  1.0512542724609375
r_  generation:  11.13586139678955
local_output_nid generation:  0.32113075256347656
local_in_edges_tensor generation:  0.7681739330291748
mini_batch_src_global generation:  0.9907362461090088
r_  generation:  11.286165475845337
----------------------check_connections_block total spend ----------------------------- 60.05427598953247
generate_one_block  14.506145000457764
generate_one_block  14.699976682662964
generate_one_block  14.527930498123169
generate_one_block  14.50796127319336
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1493592262268066
gen group dst list time:  0.27916431427001953
time for parepare:  0.46895766258239746
local_output_nid generation:  0.4294915199279785
local_in_edges_tensor generation:  1.1227993965148926
mini_batch_src_global generation:  1.1716210842132568
r_  generation:  16.94261860847473
local_output_nid generation:  0.6234569549560547
local_in_edges_tensor generation:  1.3130786418914795
mini_batch_src_global generation:  1.5003790855407715
r_  generation:  17.587214946746826
local_output_nid generation:  0.619748592376709
local_in_edges_tensor generation:  1.2215430736541748
mini_batch_src_global generation:  1.5527143478393555
r_  generation:  17.601852655410767
local_output_nid generation:  0.6535580158233643
local_in_edges_tensor generation:  1.23305344581604
mini_batch_src_global generation:  1.6118316650390625
r_  generation:  17.67708158493042
----------------------check_connections_block total spend ----------------------------- 95.14829683303833
generate_one_block  22.763278484344482
generate_one_block  22.67622447013855
generate_one_block  22.57004189491272
generate_one_block  22.537787675857544
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 2.089137554168701  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

connection checking time:  155.2025728225708
block generation total time  148.78934597969055
average batch blocks generation time:  37.19733649492264
block dataloader generation time/epoch 328.46500837802887
pseudo mini batch 0 input nodes size: 2223855
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 0.8397088050842285  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 0.8397088050842285  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 1.6681594848632812  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 1.6685256958007812  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 0.8404960632324219  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 1.3283910751342773  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 1.3283910751342773  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

first layer input nodes number: 2223855
first layer output nodes number: 1923451
edges number: 38431227
torch.Size([2223855, 100])
torch.Size([1923451, 256])
input nodes number: 1923451
output nodes number: 809288
edges number: 25185912
torch.Size([1923451, 256])
torch.Size([809288, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 9.288930892944336  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 9.297536373138428  GigaBytes
Max Memory Allocated: 10.794735431671143  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 2.090996742248535  GigaBytes
Max Memory Allocated: 10.795207023620605  GigaBytes

pseudo mini batch 1 input nodes size: 2223645
----------------------------------------before load block subtensor 
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 0.8404970169067383  GigaBytes
Max Memory Allocated: 10.795207023620605  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 0.8404970169067383  GigaBytes
Max Memory Allocated: 10.795207023620605  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 1.6688694953918457  GigaBytes
Max Memory Allocated: 10.795207023620605  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 1.6692357063293457  GigaBytes
Max Memory Allocated: 10.795207023620605  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 0.840418815612793  GigaBytes
Max Memory Allocated: 10.795207023620605  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 1.3292198181152344  GigaBytes
Max Memory Allocated: 10.795207023620605  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 21.1268310546875 GB
    Memory Allocated: 1.3292198181152344  GigaBytes
Max Memory Allocated: 10.795207023620605  GigaBytes

first layer input nodes number: 2223645
first layer output nodes number: 1927088
edges number: 38498003
torch.Size([2223645, 100])
torch.Size([1927088, 256])
input nodes number: 1927088
output nodes number: 810931
edges number: 25249381
torch.Size([1927088, 256])
torch.Size([810931, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.305393695831299  GigaBytes
Max Memory Allocated: 10.795207023620605  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7889404296875 GB
    Memory Allocated: 9.313998699188232  GigaBytes
Max Memory Allocated: 10.795207023620605  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 2.0927577018737793  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

pseudo mini batch 2 input nodes size: 2223033
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.840418815612793  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.840418815612793  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.6685633659362793  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.6689295768737793  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8401908874511719  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.3273115158081055  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.3273115158081055  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

first layer input nodes number: 2223033
first layer output nodes number: 1919984
edges number: 38392513
torch.Size([2223033, 100])
torch.Size([1919984, 256])
input nodes number: 1919984
output nodes number: 807191
edges number: 25130061
torch.Size([1919984, 256])
torch.Size([807191, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 9.273024082183838  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 9.281629085540771  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 2.0900893211364746  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

pseudo mini batch 3 input nodes size: 2222054
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8401908874511719  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8401908874511719  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.6685633659362793  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.6689295768737793  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.840418815612793  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.328017234802246  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.328017234802246  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

first layer input nodes number: 2222054
first layer output nodes number: 1921500
edges number: 38408220
torch.Size([2222054, 100])
torch.Size([1921500, 256])
input nodes number: 1921500
output nodes number: 809137
edges number: 25179365
torch.Size([1921500, 256])
torch.Size([809137, 256])
torch.Size([49142, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 9.283581256866455  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 9.292186260223389  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 2.0905919075012207  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 2.0905919075012207  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 2.0905919075012207  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4071553349494934 |0.5141168236732483 |0.19570070505142212 |0.00015103816986083984 |0.10489052534103394 |0.002780437469482422 |
----------------------------------------------------------pseudo_mini_loss sum 12.414129257202148
Total (block generation + training)time/epoch 334.4030146598816
Training time/epoch 5.225531101226807
Training time without block to device /epoch 3.1690638065338135
Training time without total dataloading part /epoch 1.20574951171875
load block tensor time/epoch 1.6286213397979736
block to device time/epoch 2.056467294692993
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  19821157
Number of first layer input nodes during this epoch:  8892587
Number of first layer output nodes during this epoch:  7692023
----------------------------------------before generate dataloader block 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 2.0905914306640625  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3812432289123535
number of batches is  4
batch size is  49143
range selection method spend 0.042386531829833984
time for parepare:  0.28133201599121094
local_output_nid generation:  0.012533187866210938
local_in_edges_tensor generation:  0.05313611030578613
mini_batch_src_global generation:  0.06196713447570801
r_  generation:  0.9257917404174805
local_output_nid generation:  0.014508724212646484
local_in_edges_tensor generation:  0.022797107696533203
mini_batch_src_global generation:  0.07733035087585449
r_  generation:  1.0269801616668701
local_output_nid generation:  0.014309167861938477
local_in_edges_tensor generation:  0.01990985870361328
mini_batch_src_global generation:  0.05579972267150879
r_  generation:  1.0997412204742432
local_output_nid generation:  0.016022920608520508
local_in_edges_tensor generation:  0.0223846435546875
mini_batch_src_global generation:  0.06742191314697266
r_  generation:  1.1160666942596436
----------------------check_connections_block total spend ----------------------------- 5.546025037765503
generate_one_block  1.550757646560669
generate_one_block  1.1566121578216553
generate_one_block  1.1599602699279785
generate_one_block  1.3912222385406494
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0197091102600098
gen group dst list time:  0.08892464637756348
time for parepare:  0.4352426528930664
local_output_nid generation:  0.15539002418518066
local_in_edges_tensor generation:  0.6061699390411377
mini_batch_src_global generation:  0.7856900691986084
r_  generation:  11.148446083068848
local_output_nid generation:  0.2583470344543457
local_in_edges_tensor generation:  0.826775312423706
mini_batch_src_global generation:  1.0347650051116943
r_  generation:  11.24595594406128
local_output_nid generation:  0.28024840354919434
local_in_edges_tensor generation:  0.7481307983398438
mini_batch_src_global generation:  0.998816728591919
r_  generation:  10.952353715896606
local_output_nid generation:  0.2838175296783447
local_in_edges_tensor generation:  0.665428876876831
mini_batch_src_global generation:  1.046274185180664
r_  generation:  11.230651378631592
----------------------check_connections_block total spend ----------------------------- 59.95192217826843
generate_one_block  14.590190172195435
generate_one_block  14.668211460113525
generate_one_block  14.25357723236084
generate_one_block  14.496642827987671
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2123053073883057
gen group dst list time:  0.3015327453613281
time for parepare:  0.42765045166015625
local_output_nid generation:  0.4550504684448242
local_in_edges_tensor generation:  1.3022499084472656
mini_batch_src_global generation:  1.1995081901550293
r_  generation:  17.42685031890869
local_output_nid generation:  0.6282515525817871
local_in_edges_tensor generation:  1.3248035907745361
mini_batch_src_global generation:  1.729423999786377
r_  generation:  17.435315132141113
local_output_nid generation:  0.6423804759979248
local_in_edges_tensor generation:  1.3179194927215576
mini_batch_src_global generation:  1.5656490325927734
r_  generation:  17.44916582107544
local_output_nid generation:  0.6591384410858154
local_in_edges_tensor generation:  1.2641639709472656
mini_batch_src_global generation:  1.7066867351531982
r_  generation:  17.39282727241516
----------------------check_connections_block total spend ----------------------------- 95.80704140663147
generate_one_block  22.62203621864319
generate_one_block  22.60950779914856
generate_one_block  22.602168560028076
generate_one_block  22.55238962173462
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 2.0905914306640625  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

connection checking time:  155.7589635848999
block generation total time  148.3947238922119
average batch blocks generation time:  37.09868097305298
block dataloader generation time/epoch 328.7696983019511
pseudo mini batch 0 input nodes size: 2226392
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8404178619384766  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8404178619384766  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.669813632965088  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.670179843902588  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8414411544799805  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.3298988342285156  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.3298988342285156  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

first layer input nodes number: 2226392
first layer output nodes number: 1926723
edges number: 38482698
torch.Size([2226392, 100])
torch.Size([1926723, 256])
input nodes number: 1926723
output nodes number: 810500
edges number: 25217551
torch.Size([1926723, 256])
torch.Size([810500, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 9.304240226745605  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 9.312845706939697  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 2.092714786529541  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

pseudo mini batch 1 input nodes size: 2222773
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8414421081542969  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8414421081542969  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.6698145866394043  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.6701807975769043  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.840418815612793  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.3280372619628906  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.3280372619628906  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

first layer input nodes number: 2222773
first layer output nodes number: 1921303
edges number: 38393349
torch.Size([2222773, 100])
torch.Size([1921303, 256])
input nodes number: 1921303
output nodes number: 809594
edges number: 25195368
torch.Size([1921303, 256])
torch.Size([809594, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 9.283684253692627  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 9.29228925704956  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 2.089393138885498  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

pseudo mini batch 2 input nodes size: 2222616
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.840418815612793  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.840418815612793  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.668407917022705  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.668774127960205  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8400354385375977  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.3280620574951172  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.3280620574951172  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

first layer input nodes number: 2222616
first layer output nodes number: 1923721
edges number: 38438303
torch.Size([2222616, 100])
torch.Size([1923721, 256])
input nodes number: 1923721
output nodes number: 809829
edges number: 25208384
torch.Size([1923721, 256])
torch.Size([809829, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 9.291175365447998  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 9.299780368804932  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 2.090078830718994  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

pseudo mini batch 3 input nodes size: 2222957
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8400354385375977  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8400354385375977  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.668407917022705  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.668774127960205  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.840418815612793  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.328226089477539  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.328226089477539  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

first layer input nodes number: 2222957
first layer output nodes number: 1922325
edges number: 38418837
torch.Size([2222957, 100])
torch.Size([1922325, 256])
input nodes number: 1922325
output nodes number: 808998
edges number: 25181460
torch.Size([1922325, 256])
torch.Size([808998, 256])
torch.Size([49142, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 9.284621238708496  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 9.29322624206543  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 2.0894665718078613  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 2.0894665718078613  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 2.0894665718078613  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4815737009048462 |0.4349600672721863 |0.12499886751174927 |0.00015932321548461914 |0.0041522979736328125 |0.0037860870361328125 |
----------------------------------------------------------pseudo_mini_loss sum 3.633305072784424
Total (block generation + training)time/epoch 334.23509923617047
Training time/epoch 4.519922733306885
Training time without block to device /epoch 2.7800824642181396
Training time without total dataloading part /epoch 0.5210280418395996
load block tensor time/epoch 1.9262948036193848
block to device time/epoch 1.7398402690887451
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  19827731
Number of first layer input nodes during this epoch:  8894738
Number of first layer output nodes during this epoch:  7694072
----------------------------------------before generate dataloader block 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 2.089466094970703  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3051626682281494
number of batches is  4
batch size is  49143
range selection method spend 0.033910274505615234
time for parepare:  0.347609281539917
local_output_nid generation:  0.022217750549316406
local_in_edges_tensor generation:  0.04261016845703125
mini_batch_src_global generation:  0.0594632625579834
r_  generation:  0.9471356868743896
local_output_nid generation:  0.01516103744506836
local_in_edges_tensor generation:  0.023277997970581055
mini_batch_src_global generation:  0.08054542541503906
r_  generation:  1.053945779800415
local_output_nid generation:  0.015241622924804688
local_in_edges_tensor generation:  0.014984846115112305
mini_batch_src_global generation:  0.05608940124511719
r_  generation:  1.082028865814209
local_output_nid generation:  0.015903711318969727
local_in_edges_tensor generation:  0.016249656677246094
mini_batch_src_global generation:  0.06537246704101562
r_  generation:  1.1226494312286377
----------------------check_connections_block total spend ----------------------------- 5.688644647598267
generate_one_block  1.5507922172546387
generate_one_block  1.158682107925415
generate_one_block  1.2287468910217285
generate_one_block  1.3720917701721191
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.068809747695923
gen group dst list time:  0.10559558868408203
time for parepare:  0.4300823211669922
local_output_nid generation:  0.15781331062316895
local_in_edges_tensor generation:  0.6101007461547852
mini_batch_src_global generation:  0.7892751693725586
r_  generation:  10.953392267227173
local_output_nid generation:  0.2563169002532959
local_in_edges_tensor generation:  0.8069393634796143
mini_batch_src_global generation:  1.0342259407043457
r_  generation:  11.28724217414856
local_output_nid generation:  0.2739882469177246
local_in_edges_tensor generation:  0.7717189788818359
mini_batch_src_global generation:  0.991368293762207
r_  generation:  11.06391453742981
local_output_nid generation:  0.26930975914001465
local_in_edges_tensor generation:  0.6512775421142578
mini_batch_src_global generation:  1.0506572723388672
r_  generation:  11.217029809951782
----------------------check_connections_block total spend ----------------------------- 59.82047915458679
generate_one_block  14.525217533111572
generate_one_block  14.504440069198608
generate_one_block  14.133987665176392
generate_one_block  14.505173921585083
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.241675853729248
gen group dst list time:  0.2784585952758789
time for parepare:  0.45743727684020996
local_output_nid generation:  0.4450955390930176
local_in_edges_tensor generation:  1.1779069900512695
mini_batch_src_global generation:  1.2053022384643555
r_  generation:  17.41063928604126
local_output_nid generation:  0.6452431678771973
local_in_edges_tensor generation:  1.2727251052856445
mini_batch_src_global generation:  1.7226932048797607
r_  generation:  17.16354751586914
local_output_nid generation:  0.6472830772399902
local_in_edges_tensor generation:  1.4546749591827393
mini_batch_src_global generation:  1.7061185836791992
r_  generation:  17.390461921691895
local_output_nid generation:  0.6763341426849365
local_in_edges_tensor generation:  1.1707284450531006
mini_batch_src_global generation:  1.58201265335083
r_  generation:  17.492599487304688
----------------------check_connections_block total spend ----------------------------- 95.37644529342651
generate_one_block  22.56745743751526
generate_one_block  22.448184728622437
generate_one_block  23.008832693099976
generate_one_block  22.508753299713135
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 2.089466094970703  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

connection checking time:  155.1969244480133
block generation total time  148.20204734802246
average batch blocks generation time:  37.050511837005615
block dataloader generation time/epoch 328.7978426218033
pseudo mini batch 0 input nodes size: 2224077
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8404178619384766  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8404178619384766  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.6689515113830566  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.6693177223205566  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8405790328979492  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.32830810546875  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.32830810546875  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

first layer input nodes number: 2224077
first layer output nodes number: 1922467
edges number: 38407797
torch.Size([2224077, 100])
torch.Size([1922467, 256])
input nodes number: 1922467
output nodes number: 809947
edges number: 25198268
torch.Size([1922467, 256])
torch.Size([809947, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 9.288050174713135  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 9.296655654907227  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 2.0901784896850586  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

pseudo mini batch 1 input nodes size: 2224751
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8405799865722656  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8405799865722656  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.6693644523620605  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.6697306632995605  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8408308029174805  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.3285174369812012  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.3285174369812012  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

first layer input nodes number: 2224751
first layer output nodes number: 1922010
edges number: 38407064
torch.Size([2224751, 100])
torch.Size([1922010, 256])
input nodes number: 1922010
output nodes number: 809090
edges number: 25184011
torch.Size([1922010, 256])
torch.Size([809090, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 9.284340858459473  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 9.292945861816406  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 2.0897393226623535  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

pseudo mini batch 2 input nodes size: 2221904
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8408308029174805  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8408308029174805  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.6685547828674316  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.6689209938049316  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8397703170776367  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.3274297714233398  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.3274297714233398  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

first layer input nodes number: 2221904
first layer output nodes number: 1922315
edges number: 38420310
torch.Size([2221904, 100])
torch.Size([1922315, 256])
input nodes number: 1922315
output nodes number: 808762
edges number: 25172390
torch.Size([1922315, 256])
torch.Size([808762, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 9.283010005950928  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 9.291615009307861  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 2.0887651443481445  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

pseudo mini batch 3 input nodes size: 2224212
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8397703170776367  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8397703170776367  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.6685547828674316  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.6689209938049316  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 0.8408308029174805  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.3293342590332031  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 1.3293342590332031  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

first layer input nodes number: 2224212
first layer output nodes number: 1926024
edges number: 38508604
torch.Size([2224212, 100])
torch.Size([1926024, 256])
input nodes number: 1926024
output nodes number: 809191
edges number: 25199495
torch.Size([1926024, 256])
torch.Size([809191, 256])
torch.Size([49142, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 9.296717643737793  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.4022216796875 GB
    Memory Allocated: 9.305322647094727  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 2.0922670364379883  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 2.0922670364379883  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 2.0922670364379883  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.48675549030303955 |0.6240949034690857 |0.12486296892166138 |0.00014203786849975586 |0.006454110145568848 |0.002729654312133789 |
----------------------------------------------------------pseudo_mini_loss sum 4.501144886016846
Total (block generation + training)time/epoch 334.2216573357582
Training time/epoch 5.29880428314209
Training time without block to device /epoch 2.802424669265747
Training time without total dataloading part /epoch 0.5285661220550537
load block tensor time/epoch 1.9470219612121582
block to device time/epoch 2.4963796138763428
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  19824750
Number of first layer input nodes during this epoch:  8894944
Number of first layer output nodes during this epoch:  7692816
----------------------------------------before generate dataloader block 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 2.09226655960083  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.29992222785949707
number of batches is  4
batch size is  49143
range selection method spend 0.03331589698791504
time for parepare:  0.28792691230773926
local_output_nid generation:  0.012830257415771484
local_in_edges_tensor generation:  0.043268442153930664
mini_batch_src_global generation:  0.058551788330078125
r_  generation:  0.9040381908416748
local_output_nid generation:  0.014385461807250977
local_in_edges_tensor generation:  0.02213120460510254
mini_batch_src_global generation:  0.08131098747253418
r_  generation:  1.0116021633148193
local_output_nid generation:  0.014535903930664062
local_in_edges_tensor generation:  0.024280071258544922
mini_batch_src_global generation:  0.05653691291809082
r_  generation:  1.045281171798706
local_output_nid generation:  0.014192342758178711
local_in_edges_tensor generation:  0.022521495819091797
mini_batch_src_global generation:  0.06719851493835449
r_  generation:  1.1220357418060303
----------------------check_connections_block total spend ----------------------------- 5.4628801345825195
generate_one_block  1.6425611972808838
generate_one_block  1.4494884014129639
generate_one_block  1.1361401081085205
generate_one_block  1.132032871246338
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2161459922790527
gen group dst list time:  0.0971212387084961
time for parepare:  0.4288790225982666
local_output_nid generation:  0.15013360977172852
local_in_edges_tensor generation:  0.645627498626709
mini_batch_src_global generation:  0.7959074974060059
r_  generation:  11.031986474990845
local_output_nid generation:  0.2527472972869873
local_in_edges_tensor generation:  0.7325713634490967
mini_batch_src_global generation:  1.0222179889678955
r_  generation:  11.178974390029907
local_output_nid generation:  0.27402544021606445
local_in_edges_tensor generation:  0.9316303730010986
mini_batch_src_global generation:  1.0223157405853271
r_  generation:  10.997918367385864
local_output_nid generation:  0.26874351501464844
local_in_edges_tensor generation:  0.6650846004486084
mini_batch_src_global generation:  1.04709792137146
r_  generation:  11.466310739517212
----------------------check_connections_block total spend ----------------------------- 60.49009299278259
generate_one_block  14.456620454788208
generate_one_block  14.301435947418213
generate_one_block  14.537984848022461
generate_one_block  14.249458074569702
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.255189895629883
gen group dst list time:  0.283785343170166
time for parepare:  0.4435749053955078
local_output_nid generation:  0.4465522766113281
local_in_edges_tensor generation:  1.1043131351470947
mini_batch_src_global generation:  1.1735446453094482
r_  generation:  16.85273504257202
local_output_nid generation:  0.5879333019256592
local_in_edges_tensor generation:  1.267815113067627
mini_batch_src_global generation:  1.6154277324676514
r_  generation:  17.127842903137207
local_output_nid generation:  0.657240629196167
local_in_edges_tensor generation:  1.3111786842346191
mini_batch_src_global generation:  1.5996851921081543
r_  generation:  17.53550624847412
local_output_nid generation:  0.6808826923370361
local_in_edges_tensor generation:  1.2953693866729736
mini_batch_src_global generation:  1.5841035842895508
r_  generation:  17.780134677886963
----------------------check_connections_block total spend ----------------------------- 94.93736863136292
generate_one_block  22.667222499847412
generate_one_block  22.52215814590454
generate_one_block  23.119425773620605
generate_one_block  22.521445989608765
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 2.09226655960083  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

connection checking time:  155.4274616241455
block generation total time  148.3757517337799
average batch blocks generation time:  37.09393793344498
block dataloader generation time/epoch 328.88163871765136
pseudo mini batch 0 input nodes size: 2222199
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8408298492431641  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8408298492431641  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.668663501739502  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.669029712677002  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.839879035949707  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.3276524543762207  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.3276524543762207  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

first layer input nodes number: 2222199
first layer output nodes number: 1921414
edges number: 38402514
torch.Size([2222199, 100])
torch.Size([1921414, 256])
input nodes number: 1921414
output nodes number: 806510
edges number: 25119320
torch.Size([1921414, 256])
torch.Size([806510, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 9.27339220046997  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 9.281997680664062  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 2.087472438812256  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

pseudo mini batch 1 input nodes size: 2226318
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8398799896240234  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8398799896240234  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.669248104095459  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.669614315032959  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8414144515991211  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.3300514221191406  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.3300514221191406  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

first layer input nodes number: 2226318
first layer output nodes number: 1926239
edges number: 38480580
torch.Size([2226318, 100])
torch.Size([1926239, 256])
input nodes number: 1926239
output nodes number: 810990
edges number: 25243030
torch.Size([1926239, 256])
torch.Size([810990, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 9.30573320388794  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 9.314338207244873  GigaBytes
Max Memory Allocated: 10.813990592956543  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 2.09354829788208  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

pseudo mini batch 2 input nodes size: 2223905
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8414144515991211  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8414144515991211  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.6698837280273438  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.6702499389648438  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8405156135559082  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.3282980918884277  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.3282980918884277  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

first layer input nodes number: 2223905
first layer output nodes number: 1923452
edges number: 38434541
torch.Size([2223905, 100])
torch.Size([1923452, 256])
input nodes number: 1923452
output nodes number: 808693
edges number: 25177526
torch.Size([1923452, 256])
torch.Size([808693, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 9.287215232849121  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 9.295820236206055  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 2.09059476852417  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

pseudo mini batch 3 input nodes size: 2222735
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8405156135559082  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8405156135559082  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.6685490608215332  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.6689152717590332  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8400797843933105  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.3281149864196777  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.3281149864196777  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

first layer input nodes number: 2222735
first layer output nodes number: 1923608
edges number: 38433768
torch.Size([2222735, 100])
torch.Size([1923608, 256])
input nodes number: 1923608
output nodes number: 810266
edges number: 25212911
torch.Size([1923608, 256])
torch.Size([810266, 256])
torch.Size([49142, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 9.293416023254395  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 9.302021026611328  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 2.0903539657592773  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 2.0903539657592773  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 2.0903539657592773  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4669327139854431 |0.5662562847137451 |0.12844562530517578 |0.00016051530838012695 |0.004324674606323242 |0.0016541481018066406 |
----------------------------------------------------------pseudo_mini_loss sum 3.403103828430176
Total (block generation + training)time/epoch 334.22162914276123
Training time/epoch 5.004371643066406
Training time without block to device /epoch 2.739346504211426
Training time without total dataloading part /epoch 0.5333774089813232
load block tensor time/epoch 1.8677308559417725
block to device time/epoch 2.2650251388549805
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  19826329
Number of first layer input nodes during this epoch:  8895157
Number of first layer output nodes during this epoch:  7694713
----------------------------------------before generate dataloader block 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 2.090353488922119  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3099040985107422
number of batches is  4
batch size is  49143
range selection method spend 0.03888726234436035
time for parepare:  0.29970312118530273
local_output_nid generation:  0.01407480239868164
local_in_edges_tensor generation:  0.10303735733032227
mini_batch_src_global generation:  0.06406068801879883
r_  generation:  0.9321877956390381
local_output_nid generation:  0.014995098114013672
local_in_edges_tensor generation:  0.02305316925048828
mini_batch_src_global generation:  0.0798799991607666
r_  generation:  1.0071325302124023
local_output_nid generation:  0.01447606086730957
local_in_edges_tensor generation:  0.012653112411499023
mini_batch_src_global generation:  0.06076979637145996
r_  generation:  1.057638168334961
local_output_nid generation:  0.014619827270507812
local_in_edges_tensor generation:  0.015544652938842773
mini_batch_src_global generation:  0.06882047653198242
r_  generation:  1.1021182537078857
----------------------check_connections_block total spend ----------------------------- 5.553121089935303
generate_one_block  1.5353968143463135
generate_one_block  1.1503934860229492
generate_one_block  1.1566522121429443
generate_one_block  1.1523518562316895
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0480904579162598
gen group dst list time:  0.0911262035369873
time for parepare:  0.43520641326904297
local_output_nid generation:  0.15423893928527832
local_in_edges_tensor generation:  0.5908186435699463
mini_batch_src_global generation:  0.785649299621582
r_  generation:  10.454866647720337
local_output_nid generation:  0.24906015396118164
local_in_edges_tensor generation:  0.6257750988006592
mini_batch_src_global generation:  0.9893388748168945
r_  generation:  10.849372148513794
local_output_nid generation:  0.271561861038208
local_in_edges_tensor generation:  0.7814652919769287
mini_batch_src_global generation:  0.9885499477386475
r_  generation:  11.10023283958435
local_output_nid generation:  0.2760782241821289
local_in_edges_tensor generation:  0.7950131893157959
mini_batch_src_global generation:  1.053955316543579
r_  generation:  11.00941777229309
----------------------check_connections_block total spend ----------------------------- 58.658650159835815
generate_one_block  14.674801588058472
generate_one_block  14.540625810623169
generate_one_block  14.20251202583313
generate_one_block  14.544457912445068
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1437134742736816
gen group dst list time:  0.28502941131591797
time for parepare:  0.4266183376312256
local_output_nid generation:  0.4461040496826172
local_in_edges_tensor generation:  1.1142592430114746
mini_batch_src_global generation:  1.2066118717193604
r_  generation:  17.864084243774414
local_output_nid generation:  0.6322760581970215
local_in_edges_tensor generation:  1.268198013305664
mini_batch_src_global generation:  1.7426090240478516
r_  generation:  17.024014711380005
local_output_nid generation:  0.6485886573791504
local_in_edges_tensor generation:  1.2760519981384277
mini_batch_src_global generation:  1.661095142364502
r_  generation:  17.821594715118408
local_output_nid generation:  0.6806533336639404
local_in_edges_tensor generation:  1.3207697868347168
mini_batch_src_global generation:  1.6851141452789307
r_  generation:  17.202335357666016
----------------------check_connections_block total spend ----------------------------- 95.87524962425232
generate_one_block  22.461815357208252
generate_one_block  22.338369131088257
generate_one_block  22.724191427230835
generate_one_block  22.58163022994995
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 2.090353488922119  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

connection checking time:  154.53389978408813
block generation total time  148.06840348243713
average batch blocks generation time:  37.01710087060928
block dataloader generation time/epoch 328.6660217841466
pseudo mini batch 0 input nodes size: 2223621
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8403706550598145  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8403706550598145  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.668734073638916  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.669100284576416  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.840700626373291  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.3282074928283691  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.3282074928283691  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

first layer input nodes number: 2223621
first layer output nodes number: 1921868
edges number: 38421369
torch.Size([2223621, 100])
torch.Size([1921868, 256])
input nodes number: 1921868
output nodes number: 808181
edges number: 25153829
torch.Size([1921868, 256])
torch.Size([808181, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 9.280412197113037  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 9.289017677307129  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 2.088918685913086  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

pseudo mini batch 1 input nodes size: 2222840
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8404097557067871  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8404097557067871  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.6684823036193848  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.6688485145568848  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8401188850402832  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.3281207084655762  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.3281207084655762  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

first layer input nodes number: 2222840
first layer output nodes number: 1924313
edges number: 38446909
torch.Size([2222840, 100])
torch.Size([1924313, 256])
input nodes number: 1924313
output nodes number: 809249
edges number: 25192789
torch.Size([1924313, 256])
torch.Size([809249, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 9.291292667388916  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 9.29989767074585  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 2.0907044410705566  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

pseudo mini batch 2 input nodes size: 2222584
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8401188850402832  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8401188850402832  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.6680960655212402  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.6684622764587402  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8400235176086426  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.3285551071166992  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.3285551071166992  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

first layer input nodes number: 2222584
first layer output nodes number: 1924521
edges number: 38452553
torch.Size([2222584, 100])
torch.Size([1924521, 256])
input nodes number: 1924521
output nodes number: 810064
edges number: 25206313
torch.Size([1924521, 256])
torch.Size([810064, 256])
torch.Size([49143, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 9.295235633850098  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 9.303840637207031  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 2.090973377227783  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

pseudo mini batch 3 input nodes size: 2223208
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8400235176086426  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8400235176086426  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.6682333946228027  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.6685996055603027  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 0.8402562141418457  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.3283495903015137  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 1.3283495903015137  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

first layer input nodes number: 2223208
first layer output nodes number: 1922732
edges number: 38427581
torch.Size([2223208, 100])
torch.Size([1922732, 256])
input nodes number: 1922732
output nodes number: 809818
edges number: 25224497
torch.Size([1922732, 256])
torch.Size([809818, 256])
torch.Size([49142, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 9.288718223571777  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 9.297323226928711  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 2.0901246070861816  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 2.0901246070861816  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.2401123046875 GB
    Memory Allocated: 2.0901246070861816  GigaBytes
Max Memory Allocated: 10.814422130584717  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.48749321699142456 |0.5467942953109741 |0.12534958124160767 |0.00014275312423706055 |0.004216611385345459 |0.0013883113861083984 |
----------------------------------------------------------pseudo_mini_loss sum 2.23315167427063
Total (block generation + training)time/epoch 333.94795179367065
Training time/epoch 4.9914069175720215
Training time without block to device /epoch 2.804229736328125
Training time without total dataloading part /epoch 0.5202240943908691
load block tensor time/epoch 1.9499728679656982
block to device time/epoch 2.1871771812438965
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  19822999
Number of first layer input nodes during this epoch:  8892253
Number of first layer output nodes during this epoch:  7693434
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  206336
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([47, 256])
layers.2.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
