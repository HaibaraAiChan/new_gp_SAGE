main start at this time 1656618744.9547546
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3349602222442627
global_2_local spend time (sec) 0.4954071044921875
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.07899165153503418
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1181132, 40: 172537, 39: 816, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.11930084228515625
auxiliary_graph
Graph(num_nodes=1377703, num_edges=101856625,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.6100900173187256
remove nodes length  1181132

auxiliary_graph.remove_nodes spent  5.17531156539917
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=101856625,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  4.197108745574951

the counter of shared neighbor distribution
Counter({1.0: 76591578, 2.0: 14049546, 3.0: 5010892, 4.0: 2311722, 5.0: 1250786, 6.0: 739600, 7.0: 472478, 8.0: 320570, 9.0: 222488, 10.0: 161872, 11.0: 120832, 12.0: 90056, 13.0: 69248, 14.0: 53652, 15.0: 42676, 16.0: 31336, 17.0: 22028, 18.0: 19462, 19.0: 13316, 20.0: 10776, 21.0: 7196, 22.0: 5792, 23.0: 4758, 24.0: 3924, 25.0: 3444, 33.0: 2970, 28.0: 2904, 26.0: 2622, 30.0: 2388, 27.0: 2258, 32.0: 2096, 31.0: 2082, 39.0: 2070, 35.0: 1734, 29.0: 1726, 37.0: 1702, 36.0: 1500, 34.0: 1446, 38.0: 1436, 40.0: 1092})
101660054
Convert a graph into a bidirected graph: 6.848 seconds
Metis partitioning: 21.974 seconds
Split the graph: 11.679 seconds
Construct subgraphs: 0.017 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  40.55773043632507
95955
100616
total k batches seeds list generation spend  69.04713535308838
after graph partition
graph partition algorithm spend time 70.27461957931519
95955
100616
partition_len_list
[687362, 799449]
REG selection method  spend 71.01380753517151
time for parepare:  0.25957560539245605
local_output_nid generation:  0.017730712890625
local_in_edges_tensor generation:  0.06619930267333984
mini_batch_src_global generation:  0.11697268486022949
r_  generation:  1.5942485332489014
local_output_nid generation:  0.016704082489013672
local_in_edges_tensor generation:  0.07886624336242676
mini_batch_src_global generation:  0.15588712692260742
r_  generation:  1.745319128036499
----------------------check_connections_block total spend ----------------------------- 4.660340309143066
generate_one_block  3.4640073776245117
generate_one_block  1.9925618171691895
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.4395806789398193
gen group dst list time:  0.04846382141113281
time for parepare:  0.4474449157714844
local_output_nid generation:  0.13074827194213867
local_in_edges_tensor generation:  0.5290677547454834
mini_batch_src_global generation:  0.6214008331298828
r_  generation:  7.930639028549194
local_output_nid generation:  0.15511727333068848
local_in_edges_tensor generation:  0.571652889251709
mini_batch_src_global generation:  0.915410041809082
r_  generation:  10.265397548675537
----------------------check_connections_block total spend ----------------------------- 24.646689414978027
generate_one_block  10.560687780380249
generate_one_block  12.518492221832275
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.312864065170288
gen group dst list time:  0.13132214546203613
time for parepare:  0.46149587631225586
local_output_nid generation:  0.34275364875793457
local_in_edges_tensor generation:  0.9073588848114014
mini_batch_src_global generation:  0.931664228439331
r_  generation:  12.15150761604309
local_output_nid generation:  0.35009288787841797
local_in_edges_tensor generation:  0.7911546230316162
mini_batch_src_global generation:  1.307368516921997
r_  generation:  13.74415135383606
----------------------check_connections_block total spend ----------------------------- 35.662720918655396
generate_one_block  15.949681043624878
generate_one_block  17.2267005443573
----------===============-------------===============-------------the number of batches *****---- 2

original number of batches:  2
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

connection checking time:  64.96975064277649
block generation total time  61.7121307849884
average batch blocks generation time:  10.2853551308314
block dataloader generation time/epoch 208.40056538581848
pseudo mini batch 0 input nodes size: 2053590
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.7830810546875 GB
    Memory Allocated: 0.7663936614990234  GigaBytes
Max Memory Allocated: 0.7663936614990234  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.7830810546875 GB
    Memory Allocated: 0.7671089172363281  GigaBytes
Max Memory Allocated: 0.7671089172363281  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.7830810546875 GB
    Memory Allocated: 0.7671089172363281  GigaBytes
Max Memory Allocated: 0.7671089172363281  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 1.1499214172363281  GigaBytes
Max Memory Allocated: 1.1499214172363281  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2303466796875 GB
    Memory Allocated: 1.1499214172363281  GigaBytes
Max Memory Allocated: 1.1499214172363281  GigaBytes

first layer input nodes number: 2053590
first layer output nodes number: 1449518
edges number: 28284172
torch.Size([2053590, 100])
torch.Size([1449518, 256])
input nodes number: 1449518
output nodes number: 687362
edges number: 19189978
torch.Size([1449518, 256])
torch.Size([687362, 256])
torch.Size([95955, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 10.6737060546875 GB
    Memory Allocated: 7.4936089515686035  GigaBytes
Max Memory Allocated: 7.996246814727783  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 10.6737060546875 GB
    Memory Allocated: 7.510410785675049  GigaBytes
Max Memory Allocated: 7.996246814727783  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.1346435546875 GB
    Memory Allocated: 1.7780380249023438  GigaBytes
Max Memory Allocated: 8.72641658782959  GigaBytes

pseudo mini batch 1 input nodes size: 2042381
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.1346435546875 GB
    Memory Allocated: 0.7846794128417969  GigaBytes
Max Memory Allocated: 8.72641658782959  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.1346435546875 GB
    Memory Allocated: 0.7846794128417969  GigaBytes
Max Memory Allocated: 8.72641658782959  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.1346435546875 GB
    Memory Allocated: 1.5455260276794434  GigaBytes
Max Memory Allocated: 8.72641658782959  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.1346435546875 GB
    Memory Allocated: 1.5462760925292969  GigaBytes
Max Memory Allocated: 8.72641658782959  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.1346435546875 GB
    Memory Allocated: 0.7799358367919922  GigaBytes
Max Memory Allocated: 8.72641658782959  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.1346435546875 GB
    Memory Allocated: 1.2199487686157227  GigaBytes
Max Memory Allocated: 8.72641658782959  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1346435546875 GB
    Memory Allocated: 1.2199487686157227  GigaBytes
Max Memory Allocated: 8.72641658782959  GigaBytes

first layer input nodes number: 2042381
first layer output nodes number: 1540451
edges number: 31320166
torch.Size([2042381, 100])
torch.Size([1540451, 256])
input nodes number: 1540451
output nodes number: 799449
edges number: 23937917
torch.Size([1540451, 256])
torch.Size([799449, 256])
torch.Size([100616, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.6561279296875 GB
    Memory Allocated: 8.18855619430542  GigaBytes
Max Memory Allocated: 8.80752420425415  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.6561279296875 GB
    Memory Allocated: 8.206173419952393  GigaBytes
Max Memory Allocated: 8.80752420425415  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 1.9303336143493652  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 1.931870937347412  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 1.931870937347412  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.329592227935791 |0.6244176626205444 |0.49999141693115234 |0.00021255016326904297 |0.17632877826690674 |0.004720449447631836 |
----------------------------------------------------------pseudo_mini_loss sum 7.144423961639404
Total (block generation + training)time/epoch 211.75401902198792
Training time/epoch 3.353109359741211
Training time without block to device /epoch 2.104274034500122
Training time without total dataloading part /epoch 1.357785940170288
load block tensor time/epoch 0.659184455871582
block to device time/epoch 1.2488353252410889
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  8572751
Number of first layer input nodes during this epoch:  4095971
Number of first layer output nodes during this epoch:  2989969
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 1.931870460510254  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.4473264217376709
global_2_local spend time (sec) 0.5462794303894043
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.08273434638977051
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1181573, 40: 172537, 39: 816, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.12269043922424316
auxiliary_graph
Graph(num_nodes=1378144, num_edges=101440449,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.6447370052337646
remove nodes length  1181573

auxiliary_graph.remove_nodes spent  5.333470582962036
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=101440449,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  4.564173936843872

the counter of shared neighbor distribution
Counter({1.0: 76262470, 2.0: 13999502, 3.0: 4993082, 4.0: 2303996, 5.0: 1242502, 6.0: 739396, 7.0: 471654, 8.0: 318818, 9.0: 223652, 10.0: 162218, 11.0: 119508, 12.0: 90236, 13.0: 68272, 14.0: 52940, 15.0: 42884, 16.0: 30994, 17.0: 22020, 18.0: 20014, 19.0: 13430, 20.0: 10922, 21.0: 7462, 22.0: 5748, 23.0: 4694, 24.0: 3946, 25.0: 3448, 33.0: 2964, 28.0: 2830, 26.0: 2556, 30.0: 2394, 27.0: 2196, 32.0: 2176, 31.0: 2104, 39.0: 2086, 29.0: 1842, 35.0: 1724, 37.0: 1628, 36.0: 1536, 38.0: 1480, 34.0: 1476, 40.0: 1078})
101243878
Convert a graph into a bidirected graph: 6.698 seconds
Metis partitioning: 23.028 seconds
Split the graph: 10.603 seconds
Construct subgraphs: 0.012 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  40.37910532951355
96777
99794
total k batches seeds list generation spend  69.62441325187683
after graph partition
graph partition algorithm spend time 70.83092069625854
96777
99794
partition_len_list
[695822, 793187]
REG selection method  spend 71.65771818161011
time for parepare:  0.27185630798339844
local_output_nid generation:  0.014731884002685547
local_in_edges_tensor generation:  0.03942465782165527
mini_batch_src_global generation:  0.11743879318237305
r_  generation:  1.5388777256011963
local_output_nid generation:  0.015548467636108398
local_in_edges_tensor generation:  0.1308140754699707
mini_batch_src_global generation:  0.15480899810791016
r_  generation:  1.6838712692260742
----------------------check_connections_block total spend ----------------------------- 4.579646825790405
generate_one_block  2.327078342437744
generate_one_block  2.058244228363037
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1878256797790527
gen group dst list time:  0.044400930404663086
time for parepare:  0.43030714988708496
local_output_nid generation:  0.14078617095947266
local_in_edges_tensor generation:  0.5114889144897461
mini_batch_src_global generation:  0.6341772079467773
r_  generation:  7.998953580856323
local_output_nid generation:  0.16412878036499023
local_in_edges_tensor generation:  0.5006239414215088
mini_batch_src_global generation:  0.9134659767150879
r_  generation:  9.958505153656006
----------------------check_connections_block total spend ----------------------------- 24.316815853118896
generate_one_block  10.81504201889038
generate_one_block  12.993385076522827
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2697083950042725
gen group dst list time:  0.1045997142791748
time for parepare:  0.4836001396179199
local_output_nid generation:  0.35214781761169434
local_in_edges_tensor generation:  0.9443860054016113
mini_batch_src_global generation:  0.9375026226043701
r_  generation:  12.265230655670166
local_output_nid generation:  0.3726356029510498
local_in_edges_tensor generation:  0.9616131782531738
mini_batch_src_global generation:  1.3761656284332275
r_  generation:  13.735185623168945
----------------------check_connections_block total spend ----------------------------- 36.164467096328735
generate_one_block  16.178675889968872
generate_one_block  17.58649516105652
----------===============-------------===============-------------the number of batches *****---- 2

original number of batches:  2
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 1.931870460510254  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

connection checking time:  65.06092977523804
block generation total time  61.95892071723938
average batch blocks generation time:  10.326486786206564
block dataloader generation time/epoch 208.92013955116272
pseudo mini batch 0 input nodes size: 2058538
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 0.7822880744934082  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 0.7822880744934082  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 1.5491533279418945  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 1.5498747825622559  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 0.7882781028747559  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 1.1733508110046387  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 1.1733508110046387  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

first layer input nodes number: 2058538
first layer output nodes number: 1463257
edges number: 28575620
torch.Size([2058538, 100])
torch.Size([1463257, 256])
input nodes number: 1463257
output nodes number: 695822
edges number: 19437722
torch.Size([1463257, 256])
torch.Size([695822, 256])
torch.Size([96777, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 7.563509941101074  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 7.580455780029297  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 1.7904052734375  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

pseudo mini batch 1 input nodes size: 2040073
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 0.7876071929931641  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 0.7876071929931641  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 1.5475940704345703  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 1.5483379364013672  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 0.7807512283325195  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 1.220163345336914  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2147216796875 GB
    Memory Allocated: 1.220163345336914  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

first layer input nodes number: 2040073
first layer output nodes number: 1543612
edges number: 31456638
torch.Size([2040073, 100])
torch.Size([1543612, 256])
input nodes number: 1543612
output nodes number: 793187
edges number: 23749698
torch.Size([1543612, 256])
torch.Size([793187, 256])
torch.Size([99794, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.2889404296875 GB
    Memory Allocated: 8.177178859710693  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.2889404296875 GB
    Memory Allocated: 8.194652557373047  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.5213623046875 GB
    Memory Allocated: 1.9281396865844727  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.5213623046875 GB
    Memory Allocated: 1.9281396865844727  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.5213623046875 GB
    Memory Allocated: 1.9281396865844727  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.40753114223480225 |0.4865328073501587 |0.2627347707748413 |0.00020170211791992188 |0.09139668941497803 |0.003917217254638672 |
----------------------------------------------------------pseudo_mini_loss sum 12.478567123413086
Total (block generation + training)time/epoch 211.9171245098114
Training time/epoch 2.640252113342285
Training time without block to device /epoch 1.6671864986419678
Training time without total dataloading part /epoch 0.7125835418701172
load block tensor time/epoch 0.8150622844696045
block to device time/epoch 0.9730656147003174
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  8594489
Number of first layer input nodes during this epoch:  4098611
Number of first layer output nodes during this epoch:  3006869
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.5213623046875 GB
    Memory Allocated: 1.9281392097473145  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.4157886505126953
global_2_local spend time (sec) 0.5212528705596924
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.036124467849731445
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1181078, 40: 172537, 39: 816, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.11939454078674316
auxiliary_graph
Graph(num_nodes=1377649, num_edges=101592085,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.6377623081207275
remove nodes length  1181078

auxiliary_graph.remove_nodes spent  5.418801307678223
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=101592085,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  4.242013931274414

the counter of shared neighbor distribution
Counter({1.0: 76339074, 2.0: 14045470, 3.0: 5010672, 4.0: 2310438, 5.0: 1250692, 6.0: 739836, 7.0: 471014, 8.0: 320252, 9.0: 222946, 10.0: 161434, 11.0: 118206, 12.0: 90108, 13.0: 68208, 14.0: 53080, 15.0: 42064, 16.0: 31386, 17.0: 22226, 18.0: 19100, 19.0: 13390, 20.0: 10732, 21.0: 7146, 22.0: 5532, 23.0: 4856, 24.0: 3998, 25.0: 3558, 33.0: 3082, 28.0: 2884, 26.0: 2734, 30.0: 2352, 27.0: 2180, 39.0: 2092, 31.0: 2088, 32.0: 2088, 29.0: 1736, 35.0: 1716, 37.0: 1686, 36.0: 1476, 38.0: 1450, 34.0: 1444, 40.0: 1088})
101395514
Convert a graph into a bidirected graph: 7.210 seconds
Metis partitioning: 24.037 seconds
Split the graph: 11.423 seconds
Construct subgraphs: 0.016 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  42.7239465713501
95441
101130
total k batches seeds list generation spend  71.71522355079651
after graph partition
graph partition algorithm spend time 72.99238109588623
95441
101130
partition_len_list
[693981, 800054]
REG selection method  spend 73.76618123054504
time for parepare:  0.26772022247314453
local_output_nid generation:  0.016186952590942383
local_in_edges_tensor generation:  0.02841663360595703
mini_batch_src_global generation:  0.1191103458404541
r_  generation:  1.423112392425537
local_output_nid generation:  0.01729559898376465
local_in_edges_tensor generation:  0.06546282768249512
mini_batch_src_global generation:  0.15215754508972168
r_  generation:  1.741912603378296
----------------------check_connections_block total spend ----------------------------- 4.4326348304748535
generate_one_block  2.2839202880859375
generate_one_block  2.0841662883758545
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2201027870178223
gen group dst list time:  0.05153059959411621
time for parepare:  0.46083974838256836
local_output_nid generation:  0.14445734024047852
local_in_edges_tensor generation:  0.5375418663024902
mini_batch_src_global generation:  0.6365678310394287
r_  generation:  7.905297517776489
local_output_nid generation:  0.16203594207763672
local_in_edges_tensor generation:  0.5775237083435059
mini_batch_src_global generation:  0.9353582859039307
r_  generation:  10.016193628311157
----------------------check_connections_block total spend ----------------------------- 24.581642389297485
generate_one_block  10.912707328796387
generate_one_block  12.811401844024658
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.254585027694702
gen group dst list time:  0.11810064315795898
time for parepare:  0.43972277641296387
local_output_nid generation:  0.36011528968811035
local_in_edges_tensor generation:  0.88749098777771
mini_batch_src_global generation:  0.9472494125366211
r_  generation:  12.513221979141235
local_output_nid generation:  0.36904382705688477
local_in_edges_tensor generation:  1.0791215896606445
mini_batch_src_global generation:  1.333263874053955
r_  generation:  13.746488094329834
----------------------check_connections_block total spend ----------------------------- 36.306723833084106
generate_one_block  16.935805559158325
generate_one_block  17.458720684051514
----------===============-------------===============-------------the number of batches *****---- 2

original number of batches:  2
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.5213623046875 GB
    Memory Allocated: 1.9281392097473145  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

connection checking time:  65.32100105285645
block generation total time  62.486721992492676
average batch blocks generation time:  10.414453665415445
block dataloader generation time/epoch 210.06210207939148
pseudo mini batch 0 input nodes size: 2087666
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.5213623046875 GB
    Memory Allocated: 0.7812786102294922  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.5213623046875 GB
    Memory Allocated: 0.7812786102294922  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.5213623046875 GB
    Memory Allocated: 1.558995246887207  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.5213623046875 GB
    Memory Allocated: 1.559706687927246  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.5213623046875 GB
    Memory Allocated: 0.798975944519043  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.5213623046875 GB
    Memory Allocated: 1.1867198944091797  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5213623046875 GB
    Memory Allocated: 1.1867198944091797  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

first layer input nodes number: 2087666
first layer output nodes number: 1492168
edges number: 29070287
torch.Size([2087666, 100])
torch.Size([1492168, 256])
input nodes number: 1492168
output nodes number: 693981
edges number: 19271474
torch.Size([1492168, 256])
torch.Size([693981, 256])
torch.Size([95441, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.5213623046875 GB
    Memory Allocated: 7.645299434661865  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.5213623046875 GB
    Memory Allocated: 7.66201114654541  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.9451904296875 GB
    Memory Allocated: 1.8045291900634766  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

pseudo mini batch 1 input nodes size: 2012958
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.9451904296875 GB
    Memory Allocated: 0.7989301681518555  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.9451904296875 GB
    Memory Allocated: 0.7989301681518555  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.9451904296875 GB
    Memory Allocated: 1.5488157272338867  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.9451904296875 GB
    Memory Allocated: 1.5495696067810059  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.9451904296875 GB
    Memory Allocated: 0.771141529083252  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.9451904296875 GB
    Memory Allocated: 1.210808277130127  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9451904296875 GB
    Memory Allocated: 1.210808277130127  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

first layer input nodes number: 2012958
first layer output nodes number: 1524495
edges number: 31097244
torch.Size([2012958, 100])
torch.Size([1524495, 256])
input nodes number: 1524495
output nodes number: 800054
edges number: 24086238
torch.Size([1524495, 256])
torch.Size([800054, 256])
torch.Size([101130, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.9471435546875 GB
    Memory Allocated: 8.140190124511719  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.9471435546875 GB
    Memory Allocated: 8.157897472381592  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.9207959175109863  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.9207959175109863  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.9207959175109863  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4139620065689087 |0.48111891746520996 |0.10631668567657471 |0.00018131732940673828 |0.011501431465148926 |0.003895998001098633 |
----------------------------------------------------------pseudo_mini_loss sum 3.6362850666046143
Total (block generation + training)time/epoch 212.8346130847931
Training time/epoch 2.323302745819092
Training time without block to device /epoch 1.3610649108886719
Training time without total dataloading part /epoch 0.23989486694335938
load block tensor time/epoch 0.8279240131378174
block to device time/epoch 0.9622378349304199
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  8611322
Number of first layer input nodes during this epoch:  4100624
Number of first layer output nodes during this epoch:  3016663
----------------------------------------before generate dataloader block 
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.9207954406738281  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.36214208602905273
global_2_local spend time (sec) 0.5864884853363037
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.03673052787780762
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1181035, 40: 172537, 39: 816, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.12615084648132324
auxiliary_graph
Graph(num_nodes=1377606, num_edges=101674287,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.6181185245513916
remove nodes length  1181035

auxiliary_graph.remove_nodes spent  5.582069396972656
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=101674287,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  4.241164445877075

the counter of shared neighbor distribution
Counter({1.0: 76438302, 2.0: 14044614, 3.0: 5010044, 4.0: 2306628, 5.0: 1243674, 6.0: 737406, 7.0: 470430, 8.0: 317834, 9.0: 224420, 10.0: 161934, 11.0: 118450, 12.0: 89198, 13.0: 68550, 14.0: 52286, 15.0: 42424, 16.0: 31166, 17.0: 21944, 18.0: 19188, 19.0: 13520, 20.0: 10676, 21.0: 6852, 22.0: 5766, 23.0: 4726, 24.0: 4066, 25.0: 3670, 33.0: 2968, 28.0: 2830, 26.0: 2596, 30.0: 2356, 27.0: 2246, 31.0: 2206, 39.0: 2084, 32.0: 2044, 35.0: 1740, 29.0: 1672, 37.0: 1660, 36.0: 1542, 34.0: 1470, 38.0: 1456, 40.0: 1078})
101477716
Convert a graph into a bidirected graph: 6.728 seconds
Metis partitioning: 23.764 seconds
Split the graph: 9.885 seconds
Construct subgraphs: 0.011 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  40.425841093063354
98048
98523
total k batches seeds list generation spend  69.79965090751648
after graph partition
graph partition algorithm spend time 70.92237377166748
98048
98523
partition_len_list
[707113, 782210]
REG selection method  spend 71.76825022697449
time for parepare:  0.2645106315612793
local_output_nid generation:  0.01443338394165039
local_in_edges_tensor generation:  0.04865670204162598
mini_batch_src_global generation:  0.1304759979248047
r_  generation:  1.5172364711761475
local_output_nid generation:  0.015621185302734375
local_in_edges_tensor generation:  0.08222794532775879
mini_batch_src_global generation:  0.15283942222595215
r_  generation:  1.6337788105010986
----------------------check_connections_block total spend ----------------------------- 4.453801155090332
generate_one_block  2.3340046405792236
generate_one_block  2.1299428939819336
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2915992736816406
gen group dst list time:  0.043828487396240234
time for parepare:  0.42979001998901367
local_output_nid generation:  0.14101099967956543
local_in_edges_tensor generation:  0.5332574844360352
mini_batch_src_global generation:  0.6420714855194092
r_  generation:  7.975307464599609
local_output_nid generation:  0.18024110794067383
local_in_edges_tensor generation:  0.49874305725097656
mini_batch_src_global generation:  0.9202098846435547
r_  generation:  9.595215082168579
----------------------check_connections_block total spend ----------------------------- 24.071873426437378
generate_one_block  10.743704319000244
generate_one_block  12.52054738998413
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3468194007873535
gen group dst list time:  0.14144563674926758
time for parepare:  0.4444737434387207
local_output_nid generation:  0.39977598190307617
local_in_edges_tensor generation:  0.9534134864807129
mini_batch_src_global generation:  0.9699790477752686
r_  generation:  12.924272775650024
local_output_nid generation:  0.4248623847961426
local_in_edges_tensor generation:  0.9492497444152832
mini_batch_src_global generation:  1.2637524604797363
r_  generation:  13.887324571609497
----------------------check_connections_block total spend ----------------------------- 36.94717335700989
generate_one_block  16.573535680770874
generate_one_block  17.00219964981079
----------===============-------------===============-------------the number of batches *****---- 2

original number of batches:  2
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.9207954406738281  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

connection checking time:  65.4728479385376
block generation total time  61.3039345741272
average batch blocks generation time:  10.2173224290212
block dataloader generation time/epoch 209.9091473221779
pseudo mini batch 0 input nodes size: 2080478
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 0.771420955657959  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 0.771420955657959  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.546459674835205  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.5471901893615723  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 0.7965507507324219  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.1888494491577148  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.1888494491577148  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

first layer input nodes number: 2080478
first layer output nodes number: 1497419
edges number: 29240140
torch.Size([2080478, 100])
torch.Size([1497419, 256])
input nodes number: 1497419
output nodes number: 707113
edges number: 19703777
torch.Size([1497419, 256])
torch.Size([707113, 256])
torch.Size([98048, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 7.709105968475342  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 7.726274013519287  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.8160042762756348  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

pseudo mini batch 1 input nodes size: 2018849
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 0.7960119247436523  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 0.7960119247436523  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.5480918884277344  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.5488262176513672  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 0.7730569839477539  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.2080678939819336  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.2080678939819336  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

first layer input nodes number: 2018849
first layer output nodes number: 1523274
edges number: 31159871
torch.Size([2018849, 100])
torch.Size([1523274, 256])
input nodes number: 1523274
output nodes number: 782210
edges number: 23504930
torch.Size([1523274, 256])
torch.Size([782210, 256])
torch.Size([98523, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 8.071730613708496  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 8.088981628417969  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.9083247184753418  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.9083247184753418  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.9083247184753418  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.40993034839630127 |0.48907434940338135 |0.10085320472717285 |0.0001819133758544922 |0.0026682615280151367 |0.0012354850769042969 |
----------------------------------------------------------pseudo_mini_loss sum 4.44549036026001
Total (block generation + training)time/epoch 212.56758505105972
Training time/epoch 2.3159823417663574
Training time without block to device /epoch 1.3378336429595947
Training time without total dataloading part /epoch 0.20864224433898926
load block tensor time/epoch 0.8198606967926025
block to device time/epoch 0.9781486988067627
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  8609343
Number of first layer input nodes during this epoch:  4099327
Number of first layer output nodes during this epoch:  3020693
----------------------------------------before generate dataloader block 
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.9083242416381836  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3595390319824219
global_2_local spend time (sec) 0.6101088523864746
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.036559343338012695
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1180944, 40: 172537, 39: 816, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.12940597534179688
auxiliary_graph
Graph(num_nodes=1377515, num_edges=101823085,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.6264834403991699
remove nodes length  1180944

auxiliary_graph.remove_nodes spent  5.165901184082031
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=101823085,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  4.217156887054443

the counter of shared neighbor distribution
Counter({1.0: 76547122, 2.0: 14056272, 3.0: 5017922, 4.0: 2311666, 5.0: 1247774, 6.0: 739896, 7.0: 471840, 8.0: 321294, 9.0: 224538, 10.0: 162872, 11.0: 119210, 12.0: 90016, 13.0: 68792, 14.0: 52750, 15.0: 42010, 16.0: 30888, 17.0: 21954, 18.0: 19466, 19.0: 13842, 20.0: 10936, 21.0: 7212, 22.0: 5854, 23.0: 4770, 24.0: 4078, 25.0: 3548, 33.0: 2986, 28.0: 2878, 26.0: 2574, 30.0: 2376, 27.0: 2218, 31.0: 2152, 39.0: 2088, 32.0: 2030, 29.0: 1774, 35.0: 1730, 37.0: 1692, 36.0: 1502, 38.0: 1458, 34.0: 1450, 40.0: 1084})
101626514
Convert a graph into a bidirected graph: 6.505 seconds
Metis partitioning: 23.554 seconds
Split the graph: 10.552 seconds
Construct subgraphs: 0.025 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  40.67539191246033
98266
98305
total k batches seeds list generation spend  69.03603434562683
after graph partition
graph partition algorithm spend time 70.24429273605347
98266
98305
partition_len_list
[703758, 781549]
REG selection method  spend 71.14912486076355
time for parepare:  0.2687044143676758
local_output_nid generation:  0.014869928359985352
local_in_edges_tensor generation:  0.04594898223876953
mini_batch_src_global generation:  0.12438249588012695
r_  generation:  1.6672580242156982
local_output_nid generation:  0.015568971633911133
local_in_edges_tensor generation:  0.08960509300231934
mini_batch_src_global generation:  0.15085673332214355
r_  generation:  1.7278523445129395
----------------------check_connections_block total spend ----------------------------- 4.69624924659729
generate_one_block  2.3138060569763184
generate_one_block  2.1439428329467773
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.188594102859497
gen group dst list time:  0.0440976619720459
time for parepare:  0.4167017936706543
local_output_nid generation:  0.13237500190734863
local_in_edges_tensor generation:  0.5305783748626709
mini_batch_src_global generation:  0.6491379737854004
r_  generation:  8.021486759185791
local_output_nid generation:  0.15677905082702637
local_in_edges_tensor generation:  0.48070549964904785
mini_batch_src_global generation:  0.9166355133056641
r_  generation:  9.540629863739014
----------------------check_connections_block total spend ----------------------------- 23.94344663619995
generate_one_block  10.297369718551636
generate_one_block  12.418689489364624
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2684011459350586
gen group dst list time:  0.11330819129943848
time for parepare:  0.4466819763183594
local_output_nid generation:  0.3422844409942627
local_in_edges_tensor generation:  0.9493153095245361
mini_batch_src_global generation:  0.9397518634796143
r_  generation:  12.25427794456482
local_output_nid generation:  0.3393683433532715
local_in_edges_tensor generation:  0.9336228370666504
mini_batch_src_global generation:  1.2954368591308594
r_  generation:  13.231055498123169
----------------------check_connections_block total spend ----------------------------- 35.37269687652588
generate_one_block  16.242337942123413
generate_one_block  17.04151940345764
----------===============-------------===============-------------the number of batches *****---- 2

original number of batches:  2
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.9083242416381836  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

connection checking time:  64.01239275932312
block generation total time  60.45766544342041
average batch blocks generation time:  10.076277573903402
block dataloader generation time/epoch 209.2134539604187
pseudo mini batch 0 input nodes size: 2079040
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 0.7737946510314941  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 0.7737946510314941  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.54829740524292  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.54902982711792  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 0.7962155342102051  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.1865620613098145  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.1865620613098145  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

first layer input nodes number: 2079040
first layer output nodes number: 1481743
edges number: 28950140
torch.Size([2079040, 100])
torch.Size([1481743, 256])
input nodes number: 1481743
output nodes number: 703758
edges number: 19658916
torch.Size([1481743, 256])
torch.Size([703758, 256])
torch.Size([98266, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 7.654653549194336  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 7.671860218048096  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.8109188079833984  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

pseudo mini batch 1 input nodes size: 2027865
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 0.7955164909362793  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 0.7955164909362793  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.5509552955627441  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.5516881942749023  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 0.7764530181884766  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.2093477249145508  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 1.2093477249145508  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

first layer input nodes number: 2027865
first layer output nodes number: 1520878
edges number: 30983389
torch.Size([2027865, 100])
torch.Size([1520878, 256])
input nodes number: 1520878
output nodes number: 781549
edges number: 23406520
torch.Size([1520878, 256])
torch.Size([781549, 256])
torch.Size([98305, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 8.06262731552124  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.7108154296875 GB
    Memory Allocated: 8.079840183258057  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 1.905961036682129  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 1.905961036682129  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 1.905961036682129  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.41508758068084717 |0.3812452554702759 |0.10205268859863281 |0.00019311904907226562 |0.004808664321899414 |0.0012352466583251953 |
----------------------------------------------------------pseudo_mini_loss sum 3.3667609691619873
Total (block generation + training)time/epoch 211.76277842521668
Training time/epoch 2.1126112937927246
Training time without block to device /epoch 1.3501207828521729
Training time without total dataloading part /epoch 0.21534419059753418
load block tensor time/epoch 0.8301751613616943
block to device time/epoch 0.7624905109405518
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  8594833
Number of first layer input nodes during this epoch:  4106905
Number of first layer output nodes during this epoch:  3002621
----------------------------------------before generate dataloader block 
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 1.9059605598449707  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.33226633071899414
global_2_local spend time (sec) 0.529313325881958
----------------------------  graph partition start---------------------
g = dgl.graph((u,v))  spent  0.05022788047790527
the counter of in-degree current block !!!!!!!!!!!!!!_______________!!!!!!!!!!
Counter({0: 1180968, 40: 172537, 39: 816, 33: 793, 37: 791, 38: 775, 28: 768, 35: 754, 36: 741, 32: 727, 14: 695, 31: 691, 30: 689, 34: 677, 15: 673, 25: 671, 26: 659, 7: 655, 23: 648, 27: 646, 24: 645, 29: 643, 10: 640, 11: 624, 13: 615, 16: 614, 18: 604, 22: 592, 21: 586, 19: 584, 12: 583, 9: 576, 20: 572, 17: 556, 6: 550, 8: 512, 4: 456, 5: 445, 3: 374, 2: 221, 1: 173})

A = g.adjacency_matrix() spent  0.12210392951965332
auxiliary_graph
Graph(num_nodes=1377539, num_edges=101778399,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
get remove nodes spent  0.5985455513000488
remove nodes length  1180968

auxiliary_graph.remove_nodes spent  5.25544285774231
after remove non output nodes the auxiliary_graph
Graph(num_nodes=196571, num_edges=101778399,
      ndata_schemes={}
      edata_schemes={'w': Scheme(shape=(), dtype=torch.float32)})
auxiliary_graph_no_diag generation spent  4.207773208618164

the counter of shared neighbor distribution
Counter({1.0: 76534596, 2.0: 14039790, 3.0: 5006502, 4.0: 2312414, 5.0: 1247454, 6.0: 739086, 7.0: 470314, 8.0: 321348, 9.0: 224020, 10.0: 161382, 11.0: 118914, 12.0: 90378, 13.0: 69162, 14.0: 52818, 15.0: 41862, 16.0: 30822, 17.0: 21642, 18.0: 19400, 19.0: 13432, 20.0: 10984, 21.0: 7158, 22.0: 5670, 23.0: 5046, 24.0: 4118, 25.0: 3436, 28.0: 2922, 33.0: 2914, 26.0: 2610, 30.0: 2360, 27.0: 2328, 32.0: 2094, 39.0: 2088, 31.0: 2076, 29.0: 1772, 35.0: 1676, 37.0: 1662, 36.0: 1516, 34.0: 1496, 38.0: 1486, 40.0: 1080})
101581828
Convert a graph into a bidirected graph: 6.530 seconds
Metis partitioning: 23.867 seconds
Split the graph: 11.274 seconds
Construct subgraphs: 0.018 seconds
auxiliary_graph_no_diag dgl.metis_partition spent  41.728209257125854
98502
98069
total k batches seeds list generation spend  70.12025475502014
after graph partition
graph partition algorithm spend time 71.22062420845032
98502
98069
partition_len_list
[781732, 706337]
REG selection method  spend 71.98914575576782
time for parepare:  0.26143479347229004
local_output_nid generation:  0.014450788497924805
local_in_edges_tensor generation:  0.02878403663635254
mini_batch_src_global generation:  0.12339901924133301
r_  generation:  1.5299065113067627
local_output_nid generation:  0.01590442657470703
local_in_edges_tensor generation:  0.06792831420898438
mini_batch_src_global generation:  0.15282773971557617
r_  generation:  1.6010291576385498
----------------------check_connections_block total spend ----------------------------- 4.392674207687378
generate_one_block  2.3646390438079834
generate_one_block  1.8976566791534424
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.341644763946533
gen group dst list time:  0.04377627372741699
time for parepare:  0.4240841865539551
local_output_nid generation:  0.17801713943481445
local_in_edges_tensor generation:  0.6052844524383545
mini_batch_src_global generation:  0.7654149532318115
r_  generation:  9.596964120864868
local_output_nid generation:  0.16655206680297852
local_in_edges_tensor generation:  0.5744740962982178
mini_batch_src_global generation:  0.9453263282775879
r_  generation:  8.275837182998657
----------------------check_connections_block total spend ----------------------------- 24.68221402168274
generate_one_block  12.719220876693726
generate_one_block  10.348888158798218
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3531076908111572
gen group dst list time:  0.11721444129943848
time for parepare:  0.44037699699401855
local_output_nid generation:  0.36341428756713867
local_in_edges_tensor generation:  0.9549784660339355
mini_batch_src_global generation:  1.017401933670044
r_  generation:  13.239474773406982
local_output_nid generation:  0.4164619445800781
local_in_edges_tensor generation:  0.7884676456451416
mini_batch_src_global generation:  1.248938798904419
r_  generation:  12.715003252029419
----------------------check_connections_block total spend ----------------------------- 35.81536602973938
generate_one_block  18.136406183242798
generate_one_block  15.785908222198486
----------===============-------------===============-------------the number of batches *****---- 2

original number of batches:  2
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 1.9059605598449707  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

connection checking time:  64.8902542591095
block generation total time  61.25271916389465
average batch blocks generation time:  10.208786527315775
block dataloader generation time/epoch 209.172914425532
pseudo mini batch 0 input nodes size: 2025261
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 0.776458740234375  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 0.776458740234375  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 1.5309276580810547  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 1.5316619873046875  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 0.7754902839660645  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 1.2107481956481934  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 1.2107481956481934  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

first layer input nodes number: 2025261
first layer output nodes number: 1526498
edges number: 31219093
torch.Size([2025261, 100])
torch.Size([1526498, 256])
input nodes number: 1526498
output nodes number: 781732
edges number: 23480093
torch.Size([1526498, 256])
torch.Size([781732, 256])
torch.Size([98502, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 8.081493854522705  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 8.09964895248413  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 1.9111785888671875  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

pseudo mini batch 1 input nodes size: 2073857
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 0.7762770652770996  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 0.7762770652770996  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 1.548849105834961  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 1.5495800971984863  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 0.7943768501281738  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 1.1856718063354492  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 1.1856718063354492  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

first layer input nodes number: 2073857
first layer output nodes number: 1490054
edges number: 29073790
torch.Size([2073857, 100])
torch.Size([1490054, 256])
input nodes number: 1490054
output nodes number: 706337
edges number: 19698811
torch.Size([1490054, 256])
torch.Size([706337, 256])
torch.Size([98069, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 7.68336296081543  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 7.7006516456604  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 1.8108453750610352  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 1.8108453750610352  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.1619873046875 GB
    Memory Allocated: 1.8108453750610352  GigaBytes
Max Memory Allocated: 9.631208419799805  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4237351417541504 |0.4959075450897217 |0.10065281391143799 |0.0001838207244873047 |0.004150509834289551 |0.0012488365173339844 |
----------------------------------------------------------pseudo_mini_loss sum 2.214245557785034
Total (block generation + training)time/epoch 211.68643434842429
Training time/epoch 2.334240198135376
Training time without block to device /epoch 1.3424251079559326
Training time without total dataloading part /epoch 0.21122312545776367
load block tensor time/epoch 0.8474702835083008
block to device time/epoch 0.9918150901794434
input features size transfer per epoch 2.682209014892578e-07
blocks size to device per epoch 1.7881393432617188e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  8603739
Number of first layer input nodes during this epoch:  4099118
Number of first layer output nodes during this epoch:  3016552
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  206336
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([47, 256])
layers.2.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
