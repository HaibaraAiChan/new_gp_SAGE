main start at this time 1656631064.1830313
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.32470273971557617
number of batches is  16
batch size is  12286
random selection method spend 0.01419377326965332
time for parepare:  0.27507495880126953
local_output_nid generation:  0.006049394607543945
local_in_edges_tensor generation:  0.0258176326751709
mini_batch_src_global generation:  0.014750480651855469
r_  generation:  0.17032456398010254
local_output_nid generation:  0.006994009017944336
local_in_edges_tensor generation:  0.0067555904388427734
mini_batch_src_global generation:  0.018901348114013672
r_  generation:  0.19231057167053223
local_output_nid generation:  0.006908893585205078
local_in_edges_tensor generation:  0.006706714630126953
mini_batch_src_global generation:  0.012771368026733398
r_  generation:  0.20575618743896484
local_output_nid generation:  0.007142543792724609
local_in_edges_tensor generation:  0.006732940673828125
mini_batch_src_global generation:  0.013464212417602539
r_  generation:  0.2175147533416748
local_output_nid generation:  0.00699925422668457
local_in_edges_tensor generation:  0.0068018436431884766
mini_batch_src_global generation:  0.013627052307128906
r_  generation:  0.23522353172302246
local_output_nid generation:  0.007116079330444336
local_in_edges_tensor generation:  0.006783246994018555
mini_batch_src_global generation:  0.016103029251098633
r_  generation:  0.2363419532775879
local_output_nid generation:  0.0069081783294677734
local_in_edges_tensor generation:  0.006778717041015625
mini_batch_src_global generation:  0.01693892478942871
r_  generation:  0.24480795860290527
local_output_nid generation:  0.006947994232177734
local_in_edges_tensor generation:  0.006779670715332031
mini_batch_src_global generation:  0.017398595809936523
r_  generation:  0.24924468994140625
local_output_nid generation:  0.006916522979736328
local_in_edges_tensor generation:  0.006757020950317383
mini_batch_src_global generation:  0.0173337459564209
r_  generation:  0.24862408638000488
local_output_nid generation:  0.007088422775268555
local_in_edges_tensor generation:  0.006925344467163086
mini_batch_src_global generation:  0.01875448226928711
r_  generation:  0.25281357765197754
local_output_nid generation:  0.0069522857666015625
local_in_edges_tensor generation:  0.006682395935058594
mini_batch_src_global generation:  0.020000696182250977
r_  generation:  0.26244258880615234
local_output_nid generation:  0.011710882186889648
local_in_edges_tensor generation:  0.006838083267211914
mini_batch_src_global generation:  0.020500898361206055
r_  generation:  0.26279330253601074
local_output_nid generation:  0.007040262222290039
local_in_edges_tensor generation:  0.0066928863525390625
mini_batch_src_global generation:  0.020862579345703125
r_  generation:  0.25946998596191406
local_output_nid generation:  0.006935834884643555
local_in_edges_tensor generation:  0.006723880767822266
mini_batch_src_global generation:  0.021090984344482422
r_  generation:  0.2619290351867676
local_output_nid generation:  0.006956815719604492
local_in_edges_tensor generation:  0.07146906852722168
mini_batch_src_global generation:  0.02129340171813965
r_  generation:  0.26299095153808594
local_output_nid generation:  0.007064104080200195
local_in_edges_tensor generation:  0.006964683532714844
mini_batch_src_global generation:  0.02241826057434082
r_  generation:  0.2700965404510498
----------------------check_connections_block total spend ----------------------------- 5.470156908035278
generate_one_block  1.344700813293457
generate_one_block  0.26271533966064453
generate_one_block  0.268263578414917
generate_one_block  0.26738882064819336
generate_one_block  0.26772403717041016
generate_one_block  0.26784729957580566
generate_one_block  0.26627564430236816
generate_one_block  0.2613868713378906
generate_one_block  0.27139759063720703
generate_one_block  0.27370238304138184
generate_one_block  0.2719237804412842
generate_one_block  0.27042055130004883
generate_one_block  0.27446818351745605
generate_one_block  0.2754523754119873
generate_one_block  0.2670292854309082
generate_one_block  0.2707819938659668
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.990872859954834
gen group dst list time:  0.15448665618896484
time for parepare:  0.4459712505340576
local_output_nid generation:  0.10597586631774902
local_in_edges_tensor generation:  0.3843204975128174
mini_batch_src_global generation:  0.35336732864379883
r_  generation:  4.2994303703308105
local_output_nid generation:  0.11024594306945801
local_in_edges_tensor generation:  0.5539243221282959
mini_batch_src_global generation:  0.4463660717010498
r_  generation:  4.4665844440460205
local_output_nid generation:  0.10894513130187988
local_in_edges_tensor generation:  0.2967085838317871
mini_batch_src_global generation:  0.4313547611236572
r_  generation:  4.577618598937988
local_output_nid generation:  0.10869598388671875
local_in_edges_tensor generation:  0.3011798858642578
mini_batch_src_global generation:  0.454852819442749
r_  generation:  4.686595439910889
local_output_nid generation:  0.1090548038482666
local_in_edges_tensor generation:  0.2994248867034912
mini_batch_src_global generation:  0.5111594200134277
r_  generation:  4.8994035720825195
local_output_nid generation:  0.11010932922363281
local_in_edges_tensor generation:  0.4605391025543213
mini_batch_src_global generation:  0.4825773239135742
r_  generation:  4.842870473861694
local_output_nid generation:  0.10816597938537598
local_in_edges_tensor generation:  0.30554866790771484
mini_batch_src_global generation:  0.4808773994445801
r_  generation:  4.811943054199219
local_output_nid generation:  0.1092228889465332
local_in_edges_tensor generation:  0.4568517208099365
mini_batch_src_global generation:  0.4871182441711426
r_  generation:  4.854527235031128
local_output_nid generation:  0.14060378074645996
local_in_edges_tensor generation:  0.30763840675354004
mini_batch_src_global generation:  0.48647046089172363
r_  generation:  4.836019277572632
local_output_nid generation:  0.11201786994934082
local_in_edges_tensor generation:  0.2933616638183594
mini_batch_src_global generation:  0.48697876930236816
r_  generation:  4.889402866363525
local_output_nid generation:  0.1132040023803711
local_in_edges_tensor generation:  0.3082399368286133
mini_batch_src_global generation:  0.5336768627166748
r_  generation:  5.050446510314941
local_output_nid generation:  0.11223697662353516
local_in_edges_tensor generation:  0.29646754264831543
mini_batch_src_global generation:  0.5027191638946533
r_  generation:  4.901463031768799
local_output_nid generation:  0.11263060569763184
local_in_edges_tensor generation:  0.41670703887939453
mini_batch_src_global generation:  0.49982523918151855
r_  generation:  4.969531059265137
local_output_nid generation:  0.14425897598266602
local_in_edges_tensor generation:  0.3114461898803711
mini_batch_src_global generation:  0.49964118003845215
r_  generation:  4.845757961273193
local_output_nid generation:  0.11283755302429199
local_in_edges_tensor generation:  0.30246472358703613
mini_batch_src_global generation:  0.4994621276855469
r_  generation:  4.993951797485352
local_output_nid generation:  0.11371517181396484
local_in_edges_tensor generation:  0.29617929458618164
mini_batch_src_global generation:  0.5024359226226807
r_  generation:  4.983498573303223
----------------------check_connections_block total spend ----------------------------- 105.11801648139954
generate_one_block  6.544400930404663
generate_one_block  5.9521706104278564
generate_one_block  6.037384986877441
generate_one_block  5.98124623298645
generate_one_block  5.952815294265747
generate_one_block  6.055653810501099
generate_one_block  6.080523252487183
generate_one_block  6.153080701828003
generate_one_block  6.25847315788269
generate_one_block  5.990910768508911
generate_one_block  5.9875218868255615
generate_one_block  5.979228734970093
generate_one_block  5.99808931350708
generate_one_block  6.0602545738220215
generate_one_block  6.445629358291626
generate_one_block  5.945403337478638
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3985817432403564
gen group dst list time:  0.9195818901062012
time for parepare:  0.46768617630004883
local_output_nid generation:  0.5385503768920898
local_in_edges_tensor generation:  1.289576530456543
mini_batch_src_global generation:  1.0826058387756348
r_  generation:  14.17061185836792
local_output_nid generation:  0.5812463760375977
local_in_edges_tensor generation:  1.4021379947662354
mini_batch_src_global generation:  1.542341947555542
r_  generation:  13.369457244873047
local_output_nid generation:  0.5706367492675781
local_in_edges_tensor generation:  1.1501948833465576
mini_batch_src_global generation:  1.4313242435455322
r_  generation:  13.772349119186401
local_output_nid generation:  0.5243256092071533
local_in_edges_tensor generation:  1.147998571395874
mini_batch_src_global generation:  1.461461067199707
r_  generation:  13.709337949752808
local_output_nid generation:  0.572373628616333
local_in_edges_tensor generation:  1.162656307220459
mini_batch_src_global generation:  1.451648235321045
r_  generation:  14.192057609558105
local_output_nid generation:  0.530501127243042
local_in_edges_tensor generation:  1.2286522388458252
mini_batch_src_global generation:  1.447707176208496
r_  generation:  13.745311498641968
local_output_nid generation:  0.5524122714996338
local_in_edges_tensor generation:  1.0884370803833008
mini_batch_src_global generation:  1.4903712272644043
r_  generation:  13.866275072097778
local_output_nid generation:  0.5297937393188477
local_in_edges_tensor generation:  1.1508612632751465
mini_batch_src_global generation:  1.4338228702545166
r_  generation:  13.834324836730957
local_output_nid generation:  0.5736088752746582
local_in_edges_tensor generation:  1.1606316566467285
mini_batch_src_global generation:  1.3657841682434082
r_  generation:  13.961530685424805
local_output_nid generation:  0.5354869365692139
local_in_edges_tensor generation:  1.1634459495544434
mini_batch_src_global generation:  1.4541432857513428
r_  generation:  13.841089248657227
local_output_nid generation:  0.5742530822753906
local_in_edges_tensor generation:  1.1539380550384521
mini_batch_src_global generation:  1.3770947456359863
r_  generation:  13.821715593338013
local_output_nid generation:  0.5282657146453857
local_in_edges_tensor generation:  1.0807547569274902
mini_batch_src_global generation:  1.4340534210205078
r_  generation:  13.813143968582153
local_output_nid generation:  0.5233035087585449
local_in_edges_tensor generation:  1.1582567691802979
mini_batch_src_global generation:  1.4230384826660156
r_  generation:  14.023128747940063
local_output_nid generation:  0.5267548561096191
local_in_edges_tensor generation:  1.1057138442993164
mini_batch_src_global generation:  1.419095516204834
r_  generation:  13.722410917282104
local_output_nid generation:  0.5756087303161621
local_in_edges_tensor generation:  1.1360719203948975
mini_batch_src_global generation:  1.3748040199279785
r_  generation:  13.766847372055054
local_output_nid generation:  0.5281569957733154
local_in_edges_tensor generation:  1.0820136070251465
mini_batch_src_global generation:  1.4393908977508545
r_  generation:  13.806344747543335
----------------------check_connections_block total spend ----------------------------- 311.15311574935913
generate_one_block  18.54469585418701
generate_one_block  18.283656358718872
generate_one_block  18.142167806625366
generate_one_block  17.998078107833862
generate_one_block  19.332051038742065
generate_one_block  18.715900897979736
generate_one_block  18.155483961105347
generate_one_block  18.62753462791443
generate_one_block  18.7531476020813
generate_one_block  18.49316167831421
generate_one_block  18.12954330444336
generate_one_block  18.694082021713257
generate_one_block  18.87339448928833
generate_one_block  18.408565521240234
generate_one_block  18.351438283920288
generate_one_block  18.62710690498352
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

connection checking time:  416.27113223075867
block generation total time  393.55279541015625
average batch blocks generation time:  24.597049713134766
block dataloader generation time/epoch 841.1713354587555
pseudo mini batch 0 input nodes size: 2128625
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.7937436103820801  GigaBytes
Max Memory Allocated: 0.7937436103820801  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.7938351631164551  GigaBytes
Max Memory Allocated: 0.7938351631164551  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8123779296875 GB
    Memory Allocated: 0.7938351631164551  GigaBytes
Max Memory Allocated: 0.7938351631164551  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.2283935546875 GB
    Memory Allocated: 1.126253604888916  GigaBytes
Max Memory Allocated: 1.126253604888916  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.2283935546875 GB
    Memory Allocated: 1.126253604888916  GigaBytes
Max Memory Allocated: 1.126253604888916  GigaBytes

first layer input nodes number: 2128625
first layer output nodes number: 1546365
edges number: 33112783
torch.Size([2128625, 100])
torch.Size([1546365, 256])
input nodes number: 1546365
output nodes number: 335804
edges number: 10859889
torch.Size([1546365, 256])
torch.Size([335804, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 9.8006591796875 GB
    Memory Allocated: 6.45959997177124  GigaBytes
Max Memory Allocated: 6.7753424644470215  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 9.8006591796875 GB
    Memory Allocated: 6.461752414703369  GigaBytes
Max Memory Allocated: 6.7753424644470215  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.3944091796875 GB
    Memory Allocated: 1.6015081405639648  GigaBytes
Max Memory Allocated: 8.445086002349854  GigaBytes

pseudo mini batch 1 input nodes size: 2124407
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.3944091796875 GB
    Memory Allocated: 0.7967562675476074  GigaBytes
Max Memory Allocated: 8.445086002349854  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.3944091796875 GB
    Memory Allocated: 0.7967562675476074  GigaBytes
Max Memory Allocated: 8.445086002349854  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3944091796875 GB
    Memory Allocated: 1.5881595611572266  GigaBytes
Max Memory Allocated: 8.445086002349854  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3944091796875 GB
    Memory Allocated: 1.5882511138916016  GigaBytes
Max Memory Allocated: 8.445086002349854  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.3944091796875 GB
    Memory Allocated: 0.7951846122741699  GigaBytes
Max Memory Allocated: 8.445086002349854  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.3944091796875 GB
    Memory Allocated: 1.12721586227417  GigaBytes
Max Memory Allocated: 8.445086002349854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3944091796875 GB
    Memory Allocated: 1.12721586227417  GigaBytes
Max Memory Allocated: 8.445086002349854  GigaBytes

first layer input nodes number: 2124407
first layer output nodes number: 1542864
edges number: 33051834
torch.Size([2124407, 100])
torch.Size([1542864, 256])
input nodes number: 1542864
output nodes number: 334851
edges number: 10832517
torch.Size([1542864, 256])
torch.Size([334851, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3944091796875 GB
    Memory Allocated: 6.446037769317627  GigaBytes
Max Memory Allocated: 8.445086002349854  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.3944091796875 GB
    Memory Allocated: 6.448726654052734  GigaBytes
Max Memory Allocated: 8.445086002349854  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.8690185546875 GB
    Memory Allocated: 1.599306583404541  GigaBytes
Max Memory Allocated: 8.445086002349854  GigaBytes

pseudo mini batch 2 input nodes size: 2129174
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.8690185546875 GB
    Memory Allocated: 0.7951846122741699  GigaBytes
Max Memory Allocated: 8.445086002349854  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.8690185546875 GB
    Memory Allocated: 0.7951846122741699  GigaBytes
Max Memory Allocated: 8.445086002349854  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8690185546875 GB
    Memory Allocated: 1.5883641242980957  GigaBytes
Max Memory Allocated: 8.445086002349854  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8690185546875 GB
    Memory Allocated: 1.5884556770324707  GigaBytes
Max Memory Allocated: 8.445086002349854  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.8690185546875 GB
    Memory Allocated: 0.7969608306884766  GigaBytes
Max Memory Allocated: 8.445086002349854  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.8690185546875 GB
    Memory Allocated: 1.1302571296691895  GigaBytes
Max Memory Allocated: 8.445086002349854  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8690185546875 GB
    Memory Allocated: 1.1302571296691895  GigaBytes
Max Memory Allocated: 8.445086002349854  GigaBytes

first layer input nodes number: 2129174
first layer output nodes number: 1549356
edges number: 33177890
torch.Size([2129174, 100])
torch.Size([1549356, 256])
input nodes number: 1549356
output nodes number: 336318
edges number: 10866997
torch.Size([1549356, 256])
torch.Size([336318, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.3065185546875 GB
    Memory Allocated: 6.474102973937988  GigaBytes
Max Memory Allocated: 8.445086002349854  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.3065185546875 GB
    Memory Allocated: 6.476254940032959  GigaBytes
Max Memory Allocated: 8.445086002349854  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 1.60408353805542  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

pseudo mini batch 3 input nodes size: 2127138
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 0.7969608306884766  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 0.7969608306884766  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 1.5893816947937012  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 1.5894732475280762  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 0.7962021827697754  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 1.1277008056640625  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 1.1277008056640625  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

first layer input nodes number: 2127138
first layer output nodes number: 1541355
edges number: 33001973
torch.Size([2127138, 100])
torch.Size([1541355, 256])
input nodes number: 1541355
output nodes number: 335477
edges number: 10848311
torch.Size([1541355, 256])
torch.Size([335477, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 6.444738864898682  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 6.446890830993652  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 1.600830078125  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

pseudo mini batch 4 input nodes size: 2126394
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 0.7962021827697754  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 0.7962021827697754  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 1.588346004486084  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 1.588437557220459  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 0.7959251403808594  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 1.1279563903808594  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 1.1279563903808594  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

first layer input nodes number: 2126394
first layer output nodes number: 1544330
edges number: 33050104
torch.Size([2126394, 100])
torch.Size([1544330, 256])
input nodes number: 1544330
output nodes number: 335767
edges number: 10854022
torch.Size([1544330, 256])
torch.Size([335767, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 6.4549665451049805  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 6.457118511199951  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 1.6007628440856934  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

pseudo mini batch 5 input nodes size: 2132125
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 0.796210765838623  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 0.796210765838623  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 1.590489387512207  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 1.590580940246582  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 0.7983455657958984  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 1.1314105987548828  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.7869873046875 GB
    Memory Allocated: 1.1314105987548828  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

first layer input nodes number: 2132125
first layer output nodes number: 1550996
edges number: 33227621
torch.Size([2132125, 100])
torch.Size([1550996, 256])
input nodes number: 1550996
output nodes number: 338149
edges number: 10952976
torch.Size([1550996, 256])
torch.Size([338149, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.5604248046875 GB
    Memory Allocated: 6.482765197753906  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.5604248046875 GB
    Memory Allocated: 6.48581600189209  GigaBytes
Max Memory Allocated: 8.464722156524658  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 1.6067218780517578  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 6 input nodes size: 2127972
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 0.7980599403381348  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 0.7980599403381348  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 1.5907917022705078  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 1.5908832550048828  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 0.7965130805969238  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 1.1285443305969238  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 1.1285443305969238  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2127972
first layer output nodes number: 1542201
edges number: 33036420
torch.Size([2127972, 100])
torch.Size([1542201, 256])
input nodes number: 1542201
output nodes number: 335222
edges number: 10852873
torch.Size([1542201, 256])
torch.Size([335222, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 6.446855545043945  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 6.449007511138916  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 1.6008520126342773  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 7 input nodes size: 2125406
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 0.7965130805969238  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 0.7965130805969238  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 1.5882887840270996  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 1.5883803367614746  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 0.7955570220947266  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 1.1275882720947266  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 1.1275882720947266  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2125406
first layer output nodes number: 1540300
edges number: 33015170
torch.Size([2125406, 100])
torch.Size([1540300, 256])
input nodes number: 1540300
output nodes number: 336094
edges number: 10887938
torch.Size([1540300, 256])
torch.Size([336094, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 6.444254398345947  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 6.446406364440918  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 1.6000347137451172  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 8 input nodes size: 2126702
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 0.7955570220947266  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 0.7955570220947266  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 1.587815284729004  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 1.587906837463379  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 0.7960395812988281  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 1.1280708312988281  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 1.1280708312988281  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2126702
first layer output nodes number: 1544035
edges number: 33069584
torch.Size([2126702, 100])
torch.Size([1544035, 256])
input nodes number: 1544035
output nodes number: 336337
edges number: 10887907
torch.Size([1544035, 256])
torch.Size([336337, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 6.455346584320068  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.3690185546875 GB
    Memory Allocated: 6.457498550415039  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 1.6002321243286133  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 9 input nodes size: 2129270
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 0.7960395812988281  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 0.7960395812988281  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 1.5892548561096191  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 1.5893464088439941  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 0.7969965934753418  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 1.1293206214904785  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 1.1293206214904785  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2129270
first layer output nodes number: 1546844
edges number: 33130322
torch.Size([2129270, 100])
torch.Size([1546844, 256])
input nodes number: 1546844
output nodes number: 336058
edges number: 10866744
torch.Size([1546844, 256])
torch.Size([336058, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 6.461986541748047  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 6.464138507843018  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 1.6013941764831543  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 10 input nodes size: 2126964
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 0.7969965934753418  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 0.7969965934753418  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 1.5893526077270508  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 1.5894441604614258  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 0.7961373329162598  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 1.1292142868041992  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 1.1292142868041992  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2126964
first layer output nodes number: 1545052
edges number: 33117839
torch.Size([2126964, 100])
torch.Size([1545052, 256])
input nodes number: 1545052
output nodes number: 337088
edges number: 10920275
torch.Size([1545052, 256])
torch.Size([337088, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 6.461855888366699  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 6.46400785446167  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 1.6033682823181152  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 11 input nodes size: 2126190
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 0.7970948219299316  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 0.7970948219299316  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 1.5891623497009277  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 1.5892539024353027  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 0.7968063354492188  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 1.1288375854492188  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 1.1288375854492188  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2126190
first layer output nodes number: 1541875
edges number: 33009990
torch.Size([2126190, 100])
torch.Size([1541875, 256])
input nodes number: 1541875
output nodes number: 335867
edges number: 10869302
torch.Size([1541875, 256])
torch.Size([335867, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 6.446998119354248  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 6.449150085449219  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 1.5999517440795898  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 12 input nodes size: 2130774
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 0.7958488464355469  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 0.7958488464355469  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 1.5896244049072266  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 1.5897159576416016  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 0.7975568771362305  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 1.1297273635864258  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 1.1297273635864258  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2130774
first layer output nodes number: 1546033
edges number: 33107516
torch.Size([2130774, 100])
torch.Size([1546033, 256])
input nodes number: 1546033
output nodes number: 336043
edges number: 10872399
torch.Size([1546033, 256])
torch.Size([336043, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 6.461208343505859  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.8416748046875 GB
    Memory Allocated: 6.46336030960083  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 1.6028122901916504  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 13 input nodes size: 2128498
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 0.7975568771362305  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 0.7975568771362305  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 1.590484619140625  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 1.590576171875  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 0.7967090606689453  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 1.129110336303711  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 1.129110336303711  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2128498
first layer output nodes number: 1547524
edges number: 33136029
torch.Size([2128498, 100])
torch.Size([1547524, 256])
input nodes number: 1547524
output nodes number: 337033
edges number: 10908850
torch.Size([1547524, 256])
torch.Size([337033, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 6.467533111572266  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 6.469685077667236  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 1.6029577255249023  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 14 input nodes size: 2128439
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 0.7970409393310547  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 0.7970409393310547  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 1.5899462699890137  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 1.5900378227233887  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 0.7970185279846191  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 1.1296133995056152  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 1.1296133995056152  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2128439
first layer output nodes number: 1547469
edges number: 33127204
torch.Size([2128439, 100])
torch.Size([1547469, 256])
input nodes number: 1547469
output nodes number: 336708
edges number: 10878412
torch.Size([1547469, 256])
torch.Size([336708, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 6.4657087326049805  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 6.468204021453857  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 1.6030006408691406  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 15 input nodes size: 2127611
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 0.7966866493225098  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 0.7966866493225098  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 1.5892839431762695  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 1.5893754959106445  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 0.7963786125183105  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 1.1284098625183105  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 1.1284098625183105  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2127611
first layer output nodes number: 1542149
edges number: 32999888
torch.Size([2127611, 100])
torch.Size([1542149, 256])
input nodes number: 1542149
output nodes number: 336791
edges number: 10896990
torch.Size([1542149, 256])
torch.Size([336791, 256])
torch.Size([12281, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 6.452580451965332  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 6.454732418060303  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3162841796875 GB
    Memory Allocated: 1.600294589996338  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.6018319129943848  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.6018319129943848  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.36618010699748993 |0.5039940923452377 |0.16075767576694489 |0.00015175342559814453 |0.01791420578956604 |0.0019178390502929688 |
----------------------------------------------------------pseudo_mini_loss sum 7.18216609954834
Total (block generation + training)time/epoch 858.1510500907898
Training time/epoch 16.979474544525146
Training time without block to device /epoch 8.915569067001343
Training time without total dataloading part /epoch 2.863095998764038
load block tensor time/epoch 5.858881711959839
block to device time/epoch 8.063905477523804
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  64144044
Number of first layer input nodes during this epoch:  34045689
Number of first layer output nodes during this epoch:  24718748
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.6018314361572266  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.4462003707885742
number of batches is  16
batch size is  12286
random selection method spend 0.014545440673828125
time for parepare:  0.29189157485961914
local_output_nid generation:  0.006234407424926758
local_in_edges_tensor generation:  0.035576820373535156
mini_batch_src_global generation:  0.017838478088378906
r_  generation:  0.18510723114013672
local_output_nid generation:  0.007140636444091797
local_in_edges_tensor generation:  0.009427070617675781
mini_batch_src_global generation:  0.019736528396606445
r_  generation:  0.20490026473999023
local_output_nid generation:  0.007070779800415039
local_in_edges_tensor generation:  0.007004976272583008
mini_batch_src_global generation:  0.012871980667114258
r_  generation:  0.2022721767425537
local_output_nid generation:  0.007223606109619141
local_in_edges_tensor generation:  0.00670623779296875
mini_batch_src_global generation:  0.013700723648071289
r_  generation:  0.21750545501708984
local_output_nid generation:  0.006943225860595703
local_in_edges_tensor generation:  0.0068356990814208984
mini_batch_src_global generation:  0.013901948928833008
r_  generation:  0.2204287052154541
local_output_nid generation:  0.007050514221191406
local_in_edges_tensor generation:  0.00657963752746582
mini_batch_src_global generation:  0.016756057739257812
r_  generation:  0.2381880283355713
local_output_nid generation:  0.006917715072631836
local_in_edges_tensor generation:  0.007750511169433594
mini_batch_src_global generation:  0.01707744598388672
r_  generation:  0.24443960189819336
local_output_nid generation:  0.006942033767700195
local_in_edges_tensor generation:  0.006883859634399414
mini_batch_src_global generation:  0.017589092254638672
r_  generation:  0.2514479160308838
local_output_nid generation:  0.00709080696105957
local_in_edges_tensor generation:  0.0067670345306396484
mini_batch_src_global generation:  0.017833471298217773
r_  generation:  0.249953031539917
local_output_nid generation:  0.006943941116333008
local_in_edges_tensor generation:  0.0066127777099609375
mini_batch_src_global generation:  0.018637895584106445
r_  generation:  0.25348687171936035
local_output_nid generation:  0.006971836090087891
local_in_edges_tensor generation:  0.006749153137207031
mini_batch_src_global generation:  0.02011585235595703
r_  generation:  0.26212310791015625
local_output_nid generation:  0.006964206695556641
local_in_edges_tensor generation:  0.0067899227142333984
mini_batch_src_global generation:  0.020226478576660156
r_  generation:  0.26160120964050293
local_output_nid generation:  0.006973743438720703
local_in_edges_tensor generation:  0.06365537643432617
mini_batch_src_global generation:  0.020099878311157227
r_  generation:  0.2580373287200928
local_output_nid generation:  0.008131265640258789
local_in_edges_tensor generation:  0.006726503372192383
mini_batch_src_global generation:  0.021278858184814453
r_  generation:  0.2667691707611084
local_output_nid generation:  0.0070683956146240234
local_in_edges_tensor generation:  0.006826162338256836
mini_batch_src_global generation:  0.021744728088378906
r_  generation:  0.2680509090423584
local_output_nid generation:  0.006952762603759766
local_in_edges_tensor generation:  0.006891727447509766
mini_batch_src_global generation:  0.02187323570251465
r_  generation:  0.26171445846557617
----------------------check_connections_block total spend ----------------------------- 5.517188310623169
generate_one_block  0.6315488815307617
generate_one_block  0.32584071159362793
generate_one_block  0.2827162742614746
generate_one_block  0.2741231918334961
generate_one_block  0.2745373249053955
generate_one_block  0.27340173721313477
generate_one_block  0.2688755989074707
generate_one_block  0.26375842094421387
generate_one_block  0.2703385353088379
generate_one_block  0.2691836357116699
generate_one_block  0.2706143856048584
generate_one_block  0.2812659740447998
generate_one_block  0.26561665534973145
generate_one_block  0.27391862869262695
generate_one_block  0.2688446044921875
generate_one_block  0.26683688163757324
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.9709136486053467
gen group dst list time:  0.15966534614562988
time for parepare:  0.4612922668457031
local_output_nid generation:  0.10795807838439941
local_in_edges_tensor generation:  0.40707898139953613
mini_batch_src_global generation:  0.357144832611084
r_  generation:  4.308467864990234
local_output_nid generation:  0.11083531379699707
local_in_edges_tensor generation:  0.29851722717285156
mini_batch_src_global generation:  0.4539005756378174
r_  generation:  4.598740577697754
local_output_nid generation:  0.1083688735961914
local_in_edges_tensor generation:  0.45459961891174316
mini_batch_src_global generation:  0.43492865562438965
r_  generation:  4.69592022895813
local_output_nid generation:  0.14281511306762695
local_in_edges_tensor generation:  0.45989418029785156
mini_batch_src_global generation:  0.45216989517211914
r_  generation:  4.644620656967163
local_output_nid generation:  0.11436319351196289
local_in_edges_tensor generation:  0.3026003837585449
mini_batch_src_global generation:  0.47086524963378906
r_  generation:  4.764405727386475
local_output_nid generation:  0.11264419555664062
local_in_edges_tensor generation:  0.3014047145843506
mini_batch_src_global generation:  0.48929357528686523
r_  generation:  4.850747346878052
local_output_nid generation:  0.11384940147399902
local_in_edges_tensor generation:  0.2945525646209717
mini_batch_src_global generation:  0.5248067378997803
r_  generation:  4.945561408996582
local_output_nid generation:  0.11240243911743164
local_in_edges_tensor generation:  0.3590083122253418
mini_batch_src_global generation:  0.5113146305084229
r_  generation:  4.884536504745483
local_output_nid generation:  0.14531683921813965
local_in_edges_tensor generation:  0.3658003807067871
mini_batch_src_global generation:  0.48311424255371094
r_  generation:  4.850915431976318
local_output_nid generation:  0.11907744407653809
local_in_edges_tensor generation:  0.2987806797027588
mini_batch_src_global generation:  0.4822230339050293
r_  generation:  4.854538202285767
local_output_nid generation:  0.1144099235534668
local_in_edges_tensor generation:  0.312453031539917
mini_batch_src_global generation:  0.4916820526123047
r_  generation:  4.92263388633728
local_output_nid generation:  0.11312747001647949
local_in_edges_tensor generation:  0.2934587001800537
mini_batch_src_global generation:  0.4976191520690918
r_  generation:  4.949553728103638
local_output_nid generation:  0.11358428001403809
local_in_edges_tensor generation:  0.3653879165649414
mini_batch_src_global generation:  0.49069929122924805
r_  generation:  4.937150955200195
local_output_nid generation:  0.16116070747375488
local_in_edges_tensor generation:  0.36583900451660156
mini_batch_src_global generation:  0.5008203983306885
r_  generation:  4.832518100738525
local_output_nid generation:  0.11402654647827148
local_in_edges_tensor generation:  0.3010988235473633
mini_batch_src_global generation:  0.49860429763793945
r_  generation:  4.9348227977752686
local_output_nid generation:  0.11357951164245605
local_in_edges_tensor generation:  0.29633116722106934
mini_batch_src_global generation:  0.4935183525085449
r_  generation:  4.853384494781494
----------------------check_connections_block total spend ----------------------------- 105.09582686424255
generate_one_block  6.445318222045898
generate_one_block  5.961476564407349
generate_one_block  5.967568635940552
generate_one_block  6.025197744369507
generate_one_block  6.306259870529175
generate_one_block  5.98983907699585
generate_one_block  5.961509466171265
generate_one_block  5.969708681106567
generate_one_block  5.970719337463379
generate_one_block  6.290757894515991
generate_one_block  6.077221155166626
generate_one_block  5.980859041213989
generate_one_block  5.925650596618652
generate_one_block  5.93759298324585
generate_one_block  5.960073947906494
generate_one_block  6.266057252883911
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2723770141601562
gen group dst list time:  0.905512809753418
time for parepare:  0.48152709007263184
local_output_nid generation:  0.5202169418334961
local_in_edges_tensor generation:  1.2589926719665527
mini_batch_src_global generation:  1.0791752338409424
r_  generation:  13.157836675643921
local_output_nid generation:  0.5145845413208008
local_in_edges_tensor generation:  1.4386074542999268
mini_batch_src_global generation:  1.3519320487976074
r_  generation:  13.58436107635498
local_output_nid generation:  0.5228621959686279
local_in_edges_tensor generation:  1.1221885681152344
mini_batch_src_global generation:  1.351518154144287
r_  generation:  13.887836456298828
local_output_nid generation:  0.5827701091766357
local_in_edges_tensor generation:  1.0768647193908691
mini_batch_src_global generation:  1.3551983833312988
r_  generation:  13.721216678619385
local_output_nid generation:  0.5342168807983398
local_in_edges_tensor generation:  1.0913634300231934
mini_batch_src_global generation:  1.4271302223205566
r_  generation:  13.812008380889893
local_output_nid generation:  0.5322535037994385
local_in_edges_tensor generation:  1.221707820892334
mini_batch_src_global generation:  1.374629020690918
r_  generation:  13.984451532363892
local_output_nid generation:  0.5273699760437012
local_in_edges_tensor generation:  1.0838282108306885
mini_batch_src_global generation:  1.3654251098632812
r_  generation:  13.889755964279175
local_output_nid generation:  0.5875852108001709
local_in_edges_tensor generation:  1.0790174007415771
mini_batch_src_global generation:  1.367405652999878
r_  generation:  13.682941198348999
local_output_nid generation:  0.5412328243255615
local_in_edges_tensor generation:  1.074730396270752
mini_batch_src_global generation:  1.3710055351257324
r_  generation:  13.875861406326294
local_output_nid generation:  0.5365111827850342
local_in_edges_tensor generation:  1.0867347717285156
mini_batch_src_global generation:  1.3669655323028564
r_  generation:  13.837972164154053
local_output_nid generation:  0.5301930904388428
local_in_edges_tensor generation:  1.212897777557373
mini_batch_src_global generation:  1.385713815689087
r_  generation:  13.867597818374634
local_output_nid generation:  0.5328032970428467
local_in_edges_tensor generation:  1.0730171203613281
mini_batch_src_global generation:  1.407982349395752
r_  generation:  13.808474063873291
local_output_nid generation:  0.5289583206176758
local_in_edges_tensor generation:  1.0723567008972168
mini_batch_src_global generation:  1.3675096035003662
r_  generation:  13.831430912017822
local_output_nid generation:  0.5798463821411133
local_in_edges_tensor generation:  1.0806312561035156
mini_batch_src_global generation:  1.3717904090881348
r_  generation:  13.794578313827515
local_output_nid generation:  0.5383851528167725
local_in_edges_tensor generation:  1.082268476486206
mini_batch_src_global generation:  1.4300546646118164
r_  generation:  13.98014783859253
local_output_nid generation:  0.530472993850708
local_in_edges_tensor generation:  1.2268905639648438
mini_batch_src_global generation:  1.375394344329834
r_  generation:  14.091918706893921
----------------------check_connections_block total spend ----------------------------- 308.88557720184326
generate_one_block  18.805965900421143
generate_one_block  18.346279621124268
generate_one_block  18.051427125930786
generate_one_block  18.081453800201416
generate_one_block  18.695232152938843
generate_one_block  19.560388326644897
generate_one_block  18.299788236618042
generate_one_block  18.856792211532593
generate_one_block  18.776217222213745
generate_one_block  18.694786310195923
generate_one_block  18.855910301208496
generate_one_block  19.122782468795776
generate_one_block  19.040133476257324
generate_one_block  18.31237483024597
generate_one_block  18.823920965194702
generate_one_block  18.875632286071777
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.6018314361572266  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

connection checking time:  413.9814040660858
block generation total time  396.23489570617676
average batch blocks generation time:  24.764680981636047
block dataloader generation time/epoch 841.4297400712967
pseudo mini batch 0 input nodes size: 2129908
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 0.7979140281677246  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 0.7979140281677246  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.5913667678833008  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.5914583206176758  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 0.798769474029541  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.1309332847595215  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.1309332847595215  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2129908
first layer output nodes number: 1545729
edges number: 33108584
torch.Size([2129908, 100])
torch.Size([1545729, 256])
input nodes number: 1545729
output nodes number: 335724
edges number: 10856666
torch.Size([1545729, 256])
torch.Size([335724, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 6.460273265838623  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 6.462425708770752  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.6040420532226562  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 1 input nodes size: 2128405
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 0.7987713813781738  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 0.7987713813781738  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.5916643142700195  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.5917558670043945  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 0.7982115745544434  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.1302428245544434  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.1302428245544434  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2128405
first layer output nodes number: 1541503
edges number: 33029643
torch.Size([2128405, 100])
torch.Size([1541503, 256])
input nodes number: 1541503
output nodes number: 335021
edges number: 10839127
torch.Size([1541503, 256])
torch.Size([335021, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 6.446308612823486  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 6.448460578918457  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.6030478477478027  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 2 input nodes size: 2127190
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 0.7982115745544434  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 0.7982115745544434  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.5906519889831543  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.5907435417175293  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 0.7977590560913086  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.1297903060913086  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.1297903060913086  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2127190
first layer output nodes number: 1541968
edges number: 33026283
torch.Size([2127190, 100])
torch.Size([1541968, 256])
input nodes number: 1541968
output nodes number: 334891
edges number: 10834740
torch.Size([1541968, 256])
torch.Size([334891, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 6.447634220123291  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 6.450116157531738  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.602412223815918  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 3 input nodes size: 2128404
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 0.7978792190551758  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 0.7978792190551758  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.5907716751098633  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.5908632278442383  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 0.7983312606811523  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.1306095123291016  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.1306095123291016  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2128404
first layer output nodes number: 1545210
edges number: 33124861
torch.Size([2128404, 100])
torch.Size([1545210, 256])
input nodes number: 1545210
output nodes number: 335051
edges number: 10850136
torch.Size([1545210, 256])
torch.Size([335051, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 6.4560089111328125  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 6.458548069000244  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.6027226448059082  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 4 input nodes size: 2128972
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 0.7982110977172852  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 0.7982110977172852  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.5913152694702148  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.5914068222045898  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 0.7984228134155273  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.1309223175048828  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 1.1309223175048828  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2128972
first layer output nodes number: 1547814
edges number: 33140775
torch.Size([2128972, 100])
torch.Size([1547814, 256])
input nodes number: 1547814
output nodes number: 337067
edges number: 10906100
torch.Size([1547814, 256])
torch.Size([337067, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 6.470275402069092  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3182373046875 GB
    Memory Allocated: 6.4724273681640625  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.60469388961792  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 5 input nodes size: 2126407
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7984781265258789  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7984781265258789  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5906267166137695  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5907182693481445  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7975225448608398  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1296863555908203  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1296863555908203  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2126407
first layer output nodes number: 1546336
edges number: 33106328
torch.Size([2126407, 100])
torch.Size([1546336, 256])
input nodes number: 1546336
output nodes number: 338190
edges number: 10925097
torch.Size([1546336, 256])
torch.Size([338190, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.468738555908203  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.470890522003174  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.603156566619873  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 6 input nodes size: 2129082
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7974672317504883  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7974672317504883  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5906124114990234  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5907039642333984  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7984638214111328  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1305809020996094  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1305809020996094  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2129082
first layer output nodes number: 1545418
edges number: 33094323
torch.Size([2129082, 100])
torch.Size([1545418, 256])
input nodes number: 1545418
output nodes number: 337101
edges number: 10903389
torch.Size([1545418, 256])
torch.Size([337101, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.465152263641357  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.467304229736328  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6041479110717773  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 7 input nodes size: 2128756
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7984638214111328  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7984638214111328  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5914874076843262  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5915789604187012  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.798342227935791  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.130373477935791  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.130373477935791  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2128756
first layer output nodes number: 1543513
edges number: 33065090
torch.Size([2128756, 100])
torch.Size([1543513, 256])
input nodes number: 1543513
output nodes number: 334827
edges number: 10835101
torch.Size([1543513, 256])
torch.Size([334827, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.450266361236572  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.452669143676758  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.602159023284912  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 8 input nodes size: 2128467
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.798342227935791  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.798342227935791  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5912580490112305  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5913496017456055  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7982344627380371  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.131272315979004  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.131272315979004  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2128467
first layer output nodes number: 1546338
edges number: 33097779
torch.Size([2128467, 100])
torch.Size([1546338, 256])
input nodes number: 1546338
output nodes number: 336465
edges number: 10880815
torch.Size([1546338, 256])
torch.Size([336465, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.464122772216797  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.46642541885376  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.604081153869629  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 9 input nodes size: 2130280
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7982344627380371  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7982344627380371  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5918259620666504  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5919175148010254  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7989101409912109  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1312599182128906  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1312599182128906  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2130280
first layer output nodes number: 1546036
edges number: 33112003
torch.Size([2130280, 100])
torch.Size([1546036, 256])
input nodes number: 1546036
output nodes number: 335471
edges number: 10855155
torch.Size([1546036, 256])
torch.Size([335471, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.461448669433594  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.4636006355285645  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6047768592834473  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 10 input nodes size: 2128430
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7989101409912109  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7989101409912109  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5918121337890625  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5919036865234375  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7982206344604492  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1306509971618652  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1306509971618652  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2128430
first layer output nodes number: 1545619
edges number: 33104321
torch.Size([2128430, 100])
torch.Size([1545619, 256])
input nodes number: 1545619
output nodes number: 336963
edges number: 10891331
torch.Size([1545619, 256])
torch.Size([336963, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.463551998138428  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.466475963592529  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6043963432312012  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 11 input nodes size: 2129091
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7982206344604492  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7982206344604492  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5913691520690918  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5914607048034668  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7984671592712402  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1306824684143066  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1306824684143066  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2129091
first layer output nodes number: 1545542
edges number: 33114991
torch.Size([2129091, 100])
torch.Size([1545542, 256])
input nodes number: 1545542
output nodes number: 336501
edges number: 10896995
torch.Size([1545542, 256])
torch.Size([336501, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.463015079498291  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.465237617492676  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6046175956726074  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 12 input nodes size: 2129494
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7984671592712402  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7984671592712402  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5917658805847168  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5918574333190918  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7986173629760742  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1306486129760742  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1306486129760742  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2129494
first layer output nodes number: 1545068
edges number: 33071511
torch.Size([2129494, 100])
torch.Size([1545068, 256])
input nodes number: 1545068
output nodes number: 335653
edges number: 10846219
torch.Size([1545068, 256])
torch.Size([335653, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.457735061645508  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.459957599639893  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6030950546264648  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 13 input nodes size: 2126793
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7986173629760742  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7986173629760742  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5909099578857422  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5910015106201172  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7976112365722656  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1296424865722656  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1296424865722656  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2126793
first layer output nodes number: 1544045
edges number: 33054454
torch.Size([2126793, 100])
torch.Size([1544045, 256])
input nodes number: 1544045
output nodes number: 336121
edges number: 10880219
torch.Size([1544045, 256])
torch.Size([336121, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.456319332122803  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.458858013153076  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.602168083190918  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 14 input nodes size: 2127494
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7976112365722656  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7976112365722656  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5901646614074707  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5902562141418457  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7978720664978027  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.130847454071045  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.130847454071045  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2127494
first layer output nodes number: 1546029
edges number: 33130689
torch.Size([2127494, 100])
torch.Size([1546029, 256])
input nodes number: 1546029
output nodes number: 337545
edges number: 10932187
torch.Size([1546029, 256])
torch.Size([337545, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.467512607574463  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.4702277183532715  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6056485176086426  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 15 input nodes size: 2130121
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7978720664978027  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7978720664978027  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5914044380187988  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5914959907531738  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7988510131835938  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1311330795288086  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1311330795288086  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2130121
first layer output nodes number: 1548011
edges number: 33124265
torch.Size([2130121, 100])
torch.Size([1548011, 256])
input nodes number: 1548011
output nodes number: 336135
edges number: 10875415
torch.Size([1548011, 256])
torch.Size([336135, 256])
torch.Size([12281, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.468446731567383  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.470597743988037  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6050305366516113  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6050305366516113  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6050305366516113  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37820467352867126 |0.3368110954761505 |0.10213010013103485 |0.00014449656009674072 |0.005725234746932983 |0.0013039112091064453 |
----------------------------------------------------------pseudo_mini_loss sum 12.483131408691406
Total (block generation + training)time/epoch 856.6097985506058
Training time/epoch 13.380192518234253
Training time without block to device /epoch 7.991214990615845
Training time without total dataloading part /epoch 1.7293012142181396
load block tensor time/epoch 6.05127477645874
block to device time/epoch 5.388977527618408
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  64160199
Number of first layer input nodes during this epoch:  34057294
Number of first layer output nodes during this epoch:  24724179
----------------------------------------before generate dataloader block 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6050300598144531  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3319590091705322
number of batches is  16
batch size is  12286
random selection method spend 0.01678633689880371
time for parepare:  0.2792832851409912
local_output_nid generation:  0.0065267086029052734
local_in_edges_tensor generation:  0.03157758712768555
mini_batch_src_global generation:  0.018065929412841797
r_  generation:  0.17755460739135742
local_output_nid generation:  0.007115840911865234
local_in_edges_tensor generation:  0.010052204132080078
mini_batch_src_global generation:  0.021097183227539062
r_  generation:  0.20351195335388184
local_output_nid generation:  0.0071032047271728516
local_in_edges_tensor generation:  0.009744644165039062
mini_batch_src_global generation:  0.012679576873779297
r_  generation:  0.20455431938171387
local_output_nid generation:  0.007158041000366211
local_in_edges_tensor generation:  0.008936405181884766
mini_batch_src_global generation:  0.013737201690673828
r_  generation:  0.21641135215759277
local_output_nid generation:  0.007042646408081055
local_in_edges_tensor generation:  0.009843587875366211
mini_batch_src_global generation:  0.013905048370361328
r_  generation:  0.22499394416809082
local_output_nid generation:  0.00713348388671875
local_in_edges_tensor generation:  0.006671428680419922
mini_batch_src_global generation:  0.01644444465637207
r_  generation:  0.2358686923980713
local_output_nid generation:  0.007063150405883789
local_in_edges_tensor generation:  0.007318258285522461
mini_batch_src_global generation:  0.01720285415649414
r_  generation:  0.2464580535888672
local_output_nid generation:  0.007074117660522461
local_in_edges_tensor generation:  0.006854057312011719
mini_batch_src_global generation:  0.017930030822753906
r_  generation:  0.253293514251709
local_output_nid generation:  0.007106781005859375
local_in_edges_tensor generation:  0.006472587585449219
mini_batch_src_global generation:  0.017664194107055664
r_  generation:  0.25110936164855957
local_output_nid generation:  0.007085323333740234
local_in_edges_tensor generation:  0.006603240966796875
mini_batch_src_global generation:  0.018738269805908203
r_  generation:  0.2557530403137207
local_output_nid generation:  0.007046699523925781
local_in_edges_tensor generation:  0.006629467010498047
mini_batch_src_global generation:  0.02049708366394043
r_  generation:  0.2633683681488037
local_output_nid generation:  0.007118701934814453
local_in_edges_tensor generation:  0.006757497787475586
mini_batch_src_global generation:  0.021105051040649414
r_  generation:  0.2665140628814697
local_output_nid generation:  0.007193088531494141
local_in_edges_tensor generation:  0.006583213806152344
mini_batch_src_global generation:  0.02246856689453125
r_  generation:  0.2649722099304199
local_output_nid generation:  0.00712132453918457
local_in_edges_tensor generation:  0.0067636966705322266
mini_batch_src_global generation:  0.021864891052246094
r_  generation:  0.26739501953125
local_output_nid generation:  0.0070765018463134766
local_in_edges_tensor generation:  0.006909608840942383
mini_batch_src_global generation:  0.022100448608398438
r_  generation:  0.2634005546569824
local_output_nid generation:  0.0070972442626953125
local_in_edges_tensor generation:  0.006544589996337891
mini_batch_src_global generation:  0.024002552032470703
r_  generation:  0.2673821449279785
----------------------check_connections_block total spend ----------------------------- 5.487060546875
generate_one_block  0.6524672508239746
generate_one_block  0.33338403701782227
generate_one_block  0.2891058921813965
generate_one_block  0.27487993240356445
generate_one_block  0.27055835723876953
generate_one_block  0.2753019332885742
generate_one_block  0.27152204513549805
generate_one_block  0.2707657814025879
generate_one_block  0.28461194038391113
generate_one_block  0.2758176326751709
generate_one_block  0.27281737327575684
generate_one_block  0.273601770401001
generate_one_block  0.27440500259399414
generate_one_block  0.2741994857788086
generate_one_block  0.2734646797180176
generate_one_block  0.27399373054504395
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0115346908569336
gen group dst list time:  0.16012835502624512
time for parepare:  0.4245419502258301
local_output_nid generation:  0.11494755744934082
local_in_edges_tensor generation:  0.32581281661987305
mini_batch_src_global generation:  0.3713819980621338
r_  generation:  4.30391788482666
local_output_nid generation:  0.11466765403747559
local_in_edges_tensor generation:  0.3017420768737793
mini_batch_src_global generation:  0.44245147705078125
r_  generation:  4.488208770751953
local_output_nid generation:  0.11013126373291016
local_in_edges_tensor generation:  0.4096956253051758
mini_batch_src_global generation:  0.4421825408935547
r_  generation:  4.576636552810669
local_output_nid generation:  0.11087989807128906
local_in_edges_tensor generation:  0.28470849990844727
mini_batch_src_global generation:  0.4855654239654541
r_  generation:  4.805356502532959
local_output_nid generation:  0.12717652320861816
local_in_edges_tensor generation:  0.46045589447021484
mini_batch_src_global generation:  0.46491217613220215
r_  generation:  4.765332460403442
local_output_nid generation:  0.12409830093383789
local_in_edges_tensor generation:  0.27796268463134766
mini_batch_src_global generation:  0.4879801273345947
r_  generation:  4.792466640472412
local_output_nid generation:  0.11275410652160645
local_in_edges_tensor generation:  0.29475831985473633
mini_batch_src_global generation:  0.4771461486816406
r_  generation:  4.741039037704468
local_output_nid generation:  0.11314749717712402
local_in_edges_tensor generation:  0.29383325576782227
mini_batch_src_global generation:  0.49080419540405273
r_  generation:  4.776315212249756
local_output_nid generation:  0.12391304969787598
local_in_edges_tensor generation:  0.2920529842376709
mini_batch_src_global generation:  0.497467041015625
r_  generation:  4.772226095199585
local_output_nid generation:  0.11602616310119629
local_in_edges_tensor generation:  0.30194926261901855
mini_batch_src_global generation:  0.4942502975463867
r_  generation:  4.837696075439453
local_output_nid generation:  0.11471724510192871
local_in_edges_tensor generation:  0.2927124500274658
mini_batch_src_global generation:  0.4970219135284424
r_  generation:  4.858870983123779
local_output_nid generation:  0.11363077163696289
local_in_edges_tensor generation:  0.3574821949005127
mini_batch_src_global generation:  0.5602679252624512
r_  generation:  4.854926824569702
local_output_nid generation:  0.11341476440429688
local_in_edges_tensor generation:  0.2963852882385254
mini_batch_src_global generation:  0.5000107288360596
r_  generation:  4.99446964263916
local_output_nid generation:  0.12141752243041992
local_in_edges_tensor generation:  0.3178286552429199
mini_batch_src_global generation:  0.5213909149169922
r_  generation:  4.872186660766602
local_output_nid generation:  0.12529969215393066
local_in_edges_tensor generation:  0.3353757858276367
mini_batch_src_global generation:  0.4996607303619385
r_  generation:  4.79352331161499
local_output_nid generation:  0.11345601081848145
local_in_edges_tensor generation:  0.2972433567047119
mini_batch_src_global generation:  0.49582433700561523
r_  generation:  4.82153582572937
----------------------check_connections_block total spend ----------------------------- 103.81401801109314
generate_one_block  6.557754993438721
generate_one_block  5.9618141651153564
generate_one_block  6.0207884311676025
generate_one_block  5.947364330291748
generate_one_block  6.317173480987549
generate_one_block  6.017283916473389
generate_one_block  6.014238357543945
generate_one_block  5.9823079109191895
generate_one_block  6.033216953277588
generate_one_block  6.159648895263672
generate_one_block  6.238250255584717
generate_one_block  6.043272495269775
generate_one_block  6.013979911804199
generate_one_block  5.991555690765381
generate_one_block  5.924651861190796
generate_one_block  5.965447902679443
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.319611072540283
gen group dst list time:  0.9033215045928955
time for parepare:  0.46762704849243164
local_output_nid generation:  0.5387976169586182
local_in_edges_tensor generation:  1.2865214347839355
mini_batch_src_global generation:  1.0733983516693115
r_  generation:  13.160391807556152
local_output_nid generation:  0.538480281829834
local_in_edges_tensor generation:  1.1703290939331055
mini_batch_src_global generation:  1.3452374935150146
r_  generation:  13.232853651046753
local_output_nid generation:  0.5175848007202148
local_in_edges_tensor generation:  1.1665921211242676
mini_batch_src_global generation:  1.3968746662139893
r_  generation:  13.533215761184692
local_output_nid generation:  0.5256168842315674
local_in_edges_tensor generation:  1.4718689918518066
mini_batch_src_global generation:  1.3483250141143799
r_  generation:  13.612313985824585
local_output_nid generation:  0.5330400466918945
local_in_edges_tensor generation:  1.12261962890625
mini_batch_src_global generation:  1.3788261413574219
r_  generation:  13.617586135864258
local_output_nid generation:  0.5276870727539062
local_in_edges_tensor generation:  1.1161119937896729
mini_batch_src_global generation:  1.3683316707611084
r_  generation:  13.543584823608398
local_output_nid generation:  0.5236210823059082
local_in_edges_tensor generation:  1.1247310638427734
mini_batch_src_global generation:  1.3847439289093018
r_  generation:  13.513192415237427
local_output_nid generation:  0.5723493099212646
local_in_edges_tensor generation:  1.1290862560272217
mini_batch_src_global generation:  1.3670272827148438
r_  generation:  13.539730787277222
local_output_nid generation:  0.557004451751709
local_in_edges_tensor generation:  1.0997488498687744
mini_batch_src_global generation:  1.3769872188568115
r_  generation:  13.631006240844727
local_output_nid generation:  0.541799783706665
local_in_edges_tensor generation:  1.1528122425079346
mini_batch_src_global generation:  1.3822917938232422
r_  generation:  13.917505502700806
local_output_nid generation:  0.5442242622375488
local_in_edges_tensor generation:  1.1467325687408447
mini_batch_src_global generation:  1.3654160499572754
r_  generation:  13.733236074447632
local_output_nid generation:  0.570939302444458
local_in_edges_tensor generation:  1.0828309059143066
mini_batch_src_global generation:  1.364671230316162
r_  generation:  13.569072723388672
local_output_nid generation:  0.5585582256317139
local_in_edges_tensor generation:  1.081146001815796
mini_batch_src_global generation:  1.364933729171753
r_  generation:  13.679134368896484
local_output_nid generation:  0.5400428771972656
local_in_edges_tensor generation:  1.078310251235962
mini_batch_src_global generation:  1.3695991039276123
r_  generation:  13.716882705688477
local_output_nid generation:  0.5383844375610352
local_in_edges_tensor generation:  1.0761022567749023
mini_batch_src_global generation:  1.3785109519958496
r_  generation:  13.631950378417969
local_output_nid generation:  0.5500338077545166
local_in_edges_tensor generation:  1.2008557319641113
mini_batch_src_global generation:  1.3474915027618408
r_  generation:  13.698463201522827
----------------------check_connections_block total spend ----------------------------- 304.1078083515167
generate_one_block  18.390817880630493
generate_one_block  19.85351014137268
generate_one_block  17.704049825668335
generate_one_block  17.767000913619995
generate_one_block  17.918468236923218
generate_one_block  18.13804578781128
generate_one_block  17.959290981292725
generate_one_block  17.959527730941772
generate_one_block  18.562958240509033
generate_one_block  18.0055890083313
generate_one_block  18.23567771911621
generate_one_block  18.212467670440674
generate_one_block  18.340883016586304
generate_one_block  18.47634243965149
generate_one_block  18.50896382331848
generate_one_block  18.84890580177307
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6050300598144531  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

connection checking time:  407.92182636260986
block generation total time  390.07124876976013
average batch blocks generation time:  24.37945304811001
block dataloader generation time/epoch 837.4642132123312
pseudo mini batch 0 input nodes size: 2130427
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7988491058349609  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7988491058349609  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5924954414367676  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5925869941711426  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7989630699157715  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1315674781799316  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1315674781799316  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2130427
first layer output nodes number: 1548713
edges number: 33166998
torch.Size([2130427, 100])
torch.Size([1548713, 256])
input nodes number: 1548713
output nodes number: 337212
edges number: 10915161
torch.Size([1548713, 256])
torch.Size([337212, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.473510265350342  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.475662708282471  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6053266525268555  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 1 input nodes size: 2127335
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7989649772644043  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7989649772644043  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5914592742919922  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5915508270263672  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7978129386901855  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1298441886901855  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1298441886901855  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2127335
first layer output nodes number: 1541819
edges number: 33027004
torch.Size([2127335, 100])
torch.Size([1541819, 256])
input nodes number: 1541819
output nodes number: 336298
edges number: 10883532
torch.Size([1541819, 256])
torch.Size([336298, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.450881004333496  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.453032970428467  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6030020713806152  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 2 input nodes size: 2124988
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7978129386901855  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7978129386901855  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.589432716369629  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.589524269104004  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.796938419342041  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.128969669342041  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.128969669342041  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2124988
first layer output nodes number: 1537167
edges number: 32951651
torch.Size([2124988, 100])
torch.Size([1537167, 256])
input nodes number: 1537167
output nodes number: 335853
edges number: 10874270
torch.Size([1537167, 256])
torch.Size([335853, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.436489105224609  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.43864107131958  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6017966270446777  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 3 input nodes size: 2127774
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.796938419342041  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.796938419342041  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5895962715148926  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5896878242492676  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7979764938354492  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1300811767578125  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1300811767578125  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2127774
first layer output nodes number: 1544770
edges number: 33101292
torch.Size([2127774, 100])
torch.Size([1544770, 256])
input nodes number: 1544770
output nodes number: 334446
edges number: 10815409
torch.Size([1544770, 256])
torch.Size([334446, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.45218563079834  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.4543375968933105  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6015172004699707  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 4 input nodes size: 2129381
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7979764938354492  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7979764938354492  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5912327766418457  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5913243293762207  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7985749244689941  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1312079429626465  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1312079429626465  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2129381
first layer output nodes number: 1549449
edges number: 33170465
torch.Size([2129381, 100])
torch.Size([1549449, 256])
input nodes number: 1549449
output nodes number: 335653
edges number: 10866169
torch.Size([1549449, 256])
torch.Size([335653, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.471015930175781  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.473815441131592  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6049861907958984  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 5 input nodes size: 2129829
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7989077568054199  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7989077568054199  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5923309326171875  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5924224853515625  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.799074649810791  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.131105899810791  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.131105899810791  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2129829
first layer output nodes number: 1545407
edges number: 33078635
torch.Size([2129829, 100])
torch.Size([1545407, 256])
input nodes number: 1545407
output nodes number: 336499
edges number: 10879656
torch.Size([1545407, 256])
torch.Size([336499, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.461383819580078  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.463735103607178  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6040740013122559  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 6 input nodes size: 2126504
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7987418174743652  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7987418174743652  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5909266471862793  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5910181999206543  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7975034713745117  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1295347213745117  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1295347213745117  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2126504
first layer output nodes number: 1544379
edges number: 33069376
torch.Size([2126504, 100])
torch.Size([1544379, 256])
input nodes number: 1544379
output nodes number: 336253
edges number: 10887795
torch.Size([1544379, 256])
torch.Size([336253, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.456877708435059  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.459029674530029  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6022510528564453  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 7 input nodes size: 2129287
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7977027893066406  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7977027893066406  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5909242630004883  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5910158157348633  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7987394332885742  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1309528350830078  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1309528350830078  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2129287
first layer output nodes number: 1546788
edges number: 33114302
torch.Size([2129287, 100])
torch.Size([1546788, 256])
input nodes number: 1546788
output nodes number: 335882
edges number: 10871019
torch.Size([1546788, 256])
torch.Size([335882, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.462967872619629  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.4653191566467285  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6037788391113281  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 8 input nodes size: 2129052
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7985401153564453  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7985401153564453  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5916738510131836  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5917654037475586  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7984523773193359  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.130444049835205  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.130444049835205  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2129052
first layer output nodes number: 1545294
edges number: 33063789
torch.Size([2129052, 100])
torch.Size([1545294, 256])
input nodes number: 1545294
output nodes number: 336813
edges number: 10875177
torch.Size([1545294, 256])
torch.Size([336813, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.461944103240967  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.4640960693359375  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6027545928955078  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 9 input nodes size: 2124990
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7984523773193359  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7984523773193359  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5900731086730957  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5901646614074707  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7969393730163574  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1289706230163574  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1289706230163574  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2124990
first layer output nodes number: 1539654
edges number: 32984031
torch.Size([2124990, 100])
torch.Size([1539654, 256])
input nodes number: 1539654
output nodes number: 336541
edges number: 10894841
torch.Size([1539654, 256])
torch.Size([336541, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.445220470428467  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.4473724365234375  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6011476516723633  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 10 input nodes size: 2126777
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7969393730163574  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7969393730163574  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5892257690429688  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5893173217773438  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.797605037689209  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.129636287689209  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.129636287689209  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2126777
first layer output nodes number: 1543836
edges number: 33076608
torch.Size([2126777, 100])
torch.Size([1543836, 256])
input nodes number: 1543836
output nodes number: 335872
edges number: 10885575
torch.Size([1543836, 256])
torch.Size([335872, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.454858303070068  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.457010269165039  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6028075218200684  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 11 input nodes size: 2125457
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7978878021240234  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7978878021240234  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5896825790405273  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5897741317749023  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.797396183013916  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.129427433013916  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.129427433013916  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2125457
first layer output nodes number: 1542498
edges number: 33018170
torch.Size([2125457, 100])
torch.Size([1542498, 256])
input nodes number: 1542498
output nodes number: 335958
edges number: 10860680
torch.Size([1542498, 256])
torch.Size([335958, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.449583053588867  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.452017784118652  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.601980209350586  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 12 input nodes size: 2125942
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7971134185791016  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7971134185791016  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5890889167785645  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5891804695129395  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7972941398620605  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1293997764587402  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.1293997764587402  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2125942
first layer output nodes number: 1545961
edges number: 33098892
torch.Size([2125942, 100])
torch.Size([1545961, 256])
input nodes number: 1545961
output nodes number: 336484
edges number: 10880127
torch.Size([1545961, 256])
torch.Size([336484, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.46127462387085  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.463932991027832  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.6024737358093262  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 13 input nodes size: 2132231
----------------------------------------before load block subtensor 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7972941398620605  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7972941398620605  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5916123390197754  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.5917038917541504  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 0.7996368408203125  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.132796287536621  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 1.132796287536621  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2132231
first layer output nodes number: 1550562
edges number: 33172363
torch.Size([2132231, 100])
torch.Size([1550562, 256])
input nodes number: 1550562
output nodes number: 336339
edges number: 10866554
torch.Size([1550562, 256])
torch.Size([336339, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.476138114929199  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 17.7947998046875 GB
    Memory Allocated: 6.47829008102417  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.6051011085510254  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 14 input nodes size: 2128229
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7999024391174316  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7999024391174316  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.5927295684814453  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.5928211212158203  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7984113693237305  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.1304426193237305  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.1304426193237305  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2128229
first layer output nodes number: 1541548
edges number: 33054271
torch.Size([2128229, 100])
torch.Size([1541548, 256])
input nodes number: 1541548
output nodes number: 335350
edges number: 10855697
torch.Size([1541548, 256])
torch.Size([335350, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.447770118713379  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.450187683105469  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.6024394035339355  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 15 input nodes size: 2127392
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7981457710266113  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7981457710266113  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.5906610488891602  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.5907526016235352  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7978339195251465  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.1298651695251465  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.1298651695251465  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2127392
first layer output nodes number: 1544097
edges number: 33063992
torch.Size([2127392, 100])
torch.Size([1544097, 256])
input nodes number: 1544097
output nodes number: 336273
edges number: 10876783
torch.Size([1544097, 256])
torch.Size([336273, 256])
torch.Size([12281, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.45720100402832  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.459352016448975  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.6018304824829102  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.6018304824829102  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.6018304824829102  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.37425170838832855 |0.407392218708992 |0.10281716287136078 |0.00016385316848754883 |0.004883959889411926 |0.0014858245849609375 |
----------------------------------------------------------pseudo_mini_loss sum 3.626267910003662
Total (block generation + training)time/epoch 852.4003040790558
Training time/epoch 14.447940826416016
Training time without block to device /epoch 7.9296653270721436
Training time without total dataloading part /epoch 1.727325439453125
load block tensor time/epoch 5.988027334213257
block to device time/epoch 6.518275499343872
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  64135263
Number of first layer input nodes during this epoch:  34045595
Number of first layer output nodes during this epoch:  24711942
----------------------------------------before generate dataloader block 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.601830005645752  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3589746952056885
number of batches is  16
batch size is  12286
random selection method spend 0.01380157470703125
time for parepare:  0.2971808910369873
local_output_nid generation:  0.006448507308959961
local_in_edges_tensor generation:  0.03151822090148926
mini_batch_src_global generation:  0.017428159713745117
r_  generation:  0.1758420467376709
local_output_nid generation:  0.0070536136627197266
local_in_edges_tensor generation:  0.010759830474853516
mini_batch_src_global generation:  0.020351409912109375
r_  generation:  0.19723057746887207
local_output_nid generation:  0.00699925422668457
local_in_edges_tensor generation:  0.007312774658203125
mini_batch_src_global generation:  0.012859344482421875
r_  generation:  0.19995594024658203
local_output_nid generation:  0.007045745849609375
local_in_edges_tensor generation:  0.006380796432495117
mini_batch_src_global generation:  0.015308380126953125
r_  generation:  0.21408796310424805
local_output_nid generation:  0.007183551788330078
local_in_edges_tensor generation:  0.007069587707519531
mini_batch_src_global generation:  0.013862848281860352
r_  generation:  0.22058439254760742
local_output_nid generation:  0.007088899612426758
local_in_edges_tensor generation:  0.007128715515136719
mini_batch_src_global generation:  0.016289710998535156
r_  generation:  0.23097538948059082
local_output_nid generation:  0.0070340633392333984
local_in_edges_tensor generation:  0.007035255432128906
mini_batch_src_global generation:  0.01896834373474121
r_  generation:  0.24438238143920898
local_output_nid generation:  0.007033824920654297
local_in_edges_tensor generation:  0.007086515426635742
mini_batch_src_global generation:  0.01790022850036621
r_  generation:  0.24506759643554688
local_output_nid generation:  0.007120370864868164
local_in_edges_tensor generation:  0.0070574283599853516
mini_batch_src_global generation:  0.017656803131103516
r_  generation:  0.24670934677124023
local_output_nid generation:  0.01046133041381836
local_in_edges_tensor generation:  0.006486415863037109
mini_batch_src_global generation:  0.0186460018157959
r_  generation:  0.2489018440246582
local_output_nid generation:  0.0069921016693115234
local_in_edges_tensor generation:  0.008015871047973633
mini_batch_src_global generation:  0.02193427085876465
r_  generation:  0.256622314453125
local_output_nid generation:  0.00700688362121582
local_in_edges_tensor generation:  0.006239175796508789
mini_batch_src_global generation:  0.021634340286254883
r_  generation:  0.2585127353668213
local_output_nid generation:  0.006951332092285156
local_in_edges_tensor generation:  0.0081329345703125
mini_batch_src_global generation:  0.020806550979614258
r_  generation:  0.25656747817993164
local_output_nid generation:  0.006966829299926758
local_in_edges_tensor generation:  0.01003885269165039
mini_batch_src_global generation:  0.02139735221862793
r_  generation:  0.2596914768218994
local_output_nid generation:  0.010851144790649414
local_in_edges_tensor generation:  0.007129192352294922
mini_batch_src_global generation:  0.02167487144470215
r_  generation:  0.25971269607543945
local_output_nid generation:  0.006981611251831055
local_in_edges_tensor generation:  0.006318807601928711
mini_batch_src_global generation:  0.02226400375366211
r_  generation:  0.25882983207702637
----------------------check_connections_block total spend ----------------------------- 5.430173397064209
generate_one_block  0.6519420146942139
generate_one_block  0.33307647705078125
generate_one_block  0.29267072677612305
generate_one_block  0.28252530097961426
generate_one_block  0.2752506732940674
generate_one_block  0.27417731285095215
generate_one_block  0.2754943370819092
generate_one_block  0.27455687522888184
generate_one_block  0.29159092903137207
generate_one_block  0.27325868606567383
generate_one_block  0.2752711772918701
generate_one_block  0.2723391056060791
generate_one_block  0.2729811668395996
generate_one_block  0.26807570457458496
generate_one_block  0.2744934558868408
generate_one_block  0.26703929901123047
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.330308675765991
gen group dst list time:  0.16253042221069336
time for parepare:  0.433154821395874
local_output_nid generation:  0.12543725967407227
local_in_edges_tensor generation:  0.39087414741516113
mini_batch_src_global generation:  0.38067007064819336
r_  generation:  4.3545753955841064
local_output_nid generation:  0.1342775821685791
local_in_edges_tensor generation:  0.30283141136169434
mini_batch_src_global generation:  0.46652960777282715
r_  generation:  4.670666456222534
local_output_nid generation:  0.1519310474395752
local_in_edges_tensor generation:  0.4413297176361084
mini_batch_src_global generation:  0.4538390636444092
r_  generation:  4.560255527496338
local_output_nid generation:  0.1278541088104248
local_in_edges_tensor generation:  0.31038641929626465
mini_batch_src_global generation:  0.46945762634277344
r_  generation:  4.7681334018707275
local_output_nid generation:  0.1285240650177002
local_in_edges_tensor generation:  0.3104219436645508
mini_batch_src_global generation:  0.48810744285583496
r_  generation:  4.781139373779297
local_output_nid generation:  0.13753485679626465
local_in_edges_tensor generation:  0.2976863384246826
mini_batch_src_global generation:  0.49373316764831543
r_  generation:  5.0325586795806885
local_output_nid generation:  0.13493108749389648
local_in_edges_tensor generation:  0.3117377758026123
mini_batch_src_global generation:  0.5035696029663086
r_  generation:  4.892570972442627
local_output_nid generation:  0.1291980743408203
local_in_edges_tensor generation:  0.3005869388580322
mini_batch_src_global generation:  0.49863743782043457
r_  generation:  4.84300422668457
local_output_nid generation:  0.13291311264038086
local_in_edges_tensor generation:  0.4412965774536133
mini_batch_src_global generation:  0.5330448150634766
r_  generation:  4.874598264694214
local_output_nid generation:  0.12790822982788086
local_in_edges_tensor generation:  0.30382847785949707
mini_batch_src_global generation:  0.49594998359680176
r_  generation:  4.952372074127197
local_output_nid generation:  0.12840819358825684
local_in_edges_tensor generation:  0.30400848388671875
mini_batch_src_global generation:  0.5289735794067383
r_  generation:  4.946535348892212
local_output_nid generation:  0.14992117881774902
local_in_edges_tensor generation:  0.36121058464050293
mini_batch_src_global generation:  0.4997990131378174
r_  generation:  4.93677282333374
local_output_nid generation:  0.12849140167236328
local_in_edges_tensor generation:  0.30489182472229004
mini_batch_src_global generation:  0.5070457458496094
r_  generation:  4.851863861083984
local_output_nid generation:  0.1467571258544922
local_in_edges_tensor generation:  0.29753565788269043
mini_batch_src_global generation:  0.5034041404724121
r_  generation:  4.886469841003418
local_output_nid generation:  0.12110590934753418
local_in_edges_tensor generation:  0.29877424240112305
mini_batch_src_global generation:  0.5095455646514893
r_  generation:  4.8573808670043945
local_output_nid generation:  0.11492919921875
local_in_edges_tensor generation:  0.2969825267791748
mini_batch_src_global generation:  0.5073728561401367
r_  generation:  4.886176109313965
----------------------check_connections_block total spend ----------------------------- 105.5979974269867
generate_one_block  6.5036115646362305
generate_one_block  6.062386512756348
generate_one_block  6.063315153121948
generate_one_block  6.1424174308776855
generate_one_block  6.331582307815552
generate_one_block  6.002650737762451
generate_one_block  6.004174709320068
generate_one_block  6.301209449768066
generate_one_block  6.244769334793091
generate_one_block  6.035588264465332
generate_one_block  6.066890716552734
generate_one_block  6.08787989616394
generate_one_block  5.974900960922241
generate_one_block  6.0095202922821045
generate_one_block  5.9830403327941895
generate_one_block  5.984970569610596
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3340866565704346
gen group dst list time:  0.9226086139678955
time for parepare:  0.4829072952270508
local_output_nid generation:  0.5383780002593994
local_in_edges_tensor generation:  1.4199342727661133
mini_batch_src_global generation:  1.1235177516937256
r_  generation:  13.349538803100586
local_output_nid generation:  0.5573203563690186
local_in_edges_tensor generation:  1.3031485080718994
mini_batch_src_global generation:  1.3726725578308105
r_  generation:  13.376932144165039
local_output_nid generation:  0.5615451335906982
local_in_edges_tensor generation:  1.273209810256958
mini_batch_src_global generation:  1.428673267364502
r_  generation:  13.682977676391602
local_output_nid generation:  0.5344798564910889
local_in_edges_tensor generation:  1.0904500484466553
mini_batch_src_global generation:  1.4784255027770996
r_  generation:  13.546589612960815
local_output_nid generation:  0.5460760593414307
local_in_edges_tensor generation:  1.0814082622528076
mini_batch_src_global generation:  1.3733272552490234
r_  generation:  13.768982410430908
local_output_nid generation:  0.5545825958251953
local_in_edges_tensor generation:  1.1150009632110596
mini_batch_src_global generation:  1.4069745540618896
r_  generation:  13.69100308418274
local_output_nid generation:  0.5383691787719727
local_in_edges_tensor generation:  1.1846134662628174
mini_batch_src_global generation:  1.4459474086761475
r_  generation:  13.813361167907715
local_output_nid generation:  0.5349636077880859
local_in_edges_tensor generation:  1.0686585903167725
mini_batch_src_global generation:  1.4438960552215576
r_  generation:  13.515137195587158
local_output_nid generation:  0.5702638626098633
local_in_edges_tensor generation:  1.0744755268096924
mini_batch_src_global generation:  1.3727328777313232
r_  generation:  13.525864601135254
local_output_nid generation:  0.5352983474731445
local_in_edges_tensor generation:  1.0684430599212646
mini_batch_src_global generation:  1.3707287311553955
r_  generation:  13.58100152015686
local_output_nid generation:  0.5549299716949463
local_in_edges_tensor generation:  1.0747406482696533
mini_batch_src_global generation:  1.3882441520690918
r_  generation:  13.64120101928711
local_output_nid generation:  0.5378813743591309
local_in_edges_tensor generation:  1.2349469661712646
mini_batch_src_global generation:  1.3805911540985107
r_  generation:  13.718919277191162
local_output_nid generation:  0.528458833694458
local_in_edges_tensor generation:  1.0722334384918213
mini_batch_src_global generation:  1.4594223499298096
r_  generation:  13.64246153831482
local_output_nid generation:  0.5335512161254883
local_in_edges_tensor generation:  1.0723440647125244
mini_batch_src_global generation:  1.4040091037750244
r_  generation:  13.601069450378418
local_output_nid generation:  0.5676417350769043
local_in_edges_tensor generation:  1.0897512435913086
mini_batch_src_global generation:  1.3862547874450684
r_  generation:  13.529835224151611
local_output_nid generation:  0.5458865165710449
local_in_edges_tensor generation:  1.0729291439056396
mini_batch_src_global generation:  1.4387547969818115
r_  generation:  13.661436080932617
----------------------check_connections_block total spend ----------------------------- 305.6689956188202
generate_one_block  18.429625511169434
generate_one_block  19.356600761413574
generate_one_block  18.26368546485901
generate_one_block  17.867919445037842
generate_one_block  18.005937576293945
generate_one_block  17.916006803512573
generate_one_block  17.99478244781494
generate_one_block  18.50523328781128
generate_one_block  18.289177417755127
generate_one_block  18.702505350112915
generate_one_block  18.470299005508423
generate_one_block  18.55946111679077
generate_one_block  18.667850255966187
generate_one_block  18.18624997138977
generate_one_block  18.98126792907715
generate_one_block  18.746531009674072
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.601830005645752  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

connection checking time:  411.2669930458069
block generation total time  392.7420415878296
average batch blocks generation time:  24.54637759923935
block dataloader generation time/epoch 837.0691208839417
pseudo mini batch 0 input nodes size: 2127838
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7978320121765137  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7978320121765137  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.5905137062072754  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.5906052589416504  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7979984283447266  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.1300296783447266  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.1300296783447266  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2127838
first layer output nodes number: 1543481
edges number: 33028977
torch.Size([2127838, 100])
torch.Size([1543481, 256])
input nodes number: 1543481
output nodes number: 335618
edges number: 10851226
torch.Size([1543481, 256])
torch.Size([335618, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.45363187789917  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.455784320831299  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.6020598411560059  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 1 input nodes size: 2129061
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7980003356933594  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7980003356933594  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.591137409210205  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.59122896194458  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7984557151794434  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.130861759185791  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.130861759185791  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2129061
first layer output nodes number: 1548630
edges number: 33139783
torch.Size([2129061, 100])
torch.Size([1548630, 256])
input nodes number: 1548630
output nodes number: 337289
edges number: 10905080
torch.Size([1548630, 256])
torch.Size([337289, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.473645210266113  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.475797176361084  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.6050000190734863  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 2 input nodes size: 2128135
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7984557151794434  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7984557151794434  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.5912480354309082  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.5913395881652832  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7981109619140625  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.1307368278503418  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.1307368278503418  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2128135
first layer output nodes number: 1545112
edges number: 33116746
torch.Size([2128135, 100])
torch.Size([1545112, 256])
input nodes number: 1545112
output nodes number: 336051
edges number: 10869353
torch.Size([1545112, 256])
torch.Size([336051, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.461537837982178  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.463689804077148  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.6053075790405273  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 3 input nodes size: 2126232
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7988228797912598  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7988228797912598  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.5909061431884766  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.5909976959228516  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7981138229370117  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.1301469802856445  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.1301469802856445  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2126232
first layer output nodes number: 1544961
edges number: 33089931
torch.Size([2126232, 100])
torch.Size([1544961, 256])
input nodes number: 1544961
output nodes number: 336992
edges number: 10898893
torch.Size([1544961, 256])
torch.Size([336992, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.461361885070801  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.464225769042969  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.6029224395751953  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

pseudo mini batch 4 input nodes size: 2130603
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7974019050598145  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7974019050598145  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.591113567352295  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.59120512008667  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7990303039550781  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.131800651550293  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.131800651550293  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

first layer input nodes number: 2130603
first layer output nodes number: 1551366
edges number: 33188822
torch.Size([2130603, 100])
torch.Size([1551366, 256])
input nodes number: 1551366
output nodes number: 337787
edges number: 10927063
torch.Size([1551366, 256])
torch.Size([337787, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.483816146850586  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.486292839050293  GigaBytes
Max Memory Allocated: 8.470880031585693  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.6055068969726562  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

pseudo mini batch 5 input nodes size: 2128610
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7990303039550781  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7990303039550781  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.5919995307922363  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.5920910835266113  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7982878684997559  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.1311564445495605  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.1311564445495605  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

first layer input nodes number: 2128610
first layer output nodes number: 1550524
edges number: 33202378
torch.Size([2128610, 100])
torch.Size([1550524, 256])
input nodes number: 1550524
output nodes number: 336546
edges number: 10894061
torch.Size([1550524, 256])
torch.Size([336546, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.476060390472412  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.478212356567383  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.6048202514648438  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

pseudo mini batch 6 input nodes size: 2123018
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7985939979553223  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7985939979553223  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.589479923248291  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.589571475982666  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7965106964111328  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.1285419464111328  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.1285419464111328  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

first layer input nodes number: 2123018
first layer output nodes number: 1540618
edges number: 32962400
torch.Size([2123018, 100])
torch.Size([1540618, 256])
input nodes number: 1540618
output nodes number: 336563
edges number: 10882231
torch.Size([1540618, 256])
torch.Size([336563, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.446763038635254  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.449221134185791  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.6000251770019531  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

pseudo mini batch 7 input nodes size: 2128787
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7962045669555664  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7962045669555664  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.5892395973205566  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.5893311500549316  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7983536720275879  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.130384922027588  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.130384922027588  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

first layer input nodes number: 2128787
first layer output nodes number: 1543310
edges number: 33044437
torch.Size([2128787, 100])
torch.Size([1543310, 256])
input nodes number: 1543310
output nodes number: 336404
edges number: 10883121
torch.Size([1543310, 256])
torch.Size([336404, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.456950664520264  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.459102630615234  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.6027026176452637  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

pseudo mini batch 8 input nodes size: 2125513
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7983536720275879  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7983536720275879  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.5901694297790527  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.5902609825134277  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7971343994140625  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.1291656494140625  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.1291656494140625  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

first layer input nodes number: 2125513
first layer output nodes number: 1545082
edges number: 33085865
torch.Size([2125513, 100])
torch.Size([1545082, 256])
input nodes number: 1545082
output nodes number: 336579
edges number: 10893738
torch.Size([1545082, 256])
torch.Size([336579, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.461346626281738  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.46400785446167  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.602278709411621  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

pseudo mini batch 9 input nodes size: 2132201
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7971343994140625  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7971343994140625  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.5914416313171387  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.5915331840515137  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7996258735656738  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.1316571235656738  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.1316571235656738  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

first layer input nodes number: 2132201
first layer output nodes number: 1545165
edges number: 33074950
torch.Size([2132201, 100])
torch.Size([1545165, 256])
input nodes number: 1545165
output nodes number: 334949
edges number: 10817790
torch.Size([1545165, 256])
torch.Size([334949, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.456551551818848  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 6.458703517913818  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.603532314300537  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

pseudo mini batch 10 input nodes size: 2132389
----------------------------------------before load block subtensor 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7996258735656738  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.7996258735656738  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.5945477485656738  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.5946393013000488  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 0.8002405166625977  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.13421630859375  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 19.2752685546875 GB
    Memory Allocated: 1.13421630859375  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

first layer input nodes number: 2132389
first layer output nodes number: 1553660
edges number: 33229282
torch.Size([2132389, 100])
torch.Size([1553660, 256])
input nodes number: 1553660
output nodes number: 336912
edges number: 10899786
torch.Size([1553660, 256])
torch.Size([336912, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.8963623046875 GB
    Memory Allocated: 6.4900383949279785  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.8963623046875 GB
    Memory Allocated: 6.492190361022949  GigaBytes
Max Memory Allocated: 8.475185871124268  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.609177589416504  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 11 input nodes size: 2130183
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 0.8002405166625977  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 0.8002405166625977  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.5937957763671875  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.5938873291015625  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 0.7988739013671875  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.1316890716552734  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.1316890716552734  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2130183
first layer output nodes number: 1550167
edges number: 33195329
torch.Size([2130183, 100])
torch.Size([1550167, 256])
input nodes number: 1550167
output nodes number: 336457
edges number: 10899907
torch.Size([1550167, 256])
torch.Size([336457, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 6.475345134735107  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 6.477497100830078  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.6050066947937012  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 12 input nodes size: 2126132
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 0.7990603446960449  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 0.7990603446960449  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.5911064147949219  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.5911979675292969  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 0.797551155090332  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.129582405090332  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.129582405090332  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2126132
first layer output nodes number: 1537870
edges number: 32960541
torch.Size([2126132, 100])
torch.Size([1537870, 256])
input nodes number: 1537870
output nodes number: 334341
edges number: 10828546
torch.Size([1537870, 256])
torch.Size([334341, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 6.433789253234863  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 6.436233997344971  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.601797103881836  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 13 input nodes size: 2128609
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 0.7973647117614746  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 0.7973647117614746  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.5903334617614746  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.5904250144958496  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.1303186416625977  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.1303186416625977  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2128609
first layer output nodes number: 1544441
edges number: 33070751
torch.Size([2128609, 100])
torch.Size([1544441, 256])
input nodes number: 1544441
output nodes number: 335097
edges number: 10829599
torch.Size([1544441, 256])
torch.Size([335097, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 6.453709125518799  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 6.4558610916137695  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.6025967597961426  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 14 input nodes size: 2127675
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 0.7982873916625977  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.5909085273742676  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.5910000801086426  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 0.7979397773742676  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.1306381225585938  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.1306381225585938  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2127675
first layer output nodes number: 1545224
edges number: 33102731
torch.Size([2127675, 100])
torch.Size([1545224, 256])
input nodes number: 1545224
output nodes number: 335946
edges number: 10869573
torch.Size([1545224, 256])
torch.Size([335946, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 6.460119247436523  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 6.462271213531494  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.602900505065918  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 15 input nodes size: 2126983
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 0.7979397773742676  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 0.7979397773742676  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.5903029441833496  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.5903944969177246  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 0.7976818084716797  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.1297130584716797  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.1297130584716797  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2126983
first layer output nodes number: 1540414
edges number: 32987268
torch.Size([2126983, 100])
torch.Size([1540414, 256])
input nodes number: 1540414
output nodes number: 334798
edges number: 10837992
torch.Size([1540414, 256])
torch.Size([334798, 256])
torch.Size([12281, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 6.442253589630127  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 6.444404602050781  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.3807373046875 GB
    Memory Allocated: 1.6013784408569336  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.6013784408569336  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.6013784408569336  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.36914944648742676 |0.3314352035522461 |0.11969420313835144 |0.00016157329082489014 |0.012037813663482666 |0.0041656494140625 |
----------------------------------------------------------pseudo_mini_loss sum 4.4529619216918945
Total (block generation + training)time/epoch 851.6549978852272
Training time/epoch 13.535024166107178
Training time without block to device /epoch 8.23206090927124
Training time without total dataloading part /epoch 2.1144630908966064
load block tensor time/epoch 5.906391143798828
block to device time/epoch 5.3029632568359375
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  64160323
Number of first layer input nodes during this epoch:  34051969
Number of first layer output nodes during this epoch:  24730025
----------------------------------------before generate dataloader block 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.6013779640197754  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3656039237976074
number of batches is  16
batch size is  12286
random selection method spend 0.029215335845947266
time for parepare:  0.2873702049255371
local_output_nid generation:  0.0066547393798828125
local_in_edges_tensor generation:  0.03096938133239746
mini_batch_src_global generation:  0.017928600311279297
r_  generation:  0.17992711067199707
local_output_nid generation:  0.007208347320556641
local_in_edges_tensor generation:  0.010829925537109375
mini_batch_src_global generation:  0.02313518524169922
r_  generation:  0.20451593399047852
local_output_nid generation:  0.007307767868041992
local_in_edges_tensor generation:  0.009567499160766602
mini_batch_src_global generation:  0.015656471252441406
r_  generation:  0.20704054832458496
local_output_nid generation:  0.0072786808013916016
local_in_edges_tensor generation:  0.007483005523681641
mini_batch_src_global generation:  0.016567230224609375
r_  generation:  0.22015833854675293
local_output_nid generation:  0.007233619689941406
local_in_edges_tensor generation:  0.007381439208984375
mini_batch_src_global generation:  0.016496896743774414
r_  generation:  0.226898193359375
local_output_nid generation:  0.007272243499755859
local_in_edges_tensor generation:  0.007250785827636719
mini_batch_src_global generation:  0.0192258358001709
r_  generation:  0.23962926864624023
local_output_nid generation:  0.0072078704833984375
local_in_edges_tensor generation:  0.0065462589263916016
mini_batch_src_global generation:  0.020157814025878906
r_  generation:  0.24900484085083008
local_output_nid generation:  0.007199764251708984
local_in_edges_tensor generation:  0.008141517639160156
mini_batch_src_global generation:  0.02175283432006836
r_  generation:  0.25560975074768066
local_output_nid generation:  0.007226705551147461
local_in_edges_tensor generation:  0.007737874984741211
mini_batch_src_global generation:  0.02045464515686035
r_  generation:  0.2545294761657715
local_output_nid generation:  0.007157087326049805
local_in_edges_tensor generation:  0.006560087203979492
mini_batch_src_global generation:  0.021915674209594727
r_  generation:  0.2598097324371338
local_output_nid generation:  0.007162332534790039
local_in_edges_tensor generation:  0.0066225528717041016
mini_batch_src_global generation:  0.0233004093170166
r_  generation:  0.2652089595794678
local_output_nid generation:  0.007145404815673828
local_in_edges_tensor generation:  0.006524562835693359
mini_batch_src_global generation:  0.023207664489746094
r_  generation:  0.26961278915405273
local_output_nid generation:  0.007256269454956055
local_in_edges_tensor generation:  0.008196353912353516
mini_batch_src_global generation:  0.025295257568359375
r_  generation:  0.27154088020324707
local_output_nid generation:  0.007287740707397461
local_in_edges_tensor generation:  0.007348060607910156
mini_batch_src_global generation:  0.024326801300048828
r_  generation:  0.2730565071105957
local_output_nid generation:  0.007238864898681641
local_in_edges_tensor generation:  0.006738185882568359
mini_batch_src_global generation:  0.02465200424194336
r_  generation:  0.2704596519470215
local_output_nid generation:  0.007275819778442383
local_in_edges_tensor generation:  0.006672859191894531
mini_batch_src_global generation:  0.025633573532104492
r_  generation:  0.2717776298522949
----------------------check_connections_block total spend ----------------------------- 5.6023640632629395
generate_one_block  0.6644492149353027
generate_one_block  0.34084415435791016
generate_one_block  0.29733777046203613
generate_one_block  0.28403592109680176
generate_one_block  0.296278715133667
generate_one_block  0.27800655364990234
generate_one_block  0.2806985378265381
generate_one_block  0.28294849395751953
generate_one_block  0.29079627990722656
generate_one_block  0.28096461296081543
generate_one_block  0.2798919677734375
generate_one_block  0.28110575675964355
generate_one_block  0.2866203784942627
generate_one_block  0.2758767604827881
generate_one_block  0.279221773147583
generate_one_block  0.2791461944580078
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0735857486724854
gen group dst list time:  0.1602175235748291
time for parepare:  0.4137601852416992
local_output_nid generation:  0.11628961563110352
local_in_edges_tensor generation:  0.3642752170562744
mini_batch_src_global generation:  0.37076616287231445
r_  generation:  4.340871334075928
local_output_nid generation:  0.11647439002990723
local_in_edges_tensor generation:  0.4650685787200928
mini_batch_src_global generation:  0.45804786682128906
r_  generation:  4.472036361694336
local_output_nid generation:  0.11578750610351562
local_in_edges_tensor generation:  0.31739211082458496
mini_batch_src_global generation:  0.5071299076080322
r_  generation:  4.876014232635498
local_output_nid generation:  0.13921618461608887
local_in_edges_tensor generation:  0.46645164489746094
mini_batch_src_global generation:  0.4666402339935303
r_  generation:  4.600152254104614
local_output_nid generation:  0.11474490165710449
local_in_edges_tensor generation:  0.3139026165008545
mini_batch_src_global generation:  0.48166418075561523
r_  generation:  4.737184762954712
local_output_nid generation:  0.11643505096435547
local_in_edges_tensor generation:  0.30129361152648926
mini_batch_src_global generation:  0.4878239631652832
r_  generation:  4.749362230300903
local_output_nid generation:  0.12532496452331543
local_in_edges_tensor generation:  0.3015429973602295
mini_batch_src_global generation:  0.5009429454803467
r_  generation:  4.814345359802246
local_output_nid generation:  0.11591744422912598
local_in_edges_tensor generation:  0.2929387092590332
mini_batch_src_global generation:  0.4956929683685303
r_  generation:  4.791106224060059
local_output_nid generation:  0.11612963676452637
local_in_edges_tensor generation:  0.313251256942749
mini_batch_src_global generation:  0.512965202331543
r_  generation:  4.859441757202148
local_output_nid generation:  0.11607003211975098
local_in_edges_tensor generation:  0.35429978370666504
mini_batch_src_global generation:  0.5151500701904297
r_  generation:  4.963656663894653
local_output_nid generation:  0.11496472358703613
local_in_edges_tensor generation:  0.3738725185394287
mini_batch_src_global generation:  0.5230422019958496
r_  generation:  4.850815773010254
local_output_nid generation:  0.12678790092468262
local_in_edges_tensor generation:  0.30556416511535645
mini_batch_src_global generation:  0.505117654800415
r_  generation:  4.79965353012085
local_output_nid generation:  0.11682391166687012
local_in_edges_tensor generation:  0.3045313358306885
mini_batch_src_global generation:  0.5131781101226807
r_  generation:  4.869727373123169
local_output_nid generation:  0.11491179466247559
local_in_edges_tensor generation:  0.2979707717895508
mini_batch_src_global generation:  0.5025234222412109
r_  generation:  4.81852650642395
local_output_nid generation:  0.1252737045288086
local_in_edges_tensor generation:  0.29956960678100586
mini_batch_src_global generation:  0.5088138580322266
r_  generation:  4.837810754776001
local_output_nid generation:  0.11548447608947754
local_in_edges_tensor generation:  0.29520416259765625
mini_batch_src_global generation:  0.5094988346099854
r_  generation:  4.8552024364471436
----------------------check_connections_block total spend ----------------------------- 104.6808967590332
generate_one_block  6.57518744468689
generate_one_block  6.028827428817749
generate_one_block  6.1304895877838135
generate_one_block  6.105652809143066
generate_one_block  6.564825057983398
generate_one_block  6.282896041870117
generate_one_block  6.119889497756958
generate_one_block  6.1004321575164795
generate_one_block  6.118444442749023
generate_one_block  6.0670835971832275
generate_one_block  6.0541651248931885
generate_one_block  6.070466756820679
generate_one_block  6.131696462631226
generate_one_block  6.021950721740723
generate_one_block  6.103911638259888
generate_one_block  6.0913426876068115
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3425350189208984
gen group dst list time:  0.8800935745239258
time for parepare:  0.46463489532470703
local_output_nid generation:  0.5146520137786865
local_in_edges_tensor generation:  1.284959077835083
mini_batch_src_global generation:  1.0846984386444092
r_  generation:  13.042463302612305
local_output_nid generation:  0.5099327564239502
local_in_edges_tensor generation:  1.2910840511322021
mini_batch_src_global generation:  1.3817791938781738
r_  generation:  13.335850715637207
local_output_nid generation:  0.5146579742431641
local_in_edges_tensor generation:  1.1328139305114746
mini_batch_src_global generation:  1.351916790008545
r_  generation:  13.447386026382446
local_output_nid generation:  0.5181455612182617
local_in_edges_tensor generation:  1.1454644203186035
mini_batch_src_global generation:  1.409400463104248
r_  generation:  13.54410719871521
local_output_nid generation:  0.5347404479980469
local_in_edges_tensor generation:  1.1482162475585938
mini_batch_src_global generation:  1.3743574619293213
r_  generation:  13.622469425201416
local_output_nid generation:  0.553818941116333
local_in_edges_tensor generation:  1.131833553314209
mini_batch_src_global generation:  1.3857917785644531
r_  generation:  13.678284168243408
local_output_nid generation:  0.5335822105407715
local_in_edges_tensor generation:  1.1433663368225098
mini_batch_src_global generation:  1.40679931640625
r_  generation:  13.717979192733765
local_output_nid generation:  0.5372703075408936
local_in_edges_tensor generation:  1.3490266799926758
mini_batch_src_global generation:  1.4372084140777588
r_  generation:  13.72676396369934
local_output_nid generation:  0.5667290687561035
local_in_edges_tensor generation:  1.1319167613983154
mini_batch_src_global generation:  1.3697834014892578
r_  generation:  13.594255208969116
local_output_nid generation:  0.5310268402099609
local_in_edges_tensor generation:  1.079643726348877
mini_batch_src_global generation:  1.402259349822998
r_  generation:  13.661224126815796
local_output_nid generation:  0.5467016696929932
local_in_edges_tensor generation:  1.09269380569458
mini_batch_src_global generation:  1.4005804061889648
r_  generation:  13.563352584838867
local_output_nid generation:  0.5299162864685059
local_in_edges_tensor generation:  1.0779480934143066
mini_batch_src_global generation:  1.4182934761047363
r_  generation:  13.53601861000061
local_output_nid generation:  0.5342683792114258
local_in_edges_tensor generation:  1.1543617248535156
mini_batch_src_global generation:  1.4036786556243896
r_  generation:  13.523784637451172
local_output_nid generation:  0.5298874378204346
local_in_edges_tensor generation:  1.0712931156158447
mini_batch_src_global generation:  1.4212563037872314
r_  generation:  13.621519804000854
local_output_nid generation:  0.5361781120300293
local_in_edges_tensor generation:  1.151163101196289
mini_batch_src_global generation:  1.426692008972168
r_  generation:  13.686612606048584
local_output_nid generation:  0.5629949569702148
local_in_edges_tensor generation:  1.0740275382995605
mini_batch_src_global generation:  1.386976718902588
r_  generation:  13.566279649734497
----------------------check_connections_block total spend ----------------------------- 305.01197123527527
generate_one_block  18.523553371429443
generate_one_block  19.281675815582275
generate_one_block  17.927820920944214
generate_one_block  18.173893690109253
generate_one_block  18.082255363464355
generate_one_block  17.782135486602783
generate_one_block  17.91460394859314
generate_one_block  17.941545248031616
generate_one_block  18.26311421394348
generate_one_block  18.536110401153564
generate_one_block  18.1606867313385
generate_one_block  18.950188875198364
generate_one_block  18.63307237625122
generate_one_block  18.28995418548584
generate_one_block  19.060975074768066
generate_one_block  18.70110774040222
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.6013779640197754  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

connection checking time:  409.6928679943085
block generation total time  392.7899549007416
average batch blocks generation time:  24.54937218129635
block dataloader generation time/epoch 836.5549785614014
pseudo mini batch 0 input nodes size: 2127895
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 0.7976799011230469  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 0.7976799011230469  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.5903825759887695  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.5904741287231445  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 0.7980194091796875  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.1300506591796875  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.1300506591796875  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2127895
first layer output nodes number: 1543221
edges number: 33028632
torch.Size([2127895, 100])
torch.Size([1543221, 256])
input nodes number: 1543221
output nodes number: 335885
edges number: 10856581
torch.Size([1543221, 256])
torch.Size([335885, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 6.453038692474365  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 6.455681800842285  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.6031055450439453  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 1 input nodes size: 2129645
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 0.7980213165283203  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 0.7980213165283203  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.5913763046264648  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.5914678573608398  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 0.7986736297607422  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.1309080123901367  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.1309080123901367  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2129645
first layer output nodes number: 1545819
edges number: 33116901
torch.Size([2129645, 100])
torch.Size([1545819, 256])
input nodes number: 1545819
output nodes number: 335748
edges number: 10863914
torch.Size([1545819, 256])
torch.Size([335748, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 6.460416793823242  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 6.462568759918213  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.6042747497558594  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 2 input nodes size: 2124812
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 0.7986736297607422  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 0.7986736297607422  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.5902280807495117  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.5903196334838867  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 0.7968730926513672  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.1289043426513672  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.1289043426513672  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2124812
first layer output nodes number: 1539318
edges number: 32958992
torch.Size([2124812, 100])
torch.Size([1539318, 256])
input nodes number: 1539318
output nodes number: 335559
edges number: 10861495
torch.Size([1539318, 256])
torch.Size([335559, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 6.443094253540039  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 6.44524621963501  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.6022491455078125  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 3 input nodes size: 2128509
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 0.7968730926513672  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 0.7968730926513672  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.5898046493530273  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.5898962020874023  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 0.7982501983642578  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.130324363708496  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.130324363708496  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2128509
first layer output nodes number: 1546458
edges number: 33096161
torch.Size([2128509, 100])
torch.Size([1546458, 256])
input nodes number: 1546458
output nodes number: 335779
edges number: 10867402
torch.Size([1546458, 256])
torch.Size([335779, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 6.46112585067749  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 6.463277816772461  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.6026873588562012  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 4 input nodes size: 2129896
----------------------------------------before load block subtensor 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 0.7982501983642578  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 0.7982501983642578  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.5916986465454102  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.5917901992797852  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 0.79876708984375  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.131363868713379  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 1.131363868713379  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2129896
first layer output nodes number: 1549708
edges number: 33166552
torch.Size([2129896, 100])
torch.Size([1549708, 256])
input nodes number: 1549708
output nodes number: 335631
edges number: 10850590
torch.Size([1549708, 256])
torch.Size([335631, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 6.470397472381592  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.3826904296875 GB
    Memory Allocated: 6.473175525665283  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.6049079895019531  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 5 input nodes size: 2123872
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.79876708984375  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.79876708984375  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.5899710655212402  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.5900626182556152  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7965226173400879  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.128553867340088  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.128553867340088  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2123872
first layer output nodes number: 1539742
edges number: 32974258
torch.Size([2123872, 100])
torch.Size([1539742, 256])
input nodes number: 1539742
output nodes number: 335205
edges number: 10848054
torch.Size([1539742, 256])
torch.Size([335205, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 6.440944671630859  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 6.443403244018555  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.6017260551452637  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 6 input nodes size: 2126934
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7965226173400879  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7965226173400879  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.5888676643371582  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.5889592170715332  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.797663688659668  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.129694938659668  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.129694938659668  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2126934
first layer output nodes number: 1542620
edges number: 33053211
torch.Size([2126934, 100])
torch.Size([1542620, 256])
input nodes number: 1542620
output nodes number: 335042
edges number: 10839356
torch.Size([1542620, 256])
torch.Size([335042, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 6.449818134307861  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 6.451970100402832  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.6017723083496094  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 7 input nodes size: 2125994
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.797947883605957  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.797947883605957  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.589942455291748  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.590034008026123  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7975974082946777  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.1296677589416504  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.1296677589416504  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2125994
first layer output nodes number: 1546278
edges number: 33093683
torch.Size([2125994, 100])
torch.Size([1546278, 256])
input nodes number: 1546278
output nodes number: 336694
edges number: 10880590
torch.Size([1546278, 256])
torch.Size([336694, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 6.4628729820251465  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 6.465309143066406  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.6029129028320312  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 8 input nodes size: 2128880
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7973132133483887  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7973132133483887  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.5903830528259277  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.5904746055603027  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7983884811401367  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.1307644844055176  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.1307644844055176  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2128880
first layer output nodes number: 1546588
edges number: 33119371
torch.Size([2128880, 100])
torch.Size([1546588, 256])
input nodes number: 1546588
output nodes number: 337012
edges number: 10910267
torch.Size([1546588, 256])
torch.Size([337012, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 6.4668169021606445  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 6.468968868255615  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.6039714813232422  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 9 input nodes size: 2129563
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7983884811401367  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7983884811401367  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.5917129516601562  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.5918045043945312  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7986431121826172  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.130950927734375  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.130950927734375  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2129563
first layer output nodes number: 1545045
edges number: 33127359
torch.Size([2129563, 100])
torch.Size([1545045, 256])
input nodes number: 1545045
output nodes number: 335940
edges number: 10875868
torch.Size([1545045, 256])
torch.Size([335940, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 6.459212303161621  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 6.461364269256592  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.6031126976013184  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 10 input nodes size: 2129520
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7989892959594727  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7989892959594727  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.5922975540161133  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.5923891067504883  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7989730834960938  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.1315479278564453  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.1315479278564453  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2129520
first layer output nodes number: 1550715
edges number: 33163028
torch.Size([2129520, 100])
torch.Size([1550715, 256])
input nodes number: 1550715
output nodes number: 336711
edges number: 10878365
torch.Size([1550715, 256])
torch.Size([336711, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 6.47777795791626  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 6.4799299240112305  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.6052179336547852  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 11 input nodes size: 2130844
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7995815277099609  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7995815277099609  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.5933828353881836  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.5934743881225586  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.800074577331543  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.1326942443847656  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.1326942443847656  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2130844
first layer output nodes number: 1549526
edges number: 33169346
torch.Size([2130844, 100])
torch.Size([1549526, 256])
input nodes number: 1549526
output nodes number: 336967
edges number: 10892352
torch.Size([1549526, 256])
torch.Size([336967, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 6.473958492279053  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 6.4764862060546875  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.6048307418823242  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 12 input nodes size: 2126268
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7991199493408203  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7991199493408203  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.5912165641784668  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.5913081169128418  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7974152565002441  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.1303744316101074  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.1303744316101074  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2126268
first layer output nodes number: 1544715
edges number: 33106633
torch.Size([2126268, 100])
torch.Size([1544715, 256])
input nodes number: 1544715
output nodes number: 338083
edges number: 10954100
torch.Size([1544715, 256])
torch.Size([338083, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 6.465005397796631  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 6.467157363891602  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.6038455963134766  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 13 input nodes size: 2126831
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7974152565002441  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7974152565002441  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.5897216796875  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.589813232421875  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7976250648498535  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.1298213005065918  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.1298213005065918  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2126831
first layer output nodes number: 1545284
edges number: 33111547
torch.Size([2126831, 100])
torch.Size([1545284, 256])
input nodes number: 1545284
output nodes number: 335636
edges number: 10860725
torch.Size([1545284, 256])
torch.Size([335636, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 6.458366394042969  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 6.4605183601379395  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.6020140647888184  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 14 input nodes size: 2131499
----------------------------------------before load block subtensor 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7976250648498535  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.7976250648498535  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.5925469398498535  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.5926384925842285  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 0.8002405166625977  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.1330327987670898  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 1.1330327987670898  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2131499
first layer output nodes number: 1551212
edges number: 33192849
torch.Size([2131499, 100])
torch.Size([1551212, 256])
input nodes number: 1551212
output nodes number: 336811
edges number: 10907285
torch.Size([1551212, 256])
torch.Size([336811, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 6.480058193206787  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 14.8612060546875 GB
    Memory Allocated: 6.483151435852051  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.6064987182617188  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 15 input nodes size: 2132002
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.8002405166625977  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.8002405166625977  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5944733619689941  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5945649147033691  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7995514869689941  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1320843696594238  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1320843696594238  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2132002
first layer output nodes number: 1550030
edges number: 33157334
torch.Size([2132002, 100])
torch.Size([1550030, 256])
input nodes number: 1550030
output nodes number: 336652
edges number: 10889687
torch.Size([1550030, 256])
torch.Size([336652, 256])
torch.Size([12281, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.4760355949401855  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.47818660736084  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.6060490608215332  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.6060490608215332  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.6060490608215332  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38188327848911285 |0.455348402261734 |0.10276487469673157 |0.00014518201351165771 |0.005234092473983765 |0.001249074935913086 |
----------------------------------------------------------pseudo_mini_loss sum 3.345235824584961
Total (block generation + training)time/epoch 851.2922524452209
Training time/epoch 15.34264087677002
Training time without block to device /epoch 8.057066440582275
Training time without total dataloading part /epoch 1.731555461883545
load block tensor time/epoch 6.110132455825806
block to device time/epoch 7.285574436187744
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  64168598
Number of first layer input nodes during this epoch:  34052964
Number of first layer output nodes during this epoch:  24736279
----------------------------------------before generate dataloader block 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.606048583984375  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3822615146636963
number of batches is  16
batch size is  12286
random selection method spend 0.015300512313842773
time for parepare:  0.3056814670562744
local_output_nid generation:  0.0065152645111083984
local_in_edges_tensor generation:  0.0382843017578125
mini_batch_src_global generation:  0.01770949363708496
r_  generation:  0.1750190258026123
local_output_nid generation:  0.007128477096557617
local_in_edges_tensor generation:  0.009822845458984375
mini_batch_src_global generation:  0.02019786834716797
r_  generation:  0.19869160652160645
local_output_nid generation:  0.007051229476928711
local_in_edges_tensor generation:  0.007195472717285156
mini_batch_src_global generation:  0.012734413146972656
r_  generation:  0.20162606239318848
local_output_nid generation:  0.007116794586181641
local_in_edges_tensor generation:  0.007965803146362305
mini_batch_src_global generation:  0.014897346496582031
r_  generation:  0.21579885482788086
local_output_nid generation:  0.007044792175292969
local_in_edges_tensor generation:  0.016382694244384766
mini_batch_src_global generation:  0.013614892959594727
r_  generation:  0.2183985710144043
local_output_nid generation:  0.007093667984008789
local_in_edges_tensor generation:  0.010334253311157227
mini_batch_src_global generation:  0.016181468963623047
r_  generation:  0.23671412467956543
local_output_nid generation:  0.007050752639770508
local_in_edges_tensor generation:  0.008052825927734375
mini_batch_src_global generation:  0.01699972152709961
r_  generation:  0.2461550235748291
local_output_nid generation:  0.007018089294433594
local_in_edges_tensor generation:  0.00793313980102539
mini_batch_src_global generation:  0.01749563217163086
r_  generation:  0.24956130981445312
local_output_nid generation:  0.007075309753417969
local_in_edges_tensor generation:  0.007228851318359375
mini_batch_src_global generation:  0.01744985580444336
r_  generation:  0.24590182304382324
local_output_nid generation:  0.007036924362182617
local_in_edges_tensor generation:  0.006758451461791992
mini_batch_src_global generation:  0.020276308059692383
r_  generation:  0.25118327140808105
local_output_nid generation:  0.0070514678955078125
local_in_edges_tensor generation:  0.01541447639465332
mini_batch_src_global generation:  0.02013254165649414
r_  generation:  0.2575497627258301
local_output_nid generation:  0.0071032047271728516
local_in_edges_tensor generation:  0.011986017227172852
mini_batch_src_global generation:  0.021777629852294922
r_  generation:  0.26149535179138184
local_output_nid generation:  0.007089376449584961
local_in_edges_tensor generation:  0.008928298950195312
mini_batch_src_global generation:  0.02122974395751953
r_  generation:  0.25696778297424316
local_output_nid generation:  0.007041454315185547
local_in_edges_tensor generation:  0.007093667984008789
mini_batch_src_global generation:  0.021322011947631836
r_  generation:  0.2633705139160156
local_output_nid generation:  0.00709223747253418
local_in_edges_tensor generation:  0.00768280029296875
mini_batch_src_global generation:  0.02186441421508789
r_  generation:  0.2599341869354248
local_output_nid generation:  0.0070683956146240234
local_in_edges_tensor generation:  0.007944345474243164
mini_batch_src_global generation:  0.02222585678100586
r_  generation:  0.2617475986480713
----------------------check_connections_block total spend ----------------------------- 5.5012898445129395
generate_one_block  0.6482183933258057
generate_one_block  0.32894253730773926
generate_one_block  0.2868180274963379
generate_one_block  0.2760179042816162
generate_one_block  0.2718160152435303
generate_one_block  0.2703070640563965
generate_one_block  0.26914072036743164
generate_one_block  0.2695591449737549
generate_one_block  0.28244805335998535
generate_one_block  0.2675628662109375
generate_one_block  0.27005910873413086
generate_one_block  0.27084994316101074
generate_one_block  0.26873230934143066
generate_one_block  0.2692267894744873
generate_one_block  0.2696964740753174
generate_one_block  0.2698063850402832
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0020954608917236
gen group dst list time:  0.1597604751586914
time for parepare:  0.424959659576416
local_output_nid generation:  0.13161754608154297
local_in_edges_tensor generation:  0.3958899974822998
mini_batch_src_global generation:  0.37221527099609375
r_  generation:  4.33844518661499
local_output_nid generation:  0.13792061805725098
local_in_edges_tensor generation:  0.3068668842315674
mini_batch_src_global generation:  0.46293044090270996
r_  generation:  4.433500528335571
local_output_nid generation:  0.13709044456481934
local_in_edges_tensor generation:  0.31223630905151367
mini_batch_src_global generation:  0.44621777534484863
r_  generation:  4.5697314739227295
local_output_nid generation:  0.13341927528381348
local_in_edges_tensor generation:  0.47333693504333496
mini_batch_src_global generation:  0.46156835556030273
r_  generation:  4.649913787841797
local_output_nid generation:  0.13345050811767578
local_in_edges_tensor generation:  0.31638050079345703
mini_batch_src_global generation:  0.4932992458343506
r_  generation:  4.887593984603882
local_output_nid generation:  0.15146660804748535
local_in_edges_tensor generation:  0.46800899505615234
mini_batch_src_global generation:  0.49454498291015625
r_  generation:  4.735421657562256
local_output_nid generation:  0.14801597595214844
local_in_edges_tensor generation:  0.30959343910217285
mini_batch_src_global generation:  0.4965665340423584
r_  generation:  4.742842197418213
local_output_nid generation:  0.13658928871154785
local_in_edges_tensor generation:  0.29517269134521484
mini_batch_src_global generation:  0.4906184673309326
r_  generation:  4.735459804534912
local_output_nid generation:  0.1387789249420166
local_in_edges_tensor generation:  0.2983379364013672
mini_batch_src_global generation:  0.49695372581481934
r_  generation:  4.7266929149627686
local_output_nid generation:  0.14684605598449707
local_in_edges_tensor generation:  0.28969359397888184
mini_batch_src_global generation:  0.4960033893585205
r_  generation:  4.74960470199585
local_output_nid generation:  0.136671781539917
local_in_edges_tensor generation:  0.29662013053894043
mini_batch_src_global generation:  0.5007529258728027
r_  generation:  4.841030120849609
local_output_nid generation:  0.1382904052734375
local_in_edges_tensor generation:  0.29241275787353516
mini_batch_src_global generation:  0.5071818828582764
r_  generation:  4.816863775253296
local_output_nid generation:  0.13741064071655273
local_in_edges_tensor generation:  0.35105085372924805
mini_batch_src_global generation:  0.506065845489502
r_  generation:  4.824229717254639
local_output_nid generation:  0.1382460594177246
local_in_edges_tensor generation:  0.3112607002258301
mini_batch_src_global generation:  0.5005507469177246
r_  generation:  4.886183500289917
local_output_nid generation:  0.1367807388305664
local_in_edges_tensor generation:  0.2980964183807373
mini_batch_src_global generation:  0.520704984664917
r_  generation:  4.813650131225586
local_output_nid generation:  0.158860445022583
local_in_edges_tensor generation:  0.3550543785095215
mini_batch_src_global generation:  0.4994087219238281
r_  generation:  4.780599117279053
----------------------check_connections_block total spend ----------------------------- 104.16246604919434
generate_one_block  6.625352382659912
generate_one_block  5.9810168743133545
generate_one_block  5.980746507644653
generate_one_block  5.981409311294556
generate_one_block  6.288433074951172
generate_one_block  5.967284917831421
generate_one_block  5.955462455749512
generate_one_block  5.974404811859131
generate_one_block  5.955768346786499
generate_one_block  5.966346740722656
generate_one_block  5.9634058475494385
generate_one_block  5.990420341491699
generate_one_block  5.967970609664917
generate_one_block  5.956735610961914
generate_one_block  5.931086301803589
generate_one_block  6.137905836105347
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2795557975769043
gen group dst list time:  0.8566524982452393
time for parepare:  0.490081787109375
local_output_nid generation:  0.5331776142120361
local_in_edges_tensor generation:  1.2988426685333252
mini_batch_src_global generation:  1.098665475845337
r_  generation:  13.175159215927124
local_output_nid generation:  0.5468530654907227
local_in_edges_tensor generation:  1.1581006050109863
mini_batch_src_global generation:  1.3614521026611328
r_  generation:  13.373355627059937
local_output_nid generation:  0.5538699626922607
local_in_edges_tensor generation:  1.1850876808166504
mini_batch_src_global generation:  1.4271032810211182
r_  generation:  13.683130741119385
local_output_nid generation:  0.528839111328125
local_in_edges_tensor generation:  1.453878402709961
mini_batch_src_global generation:  1.3751327991485596
r_  generation:  13.870717525482178
local_output_nid generation:  0.5365290641784668
local_in_edges_tensor generation:  1.1311535835266113
mini_batch_src_global generation:  1.394087553024292
r_  generation:  13.836308002471924
local_output_nid generation:  0.5395259857177734
local_in_edges_tensor generation:  1.1307010650634766
mini_batch_src_global generation:  1.4228105545043945
r_  generation:  13.591107606887817
local_output_nid generation:  0.550098180770874
local_in_edges_tensor generation:  1.1353967189788818
mini_batch_src_global generation:  1.3952205181121826
r_  generation:  13.66553521156311
local_output_nid generation:  0.5455119609832764
local_in_edges_tensor generation:  1.127718448638916
mini_batch_src_global generation:  1.382230281829834
r_  generation:  13.58535122871399
local_output_nid generation:  0.5360715389251709
local_in_edges_tensor generation:  1.1272602081298828
mini_batch_src_global generation:  1.4446845054626465
r_  generation:  13.579623937606812
local_output_nid generation:  0.534527063369751
local_in_edges_tensor generation:  1.0850811004638672
mini_batch_src_global generation:  1.3934035301208496
r_  generation:  13.609905004501343
local_output_nid generation:  0.5295500755310059
local_in_edges_tensor generation:  1.2246479988098145
mini_batch_src_global generation:  1.3870337009429932
r_  generation:  13.68650507926941
local_output_nid generation:  0.530613899230957
local_in_edges_tensor generation:  1.0818626880645752
mini_batch_src_global generation:  1.37937593460083
r_  generation:  13.871195316314697
local_output_nid generation:  0.5453197956085205
local_in_edges_tensor generation:  1.0818779468536377
mini_batch_src_global generation:  1.399287462234497
r_  generation:  13.783600568771362
local_output_nid generation:  0.5333812236785889
local_in_edges_tensor generation:  1.0947265625
mini_batch_src_global generation:  1.427243947982788
r_  generation:  13.731204748153687
local_output_nid generation:  0.5617177486419678
local_in_edges_tensor generation:  1.076263666152954
mini_batch_src_global generation:  1.3880558013916016
r_  generation:  13.62269115447998
local_output_nid generation:  0.5460617542266846
local_in_edges_tensor generation:  1.0811338424682617
mini_batch_src_global generation:  1.3769798278808594
r_  generation:  13.735772848129272
----------------------check_connections_block total spend ----------------------------- 306.68884325027466
generate_one_block  18.615341663360596
generate_one_block  19.312968015670776
generate_one_block  18.447686672210693
generate_one_block  18.003061532974243
generate_one_block  18.121857404708862
generate_one_block  17.976622343063354
generate_one_block  18.037132501602173
generate_one_block  18.425562143325806
generate_one_block  18.154387712478638
generate_one_block  18.7393639087677
generate_one_block  18.32082772254944
generate_one_block  18.714370727539062
generate_one_block  18.46597409248352
generate_one_block  18.48161482810974
generate_one_block  19.02182173728943
generate_one_block  18.56783962249756
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.606048583984375  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

connection checking time:  410.851309299469
block generation total time  392.03018260002136
average batch blocks generation time:  24.501886412501335
block dataloader generation time/epoch 836.1950800418854
pseudo mini batch 0 input nodes size: 2129830
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7995495796203613  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7995495796203613  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.592973232269287  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.593064785003662  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7987403869628906  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.131256103515625  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.131256103515625  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2129830
first layer output nodes number: 1546629
edges number: 33154384
torch.Size([2129830, 100])
torch.Size([1546629, 256])
input nodes number: 1546629
output nodes number: 336327
edges number: 10883203
torch.Size([1546629, 256])
torch.Size([336327, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.4656195640563965  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.467772006988525  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.6051430702209473  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 1 input nodes size: 2128426
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7987422943115234  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7987422943115234  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5916428565979004  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5917344093322754  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7982192039489746  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1302504539489746  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1302504539489746  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2128426
first layer output nodes number: 1542502
edges number: 33041900
torch.Size([2128426, 100])
torch.Size([1542502, 256])
input nodes number: 1542502
output nodes number: 336010
edges number: 10856766
torch.Size([1542502, 256])
torch.Size([336010, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.451456546783447  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.453608512878418  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.6017322540283203  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 2 input nodes size: 2130713
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7983551025390625  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7983551025390625  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5921077728271484  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5921993255615234  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7992072105407715  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1319012641906738  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1319012641906738  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2130713
first layer output nodes number: 1550252
edges number: 33179847
torch.Size([2130713, 100])
torch.Size([1550252, 256])
input nodes number: 1550252
output nodes number: 336970
edges number: 10888461
torch.Size([1550252, 256])
torch.Size([336970, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.475948810577393  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.478100776672363  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.604649543762207  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 3 input nodes size: 2127503
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7991795539855957  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7991795539855957  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5917363166809082  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5918278694152832  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7979836463928223  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.130662441253662  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.130662441253662  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2127503
first layer output nodes number: 1549034
edges number: 33176377
torch.Size([2127503, 100])
torch.Size([1549034, 256])
input nodes number: 1549034
output nodes number: 337133
edges number: 10911264
torch.Size([1549034, 256])
torch.Size([337133, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.473537445068359  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.475797653198242  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.604982852935791  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 4 input nodes size: 2128285
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7978754043579102  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7978754043579102  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5907235145568848  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5908150672912598  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7981667518615723  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1305632591247559  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1305632591247559  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2128285
first layer output nodes number: 1545238
edges number: 33092897
torch.Size([2128285, 100])
torch.Size([1545238, 256])
input nodes number: 1545238
output nodes number: 335818
edges number: 10870207
torch.Size([1545238, 256])
torch.Size([335818, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.458832263946533  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.460984230041504  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.6031360626220703  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 5 input nodes size: 2126706
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7981667518615723  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7981667518615723  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5904269218444824  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5905184745788574  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7975788116455078  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.129887580871582  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.129887580871582  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2126706
first layer output nodes number: 1545966
edges number: 33128016
torch.Size([2126706, 100])
torch.Size([1545966, 256])
input nodes number: 1545966
output nodes number: 336796
edges number: 10905963
torch.Size([1545966, 256])
torch.Size([336796, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.46298885345459  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.4651408195495605  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.6025981903076172  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 6 input nodes size: 2126586
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7975788116455078  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7975788116455078  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5897941589355469  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5898857116699219  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7975339889526367  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1295652389526367  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1295652389526367  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2126586
first layer output nodes number: 1543828
edges number: 33068193
torch.Size([2126586, 100])
torch.Size([1543828, 256])
input nodes number: 1543828
output nodes number: 336188
edges number: 10875744
torch.Size([1543828, 256])
torch.Size([336188, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.45478630065918  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.457221031188965  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.6023659706115723  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 7 input nodes size: 2128439
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7975339889526367  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7975339889526367  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5904393196105957  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5905308723449707  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7982239723205566  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1303563117980957  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1303563117980957  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2128439
first layer output nodes number: 1545717
edges number: 33103628
torch.Size([2128439, 100])
torch.Size([1545717, 256])
input nodes number: 1545717
output nodes number: 336116
edges number: 10873376
torch.Size([1545717, 256])
torch.Size([336116, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.461060523986816  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.463212490081787  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.6034936904907227  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 8 input nodes size: 2123854
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7982239723205566  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7982239723205566  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.589421272277832  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.589512825012207  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.796515941619873  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.128509521484375  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.128509521484375  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2123854
first layer output nodes number: 1540247
edges number: 32992551
torch.Size([2123854, 100])
torch.Size([1540247, 256])
input nodes number: 1540247
output nodes number: 335383
edges number: 10850525
torch.Size([1540247, 256])
torch.Size([335383, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.442251682281494  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.444403648376465  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.600015640258789  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 9 input nodes size: 2126502
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.796515941619873  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.796515941619873  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5886998176574707  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5887913703918457  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7975025177001953  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1295337677001953  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1295337677001953  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2126502
first layer output nodes number: 1542499
edges number: 33052108
torch.Size([2126502, 100])
torch.Size([1542499, 256])
input nodes number: 1542499
output nodes number: 335201
edges number: 10851198
torch.Size([1542499, 256])
torch.Size([335201, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.449889183044434  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.452041149139404  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.6026477813720703  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 10 input nodes size: 2128559
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7975025177001953  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7975025177001953  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5904526710510254  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5905442237854004  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7982687950134277  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1313352584838867  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1313352584838867  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2128559
first layer output nodes number: 1545318
edges number: 33107317
torch.Size([2128559, 100])
torch.Size([1545318, 256])
input nodes number: 1545318
output nodes number: 335536
edges number: 10865168
torch.Size([1545318, 256])
torch.Size([335536, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.460134029388428  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.462285995483398  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.6030035018920898  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 11 input nodes size: 2128437
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7982687950134277  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7982687950134277  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5911736488342285  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5912652015686035  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7982234954833984  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1303091049194336  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1303091049194336  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2128437
first layer output nodes number: 1545688
edges number: 33095842
torch.Size([2128437, 100])
torch.Size([1545688, 256])
input nodes number: 1545688
output nodes number: 336976
edges number: 10884266
torch.Size([1545688, 256])
torch.Size([336976, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.463831424713135  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.4659833908081055  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.6040668487548828  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 12 input nodes size: 2125911
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7982234954833984  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7982234954833984  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5901870727539062  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.5902786254882812  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7972822189331055  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1293134689331055  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1293134689331055  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2125911
first layer output nodes number: 1544630
edges number: 33067133
torch.Size([2125911, 100])
torch.Size([1544630, 256])
input nodes number: 1544630
output nodes number: 336795
edges number: 10892160
torch.Size([1544630, 256])
torch.Size([336795, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.459880352020264  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.46231746673584  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.6028532981872559  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 13 input nodes size: 2127716
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7972822189331055  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7972822189331055  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.589918613433838  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.590010166168213  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7979550361633301  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1300568580627441  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1300568580627441  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2127716
first layer output nodes number: 1544829
edges number: 33099234
torch.Size([2127716, 100])
torch.Size([1544829, 256])
input nodes number: 1544829
output nodes number: 335896
edges number: 10866291
torch.Size([1544829, 256])
torch.Size([335896, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.457282066345215  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.4594340324401855  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.6022005081176758  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 14 input nodes size: 2126339
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7979550361633301  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7979550361633301  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.590078353881836  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.590169906616211  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7974419593811035  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1294732093811035  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1294732093811035  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2126339
first layer output nodes number: 1542033
edges number: 32996281
torch.Size([2126339, 100])
torch.Size([1542033, 256])
input nodes number: 1542033
output nodes number: 335135
edges number: 10840300
torch.Size([1542033, 256])
torch.Size([335135, 256])
torch.Size([12286, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.446620941162109  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.4490790367126465  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.6011261940002441  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

pseudo mini batch 15 input nodes size: 2127562
----------------------------------------before load block subtensor 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7977299690246582  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7977299690246582  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.590308666229248  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.590400218963623  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 0.7981853485107422  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1302165985107422  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.1302165985107422  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

first layer input nodes number: 2127562
first layer output nodes number: 1543780
edges number: 33065540
torch.Size([2127562, 100])
torch.Size([1543780, 256])
input nodes number: 1543780
output nodes number: 336240
edges number: 10888740
torch.Size([1543780, 256])
torch.Size([336240, 256])
torch.Size([12281, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.455177307128906  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 6.457469463348389  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.601975440979004  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.601975440979004  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 16.3416748046875 GB
    Memory Allocated: 1.601975440979004  GigaBytes
Max Memory Allocated: 8.488070487976074  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.38640880584716797 |0.37789584696292877 |0.10174284875392914 |0.0006962120532989502 |0.0034184008836746216 |0.0012576580047607422 |
----------------------------------------------------------pseudo_mini_loss sum 2.2232484817504883
Total (block generation + training)time/epoch 850.8328394492468
Training time/epoch 14.139971733093262
Training time without block to device /epoch 8.093638181686401
Training time without total dataloading part /epoch 1.694977045059204
load block tensor time/epoch 6.1825408935546875
block to device time/epoch 6.04633355140686
input features size transfer per epoch 2.1457672119140625e-06
blocks size to device per epoch 1.430511474609375e-06
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  64138078
Number of first layer input nodes during this epoch:  34041368
Number of first layer output nodes during this epoch:  24718190
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  206336
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([47, 256])
layers.2.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
