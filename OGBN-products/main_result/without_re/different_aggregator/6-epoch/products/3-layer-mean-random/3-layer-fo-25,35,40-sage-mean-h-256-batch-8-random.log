main start at this time 1656624162.2267175
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3309662342071533
number of batches is  8
batch size is  24572
random selection method spend 0.015126466751098633
time for parepare:  0.279386043548584
local_output_nid generation:  0.011837482452392578
local_in_edges_tensor generation:  0.03920173645019531
mini_batch_src_global generation:  0.028325319290161133
r_  generation:  0.3847959041595459
local_output_nid generation:  0.013170957565307617
local_in_edges_tensor generation:  0.023382186889648438
mini_batch_src_global generation:  0.04084372520446777
r_  generation:  0.43348145484924316
local_output_nid generation:  0.013232946395874023
local_in_edges_tensor generation:  0.01238107681274414
mini_batch_src_global generation:  0.026637554168701172
r_  generation:  0.45308971405029297
local_output_nid generation:  0.013262033462524414
local_in_edges_tensor generation:  0.015138864517211914
mini_batch_src_global generation:  0.030527114868164062
r_  generation:  0.48355579376220703
local_output_nid generation:  0.01334834098815918
local_in_edges_tensor generation:  0.012629508972167969
mini_batch_src_global generation:  0.032279014587402344
r_  generation:  0.5131762027740479
local_output_nid generation:  0.013292551040649414
local_in_edges_tensor generation:  0.012632131576538086
mini_batch_src_global generation:  0.03747725486755371
r_  generation:  0.5311799049377441
local_output_nid generation:  0.013403177261352539
local_in_edges_tensor generation:  0.012400627136230469
mini_batch_src_global generation:  0.038301706314086914
r_  generation:  0.5447335243225098
local_output_nid generation:  0.013406753540039062
local_in_edges_tensor generation:  0.0125274658203125
mini_batch_src_global generation:  0.03982234001159668
r_  generation:  0.5420184135437012
----------------------check_connections_block total spend ----------------------------- 5.396310091018677
generate_one_block  1.621699333190918
generate_one_block  0.5482289791107178
generate_one_block  0.5595550537109375
generate_one_block  0.559511661529541
generate_one_block  0.5457172393798828
generate_one_block  0.5501878261566162
generate_one_block  0.5613024234771729
generate_one_block  0.5475819110870361
The real block id is  1
get_global_graph_edges_ids_block function  spend 1.9960663318634033
gen group dst list time:  0.12200641632080078
time for parepare:  0.44244980812072754
local_output_nid generation:  0.16305971145629883
local_in_edges_tensor generation:  0.5683860778808594
mini_batch_src_global generation:  0.5581388473510742
r_  generation:  6.7211713790893555
local_output_nid generation:  0.1705470085144043
local_in_edges_tensor generation:  0.474229097366333
mini_batch_src_global generation:  0.6934707164764404
r_  generation:  7.163830995559692
local_output_nid generation:  0.1713707447052002
local_in_edges_tensor generation:  0.4654970169067383
mini_batch_src_global generation:  0.6861863136291504
r_  generation:  7.128308296203613
local_output_nid generation:  0.17093610763549805
local_in_edges_tensor generation:  0.46660423278808594
mini_batch_src_global generation:  0.709073543548584
r_  generation:  7.233864784240723
local_output_nid generation:  0.1713869571685791
local_in_edges_tensor generation:  0.6299982070922852
mini_batch_src_global generation:  0.7284104824066162
r_  generation:  7.337588310241699
local_output_nid generation:  0.17051172256469727
local_in_edges_tensor generation:  0.6129412651062012
mini_batch_src_global generation:  0.7373659610748291
r_  generation:  7.3912835121154785
local_output_nid generation:  0.2056410312652588
local_in_edges_tensor generation:  0.4670896530151367
mini_batch_src_global generation:  0.7450103759765625
r_  generation:  7.311700820922852
local_output_nid generation:  0.1751866340637207
local_in_edges_tensor generation:  0.45982861518859863
mini_batch_src_global generation:  0.7525267601013184
r_  generation:  7.519442558288574
----------------------check_connections_block total spend ----------------------------- 78.90307426452637
generate_one_block  10.609779596328735
generate_one_block  9.48241400718689
generate_one_block  9.47417163848877
generate_one_block  9.52636432647705
generate_one_block  9.697954654693604
generate_one_block  9.454301834106445
generate_one_block  9.41849684715271
generate_one_block  9.844062805175781
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.405040979385376
gen group dst list time:  0.5533244609832764
time for parepare:  0.47417569160461426
local_output_nid generation:  0.5780868530273438
local_in_edges_tensor generation:  1.6139295101165771
mini_batch_src_global generation:  1.216820240020752
r_  generation:  16.028006315231323
local_output_nid generation:  0.6555511951446533
local_in_edges_tensor generation:  1.3279640674591064
mini_batch_src_global generation:  1.6943409442901611
r_  generation:  15.18424677848816
local_output_nid generation:  0.6260204315185547
local_in_edges_tensor generation:  2.1773910522460938
mini_batch_src_global generation:  1.5506789684295654
r_  generation:  15.569793462753296
local_output_nid generation:  0.6329362392425537
local_in_edges_tensor generation:  1.319573163986206
mini_batch_src_global generation:  1.4895992279052734
r_  generation:  15.365583896636963
local_output_nid generation:  0.5896625518798828
local_in_edges_tensor generation:  1.1881351470947266
mini_batch_src_global generation:  1.587449312210083
r_  generation:  15.762820720672607
local_output_nid generation:  0.5887401103973389
local_in_edges_tensor generation:  1.3120055198669434
mini_batch_src_global generation:  1.520524263381958
r_  generation:  15.344669580459595
local_output_nid generation:  0.6455948352813721
local_in_edges_tensor generation:  1.206542730331421
mini_batch_src_global generation:  1.5862233638763428
r_  generation:  15.56591510772705
local_output_nid generation:  0.5919418334960938
local_in_edges_tensor generation:  1.184112787246704
mini_batch_src_global generation:  1.614931344985962
r_  generation:  15.400484561920166
----------------------check_connections_block total spend ----------------------------- 175.4956305027008
generate_one_block  20.58150339126587
generate_one_block  19.923015117645264
generate_one_block  20.27957582473755
generate_one_block  19.875354766845703
generate_one_block  20.031044006347656
generate_one_block  20.401599884033203
generate_one_block  20.155237674713135
generate_one_block  20.892606735229492
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

connection checking time:  254.39870476722717
block generation total time  239.64748311042786
average batch blocks generation time:  29.955935388803482
block dataloader generation time/epoch 520.578773021698
pseudo mini batch 0 input nodes size: 2182929
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8319091796875 GB
    Memory Allocated: 0.8139734268188477  GigaBytes
Max Memory Allocated: 0.8139734268188477  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8319091796875 GB
    Memory Allocated: 0.8141565322875977  GigaBytes
Max Memory Allocated: 0.8141565322875977  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8319091796875 GB
    Memory Allocated: 0.8141565322875977  GigaBytes
Max Memory Allocated: 0.8141565322875977  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 1.2210750579833984  GigaBytes
Max Memory Allocated: 1.2210750579833984  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.3221435546875 GB
    Memory Allocated: 1.2210750579833984  GigaBytes
Max Memory Allocated: 1.2210750579833984  GigaBytes

first layer input nodes number: 2182929
first layer output nodes number: 1759826
edges number: 36364818
torch.Size([2182929, 100])
torch.Size([1759826, 256])
input nodes number: 1759826
output nodes number: 543640
edges number: 17323336
torch.Size([1759826, 256])
torch.Size([543640, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 11.4022216796875 GB
    Memory Allocated: 7.835925579071045  GigaBytes
Max Memory Allocated: 8.314653396606445  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 11.4022216796875 GB
    Memory Allocated: 7.840229034423828  GigaBytes
Max Memory Allocated: 8.314653396606445  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.8006591796875 GB
    Memory Allocated: 1.8339948654174805  GigaBytes
Max Memory Allocated: 9.622832775115967  GigaBytes

pseudo mini batch 1 input nodes size: 2185686
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.8006591796875 GB
    Memory Allocated: 0.8192286491394043  GigaBytes
Max Memory Allocated: 9.622832775115967  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.8006591796875 GB
    Memory Allocated: 0.8192286491394043  GigaBytes
Max Memory Allocated: 9.622832775115967  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.8006591796875 GB
    Memory Allocated: 1.633460521697998  GigaBytes
Max Memory Allocated: 9.622832775115967  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.8026123046875 GB
    Memory Allocated: 1.633643627166748  GigaBytes
Max Memory Allocated: 9.622832775115967  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.8026123046875 GB
    Memory Allocated: 0.8202557563781738  GigaBytes
Max Memory Allocated: 9.622832775115967  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.8026123046875 GB
    Memory Allocated: 1.2276244163513184  GigaBytes
Max Memory Allocated: 9.622832775115967  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8026123046875 GB
    Memory Allocated: 1.2276244163513184  GigaBytes
Max Memory Allocated: 9.622832775115967  GigaBytes

first layer input nodes number: 2185686
first layer output nodes number: 1761990
edges number: 36409838
torch.Size([2185686, 100])
torch.Size([1761990, 256])
input nodes number: 1761990
output nodes number: 544498
edges number: 17338263
torch.Size([1761990, 256])
torch.Size([544498, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.8494873046875 GB
    Memory Allocated: 7.847073554992676  GigaBytes
Max Memory Allocated: 9.622832775115967  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.8494873046875 GB
    Memory Allocated: 7.851376533508301  GigaBytes
Max Memory Allocated: 9.622832775115967  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.8369884490966797  GigaBytes
Max Memory Allocated: 9.634931087493896  GigaBytes

pseudo mini batch 2 input nodes size: 2186475
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8202557563781738  GigaBytes
Max Memory Allocated: 9.634931087493896  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8202557563781738  GigaBytes
Max Memory Allocated: 9.634931087493896  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.6347813606262207  GigaBytes
Max Memory Allocated: 9.634931087493896  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.6349644660949707  GigaBytes
Max Memory Allocated: 9.634931087493896  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.820549488067627  GigaBytes
Max Memory Allocated: 9.634931087493896  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.2284693717956543  GigaBytes
Max Memory Allocated: 9.634931087493896  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.2284693717956543  GigaBytes
Max Memory Allocated: 9.634931087493896  GigaBytes

first layer input nodes number: 2186475
first layer output nodes number: 1762736
edges number: 36408260
torch.Size([2186475, 100])
torch.Size([1762736, 256])
input nodes number: 1762736
output nodes number: 546182
edges number: 17411983
torch.Size([1762736, 256])
torch.Size([546182, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.85573148727417  GigaBytes
Max Memory Allocated: 9.634931087493896  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.86088228225708  GigaBytes
Max Memory Allocated: 9.634931087493896  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.8387603759765625  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

pseudo mini batch 3 input nodes size: 2184264
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.820549488067627  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.820549488067627  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.6347813606262207  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.6349644660949707  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8202557563781738  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.2269015312194824  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.2269015312194824  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

first layer input nodes number: 2184264
first layer output nodes number: 1756207
edges number: 36311139
torch.Size([2184264, 100])
torch.Size([1756207, 256])
input nodes number: 1756207
output nodes number: 543272
edges number: 17338314
torch.Size([1756207, 256])
torch.Size([543272, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.82582950592041  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.830132484436035  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.8359603881835938  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

pseudo mini batch 4 input nodes size: 2184945
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8202557563781738  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8202557563781738  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.6347088813781738  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.6348919868469238  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8204770088195801  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.2277350425720215  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.2277350425720215  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

first layer input nodes number: 2184945
first layer output nodes number: 1759648
edges number: 36366791
torch.Size([2184945, 100])
torch.Size([1759648, 256])
input nodes number: 1759648
output nodes number: 544815
edges number: 17366369
torch.Size([1759648, 256])
torch.Size([544815, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.841891288757324  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.846194267272949  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.8369841575622559  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

pseudo mini batch 5 input nodes size: 2183502
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8204770088195801  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8204770088195801  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.633894920349121  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.634078025817871  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8194417953491211  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.2267637252807617  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.2267637252807617  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

first layer input nodes number: 2183502
first layer output nodes number: 1758881
edges number: 36357068
torch.Size([2183502, 100])
torch.Size([1758881, 256])
input nodes number: 1758881
output nodes number: 544838
edges number: 17383346
torch.Size([1758881, 256])
torch.Size([544838, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.838403701782227  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.842706680297852  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.8371729850769043  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

pseudo mini batch 6 input nodes size: 2186166
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8194417953491211  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8194417953491211  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.633894920349121  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.634078025817871  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8204770088195801  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.2288103103637695  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.2288103103637695  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

first layer input nodes number: 2186166
first layer output nodes number: 1763129
edges number: 36437864
torch.Size([2186166, 100])
torch.Size([1763129, 256])
input nodes number: 1763129
output nodes number: 544479
edges number: 17360432
torch.Size([1763129, 256])
torch.Size([544479, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.850313186645508  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.854616165161133  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.8378372192382812  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

pseudo mini batch 7 input nodes size: 2184374
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8204770088195801  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8204770088195801  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.6342201232910156  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.6344032287597656  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 0.8197669982910156  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.2270946502685547  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.2270946502685547  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

first layer input nodes number: 2184374
first layer output nodes number: 1760552
edges number: 36364413
torch.Size([2184374, 100])
torch.Size([1760552, 256])
input nodes number: 1760552
output nodes number: 545572
edges number: 17377389
torch.Size([1760552, 256])
torch.Size([545572, 256])
torch.Size([24567, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.847578048706055  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 7.851880073547363  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5330810546875 GB
    Memory Allocated: 1.837531566619873  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.83906888961792  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.83906888961792  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.39214855432510376 |0.6322196424007416 |0.20649364590644836 |0.0001513659954071045 |0.07585087418556213 |0.0019550323486328125 |
----------------------------------------------------------pseudo_mini_loss sum 7.1722025871276855
Total (block generation + training)time/epoch 531.2744860649109
Training time/epoch 10.695404767990112
Training time without block to device /epoch 5.63764762878418
Training time without total dataloading part /epoch 2.2619221210479736
load block tensor time/epoch 3.13718843460083
block to device time/epoch 5.057757139205933
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  35918606
Number of first layer input nodes during this epoch:  17478341
Number of first layer output nodes during this epoch:  14082969
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8390684127807617  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.4353678226470947
number of batches is  8
batch size is  24572
random selection method spend 0.014276742935180664
time for parepare:  0.2897834777832031
local_output_nid generation:  0.012080907821655273
local_in_edges_tensor generation:  0.04544234275817871
mini_batch_src_global generation:  0.030751466751098633
r_  generation:  0.3920891284942627
local_output_nid generation:  0.01473855972290039
local_in_edges_tensor generation:  0.014529228210449219
mini_batch_src_global generation:  0.040509700775146484
r_  generation:  0.44296932220458984
local_output_nid generation:  0.01331019401550293
local_in_edges_tensor generation:  0.012755393981933594
mini_batch_src_global generation:  0.02738475799560547
r_  generation:  0.4616355895996094
local_output_nid generation:  0.013483762741088867
local_in_edges_tensor generation:  0.01254725456237793
mini_batch_src_global generation:  0.031418800354003906
r_  generation:  0.5053091049194336
local_output_nid generation:  0.013467788696289062
local_in_edges_tensor generation:  0.012783050537109375
mini_batch_src_global generation:  0.033998966217041016
r_  generation:  0.516395092010498
local_output_nid generation:  0.013328075408935547
local_in_edges_tensor generation:  0.012610435485839844
mini_batch_src_global generation:  0.03856778144836426
r_  generation:  0.5422706604003906
local_output_nid generation:  0.013424396514892578
local_in_edges_tensor generation:  0.012501239776611328
mini_batch_src_global generation:  0.039145708084106445
r_  generation:  0.5626089572906494
local_output_nid generation:  0.013373851776123047
local_in_edges_tensor generation:  0.012441396713256836
mini_batch_src_global generation:  0.04038643836975098
r_  generation:  0.5629019737243652
----------------------check_connections_block total spend ----------------------------- 5.537403106689453
generate_one_block  1.02103853225708
generate_one_block  0.6596190929412842
generate_one_block  0.6315572261810303
generate_one_block  0.6466338634490967
generate_one_block  0.578493595123291
generate_one_block  0.570303201675415
generate_one_block  0.5677330493927002
generate_one_block  0.5728566646575928
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.2209908962249756
gen group dst list time:  0.13439249992370605
time for parepare:  0.4697277545928955
local_output_nid generation:  0.18671631813049316
local_in_edges_tensor generation:  0.5608363151550293
mini_batch_src_global generation:  0.5721993446350098
r_  generation:  6.797557353973389
local_output_nid generation:  0.18731379508972168
local_in_edges_tensor generation:  0.46465396881103516
mini_batch_src_global generation:  0.7110166549682617
r_  generation:  7.289571523666382
local_output_nid generation:  0.21014046669006348
local_in_edges_tensor generation:  0.5995340347290039
mini_batch_src_global generation:  0.6911137104034424
r_  generation:  7.328951120376587
local_output_nid generation:  0.1777024269104004
local_in_edges_tensor generation:  0.47465991973876953
mini_batch_src_global generation:  0.8080654144287109
r_  generation:  7.322365760803223
local_output_nid generation:  0.21062493324279785
local_in_edges_tensor generation:  0.5986630916595459
mini_batch_src_global generation:  0.7256548404693604
r_  generation:  7.311670303344727
local_output_nid generation:  0.1773824691772461
local_in_edges_tensor generation:  0.48476433753967285
mini_batch_src_global generation:  0.7704212665557861
r_  generation:  7.5401222705841064
local_output_nid generation:  0.17684125900268555
local_in_edges_tensor generation:  0.4653804302215576
mini_batch_src_global generation:  0.7503340244293213
r_  generation:  7.384599447250366
local_output_nid generation:  0.2108614444732666
local_in_edges_tensor generation:  0.6024079322814941
mini_batch_src_global generation:  0.7479956150054932
r_  generation:  7.334780693054199
----------------------check_connections_block total spend ----------------------------- 79.87778735160828
generate_one_block  9.874550819396973
generate_one_block  9.382254123687744
generate_one_block  9.719284296035767
generate_one_block  9.467991352081299
generate_one_block  9.700899124145508
generate_one_block  9.434298276901245
generate_one_block  9.308841228485107
generate_one_block  9.356642246246338
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.077127695083618
gen group dst list time:  0.5278775691986084
time for parepare:  0.4786972999572754
local_output_nid generation:  0.5783510208129883
local_in_edges_tensor generation:  1.344376802444458
mini_batch_src_global generation:  1.2471058368682861
r_  generation:  15.190271854400635
local_output_nid generation:  0.6589772701263428
local_in_edges_tensor generation:  1.3938579559326172
mini_batch_src_global generation:  1.5419306755065918
r_  generation:  15.303422927856445
local_output_nid generation:  0.6432397365570068
local_in_edges_tensor generation:  1.2563436031341553
mini_batch_src_global generation:  1.4896233081817627
r_  generation:  15.423524141311646
local_output_nid generation:  0.5910985469818115
local_in_edges_tensor generation:  1.2684392929077148
mini_batch_src_global generation:  1.632995367050171
r_  generation:  15.232075452804565
local_output_nid generation:  0.6406478881835938
local_in_edges_tensor generation:  1.2465085983276367
mini_batch_src_global generation:  1.505934476852417
r_  generation:  15.413387298583984
local_output_nid generation:  0.5885276794433594
local_in_edges_tensor generation:  1.2475085258483887
mini_batch_src_global generation:  1.5332286357879639
r_  generation:  15.599781513214111
local_output_nid generation:  0.5870881080627441
local_in_edges_tensor generation:  1.2070393562316895
mini_batch_src_global generation:  1.5601420402526855
r_  generation:  15.57267165184021
local_output_nid generation:  0.6379389762878418
local_in_edges_tensor generation:  1.2513296604156494
mini_batch_src_global generation:  1.5132949352264404
r_  generation:  15.3297119140625
----------------------check_connections_block total spend ----------------------------- 172.83919858932495
generate_one_block  20.336695432662964
generate_one_block  19.94530415534973
generate_one_block  20.17151165008545
generate_one_block  19.944316625595093
generate_one_block  19.75787115097046
generate_one_block  20.53081440925598
generate_one_block  20.97130823135376
generate_one_block  20.414398908615112
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8390684127807617  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

connection checking time:  252.71698594093323
block generation total time  238.31698203086853
average batch blocks generation time:  29.789622753858566
block dataloader generation time/epoch 519.3007742166519
pseudo mini batch 0 input nodes size: 2186058
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8213024139404297  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8213024139404297  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6357555389404297  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6359386444091797  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8220124244689941  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.228818416595459  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.228818416595459  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

first layer input nodes number: 2186058
first layer output nodes number: 1759133
edges number: 36359061
torch.Size([2186058, 100])
torch.Size([1759133, 256])
input nodes number: 1759133
output nodes number: 543339
edges number: 17314132
torch.Size([1759133, 256])
torch.Size([543339, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.836915969848633  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.841219425201416  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8365211486816406  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

pseudo mini batch 1 input nodes size: 2183596
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.635467529296875  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.635650634765625  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.821014404296875  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2277212142944336  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2277212142944336  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

first layer input nodes number: 2183596
first layer output nodes number: 1758069
edges number: 36356652
torch.Size([2183596, 100])
torch.Size([1758069, 256])
input nodes number: 1758069
output nodes number: 542568
edges number: 17303721
torch.Size([1758069, 256])
torch.Size([542568, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.829095363616943  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.834251880645752  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8355817794799805  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

pseudo mini batch 2 input nodes size: 2184421
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.821014404296875  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.821014404296875  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.635467529296875  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.635650634765625  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2298741340637207  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2298741340637207  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

first layer input nodes number: 2184421
first layer output nodes number: 1761767
edges number: 36385930
torch.Size([2184421, 100])
torch.Size([1761767, 256])
input nodes number: 1761767
output nodes number: 547039
edges number: 17425241
torch.Size([1761767, 256])
torch.Size([547039, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.8561906814575195  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.8604936599731445  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8406658172607422  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

pseudo mini batch 3 input nodes size: 2186627
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6365966796875  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.63677978515625  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8221435546875  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.229456901550293  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.229456901550293  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

first layer input nodes number: 2186627
first layer output nodes number: 1760519
edges number: 36375776
torch.Size([2186627, 100])
torch.Size([1760519, 256])
input nodes number: 1760519
output nodes number: 544755
edges number: 17363349
torch.Size([1760519, 256])
torch.Size([544755, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.848065376281738  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.852368354797363  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8400788307189941  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

pseudo mini batch 4 input nodes size: 2186213
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8221435546875  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8221435546875  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6365966796875  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.63677978515625  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.23148775100708  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.23148775100708  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

first layer input nodes number: 2186213
first layer output nodes number: 1762937
edges number: 36439710
torch.Size([2186213, 100])
torch.Size([1762937, 256])
input nodes number: 1762937
output nodes number: 543800
edges number: 17327777
torch.Size([1762937, 256])
torch.Size([543800, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.853962421417236  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.858486175537109  GigaBytes
Max Memory Allocated: 9.642262935638428  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8423566818237305  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

pseudo mini batch 5 input nodes size: 2185364
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6361260414123535  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6363091468811035  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8216729164123535  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.22938871383667  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.22938871383667  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

first layer input nodes number: 2185364
first layer output nodes number: 1760468
edges number: 36391839
torch.Size([2185364, 100])
torch.Size([1760468, 256])
input nodes number: 1760468
output nodes number: 545885
edges number: 17401557
torch.Size([1760468, 256])
torch.Size([545885, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.850029468536377  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.854332447052002  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8380427360534668  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

pseudo mini batch 6 input nodes size: 2185167
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8216729164123535  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8216729164123535  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6361260414123535  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6363091468811035  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2291083335876465  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2291083335876465  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

first layer input nodes number: 2185167
first layer output nodes number: 1760938
edges number: 36361379
torch.Size([2185167, 100])
torch.Size([1760938, 256])
input nodes number: 1760938
output nodes number: 544506
edges number: 17348997
torch.Size([1760938, 256])
torch.Size([544506, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.845313549041748  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.849616527557373  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8382964134216309  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

pseudo mini batch 7 input nodes size: 2185021
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.635998249053955  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.636181354522705  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8215451240539551  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2294459342956543  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2294459342956543  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

first layer input nodes number: 2185021
first layer output nodes number: 1761735
edges number: 36388422
torch.Size([2185021, 100])
torch.Size([1761735, 256])
input nodes number: 1761735
output nodes number: 546394
edges number: 17430285
torch.Size([1761735, 256])
torch.Size([546394, 256])
torch.Size([24567, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.853072643280029  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.858282089233398  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8395004272460938  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8395004272460938  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8395004272460938  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4373781085014343 |0.5299676060676575 |0.11550518870353699 |0.00016942620277404785 |0.0031338632106781006 |0.0012331008911132812 |
----------------------------------------------------------pseudo_mini_loss sum 12.40730094909668
Total (block generation + training)time/epoch 529.1292700767517
Training time/epoch 8.961067914962769
Training time without block to device /epoch 4.721327066421509
Training time without total dataloading part /epoch 0.9517009258270264
load block tensor time/epoch 3.4990248680114746
block to device time/epoch 4.23974084854126
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  35926319
Number of first layer input nodes during this epoch:  17482467
Number of first layer output nodes during this epoch:  14085566
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8394999504089355  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.334766149520874
number of batches is  8
batch size is  24572
random selection method spend 0.015840530395507812
time for parepare:  0.3115215301513672
local_output_nid generation:  0.01240396499633789
local_in_edges_tensor generation:  0.04146385192871094
mini_batch_src_global generation:  0.032354116439819336
r_  generation:  0.3899683952331543
local_output_nid generation:  0.013661384582519531
local_in_edges_tensor generation:  0.014402389526367188
mini_batch_src_global generation:  0.04123377799987793
r_  generation:  0.4388899803161621
local_output_nid generation:  0.013475418090820312
local_in_edges_tensor generation:  0.013448715209960938
mini_batch_src_global generation:  0.029284954071044922
r_  generation:  0.4539618492126465
local_output_nid generation:  0.013694286346435547
local_in_edges_tensor generation:  0.013453006744384766
mini_batch_src_global generation:  0.03053736686706543
r_  generation:  0.49272704124450684
local_output_nid generation:  0.013415813446044922
local_in_edges_tensor generation:  0.013936758041381836
mini_batch_src_global generation:  0.033036231994628906
r_  generation:  0.515941858291626
local_output_nid generation:  0.013491392135620117
local_in_edges_tensor generation:  0.012237548828125
mini_batch_src_global generation:  0.04088997840881348
r_  generation:  0.5442442893981934
local_output_nid generation:  0.013461828231811523
local_in_edges_tensor generation:  0.013580083847045898
mini_batch_src_global generation:  0.03884434700012207
r_  generation:  0.5490295886993408
local_output_nid generation:  0.013457536697387695
local_in_edges_tensor generation:  0.011856794357299805
mini_batch_src_global generation:  0.04195666313171387
r_  generation:  0.563718318939209
----------------------check_connections_block total spend ----------------------------- 5.534764528274536
generate_one_block  1.007274866104126
generate_one_block  0.5774519443511963
generate_one_block  0.5640676021575928
generate_one_block  0.5668089389801025
generate_one_block  0.5608916282653809
generate_one_block  0.5644478797912598
generate_one_block  0.5795044898986816
generate_one_block  0.5595479011535645
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.136089324951172
gen group dst list time:  0.13792753219604492
time for parepare:  0.4273526668548584
local_output_nid generation:  0.17889761924743652
local_in_edges_tensor generation:  0.6050224304199219
mini_batch_src_global generation:  0.5819430351257324
r_  generation:  7.044202089309692
local_output_nid generation:  0.2032020092010498
local_in_edges_tensor generation:  0.7206268310546875
mini_batch_src_global generation:  0.7209949493408203
r_  generation:  6.997763395309448
local_output_nid generation:  0.18213319778442383
local_in_edges_tensor generation:  0.4677879810333252
mini_batch_src_global generation:  0.7138054370880127
r_  generation:  7.182209730148315
local_output_nid generation:  0.19158220291137695
local_in_edges_tensor generation:  0.4616079330444336
mini_batch_src_global generation:  0.7289059162139893
r_  generation:  7.311932563781738
local_output_nid generation:  0.18511295318603516
local_in_edges_tensor generation:  0.4638535976409912
mini_batch_src_global generation:  0.8080391883850098
r_  generation:  7.554844379425049
local_output_nid generation:  0.18129301071166992
local_in_edges_tensor generation:  0.536341667175293
mini_batch_src_global generation:  0.7664861679077148
r_  generation:  7.344574928283691
local_output_nid generation:  0.19304919242858887
local_in_edges_tensor generation:  0.5329997539520264
mini_batch_src_global generation:  0.7514448165893555
r_  generation:  7.4270100593566895
local_output_nid generation:  0.19108271598815918
local_in_edges_tensor generation:  0.4626948833465576
mini_batch_src_global generation:  0.7537791728973389
r_  generation:  7.429259777069092
----------------------check_connections_block total spend ----------------------------- 79.99200105667114
generate_one_block  9.968282461166382
generate_one_block  9.763581275939941
generate_one_block  9.741401672363281
generate_one_block  9.698088645935059
generate_one_block  9.439054727554321
generate_one_block  9.4575035572052
generate_one_block  9.448456287384033
generate_one_block  9.401440143585205
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.312072992324829
gen group dst list time:  0.5620405673980713
time for parepare:  0.45897436141967773
local_output_nid generation:  0.5973920822143555
local_in_edges_tensor generation:  1.3686556816101074
mini_batch_src_global generation:  1.189436674118042
r_  generation:  15.168699026107788
local_output_nid generation:  0.6271820068359375
local_in_edges_tensor generation:  1.4698867797851562
mini_batch_src_global generation:  1.5166451930999756
r_  generation:  15.018770217895508
local_output_nid generation:  0.6130406856536865
local_in_edges_tensor generation:  1.1862025260925293
mini_batch_src_global generation:  1.5591509342193604
r_  generation:  15.518030881881714
local_output_nid generation:  0.6361041069030762
local_in_edges_tensor generation:  1.3071317672729492
mini_batch_src_global generation:  1.5156073570251465
r_  generation:  15.097845554351807
local_output_nid generation:  0.6134200096130371
local_in_edges_tensor generation:  1.173537254333496
mini_batch_src_global generation:  1.4851160049438477
r_  generation:  15.166805982589722
local_output_nid generation:  0.6061596870422363
local_in_edges_tensor generation:  1.1683039665222168
mini_batch_src_global generation:  1.5584218502044678
r_  generation:  15.518604755401611
local_output_nid generation:  0.594451904296875
local_in_edges_tensor generation:  1.2489421367645264
mini_batch_src_global generation:  1.5339417457580566
r_  generation:  15.240864515304565
local_output_nid generation:  0.6343388557434082
local_in_edges_tensor generation:  1.2460145950317383
mini_batch_src_global generation:  1.5057263374328613
r_  generation:  15.168617248535156
----------------------check_connections_block total spend ----------------------------- 170.6613268852234
generate_one_block  20.143485069274902
generate_one_block  19.392431259155273
generate_one_block  19.55929160118103
generate_one_block  20.046317100524902
generate_one_block  19.535247325897217
generate_one_block  19.556617498397827
generate_one_block  20.705582857131958
generate_one_block  19.8563973903656
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8394999504089355  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

connection checking time:  250.65332794189453
block generation total time  235.71317887306213
average batch blocks generation time:  29.464147359132767
block dataloader generation time/epoch 517.2194921970367
pseudo mini batch 0 input nodes size: 2185731
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8215432167053223  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8215432167053223  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6359963417053223  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6361794471740723  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8220124244689941  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2297511100769043  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2297511100769043  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

first layer input nodes number: 2185731
first layer output nodes number: 1761353
edges number: 36399441
torch.Size([2185731, 100])
torch.Size([1761353, 256])
input nodes number: 1761353
output nodes number: 545516
edges number: 17396424
torch.Size([1761353, 256])
torch.Size([545516, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.849625587463379  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.853929042816162  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8384032249450684  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

pseudo mini batch 1 input nodes size: 2183512
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6354360580444336  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6356191635131836  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8209829330444336  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2276430130004883  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2276430130004883  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

first layer input nodes number: 2183512
first layer output nodes number: 1757612
edges number: 36347344
torch.Size([2183512, 100])
torch.Size([1757612, 256])
input nodes number: 1757612
output nodes number: 542800
edges number: 17305387
torch.Size([1757612, 256])
torch.Size([542800, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.828542709350586  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.833422660827637  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8345489501953125  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

pseudo mini batch 2 input nodes size: 2185448
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8209829330444336  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8209829330444336  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6354360580444336  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6356191635131836  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2294793128967285  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2294793128967285  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

first layer input nodes number: 2185448
first layer output nodes number: 1762361
edges number: 36395998
torch.Size([2185448, 100])
torch.Size([1762361, 256])
input nodes number: 1762361
output nodes number: 544714
edges number: 17363470
torch.Size([1762361, 256])
torch.Size([544714, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.85115385055542  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.855456829071045  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8386683464050293  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

pseudo mini batch 3 input nodes size: 2185609
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8222818374633789  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8222818374633789  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6364850997924805  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6366682052612305  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8220319747924805  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.229421615600586  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.229421615600586  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

first layer input nodes number: 2185609
first layer output nodes number: 1761289
edges number: 36382893
torch.Size([2185609, 100])
torch.Size([1761289, 256])
input nodes number: 1761289
output nodes number: 544435
edges number: 17366168
torch.Size([1761289, 256])
torch.Size([544435, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.845780372619629  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.850083351135254  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.838892936706543  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

pseudo mini batch 4 input nodes size: 2184521
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8217644691467285  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8217644691467285  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6362175941467285  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6364006996154785  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2289910316467285  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2289910316467285  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

first layer input nodes number: 2184521
first layer output nodes number: 1757742
edges number: 36311956
torch.Size([2184521, 100])
torch.Size([1757742, 256])
input nodes number: 1757742
output nodes number: 545747
edges number: 17383541
torch.Size([1757742, 256])
torch.Size([545747, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.840061187744141  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.845285415649414  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.837186336517334  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

pseudo mini batch 5 input nodes size: 2183446
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6354117393493652  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6355948448181152  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8209586143493652  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.227963924407959  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.227963924407959  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

first layer input nodes number: 2183446
first layer output nodes number: 1758636
edges number: 36335920
torch.Size([2183446, 100])
torch.Size([1758636, 256])
input nodes number: 1758636
output nodes number: 544330
edges number: 17362722
torch.Size([1758636, 256])
torch.Size([544330, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.837383270263672  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 7.841686248779297  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.8386435508728027  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

pseudo mini batch 6 input nodes size: 2186463
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8209586143493652  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.8209586143493652  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6354799270629883  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.6356630325317383  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 0.82208251953125  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2320241928100586  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.5350341796875 GB
    Memory Allocated: 1.2320241928100586  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

first layer input nodes number: 2186463
first layer output nodes number: 1766416
edges number: 36474204
torch.Size([2186463, 100])
torch.Size([1766416, 256])
input nodes number: 1766416
output nodes number: 546248
edges number: 17391667
torch.Size([1766416, 256])
torch.Size([546248, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.3123779296875 GB
    Memory Allocated: 7.870995044708252  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.3123779296875 GB
    Memory Allocated: 7.875298023223877  GigaBytes
Max Memory Allocated: 9.645982265472412  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.5233154296875 GB
    Memory Allocated: 1.8429069519042969  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

pseudo mini batch 7 input nodes size: 2185547
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.5233154296875 GB
    Memory Allocated: 0.82208251953125  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.5233154296875 GB
    Memory Allocated: 0.82208251953125  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.5233154296875 GB
    Memory Allocated: 1.63653564453125  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.5233154296875 GB
    Memory Allocated: 1.63671875  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.5233154296875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.5233154296875 GB
    Memory Allocated: 1.229057788848877  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5233154296875 GB
    Memory Allocated: 1.229057788848877  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

first layer input nodes number: 2185547
first layer output nodes number: 1758859
edges number: 36357672
torch.Size([2185547, 100])
torch.Size([1758859, 256])
input nodes number: 1758859
output nodes number: 544088
edges number: 17346526
torch.Size([1758859, 256])
torch.Size([544088, 256])
torch.Size([24567, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5233154296875 GB
    Memory Allocated: 7.83782434463501  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.5233154296875 GB
    Memory Allocated: 7.842126369476318  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.5233154296875 GB
    Memory Allocated: 1.8373770713806152  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 1.8373770713806152  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 1.8373770713806152  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.41644975543022156 |0.3672710359096527 |0.1549815833568573 |0.0001468360424041748 |0.017513900995254517 |0.002367258071899414 |
----------------------------------------------------------pseudo_mini_loss sum 3.6218442916870117
Total (block generation + training)time/epoch 526.410208940506
Training time/epoch 7.914925575256348
Training time without block to device /epoch 4.976757287979126
Training time without total dataloading part /epoch 1.3835058212280273
load block tensor time/epoch 3.3315980434417725
block to device time/epoch 2.9381682872772217
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  35922423
Number of first layer input nodes during this epoch:  17480277
Number of first layer output nodes during this epoch:  14084268
----------------------------------------before generate dataloader block 
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 1.837376594543457  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3773069381713867
number of batches is  8
batch size is  24572
random selection method spend 0.013490915298461914
time for parepare:  0.28364086151123047
local_output_nid generation:  0.012161016464233398
local_in_edges_tensor generation:  0.03861689567565918
mini_batch_src_global generation:  0.03321242332458496
r_  generation:  0.38555049896240234
local_output_nid generation:  0.01331329345703125
local_in_edges_tensor generation:  0.013651609420776367
mini_batch_src_global generation:  0.0403897762298584
r_  generation:  0.4359152317047119
local_output_nid generation:  0.013301610946655273
local_in_edges_tensor generation:  0.012262105941772461
mini_batch_src_global generation:  0.029526948928833008
r_  generation:  0.4543883800506592
local_output_nid generation:  0.013402223587036133
local_in_edges_tensor generation:  0.011789560317993164
mini_batch_src_global generation:  0.0330049991607666
r_  generation:  0.4951643943786621
local_output_nid generation:  0.013342618942260742
local_in_edges_tensor generation:  0.012238025665283203
mini_batch_src_global generation:  0.036595821380615234
r_  generation:  0.5210351943969727
local_output_nid generation:  0.01340794563293457
local_in_edges_tensor generation:  0.012033462524414062
mini_batch_src_global generation:  0.04258322715759277
r_  generation:  0.5409440994262695
local_output_nid generation:  0.01333928108215332
local_in_edges_tensor generation:  0.015311479568481445
mini_batch_src_global generation:  0.038495540618896484
r_  generation:  0.5457594394683838
local_output_nid generation:  0.013314247131347656
local_in_edges_tensor generation:  0.014827966690063477
mini_batch_src_global generation:  0.04042649269104004
r_  generation:  0.5509946346282959
----------------------check_connections_block total spend ----------------------------- 5.48905348777771
generate_one_block  0.9200127124786377
generate_one_block  0.5823328495025635
generate_one_block  0.5644762516021729
generate_one_block  0.5691227912902832
generate_one_block  0.5563516616821289
generate_one_block  0.5666072368621826
generate_one_block  0.5586469173431396
generate_one_block  0.5567939281463623
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1039505004882812
gen group dst list time:  0.12738561630249023
time for parepare:  0.4404165744781494
local_output_nid generation:  0.18094491958618164
local_in_edges_tensor generation:  0.5986723899841309
mini_batch_src_global generation:  0.559166669845581
r_  generation:  6.857235431671143
local_output_nid generation:  0.17615079879760742
local_in_edges_tensor generation:  0.4966096878051758
mini_batch_src_global generation:  0.7191781997680664
r_  generation:  7.5201356410980225
local_output_nid generation:  0.18071269989013672
local_in_edges_tensor generation:  0.7945783138275146
mini_batch_src_global generation:  0.73758864402771
r_  generation:  7.19651198387146
local_output_nid generation:  0.1940779685974121
local_in_edges_tensor generation:  0.4819169044494629
mini_batch_src_global generation:  0.7316560745239258
r_  generation:  7.28874135017395
local_output_nid generation:  0.19142413139343262
local_in_edges_tensor generation:  0.43344616889953613
mini_batch_src_global generation:  0.7521257400512695
r_  generation:  7.52461576461792
local_output_nid generation:  0.18107986450195312
local_in_edges_tensor generation:  0.48201584815979004
mini_batch_src_global generation:  0.7872776985168457
r_  generation:  7.6024088859558105
local_output_nid generation:  0.18101882934570312
local_in_edges_tensor generation:  0.6119029521942139
mini_batch_src_global generation:  0.780935525894165
r_  generation:  7.3257622718811035
local_output_nid generation:  0.19268321990966797
local_in_edges_tensor generation:  0.48582959175109863
mini_batch_src_global generation:  0.7534165382385254
r_  generation:  7.330530405044556
----------------------check_connections_block total spend ----------------------------- 80.39583897590637
generate_one_block  9.949006795883179
generate_one_block  9.806418895721436
generate_one_block  9.643020629882812
generate_one_block  9.443612337112427
generate_one_block  9.686789274215698
generate_one_block  9.755340337753296
generate_one_block  9.360862493515015
generate_one_block  9.44642186164856
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3304522037506104
gen group dst list time:  0.5187640190124512
time for parepare:  0.4755563735961914
local_output_nid generation:  0.5987014770507812
local_in_edges_tensor generation:  1.3598275184631348
mini_batch_src_global generation:  1.1932611465454102
r_  generation:  15.267597198486328
local_output_nid generation:  0.6567761898040771
local_in_edges_tensor generation:  1.4680461883544922
mini_batch_src_global generation:  1.5199615955352783
r_  generation:  15.216978549957275
local_output_nid generation:  0.6322019100189209
local_in_edges_tensor generation:  1.3509800434112549
mini_batch_src_global generation:  1.7231509685516357
r_  generation:  15.570852756500244
local_output_nid generation:  0.6531317234039307
local_in_edges_tensor generation:  1.170633316040039
mini_batch_src_global generation:  1.501976490020752
r_  generation:  15.264553546905518
local_output_nid generation:  0.6311497688293457
local_in_edges_tensor generation:  1.314945936203003
mini_batch_src_global generation:  1.5680952072143555
r_  generation:  15.630918741226196
local_output_nid generation:  0.6178460121154785
local_in_edges_tensor generation:  1.2137579917907715
mini_batch_src_global generation:  1.6348652839660645
r_  generation:  15.37081241607666
local_output_nid generation:  0.6473438739776611
local_in_edges_tensor generation:  1.180145263671875
mini_batch_src_global generation:  1.5167655944824219
r_  generation:  15.49872350692749
local_output_nid generation:  0.6258907318115234
local_in_edges_tensor generation:  1.1819822788238525
mini_batch_src_global generation:  1.5203440189361572
r_  generation:  15.397321701049805
----------------------check_connections_block total spend ----------------------------- 172.79716634750366
generate_one_block  20.406781673431396
generate_one_block  20.0700421333313
generate_one_block  20.07485866546631
generate_one_block  19.542211771011353
generate_one_block  19.59273886680603
generate_one_block  19.836682319641113
generate_one_block  21.172164916992188
generate_one_block  20.16325092315674
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 1.837376594543457  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

connection checking time:  253.19300532341003
block generation total time  237.95020389556885
average batch blocks generation time:  29.743775486946106
block dataloader generation time/epoch 517.2313158512115
pseudo mini batch 0 input nodes size: 2186035
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 0.8224215507507324  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 0.8224215507507324  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 1.6367831230163574  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 1.6369662284851074  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 0.8223299980163574  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 1.2299046516418457  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 1.2299046516418457  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

first layer input nodes number: 2186035
first layer output nodes number: 1763246
edges number: 36400600
torch.Size([2186035, 100])
torch.Size([1763246, 256])
input nodes number: 1763246
output nodes number: 545462
edges number: 17373616
torch.Size([1763246, 256])
torch.Size([545462, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 7.855561256408691  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 7.859864711761475  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 1.839920997619629  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

pseudo mini batch 1 input nodes size: 2184361
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 0.821922779083252  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 0.821922779083252  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 1.636375904083252  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 1.636559009552002  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 1.2294917106628418  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 1.2294917106628418  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

first layer input nodes number: 2184361
first layer output nodes number: 1759695
edges number: 36376744
torch.Size([2184361, 100])
torch.Size([1759695, 256])
input nodes number: 1759695
output nodes number: 545510
edges number: 17385905
torch.Size([1759695, 256])
torch.Size([545510, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 7.845356464385986  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 7.849659442901611  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 1.8382549285888672  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

pseudo mini batch 2 input nodes size: 2186384
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 1.6365060806274414  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 1.6366891860961914  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 0.8220529556274414  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 1.2324867248535156  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5252685546875 GB
    Memory Allocated: 1.2324867248535156  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

first layer input nodes number: 2186384
first layer output nodes number: 1767118
edges number: 36469451
torch.Size([2186384, 100])
torch.Size([1767118, 256])
input nodes number: 1767118
output nodes number: 547516
edges number: 17458063
torch.Size([1767118, 256])
torch.Size([547516, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 7.877574443817139  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 7.881877422332764  GigaBytes
Max Memory Allocated: 9.66428279876709  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 1.8467059135437012  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

pseudo mini batch 3 input nodes size: 2183033
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 0.8220529556274414  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 0.8220529556274414  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 1.63529634475708  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 1.63547945022583  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 0.8208045959472656  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 1.227513313293457  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 1.227513313293457  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

first layer input nodes number: 2183033
first layer output nodes number: 1757149
edges number: 36285629
torch.Size([2183033, 100])
torch.Size([1757149, 256])
input nodes number: 1757149
output nodes number: 545092
edges number: 17370376
torch.Size([1757149, 256])
torch.Size([545092, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 7.83438777923584  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 7.838690757751465  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 1.8353304862976074  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

pseudo mini batch 4 input nodes size: 2186132
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 0.8208045959472656  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 0.8208045959472656  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 1.635202407836914  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 1.635385513305664  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 0.8219590187072754  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 1.228848934173584  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 1.228848934173584  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

first layer input nodes number: 2186132
first layer output nodes number: 1759950
edges number: 36358046
torch.Size([2186132, 100])
torch.Size([1759950, 256])
input nodes number: 1759950
output nodes number: 543899
edges number: 17325571
torch.Size([1759950, 256])
torch.Size([543899, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 7.8389201164245605  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 7.8432230949401855  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 1.83693265914917  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

pseudo mini batch 5 input nodes size: 2187958
----------------------------------------before load block subtensor 
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 0.8219590187072754  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 0.8219590187072754  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 1.6370372772216797  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 1.6372203826904297  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 0.8226394653320312  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 1.232710838317871  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.5272216796875 GB
    Memory Allocated: 1.232710838317871  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

first layer input nodes number: 2187958
first layer output nodes number: 1767934
edges number: 36506858
torch.Size([2187958, 100])
torch.Size([1767934, 256])
input nodes number: 1767934
output nodes number: 545738
edges number: 17409558
torch.Size([1767934, 256])
torch.Size([545738, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5897216796875 GB
    Memory Allocated: 7.873793125152588  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.5897216796875 GB
    Memory Allocated: 7.878096103668213  GigaBytes
Max Memory Allocated: 9.668510437011719  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8462986946105957  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

pseudo mini batch 6 input nodes size: 2184034
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8226394653320312  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8226394653320312  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6370372772216797  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6372203826904297  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8219590187072754  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2280850410461426  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2280850410461426  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

first layer input nodes number: 2184034
first layer output nodes number: 1756206
edges number: 36311643
torch.Size([2184034, 100])
torch.Size([1756206, 256])
input nodes number: 1756206
output nodes number: 541834
edges number: 17269095
torch.Size([1756206, 256])
torch.Size([541834, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.821486473083496  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.825789451599121  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8341307640075684  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

pseudo mini batch 7 input nodes size: 2185088
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8219590187072754  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8219590187072754  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6364121437072754  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6365952491760254  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.228909969329834  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.228909969329834  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

first layer input nodes number: 2185088
first layer output nodes number: 1758690
edges number: 36357108
torch.Size([2185088, 100])
torch.Size([1758690, 256])
input nodes number: 1758690
output nodes number: 543433
edges number: 17327586
torch.Size([1758690, 256])
torch.Size([543433, 256])
torch.Size([24567, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.834878444671631  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.8391804695129395  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8378663063049316  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8378663063049316  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8378663063049316  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.41957423090934753 |0.5180380642414093 |0.11629635095596313 |0.00014740228652954102 |0.03762209415435791 |0.0012347698211669922 |
----------------------------------------------------------pseudo_mini_loss sum 4.485847473144531
Total (block generation + training)time/epoch 526.3733969330788
Training time/epoch 8.99596118927002
Training time without block to device /epoch 4.851656675338745
Training time without total dataloading part /epoch 1.2337615489959717
load block tensor time/epoch 3.3565938472747803
block to device time/epoch 4.144304513931274
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  35931497
Number of first layer input nodes during this epoch:  17483025
Number of first layer output nodes during this epoch:  14089988
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8378658294677734  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.3504750728607178
number of batches is  8
batch size is  24572
random selection method spend 0.014023065567016602
time for parepare:  0.2955441474914551
local_output_nid generation:  0.012326478958129883
local_in_edges_tensor generation:  0.03776717185974121
mini_batch_src_global generation:  0.03155660629272461
r_  generation:  0.38540077209472656
local_output_nid generation:  0.015851974487304688
local_in_edges_tensor generation:  0.01755070686340332
mini_batch_src_global generation:  0.03988909721374512
r_  generation:  0.44623613357543945
local_output_nid generation:  0.013416051864624023
local_in_edges_tensor generation:  0.01551675796508789
mini_batch_src_global generation:  0.027828454971313477
r_  generation:  0.4546627998352051
local_output_nid generation:  0.013635635375976562
local_in_edges_tensor generation:  0.013560056686401367
mini_batch_src_global generation:  0.03084540367126465
r_  generation:  0.49576735496520996
local_output_nid generation:  0.014754056930541992
local_in_edges_tensor generation:  0.013424158096313477
mini_batch_src_global generation:  0.032773733139038086
r_  generation:  0.5168311595916748
local_output_nid generation:  0.01339578628540039
local_in_edges_tensor generation:  0.012256860733032227
mini_batch_src_global generation:  0.03740501403808594
r_  generation:  0.539884090423584
local_output_nid generation:  0.013556957244873047
local_in_edges_tensor generation:  0.014519691467285156
mini_batch_src_global generation:  0.04143524169921875
r_  generation:  0.5492548942565918
local_output_nid generation:  0.01346588134765625
local_in_edges_tensor generation:  0.01223897933959961
mini_batch_src_global generation:  0.04254913330078125
r_  generation:  0.5535829067230225
----------------------check_connections_block total spend ----------------------------- 5.52912712097168
generate_one_block  0.9995665550231934
generate_one_block  0.5782630443572998
generate_one_block  0.5589408874511719
generate_one_block  0.5664525032043457
generate_one_block  0.5630409717559814
generate_one_block  0.5565860271453857
generate_one_block  0.568464994430542
generate_one_block  0.5534944534301758
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0541160106658936
gen group dst list time:  0.12634730339050293
time for parepare:  0.4317338466644287
local_output_nid generation:  0.18593621253967285
local_in_edges_tensor generation:  0.5933799743652344
mini_batch_src_global generation:  0.5779561996459961
r_  generation:  6.828064203262329
local_output_nid generation:  0.17679381370544434
local_in_edges_tensor generation:  0.4788510799407959
mini_batch_src_global generation:  0.7025232315063477
r_  generation:  7.078165292739868
local_output_nid generation:  0.17737960815429688
local_in_edges_tensor generation:  0.6516249179840088
mini_batch_src_global generation:  0.7758619785308838
r_  generation:  7.500653505325317
local_output_nid generation:  0.18162894248962402
local_in_edges_tensor generation:  0.5077898502349854
mini_batch_src_global generation:  0.8048944473266602
r_  generation:  7.5623650550842285
local_output_nid generation:  0.2053837776184082
local_in_edges_tensor generation:  0.6444520950317383
mini_batch_src_global generation:  0.7511076927185059
r_  generation:  7.349925518035889
local_output_nid generation:  0.18234610557556152
local_in_edges_tensor generation:  0.4740307331085205
mini_batch_src_global generation:  0.7503476142883301
r_  generation:  7.364542484283447
local_output_nid generation:  0.18306636810302734
local_in_edges_tensor generation:  0.469463586807251
mini_batch_src_global generation:  0.7622861862182617
r_  generation:  7.414557933807373
local_output_nid generation:  0.18358135223388672
local_in_edges_tensor generation:  0.47135138511657715
mini_batch_src_global generation:  0.764702558517456
r_  generation:  7.37857460975647
----------------------check_connections_block total spend ----------------------------- 80.21576881408691
generate_one_block  10.038562536239624
generate_one_block  9.458406925201416
generate_one_block  10.349401712417603
generate_one_block  9.423484802246094
generate_one_block  9.503395080566406
generate_one_block  9.468981981277466
generate_one_block  9.444059371948242
generate_one_block  9.51381778717041
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.3526811599731445
gen group dst list time:  0.5185694694519043
time for parepare:  0.45205259323120117
local_output_nid generation:  0.5707521438598633
local_in_edges_tensor generation:  1.367265224456787
mini_batch_src_global generation:  1.1951849460601807
r_  generation:  14.928330183029175
local_output_nid generation:  0.6167535781860352
local_in_edges_tensor generation:  1.4988420009613037
mini_batch_src_global generation:  1.5098164081573486
r_  generation:  14.845031023025513
local_output_nid generation:  0.5978751182556152
local_in_edges_tensor generation:  1.2022066116333008
mini_batch_src_global generation:  1.5956904888153076
r_  generation:  15.418544292449951
local_output_nid generation:  0.6242780685424805
local_in_edges_tensor generation:  1.307539701461792
mini_batch_src_global generation:  1.5228185653686523
r_  generation:  15.155099630355835
local_output_nid generation:  0.5873355865478516
local_in_edges_tensor generation:  1.1772680282592773
mini_batch_src_global generation:  1.498100757598877
r_  generation:  14.970820426940918
local_output_nid generation:  0.6040489673614502
local_in_edges_tensor generation:  1.1661460399627686
mini_batch_src_global generation:  1.5364923477172852
r_  generation:  15.404854536056519
local_output_nid generation:  0.5915877819061279
local_in_edges_tensor generation:  1.2391152381896973
mini_batch_src_global generation:  1.5120258331298828
r_  generation:  14.907120943069458
local_output_nid generation:  0.6188509464263916
local_in_edges_tensor generation:  1.2356224060058594
mini_batch_src_global generation:  1.5071682929992676
r_  generation:  15.178146600723267
----------------------check_connections_block total spend ----------------------------- 169.6935794353485
generate_one_block  19.99123787879944
generate_one_block  19.544782400131226
generate_one_block  19.56862783432007
generate_one_block  19.646485090255737
generate_one_block  19.796551942825317
generate_one_block  19.498733282089233
generate_one_block  19.44310426712036
generate_one_block  20.32712697982788
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8378658294677734  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

connection checking time:  249.90934824943542
block generation total time  235.01675987243652
average batch blocks generation time:  29.377094984054565
block dataloader generation time/epoch 516.084555721283
pseudo mini batch 0 input nodes size: 2186708
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8220124244689941  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8220124244689941  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.636624813079834  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.636807918548584  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.822171688079834  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2299261093139648  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2299261093139648  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

first layer input nodes number: 2186708
first layer output nodes number: 1760326
edges number: 36378095
torch.Size([2186708, 100])
torch.Size([1760326, 256])
input nodes number: 1760326
output nodes number: 544324
edges number: 17344565
torch.Size([1760326, 256])
torch.Size([544324, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.842874526977539  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.847177982330322  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.838181495666504  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

pseudo mini batch 1 input nodes size: 2183433
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8221735954284668  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8221735954284668  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.635566234588623  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.635749340057373  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8209538459777832  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2272868156433105  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2272868156433105  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

first layer input nodes number: 2183433
first layer output nodes number: 1757074
edges number: 36294840
torch.Size([2183433, 100])
torch.Size([1757074, 256])
input nodes number: 1757074
output nodes number: 542970
edges number: 17313652
torch.Size([1757074, 256])
torch.Size([542970, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.828171730041504  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.832474708557129  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8365650177001953  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

pseudo mini batch 2 input nodes size: 2184106
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8209538459777832  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8209538459777832  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.634596824645996  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.634779930114746  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8212041854858398  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2281713485717773  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2281713485717773  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

first layer input nodes number: 2184106
first layer output nodes number: 1760420
edges number: 36355134
torch.Size([2184106, 100])
torch.Size([1760420, 256])
input nodes number: 1760420
output nodes number: 544094
edges number: 17339649
torch.Size([1760420, 256])
torch.Size([544094, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.840415954589844  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.844718933105469  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.836130142211914  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

pseudo mini batch 3 input nodes size: 2183444
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8212041854858398  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8212041854858398  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6346006393432617  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6347837448120117  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8209576606750488  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2280049324035645  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2280049324035645  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

first layer input nodes number: 2183444
first layer output nodes number: 1760129
edges number: 36356083
torch.Size([2183444, 100])
torch.Size([1760129, 256])
input nodes number: 1760129
output nodes number: 544592
edges number: 17346942
torch.Size([1760129, 256])
torch.Size([544592, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.841248989105225  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.84561824798584  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8356943130493164  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

pseudo mini batch 4 input nodes size: 2185956
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8209576606750488  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8209576606750488  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6352901458740234  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6354732513427734  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8218936920166016  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.231973648071289  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.231973648071289  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

first layer input nodes number: 2185956
first layer output nodes number: 1763306
edges number: 36451398
torch.Size([2185956, 100])
torch.Size([1763306, 256])
input nodes number: 1763306
output nodes number: 545741
edges number: 17410502
torch.Size([1763306, 256])
torch.Size([545741, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.860294342041016  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.865187644958496  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8453316688537598  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

pseudo mini batch 5 input nodes size: 2186988
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8218936920166016  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8218936920166016  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.636610507965088  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.636793613433838  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8222780227661133  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2322683334350586  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2322683334350586  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

first layer input nodes number: 2186988
first layer output nodes number: 1766423
edges number: 36459417
torch.Size([2186988, 100])
torch.Size([1766423, 256])
input nodes number: 1766423
output nodes number: 546510
edges number: 17399486
torch.Size([1766423, 256])
torch.Size([546510, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.8733415603637695  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.8776445388793945  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8446011543273926  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

pseudo mini batch 6 input nodes size: 2183213
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8222780227661133  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8222780227661133  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6355886459350586  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6357717514038086  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8208718299865723  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2282929420471191  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2282929420471191  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

first layer input nodes number: 2183213
first layer output nodes number: 1758495
edges number: 36359732
torch.Size([2183213, 100])
torch.Size([1758495, 256])
input nodes number: 1758495
output nodes number: 545083
edges number: 17392167
torch.Size([1758495, 256])
torch.Size([545083, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.839756965637207  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.844804286956787  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.837526798248291  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

pseudo mini batch 7 input nodes size: 2187653
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8208718299865723  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8208718299865723  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.635836124420166  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.636019229888916  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8225255012512207  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2325234413146973  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2325234413146973  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

first layer input nodes number: 2187653
first layer output nodes number: 1767910
edges number: 36489583
torch.Size([2187653, 100])
torch.Size([1767910, 256])
input nodes number: 1767910
output nodes number: 545671
edges number: 17400915
torch.Size([1767910, 256])
torch.Size([545671, 256])
torch.Size([24567, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.872014045715332  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.876317024230957  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.84478759765625  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.84478759765625  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.84478759765625  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.44827061891555786 |0.4393683969974518 |0.11519208550453186 |0.0001392662525177002 |0.003293275833129883 |0.0012247562408447266 |
----------------------------------------------------------pseudo_mini_loss sum 3.3344650268554688
Total (block generation + training)time/epoch 525.0610752105713
Training time/epoch 8.314069747924805
Training time without block to device /epoch 4.79912257194519
Training time without total dataloading part /epoch 0.9502217769622803
load block tensor time/epoch 3.586164951324463
block to device time/epoch 3.5149471759796143
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  35934569
Number of first layer input nodes during this epoch:  17481501
Number of first layer output nodes during this epoch:  14094083
----------------------------------------before generate dataloader block 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8447871208190918  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.346545934677124
number of batches is  8
batch size is  24572
random selection method spend 0.013431787490844727
time for parepare:  0.28380370140075684
local_output_nid generation:  0.01212310791015625
local_in_edges_tensor generation:  0.03836965560913086
mini_batch_src_global generation:  0.03262209892272949
r_  generation:  0.38652539253234863
local_output_nid generation:  0.013376474380493164
local_in_edges_tensor generation:  0.016356229782104492
mini_batch_src_global generation:  0.04021763801574707
r_  generation:  0.440523624420166
local_output_nid generation:  0.013373374938964844
local_in_edges_tensor generation:  0.011981487274169922
mini_batch_src_global generation:  0.02665114402770996
r_  generation:  0.44318604469299316
local_output_nid generation:  0.01349949836730957
local_in_edges_tensor generation:  0.011955499649047852
mini_batch_src_global generation:  0.030393362045288086
r_  generation:  0.49654722213745117
local_output_nid generation:  0.013277053833007812
local_in_edges_tensor generation:  0.013421297073364258
mini_batch_src_global generation:  0.03301739692687988
r_  generation:  0.5060915946960449
local_output_nid generation:  0.013399839401245117
local_in_edges_tensor generation:  0.013548135757446289
mini_batch_src_global generation:  0.03796672821044922
r_  generation:  0.538262128829956
local_output_nid generation:  0.013397932052612305
local_in_edges_tensor generation:  0.013014554977416992
mini_batch_src_global generation:  0.03894162178039551
r_  generation:  0.5435068607330322
local_output_nid generation:  0.013265371322631836
local_in_edges_tensor generation:  0.011919498443603516
mini_batch_src_global generation:  0.039743661880493164
r_  generation:  0.5569348335266113
----------------------check_connections_block total spend ----------------------------- 5.442265748977661
generate_one_block  0.9909801483154297
generate_one_block  0.5830297470092773
generate_one_block  0.5612375736236572
generate_one_block  0.559685230255127
generate_one_block  0.5602939128875732
generate_one_block  0.5640251636505127
generate_one_block  0.5703527927398682
generate_one_block  0.5606179237365723
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0281195640563965
gen group dst list time:  0.13135194778442383
time for parepare:  0.42266345024108887
local_output_nid generation:  0.18198394775390625
local_in_edges_tensor generation:  0.5420348644256592
mini_batch_src_global generation:  0.5836553573608398
r_  generation:  6.526347875595093
local_output_nid generation:  0.18455028533935547
local_in_edges_tensor generation:  0.4719667434692383
mini_batch_src_global generation:  0.7067055702209473
r_  generation:  6.99269700050354
local_output_nid generation:  0.17596125602722168
local_in_edges_tensor generation:  0.4766380786895752
mini_batch_src_global generation:  0.7161695957183838
r_  generation:  6.8782899379730225
local_output_nid generation:  0.17856979370117188
local_in_edges_tensor generation:  0.4736928939819336
mini_batch_src_global generation:  0.7345969676971436
r_  generation:  7.178637266159058
local_output_nid generation:  0.17493987083435059
local_in_edges_tensor generation:  0.4746992588043213
mini_batch_src_global generation:  0.7727413177490234
r_  generation:  7.084163427352905
local_output_nid generation:  0.17957305908203125
local_in_edges_tensor generation:  0.46961140632629395
mini_batch_src_global generation:  0.7556226253509521
r_  generation:  7.4098801612854
local_output_nid generation:  0.17572355270385742
local_in_edges_tensor generation:  0.6324462890625
mini_batch_src_global generation:  0.7757265567779541
r_  generation:  7.144146203994751
local_output_nid generation:  0.20226073265075684
local_in_edges_tensor generation:  0.6240320205688477
mini_batch_src_global generation:  0.7538154125213623
r_  generation:  7.211893081665039
----------------------check_connections_block total spend ----------------------------- 77.80617165565491
generate_one_block  9.808916568756104
generate_one_block  9.274387121200562
generate_one_block  9.657815217971802
generate_one_block  9.420778274536133
generate_one_block  9.252864599227905
generate_one_block  9.455738067626953
generate_one_block  9.567770004272461
generate_one_block  9.228176355361938
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.392608880996704
gen group dst list time:  0.5123534202575684
time for parepare:  0.4501161575317383
local_output_nid generation:  0.5776593685150146
local_in_edges_tensor generation:  1.338226079940796
mini_batch_src_global generation:  1.180919885635376
r_  generation:  14.034998655319214
local_output_nid generation:  0.5749096870422363
local_in_edges_tensor generation:  1.2247390747070312
mini_batch_src_global generation:  1.4943690299987793
r_  generation:  14.779890298843384
local_output_nid generation:  0.6066098213195801
local_in_edges_tensor generation:  1.227794885635376
mini_batch_src_global generation:  1.4802417755126953
r_  generation:  14.4783194065094
local_output_nid generation:  0.5849673748016357
local_in_edges_tensor generation:  1.220832347869873
mini_batch_src_global generation:  1.5961172580718994
r_  generation:  15.082233667373657
local_output_nid generation:  0.5835304260253906
local_in_edges_tensor generation:  1.2116296291351318
mini_batch_src_global generation:  1.5036449432373047
r_  generation:  14.586012840270996
local_output_nid generation:  0.5885541439056396
local_in_edges_tensor generation:  1.3764395713806152
mini_batch_src_global generation:  1.5084059238433838
r_  generation:  15.193071842193604
local_output_nid generation:  0.585564136505127
local_in_edges_tensor generation:  1.2027924060821533
mini_batch_src_global generation:  1.5472888946533203
r_  generation:  14.767183065414429
local_output_nid generation:  0.5815539360046387
local_in_edges_tensor generation:  1.200253963470459
mini_batch_src_global generation:  1.5639710426330566
r_  generation:  15.183555841445923
----------------------check_connections_block total spend ----------------------------- 166.27218866348267
generate_one_block  19.810590505599976
generate_one_block  19.811877012252808
generate_one_block  19.48098397254944
generate_one_block  19.67970585823059
generate_one_block  19.494954109191895
generate_one_block  19.401776552200317
generate_one_block  19.198885917663574
generate_one_block  20.77673625946045
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8447871208190918  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

connection checking time:  244.07836031913757
block generation total time  233.3219563961029
average batch blocks generation time:  29.165244549512863
block dataloader generation time/epoch 514.0176151196162
pseudo mini batch 0 input nodes size: 2187062
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8225235939025879  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8225235939025879  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.63726806640625  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.637451171875  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8223037719726562  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2298698425292969  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2298698425292969  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

first layer input nodes number: 2187062
first layer output nodes number: 1760381
edges number: 36403875
torch.Size([2187062, 100])
torch.Size([1760381, 256])
input nodes number: 1760381
output nodes number: 545235
edges number: 17369790
torch.Size([1760381, 256])
torch.Size([545235, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.847392559051514  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.851696014404297  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8398857116699219  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

pseudo mini batch 1 input nodes size: 2185760
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8223056793212891  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8223056793212891  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.636758804321289  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.636941909790039  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2308030128479004  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2308030128479004  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

first layer input nodes number: 2185760
first layer output nodes number: 1764454
edges number: 36434361
torch.Size([2185760, 100])
torch.Size([1764454, 256])
input nodes number: 1764454
output nodes number: 547332
edges number: 17441770
torch.Size([1764454, 256])
torch.Size([547332, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.8655171394348145  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.8698201179504395  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8412895202636719  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

pseudo mini batch 2 input nodes size: 2183503
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6354327201843262  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6356158256530762  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8209795951843262  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2285676002502441  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2285676002502441  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

first layer input nodes number: 2183503
first layer output nodes number: 1759700
edges number: 36371433
torch.Size([2183503, 100])
torch.Size([1759700, 256])
input nodes number: 1759700
output nodes number: 545554
edges number: 17406114
torch.Size([1759700, 256])
torch.Size([545554, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.84474515914917  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.849048137664795  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8386716842651367  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

pseudo mini batch 3 input nodes size: 2184629
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8209795951843262  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8209795951843262  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6354327201843262  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6356158256530762  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2294039726257324  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2294039726257324  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

first layer input nodes number: 2184629
first layer output nodes number: 1760241
edges number: 36373064
torch.Size([2184629, 100])
torch.Size([1760241, 256])
input nodes number: 1760241
output nodes number: 545196
edges number: 17377322
torch.Size([1760241, 256])
torch.Size([545196, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.8463945388793945  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.8506975173950195  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8386611938476562  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

pseudo mini batch 4 input nodes size: 2182321
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6349925994873047  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6351757049560547  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8205394744873047  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2267341613769531  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2267341613769531  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

first layer input nodes number: 2182321
first layer output nodes number: 1755393
edges number: 36286689
torch.Size([2182321, 100])
torch.Size([1755393, 256])
input nodes number: 1755393
output nodes number: 542712
edges number: 17303169
torch.Size([1755393, 256])
torch.Size([542712, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.822499752044678  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.826802730560303  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.833498477935791  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

pseudo mini batch 5 input nodes size: 2184524
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8205394744873047  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8205394744873047  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6349925994873047  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6351757049560547  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2292485237121582  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2292485237121582  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

first layer input nodes number: 2184524
first layer output nodes number: 1759978
edges number: 36366611
torch.Size([2184524, 100])
torch.Size([1759978, 256])
input nodes number: 1759978
output nodes number: 544875
edges number: 17362009
torch.Size([1759978, 256])
torch.Size([544875, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.843055248260498  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.847358226776123  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8372879028320312  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

pseudo mini batch 6 input nodes size: 2183512
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6354360580444336  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6356191635131836  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8209829330444336  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2281608581542969  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2281608581542969  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

first layer input nodes number: 2183512
first layer output nodes number: 1759974
edges number: 36358507
torch.Size([2183512, 100])
torch.Size([1759974, 256])
input nodes number: 1759974
output nodes number: 544851
edges number: 17361037
torch.Size([1759974, 256])
torch.Size([544851, 256])
torch.Size([24572, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.843052864074707  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.847355842590332  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8380522727966309  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

pseudo mini batch 7 input nodes size: 2183945
----------------------------------------before load block subtensor 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8209829330444336  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.8209829330444336  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6354360580444336  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.6356191635131836  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 0.822014331817627  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2286524772644043  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.2286524772644043  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

first layer input nodes number: 2183945
first layer output nodes number: 1758338
edges number: 36331588
torch.Size([2183945, 100])
torch.Size([1758338, 256])
input nodes number: 1758338
output nodes number: 543110
edges number: 17317315
torch.Size([1758338, 256])
torch.Size([543110, 256])
torch.Size([24567, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.833127975463867  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 7.837430953979492  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8379273414611816  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8379273414611816  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 22.2791748046875 GB
    Memory Allocated: 1.8379273414611816  GigaBytes
Max Memory Allocated: 9.670547485351562  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.442425012588501 |0.5340946316719055 |0.11338922381401062 |0.0001385211944580078 |0.003249257802963257 |0.0012204647064208984 |
----------------------------------------------------------pseudo_mini_loss sum 2.207458972930908
Total (block generation + training)time/epoch 522.9994221131006
Training time/epoch 9.008021831512451
Training time without block to device /epoch 4.735264778137207
Training time without total dataloading part /epoch 0.935436487197876
load block tensor time/epoch 3.539400100708008
block to device time/epoch 4.272757053375244
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  35912580
Number of first layer input nodes during this epoch:  17475256
Number of first layer output nodes during this epoch:  14078459
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  206336
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([47, 256])
layers.2.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
