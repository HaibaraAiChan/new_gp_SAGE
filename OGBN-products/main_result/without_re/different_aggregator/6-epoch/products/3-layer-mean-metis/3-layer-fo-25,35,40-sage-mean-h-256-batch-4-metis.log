main start at this time 1656969505.2116563
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

#nodes: 2449029
#edges: 123718024
#classes: 47
success----------------------------------------
196571
39255
2164782
# Nodes: 2400608
# Edges: 123718024
# Train: 196571
# Val: 39255
# Test: 2164782
# Classes: 47

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  100
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.5263993740081787
global_2_local spend time (sec) 0.4552726745605469
----------------------------  graph partition start---------------------
Convert a graph into a bidirected graph: 1.433 seconds
Metis partitioning: 2.078 seconds
Split the graph: 0.616 seconds
Construct subgraphs: 0.030 seconds
48351
50410
48169
49641
The batched output nid list before graph partition
total k batches seeds list generation spend  4.219225883483887
after graph partition
graph partition algorithm spend time 5.53324818611145
48351
50410
48169
49641
partition_len_list
[802017, 819119, 802351, 814676]
metis selection method  spend 6.249335765838623
time for parepare:  0.281191349029541
local_output_nid generation:  0.008020401000976562
local_in_edges_tensor generation:  0.020985841751098633
mini_batch_src_global generation:  0.058152198791503906
r_  generation:  0.9130909442901611
local_output_nid generation:  0.012850046157836914
local_in_edges_tensor generation:  0.09187150001525879
mini_batch_src_global generation:  0.07739615440368652
r_  generation:  1.0668811798095703
local_output_nid generation:  0.010377645492553711
local_in_edges_tensor generation:  0.04201555252075195
mini_batch_src_global generation:  0.06189680099487305
r_  generation:  1.0119762420654297
local_output_nid generation:  0.011876344680786133
local_in_edges_tensor generation:  0.19939255714416504
mini_batch_src_global generation:  0.06499958038330078
r_  generation:  1.1058375835418701
----------------------check_connections_block total spend ----------------------------- 5.724711179733276
generate_one_block  2.585827350616455
generate_one_block  1.1682944297790527
generate_one_block  1.1125082969665527
generate_one_block  1.1537883281707764
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.0094738006591797
gen group dst list time:  0.10435175895690918
time for parepare:  0.4502377510070801
local_output_nid generation:  0.214216947555542
local_in_edges_tensor generation:  0.7109375
mini_batch_src_global generation:  0.8301517963409424
r_  generation:  11.05045199394226
local_output_nid generation:  0.2654757499694824
local_in_edges_tensor generation:  0.7513463497161865
mini_batch_src_global generation:  1.0841639041900635
r_  generation:  11.203387022018433
local_output_nid generation:  0.2368462085723877
local_in_edges_tensor generation:  0.6156940460205078
mini_batch_src_global generation:  1.0113420486450195
r_  generation:  10.94143271446228
local_output_nid generation:  0.2594277858734131
local_in_edges_tensor generation:  0.8864338397979736
mini_batch_src_global generation:  1.0005650520324707
r_  generation:  11.551162242889404
----------------------check_connections_block total spend ----------------------------- 60.440836906433105
generate_one_block  14.563293933868408
generate_one_block  14.398614883422852
generate_one_block  14.495499610900879
generate_one_block  14.613956689834595
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.2350142002105713
gen group dst list time:  0.2727370262145996
time for parepare:  0.4901151657104492
local_output_nid generation:  0.589026927947998
local_in_edges_tensor generation:  1.259343147277832
mini_batch_src_global generation:  1.2075223922729492
r_  generation:  17.550772666931152
local_output_nid generation:  0.6310279369354248
local_in_edges_tensor generation:  1.2209298610687256
mini_batch_src_global generation:  1.5453689098358154
r_  generation:  17.55241584777832
local_output_nid generation:  0.6364524364471436
local_in_edges_tensor generation:  1.2158043384552002
mini_batch_src_global generation:  1.4970078468322754
r_  generation:  17.659008979797363
local_output_nid generation:  0.6068286895751953
local_in_edges_tensor generation:  1.2401158809661865
mini_batch_src_global generation:  1.533463954925537
r_  generation:  17.754709243774414
----------------------check_connections_block total spend ----------------------------- 96.47608351707458
generate_one_block  22.618016719818115
generate_one_block  22.250730991363525
generate_one_block  22.156394004821777
generate_one_block  22.84932827949524
----------===============-------------===============-------------the number of batches *****---- 4

original number of batches:  4
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

connection checking time:  162.64163160324097
block generation total time  153.96625351905823
average batch blocks generation time:  12.830521126588186
block dataloader generation time/epoch 337.20613193511963
pseudo mini batch 0 input nodes size: 2223161
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0007686614990234375  GigaBytes
Max Memory Allocated: 0.0007686614990234375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.8475341796875 GB
    Memory Allocated: 0.8289608955383301  GigaBytes
Max Memory Allocated: 0.8289608955383301  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.8475341796875 GB
    Memory Allocated: 0.8293213844299316  GigaBytes
Max Memory Allocated: 0.8293213844299316  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.8475341796875 GB
    Memory Allocated: 0.8293213844299316  GigaBytes
Max Memory Allocated: 0.8293213844299316  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 1.3164143562316895  GigaBytes
Max Memory Allocated: 1.3164143562316895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.4080810546875 GB
    Memory Allocated: 1.3164143562316895  GigaBytes
Max Memory Allocated: 1.3164143562316895  GigaBytes

first layer input nodes number: 2223161
first layer output nodes number: 1918905
edges number: 38382547
torch.Size([2223161, 100])
torch.Size([1918905, 256])
input nodes number: 1918905
output nodes number: 802017
edges number: 24965918
torch.Size([1918905, 256])
torch.Size([802017, 256])
torch.Size([48351, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 13.2596435546875 GB
    Memory Allocated: 9.249516010284424  GigaBytes
Max Memory Allocated: 9.937355518341064  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 13.2596435546875 GB
    Memory Allocated: 9.257982730865479  GigaBytes
Max Memory Allocated: 9.937355518341064  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.4530029296875 GB
    Memory Allocated: 2.082796096801758  GigaBytes
Max Memory Allocated: 10.742269039154053  GigaBytes

pseudo mini batch 1 input nodes size: 2223155
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.4530029296875 GB
    Memory Allocated: 0.8385567665100098  GigaBytes
Max Memory Allocated: 10.742269039154053  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.4530029296875 GB
    Memory Allocated: 0.8385567665100098  GigaBytes
Max Memory Allocated: 10.742269039154053  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.4530029296875 GB
    Memory Allocated: 1.6667466163635254  GigaBytes
Max Memory Allocated: 10.742269039154053  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.4530029296875 GB
    Memory Allocated: 1.6671223640441895  GigaBytes
Max Memory Allocated: 10.742269039154053  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.4530029296875 GB
    Memory Allocated: 0.8385696411132812  GigaBytes
Max Memory Allocated: 10.742269039154053  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.4530029296875 GB
    Memory Allocated: 1.3293075561523438  GigaBytes
Max Memory Allocated: 10.742269039154053  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4530029296875 GB
    Memory Allocated: 1.3293075561523438  GigaBytes
Max Memory Allocated: 10.742269039154053  GigaBytes

first layer input nodes number: 2223155
first layer output nodes number: 1926609
edges number: 38474555
torch.Size([2223155, 100])
torch.Size([1926609, 256])
input nodes number: 1926609
output nodes number: 819119
edges number: 25485011
torch.Size([1926609, 256])
torch.Size([819119, 256])
torch.Size([50410, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.7850341796875 GB
    Memory Allocated: 9.335014343261719  GigaBytes
Max Memory Allocated: 10.742269039154053  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.7850341796875 GB
    Memory Allocated: 9.343841075897217  GigaBytes
Max Memory Allocated: 10.742269039154053  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.4119873046875 GB
    Memory Allocated: 2.097792148590088  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

pseudo mini batch 2 input nodes size: 2224855
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.4119873046875 GB
    Memory Allocated: 0.8389301300048828  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.4119873046875 GB
    Memory Allocated: 0.8389301300048828  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.4119873046875 GB
    Memory Allocated: 1.6677532196044922  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.4119873046875 GB
    Memory Allocated: 1.6681122779846191  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.4119873046875 GB
    Memory Allocated: 0.8395466804504395  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.4119873046875 GB
    Memory Allocated: 1.3257098197937012  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4119873046875 GB
    Memory Allocated: 1.3257098197937012  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

first layer input nodes number: 2224855
first layer output nodes number: 1921614
edges number: 38426113
torch.Size([2224855, 100])
torch.Size([1921614, 256])
input nodes number: 1921614
output nodes number: 802351
edges number: 25004455
torch.Size([1921614, 256])
torch.Size([802351, 256])
torch.Size([48169, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4119873046875 GB
    Memory Allocated: 9.25657320022583  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.4119873046875 GB
    Memory Allocated: 9.265007972717285  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.4119873046875 GB
    Memory Allocated: 2.084371566772461  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

pseudo mini batch 3 input nodes size: 2223721
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.4119873046875 GB
    Memory Allocated: 0.8391547203063965  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.4119873046875 GB
    Memory Allocated: 0.8391547203063965  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.4119873046875 GB
    Memory Allocated: 1.667555809020996  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.4119873046875 GB
    Memory Allocated: 1.6679258346557617  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.4119873046875 GB
    Memory Allocated: 0.8387436866760254  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.4119873046875 GB
    Memory Allocated: 1.3280606269836426  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4119873046875 GB
    Memory Allocated: 1.3280606269836426  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

first layer input nodes number: 2223721
first layer output nodes number: 1926716
edges number: 38461312
torch.Size([2223721, 100])
torch.Size([1926716, 256])
input nodes number: 1926716
output nodes number: 814676
edges number: 25338094
torch.Size([1926716, 256])
torch.Size([814676, 256])
torch.Size([49641, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4119873046875 GB
    Memory Allocated: 9.316579341888428  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.4119873046875 GB
    Memory Allocated: 9.325271606445312  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.2498779296875 GB
    Memory Allocated: 2.0923523902893066  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 2.0938897132873535  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 2.0938897132873535  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.3717226982116699 |0.7495503425598145 |0.36577534675598145 |0.00018346309661865234 |0.14374858140945435 |0.003962278366088867 |
----------------------------------------------------------pseudo_mini_loss sum 7.158202171325684
Total (block generation + training)time/epoch 343.8814253807068
Training time/epoch 6.674943685531616
Training time without block to device /epoch 3.6767423152923584
Training time without total dataloading part /epoch 2.0427918434143066
load block tensor time/epoch 1.4868907928466797
block to device time/epoch 2.998201370239258
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  19826899
Number of first layer input nodes during this epoch:  8894892
Number of first layer output nodes during this epoch:  7693844
----------------------------------------before generate dataloader block 
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 2.0938892364501953  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.45223116874694824
global_2_local spend time (sec) 0.4704275131225586
----------------------------  graph partition start---------------------
Convert a graph into a bidirected graph: 0.504 seconds
Metis partitioning: 2.368 seconds
Split the graph: 0.623 seconds
Construct subgraphs: 0.056 seconds
48351
50410
48169
49641
The batched output nid list before graph partition
total k batches seeds list generation spend  3.613548517227173
after graph partition
graph partition algorithm spend time 4.966071128845215
48351
50410
48169
49641
partition_len_list
[801349, 819913, 800821, 815381]
metis selection method  spend 5.734641790390015
time for parepare:  0.28026270866394043
local_output_nid generation:  0.010067939758300781
local_in_edges_tensor generation:  0.08538556098937988
mini_batch_src_global generation:  0.05854940414428711
r_  generation:  0.8867990970611572
local_output_nid generation:  0.009627342224121094
local_in_edges_tensor generation:  0.036995649337768555
mini_batch_src_global generation:  0.08090853691101074
r_  generation:  1.0329368114471436
local_output_nid generation:  0.010609865188598633
local_in_edges_tensor generation:  0.025740861892700195
mini_batch_src_global generation:  0.05580019950866699
r_  generation:  1.0398790836334229
local_output_nid generation:  0.009740114212036133
local_in_edges_tensor generation:  0.03130936622619629
mini_batch_src_global generation:  0.07461071014404297
r_  generation:  1.1760613918304443
----------------------check_connections_block total spend ----------------------------- 5.633621454238892
generate_one_block  1.5323824882507324
generate_one_block  1.1869537830352783
generate_one_block  1.1253163814544678
generate_one_block  1.177797555923462
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.180015802383423
gen group dst list time:  0.10022425651550293
time for parepare:  0.45845484733581543
local_output_nid generation:  0.23179030418395996
local_in_edges_tensor generation:  0.7252278327941895
mini_batch_src_global generation:  0.8037934303283691
r_  generation:  11.077657699584961
local_output_nid generation:  0.2630341053009033
local_in_edges_tensor generation:  0.7721500396728516
mini_batch_src_global generation:  1.0882015228271484
r_  generation:  11.086636304855347
local_output_nid generation:  0.26606130599975586
local_in_edges_tensor generation:  0.8292109966278076
mini_batch_src_global generation:  1.021094560623169
r_  generation:  11.123686790466309
local_output_nid generation:  0.2637467384338379
local_in_edges_tensor generation:  0.7409741878509521
mini_batch_src_global generation:  0.9931950569152832
r_  generation:  11.410280704498291
----------------------check_connections_block total spend ----------------------------- 60.81512808799744
generate_one_block  16.206106185913086
generate_one_block  14.990050792694092
generate_one_block  14.44194769859314
generate_one_block  14.390800714492798
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.303431749343872
gen group dst list time:  0.2747828960418701
time for parepare:  0.4830808639526367
local_output_nid generation:  0.6013338565826416
local_in_edges_tensor generation:  1.3549625873565674
mini_batch_src_global generation:  1.2124717235565186
r_  generation:  17.749438047409058
local_output_nid generation:  0.661811113357544
local_in_edges_tensor generation:  1.2879157066345215
mini_batch_src_global generation:  1.6145756244659424
r_  generation:  17.735811710357666
local_output_nid generation:  0.6259942054748535
local_in_edges_tensor generation:  1.4201257228851318
mini_batch_src_global generation:  1.5282256603240967
r_  generation:  17.690765380859375
local_output_nid generation:  0.6220273971557617
local_in_edges_tensor generation:  1.2489440441131592
mini_batch_src_global generation:  1.6872892379760742
r_  generation:  17.794840812683105
----------------------check_connections_block total spend ----------------------------- 97.34903740882874
generate_one_block  22.744549036026
generate_one_block  22.78008508682251
generate_one_block  22.94490909576416
generate_one_block  23.516701459884644
----------===============-------------===============-------------the number of batches *****---- 4

original number of batches:  4
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 2.0938892364501953  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

connection checking time:  163.79778695106506
block generation total time  157.03760027885437
average batch blocks generation time:  13.086466689904531
block dataloader generation time/epoch 339.36986017227173
pseudo mini batch 0 input nodes size: 2221930
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 0.8405375480651855  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 0.8405375480651855  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 1.6682710647583008  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 1.6686315536499023  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 0.8398604393005371  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 1.325742244720459  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 1.325742244720459  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

first layer input nodes number: 2221930
first layer output nodes number: 1920192
edges number: 38423414
torch.Size([2221930, 100])
torch.Size([1920192, 256])
input nodes number: 1920192
output nodes number: 801349
edges number: 24961917
torch.Size([1920192, 256])
torch.Size([801349, 256])
torch.Size([48351, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 9.250627517700195  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 9.25909423828125  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 2.0836973190307617  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

pseudo mini batch 1 input nodes size: 2224544
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 0.8396353721618652  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 0.8396353721618652  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 1.6683425903320312  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 1.6687183380126953  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 0.8406243324279785  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 1.3315892219543457  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.2518310546875 GB
    Memory Allocated: 1.3315892219543457  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

first layer input nodes number: 2224544
first layer output nodes number: 1928573
edges number: 38495398
torch.Size([2224544, 100])
torch.Size([1928573, 256])
input nodes number: 1928573
output nodes number: 819913
edges number: 25495323
torch.Size([1928573, 256])
torch.Size([819913, 256])
torch.Size([50410, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 15.8221435546875 GB
    Memory Allocated: 9.344419956207275  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 15.8221435546875 GB
    Memory Allocated: 9.353246688842773  GigaBytes
Max Memory Allocated: 10.85801649093628  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 2.0999794006347656  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

pseudo mini batch 2 input nodes size: 2223878
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 0.8409848213195801  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 0.8409848213195801  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 1.6694440841674805  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 1.6698031425476074  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 0.8407201766967773  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 1.3260326385498047  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 1.3260326385498047  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

first layer input nodes number: 2223878
first layer output nodes number: 1918151
edges number: 38361056
torch.Size([2223878, 100])
torch.Size([1918151, 256])
input nodes number: 1918151
output nodes number: 800821
edges number: 24954169
torch.Size([1918151, 256])
torch.Size([800821, 256])
torch.Size([48169, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 9.242488384246826  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 9.250923156738281  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 2.08243465423584  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

pseudo mini batch 3 input nodes size: 2222421
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 0.8403282165527344  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 0.8403282165527344  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 1.6690354347229004  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 1.669405460357666  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 0.8405871391296387  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 1.3299298286437988  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 1.3299298286437988  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

first layer input nodes number: 2222421
first layer output nodes number: 1925381
edges number: 38450770
torch.Size([2222421, 100])
torch.Size([1925381, 256])
input nodes number: 1925381
output nodes number: 815381
edges number: 25352861
torch.Size([1925381, 256])
torch.Size([815381, 256])
torch.Size([49641, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 9.317032814025879  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 9.325725078582764  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 2.0955629348754883  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 2.0955629348754883  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 2.0955629348754883  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.45019692182540894 |0.5076491236686707 |0.1911334991455078 |0.0001556873321533203 |0.05612599849700928 |0.0033469200134277344 |
----------------------------------------------------------pseudo_mini_loss sum 12.477285385131836
Total (block generation + training)time/epoch 345.28842055797577
Training time/epoch 5.161573648452759
Training time without block to device /epoch 3.130977153778076
Training time without total dataloading part /epoch 0.9930076599121094
load block tensor time/epoch 1.8007876873016357
block to device time/epoch 2.0305964946746826
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 1 |
Number of nodes for computation during this epoch:  19822534
Number of first layer input nodes during this epoch:  8892773
Number of first layer output nodes during this epoch:  7692297
----------------------------------------before generate dataloader block 
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 2.09556245803833  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.36359715461730957
global_2_local spend time (sec) 0.5264897346496582
----------------------------  graph partition start---------------------
Convert a graph into a bidirected graph: 0.493 seconds
Metis partitioning: 2.467 seconds
Split the graph: 0.668 seconds
Construct subgraphs: 0.071 seconds
48351
50410
48169
49641
The batched output nid list before graph partition
total k batches seeds list generation spend  3.7561330795288086
after graph partition
graph partition algorithm spend time 5.1243064403533936
48351
50410
48169
49641
partition_len_list
[801385, 819640, 801847, 814800]
metis selection method  spend 5.939978837966919
time for parepare:  0.2716684341430664
local_output_nid generation:  0.00895237922668457
local_in_edges_tensor generation:  0.026921987533569336
mini_batch_src_global generation:  0.07546138763427734
r_  generation:  0.9383368492126465
local_output_nid generation:  0.012755870819091797
local_in_edges_tensor generation:  0.0472722053527832
mini_batch_src_global generation:  0.07745122909545898
r_  generation:  1.0432519912719727
local_output_nid generation:  0.010269403457641602
local_in_edges_tensor generation:  0.019648075103759766
mini_batch_src_global generation:  0.056174278259277344
r_  generation:  0.9907889366149902
local_output_nid generation:  0.010990381240844727
local_in_edges_tensor generation:  0.04233670234680176
mini_batch_src_global generation:  0.07338619232177734
r_  generation:  1.1397688388824463
----------------------check_connections_block total spend ----------------------------- 5.580347061157227
generate_one_block  1.564551591873169
generate_one_block  1.393176794052124
generate_one_block  1.3134729862213135
generate_one_block  1.1634113788604736
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.1938984394073486
gen group dst list time:  0.11082768440246582
time for parepare:  0.47775912284851074
local_output_nid generation:  0.22795486450195312
local_in_edges_tensor generation:  0.790316104888916
mini_batch_src_global generation:  0.8213403224945068
r_  generation:  10.856761932373047
local_output_nid generation:  0.2652747631072998
local_in_edges_tensor generation:  0.8495991230010986
mini_batch_src_global generation:  1.0140635967254639
r_  generation:  11.324736595153809
local_output_nid generation:  0.2605578899383545
local_in_edges_tensor generation:  0.7461588382720947
mini_batch_src_global generation:  0.980959415435791
r_  generation:  10.82373857498169
local_output_nid generation:  0.24478673934936523
local_in_edges_tensor generation:  1.25455641746521
mini_batch_src_global generation:  1.0186400413513184
r_  generation:  11.191103458404541
----------------------check_connections_block total spend ----------------------------- 60.649574279785156
generate_one_block  14.471384286880493
generate_one_block  14.692598581314087
generate_one_block  14.131803274154663
generate_one_block  14.582951784133911
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.1973652839660645
gen group dst list time:  0.2850022315979004
time for parepare:  0.45185279846191406
local_output_nid generation:  0.5839278697967529
local_in_edges_tensor generation:  1.5679094791412354
mini_batch_src_global generation:  1.2841343879699707
r_  generation:  17.659570932388306
local_output_nid generation:  0.6360459327697754
local_in_edges_tensor generation:  1.3720381259918213
mini_batch_src_global generation:  1.7489285469055176
r_  generation:  17.717875719070435
local_output_nid generation:  0.6288526058197021
local_in_edges_tensor generation:  1.250330924987793
mini_batch_src_global generation:  1.6612091064453125
r_  generation:  17.664846181869507
local_output_nid generation:  0.6503176689147949
local_in_edges_tensor generation:  1.258429765701294
mini_batch_src_global generation:  1.5937888622283936
r_  generation:  17.836251258850098
----------------------check_connections_block total spend ----------------------------- 97.47418642044067
generate_one_block  22.623840808868408
generate_one_block  22.807642936706543
generate_one_block  22.7874493598938
generate_one_block  22.804435968399048
----------===============-------------===============-------------the number of batches *****---- 4

original number of batches:  4
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 2.09556245803833  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

connection checking time:  163.70410776138306
block generation total time  154.33671975135803
average batch blocks generation time:  12.861393312613169
block dataloader generation time/epoch 339.1837264696757
pseudo mini batch 0 input nodes size: 2221659
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 0.840843677520752  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 0.840843677520752  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 1.6684765815734863  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 1.668837070465088  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 0.8397598266601562  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 1.3252248764038086  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 1.3252248764038086  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

first layer input nodes number: 2221659
first layer output nodes number: 1917848
edges number: 38362215
torch.Size([2221659, 100])
torch.Size([1917848, 256])
input nodes number: 1917848
output nodes number: 801385
edges number: 24966781
torch.Size([1917848, 256])
torch.Size([801385, 256])
torch.Size([48351, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 9.243175506591797  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 9.251642227172852  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 2.0825915336608887  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

pseudo mini batch 1 input nodes size: 2225627
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 0.8395347595214844  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 0.8395347595214844  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 1.6686458587646484  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 1.6690216064453125  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 0.8410282135009766  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 1.3318681716918945  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.4471435546875 GB
    Memory Allocated: 1.3318681716918945  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

first layer input nodes number: 2225627
first layer output nodes number: 1929527
edges number: 38494109
torch.Size([2225627, 100])
torch.Size([1929527, 256])
input nodes number: 1929527
output nodes number: 819640
edges number: 25480030
torch.Size([1929527, 256])
torch.Size([819640, 256])
torch.Size([50410, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 16.1053466796875 GB
    Memory Allocated: 9.3454270362854  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 16.1053466796875 GB
    Memory Allocated: 9.354253768920898  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.7322998046875 GB
    Memory Allocated: 2.100015163421631  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

pseudo mini batch 2 input nodes size: 2222375
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.7322998046875 GB
    Memory Allocated: 0.8413887023925781  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.7322998046875 GB
    Memory Allocated: 0.8413887023925781  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.7322998046875 GB
    Memory Allocated: 1.669288158416748  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.7322998046875 GB
    Memory Allocated: 1.669647216796875  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.7322998046875 GB
    Memory Allocated: 0.8401603698730469  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.7322998046875 GB
    Memory Allocated: 1.3256855010986328  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7322998046875 GB
    Memory Allocated: 1.3256855010986328  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

first layer input nodes number: 2222375
first layer output nodes number: 1917098
edges number: 38365941
torch.Size([2222375, 100])
torch.Size([1917098, 256])
input nodes number: 1917098
output nodes number: 801847
edges number: 24978118
torch.Size([1917098, 256])
torch.Size([801847, 256])
torch.Size([48169, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7322998046875 GB
    Memory Allocated: 9.243613719940186  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.7322998046875 GB
    Memory Allocated: 9.25204849243164  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 18.7322998046875 GB
    Memory Allocated: 2.0838704109191895  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

pseudo mini batch 3 input nodes size: 2224894
----------------------------------------before load block subtensor 
 Nvidia-smi: 18.7322998046875 GB
    Memory Allocated: 0.8397684097290039  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 18.7322998046875 GB
    Memory Allocated: 0.8397684097290039  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 18.7322998046875 GB
    Memory Allocated: 1.668879508972168  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 18.7322998046875 GB
    Memory Allocated: 1.6692495346069336  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 18.7322998046875 GB
    Memory Allocated: 0.8409910202026367  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 18.7322998046875 GB
    Memory Allocated: 1.3306264877319336  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7322998046875 GB
    Memory Allocated: 1.3306264877319336  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

first layer input nodes number: 2224894
first layer output nodes number: 1928375
edges number: 38501352
torch.Size([2224894, 100])
torch.Size([1928375, 256])
input nodes number: 1928375
output nodes number: 814800
edges number: 25341695
torch.Size([1928375, 256])
torch.Size([814800, 256])
torch.Size([49641, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 18.7322998046875 GB
    Memory Allocated: 9.323235034942627  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 18.7322998046875 GB
    Memory Allocated: 9.332884311676025  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 2.095334053039551  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 2.095334053039551  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 2.095334053039551  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4520367980003357 |0.4435077905654907 |0.16813457012176514 |0.0001570582389831543 |0.061395108699798584 |0.0027883052825927734 |
----------------------------------------------------------pseudo_mini_loss sum 3.6499361991882324
Total (block generation + training)time/epoch 344.74087111155194
Training time/epoch 4.834046840667725
Training time without block to device /epoch 3.0600156784057617
Training time without total dataloading part /epoch 0.9215352535247803
load block tensor time/epoch 1.8081471920013428
block to device time/epoch 1.774031162261963
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 2 |
Number of nodes for computation during this epoch:  19825075
Number of first layer input nodes during this epoch:  8894555
Number of first layer output nodes during this epoch:  7692848
----------------------------------------before generate dataloader block 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 2.0953335762023926  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.29139018058776855
global_2_local spend time (sec) 0.4852302074432373
----------------------------  graph partition start---------------------
Convert a graph into a bidirected graph: 0.382 seconds
Metis partitioning: 2.333 seconds
Split the graph: 0.701 seconds
Construct subgraphs: 0.097 seconds
48351
50410
48169
49641
The batched output nid list before graph partition
total k batches seeds list generation spend  3.5741076469421387
after graph partition
graph partition algorithm spend time 4.888596296310425
48351
50410
48169
49641
partition_len_list
[803384, 819459, 800394, 814564]
metis selection method  spend 5.649338960647583
time for parepare:  0.27260637283325195
local_output_nid generation:  0.009142637252807617
local_in_edges_tensor generation:  0.026155948638916016
mini_batch_src_global generation:  0.06194591522216797
r_  generation:  0.8978135585784912
local_output_nid generation:  0.013290643692016602
local_in_edges_tensor generation:  0.029920578002929688
mini_batch_src_global generation:  0.08495497703552246
r_  generation:  1.0390386581420898
local_output_nid generation:  0.009972095489501953
local_in_edges_tensor generation:  0.01575160026550293
mini_batch_src_global generation:  0.056382179260253906
r_  generation:  1.06294846534729
local_output_nid generation:  0.01386713981628418
local_in_edges_tensor generation:  0.018413543701171875
mini_batch_src_global generation:  0.0691218376159668
r_  generation:  1.1117942333221436
----------------------check_connections_block total spend ----------------------------- 5.508867263793945
generate_one_block  1.5515227317810059
generate_one_block  1.1971673965454102
generate_one_block  1.1573596000671387
generate_one_block  1.2822928428649902
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.261608123779297
gen group dst list time:  0.11187219619750977
time for parepare:  0.4481673240661621
local_output_nid generation:  0.22678589820861816
local_in_edges_tensor generation:  0.7747294902801514
mini_batch_src_global generation:  0.8217923641204834
r_  generation:  11.530812501907349
local_output_nid generation:  0.26055169105529785
local_in_edges_tensor generation:  0.7684204578399658
mini_batch_src_global generation:  1.046644926071167
r_  generation:  11.303385734558105
local_output_nid generation:  0.2562754154205322
local_in_edges_tensor generation:  0.9066619873046875
mini_batch_src_global generation:  1.0002007484436035
r_  generation:  10.774545192718506
local_output_nid generation:  0.2533247470855713
local_in_edges_tensor generation:  0.6316978931427002
mini_batch_src_global generation:  1.0834672451019287
r_  generation:  11.292277812957764
----------------------check_connections_block total spend ----------------------------- 60.92829728126526
generate_one_block  14.603492736816406
generate_one_block  14.768553972244263
generate_one_block  14.437758207321167
generate_one_block  14.638772249221802
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.212892532348633
gen group dst list time:  0.29136228561401367
time for parepare:  0.4539341926574707
local_output_nid generation:  0.580498456954956
local_in_edges_tensor generation:  1.3327126502990723
mini_batch_src_global generation:  1.1789276599884033
r_  generation:  16.93501877784729
local_output_nid generation:  0.6383538246154785
local_in_edges_tensor generation:  1.315326452255249
mini_batch_src_global generation:  1.5187747478485107
r_  generation:  17.62747859954834
local_output_nid generation:  0.6185948848724365
local_in_edges_tensor generation:  1.4488277435302734
mini_batch_src_global generation:  1.5961453914642334
r_  generation:  17.535908937454224
local_output_nid generation:  0.6432023048400879
local_in_edges_tensor generation:  1.1297366619110107
mini_batch_src_global generation:  1.863037109375
r_  generation:  18.13521695137024
----------------------check_connections_block total spend ----------------------------- 96.42317414283752
generate_one_block  22.75066089630127
generate_one_block  22.63071846961975
generate_one_block  23.12057089805603
generate_one_block  22.74065375328064
----------===============-------------===============-------------the number of batches *****---- 4

original number of batches:  4
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 2.0953335762023926  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

connection checking time:  162.86033868789673
block generation total time  154.87952375411987
average batch blocks generation time:  12.906626979509989
block dataloader generation time/epoch 338.9302012324333
pseudo mini batch 0 input nodes size: 2221869
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 0.84124755859375  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 0.84124755859375  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.6689586639404297  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.6693191528320312  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 0.8398380279541016  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.326024055480957  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.326024055480957  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

first layer input nodes number: 2221869
first layer output nodes number: 1918824
edges number: 38382311
torch.Size([2221869, 100])
torch.Size([1918824, 256])
input nodes number: 1918824
output nodes number: 803384
edges number: 25042706
torch.Size([1918824, 256])
torch.Size([803384, 256])
torch.Size([48351, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 9.254330158233643  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 9.262796878814697  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 2.084728240966797  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

pseudo mini batch 1 input nodes size: 2224796
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 0.8396129608154297  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 0.8396129608154297  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.6687240600585938  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.6690998077392578  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 0.8410282135009766  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.3316764831542969  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.3316764831542969  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

first layer input nodes number: 2224796
first layer output nodes number: 1927469
edges number: 38473202
torch.Size([2224796, 100])
torch.Size([1927469, 256])
input nodes number: 1927469
output nodes number: 819459
edges number: 25477593
torch.Size([1927469, 256])
torch.Size([819459, 256])
torch.Size([50410, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 9.339637756347656  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 9.348464488983154  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 2.100492000579834  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

pseudo mini batch 2 input nodes size: 2221570
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 0.8413887023925781  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 0.8413887023925781  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.6689882278442383  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.6693472862243652  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 0.8398604393005371  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.3251128196716309  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.3251128196716309  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

first layer input nodes number: 2221570
first layer output nodes number: 1917225
edges number: 38372370
torch.Size([2221570, 100])
torch.Size([1917225, 256])
input nodes number: 1917225
output nodes number: 800394
edges number: 24935486
torch.Size([1917225, 256])
torch.Size([800394, 256])
torch.Size([48169, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 9.238451480865479  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 9.246886253356934  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 2.082162857055664  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

pseudo mini batch 3 input nodes size: 2224937
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 0.8394684791564941  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 0.8394684791564941  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.6685795783996582  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.6689496040344238  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 0.8409910202026367  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.330888271331787  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.330888271331787  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

first layer input nodes number: 2224937
first layer output nodes number: 1926772
edges number: 38461454
torch.Size([2224937, 100])
torch.Size([1926772, 256])
input nodes number: 1926772
output nodes number: 814564
edges number: 25330485
torch.Size([1926772, 256])
torch.Size([814564, 256])
torch.Size([49641, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 9.319154739379883  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 9.327847003936768  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 2.095949172973633  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 2.095949172973633  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 2.095949172973633  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.48873597383499146 |0.5124916434288025 |0.12726593017578125 |0.0001544356346130371 |0.0041574835777282715 |0.003080129623413086 |
----------------------------------------------------------pseudo_mini_loss sum 4.501787185668945
Total (block generation + training)time/epoch 344.31590700149536
Training time/epoch 4.871046543121338
Training time without block to device /epoch 2.821079969406128
Training time without total dataloading part /epoch 0.5293915271759033
load block tensor time/epoch 1.9549438953399658
block to device time/epoch 2.04996657371521
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 3 |
Number of nodes for computation during this epoch:  19821263
Number of first layer input nodes during this epoch:  8893172
Number of first layer output nodes during this epoch:  7690290
----------------------------------------before generate dataloader block 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 2.0959486961364746  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.33818912506103516
global_2_local spend time (sec) 0.476154088973999
----------------------------  graph partition start---------------------
Convert a graph into a bidirected graph: 0.495 seconds
Metis partitioning: 2.478 seconds
Split the graph: 0.619 seconds
Construct subgraphs: 0.043 seconds
48351
50410
48169
49641
The batched output nid list before graph partition
total k batches seeds list generation spend  3.693011999130249
after graph partition
graph partition algorithm spend time 5.032087564468384
48351
50410
48169
49641
partition_len_list
[802170, 822559, 799724, 813453]
metis selection method  spend 5.801686525344849
time for parepare:  0.2667520046234131
local_output_nid generation:  0.009430646896362305
local_in_edges_tensor generation:  0.0325164794921875
mini_batch_src_global generation:  0.06246137619018555
r_  generation:  0.9209959506988525
local_output_nid generation:  0.011371374130249023
local_in_edges_tensor generation:  0.04347968101501465
mini_batch_src_global generation:  0.08014655113220215
r_  generation:  1.1066443920135498
local_output_nid generation:  0.013068675994873047
local_in_edges_tensor generation:  0.02078104019165039
mini_batch_src_global generation:  0.055551767349243164
r_  generation:  1.0161993503570557
local_output_nid generation:  0.010640382766723633
local_in_edges_tensor generation:  0.033562421798706055
mini_batch_src_global generation:  0.06649541854858398
r_  generation:  1.1206841468811035
----------------------check_connections_block total spend ----------------------------- 5.584095239639282
generate_one_block  1.5527818202972412
generate_one_block  1.173224687576294
generate_one_block  1.1700592041015625
generate_one_block  1.3241498470306396
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.087355852127075
gen group dst list time:  0.10291910171508789
time for parepare:  0.4603240489959717
local_output_nid generation:  0.22864651679992676
local_in_edges_tensor generation:  0.7574965953826904
mini_batch_src_global generation:  0.798651933670044
r_  generation:  10.836140632629395
local_output_nid generation:  0.26140356063842773
local_in_edges_tensor generation:  0.7661905288696289
mini_batch_src_global generation:  1.0282058715820312
r_  generation:  11.422979354858398
local_output_nid generation:  0.2543058395385742
local_in_edges_tensor generation:  0.9170546531677246
mini_batch_src_global generation:  1.0000617504119873
r_  generation:  10.714298963546753
local_output_nid generation:  0.25272130966186523
local_in_edges_tensor generation:  0.6179633140563965
mini_batch_src_global generation:  1.0025486946105957
r_  generation:  11.391749382019043
----------------------check_connections_block total spend ----------------------------- 60.33520746231079
generate_one_block  14.497606754302979
generate_one_block  14.453668117523193
generate_one_block  14.30936598777771
generate_one_block  15.0490562915802
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.319929599761963
gen group dst list time:  0.30269575119018555
time for parepare:  0.48145341873168945
local_output_nid generation:  0.6185793876647949
local_in_edges_tensor generation:  1.4121358394622803
mini_batch_src_global generation:  1.19633150100708
r_  generation:  17.401227474212646
local_output_nid generation:  0.6548659801483154
local_in_edges_tensor generation:  1.3733274936676025
mini_batch_src_global generation:  1.780287742614746
r_  generation:  17.46915316581726
local_output_nid generation:  0.6224286556243896
local_in_edges_tensor generation:  1.279789924621582
mini_batch_src_global generation:  1.745328664779663
r_  generation:  17.5335533618927
local_output_nid generation:  0.6378827095031738
local_in_edges_tensor generation:  1.2749979496002197
mini_batch_src_global generation:  1.723975658416748
r_  generation:  17.630250453948975
----------------------check_connections_block total spend ----------------------------- 96.99962735176086
generate_one_block  22.79927659034729
generate_one_block  22.71870231628418
generate_one_block  22.965319871902466
generate_one_block  22.598941802978516
----------===============-------------===============-------------the number of batches *****---- 4

original number of batches:  4
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 2.0959486961364746  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

connection checking time:  162.91893005371094
block generation total time  154.61215329170227
average batch blocks generation time:  12.884346107641855
block dataloader generation time/epoch 338.78653569221495
pseudo mini batch 0 input nodes size: 2224050
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 0.84124755859375  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 0.84124755859375  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.6697711944580078  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.6701316833496094  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 0.8406505584716797  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.3265151977539062  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.3265151977539062  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

first layer input nodes number: 2224050
first layer output nodes number: 1919820
edges number: 38392000
torch.Size([2224050, 100])
torch.Size([1919820, 256])
input nodes number: 1919820
output nodes number: 802170
edges number: 24992811
torch.Size([1919820, 256])
torch.Size([802170, 256])
torch.Size([48351, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 9.252330303192139  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 9.260797023773193  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 2.085134983062744  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

pseudo mini batch 1 input nodes size: 2222703
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 0.8404254913330078  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 0.8404254913330078  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.6684470176696777  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.6688227653503418  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 0.8399386405944824  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.3315720558166504  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5721435546875 GB
    Memory Allocated: 1.3315720558166504  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

first layer input nodes number: 2222703
first layer output nodes number: 1927988
edges number: 38487729
torch.Size([2222703, 100])
torch.Size([1927988, 256])
input nodes number: 1927988
output nodes number: 822559
edges number: 25591273
torch.Size([1927988, 256])
torch.Size([822559, 256])
torch.Size([50410, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 9.35055685043335  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 9.359383583068848  GigaBytes
Max Memory Allocated: 10.868971824645996  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 2.1008682250976562  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

pseudo mini batch 2 input nodes size: 2222942
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 0.840299129486084  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 0.840299129486084  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.668409824371338  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.6687688827514648  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 0.8403716087341309  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.3255772590637207  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.3255772590637207  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

first layer input nodes number: 2222942
first layer output nodes number: 1919374
edges number: 38383714
torch.Size([2222942, 100])
torch.Size([1919374, 256])
input nodes number: 1919374
output nodes number: 799724
edges number: 24918004
torch.Size([1919374, 256])
torch.Size([799724, 256])
torch.Size([48169, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 9.241612911224365  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 9.25004768371582  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 2.0814242362976074  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

pseudo mini batch 3 input nodes size: 2224482
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 0.8399796485900879  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 0.8399796485900879  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.6686639785766602  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.6690340042114258  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 0.8405642509460449  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.3297677040100098  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.3297677040100098  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

first layer input nodes number: 2224482
first layer output nodes number: 1927266
edges number: 38485170
torch.Size([2224482, 100])
torch.Size([1927266, 256])
input nodes number: 1927266
output nodes number: 813453
edges number: 25298604
torch.Size([1927266, 256])
torch.Size([813453, 256])
torch.Size([49641, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 9.31644582748413  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 9.325138092041016  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 2.0954055786132812  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 2.0954055786132812  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 2.0954055786132812  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.4855077266693115 |0.4951704740524292 |0.12902921438217163 |0.00016129016876220703 |0.004163503646850586 |0.003224611282348633 |
----------------------------------------------------------pseudo_mini_loss sum 3.38871431350708
Total (block generation + training)time/epoch 344.0551258563995
Training time/epoch 4.799800872802734
Training time without block to device /epoch 2.8191189765930176
Training time without total dataloading part /epoch 0.5366406440734863
load block tensor time/epoch 1.942030906677246
block to device time/epoch 1.9806818962097168
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 4 |
Number of nodes for computation during this epoch:  19826531
Number of first layer input nodes during this epoch:  8894177
Number of first layer output nodes during this epoch:  7694448
----------------------------------------before generate dataloader block 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 2.095405101776123  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.31807661056518555
global_2_local spend time (sec) 0.5725662708282471
----------------------------  graph partition start---------------------
Convert a graph into a bidirected graph: 0.464 seconds
Metis partitioning: 2.615 seconds
Split the graph: 0.645 seconds
Construct subgraphs: 0.052 seconds
48351
50410
48169
49641
The batched output nid list before graph partition
total k batches seeds list generation spend  3.82308292388916
after graph partition
graph partition algorithm spend time 5.13598370552063
48351
50410
48169
49641
partition_len_list
[800894, 819788, 801817, 814553]
metis selection method  spend 6.015577077865601
time for parepare:  0.319133996963501
local_output_nid generation:  0.009903907775878906
local_in_edges_tensor generation:  0.036464691162109375
mini_batch_src_global generation:  0.06078314781188965
r_  generation:  0.9804134368896484
local_output_nid generation:  0.01409912109375
local_in_edges_tensor generation:  0.03695487976074219
mini_batch_src_global generation:  0.08489584922790527
r_  generation:  0.9875714778900146
local_output_nid generation:  0.010698318481445312
local_in_edges_tensor generation:  0.015561103820800781
mini_batch_src_global generation:  0.06574797630310059
r_  generation:  0.9854714870452881
local_output_nid generation:  0.010789632797241211
local_in_edges_tensor generation:  0.02353954315185547
mini_batch_src_global generation:  0.06611824035644531
r_  generation:  1.1077721118927002
----------------------check_connections_block total spend ----------------------------- 5.5381834506988525
generate_one_block  1.5836091041564941
generate_one_block  1.1683588027954102
generate_one_block  1.4508485794067383
generate_one_block  1.237339973449707
The real block id is  1
get_global_graph_edges_ids_block function  spend 2.221339225769043
gen group dst list time:  0.11615467071533203
time for parepare:  0.4805619716644287
local_output_nid generation:  0.23573017120361328
local_in_edges_tensor generation:  0.849755048751831
mini_batch_src_global generation:  0.8220615386962891
r_  generation:  10.978971481323242
local_output_nid generation:  0.27120113372802734
local_in_edges_tensor generation:  0.763953447341919
mini_batch_src_global generation:  1.0435278415679932
r_  generation:  11.489588260650635
local_output_nid generation:  0.26162075996398926
local_in_edges_tensor generation:  0.8569557666778564
mini_batch_src_global generation:  1.028320550918579
r_  generation:  11.01164174079895
local_output_nid generation:  0.25350475311279297
local_in_edges_tensor generation:  0.6866562366485596
mini_batch_src_global generation:  1.0195577144622803
r_  generation:  11.586738109588623
----------------------check_connections_block total spend ----------------------------- 61.46625471115112
generate_one_block  14.638743877410889
generate_one_block  14.665860652923584
generate_one_block  14.54126262664795
generate_one_block  14.544103622436523
The real block id is  0
get_global_graph_edges_ids_block function  spend 2.393383502960205
gen group dst list time:  0.2939729690551758
time for parepare:  0.47507238388061523
local_output_nid generation:  0.6157479286193848
local_in_edges_tensor generation:  1.4099299907684326
mini_batch_src_global generation:  1.289442777633667
r_  generation:  17.382704734802246
local_output_nid generation:  0.6532483100891113
local_in_edges_tensor generation:  1.3446755409240723
mini_batch_src_global generation:  1.7603576183319092
r_  generation:  17.214930772781372
local_output_nid generation:  0.6259369850158691
local_in_edges_tensor generation:  1.442880630493164
mini_batch_src_global generation:  1.6608359813690186
r_  generation:  17.505425691604614
local_output_nid generation:  0.643404483795166
local_in_edges_tensor generation:  1.2962346076965332
mini_batch_src_global generation:  1.6285617351531982
r_  generation:  17.768304109573364
----------------------check_connections_block total spend ----------------------------- 96.79595375061035
generate_one_block  22.85818314552307
generate_one_block  22.896297693252563
generate_one_block  23.500991821289062
generate_one_block  22.850280046463013
----------===============-------------===============-------------the number of batches *****---- 4

original number of batches:  4
re graph partition time:  0

-----------------------------------------after block dataloader generation 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 2.095405101776123  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

connection checking time:  163.80039191246033
block generation total time  155.935879945755
average batch blocks generation time:  12.99465666214625
block dataloader generation time/epoch 339.1219713290532
pseudo mini batch 0 input nodes size: 2222033
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 0.8408207893371582  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 0.8408207893371582  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.668592929840088  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.6689534187316895  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 0.8398990631103516  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.326158046722412  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.326158046722412  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

first layer input nodes number: 2222033
first layer output nodes number: 1920172
edges number: 38411539
torch.Size([2222033, 100])
torch.Size([1920172, 256])
input nodes number: 1920172
output nodes number: 800894
edges number: 24948918
torch.Size([1920172, 256])
torch.Size([800894, 256])
torch.Size([48351, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 9.248700618743896  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 9.257167339324951  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 2.0831518173217773  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

pseudo mini batch 1 input nodes size: 2223946
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 0.8396739959716797  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 0.8396739959716797  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.668358325958252  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.668734073638916  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 0.8406014442443848  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.331251621246338  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.331251621246338  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

first layer input nodes number: 2223946
first layer output nodes number: 1927542
edges number: 38471867
torch.Size([2223946, 100])
torch.Size([1927542, 256])
input nodes number: 1927542
output nodes number: 819788
edges number: 25477714
torch.Size([1927542, 256])
torch.Size([819788, 256])
torch.Size([50410, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 9.33983564376831  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 9.348662376403809  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 2.0997066497802734  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

pseudo mini batch 2 input nodes size: 2221210
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 0.8409619331359863  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 0.8409619331359863  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.6684274673461914  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.6687865257263184  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 0.839726448059082  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.325216293334961  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.325216293334961  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

first layer input nodes number: 2221210
first layer output nodes number: 1917751
edges number: 38350038
torch.Size([2221210, 100])
torch.Size([1917751, 256])
input nodes number: 1917751
output nodes number: 801817
edges number: 24988818
torch.Size([1917751, 256])
torch.Size([801817, 256])
torch.Size([48169, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 9.244039535522461  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 9.252474308013916  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 2.0832691192626953  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

pseudo mini batch 3 input nodes size: 2225287
----------------------------------------before load block subtensor 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 0.8393344879150391  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 0.8393344879150391  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.668318748474121  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.6686887741088867  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 0.8408641815185547  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.3307795524597168  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 1.3307795524597168  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

first layer input nodes number: 2225287
first layer output nodes number: 1926317
edges number: 38475854
torch.Size([2225287, 100])
torch.Size([1926317, 256])
input nodes number: 1926317
output nodes number: 814553
edges number: 25344780
torch.Size([1926317, 256])
torch.Size([814553, 256])
torch.Size([49641, 47])
-----------------------------------------batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 9.318025588989258  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 9.326717853546143  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 2.096104621887207  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 2.096104621887207  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 20.5740966796875 GB
    Memory Allocated: 2.096104621887207  GigaBytes
Max Memory Allocated: 10.879706382751465  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.47333335876464844 |0.665344774723053 |0.12674051523208618 |0.00016319751739501953 |0.004257559776306152 |0.0015065670013427734 |
----------------------------------------------------------pseudo_mini_loss sum 2.228745222091675
Total (block generation + training)time/epoch 344.4162169297536
Training time/epoch 5.422211170196533
Training time without block to device /epoch 2.7608320713043213
Training time without total dataloading part /epoch 0.5261516571044922
load block tensor time/epoch 1.8933334350585938
block to device time/epoch 2.661379098892212
input features size transfer per epoch 5.364418029785156e-07
blocks size to device per epoch 3.5762786865234375e-07
 Run 0| Epoch 5 |
Number of nodes for computation during this epoch:  19821310
Number of first layer input nodes during this epoch:  8892476
Number of first layer output nodes during this epoch:  7691782
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=100, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  206336
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 100])
layers.0.fc_neigh.weight, torch.Size([256, 100])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([47, 256])
layers.2.fc_neigh.weight, torch.Size([47, 256])
----------------------------------------
un-trainable parameters
