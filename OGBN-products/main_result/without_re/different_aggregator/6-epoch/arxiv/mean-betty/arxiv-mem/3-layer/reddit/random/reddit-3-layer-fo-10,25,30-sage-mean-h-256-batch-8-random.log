main start at this time 1657073463.268818
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

success----------------------------------------
153431
23831
55703
# Nodes: 232965
# Edges: 114615892
# Train: 153431
# Val: 23831
# Test: 55703
# Classes: 41

#nodes: 232965
#edges: 114615892
#classes: 41
----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  602
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017147064208984375  GigaBytes
Max Memory Allocated: 0.0017147064208984375  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017147064208984375  GigaBytes
Max Memory Allocated: 0.0017147064208984375  GigaBytes

The real block id is  2
get_global_graph_edges_ids_block function  spend 0.32051944732666016
number of batches is  8
batch size is  19179
random selection method spend 0.014077425003051758
time for parepare:  0.028176546096801758
local_output_nid generation:  0.008360862731933594
local_in_edges_tensor generation:  0.016016483306884766
mini_batch_src_global generation:  0.015863418579101562
r_  generation:  0.17316794395446777
local_output_nid generation:  0.01072549819946289
local_in_edges_tensor generation:  0.01394033432006836
mini_batch_src_global generation:  0.020991086959838867
r_  generation:  0.18879199028015137
local_output_nid generation:  0.010777950286865234
local_in_edges_tensor generation:  0.009614944458007812
mini_batch_src_global generation:  0.0176699161529541
r_  generation:  0.19399285316467285
local_output_nid generation:  0.010814189910888672
local_in_edges_tensor generation:  0.00960540771484375
mini_batch_src_global generation:  0.019315004348754883
r_  generation:  0.20236754417419434
local_output_nid generation:  0.010791778564453125
local_in_edges_tensor generation:  0.011154890060424805
mini_batch_src_global generation:  0.020638465881347656
r_  generation:  0.20697736740112305
local_output_nid generation:  0.010843276977539062
local_in_edges_tensor generation:  0.00831747055053711
mini_batch_src_global generation:  0.023448467254638672
r_  generation:  0.2113022804260254
local_output_nid generation:  0.010686635971069336
local_in_edges_tensor generation:  0.008199691772460938
mini_batch_src_global generation:  0.025825977325439453
r_  generation:  0.2113025188446045
local_output_nid generation:  0.010724782943725586
local_in_edges_tensor generation:  0.01079106330871582
mini_batch_src_global generation:  0.022732257843017578
r_  generation:  0.22101998329162598
----------------------check_connections_block total spend ----------------------------- 2.287477731704712
generate_one_block  0.2810676097869873
generate_one_block  0.2718360424041748
generate_one_block  0.2706282138824463
generate_one_block  0.27277517318725586
generate_one_block  0.26712894439697266
generate_one_block  0.26273488998413086
generate_one_block  0.2631502151489258
generate_one_block  0.267474889755249
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.6773972511291504
gen group dst list time:  0.03472566604614258
time for parepare:  0.031269073486328125
local_output_nid generation:  0.03555774688720703
local_in_edges_tensor generation:  0.13021183013916016
mini_batch_src_global generation:  0.12420535087585449
r_  generation:  1.207301139831543
local_output_nid generation:  0.0411679744720459
local_in_edges_tensor generation:  0.10158109664916992
mini_batch_src_global generation:  0.15157604217529297
r_  generation:  1.2458298206329346
local_output_nid generation:  0.0410914421081543
local_in_edges_tensor generation:  0.09725093841552734
mini_batch_src_global generation:  0.1522536277770996
r_  generation:  1.2545561790466309
local_output_nid generation:  0.041118621826171875
local_in_edges_tensor generation:  0.09132766723632812
mini_batch_src_global generation:  0.14211487770080566
r_  generation:  1.3187978267669678
local_output_nid generation:  0.040984392166137695
local_in_edges_tensor generation:  0.0807037353515625
mini_batch_src_global generation:  0.14535164833068848
r_  generation:  1.2864203453063965
local_output_nid generation:  0.04145455360412598
local_in_edges_tensor generation:  0.05885195732116699
mini_batch_src_global generation:  0.1557157039642334
r_  generation:  1.3121099472045898
local_output_nid generation:  0.04523944854736328
local_in_edges_tensor generation:  0.060624122619628906
mini_batch_src_global generation:  0.14598917961120605
r_  generation:  1.2542221546173096
local_output_nid generation:  0.04257369041442871
local_in_edges_tensor generation:  0.0701911449432373
mini_batch_src_global generation:  0.15601611137390137
r_  generation:  1.2644574642181396
----------------------check_connections_block total spend ----------------------------- 14.20796012878418
generate_one_block  1.626314401626587
generate_one_block  1.5797827243804932
generate_one_block  1.5510962009429932
generate_one_block  1.580460548400879
generate_one_block  1.5456266403198242
generate_one_block  1.5560765266418457
generate_one_block  1.5962939262390137
generate_one_block  1.5784215927124023
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.281017541885376
gen group dst list time:  0.07650637626647949
time for parepare:  0.029172897338867188
local_output_nid generation:  0.050809621810913086
local_in_edges_tensor generation:  0.0837407112121582
mini_batch_src_global generation:  0.06367135047912598
r_  generation:  0.7488365173339844
local_output_nid generation:  0.0543513298034668
local_in_edges_tensor generation:  0.07433390617370605
mini_batch_src_global generation:  0.07612013816833496
r_  generation:  0.7602646350860596
local_output_nid generation:  0.05573606491088867
local_in_edges_tensor generation:  0.07126665115356445
mini_batch_src_global generation:  0.07477736473083496
r_  generation:  0.804379940032959
local_output_nid generation:  0.05436444282531738
local_in_edges_tensor generation:  0.0722200870513916
mini_batch_src_global generation:  0.08131814002990723
r_  generation:  0.7765345573425293
local_output_nid generation:  0.05397820472717285
local_in_edges_tensor generation:  0.06638884544372559
mini_batch_src_global generation:  0.07663702964782715
r_  generation:  0.7962567806243896
local_output_nid generation:  0.05369091033935547
local_in_edges_tensor generation:  0.062306880950927734
mini_batch_src_global generation:  0.0776364803314209
r_  generation:  0.7800323963165283
local_output_nid generation:  0.053722381591796875
local_in_edges_tensor generation:  0.05641889572143555
mini_batch_src_global generation:  0.07680797576904297
r_  generation:  0.812546968460083
local_output_nid generation:  0.0543217658996582
local_in_edges_tensor generation:  0.06181693077087402
mini_batch_src_global generation:  0.0784158706665039
r_  generation:  0.7781503200531006
----------------------check_connections_block total spend ----------------------------- 9.191051483154297
generate_one_block  1.0869576930999756
generate_one_block  0.9481201171875
generate_one_block  0.9735896587371826
generate_one_block  0.9686577320098877
generate_one_block  0.976391077041626
generate_one_block  0.9811580181121826
generate_one_block  0.9196100234985352
generate_one_block  0.9420380592346191
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017147064208984375  GigaBytes
Max Memory Allocated: 0.0017147064208984375  GigaBytes

connection checking time:  23.399011611938477
block generation total time  20.410594940185547
average batch blocks generation time:  2.5513243675231934
block dataloader generation time/epoch 50.613378047943115
pseudo mini batch 0 input nodes size: 221616
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017147064208984375  GigaBytes
Max Memory Allocated: 0.0017147064208984375  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0017147064208984375  GigaBytes
Max Memory Allocated: 0.0017147064208984375  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.4987163543701172  GigaBytes
Max Memory Allocated: 0.4987163543701172  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.4988594055175781  GigaBytes
Max Memory Allocated: 0.4988594055175781  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.5155029296875 GB
    Memory Allocated: 0.4988594055175781  GigaBytes
Max Memory Allocated: 0.4988594055175781  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.5500307083129883  GigaBytes
Max Memory Allocated: 0.5500307083129883  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.5500307083129883  GigaBytes
Max Memory Allocated: 0.5500307083129883  GigaBytes

first layer input nodes number: 221616
first layer output nodes number: 216619
edges number: 2144808
----------------------------------------before model layer 0
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.5532960891723633  GigaBytes
Max Memory Allocated: 0.561286449432373  GigaBytes

torch.Size([221616, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.6502685546875 GB
    Memory Allocated: 0.5532960891723633  GigaBytes
Max Memory Allocated: 0.561286449432373  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.3533935546875 GB
    Memory Allocated: 1.2629961967468262  GigaBytes
Max Memory Allocated: 1.5435476303100586  GigaBytes

torch.Size([216619, 256])
torch.Size([216619, 256])
----------------------------------------after rst
 Nvidia-smi: 3.5604248046875 GB
    Memory Allocated: 1.4700274467468262  GigaBytes
Max Memory Allocated: 1.6766114234924316  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.5604248046875 GB
    Memory Allocated: 1.2634434700012207  GigaBytes
Max Memory Allocated: 1.6766114234924316  GigaBytes

torch.Size([216619, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.5604248046875 GB
    Memory Allocated: 1.4700274467468262  GigaBytes
Max Memory Allocated: 1.6766114234924316  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.5604248046875 GB
    Memory Allocated: 1.5216736793518066  GigaBytes
Max Memory Allocated: 1.728257656097412  GigaBytes

input nodes number: 216619
output nodes number: 162510
edges number: 3989905
----------------------------------------before model layer 1
 Nvidia-smi: 3.5604248046875 GB
    Memory Allocated: 1.5248680114746094  GigaBytes
Max Memory Allocated: 1.728257656097412  GigaBytes

torch.Size([216619, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.5604248046875 GB
    Memory Allocated: 1.5248680114746094  GigaBytes
Max Memory Allocated: 1.728257656097412  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.7479248046875 GB
    Memory Allocated: 1.8657703399658203  GigaBytes
Max Memory Allocated: 1.8657703399658203  GigaBytes

torch.Size([162510, 256])
torch.Size([162510, 256])
----------------------------------------after rst
 Nvidia-smi: 4.0604248046875 GB
    Memory Allocated: 2.020751953125  GigaBytes
Max Memory Allocated: 2.1757335662841797  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 4.0604248046875 GB
    Memory Allocated: 1.8657703399658203  GigaBytes
Max Memory Allocated: 2.1757335662841797  GigaBytes

torch.Size([162510, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 4.0604248046875 GB
    Memory Allocated: 2.020751953125  GigaBytes
Max Memory Allocated: 2.1757335662841797  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 4.0604248046875 GB
    Memory Allocated: 2.059497356414795  GigaBytes
Max Memory Allocated: 2.2144789695739746  GigaBytes

----------------input nodes number: 162510
----------------output nodes number: 19179
----------------edges number: 528883
----------------------------------------before mean aggregator
 Nvidia-smi: 4.0604248046875 GB
    Memory Allocated: 2.060908794403076  GigaBytes
Max Memory Allocated: 2.2144789695739746  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 4.0604248046875 GB
    Memory Allocated: 2.087700366973877  GigaBytes
Max Memory Allocated: 2.2144789695739746  GigaBytes

torch.Size([19179, 41])
torch.Size([19179, 41])
----------------------------------------after rst
 Nvidia-smi: 4.0604248046875 GB
    Memory Allocated: 2.090630054473877  GigaBytes
Max Memory Allocated: 2.2144789695739746  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 4.0604248046875 GB
    Memory Allocated: 2.087700366973877  GigaBytes
Max Memory Allocated: 2.2144789695739746  GigaBytes

torch.Size([19179, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 4.0604248046875 GB
    Memory Allocated: 2.090630054473877  GigaBytes
Max Memory Allocated: 2.2144789695739746  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 4.0604248046875 GB
    Memory Allocated: 2.0935606956481934  GigaBytes
Max Memory Allocated: 2.2144789695739746  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 4.7889404296875 GB
    Memory Allocated: 0.6502499580383301  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

pseudo mini batch 1 input nodes size: 221599
----------------------------------------before load block subtensor 
 Nvidia-smi: 4.7889404296875 GB
    Memory Allocated: 0.503504753112793  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 4.7889404296875 GB
    Memory Allocated: 0.503504753112793  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2869873046875 GB
    Memory Allocated: 1.0004682540893555  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2869873046875 GB
    Memory Allocated: 1.0006113052368164  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2869873046875 GB
    Memory Allocated: 0.5034666061401367  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2869873046875 GB
    Memory Allocated: 0.5552549362182617  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2869873046875 GB
    Memory Allocated: 0.5552549362182617  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

first layer input nodes number: 221599
first layer output nodes number: 216653
edges number: 2145976
----------------------------------------before model layer 0
 Nvidia-smi: 5.2869873046875 GB
    Memory Allocated: 0.5585207939147949  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

torch.Size([221599, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2869873046875 GB
    Memory Allocated: 0.5585207939147949  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.2686767578125  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

torch.Size([216653, 256])
torch.Size([216653, 256])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.4752931594848633  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.2682619094848633  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

torch.Size([216653, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.4752931594848633  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.5269474983215332  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

input nodes number: 216653
output nodes number: 162914
edges number: 4003145
----------------------------------------before model layer 1
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.530921459197998  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

torch.Size([216653, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.530921459197998  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.8744616508483887  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

torch.Size([162914, 256])
torch.Size([162914, 256])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0298285484313965  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.8735785484313965  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

torch.Size([162914, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0298285484313965  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0686702728271484  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

----------------input nodes number: 162914
----------------output nodes number: 19179
----------------edges number: 531327
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0700273513793945  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0953493118286133  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

torch.Size([19179, 41])
torch.Size([19179, 41])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0982789993286133  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0953493118286133  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

torch.Size([19179, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0953493118286133  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0982794761657715  GigaBytes
Max Memory Allocated: 2.3839268684387207  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.650970458984375  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

pseudo mini batch 2 input nodes size: 221476
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5034666061401367  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5034666061401367  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.0001544952392578  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.0002975463867188  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5031909942626953  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5535998344421387  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5535998344421387  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

first layer input nodes number: 221476
first layer output nodes number: 216520
edges number: 2144525
----------------------------------------before model layer 0
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5569429397583008  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

torch.Size([221476, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5569429397583008  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.2670879364013672  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

torch.Size([216520, 256])
torch.Size([216520, 256])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.4735774993896484  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.2665462493896484  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

torch.Size([216520, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.4735774993896484  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.5251998901367188  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

input nodes number: 216520
output nodes number: 162482
edges number: 3992065
----------------------------------------before model layer 1
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.528172492980957  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

torch.Size([216520, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.528172492980957  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.8690376281738281  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

torch.Size([162482, 256])
torch.Size([162482, 256])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0239925384521484  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.8690376281738281  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

torch.Size([162482, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0239925384521484  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0627312660217285  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------input nodes number: 162482
----------------output nodes number: 19179
----------------edges number: 531374
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.064169406890869  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0899410247802734  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

torch.Size([19179, 41])
torch.Size([19179, 41])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0928707122802734  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0899410247802734  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

torch.Size([19179, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0899410247802734  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0928711891174316  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.6495308876037598  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

pseudo mini batch 3 input nodes size: 221685
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5031909942626953  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5031909942626953  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.0012378692626953  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.0013809204101562  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5045499801635742  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5550069808959961  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5550069808959961  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

first layer input nodes number: 221685
first layer output nodes number: 216692
edges number: 2146004
----------------------------------------before model layer 0
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5582733154296875  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

torch.Size([221685, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5582733154296875  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.2684292793273926  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

torch.Size([216692, 256])
torch.Size([216692, 256])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.4750828742980957  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.2680516242980957  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

torch.Size([216692, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.4750828742980957  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.5267462730407715  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

input nodes number: 216692
output nodes number: 162924
edges number: 4002684
----------------------------------------before model layer 1
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.5298376083374023  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

torch.Size([216692, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.5298376083374023  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.8733739852905273  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

torch.Size([162924, 256])
torch.Size([162924, 256])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.028750419616699  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.8725004196166992  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

torch.Size([162924, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.028750419616699  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.067594528198242  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------input nodes number: 162924
----------------output nodes number: 19179
----------------edges number: 531019
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.069326400756836  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0953097343444824  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

torch.Size([19179, 41])
torch.Size([19179, 41])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0982394218444824  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0953097343444824  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

torch.Size([19179, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0953097343444824  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0982398986816406  GigaBytes
Max Memory Allocated: 2.390900135040283  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.6513671875  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

pseudo mini batch 4 input nodes size: 221572
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5045499801635742  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5045499801635742  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.001452922821045  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.0015959739685059  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5034060478210449  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5545487403869629  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5545487403869629  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

first layer input nodes number: 221572
first layer output nodes number: 216680
edges number: 2145621
----------------------------------------before model layer 0
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5579357147216797  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([221572, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5579357147216797  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.2680888175964355  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([216680, 256])
torch.Size([216680, 256])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.4747309684753418  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.2676997184753418  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([216680, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.4747309684753418  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.5263915061950684  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

input nodes number: 216680
output nodes number: 162720
edges number: 3995563
----------------------------------------before model layer 1
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.5293211936950684  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([216680, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.5293211936950684  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.8706679344177246  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([162720, 256])
torch.Size([162720, 256])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0258498191833496  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.8706679344177246  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([162720, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0258498191833496  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.064645290374756  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------input nodes number: 162720
----------------output nodes number: 19179
----------------edges number: 530173
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.066718578338623  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0927281379699707  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([19179, 41])
torch.Size([19179, 41])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0956578254699707  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0927281379699707  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([19179, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0927281379699707  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.095658302307129  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.6509151458740234  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

pseudo mini batch 5 input nodes size: 221627
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5034060478210449  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5034060478210449  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.0004324913024902  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.0005755424499512  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5035295486450195  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5546703338623047  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5546703338623047  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

first layer input nodes number: 221627
first layer output nodes number: 216628
edges number: 2145135
----------------------------------------before model layer 0
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5579357147216797  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([221627, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5579357147216797  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.26808500289917  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([216628, 256])
torch.Size([216628, 256])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.474677562713623  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.267646312713623  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([216628, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.474677562713623  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.5263257026672363  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

input nodes number: 216628
output nodes number: 162707
edges number: 3997032
----------------------------------------before model layer 1
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.52937650680542  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([216628, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.52937650680542  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.87070894241333  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([162707, 256])
torch.Size([162707, 256])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.025878429412842  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.87070894241333  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([162707, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.025878429412842  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.064671039581299  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------input nodes number: 162707
----------------output nodes number: 19179
----------------edges number: 531018
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.06674861907959  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0927529335021973  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([19179, 41])
torch.Size([19179, 41])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0956826210021973  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0927529335021973  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([19179, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0927529335021973  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0956830978393555  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.6510558128356934  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

pseudo mini batch 6 input nodes size: 221526
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5035295486450195  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5035295486450195  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.0003294944763184  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.0004725456237793  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.503303050994873  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5544357299804688  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5544357299804688  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

first layer input nodes number: 221526
first layer output nodes number: 216435
edges number: 2143475
----------------------------------------before model layer 0
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5576992034912109  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([221526, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5576992034912109  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.2678351402282715  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([216435, 256])
torch.Size([216435, 256])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.4742436408996582  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.2672123908996582  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([216435, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.4742436408996582  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.525846004486084  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

input nodes number: 216435
output nodes number: 162437
edges number: 3991383
----------------------------------------before model layer 1
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.5287055969238281  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([216435, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.5287055969238281  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.8694791793823242  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([162437, 256])
torch.Size([162437, 256])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0243911743164062  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.8694791793823242  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([162437, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0243911743164062  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.063119411468506  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------input nodes number: 162437
----------------output nodes number: 19179
----------------edges number: 531722
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0646004676818848  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.090625762939453  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([19179, 41])
torch.Size([19179, 41])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.093555450439453  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.090625762939453  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([19179, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.090625762939453  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0935559272766113  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.6499552726745605  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

pseudo mini batch 7 input nodes size: 221577
----------------------------------------before load block subtensor 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.503303050994873  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.503303050994873  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.0002174377441406  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.0003604888916016  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5034174919128418  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5538649559020996  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5538649559020996  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

first layer input nodes number: 221577
first layer output nodes number: 216591
edges number: 2145332
----------------------------------------before model layer 0
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5571303367614746  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([221577, 602])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.5571303367614746  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.2672815322875977  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([216591, 256])
torch.Size([216591, 256])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.4738388061523438  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.2668075561523438  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([216591, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.4738388061523438  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.5254783630371094  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

input nodes number: 216591
output nodes number: 162703
edges number: 3999045
----------------------------------------before model layer 1
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.5285744667053223  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([216591, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.5285744667053223  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.8699145317077637  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([162703, 256])
torch.Size([162703, 256])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0250802040100098  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 1.8699145317077637  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([162703, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0250802040100098  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0638718605041504  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------input nodes number: 162703
----------------output nodes number: 19178
----------------edges number: 533276
----------------------------------------before mean aggregator
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.065608501434326  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0916037559509277  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([19178, 41])
torch.Size([19178, 41])
----------------------------------------after rst
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0945329666137695  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0916037559509277  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

torch.Size([19178, 41])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0916032791137695  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 2.0945329666137695  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 5.2889404296875 GB
    Memory Allocated: 0.6503129005432129  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 5.2928466796875 GB
    Memory Allocated: 0.6537423133850098  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 5.2928466796875 GB
    Memory Allocated: 0.6537423133850098  GigaBytes
Max Memory Allocated: 2.391160011291504  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.15130719542503357 |0.07661160826683044 |0.14678213000297546 |0.00016069412231445312 |0.009570181369781494 |0.002227783203125 |
----------------------------------------------------------pseudo_mini_loss sum 10.789133071899414
Total (block generation + training)time/epoch 53.75022029876709
Training time/epoch 3.1365063190460205
Training time without block to device /epoch 2.523613452911377
Training time without total dataloading part /epoch 1.2543318271636963
load block tensor time/epoch 1.2104575634002686
block to device time/epoch 0.6128928661346436
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  4806893
Number of first layer input nodes during this epoch:  1772678
Number of first layer output nodes during this epoch:  1732818
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=602, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=602, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=41, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=41, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  460288
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 602])
layers.0.fc_neigh.weight, torch.Size([256, 602])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([41, 256])
layers.2.fc_neigh.weight, torch.Size([41, 256])
----------------------------------------
un-trainable parameters
