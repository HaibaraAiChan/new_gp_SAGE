main start at this time 1657097337.6638489
-----------------------------------------before load data 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

ogbn-arxiv
# Nodes: 169343
# Edges: 2315598
# Train: 90941
# Val: 29799
# Test: 48603
# Classes: 40

----------------------------------------start of run function 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

in feats:  128
----------------------------------------before model to device 
 Nvidia-smi: 0.1717529296875 GB
    Memory Allocated: 0.0  GigaBytes
Max Memory Allocated: 0.0  GigaBytes

----------------------------------------after model to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

----------------------------------------before generate dataloader block 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

The real block id is  3
get_global_graph_edges_ids_block function  spend 0.029285430908203125
number of batches is  8
batch size is  11368
random selection method spend 0.0071506500244140625
time for parepare:  0.01874089241027832
local_output_nid generation:  0.004338264465332031
local_in_edges_tensor generation:  0.006388187408447266
mini_batch_src_global generation:  0.0033788681030273438
r_  generation:  0.04120588302612305
local_output_nid generation:  0.005507469177246094
local_in_edges_tensor generation:  0.0031626224517822266
mini_batch_src_global generation:  0.004194498062133789
r_  generation:  0.03834867477416992
local_output_nid generation:  0.005791664123535156
local_in_edges_tensor generation:  0.0030393600463867188
mini_batch_src_global generation:  0.002820730209350586
r_  generation:  0.03950095176696777
local_output_nid generation:  0.005858659744262695
local_in_edges_tensor generation:  0.0031342506408691406
mini_batch_src_global generation:  0.0030205249786376953
r_  generation:  0.041176557540893555
local_output_nid generation:  0.005970954895019531
local_in_edges_tensor generation:  0.0033147335052490234
mini_batch_src_global generation:  0.00304412841796875
r_  generation:  0.04135322570800781
local_output_nid generation:  0.005991697311401367
local_in_edges_tensor generation:  0.0030541419982910156
mini_batch_src_global generation:  0.0033037662506103516
r_  generation:  0.041522979736328125
local_output_nid generation:  0.005943775177001953
local_in_edges_tensor generation:  0.003008127212524414
mini_batch_src_global generation:  0.003294229507446289
r_  generation:  0.04166817665100098
local_output_nid generation:  0.005939006805419922
local_in_edges_tensor generation:  0.0029599666595458984
mini_batch_src_global generation:  0.0034637451171875
r_  generation:  0.042336463928222656
----------------------check_connections_block total spend ----------------------------- 0.5223836898803711
generate_one_block  0.05641603469848633
generate_one_block  0.05771040916442871
generate_one_block  0.055315494537353516
generate_one_block  0.05540895462036133
generate_one_block  0.05443572998046875
generate_one_block  0.05473589897155762
generate_one_block  0.054613590240478516
generate_one_block  0.05518841743469238
The real block id is  2
get_global_graph_edges_ids_block function  spend 0.030312061309814453
gen group dst list time:  0.015123844146728516
time for parepare:  0.018931150436401367
local_output_nid generation:  0.013025522232055664
local_in_edges_tensor generation:  0.024678707122802734
mini_batch_src_global generation:  0.026479244232177734
r_  generation:  0.2800576686859131
local_output_nid generation:  0.018284082412719727
local_in_edges_tensor generation:  0.027947187423706055
mini_batch_src_global generation:  0.03388786315917969
r_  generation:  0.2855501174926758
local_output_nid generation:  0.01789259910583496
local_in_edges_tensor generation:  0.020434141159057617
mini_batch_src_global generation:  0.03560519218444824
r_  generation:  0.29076528549194336
local_output_nid generation:  0.017760753631591797
local_in_edges_tensor generation:  0.022782564163208008
mini_batch_src_global generation:  0.036602020263671875
r_  generation:  0.29407811164855957
local_output_nid generation:  0.017728805541992188
local_in_edges_tensor generation:  0.01766204833984375
mini_batch_src_global generation:  0.0348355770111084
r_  generation:  0.29797983169555664
local_output_nid generation:  0.017909526824951172
local_in_edges_tensor generation:  0.01711893081665039
mini_batch_src_global generation:  0.03598475456237793
r_  generation:  0.29558491706848145
local_output_nid generation:  0.017877817153930664
local_in_edges_tensor generation:  0.02478766441345215
mini_batch_src_global generation:  0.03540468215942383
r_  generation:  0.2956867218017578
local_output_nid generation:  0.017911195755004883
local_in_edges_tensor generation:  0.02482461929321289
mini_batch_src_global generation:  0.03734588623046875
r_  generation:  0.302032470703125
----------------------check_connections_block total spend ----------------------------- 3.4591057300567627
generate_one_block  0.38018083572387695
generate_one_block  0.37242746353149414
generate_one_block  0.39135265350341797
generate_one_block  0.38279199600219727
generate_one_block  0.36909031867980957
generate_one_block  0.3735992908477783
generate_one_block  0.38089871406555176
generate_one_block  0.3791215419769287
The real block id is  1
get_global_graph_edges_ids_block function  spend 0.03621649742126465
gen group dst list time:  0.034926414489746094
time for parepare:  0.018838882446289062
local_output_nid generation:  0.027482986450195312
local_in_edges_tensor generation:  0.04336977005004883
mini_batch_src_global generation:  0.044097185134887695
r_  generation:  0.47118353843688965
local_output_nid generation:  0.034739017486572266
local_in_edges_tensor generation:  0.04802227020263672
mini_batch_src_global generation:  0.05344748497009277
r_  generation:  0.4834270477294922
local_output_nid generation:  0.03424215316772461
local_in_edges_tensor generation:  0.04089641571044922
mini_batch_src_global generation:  0.05094599723815918
r_  generation:  0.4867250919342041
local_output_nid generation:  0.034567832946777344
local_in_edges_tensor generation:  0.032006263732910156
mini_batch_src_global generation:  0.054558753967285156
r_  generation:  0.4824039936065674
local_output_nid generation:  0.03464055061340332
local_in_edges_tensor generation:  0.03458881378173828
mini_batch_src_global generation:  0.05315756797790527
r_  generation:  0.496523380279541
local_output_nid generation:  0.03449654579162598
local_in_edges_tensor generation:  0.03513050079345703
mini_batch_src_global generation:  0.05518817901611328
r_  generation:  0.4875802993774414
local_output_nid generation:  0.03474068641662598
local_in_edges_tensor generation:  0.030757904052734375
mini_batch_src_global generation:  0.05379486083984375
r_  generation:  0.491375207901001
local_output_nid generation:  0.03471875190734863
local_in_edges_tensor generation:  0.03939461708068848
mini_batch_src_global generation:  0.05830240249633789
r_  generation:  0.4911916255950928
----------------------check_connections_block total spend ----------------------------- 5.733572959899902
generate_one_block  0.5981364250183105
generate_one_block  0.6108913421630859
generate_one_block  0.6554033756256104
generate_one_block  0.6017758846282959
generate_one_block  0.6021921634674072
generate_one_block  0.6084353923797607
generate_one_block  0.600581169128418
generate_one_block  0.6188757419586182
The real block id is  0
get_global_graph_edges_ids_block function  spend 0.018361330032348633
gen group dst list time:  0.04361987113952637
time for parepare:  0.018751859664916992
local_output_nid generation:  0.03356361389160156
local_in_edges_tensor generation:  0.038112640380859375
mini_batch_src_global generation:  0.03038644790649414
r_  generation:  0.36797070503234863
local_output_nid generation:  0.038884878158569336
local_in_edges_tensor generation:  0.03018784523010254
mini_batch_src_global generation:  0.041768550872802734
r_  generation:  0.3689920902252197
local_output_nid generation:  0.03905439376831055
local_in_edges_tensor generation:  0.03824186325073242
mini_batch_src_global generation:  0.0377812385559082
r_  generation:  0.38482189178466797
local_output_nid generation:  0.03982043266296387
local_in_edges_tensor generation:  0.03409218788146973
mini_batch_src_global generation:  0.03906536102294922
r_  generation:  0.3914332389831543
local_output_nid generation:  0.03956294059753418
local_in_edges_tensor generation:  0.04191279411315918
mini_batch_src_global generation:  0.05350160598754883
r_  generation:  0.39084601402282715
local_output_nid generation:  0.04251265525817871
local_in_edges_tensor generation:  0.037183284759521484
mini_batch_src_global generation:  0.037604331970214844
r_  generation:  0.3801426887512207
local_output_nid generation:  0.04045724868774414
local_in_edges_tensor generation:  0.03623008728027344
mini_batch_src_global generation:  0.03731393814086914
r_  generation:  0.4183313846588135
local_output_nid generation:  0.04308199882507324
local_in_edges_tensor generation:  0.03150773048400879
mini_batch_src_global generation:  0.06724357604980469
r_  generation:  0.38606882095336914
----------------------check_connections_block total spend ----------------------------- 4.779735088348389
generate_one_block  0.45559024810791016
generate_one_block  0.49483537673950195
generate_one_block  0.46799564361572266
generate_one_block  0.5018899440765381
generate_one_block  0.49473094940185547
generate_one_block  0.45795559883117676
generate_one_block  0.46431422233581543
generate_one_block  0.45682287216186523
-----------------------------------------after block dataloader generation 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

connection checking time:  13.972413778305054
block generation total time  11.719889163970947
average batch blocks generation time:  1.4649861454963684
block dataloader generation time/epoch 27.35774540901184
pseudo mini batch 0 input nodes size: 164487
----------------------------------------before load block subtensor 
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 1.0174560546875 GB
    Memory Allocated: 0.0012969970703125  GigaBytes
Max Memory Allocated: 0.0012969970703125  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.07973051071166992  GigaBytes
Max Memory Allocated: 0.07973051071166992  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.07981538772583008  GigaBytes
Max Memory Allocated: 0.07981538772583008  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 1.0975341796875 GB
    Memory Allocated: 0.07981538772583008  GigaBytes
Max Memory Allocated: 0.07981538772583008  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10690546035766602  GigaBytes
Max Memory Allocated: 0.10690546035766602  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10690546035766602  GigaBytes
Max Memory Allocated: 0.10690546035766602  GigaBytes

first layer input nodes number: 164487
first layer output nodes number: 160147
edges number: 1029115
----------------------------------------before model layer 0
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10974359512329102  GigaBytes
Max Memory Allocated: 0.11357736587524414  GigaBytes

torch.Size([164487, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 1.2030029296875 GB
    Memory Allocated: 0.10974359512329102  GigaBytes
Max Memory Allocated: 0.11357736587524414  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 1.7850341796875 GB
    Memory Allocated: 0.34710025787353516  GigaBytes
Max Memory Allocated: 0.34710025787353516  GigaBytes

torch.Size([160147, 256])
torch.Size([160147, 256])
----------------------------------------after rst
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.4998283386230469  GigaBytes
Max Memory Allocated: 0.6525564193725586  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.34710025787353516  GigaBytes
Max Memory Allocated: 0.6525564193725586  GigaBytes

torch.Size([160147, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.4998283386230469  GigaBytes
Max Memory Allocated: 0.6525564193725586  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.5380105972290039  GigaBytes
Max Memory Allocated: 0.6907386779785156  GigaBytes

input nodes number: 160147
output nodes number: 140091
edges number: 1488776
----------------------------------------before model layer 1
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.5411481857299805  GigaBytes
Max Memory Allocated: 0.6907386779785156  GigaBytes

torch.Size([160147, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.0936279296875 GB
    Memory Allocated: 0.5411481857299805  GigaBytes
Max Memory Allocated: 0.6907386779785156  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.2850341796875 GB
    Memory Allocated: 0.8204879760742188  GigaBytes
Max Memory Allocated: 0.8204879760742188  GigaBytes

torch.Size([140091, 256])
torch.Size([140091, 256])
----------------------------------------after rst
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 0.9540891647338867  GigaBytes
Max Memory Allocated: 1.0876903533935547  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 0.8204879760742188  GigaBytes
Max Memory Allocated: 1.0876903533935547  GigaBytes

torch.Size([140091, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 0.9540891647338867  GigaBytes
Max Memory Allocated: 1.0876903533935547  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 0.9874897003173828  GigaBytes
Max Memory Allocated: 1.1210908889770508  GigaBytes

input nodes number: 140091
output nodes number: 68545
edges number: 907117
----------------------------------------before model layer 2
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 0.9891653060913086  GigaBytes
Max Memory Allocated: 1.1210908889770508  GigaBytes

torch.Size([140091, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 0.9891653060913086  GigaBytes
Max Memory Allocated: 1.1210908889770508  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.5545654296875 GB
    Memory Allocated: 1.127706527709961  GigaBytes
Max Memory Allocated: 1.127706527709961  GigaBytes

torch.Size([68545, 256])
torch.Size([68545, 256])
----------------------------------------after rst
 Nvidia-smi: 2.6873779296875 GB
    Memory Allocated: 1.1930761337280273  GigaBytes
Max Memory Allocated: 1.2584457397460938  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 2.6873779296875 GB
    Memory Allocated: 1.127706527709961  GigaBytes
Max Memory Allocated: 1.2584457397460938  GigaBytes

torch.Size([68545, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 2.6873779296875 GB
    Memory Allocated: 1.1930761337280273  GigaBytes
Max Memory Allocated: 1.2584457397460938  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 2.6873779296875 GB
    Memory Allocated: 1.209418773651123  GigaBytes
Max Memory Allocated: 1.2747883796691895  GigaBytes

----------------input nodes number: 68545
----------------output nodes number: 11368
----------------edges number: 107375
----------------------------------------before mean aggregator
 Nvidia-smi: 2.6893310546875 GB
    Memory Allocated: 1.210014820098877  GigaBytes
Max Memory Allocated: 1.2747883796691895  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 2.6912841796875 GB
    Memory Allocated: 1.2235021591186523  GigaBytes
Max Memory Allocated: 1.2747883796691895  GigaBytes

torch.Size([11368, 40])
torch.Size([11368, 40])
----------------------------------------after rst
 Nvidia-smi: 2.6912841796875 GB
    Memory Allocated: 1.225196361541748  GigaBytes
Max Memory Allocated: 1.2747883796691895  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 2.6912841796875 GB
    Memory Allocated: 1.223435401916504  GigaBytes
Max Memory Allocated: 1.2747883796691895  GigaBytes

torch.Size([11368, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 2.6912841796875 GB
    Memory Allocated: 1.225196361541748  GigaBytes
Max Memory Allocated: 1.2747883796691895  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 2.6912841796875 GB
    Memory Allocated: 1.227529525756836  GigaBytes
Max Memory Allocated: 1.2747883796691895  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.16662883758544922  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

pseudo mini batch 1 input nodes size: 164643
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.08287429809570312  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.08287429809570312  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.16138219833374023  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.1614670753479004  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.08294868469238281  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.10992908477783203  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.10992908477783203  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

first layer input nodes number: 164643
first layer output nodes number: 160213
edges number: 1029452
----------------------------------------before model layer 0
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.1123499870300293  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([164643, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.1123499870300293  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.3498039245605469  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([160213, 256])
torch.Size([160213, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.5025949478149414  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.3498039245605469  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([160213, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.5025949478149414  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.5407929420471191  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

input nodes number: 160213
output nodes number: 140211
edges number: 1490878
----------------------------------------before model layer 1
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.5438046455383301  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([160213, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.5438046455383301  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.8233895301818848  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([140211, 256])
torch.Size([140211, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.9571051597595215  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.8233895301818848  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([140211, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.9571051597595215  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.9905343055725098  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

input nodes number: 140211
output nodes number: 67499
edges number: 894871
----------------------------------------before model layer 2
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.9920873641967773  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([140211, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.9920873641967773  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.1283516883850098  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([67499, 256])
torch.Size([67499, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.1927237510681152  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.1283516883850098  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([67499, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.1927237510681152  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.2088170051574707  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------input nodes number: 67499
----------------output nodes number: 11368
----------------edges number: 104795
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.2094049453735352  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.2231464385986328  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([11368, 40])
torch.Size([11368, 40])
----------------------------------------after rst
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.2248406410217285  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.222806453704834  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([11368, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.2230796813964844  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.2247743606567383  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.16597843170166016  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

pseudo mini batch 2 input nodes size: 164646
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.0832219123840332  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.0832219123840332  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.16173124313354492  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.16181612014770508  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.08322334289550781  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.11025238037109375  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.11025238037109375  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

first layer input nodes number: 164646
first layer output nodes number: 160314
edges number: 1029734
----------------------------------------before model layer 0
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.11301565170288086  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([164646, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.11301565170288086  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.350616455078125  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([160314, 256])
torch.Size([160314, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.5035037994384766  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.350616455078125  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([160314, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.5035037994384766  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.5417256355285645  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

input nodes number: 160314
output nodes number: 140356
edges number: 1491274
----------------------------------------before model layer 1
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.5445446968078613  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([160314, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.5445446968078613  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.8262333869934082  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([140356, 256])
torch.Size([140356, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.9609990119934082  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.8262333869934082  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([140356, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.9609990119934082  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.9944624900817871  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

input nodes number: 140356
output nodes number: 67664
edges number: 900325
----------------------------------------before model layer 2
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.9966483116149902  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([140356, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 0.9966483116149902  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.1335220336914062  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([67664, 256])
torch.Size([67664, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.1980514526367188  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.1335220336914062  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([67664, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.1980514526367188  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.2141838073730469  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------input nodes number: 67664
----------------output nodes number: 11368
----------------edges number: 105917
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.214773178100586  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.2283658981323242  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([11368, 40])
torch.Size([11368, 40])
----------------------------------------after rst
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.23006010055542  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.2281832695007324  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

torch.Size([11368, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.2278432846069336  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2694091796875 GB
    Memory Allocated: 1.2297205924987793  GigaBytes
Max Memory Allocated: 1.3444905281066895  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.16656827926635742  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

pseudo mini batch 3 input nodes size: 164601
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.08288335800170898  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.08288335800170898  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.16137123107910156  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.16145610809326172  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.08286190032958984  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.10916376113891602  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.10916376113891602  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

first layer input nodes number: 164601
first layer output nodes number: 160284
edges number: 1029654
----------------------------------------before model layer 0
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.11159849166870117  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([164601, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.11159849166870117  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.34915637969970703  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([160284, 256])
torch.Size([160284, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5020151138305664  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.34915637969970703  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([160284, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5020151138305664  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5402297973632812  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

input nodes number: 160284
output nodes number: 140290
edges number: 1490535
----------------------------------------before model layer 1
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5431060791015625  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([160284, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5431060791015625  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.8247890472412109  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([140290, 256])
torch.Size([140290, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9585800170898438  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.8238143920898438  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([140290, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9585800170898438  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.992027759552002  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

input nodes number: 140290
output nodes number: 67880
edges number: 901872
----------------------------------------before model layer 2
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9942293167114258  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([140290, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9942293167114258  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.1311640739440918  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([67880, 256])
torch.Size([67880, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.195899486541748  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.1311640739440918  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([67880, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.195899486541748  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.212083339691162  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------input nodes number: 67880
----------------output nodes number: 11368
----------------edges number: 106356
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2126741409301758  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.226144790649414  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([11368, 40])
torch.Size([11368, 40])
----------------------------------------after rst
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2278389930725098  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2260870933532715  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([11368, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.226144790649414  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.227839469909668  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.16526031494140625  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

pseudo mini batch 4 input nodes size: 164646
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.08291959762573242  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.08291959762573242  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.16142892837524414  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.1615138053894043  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.08294105529785156  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.10914993286132812  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.10914993286132812  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

first layer input nodes number: 164646
first layer output nodes number: 160221
edges number: 1029238
----------------------------------------before model layer 0
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.11195087432861328  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([164646, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.11195087432861328  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.3494143486022949  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([160221, 256])
torch.Size([160221, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5022130012512207  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.3494143486022949  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([160221, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5022130012512207  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5404129028320312  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

input nodes number: 160221
output nodes number: 139889
edges number: 1487898
----------------------------------------before model layer 1
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5434093475341797  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([160221, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5434093475341797  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.8223552703857422  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([139889, 256])
torch.Size([139889, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9557638168334961  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.8223552703857422  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([139889, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9557638168334961  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9891161918640137  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

input nodes number: 139889
output nodes number: 67414
edges number: 895296
----------------------------------------before model layer 2
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9909758567810059  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([139889, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9909758567810059  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.1267313957214355  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([67414, 256])
torch.Size([67414, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.1910223960876465  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.1267313957214355  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([67414, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.1910223960876465  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2070951461791992  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------input nodes number: 67414
----------------output nodes number: 11368
----------------edges number: 105018
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2076826095581055  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2211174964904785  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([11368, 40])
torch.Size([11368, 40])
----------------------------------------after rst
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2232327461242676  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2215070724487305  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([11368, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2214808464050293  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2232332229614258  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.16489887237548828  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

pseudo mini batch 5 input nodes size: 164627
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.08291482925415039  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.08291482925415039  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.16141510009765625  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.1614999771118164  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.08290576934814453  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.10992717742919922  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.10992717742919922  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

first layer input nodes number: 164627
first layer output nodes number: 160365
edges number: 1029469
----------------------------------------before model layer 0
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.11234903335571289  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([164627, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.11234903335571289  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.3500208854675293  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([160365, 256])
torch.Size([160365, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5029568672180176  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.3500208854675293  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([160365, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5029568672180176  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5411911010742188  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

input nodes number: 160365
output nodes number: 140192
edges number: 1488994
----------------------------------------before model layer 1
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5439128875732422  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([160365, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5439128875732422  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.8234472274780273  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([140192, 256])
torch.Size([140192, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9571447372436523  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.8234472274780273  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([140192, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9571447372436523  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9905691146850586  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

input nodes number: 140192
output nodes number: 67670
edges number: 899642
----------------------------------------before model layer 2
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9921417236328125  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([140192, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9921417236328125  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.128678321838379  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([67670, 256])
torch.Size([67670, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.1932134628295898  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.128678321838379  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([67670, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.1932134628295898  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2093472480773926  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------input nodes number: 67670
----------------output nodes number: 11368
----------------edges number: 105590
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2099366188049316  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2235207557678223  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([11368, 40])
torch.Size([11368, 40])
----------------------------------------after rst
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.225214958190918  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.223343849182129  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([11368, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2234892845153809  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2251839637756348  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.1654963493347168  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

pseudo mini batch 6 input nodes size: 164500
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.08305120468139648  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.08305120468139648  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.16149091720581055  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.1615757942199707  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.08299064636230469  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.10998249053955078  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.10998249053955078  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

first layer input nodes number: 164500
first layer output nodes number: 159946
edges number: 1028642
----------------------------------------before model layer 0
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.11281299591064453  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([164500, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.11281299591064453  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.34987831115722656  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([159946, 256])
torch.Size([159946, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5024147033691406  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.34987831115722656  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([159946, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5024147033691406  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5405488014221191  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

input nodes number: 159946
output nodes number: 139684
edges number: 1486003
----------------------------------------before model layer 1
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.544069766998291  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([159946, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.544069766998291  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.8226094245910645  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([139684, 256])
torch.Size([139684, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9558224678039551  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.8226094245910645  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([139684, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9558224678039551  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9891257286071777  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

input nodes number: 139684
output nodes number: 67464
edges number: 895908
----------------------------------------before model layer 2
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9911813735961914  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([139684, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9911813735961914  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.1276988983154297  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([67464, 256])
torch.Size([67464, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.192037582397461  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.1276988983154297  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([67464, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.192037582397461  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2081222534179688  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------input nodes number: 67464
----------------output nodes number: 11368
----------------edges number: 105266
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2087101936340332  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.222278118133545  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([11368, 40])
torch.Size([11368, 40])
----------------------------------------after rst
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2239723205566406  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2221155166625977  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([11368, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2221012115478516  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2241692543029785  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.16713380813598633  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

pseudo mini batch 7 input nodes size: 164576
----------------------------------------before load block subtensor 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.0829763412475586  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------before batch input features to device
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.0829763412475586  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after batch input features to device
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.1614522933959961  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after  batch labels to device
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.16153717041015625  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after load block subtensor  
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.08301258087158203  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after blocks to device 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.11003875732421875  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------before batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.11003875732421875  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

first layer input nodes number: 164576
first layer output nodes number: 160318
edges number: 1029355
----------------------------------------before model layer 0
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.11245965957641602  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([164576, 128])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.11245965957641602  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.3500633239746094  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([160318, 256])
torch.Size([160318, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5029544830322266  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 0 x = layer(block, x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.3500633239746094  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([160318, 256])
----------------------------------------after model layer 0 x = self.activation(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5029544830322266  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 0 x = self.dropout(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5411772727966309  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

input nodes number: 160318
output nodes number: 140421
edges number: 1490743
----------------------------------------before model layer 1
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5439887046813965  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([160318, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.5439887046813965  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.8256745338439941  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([140421, 256])
torch.Size([140421, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9595904350280762  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 1 x = layer(block, x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.8248248100280762  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([140421, 256])
----------------------------------------after model layer 1 x = self.activation(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9595904350280762  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 1 x = self.dropout(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9930696487426758  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

input nodes number: 140421
output nodes number: 68250
edges number: 899953
----------------------------------------before model layer 2
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9946250915527344  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([140421, 256])
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.9946250915527344  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.132296085357666  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([68250, 256])
torch.Size([68250, 256])
----------------------------------------after rst
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.1973843574523926  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 2 x = layer(block, x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.132296085357666  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([68250, 256])
----------------------------------------after model layer 2 x = self.activation(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.1973843574523926  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after model layer 2 x = self.dropout(x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2136564254760742  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------input nodes number: 68250
----------------output nodes number: 11365
----------------edges number: 105962
----------------------------------------before mean aggregator
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.214250087738037  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------after mean aggregator-------
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.228161334991455  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([11365, 40])
torch.Size([11365, 40])
----------------------------------------after rst
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2298550605773926  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

----------------------------------------end of model layers  after x = self.layers[-1](blocks[-1], x)
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2276568412780762  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

torch.Size([11365, 40])
----------------------------------------- after batch_pred = model(blocks, batch_inputs) 
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2277131080627441  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

-----------------------------------------after loss calculation
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 1.2299118041992188  GigaBytes
Max Memory Allocated: 1.3453664779663086  GigaBytes

-----------------------------------------after loss backward
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.16542434692382812  GigaBytes
Max Memory Allocated: 1.3463597297668457  GigaBytes

-----------------------------------------after optimizer step
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.16801834106445312  GigaBytes
Max Memory Allocated: 1.3463597297668457  GigaBytes

-----------------------------------------after optimizer zero grad
 Nvidia-smi: 3.2713623046875 GB
    Memory Allocated: 0.16801834106445312  GigaBytes
Max Memory Allocated: 1.3463597297668457  GigaBytes

times | data loading | block to device | model prediction | loss calculation | loss backward |  optimizer step |
      |0.04069790244102478 |0.0682104229927063 |0.1252584159374237 |0.00017887353897094727 |0.014080733060836792 |0.002297639846801758 |
----------------------------------------------------------pseudo_mini_loss sum 6.469974994659424
Total (block generation + training)time/epoch 29.392625331878662
Training time/epoch 2.034656047821045
Training time without block to device /epoch 1.4889726638793945
Training time without total dataloading part /epoch 1.1184418201446533
load block tensor time/epoch 0.32558321952819824
block to device time/epoch 0.5456833839416504
input features size transfer per epoch 1.0728836059570312e-06
blocks size to device per epoch 7.152557373046875e-07
 Run 0| Epoch 0 |
Number of nodes for computation during this epoch:  4262054
Number of first layer input nodes during this epoch:  1316726
Number of first layer output nodes during this epoch:  1281808
GraphSAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (fc_self): Linear(in_features=128, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=128, out_features=256, bias=False)
    )
    (1): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (2): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=256, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=256, bias=False)
    )
    (3): SAGEConv(
      (fc_self): Linear(in_features=256, out_features=40, bias=False)
      (fc_neigh): Linear(in_features=256, out_features=40, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
total model parameters size  348160
trainable parameters
layers.0.fc_self.weight, torch.Size([256, 128])
layers.0.fc_neigh.weight, torch.Size([256, 128])
layers.1.fc_self.weight, torch.Size([256, 256])
layers.1.fc_neigh.weight, torch.Size([256, 256])
layers.2.fc_self.weight, torch.Size([256, 256])
layers.2.fc_neigh.weight, torch.Size([256, 256])
layers.3.fc_self.weight, torch.Size([40, 256])
layers.3.fc_neigh.weight, torch.Size([40, 256])
----------------------------------------
un-trainable parameters
